<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Ein Kochbuch mit Rezepten aus der Bio Data Science, Biostatistik, Biometrie und Statistik zum selber nachkochen!">

<title>31&nbsp; Die ANOVA – Bio Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./stat-tests-ancova2.html" rel="next">
<link href="./stat-tests-ttest.html" rel="prev">
<link href="./cover2024_favi.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-05fe91a66cf75bbbb8c9664867fe5124.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-05a8b96638736df272eeeeef67138371.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="31&nbsp; Die ANOVA – Bio Data Science">
<meta property="og:description" content="Ein Kochbuch mit Rezepten der Bio Data Science, Biostatistik, Biometrie und Statistik">
<meta property="og:image" content="https://github.com/jkruppa/jkruppa.github.io/raw/master/cover2024.png">
<meta property="og:site_name" content="Bio Data Science">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-tests-preface-app.html">Statistische Gruppenvergleiche</a></li><li class="breadcrumb-item"><a href="./stat-tests-anova2.html"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Die ANOVA</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bio Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jkruppa/jkruppa.github.io/" title="Quellcode" class="quarto-navigation-tool px-1" aria-label="Quellcode"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Willkommen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bibliothek</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./forschungsprozess.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forschungsprozess</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abschlussarbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Abschlussarbeit</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./example-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datenbeispiele</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-database.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Von Datenbanken</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programmieren in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Daten in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Daten einlesen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Reguläre Ausdrücke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-purrr-furrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Ein <code>{purrr}</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Ein <code>{ggplot}</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-quarto-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Quarto und Shiny App</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorative Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Testen von Hypothesen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelle Designs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Versuchsplanung in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Einfache Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Fortgeschrittene Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-app.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistische Gruppenvergleiche</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Testen in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Der t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Die repeated / mixed ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-manova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Die MANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Der U-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Der Friedman Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Der Chi-Quadrat-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anteil-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Der Anteilstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-trendtest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Der Trendtest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-permutationstest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Der Permutationstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Der Post-hoc Test</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grundlagen des Modellierens</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Modelgüte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Korrelation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Ausreißer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Variablenselektion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Fehlende Werte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistisches Modellieren</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Modellieren in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-beta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Beta Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-prob-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-robust-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Überlebenszeitanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-noninferiority.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Äquivalenz oder Nichtunterlegenheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Metaanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Fragebogenanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./time-space-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zeitliche und räumliche Analysen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-pseudo-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Pseudo Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Räumliche Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Klassifikation oder maschinelles Lernen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-pre-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Data preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Support vector machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./abspann.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abspann</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-spielecke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">80</span>&nbsp; <span class="chapter-title">Spielecke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./construction-zone.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">Baustelle</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#allgemeiner-hintergrund" id="toc-allgemeiner-hintergrund" class="nav-link active" data-scroll-target="#allgemeiner-hintergrund"><span class="header-section-number">31.1</span> Allgemeiner Hintergrund</a></li>
  <li><a href="#theoretischer-hintergrund" id="toc-theoretischer-hintergrund" class="nav-link" data-scroll-target="#theoretischer-hintergrund"><span class="header-section-number">31.2</span> Theoretischer Hintergrund</a>
  <ul class="collapse">
  <li><a href="#haupteffekte-f_a" id="toc-haupteffekte-f_a" class="nav-link" data-scroll-target="#haupteffekte-f_a"><span class="header-section-number">31.2.1</span> Haupteffekte <span class="math inline">\(f_A\)</span></a></li>
  <li><a href="#effektschätzer" id="toc-effektschätzer" class="nav-link" data-scroll-target="#effektschätzer"><span class="header-section-number">31.2.2</span> Effektschätzer</a></li>
  <li><a href="#interaktion-f_a-times-f_b" id="toc-interaktion-f_a-times-f_b" class="nav-link" data-scroll-target="#interaktion-f_a-times-f_b"><span class="header-section-number">31.2.3</span> Interaktion <span class="math inline">\(f_A \times f_B\)</span></a></li>
  </ul></li>
  <li><a href="#genutzte-r-pakete" id="toc-genutzte-r-pakete" class="nav-link" data-scroll-target="#genutzte-r-pakete"><span class="header-section-number">31.3</span> Genutzte R Pakete</a></li>
  <li><a href="#daten" id="toc-daten" class="nav-link" data-scroll-target="#daten"><span class="header-section-number">31.4</span> Daten</a></li>
  <li><a href="#sec-anova-test-pre" id="toc-sec-anova-test-pre" class="nav-link" data-scroll-target="#sec-anova-test-pre"><span class="header-section-number">31.5</span> Test auf Normalverteilung und Varianzhomogenität</a></li>
  <li><a href="#einfaktorielle-anova" id="toc-einfaktorielle-anova" class="nav-link" data-scroll-target="#einfaktorielle-anova"><span class="header-section-number">31.6</span> Einfaktorielle ANOVA</a></li>
  <li><a href="#zweifaktorielle-anova" id="toc-zweifaktorielle-anova" class="nav-link" data-scroll-target="#zweifaktorielle-anova"><span class="header-section-number">31.7</span> Zweifaktorielle ANOVA</a>
  <ul class="collapse">
  <li><a href="#haupteffekte" id="toc-haupteffekte" class="nav-link" data-scroll-target="#haupteffekte"><span class="header-section-number">31.7.1</span> Haupteffekte</a></li>
  <li><a href="#interaktion" id="toc-interaktion" class="nav-link" data-scroll-target="#interaktion"><span class="header-section-number">31.7.2</span> Interaktion</a></li>
  </ul></li>
  <li><a href="#mehrfaktorielle-anova" id="toc-mehrfaktorielle-anova" class="nav-link" data-scroll-target="#mehrfaktorielle-anova"><span class="header-section-number">31.8</span> Mehrfaktorielle ANOVA</a>
  <ul class="collapse">
  <li><a href="#haupteffekte-1" id="toc-haupteffekte-1" class="nav-link" data-scroll-target="#haupteffekte-1"><span class="header-section-number">31.8.1</span> Haupteffekte</a></li>
  <li><a href="#interaktion-1" id="toc-interaktion-1" class="nav-link" data-scroll-target="#interaktion-1"><span class="header-section-number">31.8.2</span> Interaktion</a></li>
  </ul></li>
  <li><a href="#am-ende" id="toc-am-ende" class="nav-link" data-scroll-target="#am-ende"><span class="header-section-number">31.9</span> Am Ende</a></li>
  <li><a href="#referenzen" id="toc-referenzen" class="nav-link" data-scroll-target="#referenzen">Referenzen</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-tests-anova2.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-tests-anova2.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-tests-preface-app.html">Statistische Gruppenvergleiche</a></li><li class="breadcrumb-item"><a href="./stat-tests-anova2.html"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Die ANOVA</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-anova" class="quarto-section-identifier"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code zeigen</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code verbergen</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Quellcode anzeigen</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><em>Letzte Änderung am 27. June 2025 um 14:02:55</em></p>
<blockquote class="blockquote">
<p><em>“Yeah, I might seem so strong; Yeah, I might speak so long; I’ve never been so wrong.” — London Grammar, Strong</em></p>
</blockquote>
<p>Die ANOVA (eng. <em>analysis of variance</em>) ist wichtig. Was für ein schöner Satz um anzufangen. Historisch betrachtet ist die ANOVA, <em>das</em> statistische Verfahren was gut per Hand ohne Computer berechnet werden kann. Daher war die ANOVA von den 20zigern bis in die frühen 90ziger des letzten Jahrhunderts <em>das</em> statistische Verfahren der Wahl. Wir brauchen daher die ANOVA aus mehreren Gründen. Die Hochzeiten der ANOVA sind eigentlich vorbei, wir haben in der Statistik für viele Fälle mittlerweile besser Werkzeuge, aber als Allrounder ist die ANOVA immer noch nutzbar. Insbesondere wenn wir uns mit einem faktoriellen Design beschäftigen, dann komt die Stärke der ANOVA voll zu tragen. Da wir in den agrarwissenschaften eben dann doch sehr viele Feldexperimente in einem faktoriellen Design vorliegen haben, hat auch die ANOVA ihren Platz in der praktischen Auswertung. Wir werden immer wieder in diesem Buch auf die ANOVA inhaltlich zurück kommen und in vielen Abschlussarbeiten wird die ANOVA immer noch als integraler Bestandteil genutzt.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Der ANOVA Pfad
</div>
</div>
<div class="callout-body-container callout-body">
<blockquote class="blockquote">
<p><em>“Patience, my children; one hour of suffering will bring more true happiness than a whole life of pleasure.” — <a href="https://en.wikipedia.org/wiki/The_Pathfinder,_or_The_Inland_Sea">The Pathfinder</a></em></p>
</blockquote>
<p>Ich nenne es immer liebevoll den ANOVA Pfad, was wir hier mit der ANOVA machen. Wir wollen eigentlich einen multiplen Gruppenvergleich rechnen. Dafür führen wir folgende Schritte durch.</p>
<ol type="1">
<li>Wir erstellen uns ein Modell mit einem Messwert <span class="math inline">\(y\)</span> und mindestens einem Faktor <span class="math inline">\(f\)</span>.</li>
<li>Wir rechnen auf dem Modell eine ANOVA um herauszufinden ob wir einen signfikanten Unterschied in den Gruppen vorliegen haben.</li>
<li>Wir rechnen einen Post-hoc Test um die signifikanten paarweisen Vergleiche in den Gruppen zu finden.</li>
</ol>
<p>Das ganze machen wir dann für <em>jeden</em> unserer Messwerte.</p>
</div>
</div>
<p>Was findest du in diesem Übersichtskapitel zur ANOVA? Wir werden uns in diesem Kapitel auf die einfaktorielle ANOVA (eng. <em>one-way ANOVA</em>) sowie die zweifaktorielle ANOVA (eng. <em>two-way ANOVA</em>) konzentrieren. Ich gehe dann auch noch auf ein mehrfaktorielles Modell ein. In dem <a href="stat-tests-ancova2.html">Kapitel zur ANCOVA</a> findest du dann alle Informationen, wenn du zusärtzlich zu deinen Faktoren noch eine numerische Kovariate mit in dein Modell nehmen willst. Häufig wird die ANOVA auch verwendet, wenn du Messwiederholungen in deinen Daten vorliegen hast. Hierfür habe ich dann das <a href="stat-tests-anova-mixed.html">Kapitel zur repeated &amp; mixed ANOVA</a> geschrieben, wo du dann einmal schauen musst. Am Ende kommt dann noch das <a href="stat-tests-anova-manova.html">Kapitel zur multivariate ANOVA</a>, wenn du simultan mehr als einen Messwert <span class="math inline">\(y\)</span> in dein Modell nehmen willst. Wie immer, du musst dann schauen, was zu deiner wissenschaftlichen Fragetstellung passt.</p>
<section id="allgemeiner-hintergrund" class="level2" data-number="31.1">
<h2 data-number="31.1" class="anchored" data-anchor-id="allgemeiner-hintergrund"><span class="header-section-number">31.1</span> Allgemeiner Hintergrund</h2>
<p>Fangen wir also mit der zentralen Idee der ANOVA an und arbeiten uns dann vor. Du kannst gerne den allgemeinen wie auch den theoretischen Teil überspringen und dir gleich das passende Datenbeispiel für deine Fragestellung raussuchen. Der Teil hier vorab dient nur dem tieferen Verständnis und du brauchst es eigentlich nicht um einfach nur eine ANOVA anzuwenden und ein Ergebnis zu erhalten. Da ist die ANOVA ziemlich gut zu interpretieren und anzuwenden. Wir fangen hier jetzt aber einmal an uns eine grundsätzliche Frage über unser experimentellen Versuch zu stellen.</p>
<dl>
<dt>Ist eine hohe Varianz in dem Messwert <span class="math inline">\(\boldsymbol{y}\)</span> zu vermeiden?</dt>
<dd>
<p>Es gibt eigentlich zwei Fehlannahmen (eng. <em>misconception</em>) an die ANOVA. Zum einen, dass die ANOVA die Varianzen vergleichen würde. Das stimmt nur bedingt. Die Nullhypothese der ANOVA ist die Gleichheit der Mittelwerte in den Gruppen. Zum anderen, dass wenig Varianz in den Messwerten <span class="math inline">\(y\)</span> per se gut wäre und ein angestrebtes Ziel in einem geplanten Feldexperiment.</p>
</dd>
</dl>
<p>In der folgenden Abbildung siehst du einmal vier Maisspflanzen mit jeweils einer Behandlung für ein gesteigertes Wachstum. In der linken Abbildung haben wir eine geringe Varianz und damit auch gleiche Mittelwerte. Die Behandlungen haben überhaupt keinen Einfluß auf den Wuchs. In der rechten Abbildung siehst du eine hohe Varianz, weil eben die Behandlungen einen Effekt auf das Wachstum haben. Wenn du also ein geplantes Experiment mit Kontrolle und Behandlungen durchführst, dann erwartest du eine hohe Varianz in dem Messwert <span class="math inline">\(y\)</span>. Ansonsten würde deine Behandlung überhaupt nicht wirken.</p>
<div id="fig-anova-intro" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-anova-intro-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/anova/anova_intro.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Abbildung&nbsp;31.1— Feldexperiment mit vier Behandlungen zur Steigerung der Wuchshöhe von Maispflanzen. Jede Pflanze stellt vereinfacht eine Behandlung dar. (A) Die gepoolte Varianz s^2_p über die Gruppen ist klein (s^2_p=0), die Behandlungen haben keinen Effekt auf das Wachstum. (B) Die gepoolte Varianz s^2_p über die Gruppen ist groß (s^2_p>0), die Behandlungen haben einen Effekt auf das Wachstum der Maisspflanzen."><img src="images/anova/anova_intro.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-anova-intro-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.1— Feldexperiment mit vier Behandlungen zur Steigerung der Wuchshöhe von Maispflanzen. Jede Pflanze stellt vereinfacht eine Behandlung dar. <strong>(A)</strong> Die gepoolte Varianz <span class="math inline">\(s^2_p\)</span> über die Gruppen ist klein (<span class="math inline">\(s^2_p=0\)</span>), die Behandlungen haben keinen Effekt auf das Wachstum. <strong>(B)</strong> Die gepoolte Varianz <span class="math inline">\(s^2_p\)</span> über die Gruppen ist groß (<span class="math inline">\(s^2_p&gt;0\)</span>), die Behandlungen haben einen Effekt auf das Wachstum der Maisspflanzen.
</figcaption>
</figure>
</div>
<p>Arbeiten wir uns nun einmal durch die Themen der Hypothesen sowie der Idee des faktoriellen Modells. Wir brauchen eine Idee des faktoriellen Modells um die verschiednen Typen der ANOVA unterscheiden zu können. Teilweise sind es eben dann nur Erweiterungen des immer gleichen Grundgerüst. Dann schauen wir nochmal auf die Voraussetzungen der ANOVA an deine Daten. Zum einen mit dem Fokus auf die Normalverteilung deines Messwert <span class="math inline">\(y\)</span> und zum anderen die Varianzhomogenität in deinen Faktoren. Bevor wir dann nochmal als Einschub die Theorie behandlen, stelle ich dir R Pakete vor, die dir die ANOVA rechnen können.</p>
<section id="das-modell" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="das-modell">Das Modell</h4>
<p>Beginnen wir also mit der Festlegung welche Art der Analyse wir rechnen wollen. Wichtig ist hier, dass du einen normmalverteiten Messwert <span class="math inline">\(y\)</span> vorliegen hast und ein oder mehrere Faktoren <span class="math inline">\(f\)</span>. Was sind im Kontext von R Faktoren? Ein Faktor ist eine Behandlung oder eben eine Spalte in deinem Datensatz, der verschiedene Gruppen oder Kategorien beinhaltet. Wir nennen diese Kategorien Level. In den folgenden Datenbeispielen ist die Spalte <code>animal</code> ein Faktor mit drei Leveln. Wir haben dort nämlich die Sprungweiten von drei Floharten gemessen. Jetzt kann es aber auch sein, dass du neben einem Faktor noch eine numeriche Kovariate <span class="math inline">\(c\)</span> gemessen hast. Oder aber du hast zwei Messwerte, die du dann gemeinsam mit einem Faktor vergleichen willst. Diese drei Analysetypen wollen wir uns in den folgenden Tabs mal näher anschauen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">ANOVA (faktoriell)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">ANCOVA (faktoriell und numerisch)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">MANOVA (multivariat)</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Das faktorielle Modell der klassischen ANOVA beinhaltet einen Messwert <span class="math inline">\(y\)</span>, der normalverteilt ist. Darüber hinaus haben wir noch ein bis mehrere Faktoren <span class="math inline">\(f\)</span>. Wir bezeichnen hier die Faktoren mit den Indizes <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span> und <span class="math inline">\(C\)</span> und die jeweiligen Level des Faktors <span class="math inline">\(A\)</span> als <span class="math inline">\(A.1, A.2,..., A.k\)</span>. Häufig haben wir aber zwei Faktoren in einem Modell mit zwei bis fünf Leveln. Aber hier gibt es sicherlich auch noch Fragestellungen mit mehr Gruppen und damit Leveln in einem Faktor. Wir schreiben ein faktorielles Modell wie folgt.</p>
<p><span class="math display">\[
y \sim f_A + f_B + ... + f_P + f_A \times f_B + ... + f_A \times f_B \times f_C
\]</span></p>
<p>mit</p>
<ul>
<li><span class="math inline">\(y\)</span> gleich dem Messwert oder Outcome</li>
<li><span class="math inline">\(f_A + f_B + ... + f_P\)</span> gleich experimenteller Faktoren</li>
<li><span class="math inline">\(f_A \times f_B\)</span> gleich einem beispielhaften Interaktionsterm erster Ordnung</li>
<li><span class="math inline">\(f_A \times f_B \times f_C\)</span> gleich einem beispielhaften Interaktionsterm zweiter Ordnung</li>
</ul>
<p>Zusätzlich können noch Interaktionsterme höherer Ordnungen entstehen, aber hier wird es extrem schwierig diese Interaktionsterme dann auch zu interpretieren. Ich würde grundsätzlich vermeiden Interaktionen zweiter und höherer Ordnungen mit ins Modell zu nehmen. Was genau eine Interaktion ist, besprechen wir in einem folgenden Abschnit. Um eine Interaktion beobachten zu können, brauchst du aber mindestens zwei Faktoren in deiner Analyse.</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Wenn wir neben einem bis mehreren Faktoren <span class="math inline">\(f\)</span> noch eine numerische Kovariate <span class="math inline">\(c\)</span> mit modellieren wollen, dann nutzen wir die ANCOVA (eng. <em>Analysis of Covariance</em>). Hier kommt dann immer als erstes die Frage, was heißt den Kovariate <span class="math inline">\(c\)</span>? Hier kannst du dir eine numerische Variable vorstellen, die ebenfalls im Experiment gemessen wird. Es kann das Startgewicht oder aber die kummulierte Wassergabe sein. Wir haben eben hier keinen Faktor als Kategorie vorliegen, sondern eben etwas numerisch gemessen. Daher ist unsere Modellierung etwas anders.</p>
<p><span class="math display">\[
y \sim f_A + f_B + ... + f_P + f_A \times f_B + c_1 + ... + c_p
\]</span></p>
<p>mit</p>
<ul>
<li><span class="math inline">\(y\)</span> gleich dem Messwert oder Outcome</li>
<li><span class="math inline">\(f_A + f_B + ... + f_P\)</span> gleich experimenteller Faktoren</li>
<li><span class="math inline">\(f_A \times f_B\)</span> gleich einem beispielhaften Interaktionsterm erster Ordnung</li>
<li><span class="math inline">\(c_1 + ... + c_p\)</span> gleich einer oder mehrer numerischer Kovariaten</li>
</ul>
<p>Hier muss ich gleich die Einschränkung machen, dass wir <em>normalerweise</em> maximal ein zweifaktorielles Modell mit einem Faktor <span class="math inline">\(A\)</span> und einem Faktor <span class="math inline">\(B\)</span> sowie einer Kovariate <span class="math inline">\(c\)</span> betrachten. Sehr selten haben wir mehr Faktoren oder gar Kovariaten in dem Modell. Wenn das der Fall sein sollte, dann könnte eine andere Modellierung wie eine multiple Regression eine bessere Lösung sein. Mehr Informationen zur der Berechnung findest du in dem <a href="stat-tests-ancova2.html">Kapitel zur ANCOVA</a></p>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>Am Ende des Kapitels schauen wir uns noch einen weiteren Spezialfall an. Nämlich den Fall, dass wir nicht nur einen Messwert <span class="math inline">\(y\)</span> vorliegen haben sondern eben mehrere die wir simultan auswerten wollen. Das klingt jetzt erstmal etwas schräg, aber es wird dann klarer, wenn wir uns die Sachlage einmal an einem Beispiel anschauen.</p>
<p><span class="math display">\[
(y_1, y_2, ..., y_j) \sim f_A + f_B + ... + f_P + f_A \times f_B
\]</span></p>
<p>mit</p>
<ul>
<li><span class="math inline">\((y_1, y_2)\)</span> gleich der Messwerte oder Outcomes</li>
<li><span class="math inline">\(f_A + f_B + ... + f_P\)</span> gleich experimenteller Faktoren</li>
<li><span class="math inline">\(f_A \times f_B\)</span> gleich einem beispielhaften Interaktionsterm erster Ordnung</li>
</ul>
<p>Die ganze multivariate Analyse ist dann etwas seltener, da wir hier dann doch schon einiges an Fallzahl brauchen, damit es dann auch einen Sinn macht. Einiges an Fallzahl heißt dann hier, dass wir dann schon mehr als sechs Beobachtungen in einer Gruppe haben sollten. Wenn du weniger hast, kann es sein, dass du keine signifikanten Unterschiede findest. Mehr Informationen zur der Berechnung findest du in dem <a href="stat-tests-anova-manova.html">Kapitel zur MANOVA</a></p>
</div>
</div>
</div>
<p>Daneben gibt es natürlich noch Spezialfälle wie die gemischte ANOVA (eng. <em>mixed ANOVA</em>), wenn wir Beobachtungen wiederholt messen. Dieses Modell schauen wir uns dann auch nochmal an. Der Unterschied in der Modellierung ist ein Fehlerterm (eng. <em>Error</em>), den wir dann nochmal mit angeben müssen. Dazu dann aber mehr in dem <a href="stat-tests-anova-mixed.html">Kapitel zur repeated &amp; mixed ANOVA</a>.</p>
</section>
<section id="hypothesen" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="hypothesen">Hypothesen</h4>
<p>Wenn wir von der ANOVA sprechen, dann kommen wir natürlich nicht an den Hypothesen vorbei. Die ANOVA ist ja auch ein klassischer statistischer Test. Hier müssen wir unterscheiden, ob wir eine Behandlung mit zwei Gruppen, also einem Faktor <span class="math inline">\(A\)</span> mit <span class="math inline">\(2\)</span> Leveln vorliegen haben. Oder aber eine Behandlung mit drei oder mehr Gruppen vorliegen haben, also einem Faktor <span class="math inline">\(A\)</span> mit <span class="math inline">\(\geq 3\)</span> Leveln in den Daten haben. Da wir schnell in einer ANOVA mehrere Faktoren haben, haben wir auch schnell viele Hypothesen zu beachten. Jeweils ein Hypothesenpaar pro Faktor muss dann betrachtet werden. Das ist immer ganz wichtig, die Hypothesenpaare sind unter den Faktoren mehr oder minder unabhängig.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Faktor mit <span class="math inline">\(2\)</span> Leveln</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Faktor mit <span class="math inline">\(\geq 3\)</span> Leveln</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Bei einem Faktor <span class="math inline">\(A\)</span> mit nur zwei Leveln <span class="math inline">\(A.1\)</span> und <span class="math inline">\(A.2\)</span> haben wir eine Nullhypothese, die du schon aus den Gruppenvergleichen wie dem t-Test kennst. Wir wollen zwei Mittelwerte vergleichen und in unserer Nullhypothese steht somit die Gleichheit. Da wir nur zwei Gruppen haben, sieht die Nullhypothese einfach aus.</p>
<p><span class="math display">\[
H_0: \; \bar{y}_{A.1} = \bar{y}_{A.2}
\]</span></p>
<p>In der Alternativehypothese haben wir dann den Unterschied zwischen den beiden Mittelwerten. Wenn wir die Nullhypothese ablehnen können, dann wissen wir auch welche Mittelwertsunterschied signifikant ist. Wir haben ja auch nur einen Unterschied getestet.</p>
<p><span class="math display">\[
H_A: \; \bar{y}_{A.1} \neq \bar{y}_{A.2}
\]</span> Das Ganze wird dann etwas komplexer im Bezug auf die Alternativehypothese wenn wir mehr als zwei Gruppen haben. Hier kommt dann natürlich auch die Stärke der ANOVA zu tragen. Eben mehr als zwei Mittelwerte vergleichen zu können.</p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Die klassische Nullhypothese der ANOVA hat natürlich mehr als zwei Level. Hier einmal beispielhaft die Nullhypothese für den Vergleich von drei Gruppen des Faktors <span class="math inline">\(A\)</span>. Wir wollen als Nullhypothese testen, ob alle Mittelwerte der drei Gruppen gleich sind.</p>
<p><span class="math display">\[
H_0: \; \bar{y}_{A.1} = \bar{y}_{A.2} = \bar{y}_{A.3}
\]</span></p>
<p>Wenn wir die Nullhypothese betrachten dann sehen wir auch gleich das Problem der Alternativehypothese. Wir haben eine Menge an paarweisen Vergleichen. Wenn wir jetzt die Nullhypothese ablehnen, dann wissen wir nicht welcher der drei paarweisen Mittelwertsvergleiche denn nun unterschiedlich ist. Praktisch können es auch alle drei oder eben zwei Vergleiche sein.</p>
<p><span class="math display">\[
\begin{aligned}
H_A: &amp;\; \bar{y}_{A.1} \ne \bar{y}_{A.2}\\
\phantom{H_A:} &amp;\; \bar{y}_{A.1} \ne \bar{y}_{A.3}\\
\phantom{H_A:} &amp;\; \bar{y}_{A.2} \ne \bar{y}_{A.3}\\
\phantom{H_A:} &amp;\; \mbox{für mindestens einen Vergleich}
\end{aligned}
\]</span></p>
<p>Wenn wir die Nullhypothese abgelhent haben, dann müssen wir noch einen sogenannten Post-hoc Test anschließen um die paarweisen Unterschiede zu finden, die dann signifikant sind. Das ganze machen wir dann aber in einem eigenen Kapitel zum Post-hoc Test.</p>
</div>
</div>
</div>
</section>
<section id="normalverteilung-und-varianzhomogenität" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="normalverteilung-und-varianzhomogenität">Normalverteilung und Varianzhomogenität</h4>
<blockquote class="blockquote">
<p><em>“Soll ich’s wirklich machen oder lass ich’s lieber sein? Jein…” — Fettes Brot, Jein</em></p>
</blockquote>
<p>Wenn wir die ANOVA nutzen wollen, dann kommen wir um die Voraussetzungen der Normalverteilung an den Messwert <span class="math inline">\(y\)</span> sowie die Varianzhomogenität in den Faktorleveln oder Behandlungsgruppen <span class="math inline">\(f\)</span> nicht herum. In dem <a href="stat-tests-pretest2.html">Kapitel zum Pre-Test oder Vortest</a> gehe ich nochmal detailierter auf mögliche Tests auf die Normalverteilung und die Varianzhomogenität ein. In diesem Kapitel findest du in dem Abschnitt <a href="#sec-anova-test-pre">Test auf Normalverteilung und Varianzhomogenität</a> einmal ein Vorgehen für das Testen der Annahmen. Ich würde davon allgemein abraten, aber es wird immer wieder verlangt, also stelle ich es hier auch vor. Kurzfassung, die ANOVA ist realtiv robust gegen eine Abweichung von der Normalverteilung der Messwerte. Ebenso kann die ANOVA mit leichter Varianzheterogenität umgehen.</p>
<p>Häufig kommt jetzt die Frage, ob mein Messwert <span class="math inline">\(y\)</span> wirklich normalverteilt ist und ich nicht den Messwert auf Normalverteilung testen sollte. Die kurze Antwort lautet nein, da du meistens zu wenig Beobachtungen pro Gruppe vorliegen hast. Die etwas längere liefert <span class="citation" data-cites="kozak2018s">Kozak &amp; Piepho (<a href="#ref-kozak2018s" role="doc-biblioref">2018</a>)</span> mit dem Artikel <a href="https://onlinelibrary.wiley.com/doi/pdf/10.1111/jac.12220?casa_token=22Jm83-kW-MAAAAA:yh0EVuGiGHWDsuPiVP8ZLj51OCasdpIiVWUcYv3Q8dGaIo0yMeNZNwkHIk1ibTCsLhkxbLKZrwZSByo">What’s normal anyway? Residual plots are more telling than significance tests when checking ANOVA assumptions</a>.</p>
<p>Kommen wir nun zur Varianzhomogenität oder Varianzhterogenität in den Gruppen des Behandlunsgfaktors. Wir betrachten also meistens nur den wichtigen Faktor <span class="math inline">\(f_A\)</span> und ignorieren ein wenig den zwieten Faktor. Prinzipiell kannst du natürlich auch den zweiten Fakto anschauen, aber dann werden es immer mehr Gruppen und Fakotrkombinationen. Am Ende kommt dann sowieso heraus, dass über alle Gruppen hinweg keine homogenen Varianzen vorliegen. Wenn du mehr lesen willst so gibt es auf der Seite DSFAIR noch einen Artikel zu <code>{emmeans}</code> und der Frage <a href="https://schmidtpaul.github.io/dsfair_quarto/ch/summaryarticles/whyseequal.html">Why are the StdErr all the same?</a></p>
<dl>
<dt>Wann liegt vermutlich Varianzheterogenität in deinen experimentellen Faktoren <span class="math inline">\(f\)</span> vor?</dt>
<dd>
<p>Es gibt so ein paar Daumenregeln, die dir helfen abzuschätzen, ob in deinen Gruppen Varianzheterogenität vorliegt. Um es kurz zu machen, vermutlich hast du mindestens leichte Varianzhterogenität in den Daten vorliegen.</p>
</dd>
</dl>
<ol type="1">
<li>Du hat viele Behandlungsgruppen. Je mehr Gruppen du hast oder eben dann auch Faktorkombinationen, die du testen möchtest, desto wahrscheinlicher wird es, dass mindestens eine Gruppe eine unterschiedliche Varianz hat. Du hast Varianzheterogenität vorliegen.</li>
<li>Du misst deine Gruppen über die Zeit. Je größer, schwerer oder allgemein höher ein Messwert wird, desto größer wird auch die Varianz. Schaust du dir deine Messwerte über die Zeit an hast du meistens Varianzheterogenität vorliegen.</li>
<li>Deine Kontrolle ohne Behandlung verhält sich meistens nicht so, wie die Gruppen, die eine Behandlung erhalten haben. Wenn du nichts machst in deiner negativen Kontrolle, dann hast du meistens eine andere Streuung der Messwerte als unter einer Behandlung.</li>
<li>Diene Behandlungen sind stark unterschiedlich. Wenn deine Behandlungen sich biologisch oder chemisch in der Wirkung unterscheiden, denn werden vermutlich deine Messwerte auch anders streuen. Hier spielt auch die Anwendung der Behandlung und deren Bereitstellung eine Rolle. Wenn was nicht gleich ist, dann wird es vermutlich nicht gleiche Messwerte erzeugen.</li>
<li>Du hast wenig Fallzahl pro Gruppe oder Faktorkombination. Wenn du wenig Fallzahl in einer Gruppe hast, dann reicht schon eine (zufällige) Messabweichung und schon sind deine Varianzen heterogen.</li>
</ol>
<p>Gut, jetzt wissen wir, dass du <em>vermutlich</em> Varianzheterogenität in deinen Daten vorliegen hast. Erstmal ist das kein so großes Problem.</p>
<dl>
<dt>Tut Varianzhterogenität anstatt Varianzhomogenität weh?</dt>
<dd>
<p>Nein. Meistens ist die Varianzheterogenität nicht so ausgeprägt, dass du nicht auch eine ANOVA rechnen kannst. Über alle Gruppen hinweg wird dann zwar in einer ANOVA die Varianz gemmittelt und es kann dann zu weniger signifkanten Ergebnissen führen, aber so schlimm ist es nicht. Im Post-hoc Test solltest du aber die Varianzhterogenität berücksichtigen, da du ja immer nur zwei Gruppen gleichzeitig betrachtest.</p>
</dd>
</dl>
</section>
<section id="welche-pakete-gibt-es-eigentlich" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="welche-pakete-gibt-es-eigentlich">Welche Pakete gibt es eigentlich?</h4>
<p>Wenn um die Anwendung der ANOVA in R geht, dann haben wir eine Menge Pakete zur Auswahl. Wie immer macht die Fragestellung und das gewählte Modell den Großteil der Entscheidungsindung aus. Ich zeige dir später in der Anwendung dann auch alle Pakete einmal, gebe dir dann aber auch immer eine Empfehlung mit. In der folgenden Tabelle gebe ich dir einmal eine kurze Übersicht über die beiden Annahmen an die ANOVA. Normalerweise brauchen wir einen normalverteilten Messwert <span class="math inline">\(y\)</span> und Varianzhomogenität in den Faktoren. In den letzten Jahren wurden aber noch weitere Implementierungen der ANOVA entwickelt, so dass hier auch Alternativen vorliegen.</p>
<div id="tbl-anova-übersicht" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-anova-übersicht-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;31.1— Übersicht über Funktion der ANOVA in ausgewählten Paketen und Excel. Die Aussagen sind nicht als absolut zu verstehen sondern eher als Empfehlung und Leitplanken zur Orientierung.
</figcaption>
<div aria-describedby="tbl-anova-übersicht-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 37%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;"><code>{base}</code></th>
<th style="text-align: center;"><code>{car}</code></th>
<th style="text-align: center;"><code>{afex}</code></th>
<th style="text-align: center;"><code>{WRS2}</code></th>
<th style="text-align: center;">Excel</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Normalverteilt</strong> <span class="math inline">\(y\)</span></td>
<td style="text-align: center;">ja</td>
<td style="text-align: center;">ja</td>
<td style="text-align: center;">ja</td>
<td style="text-align: center;">nein</td>
<td style="text-align: center;">ja</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Varianzhomogenität</strong> <span class="math inline">\(f\)</span></td>
<td style="text-align: center;">ja</td>
<td style="text-align: center;">optional</td>
<td style="text-align: center;">ja</td>
<td style="text-align: center;">nein</td>
<td style="text-align: center;">ja</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Messwiederholungen</strong></td>
<td style="text-align: center;">nein</td>
<td style="text-align: center;">nein</td>
<td style="text-align: center;">ja</td>
<td style="text-align: center;">ja</td>
<td style="text-align: center;">nein</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Gehen wir jetzt mal die Pakete durch. Wir immer gibt es einiges an Möglichkeiten und ich zeige dir hier eben die Auswahl. Es gibt hier das ein oder andere noch zu beachten, aber da gehe ich dann bei den jeweiligen Methoden drauf ein. Es macht eben dann doch einen Unterschied ob ich eine einfaktorielle oder komplexere ANOVA rechnen will. Nicht alles geht in allen R Pakten oder gar Excel.</p>
<dl>
<dt>Der Standard mit der Funktion <code>aov()</code> aus <code>{base}</code></dt>
<dd>
<p>Die Standardfunktion <code>aov()</code> erlaubt es eine einfaktorielle oder zweifaktorielle ANOVA direkt auf einem Datensatz zu rechnen. Hier brauchen wir nur ein Modell in der in R üblichen Formelschreibweise <code>y ~ f</code>. Du kannst diesen Ansatz als schnelle ANOVA begreifen. Dein Messwert <span class="math inline">\(y\)</span> muss hier normalverteilt sein.</p>
</dd>
<dt>Der erweiterte Standard mit der Funktion <code>anova()</code> aus <code>{base}</code></dt>
<dd>
<p>Die Funktion <code>anova()</code> erlaubt es auch auf anderen Modellen eine ANOVA zu rechnen. Wi nutzen hier die Funktion <code>lm()</code>, die einen normalverteilten Messwert <span class="math inline">\(y\)</span> annimmt. Es ginge aber auch mit anderen Modellierungen und der Funktion <code>glm()</code> für Zähldaten einer Possionverteilung oder noch anderen Verteilungen. Die <code>anova()</code> Funktion ist sehr reudziert, tut aber im Sinne einer ANOVA was die Funktion machen soll.</p>
</dd>
<dt>Mit der Funktion <code>Anova()</code> aus <code>{car}</code></dt>
<dd>
<p>Das <a href="https://cran.r-project.org/web/packages/car/index.html">R Paket <code>{car}</code></a> bietet eine Verbesserung der Standardfunktionen der ANOVA an. Insbesondere die Berücksichtigung und die Modellierung eines Interaktionseffektes in einer zweifaktoriellen ANOVA sticht heraus. Daher ist die Funktion hier etwas flexibeler als der Standard. In einer einfaktoriellen ANOVA bemerkst du keinen Unterschied.</p>
</dd>
<dt>Mit den ANOVA Funktionen aus <code>{afex}</code></dt>
<dd>
<p>Wir können die ANOVA auch anwenden, wenn wir Messwiederholungen vorliegen haben. Daher bietet sich hier das <a href="https://github.com/singmann/afex">R Paket <code>{afex}</code></a> an. Du musst bei den Funktionen von <code>{afex}</code> immer eine ID mitlaufen lassen, die angibt welche Individuen wiederholt gemessen wurden. Also hat jede Zeile eine Nummer, die beschreibt welche Beobachtung hier vorliegt. Besonders wichtig bei Messungen über die Zeit. Darüber hinaus kann das Paket sehr gut Interaktionen schätzen und Bedarf dort keiner zusätzlichen Optionen.</p>
</dd>
</dl>
<blockquote class="blockquote">
<p><em>“ANOVAs are generally robust to ‘light’ heteroscedasticity, but there are various other methods (not available in <code>{afex}</code>) for getting robust error estimates.”</em> — <a href="https://cran.r-project.org/web/packages/afex/vignettes/assumptions_of_ANOVAs.html">Testing the Assumptions of ANOVAs</a></p>
</blockquote>
<p>Das Paket <code>{afex}</code> kann nicht mit Varianzheterogenität umgehen, aber dafür mit Messwiederholungen. Ich würde das Paket <code>{afex}</code> nehmen, wenn ich Messwiederholungen vorliegen habe oder mich die Interaktion in einem zweifaktoriellen Modell interessiert.</p>
<dl>
<dt>Mit den ANOVA Funktionen aus <code>{WRS2}</code></dt>
<dd>
<p>Eine Annahme an die ANOVA ist, dass wir es mit normalverteilten Messwerten <span class="math inline">\(y\)</span> sowie Varianzhomogenität in den Faktoren <span class="math inline">\(f\)</span> vorliegen haben. Das R Paket <code>{WRS2}</code> mit der hervorragenden Vingette <a href="https://cran.r-project.org/web/packages/WRS2/vignettes/WRS2.pdf">Robust Statistical Methods Using WRS2</a> erlaubt nun aber diese beiden Annahmen zu umgehen und bietet eine robuste ANOVA an. Robust meint hier, dass wir uns nicht um die Normalverteilung und Varianzhomogenität kümmern müssen.</p>
</dd>
<dt>Mit Excel</dt>
<dd>
<p>Hier muss ich sagen, dass es schon etwas weh tut die einfaktorielle und zweifaktorielle ANOVA in Excel zu rechnen. Ich habe dir bei der einfaktoriellen sowie der zweifaktoriellen ANOVA ein Video für die ANOVA in Excel ergänzt. Eigentlich ist es nur der letzte Strohhalm, wenn du keine Zeit mehr hast dich in R nochmal einzuarbeiten.</p>
</dd>
</dl>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Weitere Tutorien für die ANOVA
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wir oben schon erwähnt, kann dieses Kapitel nicht alle Themen der ANOVA abarbeiten. Daher präsentiere ich hier eine Liste von Literatur und Links, die mich für dieses Kapitel hier inspiriert haben. Nicht alles habe ich genutzt, aber vielleicht ist für dich was dabei.</p>
<ul>
<li><a href="https://www.datanovia.com/en/lessons/anova-in-r/">ANOVA in R</a></li>
<li><a href="https://www.sthda.com/english/wiki/one-way-anova-test-in-r">One-Way ANOVA Test in R</a></li>
<li><a href="https://www.sthda.com/english/wiki/two-way-anova-test-in-r">Two-Way ANOVA Test in R</a></li>
<li><a href="https://www.sthda.com/english/wiki/manova-test-in-r-multivariate-analysis-of-variance">MANOVA Test in R: Multivariate Analysis of Variance</a></li>
<li><a href="https://www.scribbr.com/statistics/anova-in-r/">ANOVA in R | A Complete Step-by-Step Guide with Examples</a></li>
</ul>
</div>
</div>
</section>
</section>
<section id="theoretischer-hintergrund" class="level2" data-number="31.2">
<h2 data-number="31.2" class="anchored" data-anchor-id="theoretischer-hintergrund"><span class="header-section-number">31.2</span> Theoretischer Hintergrund</h2>
<p>Im folgenden Abschnitt schauen wir uns einmal den theoretischen Hintergrund zu der ANOVA an. Ich fokusiiere mich hier einmal für die Theorie auf die einfaktorielle ANOVA. Die Prinzipien lassen sich dann auch auf die zweifaktorielle und mehrfaktoriellen Algorithmen der ANOVA anwenden. Was dann später noch dazukommt sind dann die Interaktionen. Dabei ist zu bachten, dass wir natürlich eine Interaktion nur in einem zweifaktoriellen Modell beobachten können. Daher hier der Start mit der einfaktoriellen ANOVA und dann die Vertiefung zur Interaktion mit der zweifaktoriellen ANOVA.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/angel_01_small.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="images/angel_01_small.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p><em>In der ersten Version dieses Kapitels habe ich noch sehr viel beispielhaft für eine einfaktorielle ANOVA durchgerechnet. Wie sich dann in den Jahren herausstellte, hat es dir wenig geholfen, die ANOVA zu verstehen oder anzuwenden. Wer rechnet schon die ANOVA per Hand? Daher hier eben das klassische</em> <a href="https://en.wikipedia.org/wiki/Lie-to-children">lying-to-children</a>* und ich erkläre dir die ANOVA mehr konzeptionell als rein mathematisch korrekt.*</p>
</blockquote>
</div>
</div>
</div>
<p>Wir müssen jetzt einmal für dei Haupteffekte eines Faktors <span class="math inline">\(A\)</span> oder <span class="math inline">\(B\)</span> unterschieden sowie deren Interaktion untereinander. Deshalb besprechen wir jetzt erstmal einen Haupteffekt eines Faktors <span class="math inline">\(A\)</span> mit drei Levels <span class="math inline">\(A.1\)</span>, <span class="math inline">\(A.2\)</span> sowie <span class="math inline">\(A.3\)</span> und arbeiten uns dann vor. Ich habe auf großartige Mathematik und Formeln verzichtet. Du findest die entsprechenden händischen Rechenoperation auf Wikipedia oder in einem entsprechenden statistischen <a href="https://s3-us-west-2.amazonaws.com/mtvernon.wsu.edu/uploads/2016/12/Statistics_for_Terrified_Biologists.pdf">Lehrbuch zur ANOVA und Statistik</a> wie das verlinkte Buch von <span class="citation" data-cites="van2019statistics">Van Emden (<a href="#ref-van2019statistics" role="doc-biblioref">2019</a>)</span>.</p>
<section id="haupteffekte-f_a" class="level3" data-number="31.2.1">
<h3 data-number="31.2.1" class="anchored" data-anchor-id="haupteffekte-f_a"><span class="header-section-number">31.2.1</span> Haupteffekte <span class="math inline">\(f_A\)</span></h3>
<p>Für die Theorie konzentrieren wir uns nur auf die einfaktoriele ANOVA. Das heißt wir haben einen Faktor <span class="math inline">\(A\)</span> mit drei Levels <span class="math inline">\(A.1\)</span>, <span class="math inline">\(A.2\)</span> sowie <span class="math inline">\(A.3\)</span> vorliegen. Du kannst dir die drei Level als drei Gruppen vorstellen. Entweder sind es verschiedene Düngestufen oder aber eben drei Floharten, die unterschiedlich weit springen. Erinnere dich nochmal an die <a href="#fig-anova-intro" class="quarto-xref">Abbildung&nbsp;<span>31.1</span></a> zu Beginn des Kapitels. Wir wollen in unseren Daten Varianz haben, denn nur dann haben wir auch wirklich einen Unterschied zwischen den Gruppen in unserer Behandlung. Fangen wir also mit der wichtigste Frage einmal an.</p>
<dl>
<dt>Wann sind drei oder mehr Mittelwerte gleich?</dt>
<dd>
<p>Für unseren Gedankengang nehmen wir mal drei Mittelwerte für die drei Gruppen <span class="math inline">\(A.1\)</span>, <span class="math inline">\(A.2\)</span> sowie <span class="math inline">\(A.3\)</span> an. Wir brauchen ja in der Nullhypothese Gleichheit. Das heißt, dass alle drei Mittelwerte <span class="math inline">\(\bar{y}_{A.1}\)</span>, <span class="math inline">\(\bar{y}_{A.2}\)</span> und <span class="math inline">\(\bar{y}_{A.3}\)</span> gleich sein müssen. Wir nennen diese Mittelwerte der Gruppen daher auch lokale Mittelwerte. Wir können also wie folgt schreiben.</p>
</dd>
</dl>
<p><span class="math display">\[
\bar{y}_{A.1} = \bar{y}_{A.2} = \bar{y}_{A.3}
\]</span></p>
<p>Jetzt kommt der eigentlich Hauptgedanke. Wir können auch einen globalen Mittelwert <span class="math inline">\(\beta_0\)</span> berechnen in dem wir die drei Mittelwerte mitteln oder aber den Faktor vergessen und über alle Beobachtungen den Mittelwert berechnen. Wenn wir mehr Mittelwerte oder eben Gruppen haben, dann ändert sich natürlich der Nenner.</p>
<p><span class="math display">\[
\beta_0 = \cfrac{\bar{y}_{A.1} + \bar{y}_{A.2} + \bar{y}_{A.3}}{3}
\]</span></p>
<p>Wenn die drei Mittelwerte gleich sind, dann ist auch das globale Mittel <span class="math inline">\(\beta_0\)</span> gleich der drei Mittelwerte. Das klingt jetzt erstmal etwas schräg, aber wir hätten dann folgenden Zusammenhang. Aber das ist eigentlich was wir brauchen. Eine statistische Maßzahl, die Null ist, wenn Gleichheit in den Gruppen vorherrscht.</p>
<p><span class="math display">\[
\mbox{Wenn}\; \beta_0 = 0\; \mbox{dann}\; \bar{y}_{A.1} = \bar{y}_{A.2} = \bar{y}_{A.3}
\]</span></p>
<p>In der folgenden <a href="#fig-ggplot-anova-intro-null" class="quarto-xref">Abbildung&nbsp;<span>31.2</span></a> wird dir es vielleicht nochmal klarer. Wir haben hier einmal den globalen Mittelwert <span class="math inline">\(\beta_0\)</span> sowie von lokalen Mittelwerten <span class="math inline">\(\bar{y}_{A.1}\)</span>, <span class="math inline">\(\bar{y}_{A.2}\)</span> und <span class="math inline">\(\bar{y}_{A.3}\)</span> der einzelen Gruppen des Faktors <span class="math inline">\(A\)</span> dargsstellt. In der linken Abbildung siehst du, dass die lokalen Mittelwerte der Gruppen alle auf einer Höhe liegen. Die Mittelwerte der Gruppen sind gleich. Es gibt keinen Uterschied. Darüber hinaus sind die Abstände der lokalen Mittelwerte zum gloabeln Mittelwert Null. Die Nullhypothese gilt.</p>
<p>Wenn sich jetzt die lokalen Mittelwerte untereinander unterscheiden, dann liegen die lokalen Mittelwerte nicht mehr auf einer Ebene. Damit entstehen auch positive und negative Abstände von den lokalen Mittelwerten zu dem globalen Mittelwert. Diese Abstände sind nämlich jetzt nicht mehr Null. Daher haben wir auch nicht mehr Gleichkeit vorliegen. Wir können daher die Nullhypothese ablehnen. Je größer die Abstände der lokalen Mittelwerte zum globalen Mittelwert werden, desto mehr würden wir die Nullhypothese ablehnen und an einen Gruppenunterschied glauben.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-anova-intro-null" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-anova-intro-null-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-ggplot-anova-intro-null-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Abbildung&nbsp;31.2— Zusammenhang zwischen dem globalen Mittelwert \beta_0 und den drei Mittelwerten \bar{y}_{A.1}, \bar{y}_{A.2} und \bar{y}_{A.3} der Gruppen A.1, A.2 sowie A.3. (A) Wenn die drei Mittelwerte gleich sidn und damit die Nullhypothese gilt, dann liegen die drei Mittelwerte auf dem globalen Mittelwert. (B) Wenn die drei Mittelwerte sich unterschieden, dann kann die Nullhypothese abgelehnt werden und die drei Mittelwerte liegen nicht auf dem globalen Mittel. [Zum Vergrößern anklicken]"><img src="stat-tests-anova2_files/figure-html/fig-ggplot-anova-intro-null-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="720"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-anova-intro-null-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.2— Zusammenhang zwischen dem globalen Mittelwert <span class="math inline">\(\beta_0\)</span> und den drei Mittelwerten <span class="math inline">\(\bar{y}_{A.1}\)</span>, <span class="math inline">\(\bar{y}_{A.2}\)</span> und <span class="math inline">\(\bar{y}_{A.3}\)</span> der Gruppen <span class="math inline">\(A.1\)</span>, <span class="math inline">\(A.2\)</span> sowie <span class="math inline">\(A.3\)</span>. <strong>(A)</strong> Wenn die drei Mittelwerte gleich sidn und damit die Nullhypothese gilt, dann liegen die drei Mittelwerte auf dem globalen Mittelwert. <strong>(B)</strong> Wenn die drei Mittelwerte sich unterschieden, dann kann die Nullhypothese abgelehnt werden und die drei Mittelwerte liegen nicht auf dem globalen Mittel. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Damit haben wir jetzt das zentrale Prinzip der ANOVA verstanden. Es geht um die Abstände von lokalen Gruppenmittelwerten zu einem globalen Mittelwert über alle Gruppen.</p>
<dl>
<dt>Wie werden die Abstände von den lokalen Mittelwert zum globalen Mittelwert berechnet?</dt>
<dd>
<p>Nun könnten wir einfach sagen, dass wenn die aufsummierten Abstände nicht Null sind, wir einen Effekt in den Gruppen vorliegen haben. Hier tritt wieder das Problem auf, dass wir positive Abweichung und negative Abweichungen von den lokalen Mittelwerten zu dem gloablen mittelwert haben. Daher berechnen wir nicht die Abstände sondern die quadratischen Abstände und summieren diese dann auf. Wir berechnen die Abweichungsquadrate (eng. <em>sum of squares</em>, abk. <em>SS</em>). Daher sagen wir auch, dass die Abstände der lokalen Mittelwerte zum globalen Mittel als Abweichungsquadrate berechnet werden. In der folgenden Abbildung siehst du einmal die Visualsierung der Berechnung der Abweichungsquadrate des Faktors <span class="math inline">\(A\)</span> oder eben <span class="math inline">\(SS_A\)</span>.</p>
</dd>
</dl>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-anova-intro-alt-ssa" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-anova-intro-alt-ssa-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-ggplot-anova-intro-alt-ssa-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Abbildung&nbsp;31.3— Visualsierung der Berechnung der Abweichungsquadrate des Faktors A als SS_A bezeichnet. Für jede Beobachtung wird einmal der Abstand des lokalen Mittelwerts der Gruppe zum globalen Mittelwert berechnet und quadriert. Die Abstände werden dann aufsummiert."><img src="stat-tests-anova2_files/figure-html/fig-ggplot-anova-intro-alt-ssa-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="720"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-anova-intro-alt-ssa-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.3— Visualsierung der Berechnung der Abweichungsquadrate des Faktors <span class="math inline">\(A\)</span> als <span class="math inline">\(SS_A\)</span> bezeichnet. Für jede Beobachtung wird einmal der Abstand des lokalen Mittelwerts der Gruppe zum globalen Mittelwert berechnet und quadriert. Die Abstände werden dann aufsummiert.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Jetzt tritt aber wiederum ein anderes Problem auf. Je mehr Gruppen wir haben, desto größer werden unsere Abweichungsquadrate. Deshalb mitteln wir auch die Abweichungsquadrate um die mittleren Abweichungsquadrate (eng. <em>mean of squares</em>, abk. <em>MS</em>) zu erhalten. Jetzt könnten wir natürlich sagen, wenn <span class="math inline">\(MS_A\)</span> gleich Null ist, dann können wir die Nullhypothese nicht ablehnen. Aber hier nochmal ein kurzer Einwurf zur Teststatistik.</p>
<dl>
<dt>Wie sieht eine Teststatistik aus?</dt>
<dd>
<p>Eine Teststatistik teilt immer den Effekt (<em>signal</em>) durch die Streuung des Effekts (<em>noise</em>). Dabei muss eine Teststatistik Null sein, wenn die Nullhypothese gilt. Daher haben wir dann folgenden Zusammenhang.</p>
</dd>
</dl>
<p><span class="math display">\[
T_D = \cfrac{\mbox{signal}}{\mbox{noise}} = \cfrac{\mbox{Effekt}}{\mbox{Streuung}}
\]</span></p>
<p>In unserem Fall wäre dann der Effekt die mittleren Abweichungsquadrate des Faktors A also <span class="math inline">\(MS_A\)</span>. Das passt auch in soweit, dass wenn die mittlere Abweichung der lokalen Mittelwerte zum globalen Mittelwert Null ist, dann können wir die Nullhypothese nicht ablehnen. Es fehlt also noch ein statistisches Maß für die Streuung.</p>
<p>Wir haben aber noch die Streuung <em>innerhalb</em> der einzelnen Gruppen. Diese Streuung innerhalb der Gruppen nennen wir gerne Reststreuung, da diese nicht von den Gruppen erklärt wird. Oder aber ganz kurz, den Fehler (eng. <em>error</em>). Wir berechnen also nochmal die quadrierten Abstände der einzelnen Beobachtungen um die jeweiligen Gruppenmittelwerte und nennen diese dann <span class="math inline">\(SS_{Error}\)</span>. Dann summieren wir die quadrierten Abstände einmal auf, wie du in der folgenden Abbildung einmal sehen kannst. Am Ende mitteln wir auch die quadratische Abweichung der Fehler zu <span class="math inline">\(MS_{Error}\)</span> umd die mittlere Abweichung der einzelnen Beobachtungen zu den lokalen Mittelwerten darzustellen.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-anova-intro-alt-sse" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-anova-intro-alt-sse-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-ggplot-anova-intro-alt-sse-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Abbildung&nbsp;31.4— Visualsierung der Berechnung der Abweichungsquadrate des Fehlers Error als SS_{Error} bezeichnet. Für jede Beobachtung wird einmal der Abstand zum lokalen Mittelwert der Gruppe berechnet und quadriert. Die Abstände werden dann aufsummiert."><img src="stat-tests-anova2_files/figure-html/fig-ggplot-anova-intro-alt-sse-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="720"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-anova-intro-alt-sse-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.4— Visualsierung der Berechnung der Abweichungsquadrate des Fehlers <span class="math inline">\(Error\)</span> als <span class="math inline">\(SS_{Error}\)</span> bezeichnet. Für jede Beobachtung wird einmal der Abstand zum lokalen Mittelwert der Gruppe berechnet und quadriert. Die Abstände werden dann aufsummiert.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In der folgenden Tabelle siehst du nochmal die wichtigen Begrifflichkeiten der Varianz in einer ANOVA als mittleren quadratischen Abweichung <span class="math inline">\(MS\)</span> zusammengefasst. Die gesamte Varianz wird auch als <span class="math inline">\(MS_{Total}\)</span> bezeichnet und du kennst diese schon als gepoolte Varianz <span class="math inline">\(s^2_p\)</span> aus dem Student t-Test.</p>
<div id="tbl-anova-namen" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-anova-namen-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;31.2— Zusammenfassung der Begrifflichkeit der mittleren quadratischen Abweichung <span class="math inline">\(MS\)</span> in einer ANOVA.
</figcaption>
<div aria-describedby="tbl-anova-namen-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 44%">
<col style="width: 20%">
<col style="width: 22%">
<col style="width: 12%">
</colgroup>
<tbody>
<tr class="odd">
<td>Varianz zwischen den Gruppen</td>
<td style="text-align: center;"><span class="math inline">\(MS_A\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MS_{between}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td>Varianz innerhalb der Gruppen</td>
<td style="text-align: center;"><span class="math inline">\(MS_{Error}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MS_{within}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td>Varianz aller Gruppen</td>
<td style="text-align: center;"><span class="math inline">\(MS_{Total}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MS_{Total}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(s^2_p\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Da wir jetzt alle statistischen Maßzahlen zusammen haben können wir jetzt auch einen statistischen Test rechnen. Wir haben damit dann einmal als Effekt die mittleren Abweichungsquadrate der lokalen Mittelwerte zum globalen Mittelwert des Faktors <span class="math inline">\(A\)</span> als <span class="math inline">\(MS_A\)</span> vorliegen. Das ist jetzt unser statistisches Maß für den Mittelwertsunterschied oder eben allgemeiner dem Effekt. Auch wenn wir diesen Effekt nicht biologisch interpretieren können. Dann haben wir noch als Streuung den Fehler, als mittlere Abweichungsquadrate der Beobachtungen zu den jeweiligen Gruppenmittewerten. Daraus können wir uns jetzt die Testststatistik <span class="math inline">\(F_D\)</span> der ANOVA bauen.</p>
<p><span class="math display">\[
F_D = \cfrac{MS_A}{MS_{Error}}
\]</span> mit</p>
<ul>
<li><span class="math inline">\(MS_A\)</span> gleich der mittleren Abweichungsquadrate der lokalen Mittelwerte zum globalen Mittelwert des Faktors <span class="math inline">\(A\)</span>.</li>
<li><span class="math inline">\(MS_{Error}\)</span> mittlere Abweichungsquadrate der Beobachtungen zu den jeweiligen Gruppenmittewerten.</li>
</ul>
<p>Wenn die Nullhypothese gilt, dann sind die mittleren Abweichungsquadrate der lokalen Mittelwerte zum globalen Mittelwert <span class="math inline">\(MS_A\)</span> gleich Null und die Teststatistik <span class="math inline">\(F_D\)</span> ist ebenfalls Null. Es kann aber keine negativen Werte für die F Statistik geben, da es keien ngeativen Werte für <span class="math inline">\(MS_A\)</span> geben kann. In der folgenden Abbildung siehst du nochmal die F Statistik visualisert.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-anova-fstat" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-anova-fstat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-ggplot-anova-fstat-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Abbildung&nbsp;31.5— Visualiserung der F Statistik einer ANOVA mit dem kritischen Wert F_{\alpha = 5\%} und der berechneten Teststatistik F_D aus den Daten. Eingezeichnet sind als Flächen das Signifkanzniveau \alpha gleich 5% und der p-Wert mit Pr(F_D|H_0)."><img src="stat-tests-anova2_files/figure-html/fig-ggplot-anova-fstat-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-anova-fstat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.5— Visualiserung der F Statistik einer ANOVA mit dem kritischen Wert <span class="math inline">\(F_{\alpha = 5\%}\)</span> und der berechneten Teststatistik <span class="math inline">\(F_D\)</span> aus den Daten. Eingezeichnet sind als Flächen das Signifkanzniveau <span class="math inline">\(\alpha\)</span> gleich 5% und der p-Wert mit <span class="math inline">\(Pr(F_D|H_0)\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Jetzt bietet es sich an nochmal den Zusammenhang von <span class="math inline">\(MS_A\)</span> und <span class="math inline">\(MS_{Error}\)</span> in der folgenden <a href="stat-tests-ancova2.html#fig-ggplot-anova-msa-mse" class="quarto-xref">Abbildung&nbsp;<span>32.1</span></a> näher zu betrachten. Wir können ja kleine Werte oder große Werte für die mittleren Abweichungsquadrate der lokalen Mittelwerte zum globalen Mittelwert <span class="math inline">\(MS_A\)</span> vorliegen haben. Ebenso können die mittlere Abweichungsquadrate der Beobachtungen zu den jeweiligen Gruppenmittewerten <span class="math inline">\(MS_{Error}\)</span> klein oder groß sein. Wir sehen sofort, dass ein großer Effekt <span class="math inline">\(MS_A &gt; 0\)</span> und ein kleiner Fehler <span class="math inline">\(MS_{Error} \approx 0\)</span> es erleichtern einen signifikanten Unterschied nachzuweisen. Steigt der Fehler oder wird der Effekt klein, wird es schwerer einen signifikanten Unterschied zwischen den Gruppen zu zeigen. Die Gruppenmittelwerte liegen dann meistens auf einer Ebene oder die Fehlerbalken überlappen sich.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-anova-msa-mse" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-anova-msa-mse-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-ggplot-anova-msa-mse-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Abbildung&nbsp;31.6— Visualisierung des Zusammenhangs zwischen den mittleren Abweichungsquadrate der lokalen Mittelwerte zum globalen Mittelwert MS_A sowie der mittleren Abweichungsquadrate der Beobachtungen zu den jeweiligen Gruppenmittewerten MS_{Error}. [Zum Vergrößern anklicken]"><img src="stat-tests-anova2_files/figure-html/fig-ggplot-anova-msa-mse-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="720"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-anova-msa-mse-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.6— Visualisierung des Zusammenhangs zwischen den mittleren Abweichungsquadrate der lokalen Mittelwerte zum globalen Mittelwert <span class="math inline">\(MS_A\)</span> sowie der mittleren Abweichungsquadrate der Beobachtungen zu den jeweiligen Gruppenmittewerten <span class="math inline">\(MS_{Error}\)</span>. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Am Ende können wir dann die Abweichungsquadrate <span class="math inline">\(SS\)</span> und die mittleren Abweichungsquadrate <span class="math inline">\(MS\)</span> in einer Übersichtstabelle darstellen. Wir nennen diese Übersichtstabelle auch gerne die Ergebnistabelle der ANOVA. Wir können dann auch die <span class="math inline">\(F_D\)</span> Teststatistik ergänzen. Jeder Faktor hat eine eigene Zeile. Dabei addieren sich dann die <span class="math inline">\(SS_A\)</span> und <span class="math inline">\(SS_{Error}\)</span> zu den gesammten <span class="math inline">\(SS_{Total}\)</span> auf. Die Ergebnistabelle wird dir dann später in R berechnet. Insbesondere die Berechnung der Freiheitsgrade <span class="math inline">\(df\)</span> ist eine eigene Wissenschaft für sich und du würdest diese Berechnung dann in einem statistsichen Buch nachschlagen. Hier dient die Ergebnistabelle dann nur zur Übersicht.</p>
<div id="tbl-anova-fac1-theo" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-anova-fac1-theo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;31.3— Ergebnistabelle der einfaktoriellen ANOVA in der theoretischen Darstellung. Die Abweichungsquadrate <span class="math inline">\(SS\)</span> müssen noch zu den mittleren Abweichungsquadraten <span class="math inline">\(MS\)</span> gemittelt werden. Abschließend wird die <span class="math inline">\(F_D\)</span> Teststatistik als Prüfgröße berechnet.
</figcaption>
<div aria-describedby="tbl-anova-fac1-theo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Quelle</th>
<th style="text-align: center;">df</th>
<th style="text-align: center;">Sum of squares (SS)</th>
<th style="text-align: center;">Mean squares (MS)</th>
<th style="text-align: center;">Teststatistik F<span class="math inline">\(_{\boldsymbol{D}}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(A\)</span></td>
<td style="text-align: center;"><span class="math inline">\(df_A\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_A\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MS_A = \cfrac{SS_A}{df_A}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(F_{D} = \cfrac{MS_A}{MS_{Error}}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(Error\)</span></td>
<td style="text-align: center;"><span class="math inline">\(df_{Error}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{Error}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MS_{Error} = \cfrac{SS_{Error}}{df_{Error}}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(Total\)</span></td>
<td style="text-align: center;"><span class="math inline">\(df_{total}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{Total}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Wenn es dann die Ergebnistabelle für die einfaktorielle ANOVA gibt, dann gibt es natürlich auch eine Ergebnistabelle für eine zweifaktorielle ANOVA. Im Folgenden einmal die Ergebnistabelle gezeigt. Wenn du mehr Faktoren in deine ANOVA aufnimmst, dann erhälst du mehr Zeilen. Insbesondere der Interaktionsterm <span class="math inline">\(A \times B\)</span> kann erst auftreten, wenn du zwei oder mhr Faktoren in dein Modell nimmst. Am Ende berechnest du aber immer die F Statistik indem du die mittleren Abweichungsquadrate des entsprechenden Fakotr in der Zeile durch den mittleren Fehler teilst. Es wird eben immer komplexer und hier nimmt uns R die Arbeit dann ab.</p>
<div id="tbl-anova-fac2-ohne-inter" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-anova-fac2-ohne-inter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;31.4— Ergebnistabelle der zweifaktoriellen ANOVA in der theoretischen Darstellung mit Interaktionsterm für die beiden Faktoren. Die Abweichungsquadrate <span class="math inline">\(SS\)</span> müssen noch zu den mittleren Abweichungsquadraten <span class="math inline">\(MS\)</span> gemittelt werden. Abschließend wird die <span class="math inline">\(F_D\)</span> Teststatistik als Prüfgröße für jeden Faktor separat berechnet.
</figcaption>
<div aria-describedby="tbl-anova-fac2-ohne-inter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Quelle</th>
<th style="text-align: center;">df</th>
<th style="text-align: center;">Sum of squares (SS)</th>
<th style="text-align: center;">Mean squares (MS)</th>
<th style="text-align: center;">Teststatistik F<span class="math inline">\(_{\boldsymbol{D}}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(A\)</span></td>
<td style="text-align: center;"><span class="math inline">\(df_A\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{A}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MS_{A} = \cfrac{SS_A}{df_A}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(F_{D} = \cfrac{MS_{A}}{MS_{Error}}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(B\)</span></td>
<td style="text-align: center;"><span class="math inline">\(df_B\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{B}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MS_{B} = \cfrac{SS_B}{df_B}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(F_{D} = \cfrac{MS_{B}}{MS_{Error}}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(A \times B\)</span></td>
<td style="text-align: center;"><span class="math inline">\(df_{A \times B}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{A \times B}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MS_{A \times B} = \cfrac{SS_{A \times B}}{df_{A \times B}}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(F_{D} = \cfrac{MS_{A \times B}}{MS_{Error}}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(Error\)</span></td>
<td style="text-align: center;"><span class="math inline">\(df_{Error}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{error}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MS_{Error} = \cfrac{SS_{Error}}{df_{Error}}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(Total\)</span></td>
<td style="text-align: center;"><span class="math inline">\(df_{total}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{total}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Damit wären wir fast schon am Ende der theoretischen Betrachtung des Haupteffekts eines Fakots in der einfaktoriellen ANOVA. Was mir jetzt noch bleibt, ist auf die Varianzhomogenität einzugehen. Wie du sicherlich schon gelesen hast, müssen alle Gruppen die gleiche Varianz haben. Wir berechnen ja auch nur einen Fehlerterm durch den wir dann teilen. Der ist ja für jeden Faktor der gleiche Wert. Daher hier nochmal ein Satz zur Varianzhomogenität.</p>
<dl>
<dt>Die Annahme der Varianzhomogenität theoretisch betrachtet</dt>
<dd>
<p>Wir wollen nochmal die Annahme an die Varianuhomogenität theoretisch betrachten und herausfinden, warum wir homogene Varianzen über die Gruppen brauchen. Wir du in der folgenden <a href="#fig-ggplot-anova-var-hetero" class="quarto-xref">Abbildung&nbsp;<span>31.7</span></a> einmal siehst, modelliert die ANOVA unter der Annahme der Varianzhomogenität in den Gruppen die Daten. Wir haben in den linken Plot unsere experimentellen Datan mit starker Varianzheterogenität. Die Varianz in der Gruppe <span class="math inline">\(A.2\)</span> ist viel größer als in den anderen beiden Gruppen. Dabei unterscheiden sich die Gruppen <span class="math inline">\(A.1\)</span> und <span class="math inline">\(A.3\)</span> signifikant. Die beiden Gruppen teilen sich nicht den gleichen Buchstaben des <em>Compact letter displays</em>. Wenn wir jetzt die ANOVA rechnen, dann teilen sich alle Gruppen die gemittlete Varianz über <em>alle</em> Gruppen. Das sehen wir dann in der rechten Abbilung. Die beiden Gruppen <span class="math inline">\(A.1\)</span> und <span class="math inline">\(A.3\)</span> erhalten viel mehr Streuung und die Gruppe <span class="math inline">\(A.2\)</span> weniger. Am Ende haben alle Gruppen faktisch gleich viel Streuung. So sehen dann die Daten aus, die die ANOVA modelliert. Wir können am Ende keinen signifikanten Unterschied mehr nachweisen. Daher kann es passieren, dasss eine ANOVA keinen Unterschied nachweisen kann, aber <code>{emmeans}</code> mit der Adjustierung für Varianzheterogenität dennoch einen Unterschied findet.</p>
</dd>
</dl>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-anova-var-hetero" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-anova-var-hetero-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-ggplot-anova-var-hetero-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Abbildung&nbsp;31.7— Visualisierung der Annahme der Varianzhomogenität in den Gruppen. (A) Die experimentellen Daten zeigen eine Varianzheterogenität in den Gruppen. Die Gruppe A.1 unterscheidet sich signifikant von der Gruppe A.3 dargestellt durch das Compact letter display. (B) Die ANOVA modelliert gleiche Varianzen in allen Gruppen. Dadurch verschwindet der signifikante Unterschied, da der Fehler über alle Gruppen gemittelt wird [Zum Vergrößern anklicken]"><img src="stat-tests-anova2_files/figure-html/fig-ggplot-anova-var-hetero-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="720"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-anova-var-hetero-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.7— Visualisierung der Annahme der Varianzhomogenität in den Gruppen. <strong>(A)</strong> Die experimentellen Daten zeigen eine Varianzheterogenität in den Gruppen. Die Gruppe <span class="math inline">\(A.1\)</span> unterscheidet sich signifikant von der Gruppe <span class="math inline">\(A.3\)</span> dargestellt durch das <em>Compact letter display</em>. <strong>(B)</strong> Die ANOVA modelliert gleiche Varianzen in allen Gruppen. Dadurch verschwindet der signifikante Unterschied, da der Fehler über alle Gruppen gemittelt wird <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Somit wären wir mit den theoretischen Teil durch. In dem folgenden Kasten sprechen wir nochmal über die Idee der Varianzzerlegung und wie das ganze mit der ANOVA funktioniert. Dann berechnen wir einmal den Effektschätzer der ANOVA. Bis jetzt haben wir ja nur eine Aussage über die Signifikanz, aber noch keinen Effekt berechnet.</p>
<p>Danach verlassen wir dann die einfaktorielle ANOVA und schauen auch schon weiter. Wir betrachten dann die Interaktion in einer zweifaktoriellen ANOVA. Der zweite Faktor in einer zweifaktoriellen ANOVA wird nämlich ähnlich behandelt wie der erste Faktor. Da tut sich dann konzeptionell nicht mehr so viel. Und den statistischen Engel nehme ich dann mit für die Aussage.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exkurs: Die Idee der Varianzzerlegung
</div>
</div>
<div class="callout-body-container callout-body">
<p>Häufig spricht man bei der ANOVA auch von einer Varianzzerlegung. Das ist richtig, verwirrt aber, wenn du damit gedanklich anfängst. Die ANOVA vergleicht primär Mittelwerte und die Nullhypothese ist auch entsprechend gebaut. Was die ANOVA dennoch tut, ist die gloable Streuung oder Varianz als <span class="math inline">\(SS_{Total}\)</span> auf die unterschiedlichen Quellen zu verteilen. Wenn der Faktor <span class="math inline">\(A\)</span> keinen Einfluss hätte dann würde alle Streuung nur durch den Fehler <span class="math inline">\(MS_{Error}\)</span> dargestellt und nichts von der Streuung durch die Verschiebung der lokalen Mittelwerte <span class="math inline">\(MS_A\)</span>. In der folgenden Abbildung siehst du den Zusammenhang einmal dargestellt. In der linken Abbdilung vergessen wir einmal, dass wir einen Faktor A haben. Unsere Beobachtungen streuen um den globalen Mittelwert. Wie du dann aber rechts siehst, kommt ein Teil der Streuung durch die lokalen Mittelwerte des Faktors A. Wir können also die Streuung durch die unterschiedlichen Gruppenmittelwerte teilweise erklären. Diese Verschiebungen nennen wir dann auch <span class="math inline">\(\beta_{A.1}\)</span>, <span class="math inline">\(\beta_{A.2}\)</span> und <span class="math inline">\(\beta_{A.3}\)</span>. Wäre nur der Faktor A ursächlich für die Streuung, dann würden alle Beobachtungen auf den entsprechenden lokalen Mittelwerten liegen. Die Fehlerterme <span class="math inline">\(\epsilon\)</span> wären dann alle Null. Somit kannst du dann am Ende jeden Messwert y einer Beobachtung aus den Informationen des gloabeln Mittelwerts, dem Gruppenmittel und dem entspechenden Restfehler der Beobachtung zurückrechnen.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-single-cat-anova" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-single-cat-anova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-single-cat-anova-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Abbildung&nbsp;31.8— Visualisierung der Varianzzerlegung anhand eines Faktors A mit unterschiedlichen Gruppenmittelwerten. Die Verschiebung der einzelnen Gruppenmittelwerte wird mit \beta_{A.1}, \beta_{A.2} und \beta_{A.3} bezeichnet. Die restliche Streuung dann als Fehler \epsilon der einzelnen Beobachtung zu dem zugehörigen Gruppenmittel. Somit kann jeder Messwert y einer Beobachtung aus den Informationen des gloabeln Mittelwerts, dem Gruppenmittel und dem entspechenden Restfehler der Beobachtung zurückrechnen werden [Zum Vergrößern anklicken]"><img src="stat-tests-anova2_files/figure-html/fig-single-cat-anova-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-single-cat-anova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.8— Visualisierung der Varianzzerlegung anhand eines Faktors A mit unterschiedlichen Gruppenmittelwerten. Die Verschiebung der einzelnen Gruppenmittelwerte wird mit <span class="math inline">\(\beta_{A.1}\)</span>, <span class="math inline">\(\beta_{A.2}\)</span> und <span class="math inline">\(\beta_{A.3}\)</span> bezeichnet. Die restliche Streuung dann als Fehler <span class="math inline">\(\epsilon\)</span> der einzelnen Beobachtung zu dem zugehörigen Gruppenmittel. Somit kann jeder Messwert y einer Beobachtung aus den Informationen des gloabeln Mittelwerts, dem Gruppenmittel und dem entspechenden Restfehler der Beobachtung zurückrechnen werden <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="effektschätzer" class="level3" data-number="31.2.2">
<h3 data-number="31.2.2" class="anchored" data-anchor-id="effektschätzer"><span class="header-section-number">31.2.2</span> Effektschätzer</h3>
<p>Nachdem wir uns mit der Theorie der ANOVA beschäftigt haben und verstehen, wie der Haupteffekt des Faktors A bestimmt wird, müssen wir uns noch Fragen, wie stark ist denn der Effekt nun? Wir rechnen zwar die Abqweichungsquadrate der einzlenen lokalen Mittelwerte zum globalen Mittel mit <span class="math inline">\(SS_A\)</span> aus, aber was sagt uns nun der Wert? Hierzu müssen wir nochmal einen Schritt zurücktreten und über die Abweichungsquadrate im Allgmeinen sprechen. Die gesamten Abweichungquadrate jeder Beobachtung zum globalen Mittelwert <span class="math inline">\(SS_{Total}\)</span> setzen sich aus den Abweichungsquadraten vom Faktor <span class="math inline">\(SS_{Faktor}\)</span>, der Interaktion <span class="math inline">\(SS_{Interaktion}\)</span> sowie dem Fehler <span class="math inline">\(SS_{Error}\)</span> zusammen. Wir haben dann folgenden Zusammenhang.</p>
<p><span class="math display">\[
SS_{Total} = SS_{Faktor} + SS_{Interaktion} + SS_{Error}
\]</span></p>
<p>mit</p>
<ul>
<li><span class="math inline">\(SS_{Total}\)</span> den gesamten Abweichungsquadraten jeder Beobachtung zum gloablen Mittel</li>
<li><span class="math inline">\(SS_{Faktor}\)</span> den Abweichungsquadraten der Faktoren im Modell</li>
<li><span class="math inline">\(SS_{Interaktion}\)</span> den Abweichungsquadraten möglicher Interaktionen der Faktoren</li>
<li><span class="math inline">\(SS_{Error}\)</span> dem nicht erkläreten Rest der Abweichungsquadrate</li>
</ul>
<p>Aus diesem Zusammenhang können wir dann verschiedene Effektschätzer berechnen, je nachdem wie wir dann die einzelnen Abweichungsquadrate ins Verhältnis setzen. Die Hilfeseite des R Pakets <code>{effectsize}</code> unter <a href="https://easystats.github.io/effectsize/articles/anovaES.html">Effect Sizes for ANOVAs</a> stellt eine Reihe von Effektschätzern für die ANOVA vor. Wir konzentrieren uns hier einmal auf die häufigsten angewendeten Effektschätzer. Es gibt immer mehr, aber da musst du dann nochmal selber in die Hilfeseite schauen. Dazu dann auch mehr in der Arbeit von <span class="citation" data-cites="olejnik2003generalized">Olejnik &amp; Algina (<a href="#ref-olejnik2003generalized" role="doc-biblioref">2003</a>)</span> mit dem Titel <a href="https://coshima.davidrjfikis.com/EPRS8540/uploadf07/olejnik_PsychMeth2003.pdf">Generalized eta and omega squared statistics: measures of effect size for some common research designs</a>.</p>
<section id="eta2" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="eta2">Eta<span class="math inline">\(^2\)</span></h4>
<p>Der häufigste angewendete Effektschätzer ist <a href="https://easystats.github.io/effectsize/articles/anovaES.html#eta2">Eta squared</a> oder auch <span class="math inline">\(\eta^2\)</span> geschrieben. Wir können <span class="math inline">\(\eta^2\)</span> relativ einfach aus den Abweichungsquadraten des Faktors <span class="math inline">\(SS_A\)</span> geteilt durch die gesamten Abweichungsquadrate <span class="math inline">\(SS_{Total}\)</span> berechnen. Das <span class="math inline">\(\eta^2\)</span> funktioniert besonders gut in der Anwenbdung einer einfaktoriellen ANOVA. Wir haben dann folgenden Zusammenhang.</p>
<p><span class="math display">\[
\eta^2 = \cfrac{SS_A}{SS_{Total}}
\]</span></p>
<p>mit</p>
<ul>
<li><span class="math inline">\(SS_A\)</span> den Abweichungsquadraten der lokalen Mittel des Faktor A zum globalen Mittel</li>
<li><span class="math inline">\(SS_{Total}\)</span> den gesamten Abweichungsquadraten jeder Beobachtung zum gloablen Mittel</li>
</ul>
<p>Wir rechnen hier also im Prinzip einmal einen Anteil aus. Da es sich bei den Abweichungsquadraten faktisch um eine Varianz handelt, können wir sagen, dass wir mit <span class="math inline">\(\eta^2\)</span> den Anteil der Varianz berechnen, der durch den Faktor A erklärt wird. Ich habe den Zusammenhang nochmal in der folgenden <a href="#fig-ggplot-anova-eta-venn" class="quarto-xref">Abbildung&nbsp;<span>31.9</span></a> dargestellt. Auf der linken Seite finden wir ein <span class="math inline">\(\eta^2\)</span> von <span class="math inline">\(0.2\)</span> und damit machen die <span class="math inline">\(SS_A\)</span> nur einen geringen Anteil der <span class="math inline">\(SS_{Total}\)</span> aus. Wir sagen, dass 20% der Varianz in den Daten durch den Faktor A erklärt wird. Der meiste Anteil der Abweichungsquadrate macht der Fehler <span class="math inline">\(SS_{Error}\)</span> aus. In der rechten Abbildung sehen wir dann ein <span class="math inline">\(\eta^2\)</span> von <span class="math inline">\(0.8\)</span> und damit ist der Anteil von <span class="math inline">\(SS_A\)</span> an <span class="math inline">\(SS_{Total}\)</span> groß. Wir sagen, dass 80% der Varianz in den Daten durch den Faktor A erklärt wird.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-anova-eta-venn" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-anova-eta-venn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-ggplot-anova-eta-venn-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Abbildung&nbsp;31.9— Visualisierung von \eta^2 für eine einfaktorielle ANOVA mit dem Faktor A. Gezeigt wird der Anteil der Abweichungsquadrate SS_A an den gesamten Abweichungsquadraten SS_{Total}. (A) Geringer Effekt mit einem \eta^2 von 0.2. Der Faktor A erklärt nur einen kleinen Teil der Varianz. (B) Starker Effekt mit einem \eta^2 von 0.8. Der Fakotor A erklärt fast die gesamte Varianz. [Zum Vergrößern anklicken]"><img src="stat-tests-anova2_files/figure-html/fig-ggplot-anova-eta-venn-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-anova-eta-venn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.9— Visualisierung von <span class="math inline">\(\eta^2\)</span> für eine einfaktorielle ANOVA mit dem Faktor A. Gezeigt wird der Anteil der Abweichungsquadrate <span class="math inline">\(SS_A\)</span> an den gesamten Abweichungsquadraten <span class="math inline">\(SS_{Total}\)</span>. <strong>(A)</strong> Geringer Effekt mit einem <span class="math inline">\(\eta^2\)</span> von <span class="math inline">\(0.2\)</span>. Der Faktor A erklärt nur einen kleinen Teil der Varianz. <strong>(B)</strong> Starker Effekt mit einem <span class="math inline">\(\eta^2\)</span> von <span class="math inline">\(0.8\)</span>. Der Fakotor A erklärt fast die gesamte Varianz. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Das R Paket <code>{effectsize}</code> hat auch die Funktion <code>interpret_eta_squared()</code> implementiert, die ich persönlich nicht so sinnvoll halte, da wir das <span class="math inline">\(\eta^2\)</span> relativ gut biologisch und statistisch erklären können. Das <span class="math inline">\(\eta^2\)</span> sagt dann eben aus, ob wir große oder kleine Messwerte durch unsere Behandlung durch den Faktor A vorliegen haben.</p>
<div id="tbl-anova-eta2-inter" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-anova-eta2-inter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;31.5— Interpretation einiger <span class="math inline">\(\eta^2\)</span> Werte für den Faktor A mit einer Behandlung.
</figcaption>
<div aria-describedby="tbl-anova-eta2-inter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<tbody>
<tr class="odd">
<td><span class="math inline">\(\eta^2 = 0.1\)</span></td>
<td>Faktor A erklärt 10% Varianz vom Messwert <span class="math inline">\(y\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\eta^2 = 0.5\)</span></td>
<td>Faktor A erklärt 50% Varianz vom Messwert <span class="math inline">\(y\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\eta^2 = 0.8\)</span></td>
<td>Faktor A erklärt 80% Varianz vom Messwert <span class="math inline">\(y\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Wenn du ein geplantes Experiment durchführst bei dem du durch Randomisierung und andere Maßnahmen fast alle Einflussgrößen kontrollierst, dann sollest du als Varianzquelle nur onch deinen Behandlungsfaktor A übrigbehalten. So ist dann die Daumenregel, dass wir in einem geplanten Feldexperiment ein <span class="math inline">\(\eta^2\)</span> von mindestens <span class="math inline">\(0.7\)</span> erwarten sollten. Die Streuung deines Messwerts <span class="math inline">\(y\)</span> sollte dann eignentlich nur von deiner Behandlung abhängen.</p>
</section>
<section id="omega2-und-epsilon2" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="omega2-und-epsilon2">Omega<span class="math inline">\(^2\)</span> und Epsilon<span class="math inline">\(^2\)</span></h4>
<p>Neben dem <span class="math inline">\(\eta^2\)</span> gibt es auch noch zwei weitere Effektschätzer mit dem <a href="https://www.statisticshowto.com/omega-squared/">Omega Squared</a> als <span class="math inline">\(\omega^2\)</span> geschrieben sowie dem <a href="https://www.statisticshowto.com/epsilon-squared/">Epsilon Squared</a> als <span class="math inline">\(\epsilon^2\)</span> dargestellt. Du findest dazu auf der Hilfeseite des R Pakets <code>{effectsize}</code> unter <a href="https://easystats.github.io/effectsize/articles/anovaES.html#other-measures-of-effect-size">Other Measures of Effect Size</a> noch weitere Informationen. Oder wie das R Paket <code>{effectsize}</code> wie folgt schreibt.</p>
<blockquote class="blockquote">
<p><em>“Though Omega is the more popular choice (Albers and Lakens, 2018), Epsilon is analogous to adjusted R2 (Allen, 2017, p.&nbsp;382), and has been found to be less biased (Carroll &amp; Nordholm, 1975).” — <a href="https://easystats.github.io/effectsize/articles/anovaES.html#other-measures-of-effect-size">Other Measures of Effect Size</a></em></p>
</blockquote>
<p>Beide Effektschätzer haben ihre Verwendung eher in der zweifaktoriellen ANOVA, wenn wir dann auch einen Interaktionsterm vorliegen haben. Die Interpretation ist dann nicht mehr so einfach wie bei dem <span class="math inline">\(\eta^2\)</span>. Im Allgemeinen kannst du das <span class="math inline">\(\epsilon^2\)</span> wie das Bestimmtheitsmaß <span class="math inline">\(R^2\)</span> in der linearen Regression interpretieren. Ein <span class="math inline">\(\epsilon^2\)</span> gleich 0 ist als kein Effekt und ein <span class="math inline">\(\epsilon^2\)</span> gleich 1 als ein starker Effekt anzusehen. Hier verliert sich das Ganze aber ins ungefähre und ich würde empfehlen dann die Mittelwertsdifferenzen in einem Post-hoc Test zu berechnen. Diese Differenzen der Mittelwerte sind dann direkt interpretierbar und damit vorzuziehen.</p>
<p>Für beide Effektschätzer gibt es dann die Funktionen <code>interpret_omega_squared()</code> und <code>interpret_epsilon_squared()</code> aus dem R Paket <code>{effectsize}</code>, die dir dann bei der Interpretation des Effekts helfen. Hier ist dann nicht mehr eine so einfache biologische Interpretation wie bei dem <span class="math inline">\(\eta^2\)</span> möglich. Insbesondere bei noch komplexeren mehrfaktoriellen Modellen wird die Interpretation schwerer. Ich zeige dir dann die Anwendung einmal in den unteren Beispielen in R. Da einfach mal reingucken.</p>
</section>
</section>
<section id="interaktion-f_a-times-f_b" class="level3" data-number="31.2.3">
<h3 data-number="31.2.3" class="anchored" data-anchor-id="interaktion-f_a-times-f_b"><span class="header-section-number">31.2.3</span> Interaktion <span class="math inline">\(f_A \times f_B\)</span></h3>
<p>Wenn du mehr als einen Faktor <span class="math inline">\(f_A\)</span> in deinem Modell vorliegen hast, dann kannst du eine Interaktion zwischen den Faktoren vorliegen haben. In diesem Abschnitt schauen wir uns eine Interaktion zwischen einem Faktor <span class="math inline">\(f_A\)</span> und einem Faktor <span class="math inline">\(f_B\)</span> einmal theoretisch näher an. Wir schreiben in R einen Interaktionsterm mit dem Doppelpunkt <code>:</code> zwischen den Variablennamen der beiden Faktoren. Wenn wir also die Interaktion zwischen dem Faktor <span class="math inline">\(f_1\)</span> und <span class="math inline">\(f_2\)</span> in R modellieren wollen, dann schreiben wir <code>fa:fb</code>. In der mathematischen Schreibweise haben wir dann häufig die Form <span class="math inline">\(f_A \times f_B\)</span> vorliegen. Ich schreibe hier häufig dann die mathematische Notation im Fließtext und natürlich im R Code dann die entsprechende Notation in R.</p>
<div id="tbl-anova-inter-namen" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-anova-inter-namen-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;31.6— Vergleich der Schreibweise einer Interaktion zwischen den Faktoren <span class="math inline">\(f_A\)</span> und <span class="math inline">\(f_B\)</span> einmal mathematisch und einmal in R.
</figcaption>
<div aria-describedby="tbl-anova-inter-namen-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">Mathematisch</th>
<th style="text-align: center;">R</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Interaktion zwischen Faktor <span class="math inline">\(A\)</span> und <span class="math inline">\(B\)</span></td>
<td style="text-align: center;"><span class="math inline">\(f_A \times f_B\)</span></td>
<td style="text-align: center;"><code>fa:fb</code></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Der folgende Abschnitt teilt sich grob in zwei Teile. Einmal der theoretische Hintergrund zur Interaktion und was dort eigentlich die Herausforderungen in der Modellierung sind sowie einen Abschnitt zur visuellen Überprüfung der Interaktion in einer zweifaktoriellen Analyse.</p>
<p>Beginnen wir mit der eigentlichen Problemstellung in einer zweifaktoriellen ANOVA. Wenn wir zwei Faktoren haben, dann müssen wir ja die Abweichungsquadrate den jeweiligen Faktoren zuordnen. Wenn wir keien Interaktion vorliegen haben, dann haben wir den linken Fall in der unteren <a href="#fig-ggplot-anova-inter-circ" class="quarto-xref">Abbildung&nbsp;<span>31.10</span></a> vorliegen. Der Faktor A hat seine Abweichungsquadrate mit <span class="math inline">\(SS_A\)</span> und der Faktor B auch einen Anteil der Abweichungsquadrate mit <span class="math inline">\(SS_B\)</span> vorliegen. Der Rest von den gesamten Abweichungsquadraten <span class="math inline">\(SS_{Total}\)</span> geht dann in den Fehler mit <span class="math inline">\(SS_{Error}\)</span>. Wenn wir aber eine Interaktion, wie in der rechten Abbildung vorliegen haben, dann können wir einen Teil der Abweichungsquadrate <span class="math inline">\(SS_{A \times B}\)</span> unterschiedlich zuordnen. Den die Interaktionsabweichungsquadrate <span class="math inline">\(SS_{A \times B}\)</span> könnten wir vollständig <span class="math inline">\(SS_A\)</span> oder <span class="math inline">\(SS_B\)</span> zurechnen oder aber irgendwie aufteilen. Daher gibt es jetzt verschiedene Typen von einer ANOVA, die sich eben darum drehen, wie wir die Interaktionsabweichungsquadrate <span class="math inline">\(SS_{A \times B}\)</span> verteilen.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-anova-inter-circ" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-anova-inter-circ-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-ggplot-anova-inter-circ-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Abbildung&nbsp;31.10— Visualisierung der Interaktion für eine zweifaktorielle ANOVA mit dem Faktor A und B. Gezeigt wird der Anteil der Abweichungsquadrate SS_A und SS_Ban den gesamten Abweichungsquadraten SS_{Total}. (A) Keine Interaktion. Alle Abweichungsquadrate können eindeutig einer Quelle zugeordnet werden. (B) Starke Interaktion. Ein Teil der Abweichungsquadrate SS_{A \times B} kann nicht eindeutig einem Faktor zugeordnet werden. [Zum Vergrößern anklicken]"><img src="stat-tests-anova2_files/figure-html/fig-ggplot-anova-inter-circ-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-anova-inter-circ-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.10— Visualisierung der Interaktion für eine zweifaktorielle ANOVA mit dem Faktor A und B. Gezeigt wird der Anteil der Abweichungsquadrate <span class="math inline">\(SS_A\)</span> und <span class="math inline">\(SS_B\)</span>an den gesamten Abweichungsquadraten <span class="math inline">\(SS_{Total}\)</span>. <strong>(A)</strong> Keine Interaktion. Alle Abweichungsquadrate können eindeutig einer Quelle zugeordnet werden. <strong>(B)</strong> Starke Interaktion. Ein Teil der Abweichungsquadrate <span class="math inline">\(SS_{A \times B}\)</span> kann nicht eindeutig einem Faktor zugeordnet werden. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Das zentrale Problem bleibt also, wie will ich die Abweichungsquadrate berechnen? Will ich die gesamten Interaktionsabweichungsquadrate <span class="math inline">\(SS_{A \times B}\)</span> auf den Faktor A geben? Oder wie will ich die Verteilung darstellen. Hier gibt es jetzt bei der ANOVA drei verschiedene Typen. In dem Tutorium <a href="https://md.psych.bio.uni-goettingen.de/mv/unit/lm_cat/lm_cat_unbal_ss_explained.html">Anova – Type I/II/III SS explained</a> findest du noch mehr Informationen und etwas Geschichte dazu. Ich fasse hier einmal die drei Typen zusammen und evrsuche mich mal an einer Empfehlung.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Type I</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Type II</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Type III</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Die Type I ANOVA berechnet die Abweichungsquadrate in der sequenziellen Ordnung der Faktoren in dem Modell. Es werden also erst die Abweichungsquadrate für den Faktor A berechnet, dann für den Faktor B was noch von Faktor A an Abweichungsquadraten übrig ist. Am Ende wird dann die Interaktion betrachtet, wo wir dann den Anteil der Abweichungsquadrate finden, die nicht zu dem Faktor A oder Faktor B eindeutig zugeordnet werden konnten. Es macht also einen Unterschied wie du dein Modell baust. Insbesondere wenn du unterschiedliche Anzahlen an Beobachtungen in den Gruppen vorliegen hast.</p>
<p><span class="math display">\[
\begin{aligned}
&amp;SS(A) \; \mbox{für den Faktor A} \\
&amp;SS(B \mid A) \; \mbox{für den Faktor B gegeben Faktor A}\\
&amp;SS(A \times B \mid B, A) \; \mbox{für die Interaktion gegeben Faktor B und A}
\end{aligned}
\]</span></p>
<p>Die Funktionen <code>aov()</code> und <code>anova()</code> in R rechnen immer eine Type I ANOVA. Es gibt hier nichts umzustellen, du musst hier auf die Ordnung der Faktoren in deinem Modell achten. Der wichtigere Faktor nach deiner wissenschaftlichen Fragestellung muss immer als erstes ins Modell.</p>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Die Type II ANOVA berechnet die Abweichungsquadrate eines Faktors unter der Berücksichtigung des anderen Faktors. Die Type II ANOVA ist damit der Type I ANOVA überlegen, was das finden eines signifkanten Unterschieds ausmacht. Darüber hinaus ist es auch egal welche Reihenfolge wir für unser Modell nehmen. Wenn deine beiden Faktoren im Modell also gleichwertig sind, dann ist die Type II ANOVA auf jeden Fall besser geeignet. Wichtig ist nur, dass die Type II ANOVA nur sinnvoll ist, wenn keine Interaktion zwischen den Faktoren vorliegt.</p>
<p><span class="math display">\[
\begin{aligned}
&amp;SS(A \mid B) \; \mbox{für den Faktor A gegeben Faktor B} \\
&amp;SS(B \mid A) \; \mbox{für den Faktor B gegeben Faktor A}\\
\end{aligned}
\]</span></p>
<p>Die Type II ANOVA kannst du im R Paket <code>{car}</code> mit der Funktion <code>Anova(..., type = "II")</code> anwenden. Hier empfiehlt es sich erst eine Type I Anova in <code>aov()</code> zu rechnen um zu schauen, ob eine signifikante Interaktion vorliegt. Wenn keine signifikante Interaktion zwischen den Faktoren in der Type I ANOVA vorliegt, dann ist die Type II ANOVA die bessere Wahl.</p>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<p>Die Type III ANOVA verwenden wir, wenn wir eine Interaktion in unseren Daten vorliegen haben. Die Type III ANOVA berücksichtigt die jeweilige Interaktion und die Abweichungsquadrate des anderen Faktors B bei der Berechnung der Abweichungsquadrate des Faktors A. Insbesondere bei der Anwesenheit von einer signifkanten Interaktion liefert die Type III ANOVA passende Ergebnisse. Leider lassen sich dadurch die Haupteffekte der Faktoren A und B nicht ohne die Interaktion interpretieren. Da ist dann wieder die Frage im Raum, was will ich eigentlich in der ANOVA nachweisen und wie passt die ANOVA zu meiner wissenschaftlichen Fragestellung?</p>
<p><span class="math display">\[
\begin{aligned}
&amp;SS(A \mid B,\, A \times B) \; \mbox{für den Faktor A gegeben Interaktion und Faktor B} \\
&amp;SS(B \mid A,\, A \times B) \; \mbox{für den Faktor B gegeben Interaktion und Faktor A}\\
\end{aligned}
\]</span></p>
<p>Wir können die TYPE III Anova in dem R Paket <code>{car}</code> mit der Funktion <code>Anova(..., type = "III")</code> rechnen. Hier musst du aber aufpassen, wie du das Modell baust, welches du in die Funktion <code>Anova()</code> steckst. Dazu dann mehr gleich weiter unten zur Treamtent und Effect Kodierung. Als bessere Alternative bietet sich dann die Funktion <code>aov_car()</code> aus dem R Paket <code>{afex}</code> an. Heir wird das Modell passend zur Type III Anova kodiert.</p>
</div>
</div>
</div>
<p>Jetzt haben wir da einiges an Zeug gelesen und fragen uns nun, was soll ich denn verwenden? Ich versuche jetzt mich aml an zwei etwas gewagten Empfehlungen für die Modellierung der ANOVA.</p>
<dl>
<dt>Keine Interaktion zwischen den Faktoren A und B</dt>
<dd>
<p>Wir verwenden die Type II ANOVA aus dem R Paket <code>{car}</code> mit der Funktion <code>Anova(..., type = "II")</code>. Hier haben wir die besten Chancen einen Unterschied zu finden und wir müssen nicht entscheiden, welcher Faktor uns wichtiger ist. Die Reihenfolge spielt keine Rolle im Modell.</p>
</dd>
<dt>Interaktion zwischen den Faktoren A und B</dt>
<dd>
<p>Wir verwenden die Type III Anova aus dem R Paket <code>{afex}</code> mit der Funktion <code>aov_car()</code>. Dann wird die Interaktion in den Haupteffekten der Faktoren A und B berücksichtigt. Wie wir dann weitermachen ist dann noch eine andere Sache, aber <code>{emmeans}</code> kann auch mit Interaktionen umgehen.</p>
</dd>
</dl>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/angel_01_small.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="images/angel_01_small.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p><em>Welcher ANOVA Typ nun konkret in deiner Modellierung der richtige Typ ist kann ich dir leider Allgemein nicht sagen. Fühl dich aber nicht verunsichert. Auch eine <code>aov()</code> liefert gut Ergebnisse im Zusammenspiel mit <code>{emmeans}</code> im Post-hoc Test. Das Aua hält der statistische Engel aus.</em></p>
</blockquote>
</div>
</div>
</div>
<p>Jetzt haben wir uns mit den Typen der ANOVA beschäftigt. Wie erkenne ich denn nun das wir eine vermutliche Interaktion in den Daten vorliegen haben? Hierfür kann ich dann die visuelle Überprüfung empfehlen. Eine explorative Datenanalyse ist immer der erste Schritt und auch eine vermeidliche Interaktion lässts ich gut erkennen. Dann kannst du auch schauen, ob deine ANOVA Modellierung zu den visualisierten Daten passt.</p>
<section id="visuelle-überprüfung" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="visuelle-überprüfung">Visuelle Überprüfung</h4>
<p>Die visuelle Überprüfung der Interaktion zwischen zwei Faktoren A und B ist eigentlich die beste Möglichkeit einmal zu schauen, ob wir überhaupt eine Wechselwirkung zwischen den Leveln des Faktors A und den Leveln des Faktors B vorliegen haben. Wenn es mehr Faktoren sind, dann wird die Sache sehr viel unübersichtlicher. Aber wir schauen uns meistens nur die Interaktion zwischen zwei Faktoren an. Für diesen Fall ist die visuelle Überprüfung auf jeden Fall geeignet. Wir haben die Wahl zwischen einem Liniendiagramm, den Boxplots oder aber den meist schon vorhandenen Barplots.</p>
<p>Wir betrachten hier alle drei Möglichkeiten der visuellen Überprüfung, wobei ich die Liniendiagramme mit den Mittelwerten der Faktorlevel auf jeden Fall bevorzuge. Die Boxplots gehen auch, sind aber schon etwas schwerer zu interpretieren. Von den Barplots würde ich abraten, man sieht dort wirklich schlecht eine Interaktion. In allen folgenden Abbildungen sind die Daten mehr oder minder gleich. Du musst selber entscheiden, wo du dann am besten was erkennst. Du findest den R Code für das Liniendiagramm weiter unten bei der Auswertung der zwei- und mehrfaktoriellen ANOVA.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Liniendiagramm</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Boxplot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Barplot</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-anova-inter-theo-line" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-anova-inter-theo-line-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-ggplot-anova-inter-theo-line-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Abbildung&nbsp;31.11— Visualisierung der Interaktion zwischen dem Faktor A mit drei Leveln und dem Faktor B mit zwei Leveln. Dargestellt sind die mit Linien verbundenen Mittelwerte aller Faktorkombinationen. Es empfiehlt sich den Faktor mit den meisten Leveln auf die x-Achse zu legen. (A) Keine Interaktion. Die Linien der Mittelwerte der Level des Faktors B laufen parallel über die drei Level des Faktors A. (B) Schwache Interaktion. Die Linien der Mittelwerte des Faktors B laufen aufeinander zu. (C) Starke Interaktion. Die Linien der Mittelwerte des Faktors B kreuzen sich. [Zum Vergrößern anklicken]"><img src="stat-tests-anova2_files/figure-html/fig-ggplot-anova-inter-theo-line-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-anova-inter-theo-line-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.11— Visualisierung der Interaktion zwischen dem Faktor A mit drei Leveln und dem Faktor B mit zwei Leveln. Dargestellt sind die mit Linien verbundenen Mittelwerte aller Faktorkombinationen. Es empfiehlt sich den Faktor mit den meisten Leveln auf die x-Achse zu legen. <strong>(A)</strong> Keine Interaktion. Die Linien der Mittelwerte der Level des Faktors B laufen parallel über die drei Level des Faktors A. <strong>(B)</strong> Schwache Interaktion. Die Linien der Mittelwerte des Faktors B laufen aufeinander zu. <strong>(C)</strong> Starke Interaktion. Die Linien der Mittelwerte des Faktors B kreuzen sich. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-anova-inter-theo-box" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-anova-inter-theo-box-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-ggplot-anova-inter-theo-box-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Abbildung&nbsp;31.12— Visualisierung der Interaktion zwischen dem Faktor A mit drei Leveln und dem Faktor B mit zwei Leveln. Dargestellt sind die Boxplots aller Faktorkombinationen. Es empfiehlt sich den Faktor mit den meisten Leveln auf die x-Achse zu legen. (A) Keine Interaktion. Die Boxen folgen dem gleichem Muster mit B.2 ist immer über B.1 mit etwa gleichem Abstand. (B) Schwache Interaktion. Die Boxen sind unregelmäßig mit B.2 nur teilweise über B.1 und die Abstände sind unregelmäßig. (C) Starke Interaktion. Die Boxen sind unregelmäßig und folgen keinem wiederholenden Muster. [Zum Vergrößern anklicken]"><img src="stat-tests-anova2_files/figure-html/fig-ggplot-anova-inter-theo-box-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-anova-inter-theo-box-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.12— Visualisierung der Interaktion zwischen dem Faktor A mit drei Leveln und dem Faktor B mit zwei Leveln. Dargestellt sind die Boxplots aller Faktorkombinationen. Es empfiehlt sich den Faktor mit den meisten Leveln auf die x-Achse zu legen. <strong>(A)</strong> Keine Interaktion. Die Boxen folgen dem gleichem Muster mit B.2 ist immer über B.1 mit etwa gleichem Abstand. <strong>(B)</strong> Schwache Interaktion. Die Boxen sind unregelmäßig mit B.2 nur teilweise über B.1 und die Abstände sind unregelmäßig. <strong>(C)</strong> Starke Interaktion. Die Boxen sind unregelmäßig und folgen keinem wiederholenden Muster. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-anova-inter-theo-bar" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-anova-inter-theo-bar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-ggplot-anova-inter-theo-bar-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Abbildung&nbsp;31.13— Visualisierung der Interaktion zwischen dem Faktor A mit drei Leveln und dem Faktor B mit zwei Leveln. Dargestellt sind die Barplots der Mittelwerte aller Faktorkombinationen. Es empfiehlt sich den Faktor mit den meisten Leveln auf die x-Achse zu legen. (A) Keine Interaktion. Die Säulen folgen dem gleichem Muster mit B.2 ist immer über B.1 mit etwa gleichem Abstand. (B) Schwache Interaktion. Die Säulen sind unregelmäßig mit B.2 nur teilweise über B.1 und die Abstände sind unregelmäßig. (C) Starke Interaktion. Die Säulen sind unregelmäßig und folgen keinem wiederholenden Muster. [Zum Vergrößern anklicken]"><img src="stat-tests-anova2_files/figure-html/fig-ggplot-anova-inter-theo-bar-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-anova-inter-theo-bar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.13— Visualisierung der Interaktion zwischen dem Faktor A mit drei Leveln und dem Faktor B mit zwei Leveln. Dargestellt sind die Barplots der Mittelwerte aller Faktorkombinationen. Es empfiehlt sich den Faktor mit den meisten Leveln auf die x-Achse zu legen. <strong>(A)</strong> Keine Interaktion. Die Säulen folgen dem gleichem Muster mit B.2 ist immer über B.1 mit etwa gleichem Abstand. <strong>(B)</strong> Schwache Interaktion. Die Säulen sind unregelmäßig mit B.2 nur teilweise über B.1 und die Abstände sind unregelmäßig. <strong>(C)</strong> Starke Interaktion. Die Säulen sind unregelmäßig und folgen keinem wiederholenden Muster. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="interaktion-in-r" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="interaktion-in-r">Interaktion in R</h4>
<p>Wenn wir uns Interaktionen in einer mehrfaktoriellen ANOVA anschauen wollen dann gibt es einige Möglichkeiten. Ich zeige jetzt nicht alle R Pakete in den folgenden Beispielen. Deshalb hier nochmal eine kleine Liste, wo du nochmal schauen kannst, wenn du mehr Informationen zu der Bereücksichtigung von Interaktionen in R benötigst.</p>
<ul>
<li>Das <a href="https://easystats.github.io/effectsize/articles/anovaES.html#adding-interactions">R Paket <code>{effectsize}</code></a> gibt nochmal ein Übersichtskapitel zu Interakionen in verschiedenen Modellen. Darüber hinaus diskutiert die Hilfeseite auch nochmal die verschiedenen Typen und Möglichkeiten eine ANOVA zu rechnen.</li>
<li>Das <a href="https://interactions.jacob-long.com/">R Paket <code>{interactions}</code></a> enhält eine Reihe von Funktione, die eine Analyse der Interaktion in einem mehrfaktoriellen Modell erleichtern. Hier wird nicht nur auf auf Faktoren sondern auch auf kontinuierliche Werte als Einflussvariablen eingegangen. Ein sehr rundes Paket für die Analyse von Interaktionen.</li>
<li>Das <a href="https://cran.r-project.org/web/packages/emmeans/vignettes/interactions.html">R Paket <code>{emmeans}</code></a> kann hier nicht fehlen, da wir ja meistens bis immer nach einer ANOVA einen Post-hoc Test rechnen wollen. Hier empfehle ich ja immer <code>{emmeans}</code>. Daher hat natürlich auch <code>{emmeans}</code> eine entsprechende Hilfeseite für die Berücksichtigung von Interaktionen in einem Modell.</li>
</ul>
<p>Damit wären wir dann auch schon durch. Den Rest an R Paketen zeige ich dann einmal weiter unten bei den Beispieln. So hat das R Paket <code>{afex}</code> auch noch Möglichkeiten sich Interaktionen anzeigen zu lassen, aber das zeige ich dann teilweise in der Anwendung des Paketes weiter unten. Damit wären wir fast schon mit der Theorie durch. Als nächstes schauen wir uns dann die passenden Datensätze für die verschiedenen ANOVAs einmal an.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exkurs: Treatment coding vs.&nbsp;effect coding
</div>
</div>
<div class="callout-body-container callout-body">
<p>Worum geht es in diesem Exkurs? Zum einen geht es darum zu verstehen, wie die verschiedenen Modelle – je nachdem wie die Modelle gebaut werden – die Mittelwerte schätzen. Es gibt da nämlich verschiedene Arten dies zu tun. Eine dieser Arten nennt sich <em>treatment coding</em> und eine andere <em>effect coding</em>. Die erstere Codierung nutzen wir als Standard in der Modellierung in R. Das <em>effect coding</em> ist aber für die Berechnung und Interpretation einer Interaktion bei Faktoren viel besser geeignet. Also bevor wir jetzt lange rumreden, zeige ich dir den Unterschied an einem Beispiel. Wir haben folgende Datentabelle vorliegen.</p>
<div class="cell">
<div id="tbl-1fac-contr-sum" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-1fac-contr-sum-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;31.7— Datentabelle von einem Faktor A mit drei Gruppen <span class="math inline">\(A.1\)</span>, <span class="math inline">\(A.2\)</span> und <span class="math inline">\(A.3\)</span> je drei Beobachtungen.
</figcaption>
<div aria-describedby="tbl-1fac-contr-sum-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_8f25att40v093pmc711l</title>
    <style>
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-striped" id="tinytable_8f25att40v093pmc711l" style="table-layout: fixed; width: 67% !important; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">A.1</th>
                <th scope="col">A.2</th>
                <th scope="col">A.3</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>1</td>
                  <td>7</td>
                  <td>10</td>
                </tr>
                <tr>
                  <td>2</td>
                  <td>8</td>
                  <td>11</td>
                </tr>
                <tr>
                  <td>3</td>
                  <td>9</td>
                  <td>12</td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_vni04r61qe4b3dnhvuij(i, j, css_id) {
        var table = document.getElementById("tinytable_8f25att40v093pmc711l");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_8f25att40v093pmc711l');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_vni04r61qe4b3dnhvuij(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_8f25att40v093pmc711l");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

    </script>

  


</div>
</div>
</figure>
</div>
</div>
<p>Dabei habe ich die Daten so gebaut, dass wir folgende Mittelwerte für die einzelnen Gruppen wiederfinden. Damit können wir jetzt ein Modell anpassen und schauen, wie das Modell unsere Mittelwerte abbildet.</p>
<div class="cell">
<div id="tbl-1fac-contr-sum-desc" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-1fac-contr-sum-desc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;31.8— Mittelwerte der drei Gruppen <span class="math inline">\(A.1\)</span>, <span class="math inline">\(A.2\)</span> und <span class="math inline">\(A.3\)</span> des Faktors A.
</figcaption>
<div aria-describedby="tbl-1fac-contr-sum-desc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_ox49g9h0u7uudivijjer</title>
    <style>
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-striped" id="tinytable_ox49g9h0u7uudivijjer" style="table-layout: fixed; width: 67% !important; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Faktor A</th>
                <th scope="col">Mittelwert</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>A.1</td>
                  <td> 2</td>
                </tr>
                <tr>
                  <td>A.2</td>
                  <td> 8</td>
                </tr>
                <tr>
                  <td>A.3</td>
                  <td>11</td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_qb84r7gwwipyhym505x0(i, j, css_id) {
        var table = document.getElementById("tinytable_ox49g9h0u7uudivijjer");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_ox49g9h0u7uudivijjer');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_qb84r7gwwipyhym505x0(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_ox49g9h0u7uudivijjer");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

    </script>

  


</div>
</div>
</figure>
</div>
</div>
<p>Wir haben jetzt hier zwei Möglichkeiten uns die Koeffizienten des Modells wiedergeben zu lassen. Wichtig ist, dass beide Kodierungen gleichwertig sind, was am Ende die Effekte angeht. Nur die Interpretation der numerischen Werte der Ausgabe der Modelle ist eben eine Andere. Es gibt noch mehr <a href="https://stats.oarc.ucla.edu/r/library/r-library-contrast-coding-systems-for-categorical-variables/">Contrast codings</a>, je nachdem wie dein Messwert <span class="math inline">\(y\)</span> oder deine Faktoren <span class="math inline">\(f\)</span> beschaffen sind. Aber das geht hier entschieden zu weit.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Treatment coding</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Effect coding</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>Im Falle des <em>treatment codings</em> ist der <code>(Intercept)</code> der Mittelwert der Gruppe <span class="math inline">\(A.1\)</span> und die Koeffizienten von <span class="math inline">\(A.2\)</span> und <span class="math inline">\(A.3\)</span> mit <code>faA.2</code> und <code>faA.3</code> zeigen die Differenz zum Mittelwert der Gruppe <span class="math inline">\(A.1\)</span>. Klingt wirr, ist aber mathematisch eine Lösung des Problems. Wir rechnen eben in einer Regression eine Steigung aus und die Differenzen sind eben Steigungen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(rsp <span class="sc">~</span> fa, f1_contr_sum_tbl, <span class="at">contrasts =</span> <span class="fu">list</span>(<span class="at">fa =</span> <span class="st">"contr.treatment"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)       faA.2       faA.3 
          2           6           9 </code></pre>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>Im Falle des <em>effect codings</em> ist der <code>(Intercept)</code> der gloable Mittelwert <span class="math inline">\(\beta_0\)</span> aller Beobachtungen. Damit sind dann die Koeffizienten <code>fa1</code> die Differenz des lokalen Mittelwerts von <span class="math inline">\(A.1\)</span> zu dem globalen Mittelwert. Ebenso ist dies der Fall für den Koeffizienten <code>fa2</code>, der die Differenz des lokalen Mittelwerts von <span class="math inline">\(A.2\)</span> zum globalen Mittel beschreibt. Wo ist jetzt der Koeffizient für <span class="math inline">\(A.3\)</span>? Der fehlt, lässt sich aber leicht berechnen, da die Summe der lokalen Mittelwerte Null sein muss. Damit wäre <span class="math inline">\(\bar{y}_{A.3}\)</span> gleich 4.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(rsp <span class="sc">~</span> fa, f1_contr_sum_tbl, <span class="at">contrasts =</span> <span class="fu">list</span>(<span class="at">fa =</span> <span class="st">"contr.sum"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)         fa1         fa2 
          7          -5           1 </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Wir können uns die Sachlage auch einmal in der folgenden Abbildung einmal visualisieren. Auf der linken Seite siehst du das <em>treatment coding</em> mit den jeweiligen lokalen Mittelwerten und als rote Linie den y-Achsenabschnitt der jeweiligen Kodierung. Hier sieht man dann auch sehr schon auf der rechten Seite, dass das <em>effect coding</em> die Theorie der ANOVA viel besser abbildet.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-anova-f1-effect-coding" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-anova-f1-effect-coding-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-ggplot-anova-f1-effect-coding-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Abbildung&nbsp;31.14— Visualisierung der Mittelwerte des Datensatzes. (A) Treatment Coding mit dem (Intercept) auf dem Mittelwert der Gruppe A.1. Die Koeffizienten des Modells beschreiben die Differenz der anderen Gruppen zum Mittel der Gruppe A.1. (B) Effect coding mit dem (Intercept) auf dem globalen Mittelwert \beta_0. Die Koeffizienten des Modells beschreiben die Abweichungen der Gruppenmittel zum globalen Mittel. Der Koeffizient für A.3 ist nicht im Modell enthalten, dargestellt als graue Fläche [Zum Vergrößern anklicken]"><img src="stat-tests-anova2_files/figure-html/fig-ggplot-anova-f1-effect-coding-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-anova-f1-effect-coding-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.14— Visualisierung der Mittelwerte des Datensatzes. <strong>(A)</strong> <em>Treatment Coding</em> mit dem <code>(Intercept)</code> auf dem Mittelwert der Gruppe <span class="math inline">\(A.1\)</span>. Die Koeffizienten des Modells beschreiben die Differenz der anderen Gruppen zum Mittel der Gruppe <span class="math inline">\(A.1\)</span>. <strong>(B)</strong> <em>Effect coding</em> mit dem <code>(Intercept)</code> auf dem globalen Mittelwert <span class="math inline">\(\beta_0\)</span>. Die Koeffizienten des Modells beschreiben die Abweichungen der Gruppenmittel zum globalen Mittel. Der Koeffizient für <span class="math inline">\(A.3\)</span> ist nicht im Modell enthalten, dargestellt als graue Fläche <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Jetzt wo wir den Unterschied zwischen dem <em>treatment coding</em> und dem <em>effect coding</em> verstanden haben, können wir uns einmal den Interaktionsterm in einer zweifaktoriellen ANOVA mit <em>effect coding</em> anschauen. Wie wir gleich sehen werden ist die Interpretation etwas einfacher, wenn wir uns eine Interaktion im Sinne des <em>effect codings</em> bauen. Wir setzen dann eben alle Koeffizienten in den Bezug zum globalen Mittel. Das macht die Interpretation dann in einer zweifaktoriellen ANOVA einfacher.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Effect coding ohne Interaktion</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Effect coding mit Interaktion</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>Beginnen wir einmal mit dem <em>effect coding</em> ohne Interaktion. In diesem Fall haben wir einen einfacheren zweifaktoriellen Datensatz in folgender Tabelle mit dem Faktor A und drei Leveln sowie den Faktor B mit zwei Leveln vorliegen. Es sieht jetzt etwas größer aus, aber ich habe die Daten so gebaut, dass faktisch keine Streuung in den Daten ist.</p>
<div class="cell">
<div id="tbl-2fac-contr-sum-nointer" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-2fac-contr-sum-nointer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;31.9— Datentabelle ohne Interaktion zwischen einem Faktor A mit drei Gruppen <span class="math inline">\(A.1\)</span>, <span class="math inline">\(A.2\)</span> und <span class="math inline">\(A.3\)</span> je drei Beobachtungen sowie einem Faktor B mit zwei Gruppen <span class="math inline">\(B.1\)</span> und <span class="math inline">\(B.2\)</span>. Insgesamt liegen sechs Faktorkombinationen vor.
</figcaption>
<div aria-describedby="tbl-2fac-contr-sum-nointer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_ps685nqii8vtmmo1w7gp</title>
    <style>
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-striped" id="tinytable_ps685nqii8vtmmo1w7gp" style="table-layout: fixed; width: 67% !important; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"></th>
                <th scope="col">B.1</th>
                <th scope="col">B.2</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>A.1</td>
                  <td> 79</td>
                  <td> 39</td>
                </tr>
                <tr>
                  <td>A.1</td>
                  <td> 80</td>
                  <td> 40</td>
                </tr>
                <tr>
                  <td>A.1</td>
                  <td> 81</td>
                  <td> 41</td>
                </tr>
                <tr>
                  <td>A.2</td>
                  <td>149</td>
                  <td> 99</td>
                </tr>
                <tr>
                  <td>A.2</td>
                  <td>150</td>
                  <td>100</td>
                </tr>
                <tr>
                  <td>A.2</td>
                  <td>151</td>
                  <td>101</td>
                </tr>
                <tr>
                  <td>A.3</td>
                  <td>199</td>
                  <td>149</td>
                </tr>
                <tr>
                  <td>A.3</td>
                  <td>200</td>
                  <td>150</td>
                </tr>
                <tr>
                  <td>A.3</td>
                  <td>201</td>
                  <td>151</td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_08mxuyi44crfm04dyirl(i, j, css_id) {
        var table = document.getElementById("tinytable_ps685nqii8vtmmo1w7gp");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_ps685nqii8vtmmo1w7gp');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_08mxuyi44crfm04dyirl(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_ps685nqii8vtmmo1w7gp");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

    </script>

  


</div>
</div>
</figure>
</div>
</div>
<p>Jetzt können wir uns die Mittelwerte für jede der sechs Faktorkombinationen berechnen. Ich habe das einmal in der folgenden Tabelle gemacht. Ich finde es immer sehr schwer, hier was zu sehen, aber mit einer Visualisierung wird es gleich einfacher. Wenn keine Interaktion vorliegt, dann müssen die Level des Faktors B über die Level des Faktors A parallel wie in der folgenden <a href="#fig-ggplot-anova-f2-effect-coding-no-inter" class="quarto-xref">Abbildung&nbsp;<span>31.15</span></a> laufen.</p>
<div class="cell">
<div id="tbl-2fac-contr-sum-nointer-desc" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-2fac-contr-sum-nointer-desc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;31.10— Mittelwerte der sechs Faktorkombination von Faktor A und Faktor B. Es liegt keine Interaktion in den Daten vor. Der Faktor B verhält sich über alle Level des Faktors A gleich.
</figcaption>
<div aria-describedby="tbl-2fac-contr-sum-nointer-desc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_4zkcu2i4s5tld7spa2eo</title>
    <style>
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-striped" id="tinytable_4zkcu2i4s5tld7spa2eo" style="table-layout: fixed; width: 67% !important; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Faktor A</th>
                <th scope="col">Faktor B</th>
                <th scope="col">Mittelwert</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>A.1</td>
                  <td>B.1</td>
                  <td> 80</td>
                </tr>
                <tr>
                  <td>A.1</td>
                  <td>B.2</td>
                  <td> 40</td>
                </tr>
                <tr>
                  <td>A.2</td>
                  <td>B.1</td>
                  <td>150</td>
                </tr>
                <tr>
                  <td>A.2</td>
                  <td>B.2</td>
                  <td>100</td>
                </tr>
                <tr>
                  <td>A.3</td>
                  <td>B.1</td>
                  <td>200</td>
                </tr>
                <tr>
                  <td>A.3</td>
                  <td>B.2</td>
                  <td>150</td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_1jd1rzxflccuo7fycmko(i, j, css_id) {
        var table = document.getElementById("tinytable_4zkcu2i4s5tld7spa2eo");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_4zkcu2i4s5tld7spa2eo');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_1jd1rzxflccuo7fycmko(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_4zkcu2i4s5tld7spa2eo");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

    </script>

  


</div>
</div>
</figure>
</div>
</div>
<p>Jetzt wollen wir einmal eine lineare Regression mit dem vollen Modell der beiden Faktoren und dem Interaktionsterm rechnen um die Koeffizienten als Effekte zu erhalten. Wenn wir ein <em>effect coding</em> in R nutzen wollen, dann müssen wir das der Funktion <code>lm()</code> mit der Option <code>contrast = ...</code> mitteilen. In R heißt dann <em>efffect coding</em> eben <code>contr.sum</code> und damit leben wir dann. Wir ziehen uns die Koeffizienten und runden noch kurz.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(rsp <span class="sc">~</span> fa <span class="sc">+</span> fb <span class="sc">+</span> fa<span class="sc">:</span>fb, f2_contr_sum_nointer_tbl, </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">contrasts =</span> <span class="fu">list</span>(<span class="at">fa =</span> <span class="st">"contr.sum"</span>, <span class="at">fb =</span> <span class="st">"contr.sum"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)         fa1         fa2         fb1     fa1:fb1     fa2:fb1 
     120.00      -60.00        5.00       23.33       -3.33        1.67 </code></pre>
</div>
</div>
<p>In unseren Daten ist keine Interaktion. Deshalb ist der Effekt der Interaktion mit <span class="math inline">\(-3.33\)</span> und <span class="math inline">\(1.64\)</span> für die beiden Interaktionsterme sehr klein. Den Hauptteil der Effekte machen die beiden Faktoren A und B aus. In der folgenden Tabelle siehst du einmal für den y-Wert <span class="math inline">\(80\)</span> wie sich die Effekte durch die Faktoren aufaddieren.</p>
<div id="tbl-anova-01" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-anova-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;31.11— Beispielhafte Berechnung des Messwertes <span class="math inline">\(y\)</span> für die Faktorkombination von <span class="math inline">\(A.1\)</span> und <span class="math inline">\(B.1\)</span> aus den Koeffizienten des <em>effect codings</em>.
</figcaption>
<div aria-describedby="tbl-anova-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 14%">
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">\(y\)</span></th>
<th></th>
<th><span class="math inline">\(\beta_0\)</span></th>
<th><span class="math inline">\(\beta_{A.1}\)</span></th>
<th><span class="math inline">\(\beta_{B.1}\)</span></th>
<th><span class="math inline">\(\beta_{A.1 \times B.1}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(80\)</span></td>
<td><span class="math inline">\(=\)</span></td>
<td><span class="math inline">\(120\)</span></td>
<td><span class="math inline">\(-60\)</span></td>
<td><span class="math inline">\(+23.3\)</span></td>
<td><span class="math inline">\(-3.3\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Du kannst die obige Berechnung auch in der folgenden Abbildung mit den Effekten einmal nachvollziehen. Wir wollen ja den y-Wert <span class="math inline">\(80\)</span> vom y-Achsenabschnitt <span class="math inline">\(120\)</span> kommend erreichen. Der Wert <span class="math inline">\(80\)</span> kommt durch die Faktorkombination A.1 und B.1 zustande. Deshalb ziehen wir <span class="math inline">\(-60\)</span> vom y-Achsenabschnitt für den Effekt von A.1 ab und addieren <span class="math inline">\(+23.33\)</span> für den Effekt von B.1. Der Rest, der mit <span class="math inline">\(-3.33\)</span> dann noch übrig ist, geht auf das Konto der Interaktion von A.1 und B.1.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-anova-f2-effect-coding-no-inter" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-anova-f2-effect-coding-no-inter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-ggplot-anova-f2-effect-coding-no-inter-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Abbildung&nbsp;31.15— Visualisierung des effect coding mit keiner Interaktion zwischen den Faktoren A und B. Die berechneten Effekte als Differenzen in Mittelwerten beziehen sich jeweils auf den globalen Mittelwert. Die Effekte für A.3 werden nicht vom Modell wiedergegeben sondern müssen aus dem Modell berechnet werden [Zum Vergrößern anklicken]"><img src="stat-tests-anova2_files/figure-html/fig-ggplot-anova-f2-effect-coding-no-inter-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-anova-f2-effect-coding-no-inter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.15— Visualisierung des <em>effect coding</em> mit keiner Interaktion zwischen den Faktoren A und B. Die berechneten Effekte als Differenzen in Mittelwerten beziehen sich jeweils auf den globalen Mittelwert. Die Effekte für A.3 werden nicht vom Modell wiedergegeben sondern müssen aus dem Modell berechnet werden <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Jetzt fehlen natürlich noch die Effekte für das Level A.3 aus dem Faktor A sowie die Effekte des Levels B.2 aus dem Faktor B. Auch müssen wir noch die letzte Interaktion von A.3 mit B.1 berechnen. Wichtig ist, dass alle Effekte als Mittelwertsdifferenzen zum globalen Mittel aufsummiert Null ergeben müssen. Das mache ich jetzt einmal für die fehlenden Effekte händisch.</p>
<div id="tbl-anova-02" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-anova-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;31.12— Effekte von dem Faktor A. Den Effekt des Levels A.3 berechnen wir händisch.
</figcaption>
<div aria-describedby="tbl-anova-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><span class="math inline">\(\beta_{A.1}\)</span> oder <code>fa1</code></th>
<th><span class="math inline">\(\beta_{A.2}\)</span> oder <code>fa2</code></th>
<th><span class="math inline">\(\beta_{A.3}\)</span> oder <code>fa3</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\sum = 0\)</span></td>
<td><span class="math inline">\(-60\)</span></td>
<td><span class="math inline">\(+5\)</span></td>
<td><span class="math inline">\(+55\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div id="tbl-anova-02" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-anova-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;31.13— Effekte von dem Faktor B. Den Effekt des Levels B.2 berechnen wir händisch.
</figcaption>
<div aria-describedby="tbl-anova-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th><span class="math inline">\(\beta_{B.1}\)</span> oder <code>fb1</code></th>
<th><span class="math inline">\(\beta_{B.2}\)</span> oder <code>fb2</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\sum = 0\)</span></td>
<td><span class="math inline">\(+23.33\)</span></td>
<td><span class="math inline">\(-23.33\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div id="tbl-anova-03" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-anova-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;31.14— Effekte der Interaktion zwischen dem Faktor A und dem Faktor B. Den Effekt der Interaktion von A.3 und B.1 berechnen wir händisch.
</figcaption>
<div aria-describedby="tbl-anova-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><span class="math inline">\(\beta_{A.1 \times B.1}\)</span> oder <code>fa1:fb1</code></th>
<th><span class="math inline">\(\beta_{A.2 \times B.1}\)</span> oder <code>fa2:fb1</code></th>
<th><span class="math inline">\(\beta_{A.3 \times B.1}\)</span> oder <code>fa3:fb1</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\sum = 0\)</span></td>
<td><span class="math inline">\(-3.33\)</span></td>
<td><span class="math inline">\(+1.67\)</span></td>
<td><span class="math inline">\(+1.67\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p>Nachdem du einmal das <em>effect cosing</em> ohne Interaktion zwischen den Faktoren A und B verstanden hast, schauen wir usn das gleiche Setting nochmal mit Interaktion an. Wir haben wieder den Faktor A mit drei Leveln und den Faktor B mit zwei Leveln vorliegen. Jetzt haben wir aber in der folgenden Datentabelle eine Interaktion zwischen den beiden Faktoren vorliegen. Die Messwerte für die Faktorkombination A.1 und B.1 sind nicht in der Richtung und Werten gleich wie in der Faktorkombination A.3 und B.1. Das ist hier schwer in den Zahlen zu sehen, aber faktisch drehen sich die Werte einmal. In dem Level A.1 ist B.1 großer als B.2 aber in dem Level A.3 ist es genau umgekehrt. Eine klassische Interaktion finden wir hier.</p>
<div class="cell">
<div id="tbl-2fac-contr-sum-inter" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-2fac-contr-sum-inter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;31.15— Datentabelle mit Interaktion zwischen einem Faktor A mit drei Gruppen <span class="math inline">\(A.1\)</span>, <span class="math inline">\(A.2\)</span> und <span class="math inline">\(A.3\)</span> je drei Beobachtungen sowie einem Faktor B mit zwei Gruppen <span class="math inline">\(B.1\)</span> und <span class="math inline">\(B.2\)</span>. Insgesamt liegen sechs Faktorkombinationen vor. Die Interaktion in den Daten von <span class="math inline">\(B.1\)</span> ist orange hervorgehoben.
</figcaption>
<div aria-describedby="tbl-2fac-contr-sum-inter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_7rg4sp1zsp4wtggozaqg</title>
    <style>
.table td.tinytable_css_lp5n036rh7cl2i8er4q5, .table th.tinytable_css_lp5n036rh7cl2i8er4q5 {    font-weight: bold; color: #D55E00; }
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-striped" id="tinytable_7rg4sp1zsp4wtggozaqg" style="table-layout: fixed; width: 67% !important; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"></th>
                <th scope="col">B.1</th>
                <th scope="col">B.2</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>A.1</td>
                  <td>209</td>
                  <td> 39</td>
                </tr>
                <tr>
                  <td>A.1</td>
                  <td>210</td>
                  <td> 40</td>
                </tr>
                <tr>
                  <td>A.1</td>
                  <td>211</td>
                  <td> 41</td>
                </tr>
                <tr>
                  <td>A.2</td>
                  <td>159</td>
                  <td> 99</td>
                </tr>
                <tr>
                  <td>A.2</td>
                  <td>160</td>
                  <td>100</td>
                </tr>
                <tr>
                  <td>A.2</td>
                  <td>161</td>
                  <td>101</td>
                </tr>
                <tr>
                  <td>A.3</td>
                  <td> 59</td>
                  <td>149</td>
                </tr>
                <tr>
                  <td>A.3</td>
                  <td> 60</td>
                  <td>150</td>
                </tr>
                <tr>
                  <td>A.3</td>
                  <td> 61</td>
                  <td>151</td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_dmd5bthgb6nba36sslh0(i, j, css_id) {
        var table = document.getElementById("tinytable_7rg4sp1zsp4wtggozaqg");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_7rg4sp1zsp4wtggozaqg');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_dmd5bthgb6nba36sslh0(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_7rg4sp1zsp4wtggozaqg");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

window.addEventListener('load', function () { styleCell_tinytable_dmd5bthgb6nba36sslh0(1, 1, 'tinytable_css_lp5n036rh7cl2i8er4q5') })
window.addEventListener('load', function () { styleCell_tinytable_dmd5bthgb6nba36sslh0(2, 1, 'tinytable_css_lp5n036rh7cl2i8er4q5') })
window.addEventListener('load', function () { styleCell_tinytable_dmd5bthgb6nba36sslh0(3, 1, 'tinytable_css_lp5n036rh7cl2i8er4q5') })
window.addEventListener('load', function () { styleCell_tinytable_dmd5bthgb6nba36sslh0(7, 1, 'tinytable_css_lp5n036rh7cl2i8er4q5') })
window.addEventListener('load', function () { styleCell_tinytable_dmd5bthgb6nba36sslh0(8, 1, 'tinytable_css_lp5n036rh7cl2i8er4q5') })
window.addEventListener('load', function () { styleCell_tinytable_dmd5bthgb6nba36sslh0(9, 1, 'tinytable_css_lp5n036rh7cl2i8er4q5') })
    </script>

  


</div>
</div>
</figure>
</div>
</div>
<p>Dann nochmal für alle sechs Faktorkombinationen den Mittlwert berechnet. Ich habe dir auch hier einmal die Interaktion farblich hervorgehoben. Du siehst den Zusammenhang aber sehr viel besser in der folgenden <a href="#fig-ggplot-anova-f2-effect-coding-inter" class="quarto-xref">Abbildung&nbsp;<span>31.16</span></a>. Die Linien der Mittelwerte kreuzen sich, es liegt eine Interaktion zwischen den Faktoren vor.</p>
<div class="cell">
<div id="tbl-2fac-contr-sum-inter-desc" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-2fac-contr-sum-inter-desc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;31.16— Mittelwerte der sechs Faktorkombination von Faktor A und Faktor B. Die Interaktion in den Mittelwerten von <span class="math inline">\(B.1\)</span> ist orange hervorgehoben.
</figcaption>
<div aria-describedby="tbl-2fac-contr-sum-inter-desc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_5yf9cm9a1ukjhe5sphhl</title>
    <style>
.table td.tinytable_css_4pv84r0tr4129iutlnhp, .table th.tinytable_css_4pv84r0tr4129iutlnhp {    font-weight: bold; color: #D55E00; }
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-striped" id="tinytable_5yf9cm9a1ukjhe5sphhl" style="table-layout: fixed; width: 67% !important; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Faktor A</th>
                <th scope="col">Faktor B</th>
                <th scope="col">Mittelwert</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>A.1</td>
                  <td>B.1</td>
                  <td>210</td>
                </tr>
                <tr>
                  <td>A.1</td>
                  <td>B.2</td>
                  <td> 40</td>
                </tr>
                <tr>
                  <td>A.2</td>
                  <td>B.1</td>
                  <td>160</td>
                </tr>
                <tr>
                  <td>A.2</td>
                  <td>B.2</td>
                  <td>100</td>
                </tr>
                <tr>
                  <td>A.3</td>
                  <td>B.1</td>
                  <td> 60</td>
                </tr>
                <tr>
                  <td>A.3</td>
                  <td>B.2</td>
                  <td>150</td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_02qwloe8zf4c378tnfd1(i, j, css_id) {
        var table = document.getElementById("tinytable_5yf9cm9a1ukjhe5sphhl");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_5yf9cm9a1ukjhe5sphhl');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_02qwloe8zf4c378tnfd1(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_5yf9cm9a1ukjhe5sphhl");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

window.addEventListener('load', function () { styleCell_tinytable_02qwloe8zf4c378tnfd1(1, 2, 'tinytable_css_4pv84r0tr4129iutlnhp') })
window.addEventListener('load', function () { styleCell_tinytable_02qwloe8zf4c378tnfd1(5, 2, 'tinytable_css_4pv84r0tr4129iutlnhp') })
    </script>

  


</div>
</div>
</figure>
</div>
</div>
<p>Auch hier wollen wir einmal eine lineare Regression mit dem vollen Modell der beiden Faktoren und dem Interaktionsterm rechnen um die Koeffizienten als Effekte zu erhalten. Wenn wir ein <em>effect coding</em> in R nutzen wollen, dann müssen wir das der Funktion <code>lm()</code> mit der Option <code>contrast = ...</code> mitteilen. In R heißt dann <em>efffect coding</em> eben <code>contr.sum</code> und damit leben wir dann. Wir ziehen uns die Koeffizienten und runden noch kurz. Hier sehen wir dann die Effekte in der Interaktion auch numerisch klar. Die Koeffizienten der Interaktion sind sehr viel größer als die Haupteffekte der Faktoren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(rsp <span class="sc">~</span> fa <span class="sc">+</span> fb <span class="sc">+</span> fa<span class="sc">:</span>fb, f2_contr_sum_inter_tbl, </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">contrasts =</span> <span class="fu">list</span>(<span class="at">fa =</span> <span class="st">"contr.sum"</span>, <span class="at">fb =</span> <span class="st">"contr.sum"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)         fa1         fa2         fb1     fa1:fb1     fa2:fb1 
     120.00        5.00       10.00       23.33       61.67        6.67 </code></pre>
</div>
</div>
<p>Auch hier können wir einmal beispielhaft ausrechnen wie wir auf den y-Wert von <span class="math inline">\(120\)</span> kommen würden. Nur ein kleiner Teil des Wertes machen die Haupteffekte der Faktoren aus. Ein Großteil des Wertes wird von der Interaktion erkärt. Um auf den Wert von <span class="math inline">\(210\)</span> zu kommen reichen die Effekte von A.1 und B.1 nicht aus. Ein Großteil des Wertes muss durch eine Interaktion der beiden Level beschrieben werden.</p>
<div id="tbl-anova-namen" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-anova-namen-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;31.17— Beispielhafte Berechnung des Messwertes <span class="math inline">\(y\)</span> für die Faktorkombination von <span class="math inline">\(A.1\)</span> und <span class="math inline">\(B.1\)</span> aus den Koeffizienten des <em>effect codings</em>.
</figcaption>
<div aria-describedby="tbl-anova-namen-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 7%">
<col style="width: 16%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">\(y\)</span></th>
<th></th>
<th><span class="math inline">\(\beta_0\)</span></th>
<th><span class="math inline">\(\beta_{A1}\)</span></th>
<th><span class="math inline">\(\beta_{B1}\)</span></th>
<th><span class="math inline">\(\beta_{A1:B1}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(210\)</span></td>
<td><span class="math inline">\(=\)</span></td>
<td><span class="math inline">\(120\)</span></td>
<td><span class="math inline">\(+5\)</span></td>
<td><span class="math inline">\(+23.3\)</span></td>
<td><span class="math inline">\(+61.67\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-anova-f2-effect-coding-inter" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-anova-f2-effect-coding-inter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-ggplot-anova-f2-effect-coding-inter-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Abbildung&nbsp;31.16— Visualisierung des effect coding mit einer Interaktion zwischen den Faktoren A und B. Die Linien der Mittelwerte kreuzen sich. Die berechneten Effekte als Differenzen in Mittelwerten beziehen sich jeweils auf den globalen Mittelwert. Die Effekte für A.3 werden nicht vom Modell wiedergegeben sondern müssen aus dem Modell berechnet werden [Zum Vergrößern anklicken]"><img src="stat-tests-anova2_files/figure-html/fig-ggplot-anova-f2-effect-coding-inter-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-anova-f2-effect-coding-inter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.16— Visualisierung des <em>effect coding</em> mit einer Interaktion zwischen den Faktoren A und B. Die Linien der Mittelwerte kreuzen sich. Die berechneten Effekte als Differenzen in Mittelwerten beziehen sich jeweils auf den globalen Mittelwert. Die Effekte für A.3 werden nicht vom Modell wiedergegeben sondern müssen aus dem Modell berechnet werden <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Jetzt fehlen natürlich noch die Effekte für das Level A.3 aus dem Faktor A sowie die Effekte des Levels B.2 aus dem Faktor B. Auch müssen wir noch die letzte Interaktion von A.3 mit B.1 berechnen. Das ist ja hier mit Interaktion der interessante Teil! Wichtig ist, dass alle Effekte als Mittelwertsdifferenzen zum globalen Mittel aufsummiert Null ergeben müssen. Das mache ich jetzt einmal für die fehlenden Effekte händisch.</p>
<div id="tbl-anova-01" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-anova-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;31.18— Effekte von dem Faktor A. Den Effekt des Levels A.3 berechnen wir händisch.
</figcaption>
<div aria-describedby="tbl-anova-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><span class="math inline">\(\beta_{A.1}\)</span> oder <code>fa1</code></th>
<th><span class="math inline">\(\beta_{A.2}\)</span> oder <code>fa2</code></th>
<th><span class="math inline">\(\beta_{A.3}\)</span> oder <code>fa3</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\sum = 0\)</span></td>
<td><span class="math inline">\(+5\)</span></td>
<td><span class="math inline">\(+10\)</span></td>
<td><span class="math inline">\(-15\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div id="tbl-anova-02" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-anova-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;31.19— Effekte von dem Faktor B. Den Effekt des Levels B.2 berechnen wir händisch.
</figcaption>
<div aria-describedby="tbl-anova-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th><span class="math inline">\(\beta_{B.1}\)</span> oder <code>fb1</code></th>
<th><span class="math inline">\(\beta_{B.2}\)</span> oder <code>fb2</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\sum = 0\)</span></td>
<td><span class="math inline">\(+23.33\)</span></td>
<td><span class="math inline">\(-23.33\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div id="tbl-anova-03" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-anova-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;31.20— Effekte der Interaktion zwischen dem Faktor A und dem Faktor B. Den Effekt der Interaktion von A.3 und B.1 berechnen wir händisch.
</figcaption>
<div aria-describedby="tbl-anova-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><span class="math inline">\(\beta_{A.1 \times B.1}\)</span> oder <code>fa1:fb1</code></th>
<th><span class="math inline">\(\beta_{A.2 \times B.1}\)</span> oder <code>fa2:fb1</code></th>
<th><span class="math inline">\(\beta_{A.3 \times B.1}\)</span> oder <code>fa3:fb1</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\sum = 0\)</span></td>
<td><span class="math inline">\(+61.67\)</span></td>
<td><span class="math inline">\(6.67\)</span></td>
<td><span class="math inline">\(-68.33\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="genutzte-r-pakete" class="level2" data-number="31.3">
<h2 data-number="31.3" class="anchored" data-anchor-id="genutzte-r-pakete"><span class="header-section-number">31.3</span> Genutzte R Pakete</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, magrittr, broom, WRS2, scales,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>               readxl, see, car, patchwork, emmeans,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>               interactions, effectsize, afex, report,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>               performance, conflicted)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>mutate)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>summarize)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>filter)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>arrange)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>cbbPalette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#000000"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>, </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>An der Seite des Kapitels findest du den Link <em>Quellcode anzeigen</em>, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</p>
</section>
<section id="daten" class="level2" data-number="31.4">
<h2 data-number="31.4" class="anchored" data-anchor-id="daten"><span class="header-section-number">31.4</span> Daten</h2>
<p>Wir immer bringe ich hier ein paar Datensätze mit damit wir dann verstehen, was eigentlich in den folgenden Analysen in R und den entsprechenden R Paketen passiert. Ich zeige hier an den Daten nur die Anwendung in R und nicht eine händische Berechnung der ANOVA. Deshalb fehlen dann hier auch die Mittelwerte und andere deskritptive Maßzahlen. Schauen wir jetzt also mal in unsere Beispieldaten für die einfaktorielle, zweifaktorielle und mehrfaktorielle ANOVA rein. Wie immer nehme ich hier als normalverteilten Messwert die Sprungweite von Floharten.</p>
<section id="einfaktorieller-datensatz" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="einfaktorieller-datensatz">Einfaktorieller Datensatz</h4>
<p>Beginnen wir mit einem einfaktoriellen Datensatz. Wir haben hier als Messwert die Sprungweite von Flöhen in [cm] vorliegen. Wissen wollen wir, ob sich die Sprungweite für drei verschiedene Floharten unterscheidet. Damit ist dann in unserem Modell der Faktor <code>animal</code> und die Sprungweite <code>jump_length</code> als Messwert. Ich lade einmal die Daten in das Objekt <code>fac1_tbl</code> und ergänze noch eine ID Spalte für das R Paket <code>{afex}</code>. Wir haben jeden Floh nur einmal gemessen, also kriegt jeder Floh eine eigene ID.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/flea_dog_cat_fox.xlsx"</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal))<span class="sc">|&gt;</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="st">".id"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann schauen wir uns die Daten einmal in der folgenden Tabelle als Auszug einmal an. Wichtig ist hier nochmal, dass du eben einen Faktor <code>animal</code> mit drei Leveln also Gruppen vorliegen hast. Wir wollen jetzt die drei Tierarten hinsichtlich ihrer Sprungweite in [cm] miteinander vergleichen.</p>
<div class="cell">
<div id="tbl-1fac-table" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-1fac-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;31.21— Tabelle der Sprungweiten in [cm] als Messwert <span class="math inline">\(y\)</span> von Hunde-, Katzen- und Fuchsflöhen. Der Datensatz ist einfaktoriell, da wir nur einen Faktor vorliegen haben.
</figcaption>
<div aria-describedby="tbl-1fac-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_fthrtz34ps9ix6ltejs4</title>
    <style>
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-striped" id="tinytable_fthrtz34ps9ix6ltejs4" style="table-layout: fixed; width: 67% !important; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">.id</th>
                <th scope="col">animal</th>
                <th scope="col">jump_length</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>1  </td>
                  <td>dog</td>
                  <td>5.7 </td>
                </tr>
                <tr>
                  <td>2  </td>
                  <td>dog</td>
                  <td>8.9 </td>
                </tr>
                <tr>
                  <td>3  </td>
                  <td>dog</td>
                  <td>11.8</td>
                </tr>
                <tr>
                  <td>...</td>
                  <td>...</td>
                  <td>... </td>
                </tr>
                <tr>
                  <td>19 </td>
                  <td>fox</td>
                  <td>10.6</td>
                </tr>
                <tr>
                  <td>20 </td>
                  <td>fox</td>
                  <td>8.6 </td>
                </tr>
                <tr>
                  <td>21 </td>
                  <td>fox</td>
                  <td>10.3</td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_wwjs2uqxddkfypadvnid(i, j, css_id) {
        var table = document.getElementById("tinytable_fthrtz34ps9ix6ltejs4");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_fthrtz34ps9ix6ltejs4');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_wwjs2uqxddkfypadvnid(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_fthrtz34ps9ix6ltejs4");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

    </script>

  


</div>
</div>
</figure>
</div>
</div>
<p>Und dann wollen wir uns noch einmal die Daten als einen einfachen Boxplot anschauen. Wir sehen, dass die Daten so gebaut sind, dass wir einen signifikanten Unterschied zwischend den Sprungweiten der Floharten erwarten. Die Boxen der Boxplots überlappen sich nicht und die Boxplots liegen auch nicht auf einer Ebene.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-anova-boxplot-1fac" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-anova-boxplot-1fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-ggplot-anova-boxplot-1fac-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19" title="Abbildung&nbsp;31.17— Beispielhafter einfaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten."><img src="stat-tests-anova2_files/figure-html/fig-ggplot-anova-boxplot-1fac-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-anova-boxplot-1fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.17— Beispielhafter einfaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="zweifaktorieller-datensatz" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="zweifaktorieller-datensatz">Zweifaktorieller Datensatz</h4>
<p>Neben dem einfaktoriellen Datensatz wollen wir uns noch den häufigeren Fall mit zwei Faktoren anschauen. Wir haben also nicht nur die drei Floharten vorliegen und wollen wissen ob diese unterschiedlich weit springen. Darüber hinaus haben wir noch einen zweiten Faktor gewählt. Wir haben die Sprungweiten der Hunde-, Katzen- und Fuchsflöhe nämlich an zwei Messorten, der Stadt und dem Dorf, gemessen. Dadurch haben wir jetzt den Faktor <code>animal</code> und den Faktor <code>site</code> vorliegen. Wiederum fragen wir usn, ob sich die Sprungweite in [cm] der drei Floharten in den beiden Messorten unterscheidet. Im Folgenden lade ich einmal den Datensatz in das Objekt <code>fac2_tbl</code> und ergänze noch eine ID Spalte für das R Paket <code>{afex}</code>. Wir haben jeden Floh nur einmal gemessen, also kriegt jeder Floh eine eigene ID.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>fac2_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/flea_dog_cat_fox_site.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, site, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"city"</span>, <span class="st">"village"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">site =</span> <span class="fu">as_factor</span>(site))<span class="sc">|&gt;</span> </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="st">".id"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Betrachten wir als erstes einen Auszug aus der Datentabelle. Wir haben hier als Messwert oder Outcome <span class="math inline">\(y\)</span> die Sprungweite <code>jump_length</code> vorliegen. Als ersten Faktor die Variable <code>animal</code> und als zweiten Faktor die Variable <code>site</code> festgelegt.</p>
<div class="cell">
<div id="tbl-2fac-table" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-2fac-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;31.22— Tabelle der Sprungweiten in [cm] als Messwert <span class="math inline">\(y\)</span> von Hunde-, Katzen- und Fuchsflöhen an zwei verschiedenen Messorten Stadt und Dorf. Der Datensatz ist zweifaktoriell, da wir einen Behandlungsfaktor mit <code>animal</code> und einen zweiten Faktor mit <code>site</code> vorliegen haben.
</figcaption>
<div aria-describedby="tbl-2fac-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_fwxcxcfi9ojgi7f15dn7</title>
    <style>
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-striped" id="tinytable_fwxcxcfi9ojgi7f15dn7" style="table-layout: fixed; width: 75% !important; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">.id</th>
                <th scope="col">animal</th>
                <th scope="col">site</th>
                <th scope="col">jump_length</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>1  </td>
                  <td>cat</td>
                  <td>city   </td>
                  <td>12.04</td>
                </tr>
                <tr>
                  <td>2  </td>
                  <td>cat</td>
                  <td>city   </td>
                  <td>11.98</td>
                </tr>
                <tr>
                  <td>3  </td>
                  <td>cat</td>
                  <td>city   </td>
                  <td>16.1 </td>
                </tr>
                <tr>
                  <td>...</td>
                  <td>...</td>
                  <td>...    </td>
                  <td>...  </td>
                </tr>
                <tr>
                  <td>58 </td>
                  <td>fox</td>
                  <td>village</td>
                  <td>16.96</td>
                </tr>
                <tr>
                  <td>59 </td>
                  <td>fox</td>
                  <td>village</td>
                  <td>13.38</td>
                </tr>
                <tr>
                  <td>60 </td>
                  <td>fox</td>
                  <td>village</td>
                  <td>18.38</td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_z8012t92o35isppvk46y(i, j, css_id) {
        var table = document.getElementById("tinytable_fwxcxcfi9ojgi7f15dn7");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_fwxcxcfi9ojgi7f15dn7');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_z8012t92o35isppvk46y(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_fwxcxcfi9ojgi7f15dn7");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

    </script>

  


</div>
</div>
</figure>
</div>
</div>
<p>Auch hier schauen wir uns einmal die Daten in einem Boxplot an. Wir sehen zum einen den Effekt der Floharten. Hier sehen wir aber auch eine klare Interaktion in den Daten. Die Flöhe springen in der Stadt unterschiedlich weit als in dem Dorf. So ist der Effekt und damit der Unterschied zwischen den Floharten in der Stadt ein anderer als auf dem Dorf. Wir haben eine vermutliche Interaktion zwichen den beiden Faktoren <code>animal</code> und <code>site</code> vorliegen.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-anova-boxplot-2fac" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-anova-boxplot-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-ggplot-anova-boxplot-2fac-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20" title="Abbildung&nbsp;31.18— Beispielhafter zweifaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten und den beiden Messorten."><img src="stat-tests-anova2_files/figure-html/fig-ggplot-anova-boxplot-2fac-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-anova-boxplot-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.18— Beispielhafter zweifaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten und den beiden Messorten.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="multifaktorieller-datensatz" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="multifaktorieller-datensatz">Multifaktorieller Datensatz</h4>
<p>Als letzten Datensatz lade ich noch einen multifaktoriellen Datensatz. Wir haben hier mehrere Faktoren vorliegen. Neben den Floharten <code>animal</code> haben wir auch den Entwicklungsstand <code>stage</code> sowie die Messorte <code>site</code> bestimmt. Dazu kommt dann noch der Faktor <code>season</code> als Jahreszeit. Damit haben wir dann einen vierfaktoriellen oder kurz multifaktoriellen Datensatz vorliegen. Hier wird die Sachlage dann schnell unübersichtlich und solche mehrfaktoriellen Datensätze kommen in der Praxis eher selten vor. Im Folgenden lade ich einmal den Datensatz in das Objekt <code>fac4_tbl</code> und ergänze noch eine ID Spalte für das R Paket <code>{afex}</code>. Wir haben jeden Floh nur einmal gemessen, also kriegt jeder Floh eine eigene ID.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>fac4_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/fleas_complex_data.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"fac4"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, stage, site, season, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">stage =</span> <span class="fu">factor</span>(stage, <span class="at">level =</span> <span class="fu">c</span>(<span class="st">"juvenile"</span>, <span class="st">"adult"</span>)),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">site =</span> <span class="fu">as_factor</span>(site),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">season =</span> <span class="fu">as_factor</span>(season),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">jump_length =</span> <span class="fu">round</span>(jump_length, <span class="dv">2</span>))<span class="sc">|&gt;</span> </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="st">".id"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Betrachten wir als erstes einen Auszug aus der Datentabelle. Wir haben hier als Messwert oder Outcome <span class="math inline">\(y\)</span> die Sprungweite <code>jump_length</code> vorliegen. Als ersten Faktor die Variable <code>animal</code> und als zweiten Faktor die Variable <code>site</code> festgelegt sowie als dritten Faktor den Entwicklungsstand <code>stage</code> der Flöhe.</p>
<div class="cell">
<div id="tbl-fac3-table" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-fac3-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;31.23— Tabelle der Sprungweiten in [cm] als Messwert <span class="math inline">\(y\)</span> von Hunde-, Katzen- und Fuchsflöhen an zwei verschiedenen Messorten Stadt und Dorf. Dazu wurde noch der Entwicklungsstand mit erwachsen und jugendlich erhoben. Der Datensatz ist dreifaktoriell, da wir einen Behandlungsfaktor mit <code>animal</code> und einen zweiten Faktor mit <code>site</code> vorliegen haben sowie den Entwicklungsstand <code>stage</code>.
</figcaption>
<div aria-describedby="tbl-fac3-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_nxaj6qzyslkelgjzc0in</title>
    <style>
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-striped" id="tinytable_nxaj6qzyslkelgjzc0in" style="table-layout: fixed; width: 100% !important; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">.id</th>
                <th scope="col">animal</th>
                <th scope="col">stage</th>
                <th scope="col">site</th>
                <th scope="col">season</th>
                <th scope="col">jump_length</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>1  </td>
                  <td>cat</td>
                  <td>adult   </td>
                  <td>village</td>
                  <td>summer</td>
                  <td>21.42</td>
                </tr>
                <tr>
                  <td>2  </td>
                  <td>cat</td>
                  <td>adult   </td>
                  <td>village</td>
                  <td>summer</td>
                  <td>23.42</td>
                </tr>
                <tr>
                  <td>3  </td>
                  <td>cat</td>
                  <td>adult   </td>
                  <td>village</td>
                  <td>summer</td>
                  <td>22.3 </td>
                </tr>
                <tr>
                  <td>...</td>
                  <td>...</td>
                  <td>...     </td>
                  <td>...    </td>
                  <td>...   </td>
                  <td>...  </td>
                </tr>
                <tr>
                  <td>190</td>
                  <td>fox</td>
                  <td>juvenile</td>
                  <td>city   </td>
                  <td>winter</td>
                  <td>34.05</td>
                </tr>
                <tr>
                  <td>191</td>
                  <td>fox</td>
                  <td>juvenile</td>
                  <td>city   </td>
                  <td>winter</td>
                  <td>34.9 </td>
                </tr>
                <tr>
                  <td>192</td>
                  <td>fox</td>
                  <td>juvenile</td>
                  <td>city   </td>
                  <td>winter</td>
                  <td>29.28</td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_d3et4rmlfs2icav2dl6k(i, j, css_id) {
        var table = document.getElementById("tinytable_nxaj6qzyslkelgjzc0in");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_nxaj6qzyslkelgjzc0in');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_d3et4rmlfs2icav2dl6k(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_nxaj6qzyslkelgjzc0in");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

    </script>

  


</div>
</div>
</figure>
</div>
</div>
<p>Wenn wir im Folgenden einmal die Boxplots betrachten, dann sehen wir auch einen Effekt der Floharten. Die Boxplots der Sprungweiten für die einzelnen Floharten sind unterschiedlich und liegen nicht auf einer Ebene. Die juvenilen und erwachsen Flöhe scheinen recht ähnlich zu springen. Wir sehen hier eventuell nur eine leichte Verschiedung. Darüber hinaus springen aber Dorfflöhe anders als Stadtflöhe. Hier wird es jetzt aber schwierig mit der visuellen Abschätzung, da müssen wir jetzt wirklich mal mit einer ANOVA ran und schauen was signifikant unterschiedlich ist.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-anova-boxplot-3fac" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-anova-boxplot-3fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-ggplot-anova-boxplot-3fac-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21" title="Abbildung&nbsp;31.19— Beispielhafter vierfaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten und den beiden Messorten sowie dem Entwicklungstand der Flöhe an verschiedenen Jahreszeiten."><img src="stat-tests-anova2_files/figure-html/fig-ggplot-anova-boxplot-3fac-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-anova-boxplot-3fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.19— Beispielhafter vierfaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten und den beiden Messorten sowie dem Entwicklungstand der Flöhe an verschiedenen Jahreszeiten.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="sec-anova-test-pre" class="level2" data-number="31.5">
<h2 data-number="31.5" class="anchored" data-anchor-id="sec-anova-test-pre"><span class="header-section-number">31.5</span> Test auf Normalverteilung und Varianzhomogenität</h2>
<p>Die ANOVA hat als Annahme an deinen Messwert, dass dier Messwert normalverteilt ist. Ebenso müssen die Varianzen in den Leveln des Faktors gleich sein. Wir sprechen dann von varianzhomogenität. In dem folgenden Abschnitt testen wir einmal auf Normalverteilung in dem Messwert <span class="math inline">\(y\)</span> und Varianzmomogenität in den Faktoren <span class="math inline">\(f_A\)</span> und <span class="math inline">\(f_B\)</span>. Die hier vorhandenen Ergebnisse schreibst du meistens nicht in deine Abschlussarbeit oder zeigst dort die hier vorgestellten Abbildungen. Das dient hier nur zur Überprüfung in deinem statistischen Arbeitsprozess. Du findest noch im Tutorium <a href="https://cran.r-project.org/web/packages/afex/vignettes/assumptions_of_ANOVAs.html#homogeneity-of-variances">Testing the Assumptions of ANOVAs</a> ein paar mehr Informationen, wenn es um die ANOVA und die Annahmen geht.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Achtung, bitte beachten!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wenn du keine normalverteilten Daten hast, dann wird häufig empfholen, dass du deinen Messwert <span class="math inline">\(y\)</span> transformieren sollst. Das ist eine Lösung, wenn du dann nur bei deiner ANOVA bleiben würdest oder dich die Effekte auf der Einheit des Messwert <span class="math inline">\(y\)</span> nicht interessieren. Durch eine Transformation von <span class="math inline">\(y\)</span> verlierst du immer die direkte biologische Interpretation der Effekte aus einem statistischen Test.</p>
</div>
</div>
<p>Ich zeige dir hier einmal die Funktionen <code>check_normality()</code> und <code>check_homogeneity()</code> aus dem R PAket <code>{performance}</code>. Beide Funktionen funktionieren super und man muss nicht so viel programmieren um die Funktionen zum laufen zu kriegen. Dammit du was testen kannst, musst du auch ein Modell haben was du testen kannst. Ich nutze hier einmal das einfaktorielle, zweifaktorielle sowie mehrfaktorielle Modell aus einer linearen Regression. Da sind die Annhamen die gleichen wie bei einer ANOVA.</p>
<section id="normalverteilung-des-messwerts-y" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="normalverteilung-des-messwerts-y">Normalverteilung des Messwerts <span class="math inline">\(y\)</span></h4>
<p>Wenn du überprüfen willst, ob dein Messwert <span class="math inline">\(y\)</span> einer Normalverteilung folgt, dann kannst du die Funktion <code>check_normality()</code> nutzt. Die Funktion rechnet dann den <a href="https://de.wikipedia.org/wiki/Shapiro-Wilk-Test">Shapiro-Wilk-Test</a> um auf eine Abweichung von der Normalverteilung zu testen. Hierzu ist anzumerken, dass der Test relativ empfindlich bei Abweichungen in den Verteilungsschwänzen ist. Darüber hinaus braucht der Shapiro-Wilk-Test auch etwas Fallzahl, damit er auf die Normalverteilung testen kann. Im Folgenden schauen wir uns den Code für ein einfaktorielles, zweifaktorielles und dreifaktorielles Modell einmal an. Am Ende des Abschnitts gehe ich nochmal darauf ein, was du machen kannst, wenn du keine Normalverteilung in deinem Messwert <span class="math inline">\(y\)</span> vorliegen hast.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Einfaktoriell</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Zweifaktoriell</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">Mehrfaktoriell</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p>Beginnen wir wieder mit einem einfaktoriellen Modell. Wir wollen wissen, ob unsere Sprungweite in [cm] über unsere verschiedenen Floharten normalverteilt ist. Wir bauen also erstmal das Modell und schicken es dann in die Funktion <code>check_normality()</code> aus dem R Paket <code>{performance}</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_normality</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>OK: residuals appear as normally distributed (p = 0.514).</code></pre>
</div>
</div>
<p>Die Funktion sagt, dass wir eine Normalverteilung in unseren Daten vorliegen haben. Wir können uns auch einen Diagnoseplot wiedergeben lassen. Dafür müssen wir die Funktion nur an die Funktion <code>plot()</code> weiterleiten. Das Schöne ist, dass die Abbildung uns auch gleich sagt, was wir zu erwarten haben um eine Normalverteilung anzunehmen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_normality</span>() <span class="sc">|&gt;</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>() <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-check-anova-normal-f1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-check-anova-normal-f1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-ggplot-check-anova-normal-f1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22" title="Abbildung&nbsp;31.20— Schnelle Abbildung der Residuen aus check_normality() zur Überprüfung der Normalverteilung des Messwerts in einem einfaktoriellen Modell."><img src="stat-tests-anova2_files/figure-html/fig-ggplot-check-anova-normal-f1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-check-anova-normal-f1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.20— Schnelle Abbildung der Residuen aus <code>check_normality()</code> zur Überprüfung der Normalverteilung des Messwerts in einem einfaktoriellen Modell.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p>Im zweifaktoriellen Fall ändert sich jetzt nur das Model. Wir haben eben zwei Faktoren vorliegen und diese müssen wir dann mit ins Modell nehmen. Ich habe hier auch gleich den Interaktionsterm mit ergänzt, ich teste gerne das Modell, was ich dann später auch auswerten möchte.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_normality</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>OK: residuals appear as normally distributed (p = 0.239).</code></pre>
</div>
</div>
<p>Auch hier haben wir eine Normalverteilung in den Daten vorliegen. Gerne schaue ich mir auch die Abbildung der Residuen einmal an und das geht dann flott über die Funktion <code>plot()</code>. Da musst du nur die Ausgabe der Funktion <code>check_normality()</code> weiterleiten. Die leichten Bögen in den Punkten kommen von den unterschiedlichen Faktoren und deren Effekten auf die Sprungweite.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_normality</span>() <span class="sc">|&gt;</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>() <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-check-anova-normal-f2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-check-anova-normal-f2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-ggplot-check-anova-normal-f2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23" title="Abbildung&nbsp;31.21— Schnelle Abbildung der Residuen aus check_normality() zur Überprüfung der Normalverteilung des Messwerts in einem zweifaktoriellen Modell."><img src="stat-tests-anova2_files/figure-html/fig-ggplot-check-anova-normal-f2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-check-anova-normal-f2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.21— Schnelle Abbildung der Residuen aus <code>check_normality()</code> zur Überprüfung der Normalverteilung des Messwerts in einem zweifaktoriellen Modell.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<p>Am Ende dann nochmal ein mehrfaktorielles Modell. Hier möchte ich dann auch alle Faktorkombinationen einmal testen und nutze dafür die Kurzschreibweise in R mit dem Malzeichen. Ich kann mir sonst nicht alle Kombinationen der drei Faktoren mit den entsprechenden Interaktionstermen merken. Deshalb lasse ich hier mal die beiden Jahreszeiten aus dem Modell raus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>site<span class="sc">*</span>stage, <span class="at">data =</span> fac4_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_normality</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>OK: residuals appear as normally distributed (p = 0.460).</code></pre>
</div>
</div>
<p>Auch hier sehen wir, dass die Funktion normalverteilte Sprungweiten findet. Auch hier können wir uns die Residuen des Modells einmal in einer Abbildung anschauen. Hier haben wir auch wieder leichte Bögen in den Punkten aber das kommt durch die vielen Faktoren und deren Effekten. Solange alles in den gelben Bändern bleibt, ist alles in Ordnung.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>site<span class="sc">*</span>stage, <span class="at">data =</span> fac4_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_normality</span>() <span class="sc">|&gt;</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>() <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-check-anova-normal-f3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-check-anova-normal-f3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-ggplot-check-anova-normal-f3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24" title="Abbildung&nbsp;31.22— Schnelle Abbildung der Residuen aus check_normality() zur Überprüfung der Normalverteilung des Messwerts in einem mehrfaktoriellen Modell."><img src="stat-tests-anova2_files/figure-html/fig-ggplot-check-anova-normal-f3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-check-anova-normal-f3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.22— Schnelle Abbildung der Residuen aus <code>check_normality()</code> zur Überprüfung der Normalverteilung des Messwerts in einem mehrfaktoriellen Modell.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="varianzhomogenität-der-faktoren-f" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="varianzhomogenität-der-faktoren-f">Varianzhomogenität der Faktoren <span class="math inline">\(f\)</span></h4>
<p>Nachdem wir die Normalverteilung des Messwertes <span class="math inline">\(y\)</span> getestet haben, wollen wir jetzt noch schauen, ob unsere Faktoren einer Varianzhomogenität über die Gruppen genügt. Die Funktion <code>check_homogeneity()</code> nutzt den <a href="https://de.wikipedia.org/wiki/Bartlett-Test">Bartlett-Test</a> um auf eine Abweichung von der Varianzhomogenität zu testen. Es gibt noch verschiedene andere Tests, aber ich würde hier empfehlen bei eiem Test zu bleiben und dann mit dem Ergebnis zu leben. Wild verschiedene Tests auf Varianzhomogenität durchzuführen führt dann auch nur zu einem wilden Fruchtsalat an Ergebnissen mit denen keiner was anfangen kann. Im Folgenden schauen wir uns den Code für ein einfaktorielles, zweifaktorielles und dreifaktorielles Modell einmal an. Am Ende des Abschnitts gehe ich nochmal darauf ein, was du machen kannst, wenn du keine Varianzhomogenität in deinen Faktoren vorliegen hast.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">Einfaktoriell</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Zweifaktoriell</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">Mehrfaktoriell</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<p>Beginnen wir wieder mit dem einfaktoriellen Modell. Wir stecken das Modell dann einfach in die Funktion <code>check_homogeneity()</code> und erhalten die Information über die Varianzhomogenität wiedergegeben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_homogeneity</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>OK: There is not clear evidence for different variances across groups (Bartlett Test, p = 0.297).</code></pre>
</div>
</div>
<p>Wunderbar, wir haben keine Abweichung von der Varianzhomongenität. Wir können uns auch die Daten nochmal anschauen. Hier sehen wir aber schon, dass die Daten etwas heterogen <em>aussehen</em> der Test aber die Homogenität nicht ablehnt. Das ist immer schwierig bei kleinen Fallzahlen. Aber an irgendwas muss man eben glauben.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_homogeneity</span>() <span class="sc">|&gt;</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>() <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-check-anova-variance-f1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-check-anova-variance-f1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-ggplot-check-anova-variance-f1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25" title="Abbildung&nbsp;31.23— Schnelle Abbildung der Residuen aus check_homogeneity() zur Überprüfung der Varianzhomogenität der Faktoren in einem einfaktoriellen Modell."><img src="stat-tests-anova2_files/figure-html/fig-ggplot-check-anova-variance-f1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-check-anova-variance-f1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.23— Schnelle Abbildung der Residuen aus <code>check_homogeneity()</code> zur Überprüfung der Varianzhomogenität der Faktoren in einem einfaktoriellen Modell.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<p>Jetzt können wir mal schauen, was passiert wenn wir die Anzahl an möglichen Faktorkombinationen erhöhen indem wir ein zweifaktorielles Modell nutzen. Hier haben wir dann ja sechs Faktorkombinationen oder Gruppen die dann alle homogen in den Varianzen sein müssen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_homogeneity</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>OK: There is not clear evidence for different variances across groups (Bartlett Test, p = 0.205).</code></pre>
</div>
</div>
<p>Wir haben auch hier Varianzhomogenität über alle Gruppen der Faktoren vorliegen. Wenn du dir jetzt die Abbildung zu dem Test anschaust, dann siehst du auch hier, dass die Violinplots eben dann doch alle etas anders aussehen. Wir haben aber hier auch das gleiche Problem wie bei dem einfaktoriellen Fall, wir haben eben dann doch recht wenig Fallzahl in unseren Daten.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_homogeneity</span>() <span class="sc">|&gt;</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>() <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-check-anova-variance-f2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-check-anova-variance-f2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-ggplot-check-anova-variance-f2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26" title="Abbildung&nbsp;31.24— Schnelle Abbildung der Residuen aus check_homogeneity() zur Überprüfung der Varianzhomogenität der Faktoren in einem zweifaktoriellen Modell."><img src="stat-tests-anova2_files/figure-html/fig-ggplot-check-anova-variance-f2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-check-anova-variance-f2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.24— Schnelle Abbildung der Residuen aus <code>check_homogeneity()</code> zur Überprüfung der Varianzhomogenität der Faktoren in einem zweifaktoriellen Modell.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<p>Am Ende dann nochmal ein mehrfaktorielles Modell. Hier möchte ich dann auch alle Faktorkombinationen einmal testen und nutze dafür die Kurzschreibweise in R mit dem Malzeichen. Ich kann mir sonst nicht alle Kombinationen der drei Faktoren mit den entsprechenden Interaktionstermen merken. In diesem Fall sind es dann ganze zwölf Kombinationen. Deshalb lasse ich hier mal die beiden Jahreszeiten aus dem Modell raus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>site<span class="sc">*</span>stage, <span class="at">data =</span> fac4_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_homogeneity</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Warning: Variances differ between groups (Bartlett Test, p = 0.007).</code></pre>
</div>
</div>
<p>Hier haben wir dann eine Abweichung von der Varianzhomogenität. Zum einen, weil ich die Daten so gebaut habe und zum anderen da wir jetzt echt viele Gruppen haben, wie du in der folgenden Abbidlugn sehen kannst. Es wird dann eben schwieriger in biologischen Echtdaten über viele Gruppen immer die gleiche Varianz zu haben. Irgendwann ist dann alles heterogen. Hier passt dann die Abbildung aber besser zu der Ausgabe des statistischen Tests.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>site<span class="sc">*</span>stage, <span class="at">data =</span> fac4_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_homogeneity</span>() <span class="sc">|&gt;</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-check-anova-variance-f3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-check-anova-variance-f3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-ggplot-check-anova-variance-f3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27" title="Abbildung&nbsp;31.25— Schnelle Abbildung der Residuen aus check_homogeneity() zur Überprüfung der Varianzhomogenität der Faktoren in einem dreifaktoriellen Modell."><img src="stat-tests-anova2_files/figure-html/fig-ggplot-check-anova-variance-f3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-check-anova-variance-f3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.25— Schnelle Abbildung der Residuen aus <code>check_homogeneity()</code> zur Überprüfung der Varianzhomogenität der Faktoren in einem dreifaktoriellen Modell.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<dl>
<dt>Weder Normalverteilung noch Varianzhomogenität?</dt>
<dd>
<p>In dem Fall kannst du das R Paket <code>{WRS2}</code> nutzen, was ich dir in den folgenden Tabs auch immer wieder vorstelle. Das Paket <code>{WRS2}</code> kann mit getrimmten Mittelwerten mit nicht normalverteilten Daten sowie Vamrianzhterogenität umgehen. Das ist eine bessere Lösung als die nicht-parametrischen Verfahren, wenn du auf dem ANOVA Pfad bleiben willst.</p>
</dd>
</dl>
<p>Das R Paket <code>{car}</code> erlaubt unter der Annahme der Normalverteilung des Messwertes <span class="math inline">\(y\)</span> auch eine Varianzhterogenität zu modellieren. Hier musst du dann die entsprechende Option wählen. Alles dazu findest du dann weiter unten in den entsprechenden Tabs zu der ANOVA in <code>{car}</code>.</p>
<p>Eine weitere Möglichkeit ist es deine Daten zu transformieren, wie ich es oben schon erwähnt habe. Hier findest du dann im <a href="eda-transform.html">Kaptitel zur Transformation von Daten</a> mehrere Optionen. Was da die beste Transformation ist, hängt dann stark von deiner wissenschaftlichen Fragestellung ab. Hier kann ich dann leider keine allgemeine Empfehlung abgeben.</p>
</section>
</section>
<section id="einfaktorielle-anova" class="level2" data-number="31.6">
<h2 data-number="31.6" class="anchored" data-anchor-id="einfaktorielle-anova"><span class="header-section-number">31.6</span> Einfaktorielle ANOVA</h2>
<p>Was für eine Menge an Text und Abbildungen bevor wir hier dann endlich mit der einfaktoriellen ANOVA anfangen. Wenn du dir nichts zu dem allgemeinen Hintergrund oder theoretischen Hintergrund durchgelesen hast, ist das überhaupt kein Problem. Wir nutzen jetzt hier die ANOVA auf unserem einfaktoriellen Datensatz zu der Sprungweite in [cm] von verschiedenen Floharten. Wir wollen wissen, ob sich die Sprungweite signifikant für die Hunde-, Katzen- oder Fuchsflöhe unterscheidet.</p>
<dl>
<dt>Was sagt mir eine signifikante einfaktorielle ANOVA?</dt>
<dd>
<p>Wenn wir ein signifikantes Ergebnis in einer einfaktoriellen ANOVA vorliegen haben, dann wissen wir nur, dass die Floharten alle nicht gleich weit springen. Eine signifikante ANOVA haben wir vorliegen, wenn der p-Werte kleiner ist das Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5% oder eben 0.05 als Kommazahl. Welche Floharten sich konkret unterscheiden müssen wir dann noch in einem Post-hoc Test herausfinden.</p>
</dd>
</dl>
<p>Wir haben jetzt die Wahl zwischen vier Implementierungen in R und einer holprigen Lösung in Excel. Bitte rechne die einfaktorielle ANOVA in R. Welches Paket du jetzt in R nimmst, hängt dann wiederum zum Teil von deiner Fragestellung und deinen Daten ab. Meistens ist die Standardimplementierung in <code>{base}</code> mit der Funktion <code>aov()</code> ausreichend. Da ich dann aber auch immer mal wieder was anderes brauche, zeige ich hier einmal alles.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true"><code>{base}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false"><code>{car}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false"><code>{afex}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-4" role="tab" aria-controls="tabset-9-4" aria-selected="false"><code>{WRS2}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-5" role="tab" aria-controls="tabset-9-5" aria-selected="false">Excel</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<p>Beginnen wir mit der Standardfunktion <code>aov()</code> für die einfaktorielle ANOVA. Wir nehmen einfach ein Modell und spezifizieren noch die Datenquelle. Wichtig ist, dass die Reihenfolge der Faktoren in deinem Modell eine Rolle spielt. Ja, das ist bei einem Faktor egal, aber ich schreibe es hier schonmal. Dann nutze ich noch die Funktion <code>tidy()</code> aus dem R Paket <code>{broom}</code> für eine schönere Ausgabe. Dann habe ich alles zusammen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 6
  term         df sumsq meansq statistic   p.value
  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 animal        2  74.7  37.3       11.9  0.000511
2 Residuals    18  56.5   3.14      NA   NA       </code></pre>
</div>
</div>
<p>Wir können die Ausgabe der Funktion <code>aov()</code> direkt weiter bei <code>{emmeans}</code> verwenden. Die etwas allgemeinere Form eine einfaktorielle ANOVA zu rechnen, ist erst das lineare Modell zu schätzen. Hier nutze ich einmal eine lineare Regression mit der Funktion <code>lm()</code>. Dann nutzen wir aber die Funktion <code>anova()</code> um die ANOVA zu rechnen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 6
  term         df sumsq meansq statistic   p.value
  &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 animal        2  74.7  37.3       11.9  0.000511
2 Residuals    18  56.5   3.14      NA   NA       </code></pre>
</div>
</div>
<p>Wir sind am Ende aber nur am p-Wert interessiert und auch der ist hier signifikant, da der p-Wert unter dem Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5% liegt. Wie du siehst sind die Ergebnisse numerisch gleich. Warum dann überhaupt zwei Funktionen? Mit <code>lm()</code> und <code>anova()</code> bist du etwas flexibler was das genutzte Modell angeht.</p>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<p>Jetzt könnte man meinen, warum noch eine weitere Implementierung der ANOVA, wenn wir schon die Funktion <code>aov()</code> haben? Die Funktion <code>aov()</code> rechnet grundsätzlich Type I ANOVAs. Das macht jetzt bei einer einfaktoriellen ANOVA nichts aus, aber wir können eben in <code>{car}</code> auch Type II und Type III ANOVAs rechnen. Darüber hinaus erlaubt das Paket auch für Varianzheterogenität in der ANOVA zu adjustieren.</p>
<section id="varianzhomogenität" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="varianzhomogenität">Varianzhomogenität</h4>
<p>In dem klassischen Aufruf der Funktion <code>Anova()</code> nutzen wir wieder ein Modell und dann gebe ich dir wieder die aufgeräumte Ausgabe mit <code>tidy()</code> wieder. Wenn du nichts extra angibst, dann rechnest du natürlich eine ANOVA unter der Annahme der Varianzhomogenität.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term      sumsq    df statistic   p.value
  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 animal     74.7     2      11.9  0.000511
2 Residuals  56.5    18      NA   NA       </code></pre>
</div>
</div>
<p>Wenn du die Zahlen mit der Funktion <code>aov()</code> vergleichst, siehst du das da die gleichen Werte rauskommen. Das sollte natürlich auch in einer einfaktoriellen ANOVA mit den gleichen Annahmen so sein.</p>
</section>
<section id="varianzheterogenität" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="varianzheterogenität">Varianzheterogenität</h4>
<p>Der Vorteil des Pakets <code>{car}</code> ist, dass wir in der Funktion <code>Anova()</code> auch für Varianzheterogenität adjustieren können. Wir nutzen dazu die Option <code>white.adjust = TRUE</code>. Ja, ich weiß, das ist überhaupt nicht naheliegend. Wenn wir das machen, dann werden die Abweichungsquadrate anders berechnet und unsere Ausgabe ändert sich entsprechend.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>(<span class="at">white.adjust =</span> <span class="cn">TRUE</span>)  <span class="sc">|&gt;</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Coefficient covariances computed by hccm()</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  term         df statistic   p.value
  &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 animal        2      12.1  0.000462
2 Residuals    18      NA   NA       </code></pre>
</div>
</div>
<p>Wir sind am Ende aber nur am p-Wert interessiert und auch der ist hier signifikant, da der p-Wert unter dem Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5% liegt.</p>
</section>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<p>Das R Paket <code>{afex}</code> ist eigentlich für Messwiederholungen am besten geeignet, aber ich zeige es auch hier im einfaktoriellen Fall, dann hier geht es eben auch. Das einzige was etwas anders ist, ist das wir eine ID für die Funktion brauchen. Das Paket <code>{afex}</code> möchte nämlich explizit wissen, welcher Wert zu welcher Beobachtung gehört.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> <span class="fu">Error</span>(.id), <span class="at">data =</span> fac1_tbl) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Contrasts set to contr.sum for the following variables: animal</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: jump_length
  Effect    df  MSE         F  ges p.value
1 animal 2, 18 3.14 11.89 *** .569   &lt;.001
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Da die Berechnung dann auch noch etwas anders verläuft haben wir dann leicht andere Werte raus. Wir sind am Ende aber nur am p-Wert interessiert und auch der ist hier signifikant, da der p-Wert unter dem Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5% liegt.</p>
</div>
<div id="tabset-9-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-4-tab">
<p>Jetzt wird es eigentlich erst spannend. Das <a href="https://cran.r-project.org/web/packages/WRS2/vignettes/WRS2.pdf">R Paket <code>{WRS2}</code></a> von <span class="citation" data-cites="mair2020robust">Mair &amp; Wilcox (<a href="#ref-mair2020robust" role="doc-biblioref">2020</a>)</span> erlaubt es auch bei nicht normalverteilten Daten sowie Varianzheterogenität eine ANOVA zu rechnen. Ja, du könntest dir auch die ganzen Vortests sparen und gleich eien ANOVA mit dem R Paket <code>{WRS2}</code> rechnen. Da wir es aber mit einer robusten Methode zu tun haben, werden deine Daten etwas getrimmt oder beschnitten. Wenn du also zu wenige Beobachtungen in den Gruppen hast, dann ist das R Paket <code>{WRS2}</code> nicht die beste Idee.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t1way</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
t1way(formula = jump_length ~ animal, data = fac1_tbl)

Test statistic: F = 12.8677 
Degrees of freedom 1: 2 
Degrees of freedom 2: 7.72 
p-value: 0.00348 

Explanatory measure of effect size: 0.95 
Bootstrap CI: [0.62; 1.09]</code></pre>
</div>
</div>
<p>Wir kriegen neben dem p-Wert noch ein <code>Explanatory measure of effect size</code> wiedergegeben. Du kannst den Wert wie folgt interpretieren. Ein Wert von 0.1 deutet auf einen kleinen, ein Wert von 0.3 auf einen mittleren und ab 0.5 auf einen Starken Effekt hin. Wir sind am Ende aber nur am p-Wert interessiert und auch der ist hier signifikant, da der p-Wert unter dem Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5% liegt.</p>
<p>Geht es dann im Post-hoc Test dann einfach weiter? Ja, du kannst dann auch Funkionen aus dem <code>{WRS2}</code> Paket nutzen oder aber du machst mit <code>{emmeans}</code> weiter.</p>
</div>
<div id="tabset-9-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-5-tab">
<p>Ja, du kannst auch eine einfakorielle ANOVA in Excel rechnen. Das ist dann mit etwas mehr Aufwand verbunden was die Daten angeht, aber am Ende kommt da auch was raus. Mehr dazu in dem folgenden Video. Empfehlen kann ich dir Excel nicht, aber manchmal muss das Schwein durchs Nadelöhr und dann ist das auch okay so.</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/we6vkvv8TNk" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
</div>
</div>
</div>
<p>Nachdem wir einmal die p-Werte aus unserer einfaktoriellen ANOVA erhalten und dann noch geschaut haben, ob wir ein signifikantes Ergebnis haben, können wir jetzt weiter machen. Was fehlt noch? Wir müssen noch schauen, ob wir einen Effekt zwischen den Gruppen in unserem Faktor vorliegen haben. Eine Signifikanz bedeutet ja nicht gleich Relevanz und deshalb berechnen wir auch gerne einmal einen Effektschätzer. Ein Effektschätzer sagt dir, wie stark sich die Gruppen voneinander unterscheiden. Oder anders herum formuliert, wie stark ist der Einfluss des Faktors auf den Messwert?</p>
<p>Dann müssen wir natürlich auch noch die Ergebnisse der einfaktoriellen ANOVA berichten. Dafür gibt es aber das <a href="https://easystats.github.io/report/">R Paket <code>{report}</code></a> welches dir dann bei der Interpretation der Ausgabe deiner ANOVA hilft. Nicht alle Varianten der ANOVA in R funktionieren mit dem Paket <code>{report}</code>, deshalb hier nur ein Beispiel. Aber du kannst dich dann an der Ausgabe einmal orientieren.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">Effektschätzer</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">R Paket <code>{report}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<p>Beginnen wir mit den drei Effektschätzern der ANOVA. Ich empfehle ja bei einer einfaktoriellen ANOVA immer das <span class="math inline">\(\eta^2\)</span> (eng. <em>eta squared</em>) als Effektmaß. Wir haben ja mit dem <span class="math inline">\(\eta^2\)</span> einen Wert für den Anteil der Varianz des Messwertes der durch den Behandlungsfaktor erklärt wird. Je mehr Vairanz durch die Behandlung erklärt wird, desto besser in unserem geplanten Experiment.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">eta_squared</span>() <span class="sc">|&gt;</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interpret_eta_squared</span>(<span class="at">rules =</span> <span class="st">"field2013"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA

Parameter | Eta2 |       95% CI | Interpretation
------------------------------------------------
animal    | 0.57 | [0.27, 1.00] |          large

- One-sided CIs: upper bound fixed at [1.00].
- Interpretation rule: field2013</code></pre>
</div>
</div>
<p>Wir nehmen hier die Regeln nach <span class="citation" data-cites="field2013discovering">Field (<a href="#ref-field2013discovering" role="doc-biblioref">2013</a>)</span> um zu entscheiden, wie bedeutend der Wert von <span class="math inline">\(\eta^2\)</span> ist. Hier kommt es dann aber auch auf das Experiment an. In einem geplanten Feldexperiment, wo nur die Gruppen variieren, sollte <span class="math inline">\(\eta^2\)</span> größer als 70% sein.</p>
<p>Neben dem <span class="math inline">\(\eta^2\)</span> gibt es noch das <span class="math inline">\(\epsilon^2\)</span> (eng. <em>epsilon squared</em>) sowie das <span class="math inline">\(\omega^2\)</span> (eng. <em>omega squared</em>). Ich habe beide Maßzahlen weiter oben nochmal vorgestellt. Beide Effektschätzer sind eine Möglichkeit, aber ich würde bei einer einfaktoriellen ANOVA immer das <span class="math inline">\(\eta^2\)</span> vorziehen. Beide Effektschätzer haben dann eben nicht so die klare Interpretation. Kurz gesagt, ist <span class="math inline">\(\epsilon^2\)</span> wie das <span class="math inline">\(\eta^2\)</span> bei kleinen Fallzahlen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">epsilon_squared</span>() <span class="sc">|&gt;</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interpret_epsilon_squared</span>(<span class="at">rules =</span> <span class="st">"field2013"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA

Parameter | Epsilon2 |       95% CI | Interpretation
----------------------------------------------------
animal    |     0.52 | [0.21, 1.00] |          large

- One-sided CIs: upper bound fixed at [1.00].
- Interpretation rule: field2013</code></pre>
</div>
</div>
<p>Dann hier nochmal das <span class="math inline">\(\omega^2\)</span>, was seine Stärke bei mehreren Faktoren hat. Das <span class="math inline">\(\omega^2\)</span> ist das adjustierte <span class="math inline">\(\eta^2\)</span> für mehrere Faktoren. Daher ist es hier auch nur so mäßig von Interesse.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">omega_squared</span>() <span class="sc">|&gt;</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interpret_omega_squared</span>(<span class="at">rules =</span> <span class="st">"field2013"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA

Parameter | Omega2 |       95% CI | Interpretation
--------------------------------------------------
animal    |   0.51 | [0.19, 1.00] |          large

- One-sided CIs: upper bound fixed at [1.00].
- Interpretation rule: field2013</code></pre>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<p>Das <a href="https://easystats.github.io/report/">R Paket <code>{report}</code></a> liefert nochmal die Möglichkeit sich die Ausgabe einer einfaktoriellen ANOVA in Textform wiedergeben zu lassen. Wie immer, wenn man alleine vor dem Rechner sitzt, ist das doch eine super Hilfestellung. Hier dann einmal mit der <code>Anova()</code> Funktion aus dem R Paket <code>{car}</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">report</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>The ANOVA suggests that:

  - The main effect of animal is statistically significant and large (F(2, 18) =
11.89, p &lt; .001; Eta2 = 0.57, 95% CI [0.27, 1.00])

Effect sizes were labelled following Field's (2013) recommendations.</code></pre>
</div>
</div>
<p>Wir haben dann auch die Möglichkeit etwas schönere Tabellen uns wiedergeben zu lassen. Das funktioniert aber nicht bei jeder ANOVA Implementierung.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">report_table</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter | Sum_Squares | df | Mean_Square |     F |      p | Eta2 |  Eta2 95% CI
---------------------------------------------------------------------------------
animal    |       74.68 |  2 |       37.34 | 11.89 | &lt; .001 | 0.57 | [0.27, 1.00]
Residuals |       56.53 | 18 |        3.14 |       |        |      |             </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Das war dann auch die einfaktorielle ANOVA. Wenn du die ANOVA in deiner Abschlussarbeit anwendest, musst du jetzt noch schauen, welche paarweisen Gruppenvergleiche in deinem Faktor signifikant sind. Jetzt könnte man sagen, dafür brauchst du eine signifikante ANOVA, aber meistens machen wir dann doch den ANOVA Pfad zu Ende.</p>
</section>
<section id="zweifaktorielle-anova" class="level2" data-number="31.7">
<h2 data-number="31.7" class="anchored" data-anchor-id="zweifaktorielle-anova"><span class="header-section-number">31.7</span> Zweifaktorielle ANOVA</h2>
<p>Die zweifaktorielle ANOVA. Punkt. Gibt es eine häufigere genutzte Methode in den Agrarwissenschaften im Kontext eines geplanten Feldexperiments? Ich glaube eher nicht. Viele Versuche sind so gebaut, dass du die Versuche mit einer zweifaktoriellen ANOVA auswerten kannst oder aber die Versuche so über einen Faktor mittelst, dass dann auch dein mehrfaktorielles Experiment zu einem zweifaktoriellen wird.</p>
<p>Auch hier überspringe ich dann den Teil mit dem allgemeinen und theoretischen Hintergrund und gehe dann auf die Implementierungen in R ein. Wir schauen uns hier das Beispiel der normalverteilten Sprungweiten in [cm] von Hunde-, Katzen-, und Fuchsflöhen an. Die Sprungweite wurde dann aber noch an zwei verschiedenen Orten gemessen, so dass wir ein zweifaktoriellens Design vorliegen haben.</p>
<dl>
<dt>Was sagt mir eine signifikante zweifaktorielle ANOVA?</dt>
<dd>
<p>Wenn wir ein signifikantes Ergebnis in einer zweifaktoriellen ANOVA vorliegen haben, dann wissen wir nur, dass die Floharten alle nicht gleich weit springen. Oder aber das sich die Messworte unterscheiden. Eine signifikante ANOVA haben wir vorliegen, wenn der p-Werte kleiner ist das Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5% oder eben 0.05 als Kommazahl. Welche Floharten oder Messorte sich konkret unterscheiden müssen wir dann noch in einem Post-hoc Test herausfinden.</p>
</dd>
</dl>
<p>In der folgenden Abbildung siehst die nochmal die möglichen Effekte zweier Faktoren A und B. Das ist nochmal wichtig, da mit du eine Idee davon kriegst, wann ein Faktor vermutliche signifikant ist und wie die beiden Faktoren zusammenspielen. Ich empfehle immer den Faktor mit den meisten Leveln auf die x-Achse zu legen. Wenn es deine Fragestellung verlangt, macht auch einen andere Sortierung natürlich auch Sinn. Die p-Werte sind in der Abbildung abgeschätzt und dienen der Orientierung. Wir haben eine keine signifikante und einmal eine signifikante Interaktion zwischen den Faktoren A und B vorliegen. Die Darstellung der signifikanten Interaktion ist eher beispielhaft zu sehen. Je nach Faktorkombination und Darstellung sehen dann die Abbildungen anders aus.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">Nicht signifikante Interaktion</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Signifikante Interaktion</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-anova-nsig-inter-box-2fac" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-anova-nsig-inter-box-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-ggplot-anova-nsig-inter-box-2fac-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-28" title="Abbildung&nbsp;31.26— Visualisierung möglicher Kombinationen von Effekten der Faktoren A mit den Leveln A.1, A.2 und A.3 sowie dem Faktor B mit den Leveln B.1 und B.2 anhand von Boxplots. Eine nicht signifikante Interaktion A \times B wird dargestellt. Die p-Werte sind abgeschätzt. (A) Kein Effekt in A und B. Die Boxplots aller Gruppen liegen auf dem globalen Mittelwert. (B) Effekt von B. Die Boxplots sind um den Effekt von B verschoben. Der Faktor A liegt auf einer Ebene in B. (C) Effekt von A. Die Boxplots sind um den Effekt von A verschoben. Der Faktor B zeigt keinen Unterschied im Faktor A. (D) Effekt von A und B. Die Faktoren A und B sind zum globalen Mittel verschoben. Der Faktor B ist in A in gleicher Richtung und Wert verschoben. [Zum Vergrößern anklicken]"><img src="stat-tests-anova2_files/figure-html/fig-ggplot-anova-nsig-inter-box-2fac-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-anova-nsig-inter-box-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.26— Visualisierung möglicher Kombinationen von Effekten der Faktoren A mit den Leveln <span class="math inline">\(A.1\)</span>, <span class="math inline">\(A.2\)</span> und <span class="math inline">\(A.3\)</span> sowie dem Faktor B mit den Leveln <span class="math inline">\(B.1\)</span> und <span class="math inline">\(B.2\)</span> anhand von Boxplots. Eine nicht signifikante Interaktion <span class="math inline">\(A \times B\)</span> wird dargestellt. Die p-Werte sind abgeschätzt. <strong>(A)</strong> Kein Effekt in A und B. Die Boxplots aller Gruppen liegen auf dem globalen Mittelwert. <strong>(B)</strong> Effekt von B. Die Boxplots sind um den Effekt von B verschoben. Der Faktor A liegt auf einer Ebene in B. <strong>(C)</strong> Effekt von A. Die Boxplots sind um den Effekt von A verschoben. Der Faktor B zeigt keinen Unterschied im Faktor A. <strong>(D)</strong> Effekt von A und B. Die Faktoren A und B sind zum globalen Mittel verschoben. Der Faktor B ist in A in gleicher Richtung und Wert verschoben. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-anova-sig-inter-box-2fac" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-anova-sig-inter-box-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-ggplot-anova-sig-inter-box-2fac-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-29" title="Abbildung&nbsp;31.27— Visualisierung möglicher Kombinationen von Effekten der Faktoren A mit den Leveln A.1, A.2 und A.3 sowie dem Faktor B mit den Leveln B.1 und B.2 anhand von Boxplots. Eine signifikante Interaktion A \times B wird dargestellt. Die p-Werte sind abgeschätzt. Die grünen Pfeile zeigen in die Richtung der entsprechenden Effekte in den Faktorleveln von A. (A) Faktor A und B sind nicht signifikant, da die Interaktion den Effekt in B maskiert. (B) Faktor B signifikant. Die Interaktion liegt im Level A.3 des Faktors A. (C) Faktor A signifikant. Die Interaktion maskiert den Effekt von B. (D) Faktor A und B sind signifikant. Interaktion liegt in Level A.3 für Faktor B vor. [Zum Vergrößern anklicken]"><img src="stat-tests-anova2_files/figure-html/fig-ggplot-anova-sig-inter-box-2fac-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-anova-sig-inter-box-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.27— Visualisierung möglicher Kombinationen von Effekten der Faktoren A mit den Leveln <span class="math inline">\(A.1\)</span>, <span class="math inline">\(A.2\)</span> und <span class="math inline">\(A.3\)</span> sowie dem Faktor B mit den Leveln <span class="math inline">\(B.1\)</span> und <span class="math inline">\(B.2\)</span> anhand von Boxplots. Eine signifikante Interaktion <span class="math inline">\(A \times B\)</span> wird dargestellt. Die p-Werte sind abgeschätzt. Die grünen Pfeile zeigen in die Richtung der entsprechenden Effekte in den Faktorleveln von A. <strong>(A)</strong> Faktor A und B sind nicht signifikant, da die Interaktion den Effekt in B maskiert. <strong>(B)</strong> Faktor B signifikant. Die Interaktion liegt im Level A.3 des Faktors A. <strong>(C)</strong> Faktor A signifikant. Die Interaktion maskiert den Effekt von B. <strong>(D)</strong> Faktor A und B sind signifikant. Interaktion liegt in Level A.3 für Faktor B vor. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Wenn wir uns eine zweifaktorielle ANOVA anschauen, dann haben wir immer die Haupteffekte der Faktoren A und B sowie eine potenzielle Interaktion zwischen den beiden Faktoren vorliegen. Daher betrachte ich zuerst die Haupteffekte und schauen dabei aber auch, ob wir eine Interaktion vorliegen haben. Beachte auch hier, dein Ziel ist es dann den ANOVA Pfad mit einem Post-hoc Test abzuschließen. Die zweifaktorielle ANOVA alleine reicht alleine meist nicht aus. Du musst auch wissen, welche paarweisen Vergleiche dann signifikant sind.</p>
<section id="haupteffekte" class="level3" data-number="31.7.1">
<h3 data-number="31.7.1" class="anchored" data-anchor-id="haupteffekte"><span class="header-section-number">31.7.1</span> Haupteffekte</h3>
<p>Im ersten Schritt wollen wir wissen, ob wir einen signifkanten Unterschied der Mittelwerte in den Gruppen des Faktors <code>animal</code> und dem Faktor <code>site</code> finden. Dann schauen wir noch, ob wir eine Interaktion vorliegen haben. Die Interaktion betrachten wir dann im Anschluss nochmal separat. Daher nennen wir jezt die Analyse der Faktoren auch Haupteffekte.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true"><code>{base}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false"><code>{car}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-3" role="tab" aria-controls="tabset-12-3" aria-selected="false"><code>{afex}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-4" role="tab" aria-controls="tabset-12-4" aria-selected="false"><code>{WRS2}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-5" role="tab" aria-controls="tabset-12-5" aria-selected="false">Excel</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<p>Beginnen wir mit der Standardfunktion <code>aov()</code> für die zweifaktorielle ANOVA. Wir nehmen einfach ein Modell und spezifizieren noch die Datenquelle. Wichtig ist, dass die Reihenfolge der Faktoren in deinem Modell eine Rolle spielt. Daher nehme immer deine wichtigere Behandlung als erstes in das Modell oder nutze eine Type II ANOVA im R Paket <code>{car}</code>. Dann nutze ich noch die Funktion <code>tidy()</code> aus dem R Paket <code>{broom}</code> für eine schönere Ausgabe. Dann habe ich alles zusammen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
  term           df  sumsq meansq statistic p.value
  &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  
1 animal          2 171.    85.6      25.7  &lt;0.001 
2 site            1   4.21   4.21      1.27 0.265  
3 animal:site     2  59.1   29.5       8.89 &lt;0.001 
4 Residuals      54 179.     3.32     NA    &lt;NA&gt;   </code></pre>
</div>
</div>
<p>Wir können die Ausgabe der Funktion <code>aov()</code> direkt weiter bei <code>{emmeans}</code> verwenden. Die etwas allgemeinere Form eine zweifaktorielle ANOVA zu rechnen, ist erst das lineare Modell zu schätzen. Auch hier ist die Reihenfolge von Wichtigkeit. Hier nutze ich einmal eine lineare Regression mit der Funktion <code>lm()</code>. Dann nutzen wir aber die Funktion <code>anova()</code> um die ANOVA zu rechnen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
  term           df  sumsq meansq statistic p.value
  &lt;chr&gt;       &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  
1 animal          2 171.    85.6      25.7  &lt;0.001 
2 site            1   4.21   4.21      1.27 0.265  
3 animal:site     2  59.1   29.5       8.89 &lt;0.001 
4 Residuals      54 179.     3.32     NA    &lt;NA&gt;   </code></pre>
</div>
</div>
<p>Wir sind am Ende aber nur am p-Wert der beiden Faktoren interessiert und auch der ist hier für die Floharten <code>animal</code> signifikant, da der p-Wert unter dem Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5% liegt. Der p-Wert für den Messort <code>site</code> ist dagegen nicht signifkant. Wir haben eine signifikante Interaktion <code>animal:site</code> vorliegen. Wie du siehst sind die Ergebnisse numerisch gleich.</p>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<p>Jetzt könnte man meinen, warum noch eine weitere Implementierung der ANOVA, wenn wir schon die Funktion <code>aov()</code> haben? Die Funktion <code>aov()</code> rechnet grundsätzlich Type I ANOVAs. Das macht jetzt bei einer zweifaktoriellen ANOVA schon einen Unterschied welchen Typ ANOVA wir rechnen. Wir können eben in <code>{car}</code> auch Type II und Type III ANOVAs rechnen. Darüber hinaus erlaubt das Paket auch für Varianzheterogenität in der ANOVA zu adjustieren.</p>
<section id="varianzhomogenität-1" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="varianzhomogenität-1">Varianzhomogenität</h4>
<p>In dem klassischen Aufruf der Funktion <code>Anova()</code> nutzen wir wieder ein Modell und dann gebe ich dir wieder die aufgeräumte Ausgabe mit <code>tidy()</code> wieder. Wenn du nichts extra angibst, dann rechnest du natürlich eine ANOVA unter der Annahme der Varianzhomogenität.</p>
<dl>
<dt>Keine Interaktion zwischen den Faktoren A und B</dt>
<dd>
<p>Wir rechnen dann eine Type II ANOVA, wenn wir keine Interaktion zwischen den Faktoren vorliegen haben. Ja, dass müssen wir dann natürlich vorab einmal Testen, dazu kannst du einfach die Funktion <code>aov()</code> nutzen. Wenn wir keine Interaktion vorliegen haben, dann nehmen wir auch die Interaktion aus dem Modell und testen nur die Haupteffekte mit einer Type II ANOVA. Damit ist dann auch soweit alles in Ordnung.</p>
</dd>
</dl>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>(<span class="at">type =</span> <span class="st">"II"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()  <span class="sc">|&gt;</span> </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  term       sumsq    df statistic p.value
  &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  
1 animal    171.       2    20.1   &lt;0.001 
2 site        4.21     1     0.989 0.324  
3 Residuals 239.      56    NA     &lt;NA&gt;   </code></pre>
</div>
</div>
<p>Wir sehen, dass der Faktor <code>animal</code> signifkant ist, da der p-Wert unter dem Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5% liegt. Die Messorte <code>site</code> sind nicht signifikant.</p>
<dl>
<dt>Interaktion zwischen den Faktoren A und B</dt>
<dd>
<p>Wir rechnen dann eine Type III ANOVA, wenn wir eine Interaktion zwischen den beiden Faktoren vorliegen haben. Dann werden die Haupteffekte unter der Berücksichtigung der Interaktion berechnet. Aber Achtung, du musst leider in <code>{car}</code> die Kontraste anders definieren sonst testet die Funktion <code>Anova()</code> nicht das was sie soll. Da ist dann die Funktion <code>aov_car()</code> aus dem Paket <code>{afex}</code> anwenderfreundlicher.</p>
</dd>
</dl>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl,</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">contrasts =</span> <span class="fu">list</span>(</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">animal =</span> <span class="st">"contr.sum"</span>,</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">site =</span> <span class="st">"contr.sum"</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>(<span class="at">type =</span> <span class="st">"III"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()  <span class="sc">|&gt;</span> </span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  term           sumsq    df statistic p.value
  &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  
1 (Intercept) 16389.       1   4931.   &lt;0.001 
2 animal        171.       2     25.7  &lt;0.001 
3 site            4.21     1      1.27 0.265  
4 animal:site    59.1      2      8.89 &lt;0.001 
5 Residuals     179.      54     NA    &lt;NA&gt;   </code></pre>
</div>
</div>
<p>Hier ändert sich jetzt nicht soviel. Die Entscheidungen anhand des p-Wertes sind hier gleich zu der Type II ANOVA. Wir sehen aber eine deutliche Interaktion, daher müssen wir uns die Interaktion zwischen den Haupteffekten nochmal anschauen.</p>
</section>
<section id="varianzheterogenität-1" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="varianzheterogenität-1">Varianzheterogenität</h4>
<p>Der Vorteil des Pakets <code>{car}</code> ist, dass wir in der Funktion <code>Anova()</code> auch für Varianzheterogenität adjustieren können. Wir nutzen dazu die Option <code>white.adjust = TRUE</code>. Ja, ich weiß, das ist überhaupt nicht naheliegend. Wenn wir das machen, dann werden die Abweichungsquadrate anders berechnet und unsere Ausgabe ändert sich entsprechend. Auch hier nutze ich dann mal die Type II ANOVA und betrachte nur die Haupteffekte.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>(<span class="at">white.adjust =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="st">"II"</span>)  <span class="sc">|&gt;</span> </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Coefficient covariances computed by hccm()</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  term         df statistic p.value
  &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  
1 animal        2    16.8   &lt;0.001 
2 site          1     0.923 0.341  
3 Residuals    56    NA     &lt;NA&gt;   </code></pre>
</div>
</div>
<p>Wir sind am Ende aber nur am p-Wert interessiert und auch der ist hier signifikant für den Faktor <code>animal</code>, da der p-Wert unter dem Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5% liegt. Wir finden hier keinen signifikanten Unterschied für den Messort <code>site</code>.</p>
</section>
</div>
<div id="tabset-12-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-3-tab">
<p>Der Vorteil von dem R Paket <code>{afex}</code> ist, dass wir hier mit der Funktion <code>aov_car()</code> eine Type III ANOVA rechnen, die korrekt angepasst ist. Wir müssen also nicht noch extra ein Modell mit Kontrasten anpassen. Wir können auch die ANOVA Type II rechnen. Eine Besonderheit ist, dass wir einen Fehlerterm mit <code>Error()</code> der Funktion übergeben müssen, damit <code>{afex}</code> rechnen kann. Die Stärke von <code>{afex}</code> liegt eigentlich in der repeated und mixed ANOVA. Dort brauchen wir dann die Information zwingend, welche Zeile zu welcher Beobachtung gehört.</p>
<dl>
<dt>Interaktion zwischen den Faktoren A und B</dt>
<dd>
<p>Wir rechnen dann eine Type III ANOVA, wenn wir eine Interaktion zwischen den Faktoren vorliegen haben. Die Funktion <code>aov_car()</code> rechnet automatisch eine Type III ANOVA, wenn wir nichts anderes angeben. Das macht uns das Leben sehr viel einfacher. Wir müssen also nicht extra schauen, ob die Kontraste stimmen.</p>
</dd>
</dl>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site <span class="sc">+</span> <span class="fu">Error</span>(.id), <span class="at">data =</span> fac2_tbl) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Contrasts set to contr.sum for the following variables: animal, site</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: jump_length
       Effect    df  MSE         F  ges p.value
1      animal 2, 54 3.32 25.74 *** .488   &lt;.001
2        site 1, 54 3.32      1.27 .023    .265
3 animal:site 2, 54 3.32  8.89 *** .248   &lt;.001
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>An den Ergebnissen ändert sich nicht so viel. Wir haben eine signifikanten Unterschied für den Faktor <code>animal</code> sowie für die Interaktion <code>animal:site</code> vorliegen, da der p-Wert unter dem Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5% liegt.</p>
<dl>
<dt>Keine Interaktion zwischen den Faktoren A und B</dt>
<dd>
<p>Wir rechnen in <code>{afex}</code> eine Type II ANOVA, wenn wir keine Interaktion zwischen den Faktoren vorliegen hätten. Hier müssen wir dann den Type extra angeben, damit nicht automatisch eine Type III ANOVA gerechnet wird.</p>
</dd>
</dl>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> <span class="fu">Error</span>(.id), <span class="at">data =</span> fac2_tbl, <span class="at">type =</span> <span class="st">"II"</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Contrasts set to contr.sum for the following variables: animal, site</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type II tests)

Response: jump_length
  Effect    df  MSE         F  ges p.value
1 animal 2, 56 4.26 20.08 *** .418   &lt;.001
2   site 1, 56 4.26      0.99 .017    .324
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Die Ergebnisse entsprechen aber hier auch der Type III ANOVA. Wir haben einen signifikanten Unterschied für den Faktor <code>animal</code> und damit den Floharten vorliegen, da der p-Wert unter dem Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5% liegt. Die Messorte sind nicht signifikant.</p>
</div>
<div id="tabset-12-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-4-tab">
<p>Jetzt wird es eigentlich wieder erst spannend. Das <a href="https://cran.r-project.org/web/packages/WRS2/vignettes/WRS2.pdf">R Paket <code>{WRS2}</code></a> von <span class="citation" data-cites="mair2020robust">Mair &amp; Wilcox (<a href="#ref-mair2020robust" role="doc-biblioref">2020</a>)</span> erlaubt es auch bei nicht normalverteilten Daten sowie Varianzheterogenität eine ANOVA zu rechnen. Ja, du könntest dir auch die ganzen Vortests sparen und gleich eien ANOVA mit dem R Paket <code>{WRS2}</code> rechnen. Da wir es aber mit einer robusten Methode zu tun haben, werden deine Daten etwas getrimmt oder beschnitten. Wenn du also zu wenige Beobachtungen in den Gruppen hast, dann ist das R Paket <code>{WRS2}</code> nicht die beste Idee.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t2way</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
t2way(formula = jump_length ~ animal + site + animal:site, data = fac2_tbl)

              value p.value
animal      37.1763   0.001
site         0.1375   0.715
animal:site 13.0813   0.008</code></pre>
</div>
</div>
<p>Wir sind am Ende aber nur am p-Wert interessiert und auch der ist hier für die Floharten <code>animal</code> sowie der Interaktion <code>animal:site</code> signifikant, da der p-Wert unter dem Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5% liegt. Wir erhalten hier keinen Effektschätzer wie bei der einfaktoriellen ANOVA. Dafür müssen wir uns nicht um die Annahmen kümmern.</p>
</div>
<div id="tabset-12-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-5-tab">
<p>Ja, du kannst auch eine zweifakorielle ANOVA in Excel rechnen. Das ist dann mit etwas mehr Aufwand verbunden was die Daten angeht, aber am Ende kommt da auch was raus. Auch hier dann mehr dazu in dem folgenden Video. Ich würde es dir aber wirklich nicht empfehlen eine zweifaktorielle ANOVA in Excel zu rechen. Wirklich nicht.</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/ZkfRnsQkAD8" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
</div>
</div>
</div>
<p>Nachdem wir einmal die p-Werte aus unserer zweifaktoriellen ANOVA erhalten und dann noch geschaut haben, ob wir ein signifikantes Ergebnis haben, können wir jetzt weiter machen. Was fehlt noch? Wir müssen noch schauen, ob wir einen Effekt zwischen den Gruppen in unserem Faktoren vorliegen haben. Eine Signifikanz bedeutet ja nicht gleich Relevanz und deshalb berechnen wir auch gerne einmal einen Effektschätzer. Ein Effektschätzer sagt dir, wie stark sich die Gruppen voneinander unterscheiden. Oder anders herum formuliert, wie stark ist der Einfluss des Faktors auf den Messwert? Dann schauen wir uns noch die Möglichkeit einmal an mit dem R Paket <code>{report}</code> eine bessere Ausgabe zu erhalten. Das funktioniert aber nicht bei allen Implementierungen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">Effektschätzer</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">R Paket <code>{report}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<p>Auch hier betrachten wir dann alle drei Effektschätzer <span class="math inline">\(\eta^2\)</span> (eng. <em>eta squared</em>) sowie das <span class="math inline">\(\epsilon^2\)</span> (eng. <em>epsilon squared</em>) und das <span class="math inline">\(\omega^2\)</span> (eng. <em>omega squared</em>). Hier ist dann zu beachten, dass das <span class="math inline">\(\eta^2\)</span> für mehrere Faktoren nicht mehr so gut den Anteil der Varianz, die duch die Behandlung erklärt wird, wiedergibt. Hier ist dann das <span class="math inline">\(\epsilon^2\)</span> sowie das <span class="math inline">\(\omega^2\)</span> besser geeignet. Die Interpretation ist gleich, aber wir haben eine bessere Schätzung der Werte unter Berücksichtigung der zwei Faktoren und der Interaktion. Die 95% Konfidenzintervalle sind meiner Meinung nach schwer zu interpretieren, wenn die Fallzahl klein ist.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">eta_squared</span>() <span class="sc">|&gt;</span> </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interpret_eta_squared</span>(<span class="at">rules =</span> <span class="st">"field2013"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA (Type I)

Parameter   | Eta2 (partial) |       95% CI | Interpretation
------------------------------------------------------------
animal      |           0.49 | [0.32, 1.00] |          large
site        |           0.02 | [0.00, 1.00] |          small
animal:site |           0.25 | [0.09, 1.00] |          large

- One-sided CIs: upper bound fixed at [1.00].
- Interpretation rule: field2013</code></pre>
</div>
</div>
<p>Wir nehmen hier die Regeln nach <span class="citation" data-cites="field2013discovering">Field (<a href="#ref-field2013discovering" role="doc-biblioref">2013</a>)</span> um zu entscheiden, wie bedeutend der Wert von <span class="math inline">\(\eta^2\)</span> ist. Hier kommt es dann aber auch auf das Experiment an. In einem geplanten Feldexperiment, wo nur die Gruppen variieren, sollte <span class="math inline">\(\eta^2\)</span> größer als 70% sein.</p>
<p>Dann schauen wir uns noch das <span class="math inline">\(\epsilon^2\)</span> einmal an. Auch hier haben wir ähnliche Werte. Der größte Teil der Varianz in unseren Sprungweiten, nähmlich fast 50%, wird von den Floharten erklärt. Der Rest fällt dann auf die Interaktion.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">epsilon_squared</span>() <span class="sc">|&gt;</span> </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interpret_epsilon_squared</span>(<span class="at">rules =</span> <span class="st">"field2013"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA (Type I)

Parameter   | Epsilon2 (partial) |       95% CI | Interpretation
----------------------------------------------------------------
animal      |               0.47 | [0.30, 1.00] |          large
site        |           4.85e-03 | [0.00, 1.00] |     very small
animal:site |               0.22 | [0.07, 1.00] |          large

- One-sided CIs: upper bound fixed at [1.00].
- Interpretation rule: field2013</code></pre>
</div>
</div>
<p>Das <span class="math inline">\(\omega^2\)</span> berücksichtigt die Faktoren besser und adjustiert für die drei Berechnungen des <span class="math inline">\(\omega^2\)</span>-Wertes für den Faktor <code>animal</code> sowie <code>site</code> und der Interaktion. Bei mehr als einem Faktor ist dann das <span class="math inline">\(\omega^2\)</span> vorzuziehen. Hier ist dann der erklärte Anteil der Varianz der Floharten auch etwas niedriger und nur noch bei 45%.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">omega_squared</span>() <span class="sc">|&gt;</span> </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interpret_omega_squared</span>(<span class="at">rules =</span> <span class="st">"field2013"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA (Type I)

Parameter   | Omega2 (partial) |       95% CI | Interpretation
--------------------------------------------------------------
animal      |             0.45 | [0.28, 1.00] |          large
site        |         4.44e-03 | [0.00, 1.00] |     very small
animal:site |             0.21 | [0.06, 1.00] |          large

- One-sided CIs: upper bound fixed at [1.00].
- Interpretation rule: field2013</code></pre>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<p>Das <a href="https://easystats.github.io/report/">R Paket <code>{report}</code></a> liefert nochmal die Möglichkeit sich die Ausgabe einer zweifaktoriellen ANOVA in Textform wiedergeben zu lassen. Wie immer, wenn man alleine vor dem Rechner sitzt, ist das doch eine super Hilfestellung. Hier dann einmal mit der <code>Anova()</code> Funktion aus dem R Paket <code>{car}</code>. Ich mag hier besonders die Hilfe bei einer zweifaktoriellen ANOVA. Hier wird es dann sehr schnell sehr unübersichtlich und da ist doch die <code>report()</code> Funktion hilfreich.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">report</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>The ANOVA suggests that:

  - The main effect of animal is statistically significant and large (F(2, 54) =
25.74, p &lt; .001; Eta2 (partial) = 0.49, 95% CI [0.32, 1.00])
  - The main effect of site is statistically not significant and small (F(1, 54)
= 1.27, p = 0.265; Eta2 (partial) = 0.02, 95% CI [0.00, 1.00])
  - The interaction between animal and site is statistically significant and
large (F(2, 54) = 8.89, p &lt; .001; Eta2 (partial) = 0.25, 95% CI [0.09, 1.00])

Effect sizes were labelled following Field's (2013) recommendations.</code></pre>
</div>
</div>
<p>Dann können wir uns die Ergebnistabelle der ANOVA nochmal schöner mit der Funktion <code>report_table()</code> wiedergeben lassen. Wie immer funktioniert das Paket <code>{report}</code> nicht mit jeder Implementierung der ANOVA.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">report_table</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter   | Sum_Squares | df | Mean_Square |     F |      p | Eta2 (partial) | Eta2_partial 95% CI
----------------------------------------------------------------------------------------------------
animal      |      171.13 |  2 |       85.56 | 25.74 | &lt; .001 |           0.49 |        [0.32, 1.00]
site        |        4.21 |  1 |        4.21 |  1.27 | 0.265  |           0.02 |        [0.00, 1.00]
animal:site |       59.10 |  2 |       29.55 |  8.89 | &lt; .001 |           0.25 |        [0.09, 1.00]
Residuals   |      179.47 | 54 |        3.32 |       |        |                |                    </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Wenn du die ANOVA in deiner Abschlussarbeit anwendest, musst du jetzt noch schauen, welche paarweisen Gruppenvergleiche in deinem Faktor signifikant sind. Das würden wir dann in einem Post-hoc Test am Ende machen. Das war dann auch schon fast mit der zweifaktoriellen ANOVA, wenn es nicht noch die Interaktion zwischen den beiden Faktoren geben würde. Hier werfen wir dann nochmal einen Blick drauf.</p>
</section>
<section id="interaktion" class="level3" data-number="31.7.2">
<h3 data-number="31.7.2" class="anchored" data-anchor-id="interaktion"><span class="header-section-number">31.7.2</span> Interaktion</h3>
<p>In dem theoretischen Hintergrund habe ich dir verschiedene Arten gezeigt sich die Interaktion zu visualiseren. Ich nutze jetzt hier nur das Liniendiagramm in <code>{ggplot}</code> und dann noch die Darstellung aus dem <a href="https://interactions.jacob-long.com/">R Paket <code>{interactions}</code></a>. Ebenso habe ich die Beschreibung der Abbildungen auf das wesentliche reduziert. Selten zeigst du diese Abbildungen prominent sondern eher im Anhang oder du nutzt diese Abbidlungen nur in deiner statistischen Analyse. Ich jedenfalls schaue mir gerne die Interaktion einmal an und vergleiche so die Abbildung mit den Ergebnissen einer ANOVA. Beides muss immer zusammenpassen.</p>
<dl>
<dt>Was ist das Problem einer Interaktion?</dt>
<dd>
<p>Wenn du eine Interaktion zwischen deinen beiden Faktoren vorliegen hast, dann kannst du keine allgemeine Aussage über die Gruppen der beiden Faktoren treffen. Die Effekte und Unterschiede, die du nachweist, hängen davon ab welche Faktorkombination du betrachtest. Manchmal willst du eien solche Interaktion zeigen, aber häufig wird eine Interaktion als störend in einem Experiment wahrgenommen.</p>
</dd>
</dl>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true"><code>{ggplot}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false"><code>{interactions}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<p>Betrachten wir also einmal die Interaktion zwischen den beiden Faktoren <code>animal</code> und <code>site</code> anhand eines Liniendiagramms welches uns die Mittelwerte aller sechs Faktorkombinationen zeigt. Wenn wir <em>keine</em> Interaktion vorliegen haben, dann laufen die Linien parallel zueinander. Wenn wir <em>eine</em> Interaktion vorliegen haben, dann beginnen sich die Linien anzunähern oder bewegen sich voneinander weg. Bei einer starken Interaktion kreuzen sich die Geraden. Wir du in der folgenden Abbildung sehen kannst, haben wir eine starke Interaktion zwischen unseren beiden Faktoren vorliegen. Die Floharten verhalten sich nicht gleich über die beiden Messorte. Es macht eben einen Unterschied wo du die Floharten misst.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>fac2_tbl <span class="sc">|&gt;</span> </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length,</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> site, <span class="at">group =</span> site)) <span class="sc">+</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-interactionplot-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-interactionplot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-interactionplot-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-30" title="Abbildung&nbsp;31.28— Liniendigramm mit den Mittelwerten aller sechs Faktorkombinationen der beiden Faktoren animal und site. Die Linien kreuzen sich, es liegt eine starke Interaktion vor. Eine allgmeine Aussage über die Sprungweite und die Flohart lässt sich nicht unabhängig vom Messort treffen."><img src="stat-tests-anova2_files/figure-html/fig-interactionplot-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-interactionplot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.28— Liniendigramm mit den Mittelwerten aller sechs Faktorkombinationen der beiden Faktoren <code>animal</code> und <code>site</code>. Die Linien kreuzen sich, es liegt eine starke Interaktion vor. Eine allgmeine Aussage über die Sprungweite und die Flohart lässt sich nicht unabhängig vom Messort treffen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<p>Neben der händsich gebauten Variante in <code>{ggplot}</code> gibt es auch das <a href="https://interactions.jacob-long.com/">R Paket <code>{interactions}</code></a> mit der Funktion <code>car_plot()</code>. Hier übergeben wir ein Modell und erhalten dann aus dem Modell ein Liniendiagramm zur Bewertung der Interaktion. Wie immer kann das Paket mehr als diese eine Funktion. Aber hier soll es dann erstmal so reichen. Die Funktion erstellt dann noch Fehlerbalken, die meiner Meinung nach nicht sein müssten, aber ich lasse diese mal hier mit drin. Die Aussage ist aber die gleiche wie bei <code>{ggplot}</code>, die Linien kreuzen sich, es ist von einer starken Interaktion auszugehen. Eine allgemeine Aussage über die Sprungweite und die Floharten ist nicht möglich ohne die Betrachtung des jeweiligen Messortes.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat_plot</span>(<span class="at">modx =</span> site, <span class="at">pred =</span> animal, <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-interactionplot-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-interactionplot-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-interactionplot-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-31" title="Abbildung&nbsp;31.29— Liniendigramm mit den Mittelwerten aller sechs Faktorkombinationen der beiden Faktoren animal und site. Die Linien kreuzen sich, es liegt eine starke Interaktion vor. Eine allgmeine Aussage über die Sprungweite und die Flohart lässt sich nicht aunabhängig vom Messort treffen."><img src="stat-tests-anova2_files/figure-html/fig-interactionplot-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-interactionplot-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.29— Liniendigramm mit den Mittelwerten aller sechs Faktorkombinationen der beiden Faktoren <code>animal</code> und <code>site</code>. Die Linien kreuzen sich, es liegt eine starke Interaktion vor. Eine allgmeine Aussage über die Sprungweite und die Flohart lässt sich nicht aunabhängig vom Messort treffen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Das war dann auch die zweifaktorielle ANOVA. Wenn du die ANOVA in deiner Abschlussarbeit anwendest, musst du jetzt noch schauen, welche paarweisen Gruppenvergleiche in deinen Faktoren signifikant sind. Jetzt könnte man sagen, dafür brauchst du eine signifikante ANOVA, aber meistens machen wir dann doch den ANOVA Pfad zu Ende und testen nochmal alles mit einem <a href="stat-tests-posthoc2.html">Post-hoc Test</a> durch.</p>
</section>
</section>
<section id="mehrfaktorielle-anova" class="level2" data-number="31.8">
<h2 data-number="31.8" class="anchored" data-anchor-id="mehrfaktorielle-anova"><span class="header-section-number">31.8</span> Mehrfaktorielle ANOVA</h2>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Achtung, bitte beachten!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Die Erfahrung aus meiner statistischen Beratung zeigt oft, dass du gar keine mehrfaktorielle ANOVA im eigentlichen Sinne vorliegen hast, sondern manchmal in den Daten und den Faktoren verloren bist. Deshalb empfiehlt es sich hier nochmal innezuhalten und zu überlegen, was deine Fragestellung ist und du <em>wirklich</em> alle Faktoren und deren Wechselwirkungen mit ins Modell nehmen willst.</p>
</div>
</div>
<p>Wenn es die zweifaktorielle ANOVA gibt dann gibt es natürlich auch noch mehr als nur zwei Faktoren in einer ANOVA. Wir können auch eine mherfaktorielle ANOVA rechnen. Ich habe hier einen vierfaktoriellen Datensatz, den wir uns aber als einen dreifaktoriellen Datensatz in <code>{WRS2}</code> anschauen werden. Nicht jedes Paket kann mit mehr als drei Faktoren umgehen. Das hat den Grund, dass eigentlich in der Anwendung kaum Designs mit mehr als drei Behandlungsfaktoren auftreten. Die zusätzlichen Faktoren sind dann meistens Randomisierungseinheiten wie Block oder Spalte sowie Zeile.</p>
<dl>
<dt>Habe ich wirklich mehr als drei Behandlungsfaktoren?</dt>
<dd>
<p>Das ist eine <em>sehr wichtige</em> Frage. Häufig kann es sein, dass du eben wirklich eine zeitliche Komponente als Fakotr mit in deeinen Daten hast. Dann willst du vielleicht eine <a href="stat-tests-anova-mixed.html">repeated ANOVA oder eine mixed ANOVA</a> rechnen. Manchmal haben wir auch eine lokale Komponente mit drin, dann ist die Frage, ob du hier nicht über den Ort mittlen willst. Deshalb muss man hier immer sehr genau schauen, was ist eigentlich die wissenschaftliche Fragestellung und was habe ich in den Daten.</p>
</dd>
</dl>
<p>Wir schauen usn als mehrfaktoriellen Datensatz jetzt einmal eine große Studie zu der Sprungweite von Floharten <code>animal</code> in verschiedenen Orten <code>site</code> sowie verschiedenen Entwicklungsstadien <code>stage</code> an. Dann messen wir alles nochmal im Sommer und im Winter und haben so noch den Faktor <code>season</code> mit in unserem Modell. Teilweise wird es jetzt in den verschiedenen Implementierungen recht wild, aber das liegt eben daran, dass so eine vierfaktorielle ANOVA eben dann doch schon ein echtes Extrem ist. Insbesondere bei der mehrfaktroiellen ANOVA bietet es sich an die Ergebnisse mit der Funktion <code>filter()</code> nach den signifikanten p-Werten zu filtern, so dass alles übersichtlicher bleibt.</p>
<section id="haupteffekte-1" class="level3" data-number="31.8.1">
<h3 data-number="31.8.1" class="anchored" data-anchor-id="haupteffekte-1"><span class="header-section-number">31.8.1</span> Haupteffekte</h3>
<p>In unserem Fall haben wir jetzt vier Haupteffekte. Das ist eher selten der Fall und man könnte auch meinen, dass die Modellierung der Jahreszeiten oder aber der Messorte so nicht unbedingt nötig ist, aber da wir auch nur zwei Jahreszeiten sowie zwei Messorte haben, machen wir das jetzt mal so. In der Praxis haben wir dann bei so vielen Faktoren dann nicht noch sehr viele Level pro Faktor. Denke an die Regel, dass du eben nur weißt, dass wir einen Gruppenunterschied irgendwo im Faktor haben, wenn der p-Wert kleiner als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5% ist.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true"><code>{base}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false"><code>{car}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-3" role="tab" aria-controls="tabset-15-3" aria-selected="false"><code>{afex}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-4" role="tab" aria-controls="tabset-15-4" aria-selected="false"><code>{WRS2}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<p>Dann wollen wir mal anfangen. Ich zeige jetzt hier nur die <code>aov()</code> Variante. Du findest dann bei der zweifaktoriellen ANOVA auch den Code für die <code>lm()</code> Variante mit der Funktion <code>anova()</code>. Hier wird das dann aber viel zu viel Output, der dann einfach gleich ist. Darüber hinaus findest du die Modellierung dann auch im Tab zum R Paket <code>{car}</code>. Ich schreibe hier einmal die Modellschreibweise mit dem Malzeichen <code>*</code> da ich selber nie und nimmer alle Faktorkombinationen hinkriege noch tippen will. Bedenke hier, es kommt bei der <code>aov()</code> auf die Reihenfolge der Faktoren an. Wir haben ja hier eine Type I ANOVA vorliegen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>stage<span class="sc">*</span>site<span class="sc">*</span>season, <span class="at">data =</span> fac4_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 6
   term                        df    sumsq   meansq statistic p.value
   &lt;chr&gt;                    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  
 1 animal                       2 6194.    3097.     252.     &lt;0.001 
 2 stage                        1    7.73     7.73     0.629  0.429  
 3 site                         1  106.     106.       8.64   0.004  
 4 season                       1 1029.    1029.      83.7    &lt;0.001 
 5 animal:stage                 2  530.     265.      21.6    &lt;0.001 
 6 animal:site                  2  652.     326.      26.5    &lt;0.001 
 7 stage:site                   1    0.337    0.337    0.0274 0.869  
 8 animal:season                2   14.8      7.42     0.604  0.548  
 9 stage:season                 1    6.65     6.65     0.541  0.463  
10 site:season                  1   29.6     29.6      2.41   0.122  
11 animal:stage:site            2   14.4      7.19     0.585  0.558  
12 animal:stage:season          2   60.5     30.3      2.46   0.088  
13 animal:site:season           2  327.     164.      13.3    &lt;0.001 
14 stage:site:season            1   12.9     12.9      1.05   0.307  
15 animal:stage:site:season     2   82.4     41.2      3.35   0.037  
16 Residuals                  168 2064.      12.3     NA      &lt;NA&gt;   </code></pre>
</div>
</div>
<p>Wir treten einen Schritt zurück und erschaudern bei dem Output. Hier hilft es dann wirklich nochmal die Funktion <code>filter()</code> und <code>select()</code> zu nutzen um sich einen kleineren Datensatz mit den wichtigen Informationen zu bauen. Ich sehe da sonst nichts mehr und wir übersehen dann mal schnell einen signifikanten p-Wert und das wäre ja nicht so gut.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>stage<span class="sc">*</span>site<span class="sc">*</span>season, <span class="at">data =</span> fac4_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p.value <span class="sc">&lt;=</span> <span class="fl">0.05</span>) <span class="sc">|&gt;</span> </span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, p.value) <span class="sc">|&gt;</span> </span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value)) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
  term                     p.value
  &lt;chr&gt;                    &lt;chr&gt;  
1 animal                   &lt;0.001 
2 site                     0.004  
3 season                   &lt;0.001 
4 animal:stage             &lt;0.001 
5 animal:site              &lt;0.001 
6 animal:site:season       &lt;0.001 
7 animal:stage:site:season 0.037  </code></pre>
</div>
</div>
<p>Was sehen wir jetzt? Zum einen, dass wir signifikante Haupteffekte vorliegen haben. Der Entwicklungsstatus ist als einiziges nicht signifikant. Darüber hinaus haben wir noch eine Menge signifikante Interaktionen. Das schauen wir uns dann nochmal separat in dem Abschnitt zu den Interaktionen weiter unten an.</p>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<p>Jetzt könnte man meinen, warum noch eine weitere Implementierung der ANOVA, wenn wir schon die Funktion <code>aov()</code> haben? Die Funktion <code>aov()</code> rechnet grundsätzlich Type I ANOVAs. Das macht jetzt bei einer mehrfaktoriellen ANOVA schon einen gewaltigen Unterschied ausmachen welchen Typ ANOVA wir rechnen. Wir können eben in <code>{car}</code> auch Type II und Type III ANOVAs rechnen. Darüber hinaus erlaubt das Paket auch für Varianzheterogenität in der ANOVA zu adjustieren.</p>
<section id="varianzhomogenität-2" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="varianzhomogenität-2">Varianzhomogenität</h4>
<p>In dem klassischen Aufruf der Funktion <code>Anova()</code> nutzen wir ein Modell und dann gebe ich dir wieder die aufgeräumte Ausgabe mit <code>tidy()</code> wieder. Wenn du nichts extra angibst, dann rechnest du natürlich eine ANOVA unter der Annahme der Varianzhomogenität.</p>
<dl>
<dt>Keine Interaktion zwischen den Faktoren A und B</dt>
<dd>
<p>Wir rechnen dann eine Type II ANOVA, wenn wir keine Interaktion zwischen den Faktoren vorliegen haben. Ja, dass müssen wir dann natürlich vorab einmal Testen, dazu kannst du einfach die Funktion <code>aov()</code> nutzen. Wenn wir keine Interaktion vorliegen haben, dann nehmen wir auch die Interaktion aus dem Modell und testen nur die Haupteffekte mit einer Type II ANOVA. Manchmal ist das ganz gut, damit wir überhaupt mal eine Übersicht kriegen.</p>
</dd>
</dl>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> stage <span class="sc">+</span> site <span class="sc">+</span> season, <span class="at">data =</span> fac4_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>(<span class="at">type =</span> <span class="st">"II"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()  <span class="sc">|&gt;</span> </span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  term        sumsq    df statistic p.value
  &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  
1 animal    6194.       2   152.    &lt;0.001 
2 stage        7.73     1     0.379 0.539  
3 site       106.       1     5.21  0.024  
4 season    1029.       1    50.4   &lt;0.001 
5 Residuals 3795.     186    NA     &lt;NA&gt;   </code></pre>
</div>
</div>
<dl>
<dt>Interaktion zwischen den Faktoren A und B</dt>
<dd>
<p>Wir rechnen dann eine Type III ANOVA, wenn wir eine Interaktion zwischen den beiden Faktoren vorliegen haben. Dann werden die Haupteffekte unter der Berücksichtigung der Interaktion berechnet. Aber Achtung, du musst leider in <code>{car}</code> die Kontraste anders definieren sonst testet die Funktion <code>Anova()</code> nicht das was sie soll. Da ist dann die Funktion <code>aov_car()</code> aus dem Paket <code>{afex}</code> anwenderfreundlicher.</p>
</dd>
</dl>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>stage<span class="sc">*</span>site<span class="sc">*</span>season, <span class="at">data =</span> fac4_tbl,</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">contrasts =</span> <span class="fu">list</span>(</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">animal =</span> <span class="st">"contr.sum"</span>,</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">stage =</span> <span class="st">"contr.sum"</span>,</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">site =</span> <span class="st">"contr.sum"</span>,</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="st">"contr.sum"</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>(<span class="at">type =</span> <span class="st">"III"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()  <span class="sc">|&gt;</span> </span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 17 × 5
   term                          sumsq    df  statistic p.value
   &lt;chr&gt;                         &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;  
 1 (Intercept)              163784.        1 13329.     &lt;0.001 
 2 animal                     6194.        2   252.     &lt;0.001 
 3 stage                         7.73      1     0.629  0.429  
 4 site                        106.        1     8.64   0.004  
 5 season                     1029.        1    83.7    &lt;0.001 
 6 animal:stage                530.        2    21.6    &lt;0.001 
 7 animal:site                 652.        2    26.5    &lt;0.001 
 8 stage:site                    0.337     1     0.0274 0.869  
 9 animal:season                14.8       2     0.604  0.548  
10 stage:season                  6.65      1     0.541  0.463  
11 site:season                  29.6       1     2.41   0.122  
12 animal:stage:site            14.4       2     0.585  0.558  
13 animal:stage:season          60.5       2     2.46   0.088  
14 animal:site:season          327.        2    13.3    &lt;0.001 
15 stage:site:season            12.9       1     1.05   0.307  
16 animal:stage:site:season     82.4       2     3.35   0.037  
17 Residuals                  2064.      168    NA      &lt;NA&gt;   </code></pre>
</div>
</div>
<p>Auch hier hilft ein Filtern weiter. Ansonsten sieht man echt überhaupt nichts und wir kommen nur durcheinander. Was du auf jeden Fall schon mal siehst, wenn es mehr Faktoren werden, dann macht der Typ der ANOVA schon was aus. Wir haben hier am Ende aber die gleichen signifikanten Ergebnisse wie bei der <code>aov()</code> vorliegen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>stage<span class="sc">*</span>site<span class="sc">*</span>season, <span class="at">data =</span> fac4_tbl,</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">contrasts =</span> <span class="fu">list</span>(</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">animal =</span> <span class="st">"contr.sum"</span>,</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">stage =</span> <span class="st">"contr.sum"</span>,</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">site =</span> <span class="st">"contr.sum"</span>,</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="st">"contr.sum"</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>(<span class="at">type =</span> <span class="st">"III"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p.value <span class="sc">&lt;=</span> <span class="fl">0.05</span>) <span class="sc">|&gt;</span> </span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, p.value) <span class="sc">|&gt;</span> </span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value)) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 2
  term                     p.value
  &lt;chr&gt;                    &lt;chr&gt;  
1 (Intercept)              &lt;0.001 
2 animal                   &lt;0.001 
3 site                     0.004  
4 season                   &lt;0.001 
5 animal:stage             &lt;0.001 
6 animal:site              &lt;0.001 
7 animal:site:season       &lt;0.001 
8 animal:stage:site:season 0.037  </code></pre>
</div>
</div>
</section>
<section id="varianzheterogenität-2" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="varianzheterogenität-2">Varianzheterogenität</h4>
<p>Der Vorteil des Pakets <code>{car}</code> ist, dass wir in der Funktion <code>Anova()</code> auch für Varianzheterogenität adjustieren können. Wir nutzen dazu die Option <code>white.adjust = TRUE</code>. Ich gehe hier jetzt nicht näher auf die Ausgabe ein. Die Ausgabe ist analog zu den anderen Ergebnissen zu interpretieren. Ich habe hier jetzt gleich gefiltert damit die Ausgabe etwas aufgeräumter ist.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>stage<span class="sc">*</span>site<span class="sc">*</span>season, <span class="at">data =</span> fac4_tbl,</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">contrasts =</span> <span class="fu">list</span>(</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">animal =</span> <span class="st">"contr.sum"</span>,</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">stage =</span> <span class="st">"contr.sum"</span>,</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">site =</span> <span class="st">"contr.sum"</span>,</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="st">"contr.sum"</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>(<span class="at">white.adjust =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="st">"III"</span>)  <span class="sc">|&gt;</span> </span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p.value <span class="sc">&lt;=</span> <span class="fl">0.05</span>) <span class="sc">|&gt;</span> </span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, p.value) <span class="sc">|&gt;</span> </span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value)) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Coefficient covariances computed by hccm()</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 2
  term                     p.value
  &lt;chr&gt;                    &lt;chr&gt;  
1 (Intercept)              &lt;0.001 
2 animal                   &lt;0.001 
3 site                     0.007  
4 season                   &lt;0.001 
5 animal:stage             &lt;0.001 
6 animal:site              &lt;0.001 
7 animal:site:season       &lt;0.001 
8 animal:stage:site:season 0.026  </code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-15-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-3-tab">
<p>Der Vorteil von dem R Paket <code>{afex}</code> ist, dass wir hier mit der Funktion <code>aov_car()</code> eine Type III ANOVA rechnen, die korrekt angepasst ist. Wir müssen also nicht noch extra ein Modell mit Kontrasten anpassen. Wir können auch die ANOVA Type II rechnen indem wir di Option <code>type = "II"</code> wählen. Dazu dann einfach einmal bei der zweifaktoriellen ANOVA reinschauen, da zeige ich den Code dazu. Eine Besonderheit ist, dass wir einen Fehlerterm mit <code>Error()</code> der Funktion übergeben müssen, damit <code>{afex}</code> rechnen kann. Die Stärke von <code>{afex}</code> liegt eigentlich in der repeated und mixed ANOVA. Dort brauchen wir dann die Information zwingend, welche Zeile zu welcher Beobachtung gehört. Ich verzichte hier auf die Aufteilung mit und ohne Interaktion.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>stage<span class="sc">*</span>site<span class="sc">*</span>season <span class="sc">+</span> <span class="fu">Error</span>(.id), </span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> fac4_tbl) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Contrasts set to contr.sum for the following variables: animal, stage, site, season</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: jump_length
                     Effect     df   MSE          F   ges p.value
1                    animal 2, 168 12.29 252.05 ***  .750   &lt;.001
2                     stage 1, 168 12.29       0.63  .004    .429
3                      site 1, 168 12.29    8.64 **  .049    .004
4                    season 1, 168 12.29  83.73 ***  .333   &lt;.001
5              animal:stage 2, 168 12.29  21.57 ***  .204   &lt;.001
6               animal:site 2, 168 12.29  26.52 ***  .240   &lt;.001
7                stage:site 1, 168 12.29       0.03 &lt;.001    .869
8             animal:season 2, 168 12.29       0.60  .007    .548
9              stage:season 1, 168 12.29       0.54  .003    .463
10              site:season 1, 168 12.29       2.41  .014    .122
11        animal:stage:site 2, 168 12.29       0.58  .007    .558
12      animal:stage:season 2, 168 12.29     2.46 +  .028    .088
13       animal:site:season 2, 168 12.29  13.32 ***  .137   &lt;.001
14        stage:site:season 1, 168 12.29       1.05  .006    .307
15 animal:stage:site:season 2, 168 12.29     3.35 *  .038    .037
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Ja, dann ist das Filtern der <code>{afex}</code> Ausgabe dann doch etwas nerviger als gedacht. Dennoch solltest du das tun, denn dann sehen wir besser, was hier eigentlich signifikant ist. Die Ausgabe von <code>aov_car()</code> kürzt so seltsam die p-Werte, so dass es noch unübersichtlicher wird für mich. Die Ausgabe ist dann wie immer zu interpretieren nur das wir eben schon alle signifkanten p-Werte gefiltert haben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>stage<span class="sc">*</span>site<span class="sc">*</span>season <span class="sc">+</span> <span class="fu">Error</span>(.id), </span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> fac4_tbl) <span class="sc">|&gt;</span>  </span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"anova_table"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"term"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pr_f <span class="sc">&lt;=</span> <span class="fl">0.05</span>) <span class="sc">|&gt;</span> </span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, pr_f) <span class="sc">|&gt;</span> </span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pr_f =</span> <span class="fu">pvalue</span>(pr_f)) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Contrasts set to contr.sum for the following variables: animal, stage, site, season</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
  term                     pr_f  
  &lt;chr&gt;                    &lt;chr&gt; 
1 animal                   &lt;0.001
2 site                     0.004 
3 season                   &lt;0.001
4 animal:stage             &lt;0.001
5 animal:site              &lt;0.001
6 animal:site:season       &lt;0.001
7 animal:stage:site:season 0.037 </code></pre>
</div>
</div>
</div>
<div id="tabset-15-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-4-tab">
<p>Das <a href="https://cran.r-project.org/web/packages/WRS2/vignettes/WRS2.pdf">R Paket <code>{WRS2}</code></a> von <span class="citation" data-cites="mair2020robust">Mair &amp; Wilcox (<a href="#ref-mair2020robust" role="doc-biblioref">2020</a>)</span> erlaubt es auch bei nicht normalverteilten Daten sowie Varianzheterogenität eine ANOVA zu rechnen. Dabei ist die maximale Anzahl an Faktoren auf drei Faktoren begrenzt. Daher können wir auch nur eine dreifaktorielle ANOVA (eng. <em>three-way ANOVA</em>) rechnen. Ich habe mich dazu entschieden dann die Entwicklungsstatdien aus dem Modell zu nehmen, da diese ja in den anderen Implementierungen nicht signifikant waren. Daher kann es sich lohnen mal mit den Implementierungen zu spielen und zu schauen, was da so rauskommt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t3way</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>site<span class="sc">*</span>season, <span class="at">data =</span> fac4_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
t3way(formula = jump_length ~ animal * site * season, data = fac4_tbl)

                        value p.value
animal             396.190830  0.0001
site                 7.032921  0.0110
season              53.603295  0.0010
animal:site         43.075907  0.0010
animal:season        1.897799  0.4010
site:season          1.218229  0.2750
animal:site:season  21.974268  0.0010</code></pre>
</div>
</div>
<p>In dem dreifaktoriellen Fall bleibt ja die Ergebnistabelle relativ übersichtlich. Wir sehen hier ähnliche Ergebnisse wie bei den anderen Implementierungen und die Entscheidungen nach dem p-Wert bleiben auch hier gleich. Einzig die Interaktionen zwischen den Jahreszeiten und Floharten sowie dem Messort sind nicht signifikant.</p>
</div>
</div>
</div>
<p>Nachdem wir einmal die p-Werte aus unserer mehrfaktoriellen ANOVA erhalten und dann noch geschaut haben, ob wir ein signifikantes Ergebnis haben, können wir jetzt weiter machen. Was fehlt noch? Wir müssen noch schauen, ob wir einen Effekt zwischen den Gruppen in unserem Faktoren vorliegen haben. Eine Signifikanz bedeutet ja nicht gleich Relevanz und deshalb berechnen wir auch gerne einmal einen Effektschätzer. Ein Effektschätzer sagt dir, wie stark sich die Gruppen voneinander unterscheiden. Oder anders herum formuliert, wie stark ist der Einfluss des Faktors auf den Messwert? Dann schauen wir uns noch die Möglichkeit einmal an mit dem R Paket <code>{report}</code> eine bessere Ausgabe zu erhalten. Das funktioniert aber nicht bei allen Implementierungen. Insbesondere in einer mehrfaktoriellen ANOVA ist es jetzt wichtig zu schauen, ob die Interaktionen überhaupt eine Bedeutung haben oder wir die Interaktionen dann doch vom Effekt her als irrelevant betrachten können.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true">Effektschätzer</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false">R Paket <code>{report}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<p>In einer mehrfaktoriellen ANOVA lassen wir den Effektschätzer für <span class="math inline">\(\eta^2\)</span> (eng. <em>eta squared</em>) weg und konzentrieren uns auf das <span class="math inline">\(\epsilon^2\)</span> (eng. <em>epsilon squared</em>) und das <span class="math inline">\(\omega^2\)</span> (eng. <em>omega squared</em>). Das <span class="math inline">\(\eta^2\)</span> ist nicht geeigent für mehrere Faktoren und da sind dann die anderen beiden Effektschätzer besser und auch für ausgelegt. Ich nutze dann noch die Filterfunktion um mir nur die Werte anzeigen zu lassen, die über <span class="math inline">\(0.01\)</span> liegen. Hier kannst du auch noch strenger filtern, aber filtern solltest du. Dann sortiere ich mir noch die Werte absteigend <code>desc()</code> mit der Funktion <code>arrange()</code>. Auch hier kannst du die Werte für die 95% Konfidenzintervalle bei unserer kleinen Fallzahl ignorieren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>stage<span class="sc">*</span>site<span class="sc">*</span>season, <span class="at">data =</span> fac4_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">epsilon_squared</span>() <span class="sc">|&gt;</span> </span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Epsilon2_partial <span class="sc">&gt;=</span> <span class="fl">0.01</span>) <span class="sc">|&gt;</span> </span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Epsilon2_partial)) <span class="sc">|&gt;</span> </span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interpret_epsilon_squared</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA (Type I)

Parameter                | Epsilon2 (partial) |       95% CI | Interpretation
-----------------------------------------------------------------------------
animal                   |               0.75 | [0.70, 1.00] |          large
season                   |               0.33 | [0.24, 1.00] |          large
animal:site              |               0.23 | [0.14, 1.00] |          large
animal:stage             |               0.19 | [0.11, 1.00] |          large
animal:site:season       |               0.13 | [0.05, 1.00] |         medium
site                     |               0.04 | [0.01, 1.00] |          small
animal:stage:site:season |               0.03 | [0.00, 1.00] |          small
animal:stage:season      |               0.02 | [0.00, 1.00] |          small

- One-sided CIs: upper bound fixed at [1.00].
- Interpretation rule: field2013</code></pre>
</div>
</div>
<p>Wir sehen, dass die Interaktionen dann doch einen Teil der Varianz ausmachen. Die Werte addieren sich ja nicht mehr auf Eins auf, aber dennoch können wir die Werte realtiv zueinander vergleichen. Wir haben hier eben dann doch einen starken Einfluss auf die Sprungweite durch die Faktorombinationen und damit wo, wann und was wir messen. Wir sehen den gleichen Trend dann auch im Folgenden für die <span class="math inline">\(\omega^2\)</span> Werte.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>stage<span class="sc">*</span>site<span class="sc">*</span>season, <span class="at">data =</span> fac4_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">omega_squared</span>() <span class="sc">|&gt;</span> </span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Omega2_partial <span class="sc">&gt;=</span> <span class="fl">0.01</span>) <span class="sc">|&gt;</span> </span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Omega2_partial)) <span class="sc">|&gt;</span> </span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interpret_omega_squared</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA (Type I)

Parameter                | Omega2 (partial) |       95% CI | Interpretation
---------------------------------------------------------------------------
animal                   |             0.72 | [0.67, 1.00] |          large
season                   |             0.30 | [0.21, 1.00] |          large
animal:site              |             0.21 | [0.12, 1.00] |          large
animal:stage             |             0.18 | [0.09, 1.00] |          large
animal:site:season       |             0.11 | [0.04, 1.00] |         medium
site                     |             0.04 | [0.00, 1.00] |          small
animal:stage:site:season |             0.02 | [0.00, 1.00] |          small
animal:stage:season      |             0.02 | [0.00, 1.00] |          small

- One-sided CIs: upper bound fixed at [1.00].
- Interpretation rule: field2013</code></pre>
</div>
</div>
<p>Welche der beiden Maßzahlen der Effektschätzer sollest du nun berichten? Nach der Hilfeseite von dem R Paket <code>{effectsize}</code> ist <em>“Omega is the more popular choice”</em>. Daher würde ich dann zu den <span class="math inline">\(\omega^2\)</span> Werten in einer mehrfaktoriellen ANOVA tendieren. Mehr dazu dann aber weiter oben im Abschnitt zu der theoretischen Betrachtung der Effektschätzer in der ANOVA. Mehr dazu dann auch unter <a href="https://easystats.github.io/effectsize/articles/anovaES.html#other-measures-of-effect-size">Other Measures of Effect Size</a> auf der Hilfeseite des R Pakets <code>{effectsize}</code>.</p>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<p>Das <a href="https://easystats.github.io/report/">R Paket <code>{report}</code></a> liefert nochmal die Möglichkeit sich die Ausgabe einer zweifaktoriellen ANOVA in Textform wiedergeben zu lassen. Wie immer, wenn man alleine vor dem Rechner sitzt, ist das doch eine super Hilfestellung. Hier dann einmal mit der <code>Anova()</code> Funktion aus dem R Paket <code>{car}</code>. Ich mag hier besonders die Hilfe bei einer mehrfaktoriellen ANOVA. Hier wird es dann sehr schnell sehr unübersichtlich und da ist doch die <code>report()</code> Funktion hilfreich.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>stage<span class="sc">*</span>site<span class="sc">*</span>season, <span class="at">data =</span> fac4_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>() <span class="sc">|&gt;</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">report</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>The ANOVA suggests that:

  - The main effect of animal is statistically significant and large (F(2, 168) =
252.05, p &lt; .001; Eta2 (partial) = 0.75, 95% CI [0.70, 1.00])
  - The main effect of stage is statistically not significant and very small
(F(1, 168) = 0.63, p = 0.429; Eta2 (partial) = 3.73e-03, 95% CI [0.00, 1.00])
  - The main effect of site is statistically significant and small (F(1, 168) =
8.64, p = 0.004; Eta2 (partial) = 0.05, 95% CI [9.50e-03, 1.00])
  - The main effect of season is statistically significant and large (F(1, 168) =
83.73, p &lt; .001; Eta2 (partial) = 0.33, 95% CI [0.24, 1.00])
  - The interaction between animal and stage is statistically significant and
large (F(2, 168) = 21.57, p &lt; .001; Eta2 (partial) = 0.20, 95% CI [0.12, 1.00])
  - The interaction between animal and site is statistically significant and
large (F(2, 168) = 26.52, p &lt; .001; Eta2 (partial) = 0.24, 95% CI [0.15, 1.00])
  - The interaction between stage and site is statistically not significant and
very small (F(1, 168) = 0.03, p = 0.869; Eta2 (partial) = 1.63e-04, 95% CI
[0.00, 1.00])
  - The interaction between animal and season is statistically not significant
and very small (F(2, 168) = 0.60, p = 0.548; Eta2 (partial) = 7.14e-03, 95% CI
[0.00, 1.00])
  - The interaction between stage and season is statistically not significant and
very small (F(1, 168) = 0.54, p = 0.463; Eta2 (partial) = 3.21e-03, 95% CI
[0.00, 1.00])
  - The interaction between site and season is statistically not significant and
small (F(1, 168) = 2.41, p = 0.122; Eta2 (partial) = 0.01, 95% CI [0.00, 1.00])
  - The interaction between animal, stage and site is statistically not
significant and very small (F(2, 168) = 0.58, p = 0.558; Eta2 (partial) =
6.91e-03, 95% CI [0.00, 1.00])
  - The interaction between animal, stage and season is statistically not
significant and small (F(2, 168) = 2.46, p = 0.088; Eta2 (partial) = 0.03, 95%
CI [0.00, 1.00])
  - The interaction between animal, site and season is statistically significant
and medium (F(2, 168) = 13.32, p &lt; .001; Eta2 (partial) = 0.14, 95% CI [0.06,
1.00])
  - The interaction between stage, site and season is statistically not
significant and very small (F(1, 168) = 1.05, p = 0.307; Eta2 (partial) =
6.22e-03, 95% CI [0.00, 1.00])
  - The interaction between animal, stage, site and season is statistically
significant and small (F(2, 168) = 3.35, p = 0.037; Eta2 (partial) = 0.04, 95%
CI [1.21e-03, 1.00])

Effect sizes were labelled following Field's (2013) recommendations.</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Wenn du die ANOVA in deiner Abschlussarbeit anwendest, musst du jetzt noch schauen, welche paarweisen Gruppenvergleiche in deinem Faktor signifikant sind. Das würden wir dann in einem <a href="stat-tests-posthoc2.html">Post-hoc Test</a> am Ende machen. Das war dann auch schon fast mit der mehrfaktoriellen ANOVA, wenn es nicht noch die Interaktion zwischen den Faktoren geben würde. Hier werfen wir dann nochmal einen Blick drauf, denn das ist jetzt schon noch ein bedeutender Teil.</p>
</section>
<section id="interaktion-1" class="level3" data-number="31.8.2">
<h3 data-number="31.8.2" class="anchored" data-anchor-id="interaktion-1"><span class="header-section-number">31.8.2</span> Interaktion</h3>
<blockquote class="blockquote">
<p><em>“Auch Holzwege müssen zu Ende gegangen werden.” — Angela Merkel</em></p>
</blockquote>
<p>Die Interaktion in einem mehrfaktoriellen Modell kann einen ganz schön ins schwitzen bringen, wenn man sich nicht sehr gut mit dem Experiment und dem dahinterliegenden biologischen Zusammenhängen auskennt. Schnell kann man da auf dem Holzweg gelangen und irrt durch die Daten. Hier möchte ich mir dann auch die Interaktionen einmal visualiseren, so dass ich eine Idee bekomme was in den Daten los ist. Wir wissen ja schon durch die ANOVA, wo wir hinschauen müssen und welche Interaktionen wir zu erwarten haben.</p>
<dl>
<dt>Was sagt mir die signifikante Interaktion in einem mehrfaktoriellen Modell?</dt>
<dd>
<p>Wir haben ja in unserer ANOVA zwei signifikante Interaktionen höherer Ordnung. Das heißt, wir haben nicht nur eine Interaktion zwischen zwei Faktoren sondern drei oder mehr Faktoren. Das ist immer schwer zu interpretieren, wenn man nicht die Abbildungen dazu sieht. In der Anwendung heißen signifikante Interaktionen höherer Ordnung, dass wir unsere Ergebnisse nicht über alle Faktorkombinationen verallgemeinern können.</p>
</dd>
</dl>
<p>Da es bei den Interaktionen der höheren Ordnung schnell mal unübersichtlich wird habe ich nochmal eine Tabelle zur Erklärung erstellt. Dabei ist es wichtig zu wissen, dass die gesamte Interaktionen als ganzes zu sehen ist. Das macht es dann recht schwierig alles im Kopf zu behalten, welche Faktoren sich wie ändern sollen, damit wir eine Interaktion sehen. Oder andersherum, ich finde Interaktionen höhrer Ordnung auch immer schwer zu verstehen.</p>
<div id="tbl-higher-interaction" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-higher-interaction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;31.24— Bedeutung der höhren Ordnungen der Interaktionsterme in der multifaktoriellen ANOVA.
</figcaption>
<div aria-describedby="tbl-higher-interaction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Interaktionsterm</th>
<th style="text-align: left;">Bedeutung</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>animal:site:season</code></td>
<td style="text-align: left;">Die Interaktion zwischen dem Faktor <code>animal</code> und <code>site</code> und dem Faktor <code>season</code>. Verhalten sich die Floharten an den Messorten und den Jahreszeiten gleich?</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>animal:stage:site:season</code></td>
<td style="text-align: left;">Die Interaktion zwischen dem Faktor <code>animal</code> und <code>site</code> sowie <code>stage</code> und dem Faktor <code>season</code>. Verhalten sich die Floharten an den Messorten und den Jahreszeiten für beide Entwicklungsstadien gleich?</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Schauen wir uns einmal die Interaktionen in dem mehrfaktoriellen Datensatz einmal an. Ich zeige dir hier auch die Implementierung in dem <a href="https://interactions.jacob-long.com/">R Paket <code>{interactions}</code></a> für den dreifaktoriellen Fall. Wenn wir den vierfaktoriellen Fall vorliegen haben, dann müssen wir uns die Abbdilungen selber in <code>{ggplot}</code> bauen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true"><code>{ggplot}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false"><code>{interactions}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<p>Wenn wir mehr asl zwei Faktoren in einem Liniendiagramm abilden wollen, dann müssen wir uns entscheiden, welche zusätzliche Darstellung eines Faktors wir wollen. Ich zeige hier einmal die Lösung mit einem zusätzlichen Typ an Linien mit <code>linetype = stage</code> sowie einer Aufteilung der Abbildung in zwei Unterabbildungen nach der Jahreszeit durch die Funktion <code>facet_wrap(~ season)</code>. Dadurch erhalten wir verschiedene Linientypen für den Entwicklungszustand und spalten die Abbildung einmal nach der Jahreszeit der Messung auf.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>fac4_tbl <span class="sc">|&gt;</span> </span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length,</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> site, <span class="at">linetype =</span> stage, </span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> <span class="fu">interaction</span>(site, stage))) <span class="sc">+</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> season)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-interactionplot-3a" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-interactionplot-3a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-interactionplot-3a-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-32" title="Abbildung&nbsp;31.30— Liniendiagramm zur Überprüfung der Interaktion in einem vierfaktoriellen Versuchsdesign. Wenn sich die Linien kreuzen so ist von einer Interaktion auszugehen."><img src="stat-tests-anova2_files/figure-html/fig-interactionplot-3a-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-interactionplot-3a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.30— Liniendiagramm zur Überprüfung der Interaktion in einem vierfaktoriellen Versuchsdesign. Wenn sich die Linien kreuzen so ist von einer Interaktion auszugehen.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir sehen in der Abbildung mehrere Interaktionen. Ich versuche die Interaktionen einmal mit dem p-Wert und der Abbildung überein zu bringen. Eine Interaktion sollte man eigentlich immer sehen. Häufig muss man nur sehr genau schauen und mal die Faktoren durchpermutieren. Je nachdem was auf der x-Achse liegt siehst du was anderes leichter.</p>
<ol type="1">
<li>Interaktion <code>animal:stage</code> mit dem p-Wert von <span class="math inline">\(&lt;0.001\)</span>: Hier haben wir ein Überkreuzen der Linien von dem Faktor <code>animal</code> und <code>stage</code>. Adulte Katzenflöhe springen im Mittel weiter als adulte Flöhe. Dieser Zusammenhang dreht sich bei den Hunden um.</li>
<li>Interaktion <code>animal:site</code> mit dem p-Wert von <span class="math inline">\(&lt;0.001\)</span>: Hier haben wir ein Überkreuzen der Linien von dem Faktor <code>animal</code> und <code>site</code>. Katzenflöhe springen in der Stadt weiter als auf dem Dorf. Dieser Zusammenhang dreht sich dann bei den Fuchsflöhen um. Dort springen die Dorffuchsflöhe weiter als die Stadtfuchsflöhe.</li>
<li>Interaktion <code>animal:site:season</code> mit dem p-Wert von <span class="math inline">\(&lt;0.001\)</span>: Die Sprungweiten der Floharten der drei Tiere über die Messorte im Sommer und Winter sind mehr als nur verschoben. Die Mittelwerte der Sprungweiten der Füchse sind in der Stadt im Sommer niedriger als im Winter <em>im Bezug</em> zum Messort im Dorf.</li>
<li>Interaktion <code>animal:stage:site:season</code> mit dem p-Wert von <span class="math inline">\(0.037\)</span>: Diese Interaktion ist jetzt die schwerste zu sehende Interaktion. Wir haben eben noch den Dreher der Sprungweiten bei den Hunden von Sommer zu Winter mit drin. Bei den Hunden verändert sich die Reihenfolge der Mittelwerte für <code>stage</code> und <code>juvenile</code> von Sommer zu Winter. Das Ganze kann man auch leicht bei den Katzenflöhen sehen.</li>
</ol>
<p>Jetzt können wir uns die Abbildung auch über die Funktion <code>facet_wrap(~ stage * season)</code> für die Kombinationen an Entwicklungsstand und Jahreszeit einmal aufteilen. Dann haben wir nur die Farben für den Messort und die Floharten auf der x-Achse. Das ist manchmal dann auch etwas übersichtlicher, wenn du nicht so viele Gruppen in den Faktoren hast.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>fac4_tbl <span class="sc">|&gt;</span> </span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length,</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> site, <span class="at">group =</span> site)) <span class="sc">+</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> stage <span class="sc">*</span> season) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-interactionplot-3b" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-interactionplot-3b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-interactionplot-3b-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-33" title="Abbildung&nbsp;31.31— Liniendiagramm zur Überprüfung der Interaktion in einem vierfaktoriellen Versuchsdesign. Die Aufteilung erfolgt hier über die Faktorkombinationen von stage * season. Wenn sich die Linien kreuzen so ist von einer Interaktion auszugehen."><img src="stat-tests-anova2_files/figure-html/fig-interactionplot-3b-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-interactionplot-3b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.31— Liniendiagramm zur Überprüfung der Interaktion in einem vierfaktoriellen Versuchsdesign. Die Aufteilung erfolgt hier über die Faktorkombinationen von <code>stage * season</code>. Wenn sich die Linien kreuzen so ist von einer Interaktion auszugehen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<p>In dem R Paket <code>{interactions}</code> können wir nur maximal eine dreifaktorielle ANOVA mit Interaktion darstellen. Wir legen dafür den ersten Faktor mit der Option <code>modx =</code> fest. Der zweite Faktor kommt dann in die Option <code>mod2 =</code>. Der Faktor auf der x-Achse wird dann in der Option <code>pred =</code> festgelegt. Dann können wir uns auch schon den Interaktionsplot einmal ansehen. Ich blende in der ersten Abbildung dann einmal den Faktor <code>season</code> aus.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>stage<span class="sc">*</span>site<span class="sc">*</span>season, <span class="at">data =</span> fac4_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat_plot</span>(<span class="at">modx =</span> site, <span class="at">mod2 =</span> stage, <span class="at">pred =</span> animal,  <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-interactionplot-4a" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-interactionplot-4a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-interactionplot-4a-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-34" title="Abbildung&nbsp;31.32— Liniendiagramm mit Fehlerbalken zur Überprüfung der Interaktion in einem dreifaktoriellen Versuchsdesign. Wenn sich die Linien kreuzen so ist von einer Interaktion auszugehen. Der Faktor season wird ignoriert und ausgeblendet."><img src="stat-tests-anova2_files/figure-html/fig-interactionplot-4a-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-interactionplot-4a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.32— Liniendiagramm mit Fehlerbalken zur Überprüfung der Interaktion in einem dreifaktoriellen Versuchsdesign. Wenn sich die Linien kreuzen so ist von einer Interaktion auszugehen. Der Faktor <code>season</code> wird ignoriert und ausgeblendet.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Dann können wir uns die Abbildung auch nochmal mit dem ausgeblendeten Faktor <code>stage</code> anschauen. Am Ende muss man festhalten, dass wir in einer vierfaktoriellen ANOVA natürlich nur bedingt uns die Interaktion in zerlegten dreifaktoriellen Abbildungen anschauen können. Auf der anderen Seite betrifft es dann natürlich nur die Interaktion <code>animal:stage:site:season</code>, die wir nicht anschauen können. Das ist dann auch meistens verschmerzbar, da diese selten signifikant ist.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>stage<span class="sc">*</span>site<span class="sc">*</span>season, <span class="at">data =</span> fac4_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat_plot</span>(<span class="at">modx =</span> site, <span class="at">mod2 =</span> season, <span class="at">pred =</span> animal,  <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-interactionplot-4b" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-interactionplot-4b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova2_files/figure-html/fig-interactionplot-4b-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-35" title="Abbildung&nbsp;31.33— Liniendiagramm mit Fehlerbalken zur Überprüfung der Interaktion in einem dreifaktoriellen Versuchsdesign. Wenn sich die Linien kreuzen so ist von einer Interaktion auszugehen. Der Faktor stage wird ignoriert und ausgeblendet."><img src="stat-tests-anova2_files/figure-html/fig-interactionplot-4b-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-interactionplot-4b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;31.33— Liniendiagramm mit Fehlerbalken zur Überprüfung der Interaktion in einem dreifaktoriellen Versuchsdesign. Wenn sich die Linien kreuzen so ist von einer Interaktion auszugehen. Der Faktor <code>stage</code> wird ignoriert und ausgeblendet.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="am-ende" class="level2" data-number="31.9">
<h2 data-number="31.9" class="anchored" data-anchor-id="am-ende"><span class="header-section-number">31.9</span> Am Ende</h2>
<blockquote class="blockquote">
<p><em>“Auf dem Weg der Tugend wird dir viel Leid widerfahren, doch dein Lohn wird Achtung, Verehrung und Liebe der Menschen sein.” — <a href="https://de.wikipedia.org/wiki/Herakles_am_Scheideweg">Herakles am Scheideweg</a></em></p>
</blockquote>
<p>Wie kommen wir jetzt zum Ende? Wenn du eine signifikante ANOVA vorliegen hast, dann musst du noch einen Post-hoc Test rechnen um herauszufinden, welche paarweisen Vergleiche signifkant sind. Diese paarweisen signifkanten Unterschiede sind es ja, die die ANOVA erst signifikant gemacht haben. Ehrlicherweise ist es meist so, dass du <em>immer</em> einen Post-hoc Test rechnest, da man sich nie sicher sein kann, ob die ANOVA nicht fälschlicherweise die Nullhypothese beibehalten hat. Oder einfach weil wir eben immer einen Post-hoc Test in einer Abschlussarbeit rechnen. Also, dann auf ins <a href="stat-tests-posthoc2.html">Kapitel zum Post-hoc Testen</a>.</p>
</section>
<section id="referenzen" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="referenzen">Referenzen</h2>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-field2013discovering" class="csl-entry" role="listitem">
Field, A. (2013). <em>Discovering statistics using IBM SPSS statistics</em>. sage London.
</div>
<div id="ref-kozak2018s" class="csl-entry" role="listitem">
Kozak, M., &amp; Piepho, H.-P. (2018). What’s normal anyway? Residual plots are more telling than significance tests when checking ANOVA assumptions. <em>Journal of agronomy and crop science</em>, <em>204</em>(1), 86–98.
</div>
<div id="ref-mair2020robust" class="csl-entry" role="listitem">
Mair, P., &amp; Wilcox, R. (2020). Robust statistical methods in R using the WRS2 package. <em>Behavior research methods</em>, <em>52</em>, 464–488.
</div>
<div id="ref-olejnik2003generalized" class="csl-entry" role="listitem">
Olejnik, S., &amp; Algina, J. (2003). Generalized eta and omega squared statistics: measures of effect size for some common research designs. <em>Psychological methods</em>, <em>8</em>(4), 434.
</div>
<div id="ref-van2019statistics" class="csl-entry" role="listitem">
Van Emden, H. F. (2019). <em>Statistics for terrified biologists</em>. John Wiley &amp; Sons.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./stat-tests-ttest.html" class="pagination-link" aria-label="Der t-Test">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Der t-Test</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./stat-tests-ancova2.html" class="pagination-link" aria-label="Die ANCOVA">
        <span class="nav-page-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Quellcode</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb117" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = FALSE}</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, readxl, knitr, kableExtra, Hmisc, plyr,</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="in">               patchwork, ggforce, see, sjPlot, tinytable, conflicted)</span></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(202434)</span></span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::summarise)</span></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::summarize)</span></span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::mutate)</span></span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(magrittr::set_names)</span></span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-19"><a href="#cb117-19" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-20"><a href="#cb117-20" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: false</span></span>
<span id="cb117-21"><a href="#cb117-21" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: source-anova-plots</span></span>
<span id="cb117-22"><a href="#cb117-22" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"stat-tests-anova_plot/anova_plots.R"</span>)</span>
<span id="cb117-23"><a href="#cb117-23" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-24"><a href="#cb117-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-25"><a href="#cb117-25" aria-hidden="true" tabindex="-1"></a><span class="fu"># Die ANOVA {#sec-anova}</span></span>
<span id="cb117-26"><a href="#cb117-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-27"><a href="#cb117-27" aria-hidden="true" tabindex="-1"></a>*Letzte Änderung am `r format(fs::file_info("stat-tests-anova2.qmd")$modification_time, '%d. %B %Y um %H:%M:%S')`*</span>
<span id="cb117-28"><a href="#cb117-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-29"><a href="#cb117-29" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Yeah, I might seem so strong; Yeah, I might speak so long; I've never been so wrong." --- London Grammar, Strong*</span></span>
<span id="cb117-30"><a href="#cb117-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-31"><a href="#cb117-31" aria-hidden="true" tabindex="-1"></a>Die ANOVA (eng. *analysis of variance*) ist wichtig. Was für ein schöner Satz um anzufangen. Historisch betrachtet ist die ANOVA, *das* statistische Verfahren was gut per Hand ohne Computer berechnet werden kann. Daher war die ANOVA von den 20zigern bis in die frühen 90ziger des letzten Jahrhunderts *das* statistische Verfahren der Wahl. Wir brauchen daher die ANOVA aus mehreren Gründen. Die Hochzeiten der ANOVA sind eigentlich vorbei, wir haben in der Statistik für viele Fälle mittlerweile besser Werkzeuge, aber als Allrounder ist die ANOVA immer noch nutzbar. Insbesondere wenn wir uns mit einem faktoriellen Design beschäftigen, dann komt die Stärke der ANOVA voll zu tragen. Da wir in den agrarwissenschaften eben dann doch sehr viele Feldexperimente in einem faktoriellen Design vorliegen haben, hat auch die ANOVA ihren Platz in der praktischen Auswertung. Wir werden immer wieder in diesem Buch auf die ANOVA inhaltlich zurück kommen und in vielen Abschlussarbeiten wird die ANOVA immer noch als integraler Bestandteil genutzt.</span>
<span id="cb117-32"><a href="#cb117-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-33"><a href="#cb117-33" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb117-34"><a href="#cb117-34" aria-hidden="true" tabindex="-1"></a><span class="fu">## Der ANOVA Pfad</span></span>
<span id="cb117-35"><a href="#cb117-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-36"><a href="#cb117-36" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Patience, my children; one hour of suffering will bring more true happiness than a whole life of pleasure." --- [The Pathfinder](https://en.wikipedia.org/wiki/The_Pathfinder,_or_The_Inland_Sea)*</span></span>
<span id="cb117-37"><a href="#cb117-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-38"><a href="#cb117-38" aria-hidden="true" tabindex="-1"></a>Ich nenne es immer liebevoll den ANOVA Pfad, was wir hier mit der ANOVA machen. Wir wollen eigentlich einen multiplen Gruppenvergleich rechnen. Dafür führen wir folgende Schritte durch.</span>
<span id="cb117-39"><a href="#cb117-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-40"><a href="#cb117-40" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Wir erstellen uns ein Modell mit einem Messwert $y$ und mindestens einem Faktor $f$.</span>
<span id="cb117-41"><a href="#cb117-41" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Wir rechnen auf dem Modell eine ANOVA um herauszufinden ob wir einen signfikanten Unterschied in den Gruppen vorliegen haben.</span>
<span id="cb117-42"><a href="#cb117-42" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Wir rechnen einen Post-hoc Test um die signifikanten paarweisen Vergleiche in den Gruppen zu finden.</span>
<span id="cb117-43"><a href="#cb117-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-44"><a href="#cb117-44" aria-hidden="true" tabindex="-1"></a>Das ganze machen wir dann für *jeden* unserer Messwerte.</span>
<span id="cb117-45"><a href="#cb117-45" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb117-46"><a href="#cb117-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-47"><a href="#cb117-47" aria-hidden="true" tabindex="-1"></a>Was findest du in diesem Übersichtskapitel zur ANOVA? Wir werden uns in diesem Kapitel auf die einfaktorielle ANOVA (eng. *one-way ANOVA*) sowie die zweifaktorielle ANOVA (eng. *two-way ANOVA*) konzentrieren. Ich gehe dann auch noch auf ein mehrfaktorielles Modell ein. In dem <span class="co">[</span><span class="ot">Kapitel zur ANCOVA</span><span class="co">](#sec-ancova)</span> findest du dann alle Informationen, wenn du zusärtzlich zu deinen Faktoren noch eine numerische Kovariate mit in dein Modell nehmen willst. Häufig wird die ANOVA auch verwendet, wenn du Messwiederholungen in deinen Daten vorliegen hast. Hierfür habe ich dann das <span class="co">[</span><span class="ot">Kapitel zur repeated &amp; mixed ANOVA</span><span class="co">](#sec-anova-mixed)</span> geschrieben, wo du dann einmal schauen musst. Am Ende kommt dann noch das <span class="co">[</span><span class="ot">Kapitel zur multivariate ANOVA</span><span class="co">](#sec-anova-manova)</span>, wenn du simultan mehr als einen Messwert $y$ in dein Modell nehmen willst. Wie immer, du musst dann schauen, was zu deiner wissenschaftlichen Fragetstellung passt.</span>
<span id="cb117-48"><a href="#cb117-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-49"><a href="#cb117-49" aria-hidden="true" tabindex="-1"></a><span class="fu">## Allgemeiner Hintergrund</span></span>
<span id="cb117-50"><a href="#cb117-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-51"><a href="#cb117-51" aria-hidden="true" tabindex="-1"></a>Fangen wir also mit der zentralen Idee der ANOVA an und arbeiten uns dann vor. Du kannst gerne den allgemeinen wie auch den theoretischen Teil überspringen und dir gleich das passende Datenbeispiel für deine Fragestellung raussuchen. Der Teil hier vorab dient nur dem tieferen Verständnis und du brauchst es eigentlich nicht um einfach nur eine ANOVA anzuwenden und ein Ergebnis zu erhalten. Da ist die ANOVA ziemlich gut zu interpretieren und anzuwenden. Wir fangen hier jetzt aber einmal an uns eine grundsätzliche Frage über unser experimentellen Versuch zu stellen.</span>
<span id="cb117-52"><a href="#cb117-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-53"><a href="#cb117-53" aria-hidden="true" tabindex="-1"></a>Ist eine hohe Varianz in dem Messwert $\boldsymbol{y}$ zu vermeiden?</span>
<span id="cb117-54"><a href="#cb117-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-55"><a href="#cb117-55" aria-hidden="true" tabindex="-1"></a>:   Es gibt eigentlich zwei Fehlannahmen (eng. *misconception*) an die ANOVA. Zum einen, dass die ANOVA die Varianzen vergleichen würde. Das stimmt nur bedingt. Die Nullhypothese der ANOVA ist die Gleichheit der Mittelwerte in den Gruppen. Zum anderen, dass wenig Varianz in den Messwerten $y$ per se gut wäre und ein angestrebtes Ziel in einem geplanten Feldexperiment.</span>
<span id="cb117-56"><a href="#cb117-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-57"><a href="#cb117-57" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbildung siehst du einmal vier Maisspflanzen mit jeweils einer Behandlung für ein gesteigertes Wachstum. In der linken Abbildung haben wir eine geringe Varianz und damit auch gleiche Mittelwerte. Die Behandlungen haben überhaupt keinen Einfluß auf den Wuchs. In der rechten Abbildung siehst du eine hohe Varianz, weil eben die Behandlungen einen Effekt auf das Wachstum haben. Wenn du also ein geplantes Experiment mit Kontrolle und Behandlungen durchführst, dann erwartest du eine hohe Varianz in dem Messwert $y$. Ansonsten würde deine Behandlung überhaupt nicht wirken.</span>
<span id="cb117-58"><a href="#cb117-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-59"><a href="#cb117-59" aria-hidden="true" tabindex="-1"></a><span class="al">![Feldexperiment mit vier Behandlungen zur Steigerung der Wuchshöhe von Maispflanzen. Jede Pflanze stellt vereinfacht eine Behandlung dar. **(A)** Die gepoolte Varianz $s^2_p$ über die Gruppen ist klein ($s^2_p=0$), die Behandlungen haben keinen Effekt auf das Wachstum. **(B)** Die gepoolte Varianz $s^2_p$ über die Gruppen ist groß ($s^2_p&gt;0$), die Behandlungen haben einen Effekt auf das Wachstum der Maisspflanzen.](images/anova/anova_intro.png)</span>{#fig-anova-intro fig-align="center" width="100%"}</span>
<span id="cb117-60"><a href="#cb117-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-61"><a href="#cb117-61" aria-hidden="true" tabindex="-1"></a>Arbeiten wir uns nun einmal durch die Themen der Hypothesen sowie der Idee des faktoriellen Modells. Wir brauchen eine Idee des faktoriellen Modells um die verschiednen Typen der ANOVA unterscheiden zu können. Teilweise sind es eben dann nur Erweiterungen des immer gleichen Grundgerüst. Dann schauen wir nochmal auf die Voraussetzungen der ANOVA an deine Daten. Zum einen mit dem Fokus auf die Normalverteilung deines Messwert $y$ und zum anderen die Varianzhomogenität in deinen Faktoren. Bevor wir dann nochmal als Einschub die Theorie behandlen, stelle ich dir R Pakete vor, die dir die ANOVA rechnen können.</span>
<span id="cb117-62"><a href="#cb117-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-63"><a href="#cb117-63" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Das Modell {.unnumbered .unlisted}</span></span>
<span id="cb117-64"><a href="#cb117-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-65"><a href="#cb117-65" aria-hidden="true" tabindex="-1"></a>Beginnen wir also mit der Festlegung welche Art der Analyse wir rechnen wollen. Wichtig ist hier, dass du einen normmalverteiten Messwert $y$ vorliegen hast und ein oder mehrere Faktoren $f$. Was sind im Kontext von R Faktoren? Ein Faktor ist eine Behandlung oder eben eine Spalte in deinem Datensatz, der verschiedene Gruppen oder Kategorien beinhaltet. Wir nennen diese Kategorien Level. In den folgenden Datenbeispielen ist die Spalte <span class="in">`animal`</span> ein Faktor mit drei Leveln. Wir haben dort nämlich die Sprungweiten von drei Floharten gemessen. Jetzt kann es aber auch sein, dass du neben einem Faktor noch eine numeriche Kovariate $c$ gemessen hast. Oder aber du hast zwei Messwerte, die du dann gemeinsam mit einem Faktor vergleichen willst. Diese drei Analysetypen wollen wir uns in den folgenden Tabs mal näher anschauen.</span>
<span id="cb117-66"><a href="#cb117-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-67"><a href="#cb117-67" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb117-68"><a href="#cb117-68" aria-hidden="true" tabindex="-1"></a><span class="fu">## ANOVA (faktoriell)</span></span>
<span id="cb117-69"><a href="#cb117-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-70"><a href="#cb117-70" aria-hidden="true" tabindex="-1"></a>Das faktorielle Modell der klassischen ANOVA beinhaltet einen Messwert $y$, der normalverteilt ist. Darüber hinaus haben wir noch ein bis mehrere Faktoren $f$. Wir bezeichnen hier die Faktoren mit den Indizes $A$, $B$ und $C$ und die jeweiligen Level des Faktors $A$ als $A.1, A.2,..., A.k$. Häufig haben wir aber zwei Faktoren in einem Modell mit zwei bis fünf Leveln. Aber hier gibt es sicherlich auch noch Fragestellungen mit mehr Gruppen und damit Leveln in einem Faktor. Wir schreiben ein faktorielles Modell wie folgt.</span>
<span id="cb117-71"><a href="#cb117-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-72"><a href="#cb117-72" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-73"><a href="#cb117-73" aria-hidden="true" tabindex="-1"></a>y \sim f_A + f_B + ... + f_P + f_A \times f_B + ... + f_A \times f_B \times f_C</span>
<span id="cb117-74"><a href="#cb117-74" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-75"><a href="#cb117-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-76"><a href="#cb117-76" aria-hidden="true" tabindex="-1"></a>mit</span>
<span id="cb117-77"><a href="#cb117-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-78"><a href="#cb117-78" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$y$ gleich dem Messwert oder Outcome</span>
<span id="cb117-79"><a href="#cb117-79" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$f_A + f_B + ... + f_P$ gleich experimenteller Faktoren</span>
<span id="cb117-80"><a href="#cb117-80" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$f_A \times f_B$ gleich einem beispielhaften Interaktionsterm erster Ordnung</span>
<span id="cb117-81"><a href="#cb117-81" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$f_A \times f_B \times f_C$ gleich einem beispielhaften Interaktionsterm zweiter Ordnung</span>
<span id="cb117-82"><a href="#cb117-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-83"><a href="#cb117-83" aria-hidden="true" tabindex="-1"></a>Zusätzlich können noch Interaktionsterme höherer Ordnungen entstehen, aber hier wird es extrem schwierig diese Interaktionsterme dann auch zu interpretieren. Ich würde grundsätzlich vermeiden Interaktionen zweiter und höherer Ordnungen mit ins Modell zu nehmen. Was genau eine Interaktion ist, besprechen wir in einem folgenden Abschnit. Um eine Interaktion beobachten zu können, brauchst du aber mindestens zwei Faktoren in deiner Analyse.</span>
<span id="cb117-84"><a href="#cb117-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-85"><a href="#cb117-85" aria-hidden="true" tabindex="-1"></a><span class="fu">## ANCOVA (faktoriell und numerisch)</span></span>
<span id="cb117-86"><a href="#cb117-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-87"><a href="#cb117-87" aria-hidden="true" tabindex="-1"></a>Wenn wir neben einem bis mehreren Faktoren $f$ noch eine numerische Kovariate $c$ mit modellieren wollen, dann nutzen wir die ANCOVA (eng. *Analysis of Covariance*). Hier kommt dann immer als erstes die Frage, was heißt den Kovariate $c$? Hier kannst du dir eine numerische Variable vorstellen, die ebenfalls im Experiment gemessen wird. Es kann das Startgewicht oder aber die kummulierte Wassergabe sein. Wir haben eben hier keinen Faktor als Kategorie vorliegen, sondern eben etwas numerisch gemessen. Daher ist unsere Modellierung etwas anders.</span>
<span id="cb117-88"><a href="#cb117-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-89"><a href="#cb117-89" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-90"><a href="#cb117-90" aria-hidden="true" tabindex="-1"></a>y \sim f_A + f_B + ... + f_P + f_A \times f_B + c_1 + ... + c_p</span>
<span id="cb117-91"><a href="#cb117-91" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-92"><a href="#cb117-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-93"><a href="#cb117-93" aria-hidden="true" tabindex="-1"></a>mit</span>
<span id="cb117-94"><a href="#cb117-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-95"><a href="#cb117-95" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$y$ gleich dem Messwert oder Outcome</span>
<span id="cb117-96"><a href="#cb117-96" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$f_A + f_B + ... + f_P$ gleich experimenteller Faktoren</span>
<span id="cb117-97"><a href="#cb117-97" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$f_A \times f_B$ gleich einem beispielhaften Interaktionsterm erster Ordnung</span>
<span id="cb117-98"><a href="#cb117-98" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$c_1 + ... + c_p$ gleich einer oder mehrer numerischer Kovariaten</span>
<span id="cb117-99"><a href="#cb117-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-100"><a href="#cb117-100" aria-hidden="true" tabindex="-1"></a>Hier muss ich gleich die Einschränkung machen, dass wir *normalerweise* maximal ein zweifaktorielles Modell mit einem Faktor $A$ und einem Faktor $B$ sowie einer Kovariate $c$ betrachten. Sehr selten haben wir mehr Faktoren oder gar Kovariaten in dem Modell. Wenn das der Fall sein sollte, dann könnte eine andere Modellierung wie eine multiple Regression eine bessere Lösung sein. Mehr Informationen zur der Berechnung findest du in dem <span class="co">[</span><span class="ot">Kapitel zur ANCOVA</span><span class="co">](#sec-ancova)</span></span>
<span id="cb117-101"><a href="#cb117-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-102"><a href="#cb117-102" aria-hidden="true" tabindex="-1"></a><span class="fu">## MANOVA (multivariat)</span></span>
<span id="cb117-103"><a href="#cb117-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-104"><a href="#cb117-104" aria-hidden="true" tabindex="-1"></a>Am Ende des Kapitels schauen wir uns noch einen weiteren Spezialfall an. Nämlich den Fall, dass wir nicht nur einen Messwert $y$ vorliegen haben sondern eben mehrere die wir simultan auswerten wollen. Das klingt jetzt erstmal etwas schräg, aber es wird dann klarer, wenn wir uns die Sachlage einmal an einem Beispiel anschauen.</span>
<span id="cb117-105"><a href="#cb117-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-106"><a href="#cb117-106" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-107"><a href="#cb117-107" aria-hidden="true" tabindex="-1"></a>(y_1, y_2, ..., y_j) \sim f_A + f_B + ... + f_P + f_A \times f_B </span>
<span id="cb117-108"><a href="#cb117-108" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-109"><a href="#cb117-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-110"><a href="#cb117-110" aria-hidden="true" tabindex="-1"></a>mit</span>
<span id="cb117-111"><a href="#cb117-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-112"><a href="#cb117-112" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$(y_1, y_2)$ gleich der Messwerte oder Outcomes</span>
<span id="cb117-113"><a href="#cb117-113" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$f_A + f_B + ... + f_P$ gleich experimenteller Faktoren</span>
<span id="cb117-114"><a href="#cb117-114" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$f_A \times f_B$ gleich einem beispielhaften Interaktionsterm erster Ordnung</span>
<span id="cb117-115"><a href="#cb117-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-116"><a href="#cb117-116" aria-hidden="true" tabindex="-1"></a>Die ganze multivariate Analyse ist dann etwas seltener, da wir hier dann doch schon einiges an Fallzahl brauchen, damit es dann auch einen Sinn macht. Einiges an Fallzahl heißt dann hier, dass wir dann schon mehr als sechs Beobachtungen in einer Gruppe haben sollten. Wenn du weniger hast, kann es sein, dass du keine signifikanten Unterschiede findest. Mehr Informationen zur der Berechnung findest du in dem <span class="co">[</span><span class="ot">Kapitel zur MANOVA</span><span class="co">](#sec-anova-manova)</span></span>
<span id="cb117-117"><a href="#cb117-117" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb117-118"><a href="#cb117-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-119"><a href="#cb117-119" aria-hidden="true" tabindex="-1"></a>Daneben gibt es natürlich noch Spezialfälle wie die gemischte ANOVA (eng. *mixed ANOVA*), wenn wir Beobachtungen wiederholt messen. Dieses Modell schauen wir uns dann auch nochmal an. Der Unterschied in der Modellierung ist ein Fehlerterm (eng. *Error*), den wir dann nochmal mit angeben müssen. Dazu dann aber mehr in dem <span class="co">[</span><span class="ot">Kapitel zur repeated &amp; mixed ANOVA</span><span class="co">](#sec-anova-mixed)</span>.</span>
<span id="cb117-120"><a href="#cb117-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-121"><a href="#cb117-121" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Hypothesen {.unnumbered .unlisted}</span></span>
<span id="cb117-122"><a href="#cb117-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-123"><a href="#cb117-123" aria-hidden="true" tabindex="-1"></a>Wenn wir von der ANOVA sprechen, dann kommen wir natürlich nicht an den Hypothesen vorbei. Die ANOVA ist ja auch ein klassischer statistischer Test. Hier müssen wir unterscheiden, ob wir eine Behandlung mit zwei Gruppen, also einem Faktor $A$ mit $2$ Leveln vorliegen haben. Oder aber eine Behandlung mit drei oder mehr Gruppen vorliegen haben, also einem Faktor $A$ mit $\geq 3$ Leveln in den Daten haben. Da wir schnell in einer ANOVA mehrere Faktoren haben, haben wir auch schnell viele Hypothesen zu beachten. Jeweils ein Hypothesenpaar pro Faktor muss dann betrachtet werden. Das ist immer ganz wichtig, die Hypothesenpaare sind unter den Faktoren mehr oder minder unabhängig.</span>
<span id="cb117-124"><a href="#cb117-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-125"><a href="#cb117-125" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb117-126"><a href="#cb117-126" aria-hidden="true" tabindex="-1"></a><span class="fu">## Faktor mit $2$ Leveln</span></span>
<span id="cb117-127"><a href="#cb117-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-128"><a href="#cb117-128" aria-hidden="true" tabindex="-1"></a>Bei einem Faktor $A$ mit nur zwei Leveln $A.1$ und $A.2$ haben wir eine Nullhypothese, die du schon aus den Gruppenvergleichen wie dem t-Test kennst. Wir wollen zwei Mittelwerte vergleichen und in unserer Nullhypothese steht somit die Gleichheit. Da wir nur zwei Gruppen haben, sieht die Nullhypothese einfach aus.</span>
<span id="cb117-129"><a href="#cb117-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-130"><a href="#cb117-130" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-131"><a href="#cb117-131" aria-hidden="true" tabindex="-1"></a>H_0: \; \bar{y}_{A.1} = \bar{y}_{A.2}</span>
<span id="cb117-132"><a href="#cb117-132" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-133"><a href="#cb117-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-134"><a href="#cb117-134" aria-hidden="true" tabindex="-1"></a>In der Alternativehypothese haben wir dann den Unterschied zwischen den beiden Mittelwerten. Wenn wir die Nullhypothese ablehnen können, dann wissen wir auch welche Mittelwertsunterschied signifikant ist. Wir haben ja auch nur einen Unterschied getestet.</span>
<span id="cb117-135"><a href="#cb117-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-136"><a href="#cb117-136" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-137"><a href="#cb117-137" aria-hidden="true" tabindex="-1"></a>H_A: \; \bar{y}_{A.1} \neq \bar{y}_{A.2}</span>
<span id="cb117-138"><a href="#cb117-138" aria-hidden="true" tabindex="-1"></a>$$ Das Ganze wird dann etwas komplexer im Bezug auf die Alternativehypothese wenn wir mehr als zwei Gruppen haben. Hier kommt dann natürlich auch die Stärke der ANOVA zu tragen. Eben mehr als zwei Mittelwerte vergleichen zu können.</span>
<span id="cb117-139"><a href="#cb117-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-140"><a href="#cb117-140" aria-hidden="true" tabindex="-1"></a><span class="fu">## Faktor mit $\geq 3$ Leveln</span></span>
<span id="cb117-141"><a href="#cb117-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-142"><a href="#cb117-142" aria-hidden="true" tabindex="-1"></a>Die klassische Nullhypothese der ANOVA hat natürlich mehr als zwei Level. Hier einmal beispielhaft die Nullhypothese für den Vergleich von drei Gruppen des Faktors $A$. Wir wollen als Nullhypothese testen, ob alle Mittelwerte der drei Gruppen gleich sind.</span>
<span id="cb117-143"><a href="#cb117-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-144"><a href="#cb117-144" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-145"><a href="#cb117-145" aria-hidden="true" tabindex="-1"></a>H_0: \; \bar{y}_{A.1} = \bar{y}_{A.2} = \bar{y}_{A.3}</span>
<span id="cb117-146"><a href="#cb117-146" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-147"><a href="#cb117-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-148"><a href="#cb117-148" aria-hidden="true" tabindex="-1"></a>Wenn wir die Nullhypothese betrachten dann sehen wir auch gleich das Problem der Alternativehypothese. Wir haben eine Menge an paarweisen Vergleichen. Wenn wir jetzt die Nullhypothese ablehnen, dann wissen wir nicht welcher der drei paarweisen Mittelwertsvergleiche denn nun unterschiedlich ist. Praktisch können es auch alle drei oder eben zwei Vergleiche sein.</span>
<span id="cb117-149"><a href="#cb117-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-150"><a href="#cb117-150" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-151"><a href="#cb117-151" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb117-152"><a href="#cb117-152" aria-hidden="true" tabindex="-1"></a>H_A: &amp;\; \bar{y}_{A.1} \ne \bar{y}_{A.2}<span class="sc">\\</span></span>
<span id="cb117-153"><a href="#cb117-153" aria-hidden="true" tabindex="-1"></a>\phantom{H_A:} &amp;\; \bar{y}_{A.1} \ne \bar{y}_{A.3}<span class="sc">\\</span></span>
<span id="cb117-154"><a href="#cb117-154" aria-hidden="true" tabindex="-1"></a>\phantom{H_A:} &amp;\; \bar{y}_{A.2} \ne \bar{y}_{A.3}<span class="sc">\\</span></span>
<span id="cb117-155"><a href="#cb117-155" aria-hidden="true" tabindex="-1"></a>\phantom{H_A:} &amp;\; \mbox{für mindestens einen Vergleich}</span>
<span id="cb117-156"><a href="#cb117-156" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb117-157"><a href="#cb117-157" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-158"><a href="#cb117-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-159"><a href="#cb117-159" aria-hidden="true" tabindex="-1"></a>Wenn wir die Nullhypothese abgelhent haben, dann müssen wir noch einen sogenannten Post-hoc Test anschließen um die paarweisen Unterschiede zu finden, die dann signifikant sind. Das ganze machen wir dann aber in einem eigenen Kapitel zum Post-hoc Test.</span>
<span id="cb117-160"><a href="#cb117-160" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb117-161"><a href="#cb117-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-162"><a href="#cb117-162" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Normalverteilung und Varianzhomogenität {.unnumbered .unlisted}</span></span>
<span id="cb117-163"><a href="#cb117-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-164"><a href="#cb117-164" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Soll ich's wirklich machen oder lass ich's lieber sein? Jein..." --- Fettes Brot, Jein*</span></span>
<span id="cb117-165"><a href="#cb117-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-166"><a href="#cb117-166" aria-hidden="true" tabindex="-1"></a>Wenn wir die ANOVA nutzen wollen, dann kommen wir um die Voraussetzungen der Normalverteilung an den Messwert $y$ sowie die Varianzhomogenität in den Faktorleveln oder Behandlungsgruppen $f$ nicht herum. In dem <span class="co">[</span><span class="ot">Kapitel zum Pre-Test oder Vortest</span><span class="co">](#sec-pretest)</span> gehe ich nochmal detailierter auf mögliche Tests auf die Normalverteilung und die Varianzhomogenität ein. In diesem Kapitel findest du in dem Abschnitt <span class="co">[</span><span class="ot">Test auf Normalverteilung und Varianzhomogenität</span><span class="co">](#sec-anova-test-pre)</span> einmal ein Vorgehen für das Testen der Annahmen. Ich würde davon allgemein abraten, aber es wird immer wieder verlangt, also stelle ich es hier auch vor. Kurzfassung, die ANOVA ist realtiv robust gegen eine Abweichung von der Normalverteilung der Messwerte. Ebenso kann die ANOVA mit leichter Varianzheterogenität umgehen.</span>
<span id="cb117-167"><a href="#cb117-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-168"><a href="#cb117-168" aria-hidden="true" tabindex="-1"></a>Häufig kommt jetzt die Frage, ob mein Messwert $y$ wirklich normalverteilt ist und ich nicht den Messwert auf Normalverteilung testen sollte. Die kurze Antwort lautet nein, da du meistens zu wenig Beobachtungen pro Gruppe vorliegen hast. Die etwas längere liefert @kozak2018s mit dem Artikel <span class="co">[</span><span class="ot">What's normal anyway? Residual plots are more telling than significance tests when checking ANOVA assumptions</span><span class="co">](https://onlinelibrary.wiley.com/doi/pdf/10.1111/jac.12220?casa_token=22Jm83-kW-MAAAAA:yh0EVuGiGHWDsuPiVP8ZLj51OCasdpIiVWUcYv3Q8dGaIo0yMeNZNwkHIk1ibTCsLhkxbLKZrwZSByo)</span>.</span>
<span id="cb117-169"><a href="#cb117-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-170"><a href="#cb117-170" aria-hidden="true" tabindex="-1"></a>Kommen wir nun zur Varianzhomogenität oder Varianzhterogenität in den Gruppen des Behandlunsgfaktors. Wir betrachten also meistens nur den wichtigen Faktor $f_A$ und ignorieren ein wenig den zwieten Faktor. Prinzipiell kannst du natürlich auch den zweiten Fakto anschauen, aber dann werden es immer mehr Gruppen und Fakotrkombinationen. Am Ende kommt dann sowieso heraus, dass über alle Gruppen hinweg keine homogenen Varianzen vorliegen. Wenn du mehr lesen willst so gibt es auf der Seite DSFAIR noch einen Artikel zu <span class="in">`{emmeans}`</span> und der Frage <span class="co">[</span><span class="ot">Why are the StdErr all the same?</span><span class="co">](https://schmidtpaul.github.io/dsfair_quarto/ch/summaryarticles/whyseequal.html)</span></span>
<span id="cb117-171"><a href="#cb117-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-172"><a href="#cb117-172" aria-hidden="true" tabindex="-1"></a>Wann liegt vermutlich Varianzheterogenität in deinen experimentellen Faktoren $f$ vor?</span>
<span id="cb117-173"><a href="#cb117-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-174"><a href="#cb117-174" aria-hidden="true" tabindex="-1"></a>:   Es gibt so ein paar Daumenregeln, die dir helfen abzuschätzen, ob in deinen Gruppen Varianzheterogenität vorliegt. Um es kurz zu machen, vermutlich hast du mindestens leichte Varianzhterogenität in den Daten vorliegen.</span>
<span id="cb117-175"><a href="#cb117-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-176"><a href="#cb117-176" aria-hidden="true" tabindex="-1"></a>1)  Du hat viele Behandlungsgruppen. Je mehr Gruppen du hast oder eben dann auch Faktorkombinationen, die du testen möchtest, desto wahrscheinlicher wird es, dass mindestens eine Gruppe eine unterschiedliche Varianz hat. Du hast Varianzheterogenität vorliegen.</span>
<span id="cb117-177"><a href="#cb117-177" aria-hidden="true" tabindex="-1"></a>2)  Du misst deine Gruppen über die Zeit. Je größer, schwerer oder allgemein höher ein Messwert wird, desto größer wird auch die Varianz. Schaust du dir deine Messwerte über die Zeit an hast du meistens Varianzheterogenität vorliegen.</span>
<span id="cb117-178"><a href="#cb117-178" aria-hidden="true" tabindex="-1"></a>3)  Deine Kontrolle ohne Behandlung verhält sich meistens nicht so, wie die Gruppen, die eine Behandlung erhalten haben. Wenn du nichts machst in deiner negativen Kontrolle, dann hast du meistens eine andere Streuung der Messwerte als unter einer Behandlung.</span>
<span id="cb117-179"><a href="#cb117-179" aria-hidden="true" tabindex="-1"></a>4)  Diene Behandlungen sind stark unterschiedlich. Wenn deine Behandlungen sich biologisch oder chemisch in der Wirkung unterscheiden, denn werden vermutlich deine Messwerte auch anders streuen. Hier spielt auch die Anwendung der Behandlung und deren Bereitstellung eine Rolle. Wenn was nicht gleich ist, dann wird es vermutlich nicht gleiche Messwerte erzeugen.</span>
<span id="cb117-180"><a href="#cb117-180" aria-hidden="true" tabindex="-1"></a>5)  Du hast wenig Fallzahl pro Gruppe oder Faktorkombination. Wenn du wenig Fallzahl in einer Gruppe hast, dann reicht schon eine (zufällige) Messabweichung und schon sind deine Varianzen heterogen.</span>
<span id="cb117-181"><a href="#cb117-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-182"><a href="#cb117-182" aria-hidden="true" tabindex="-1"></a>Gut, jetzt wissen wir, dass du *vermutlich* Varianzheterogenität in deinen Daten vorliegen hast. Erstmal ist das kein so großes Problem.</span>
<span id="cb117-183"><a href="#cb117-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-184"><a href="#cb117-184" aria-hidden="true" tabindex="-1"></a>Tut Varianzhterogenität anstatt Varianzhomogenität weh?</span>
<span id="cb117-185"><a href="#cb117-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-186"><a href="#cb117-186" aria-hidden="true" tabindex="-1"></a>:   Nein. Meistens ist die Varianzheterogenität nicht so ausgeprägt, dass du nicht auch eine ANOVA rechnen kannst. Über alle Gruppen hinweg wird dann zwar in einer ANOVA die Varianz gemmittelt und es kann dann zu weniger signifkanten Ergebnissen führen, aber so schlimm ist es nicht. Im Post-hoc Test solltest du aber die Varianzhterogenität berücksichtigen, da du ja immer nur zwei Gruppen gleichzeitig betrachtest.</span>
<span id="cb117-187"><a href="#cb117-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-188"><a href="#cb117-188" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Welche Pakete gibt es eigentlich? {.unnumbered .unlisted}</span></span>
<span id="cb117-189"><a href="#cb117-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-190"><a href="#cb117-190" aria-hidden="true" tabindex="-1"></a>Wenn um die Anwendung der ANOVA in R geht, dann haben wir eine Menge Pakete zur Auswahl. Wie immer macht die Fragestellung und das gewählte Modell den Großteil der Entscheidungsindung aus. Ich zeige dir später in der Anwendung dann auch alle Pakete einmal, gebe dir dann aber auch immer eine Empfehlung mit. In der folgenden Tabelle gebe ich dir einmal eine kurze Übersicht über die beiden Annahmen an die ANOVA. Normalerweise brauchen wir einen normalverteilten Messwert $y$ und Varianzhomogenität in den Faktoren. In den letzten Jahren wurden aber noch weitere Implementierungen der ANOVA entwickelt, so dass hier auch Alternativen vorliegen.</span>
<span id="cb117-191"><a href="#cb117-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-192"><a href="#cb117-192" aria-hidden="true" tabindex="-1"></a>|                            | <span class="in">`{base}`</span> | <span class="in">`{car}`</span>  | <span class="in">`{afex}`</span> | <span class="in">`{WRS2}`</span> | Excel |</span>
<span id="cb117-193"><a href="#cb117-193" aria-hidden="true" tabindex="-1"></a>|:---------------------------|:--------:|:--------:|:--------:|:--------:|:-----:|</span>
<span id="cb117-194"><a href="#cb117-194" aria-hidden="true" tabindex="-1"></a>| **Normalverteilt** $y$     |    ja    |    ja    |    ja    |   nein   |  ja   |</span>
<span id="cb117-195"><a href="#cb117-195" aria-hidden="true" tabindex="-1"></a>| **Varianzhomogenität** $f$ |    ja    | optional |    ja    |   nein   |  ja   |</span>
<span id="cb117-196"><a href="#cb117-196" aria-hidden="true" tabindex="-1"></a>| **Messwiederholungen**     |   nein   |   nein   |    ja    |    ja    | nein  |</span>
<span id="cb117-197"><a href="#cb117-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-198"><a href="#cb117-198" aria-hidden="true" tabindex="-1"></a>: Übersicht über Funktion der ANOVA in ausgewählten Paketen und Excel. Die Aussagen sind nicht als absolut zu verstehen sondern eher als Empfehlung und Leitplanken zur Orientierung. {#tbl-anova-übersicht}</span>
<span id="cb117-199"><a href="#cb117-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-200"><a href="#cb117-200" aria-hidden="true" tabindex="-1"></a>Gehen wir jetzt mal die Pakete durch. Wir immer gibt es einiges an Möglichkeiten und ich zeige dir hier eben die Auswahl. Es gibt hier das ein oder andere noch zu beachten, aber da gehe ich dann bei den jeweiligen Methoden drauf ein. Es macht eben dann doch einen Unterschied ob ich eine einfaktorielle oder komplexere ANOVA rechnen will. Nicht alles geht in allen R Pakten oder gar Excel.</span>
<span id="cb117-201"><a href="#cb117-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-202"><a href="#cb117-202" aria-hidden="true" tabindex="-1"></a>Der Standard mit der Funktion <span class="in">`aov()`</span> aus <span class="in">`{base}`</span></span>
<span id="cb117-203"><a href="#cb117-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-204"><a href="#cb117-204" aria-hidden="true" tabindex="-1"></a>:   Die Standardfunktion <span class="in">`aov()`</span> erlaubt es eine einfaktorielle oder zweifaktorielle ANOVA direkt auf einem Datensatz zu rechnen. Hier brauchen wir nur ein Modell in der in R üblichen Formelschreibweise <span class="in">`y ~ f`</span>. Du kannst diesen Ansatz als schnelle ANOVA begreifen. Dein Messwert $y$ muss hier normalverteilt sein.</span>
<span id="cb117-205"><a href="#cb117-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-206"><a href="#cb117-206" aria-hidden="true" tabindex="-1"></a>Der erweiterte Standard mit der Funktion <span class="in">`anova()`</span> aus <span class="in">`{base}`</span></span>
<span id="cb117-207"><a href="#cb117-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-208"><a href="#cb117-208" aria-hidden="true" tabindex="-1"></a>:   Die Funktion <span class="in">`anova()`</span> erlaubt es auch auf anderen Modellen eine ANOVA zu rechnen. Wi nutzen hier die Funktion <span class="in">`lm()`</span>, die einen normalverteilten Messwert $y$ annimmt. Es ginge aber auch mit anderen Modellierungen und der Funktion <span class="in">`glm()`</span> für Zähldaten einer Possionverteilung oder noch anderen Verteilungen. Die <span class="in">`anova()`</span> Funktion ist sehr reudziert, tut aber im Sinne einer ANOVA was die Funktion machen soll.</span>
<span id="cb117-209"><a href="#cb117-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-210"><a href="#cb117-210" aria-hidden="true" tabindex="-1"></a>Mit der Funktion <span class="in">`Anova()`</span> aus <span class="in">`{car}`</span></span>
<span id="cb117-211"><a href="#cb117-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-212"><a href="#cb117-212" aria-hidden="true" tabindex="-1"></a>:   Das <span class="co">[</span><span class="ot">R Paket `{car}`</span><span class="co">](https://cran.r-project.org/web/packages/car/index.html)</span> bietet eine Verbesserung der Standardfunktionen der ANOVA an. Insbesondere die Berücksichtigung und die Modellierung eines Interaktionseffektes in einer zweifaktoriellen ANOVA sticht heraus. Daher ist die Funktion hier etwas flexibeler als der Standard. In einer einfaktoriellen ANOVA bemerkst du keinen Unterschied.</span>
<span id="cb117-213"><a href="#cb117-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-214"><a href="#cb117-214" aria-hidden="true" tabindex="-1"></a>Mit den ANOVA Funktionen aus <span class="in">`{afex}`</span></span>
<span id="cb117-215"><a href="#cb117-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-216"><a href="#cb117-216" aria-hidden="true" tabindex="-1"></a>:   Wir können die ANOVA auch anwenden, wenn wir Messwiederholungen vorliegen haben. Daher bietet sich hier das <span class="co">[</span><span class="ot">R Paket `{afex}`</span><span class="co">](https://github.com/singmann/afex)</span> an. Du musst bei den Funktionen von <span class="in">`{afex}`</span> immer eine ID mitlaufen lassen, die angibt welche Individuen wiederholt gemessen wurden. Also hat jede Zeile eine Nummer, die beschreibt welche Beobachtung hier vorliegt. Besonders wichtig bei Messungen über die Zeit. Darüber hinaus kann das Paket sehr gut Interaktionen schätzen und Bedarf dort keiner zusätzlichen Optionen.</span>
<span id="cb117-217"><a href="#cb117-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-218"><a href="#cb117-218" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"ANOVAs are generally robust to 'light' heteroscedasticity, but there are various other methods (not available in `{afex}`) for getting robust error estimates."* --- </span><span class="co">[</span><span class="ot">Testing the Assumptions of ANOVAs</span><span class="co">](https://cran.r-project.org/web/packages/afex/vignettes/assumptions_of_ANOVAs.html)</span></span>
<span id="cb117-219"><a href="#cb117-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-220"><a href="#cb117-220" aria-hidden="true" tabindex="-1"></a>Das Paket <span class="in">`{afex}`</span> kann nicht mit Varianzheterogenität umgehen, aber dafür mit Messwiederholungen. Ich würde das Paket <span class="in">`{afex}`</span> nehmen, wenn ich Messwiederholungen vorliegen habe oder mich die Interaktion in einem zweifaktoriellen Modell interessiert.</span>
<span id="cb117-221"><a href="#cb117-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-222"><a href="#cb117-222" aria-hidden="true" tabindex="-1"></a>Mit den ANOVA Funktionen aus <span class="in">`{WRS2}`</span></span>
<span id="cb117-223"><a href="#cb117-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-224"><a href="#cb117-224" aria-hidden="true" tabindex="-1"></a>:   Eine Annahme an die ANOVA ist, dass wir es mit normalverteilten Messwerten $y$ sowie Varianzhomogenität in den Faktoren $f$ vorliegen haben. Das R Paket <span class="in">`{WRS2}`</span> mit der hervorragenden Vingette <span class="co">[</span><span class="ot">Robust Statistical Methods Using WRS2</span><span class="co">](https://cran.r-project.org/web/packages/WRS2/vignettes/WRS2.pdf)</span> erlaubt nun aber diese beiden Annahmen zu umgehen und bietet eine robuste ANOVA an. Robust meint hier, dass wir uns nicht um die Normalverteilung und Varianzhomogenität kümmern müssen.</span>
<span id="cb117-225"><a href="#cb117-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-226"><a href="#cb117-226" aria-hidden="true" tabindex="-1"></a>Mit Excel</span>
<span id="cb117-227"><a href="#cb117-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-228"><a href="#cb117-228" aria-hidden="true" tabindex="-1"></a>:   Hier muss ich sagen, dass es schon etwas weh tut die einfaktorielle und zweifaktorielle ANOVA in Excel zu rechnen. Ich habe dir bei der einfaktoriellen sowie der zweifaktoriellen ANOVA ein Video für die ANOVA in Excel ergänzt. Eigentlich ist es nur der letzte Strohhalm, wenn du keine Zeit mehr hast dich in R nochmal einzuarbeiten.</span>
<span id="cb117-229"><a href="#cb117-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-230"><a href="#cb117-230" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb117-231"><a href="#cb117-231" aria-hidden="true" tabindex="-1"></a><span class="fu">## Weitere Tutorien für die ANOVA</span></span>
<span id="cb117-232"><a href="#cb117-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-233"><a href="#cb117-233" aria-hidden="true" tabindex="-1"></a>Wir oben schon erwähnt, kann dieses Kapitel nicht alle Themen der ANOVA abarbeiten. Daher präsentiere ich hier eine Liste von Literatur und Links, die mich für dieses Kapitel hier inspiriert haben. Nicht alles habe ich genutzt, aber vielleicht ist für dich was dabei.</span>
<span id="cb117-234"><a href="#cb117-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-235"><a href="#cb117-235" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">ANOVA in R</span><span class="co">](https://www.datanovia.com/en/lessons/anova-in-r/)</span></span>
<span id="cb117-236"><a href="#cb117-236" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">One-Way ANOVA Test in R</span><span class="co">](https://www.sthda.com/english/wiki/one-way-anova-test-in-r)</span></span>
<span id="cb117-237"><a href="#cb117-237" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Two-Way ANOVA Test in R</span><span class="co">](https://www.sthda.com/english/wiki/two-way-anova-test-in-r)</span></span>
<span id="cb117-238"><a href="#cb117-238" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">MANOVA Test in R: Multivariate Analysis of Variance</span><span class="co">](https://www.sthda.com/english/wiki/manova-test-in-r-multivariate-analysis-of-variance)</span></span>
<span id="cb117-239"><a href="#cb117-239" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">ANOVA in R \| A Complete Step-by-Step Guide with Examples</span><span class="co">](https://www.scribbr.com/statistics/anova-in-r/)</span></span>
<span id="cb117-240"><a href="#cb117-240" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb117-241"><a href="#cb117-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-242"><a href="#cb117-242" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theoretischer Hintergrund</span></span>
<span id="cb117-243"><a href="#cb117-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-244"><a href="#cb117-244" aria-hidden="true" tabindex="-1"></a>Im folgenden Abschnitt schauen wir uns einmal den theoretischen Hintergrund zu der ANOVA an. Ich fokusiiere mich hier einmal für die Theorie auf die einfaktorielle ANOVA. Die Prinzipien lassen sich dann auch auf die zweifaktorielle und mehrfaktoriellen Algorithmen der ANOVA anwenden. Was dann später noch dazukommt sind dann die Interaktionen. Dabei ist zu bachten, dass wir natürlich eine Interaktion nur in einem zweifaktoriellen Modell beobachten können. Daher hier der Start mit der einfaktoriellen ANOVA und dann die Vertiefung zur Interaktion mit der zweifaktoriellen ANOVA.</span>
<span id="cb117-245"><a href="#cb117-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-246"><a href="#cb117-246" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>" layout-valign="top"}</span>
<span id="cb117-247"><a href="#cb117-247" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/angel_01_small.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb117-248"><a href="#cb117-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-249"><a href="#cb117-249" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *In der ersten Version dieses Kapitels habe ich noch sehr viel beispielhaft für eine einfaktorielle ANOVA durchgerechnet. Wie sich dann in den Jahren herausstellte, hat es dir wenig geholfen, die ANOVA zu verstehen oder anzuwenden. Wer rechnet schon die ANOVA per Hand? Daher hier eben das klassische* </span><span class="co">[</span><span class="ot">lying-to-children</span><span class="co">](https://en.wikipedia.org/wiki/Lie-to-children)</span><span class="sc">\*</span><span class="at"> und ich erkläre dir die ANOVA mehr konzeptionell als rein mathematisch korrekt.</span><span class="sc">\*</span></span>
<span id="cb117-250"><a href="#cb117-250" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb117-251"><a href="#cb117-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-252"><a href="#cb117-252" aria-hidden="true" tabindex="-1"></a>Wir müssen jetzt einmal für dei Haupteffekte eines Faktors $A$ oder $B$ unterschieden sowie deren Interaktion untereinander. Deshalb besprechen wir jetzt erstmal einen Haupteffekt eines Faktors $A$ mit drei Levels $A.1$, $A.2$ sowie $A.3$ und arbeiten uns dann vor. Ich habe auf großartige Mathematik und Formeln verzichtet. Du findest die entsprechenden händischen Rechenoperation auf Wikipedia oder in einem entsprechenden statistischen <span class="co">[</span><span class="ot">Lehrbuch zur ANOVA und Statistik</span><span class="co">](https://s3-us-west-2.amazonaws.com/mtvernon.wsu.edu/uploads/2016/12/Statistics_for_Terrified_Biologists.pdf)</span> wie das verlinkte Buch von @van2019statistics.</span>
<span id="cb117-253"><a href="#cb117-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-254"><a href="#cb117-254" aria-hidden="true" tabindex="-1"></a><span class="fu">### Haupteffekte $f_A$</span></span>
<span id="cb117-255"><a href="#cb117-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-256"><a href="#cb117-256" aria-hidden="true" tabindex="-1"></a>Für die Theorie konzentrieren wir uns nur auf die einfaktoriele ANOVA. Das heißt wir haben einen Faktor $A$ mit drei Levels $A.1$, $A.2$ sowie $A.3$ vorliegen. Du kannst dir die drei Level als drei Gruppen vorstellen. Entweder sind es verschiedene Düngestufen oder aber eben drei Floharten, die unterschiedlich weit springen. Erinnere dich nochmal an die @fig-anova-intro zu Beginn des Kapitels. Wir wollen in unseren Daten Varianz haben, denn nur dann haben wir auch wirklich einen Unterschied zwischen den Gruppen in unserer Behandlung. Fangen wir also mit der wichtigste Frage einmal an.</span>
<span id="cb117-257"><a href="#cb117-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-258"><a href="#cb117-258" aria-hidden="true" tabindex="-1"></a>Wann sind drei oder mehr Mittelwerte gleich?</span>
<span id="cb117-259"><a href="#cb117-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-260"><a href="#cb117-260" aria-hidden="true" tabindex="-1"></a>:   Für unseren Gedankengang nehmen wir mal drei Mittelwerte für die drei Gruppen $A.1$, $A.2$ sowie $A.3$ an. Wir brauchen ja in der Nullhypothese Gleichheit. Das heißt, dass alle drei Mittelwerte $\bar{y}_{A.1}$, $\bar{y}_{A.2}$ und $\bar{y}_{A.3}$ gleich sein müssen. Wir nennen diese Mittelwerte der Gruppen daher auch lokale Mittelwerte. Wir können also wie folgt schreiben.</span>
<span id="cb117-261"><a href="#cb117-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-262"><a href="#cb117-262" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-263"><a href="#cb117-263" aria-hidden="true" tabindex="-1"></a>\bar{y}_{A.1} = \bar{y}_{A.2} = \bar{y}_{A.3}</span>
<span id="cb117-264"><a href="#cb117-264" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-265"><a href="#cb117-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-266"><a href="#cb117-266" aria-hidden="true" tabindex="-1"></a>Jetzt kommt der eigentlich Hauptgedanke. Wir können auch einen globalen Mittelwert $\beta_0$ berechnen in dem wir die drei Mittelwerte mitteln oder aber den Faktor vergessen und über alle Beobachtungen den Mittelwert berechnen. Wenn wir mehr Mittelwerte oder eben Gruppen haben, dann ändert sich natürlich der Nenner.</span>
<span id="cb117-267"><a href="#cb117-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-268"><a href="#cb117-268" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-269"><a href="#cb117-269" aria-hidden="true" tabindex="-1"></a>\beta_0 = \cfrac{\bar{y}_{A.1} + \bar{y}_{A.2} + \bar{y}_{A.3}}{3}</span>
<span id="cb117-270"><a href="#cb117-270" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-271"><a href="#cb117-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-272"><a href="#cb117-272" aria-hidden="true" tabindex="-1"></a>Wenn die drei Mittelwerte gleich sind, dann ist auch das globale Mittel $\beta_0$ gleich der drei Mittelwerte. Das klingt jetzt erstmal etwas schräg, aber wir hätten dann folgenden Zusammenhang. Aber das ist eigentlich was wir brauchen. Eine statistische Maßzahl, die Null ist, wenn Gleichheit in den Gruppen vorherrscht.</span>
<span id="cb117-273"><a href="#cb117-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-274"><a href="#cb117-274" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-275"><a href="#cb117-275" aria-hidden="true" tabindex="-1"></a>\mbox{Wenn}\; \beta_0 = 0\; \mbox{dann}\; \bar{y}_{A.1} = \bar{y}_{A.2} = \bar{y}_{A.3}</span>
<span id="cb117-276"><a href="#cb117-276" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-277"><a href="#cb117-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-278"><a href="#cb117-278" aria-hidden="true" tabindex="-1"></a>In der folgenden @fig-ggplot-anova-intro-null wird dir es vielleicht nochmal klarer. Wir haben hier einmal den globalen Mittelwert $\beta_0$ sowie von lokalen Mittelwerten $\bar{y}_{A.1}$, $\bar{y}_{A.2}$ und $\bar{y}_{A.3}$ der einzelen Gruppen des Faktors $A$ dargsstellt. In der linken Abbildung siehst du, dass die lokalen Mittelwerte der Gruppen alle auf einer Höhe liegen. Die Mittelwerte der Gruppen sind gleich. Es gibt keinen Uterschied. Darüber hinaus sind die Abstände der lokalen Mittelwerte zum gloabeln Mittelwert Null. Die Nullhypothese gilt.</span>
<span id="cb117-279"><a href="#cb117-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-280"><a href="#cb117-280" aria-hidden="true" tabindex="-1"></a>Wenn sich jetzt die lokalen Mittelwerte untereinander unterscheiden, dann liegen die lokalen Mittelwerte nicht mehr auf einer Ebene. Damit entstehen auch positive und negative Abstände von den lokalen Mittelwerten zu dem globalen Mittelwert. Diese Abstände sind nämlich jetzt nicht mehr Null. Daher haben wir auch nicht mehr Gleichkeit vorliegen. Wir können daher die Nullhypothese ablehnen. Je größer die Abstände der lokalen Mittelwerte zum globalen Mittelwert werden, desto mehr würden wir die Nullhypothese ablehnen und an einen Gruppenunterschied glauben.</span>
<span id="cb117-281"><a href="#cb117-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-284"><a href="#cb117-284" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-285"><a href="#cb117-285" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-286"><a href="#cb117-286" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-287"><a href="#cb117-287" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-288"><a href="#cb117-288" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-anova-intro-null</span></span>
<span id="cb117-289"><a href="#cb117-289" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-290"><a href="#cb117-290" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.5</span></span>
<span id="cb117-291"><a href="#cb117-291" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7.5</span></span>
<span id="cb117-292"><a href="#cb117-292" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Zusammenhang zwischen dem globalen Mittelwert $\\beta_0$ und den drei Mittelwerten $\\bar{y}_{A.1}$, $\\bar{y}_{A.2}$ und $\\bar{y}_{A.3}$ der Gruppen $A.1$, $A.2$ sowie $A.3$. **(A)** Wenn die drei Mittelwerte gleich sidn und damit die Nullhypothese gilt, dann liegen die drei Mittelwerte auf dem globalen Mittelwert. **(B)** Wenn die drei Mittelwerte sich unterschieden, dann kann die Nullhypothese abgelehnt werden und die drei Mittelwerte liegen nicht auf dem globalen Mittel.  *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb117-293"><a href="#cb117-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-294"><a href="#cb117-294" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">202434</span>)</span>
<span id="cb117-295"><a href="#cb117-295" aria-hidden="true" tabindex="-1"></a>ex_intro_null_lst <span class="ot">&lt;-</span> <span class="fu">get_intro_data_tbl</span>(<span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>), </span>
<span id="cb117-296"><a href="#cb117-296" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">sd =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="dv">1</span>), <span class="at">ng =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">5</span>))</span>
<span id="cb117-297"><a href="#cb117-297" aria-hidden="true" tabindex="-1"></a>ex_intro_alt_lst <span class="ot">&lt;-</span> <span class="fu">get_intro_data_tbl</span>(<span class="at">mean =</span> <span class="fu">c</span>(<span class="fl">4.5</span>, <span class="dv">1</span>, <span class="dv">8</span>), </span>
<span id="cb117-298"><a href="#cb117-298" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">sd =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="dv">1</span>), <span class="at">ng =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">5</span>))</span>
<span id="cb117-299"><a href="#cb117-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-300"><a href="#cb117-300" aria-hidden="true" tabindex="-1"></a><span class="fu">get_ex_lst_intro_plot</span>(ex_intro_null_lst) <span class="sc">+</span> </span>
<span id="cb117-301"><a href="#cb117-301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Nullhypothese annehmen"</span>,</span>
<span id="cb117-302"><a href="#cb117-302" aria-hidden="true" tabindex="-1"></a>          <span class="at">subtitle =</span> <span class="st">"Die Mittelwerte sind gleich"</span>) <span class="sc">+</span></span>
<span id="cb117-303"><a href="#cb117-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_ex_lst_intro_plot</span>(ex_intro_alt_lst) <span class="sc">+</span> </span>
<span id="cb117-304"><a href="#cb117-304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Nullhypothese ablehnen"</span>,</span>
<span id="cb117-305"><a href="#cb117-305" aria-hidden="true" tabindex="-1"></a>          <span class="at">subtitle =</span> <span class="st">"Die Mittelwerte unterscheiden sich"</span>) <span class="sc">+</span></span>
<span id="cb117-306"><a href="#cb117-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb117-307"><a href="#cb117-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>) <span class="sc">+</span></span>
<span id="cb117-308"><a href="#cb117-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb117-309"><a href="#cb117-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb117-310"><a href="#cb117-310" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-311"><a href="#cb117-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-312"><a href="#cb117-312" aria-hidden="true" tabindex="-1"></a>Damit haben wir jetzt das zentrale Prinzip der ANOVA verstanden. Es geht um die Abstände von lokalen Gruppenmittelwerten zu einem globalen Mittelwert über alle Gruppen.</span>
<span id="cb117-313"><a href="#cb117-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-314"><a href="#cb117-314" aria-hidden="true" tabindex="-1"></a>Wie werden die Abstände von den lokalen Mittelwert zum globalen Mittelwert berechnet?</span>
<span id="cb117-315"><a href="#cb117-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-316"><a href="#cb117-316" aria-hidden="true" tabindex="-1"></a>:   Nun könnten wir einfach sagen, dass wenn die aufsummierten Abstände nicht Null sind, wir einen Effekt in den Gruppen vorliegen haben. Hier tritt wieder das Problem auf, dass wir positive Abweichung und negative Abweichungen von den lokalen Mittelwerten zu dem gloablen mittelwert haben. Daher berechnen wir nicht die Abstände sondern die quadratischen Abstände und summieren diese dann auf. Wir berechnen die Abweichungsquadrate (eng. *sum of squares*, abk. *SS*). Daher sagen wir auch, dass die Abstände der lokalen Mittelwerte zum globalen Mittel als Abweichungsquadrate berechnet werden. In der folgenden Abbildung siehst du einmal die Visualsierung der Berechnung der Abweichungsquadrate des Faktors $A$ oder eben $SS_A$.</span>
<span id="cb117-317"><a href="#cb117-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-320"><a href="#cb117-320" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-321"><a href="#cb117-321" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-322"><a href="#cb117-322" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-323"><a href="#cb117-323" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-324"><a href="#cb117-324" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-anova-intro-alt-ssa</span></span>
<span id="cb117-325"><a href="#cb117-325" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-326"><a href="#cb117-326" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.5</span></span>
<span id="cb117-327"><a href="#cb117-327" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7.5</span></span>
<span id="cb117-328"><a href="#cb117-328" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualsierung der Berechnung der Abweichungsquadrate des Faktors $A$ als $SS_A$ bezeichnet. Für jede Beobachtung wird einmal der Abstand des lokalen Mittelwerts der Gruppe zum globalen Mittelwert berechnet und quadriert. Die Abstände werden dann aufsummiert."</span></span>
<span id="cb117-329"><a href="#cb117-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-330"><a href="#cb117-330" aria-hidden="true" tabindex="-1"></a><span class="fu">get_ex_lst_intro_alt_ssa_plot</span>(ex_intro_alt_lst) <span class="sc">+</span> </span>
<span id="cb117-331"><a href="#cb117-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(Berechnung<span class="sc">~</span>der<span class="sc">~</span>SS[A]<span class="sc">~</span>auch<span class="sc">~</span>SS[between]),</span>
<span id="cb117-332"><a href="#cb117-332" aria-hidden="true" tabindex="-1"></a>          <span class="at">subtitle =</span> <span class="st">"Wie streuen die Gruppenmittelwerte um das globale Mittel?"</span>)</span>
<span id="cb117-333"><a href="#cb117-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-334"><a href="#cb117-334" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-335"><a href="#cb117-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-336"><a href="#cb117-336" aria-hidden="true" tabindex="-1"></a>Jetzt tritt aber wiederum ein anderes Problem auf. Je mehr Gruppen wir haben, desto größer werden unsere Abweichungsquadrate. Deshalb mitteln wir auch die Abweichungsquadrate um die mittleren Abweichungsquadrate (eng. *mean of squares*, abk. *MS*) zu erhalten. Jetzt könnten wir natürlich sagen, wenn $MS_A$ gleich Null ist, dann können wir die Nullhypothese nicht ablehnen. Aber hier nochmal ein kurzer Einwurf zur Teststatistik.</span>
<span id="cb117-337"><a href="#cb117-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-338"><a href="#cb117-338" aria-hidden="true" tabindex="-1"></a>Wie sieht eine Teststatistik aus?</span>
<span id="cb117-339"><a href="#cb117-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-340"><a href="#cb117-340" aria-hidden="true" tabindex="-1"></a>:   Eine Teststatistik teilt immer den Effekt (*signal*) durch die Streuung des Effekts (*noise*). Dabei muss eine Teststatistik Null sein, wenn die Nullhypothese gilt. Daher haben wir dann folgenden Zusammenhang.</span>
<span id="cb117-341"><a href="#cb117-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-342"><a href="#cb117-342" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-343"><a href="#cb117-343" aria-hidden="true" tabindex="-1"></a>T_D = \cfrac{\mbox{signal}}{\mbox{noise}} = \cfrac{\mbox{Effekt}}{\mbox{Streuung}}</span>
<span id="cb117-344"><a href="#cb117-344" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-345"><a href="#cb117-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-346"><a href="#cb117-346" aria-hidden="true" tabindex="-1"></a>In unserem Fall wäre dann der Effekt die mittleren Abweichungsquadrate des Faktors A also $MS_A$. Das passt auch in soweit, dass wenn die mittlere Abweichung der lokalen Mittelwerte zum globalen Mittelwert Null ist, dann können wir die Nullhypothese nicht ablehnen. Es fehlt also noch ein statistisches Maß für die Streuung.</span>
<span id="cb117-347"><a href="#cb117-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-348"><a href="#cb117-348" aria-hidden="true" tabindex="-1"></a>Wir haben aber noch die Streuung *innerhalb* der einzelnen Gruppen. Diese Streuung innerhalb der Gruppen nennen wir gerne Reststreuung, da diese nicht von den Gruppen erklärt wird. Oder aber ganz kurz, den Fehler (eng. *error*). Wir berechnen also nochmal die quadrierten Abstände der einzelnen Beobachtungen um die jeweiligen Gruppenmittelwerte und nennen diese dann $SS_{Error}$. Dann summieren wir die quadrierten Abstände einmal auf, wie du in der folgenden Abbildung einmal sehen kannst. Am Ende mitteln wir auch die quadratische Abweichung der Fehler zu $MS_{Error}$ umd die mittlere Abweichung der einzelnen Beobachtungen zu den lokalen Mittelwerten darzustellen.</span>
<span id="cb117-349"><a href="#cb117-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-352"><a href="#cb117-352" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-353"><a href="#cb117-353" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-354"><a href="#cb117-354" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-355"><a href="#cb117-355" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-356"><a href="#cb117-356" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-anova-intro-alt-sse</span></span>
<span id="cb117-357"><a href="#cb117-357" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-358"><a href="#cb117-358" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.5</span></span>
<span id="cb117-359"><a href="#cb117-359" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7.5</span></span>
<span id="cb117-360"><a href="#cb117-360" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualsierung der Berechnung der Abweichungsquadrate des Fehlers $Error$ als $SS_{Error}$ bezeichnet. Für jede Beobachtung wird einmal der Abstand zum lokalen Mittelwert der Gruppe berechnet und quadriert. Die Abstände werden dann aufsummiert."</span></span>
<span id="cb117-361"><a href="#cb117-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-362"><a href="#cb117-362" aria-hidden="true" tabindex="-1"></a><span class="fu">get_ex_lst_intro_alt_sse_plot</span>(ex_intro_alt_lst) <span class="sc">+</span></span>
<span id="cb117-363"><a href="#cb117-363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(Berechnung<span class="sc">~</span>des<span class="sc">~</span>SS[Error]<span class="sc">~</span>auch<span class="sc">~</span>SS[within]),</span>
<span id="cb117-364"><a href="#cb117-364" aria-hidden="true" tabindex="-1"></a>          <span class="at">subtitle =</span> <span class="st">"Wie streuen die Beobachtungen um die Gruppenmittelwerte?"</span>)</span>
<span id="cb117-365"><a href="#cb117-365" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-366"><a href="#cb117-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-367"><a href="#cb117-367" aria-hidden="true" tabindex="-1"></a>In der folgenden Tabelle siehst du nochmal die wichtigen Begrifflichkeiten der Varianz in einer ANOVA als mittleren quadratischen Abweichung $MS$ zusammengefasst. Die gesamte Varianz wird auch als $MS_{Total}$ bezeichnet und du kennst diese schon als gepoolte Varianz $s^2_p$ aus dem Student t-Test.</span>
<span id="cb117-368"><a href="#cb117-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-369"><a href="#cb117-369" aria-hidden="true" tabindex="-1"></a>|                               |              |                |         |</span>
<span id="cb117-370"><a href="#cb117-370" aria-hidden="true" tabindex="-1"></a>|-------------------------------|:------------:|:--------------:|:-------:|</span>
<span id="cb117-371"><a href="#cb117-371" aria-hidden="true" tabindex="-1"></a>| Varianz zwischen den Gruppen  |    $MS_A$    | $MS_{between}$ |         |</span>
<span id="cb117-372"><a href="#cb117-372" aria-hidden="true" tabindex="-1"></a>| Varianz innerhalb der Gruppen | $MS_{Error}$ | $MS_{within}$  |         |</span>
<span id="cb117-373"><a href="#cb117-373" aria-hidden="true" tabindex="-1"></a>| Varianz aller Gruppen         | $MS_{Total}$ |  $MS_{Total}$  | $s^2_p$ |</span>
<span id="cb117-374"><a href="#cb117-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-375"><a href="#cb117-375" aria-hidden="true" tabindex="-1"></a>: Zusammenfassung der Begrifflichkeit der mittleren quadratischen Abweichung $MS$ in einer ANOVA. {#tbl-anova-namen}</span>
<span id="cb117-376"><a href="#cb117-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-377"><a href="#cb117-377" aria-hidden="true" tabindex="-1"></a>Da wir jetzt alle statistischen Maßzahlen zusammen haben können wir jetzt auch einen statistischen Test rechnen. Wir haben damit dann einmal als Effekt die mittleren Abweichungsquadrate der lokalen Mittelwerte zum globalen Mittelwert des Faktors $A$ als $MS_A$ vorliegen. Das ist jetzt unser statistisches Maß für den Mittelwertsunterschied oder eben allgemeiner dem Effekt. Auch wenn wir diesen Effekt nicht biologisch interpretieren können. Dann haben wir noch als Streuung den Fehler, als mittlere Abweichungsquadrate der Beobachtungen zu den jeweiligen Gruppenmittewerten. Daraus können wir uns jetzt die Testststatistik $F_D$ der ANOVA bauen.</span>
<span id="cb117-378"><a href="#cb117-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-379"><a href="#cb117-379" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-380"><a href="#cb117-380" aria-hidden="true" tabindex="-1"></a>F_D = \cfrac{MS_A}{MS_{Error}}</span>
<span id="cb117-381"><a href="#cb117-381" aria-hidden="true" tabindex="-1"></a>$$ mit</span>
<span id="cb117-382"><a href="#cb117-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-383"><a href="#cb117-383" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$MS_A$ gleich der mittleren Abweichungsquadrate der lokalen Mittelwerte zum globalen Mittelwert des Faktors $A$.</span>
<span id="cb117-384"><a href="#cb117-384" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$MS_{Error}$ mittlere Abweichungsquadrate der Beobachtungen zu den jeweiligen Gruppenmittewerten.</span>
<span id="cb117-385"><a href="#cb117-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-386"><a href="#cb117-386" aria-hidden="true" tabindex="-1"></a>Wenn die Nullhypothese gilt, dann sind die mittleren Abweichungsquadrate der lokalen Mittelwerte zum globalen Mittelwert $MS_A$ gleich Null und die Teststatistik $F_D$ ist ebenfalls Null. Es kann aber keine negativen Werte für die F Statistik geben, da es keien ngeativen Werte für $MS_A$ geben kann. In der folgenden Abbildung siehst du nochmal die F Statistik visualisert.</span>
<span id="cb117-387"><a href="#cb117-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-390"><a href="#cb117-390" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-391"><a href="#cb117-391" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-392"><a href="#cb117-392" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-393"><a href="#cb117-393" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-394"><a href="#cb117-394" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-anova-fstat</span></span>
<span id="cb117-395"><a href="#cb117-395" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-396"><a href="#cb117-396" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb117-397"><a href="#cb117-397" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb117-398"><a href="#cb117-398" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualiserung der F Statistik einer ANOVA mit dem kritischen Wert $F_{\\alpha = 5\\%}$ und der berechneten Teststatistik $F_D$ aus den Daten. Eingezeichnet sind als Flächen das Signifkanzniveau $\\alpha$ gleich 5% und der p-Wert mit $Pr(F_D|H_0)$."</span></span>
<span id="cb117-399"><a href="#cb117-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-400"><a href="#cb117-400" aria-hidden="true" tabindex="-1"></a>p_f_stat</span>
<span id="cb117-401"><a href="#cb117-401" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-402"><a href="#cb117-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-403"><a href="#cb117-403" aria-hidden="true" tabindex="-1"></a>Jetzt bietet es sich an nochmal den Zusammenhang von $MS_A$ und $MS_{Error}$ in der folgenden @fig-ggplot-anova-msa-mse näher zu betrachten. Wir können ja kleine Werte oder große Werte für die mittleren Abweichungsquadrate der lokalen Mittelwerte zum globalen Mittelwert $MS_A$ vorliegen haben. Ebenso können die mittlere Abweichungsquadrate der Beobachtungen zu den jeweiligen Gruppenmittewerten $MS_{Error}$ klein oder groß sein. Wir sehen sofort, dass ein großer Effekt $MS_A &gt; 0$ und ein kleiner Fehler $MS_{Error} \approx 0$ es erleichtern einen signifikanten Unterschied nachzuweisen. Steigt der Fehler oder wird der Effekt klein, wird es schwerer einen signifikanten Unterschied zwischen den Gruppen zu zeigen. Die Gruppenmittelwerte liegen dann meistens auf einer Ebene oder die Fehlerbalken überlappen sich.</span>
<span id="cb117-404"><a href="#cb117-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-407"><a href="#cb117-407" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-408"><a href="#cb117-408" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-409"><a href="#cb117-409" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-410"><a href="#cb117-410" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-411"><a href="#cb117-411" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-anova-msa-mse</span></span>
<span id="cb117-412"><a href="#cb117-412" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-413"><a href="#cb117-413" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb117-414"><a href="#cb117-414" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7.5</span></span>
<span id="cb117-415"><a href="#cb117-415" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung des Zusammenhangs zwischen den mittleren Abweichungsquadrate der lokalen Mittelwerte zum globalen Mittelwert $MS_A$ sowie der mittleren Abweichungsquadrate der Beobachtungen zu den jeweiligen Gruppenmittewerten $MS_{Error}$. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb117-416"><a href="#cb117-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-417"><a href="#cb117-417" aria-hidden="true" tabindex="-1"></a>ex_00_lst <span class="ot">&lt;-</span> <span class="fu">get_data_tbl</span>(<span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>), <span class="at">sd =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>))</span>
<span id="cb117-418"><a href="#cb117-418" aria-hidden="true" tabindex="-1"></a>ex_01_lst <span class="ot">&lt;-</span> <span class="fu">get_data_tbl</span>(<span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">9</span>), <span class="at">sd =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>))</span>
<span id="cb117-419"><a href="#cb117-419" aria-hidden="true" tabindex="-1"></a>ex_10_lst <span class="ot">&lt;-</span> <span class="fu">get_data_tbl</span>(<span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>), <span class="at">sd =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb117-420"><a href="#cb117-420" aria-hidden="true" tabindex="-1"></a>ex_11_lst <span class="ot">&lt;-</span> <span class="fu">get_data_tbl</span>(<span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">9</span>), <span class="at">sd =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb117-421"><a href="#cb117-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-422"><a href="#cb117-422" aria-hidden="true" tabindex="-1"></a><span class="fu">get_ex_lst_plot</span>(ex_00_lst) <span class="sc">+</span> </span>
<span id="cb117-423"><a href="#cb117-423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(MS[A]<span class="sc">%~~%</span><span class="dv">0</span><span class="sc">~</span>und<span class="sc">~</span>MS[Error]<span class="sc">%~~%</span><span class="dv">0</span>),</span>
<span id="cb117-424"><a href="#cb117-424" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Mittelwerte gleich und Fehler klein"</span>) <span class="sc">+</span></span>
<span id="cb117-425"><a href="#cb117-425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_ex_lst_plot</span>(ex_01_lst) <span class="sc">+</span></span>
<span id="cb117-426"><a href="#cb117-426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(MS[A]<span class="sc">~</span><span class="st">"&gt;"</span><span class="sc">~</span><span class="dv">0</span><span class="sc">~</span>und<span class="sc">~</span>MS[Error]<span class="sc">%~~%</span><span class="dv">0</span>),</span>
<span id="cb117-427"><a href="#cb117-427" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Mittelwerte ungleich und Fehler klein"</span>) <span class="sc">+</span></span>
<span id="cb117-428"><a href="#cb117-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_ex_lst_plot</span>(ex_10_lst) <span class="sc">+</span> </span>
<span id="cb117-429"><a href="#cb117-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(MS[A]<span class="sc">%~~%</span><span class="dv">0</span><span class="sc">~</span>und<span class="sc">~</span>MS[Error]<span class="sc">~</span><span class="st">"&gt;"</span><span class="sc">~</span><span class="dv">0</span>),</span>
<span id="cb117-430"><a href="#cb117-430" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Mittelwerte gleich und Fehler groß"</span>) <span class="sc">+</span>  </span>
<span id="cb117-431"><a href="#cb117-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_ex_lst_plot</span>(ex_11_lst) <span class="sc">+</span></span>
<span id="cb117-432"><a href="#cb117-432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(MS[A]<span class="sc">~</span><span class="st">"&gt;"</span><span class="sc">~</span><span class="dv">0</span><span class="sc">~</span>und<span class="sc">~</span>MS[Error]<span class="sc">~</span><span class="st">"&gt;"</span><span class="sc">~</span><span class="dv">0</span>),</span>
<span id="cb117-433"><a href="#cb117-433" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Mittelwerte ungleich und Fehler groß"</span>) <span class="sc">+</span>  </span>
<span id="cb117-434"><a href="#cb117-434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb117-435"><a href="#cb117-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>) <span class="sc">+</span></span>
<span id="cb117-436"><a href="#cb117-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb117-437"><a href="#cb117-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb117-438"><a href="#cb117-438" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-439"><a href="#cb117-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-440"><a href="#cb117-440" aria-hidden="true" tabindex="-1"></a>Am Ende können wir dann die Abweichungsquadrate $SS$ und die mittleren Abweichungsquadrate $MS$ in einer Übersichtstabelle darstellen. Wir nennen diese Übersichtstabelle auch gerne die Ergebnistabelle der ANOVA. Wir können dann auch die $F_D$ Teststatistik ergänzen. Jeder Faktor hat eine eigene Zeile. Dabei addieren sich dann die $SS_A$ und $SS_{Error}$ zu den gesammten $SS_{Total}$ auf. Die Ergebnistabelle wird dir dann später in R berechnet. Insbesondere die Berechnung der Freiheitsgrade $df$ ist eine eigene Wissenschaft für sich und du würdest diese Berechnung dann in einem statistsichen Buch nachschlagen. Hier dient die Ergebnistabelle dann nur zur Übersicht.</span>
<span id="cb117-441"><a href="#cb117-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-442"><a href="#cb117-442" aria-hidden="true" tabindex="-1"></a>| Quelle | df | Sum of squares (SS) | Mean squares (MS) | Teststatistik F$_{\boldsymbol{D}}$ |</span>
<span id="cb117-443"><a href="#cb117-443" aria-hidden="true" tabindex="-1"></a>|:--:|:--:|:--:|:--:|:--:|</span>
<span id="cb117-444"><a href="#cb117-444" aria-hidden="true" tabindex="-1"></a>| $A$ | $df_A$ | $SS_A$ | $MS_A = \cfrac{SS_A}{df_A}$ | $F_{D} = \cfrac{MS_A}{MS_{Error}}$ |</span>
<span id="cb117-445"><a href="#cb117-445" aria-hidden="true" tabindex="-1"></a>| $Error$ | $df_{Error}$ | $SS_{Error}$ | $MS_{Error} = \cfrac{SS_{Error}}{df_{Error}}$ |  |</span>
<span id="cb117-446"><a href="#cb117-446" aria-hidden="true" tabindex="-1"></a>| $Total$ | $df_{total}$ | $SS_{Total}$ |  |  |</span>
<span id="cb117-447"><a href="#cb117-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-448"><a href="#cb117-448" aria-hidden="true" tabindex="-1"></a>: Ergebnistabelle der einfaktoriellen ANOVA in der theoretischen Darstellung. Die Abweichungsquadrate $SS$ müssen noch zu den mittleren Abweichungsquadraten $MS$ gemittelt werden. Abschließend wird die $F_D$ Teststatistik als Prüfgröße berechnet. {#tbl-anova-fac1-theo}</span>
<span id="cb117-449"><a href="#cb117-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-450"><a href="#cb117-450" aria-hidden="true" tabindex="-1"></a>Wenn es dann die Ergebnistabelle für die einfaktorielle ANOVA gibt, dann gibt es natürlich auch eine Ergebnistabelle für eine zweifaktorielle ANOVA. Im Folgenden einmal die Ergebnistabelle gezeigt. Wenn du mehr Faktoren in deine ANOVA aufnimmst, dann erhälst du mehr Zeilen. Insbesondere der Interaktionsterm $A \times B$ kann erst auftreten, wenn du zwei oder mhr Faktoren in dein Modell nimmst. Am Ende berechnest du aber immer die F Statistik indem du die mittleren Abweichungsquadrate des entsprechenden Fakotr in der Zeile durch den mittleren Fehler teilst. Es wird eben immer komplexer und hier nimmt uns R die Arbeit dann ab.</span>
<span id="cb117-451"><a href="#cb117-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-452"><a href="#cb117-452" aria-hidden="true" tabindex="-1"></a>| Quelle | df | Sum of squares (SS) | Mean squares (MS) | Teststatistik F$_{\boldsymbol{D}}$ |</span>
<span id="cb117-453"><a href="#cb117-453" aria-hidden="true" tabindex="-1"></a>|:--:|:--:|:--:|:--:|:--:|</span>
<span id="cb117-454"><a href="#cb117-454" aria-hidden="true" tabindex="-1"></a>| $A$ | $df_A$ | $SS_{A}$ | $MS_{A} = \cfrac{SS_A}{df_A}$ | $F_{D} = \cfrac{MS_{A}}{MS_{Error}}$ |</span>
<span id="cb117-455"><a href="#cb117-455" aria-hidden="true" tabindex="-1"></a>| $B$ | $df_B$ | $SS_{B}$ | $MS_{B} = \cfrac{SS_B}{df_B}$ | $F_{D} = \cfrac{MS_{B}}{MS_{Error}}$ |</span>
<span id="cb117-456"><a href="#cb117-456" aria-hidden="true" tabindex="-1"></a>| $A \times B$ | $df_{A \times B}$ | $SS_{A \times B}$ | $MS_{A \times B} = \cfrac{SS_{A \times B}}{df_{A \times B}}$ | $F_{D} = \cfrac{MS_{A \times B}}{MS_{Error}}$ |</span>
<span id="cb117-457"><a href="#cb117-457" aria-hidden="true" tabindex="-1"></a>| $Error$ | $df_{Error}$ | $SS_{error}$ | $MS_{Error} = \cfrac{SS_{Error}}{df_{Error}}$ |  |</span>
<span id="cb117-458"><a href="#cb117-458" aria-hidden="true" tabindex="-1"></a>| $Total$ | $df_{total}$ | $SS_{total}$ |  |  |</span>
<span id="cb117-459"><a href="#cb117-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-460"><a href="#cb117-460" aria-hidden="true" tabindex="-1"></a>: Ergebnistabelle der zweifaktoriellen ANOVA in der theoretischen Darstellung mit Interaktionsterm für die beiden Faktoren. Die Abweichungsquadrate $SS$ müssen noch zu den mittleren Abweichungsquadraten $MS$ gemittelt werden. Abschließend wird die $F_D$ Teststatistik als Prüfgröße für jeden Faktor separat berechnet. {#tbl-anova-fac2-ohne-inter}</span>
<span id="cb117-461"><a href="#cb117-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-462"><a href="#cb117-462" aria-hidden="true" tabindex="-1"></a>Damit wären wir fast schon am Ende der theoretischen Betrachtung des Haupteffekts eines Fakots in der einfaktoriellen ANOVA. Was mir jetzt noch bleibt, ist auf die Varianzhomogenität einzugehen. Wie du sicherlich schon gelesen hast, müssen alle Gruppen die gleiche Varianz haben. Wir berechnen ja auch nur einen Fehlerterm durch den wir dann teilen. Der ist ja für jeden Faktor der gleiche Wert. Daher hier nochmal ein Satz zur Varianzhomogenität.</span>
<span id="cb117-463"><a href="#cb117-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-464"><a href="#cb117-464" aria-hidden="true" tabindex="-1"></a>Die Annahme der Varianzhomogenität theoretisch betrachtet</span>
<span id="cb117-465"><a href="#cb117-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-466"><a href="#cb117-466" aria-hidden="true" tabindex="-1"></a>:   Wir wollen nochmal die Annahme an die Varianuhomogenität theoretisch betrachten und herausfinden, warum wir homogene Varianzen über die Gruppen brauchen. Wir du in der folgenden @fig-ggplot-anova-var-hetero einmal siehst, modelliert die ANOVA unter der Annahme der Varianzhomogenität in den Gruppen die Daten. Wir haben in den linken Plot unsere experimentellen Datan mit starker Varianzheterogenität. Die Varianz in der Gruppe $A.2$ ist viel größer als in den anderen beiden Gruppen. Dabei unterscheiden sich die Gruppen $A.1$ und $A.3$ signifikant. Die beiden Gruppen teilen sich nicht den gleichen Buchstaben des *Compact letter displays*. Wenn wir jetzt die ANOVA rechnen, dann teilen sich alle Gruppen die gemittlete Varianz über *alle* Gruppen. Das sehen wir dann in der rechten Abbilung. Die beiden Gruppen $A.1$ und $A.3$ erhalten viel mehr Streuung und die Gruppe $A.2$ weniger. Am Ende haben alle Gruppen faktisch gleich viel Streuung. So sehen dann die Daten aus, die die ANOVA modelliert. Wir können am Ende keinen signifikanten Unterschied mehr nachweisen. Daher kann es passieren, dasss eine ANOVA keinen Unterschied nachweisen kann, aber <span class="in">`{emmeans}`</span> mit der Adjustierung für Varianzheterogenität dennoch einen Unterschied findet.</span>
<span id="cb117-467"><a href="#cb117-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-470"><a href="#cb117-470" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-471"><a href="#cb117-471" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-472"><a href="#cb117-472" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-473"><a href="#cb117-473" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-474"><a href="#cb117-474" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-anova-var-hetero</span></span>
<span id="cb117-475"><a href="#cb117-475" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-476"><a href="#cb117-476" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.5</span></span>
<span id="cb117-477"><a href="#cb117-477" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7.5</span></span>
<span id="cb117-478"><a href="#cb117-478" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung der Annahme der Varianzhomogenität in den Gruppen. **(A)** Die experimentellen Daten zeigen eine Varianzheterogenität in den Gruppen. Die Gruppe $A.1$ unterscheidet sich signifikant von der Gruppe $A.3$ dargestellt durch das *Compact letter display*. **(B)** Die ANOVA modelliert gleiche Varianzen in allen Gruppen. Dadurch verschwindet der signifikante Unterschied, da der Fehler über alle Gruppen gemittelt wird *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb117-479"><a href="#cb117-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-480"><a href="#cb117-480" aria-hidden="true" tabindex="-1"></a>ex_hetero_lst <span class="ot">&lt;-</span> <span class="fu">get_data_tbl</span>(<span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">6</span>), <span class="at">sd =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">4</span>, <span class="fl">0.5</span>))</span>
<span id="cb117-481"><a href="#cb117-481" aria-hidden="true" tabindex="-1"></a>ex_homo_lst <span class="ot">&lt;-</span> <span class="fu">get_data_tbl</span>(<span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">6</span>), <span class="at">sd =</span> <span class="fu">c</span>(<span class="fl">1.7</span>, <span class="fl">1.7</span>, <span class="fl">1.7</span>))</span>
<span id="cb117-482"><a href="#cb117-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-483"><a href="#cb117-483" aria-hidden="true" tabindex="-1"></a><span class="fu">get_ex_lst_plot</span>(ex_hetero_lst) <span class="sc">+</span> </span>
<span id="cb117-484"><a href="#cb117-484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Experimentelle Daten"</span>,</span>
<span id="cb117-485"><a href="#cb117-485" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Varianzheterogenität in den Gruppen"</span>,</span>
<span id="cb117-486"><a href="#cb117-486" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Buchstaben zeigen Compact letter display"</span>) <span class="sc">+</span></span>
<span id="cb117-487"><a href="#cb117-487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="fl">5.5</span>, <span class="fl">16.5</span>, <span class="fl">25.5</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">13</span>, <span class="dv">9</span>), </span>
<span id="cb117-488"><a href="#cb117-488" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"AB"</span>, <span class="st">"B"</span>), <span class="at">fill =</span> <span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb117-489"><a href="#cb117-489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_ex_lst_plot</span>(ex_homo_lst) <span class="sc">+</span></span>
<span id="cb117-490"><a href="#cb117-490" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"ANOVA Modellierung"</span>,</span>
<span id="cb117-491"><a href="#cb117-491" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Varianzhomogenität in den Gruppen"</span>,</span>
<span id="cb117-492"><a href="#cb117-492" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Buchstaben zeigen Compact letter display"</span>) <span class="sc">+</span></span>
<span id="cb117-493"><a href="#cb117-493" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="fl">5.5</span>, <span class="fl">15.5</span>, <span class="fl">25.5</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="fl">9.5</span>, <span class="dv">9</span>), </span>
<span id="cb117-494"><a href="#cb117-494" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"A"</span>), <span class="at">fill =</span> <span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb117-495"><a href="#cb117-495" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb117-496"><a href="#cb117-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>) <span class="sc">+</span></span>
<span id="cb117-497"><a href="#cb117-497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb117-498"><a href="#cb117-498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb117-499"><a href="#cb117-499" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-500"><a href="#cb117-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-501"><a href="#cb117-501" aria-hidden="true" tabindex="-1"></a>Somit wären wir mit den theoretischen Teil durch. In dem folgenden Kasten sprechen wir nochmal über die Idee der Varianzzerlegung und wie das ganze mit der ANOVA funktioniert. Dann berechnen wir einmal den Effektschätzer der ANOVA. Bis jetzt haben wir ja nur eine Aussage über die Signifikanz, aber noch keinen Effekt berechnet.</span>
<span id="cb117-502"><a href="#cb117-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-503"><a href="#cb117-503" aria-hidden="true" tabindex="-1"></a>Danach verlassen wir dann die einfaktorielle ANOVA und schauen auch schon weiter. Wir betrachten dann die Interaktion in einer zweifaktoriellen ANOVA. Der zweite Faktor in einer zweifaktoriellen ANOVA wird nämlich ähnlich behandelt wie der erste Faktor. Da tut sich dann konzeptionell nicht mehr so viel. Und den statistischen Engel nehme ich dann mit für die Aussage.</span>
<span id="cb117-504"><a href="#cb117-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-505"><a href="#cb117-505" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb117-506"><a href="#cb117-506" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exkurs: Die Idee der Varianzzerlegung</span></span>
<span id="cb117-507"><a href="#cb117-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-508"><a href="#cb117-508" aria-hidden="true" tabindex="-1"></a>Häufig spricht man bei der ANOVA auch von einer Varianzzerlegung. Das ist richtig, verwirrt aber, wenn du damit gedanklich anfängst. Die ANOVA vergleicht primär Mittelwerte und die Nullhypothese ist auch entsprechend gebaut. Was die ANOVA dennoch tut, ist die gloable Streuung oder Varianz als $SS_{Total}$ auf die unterschiedlichen Quellen zu verteilen. Wenn der Faktor $A$ keinen Einfluss hätte dann würde alle Streuung nur durch den Fehler $MS_{Error}$ dargestellt und nichts von der Streuung durch die Verschiebung der lokalen Mittelwerte $MS_A$. In der folgenden Abbildung siehst du den Zusammenhang einmal dargestellt. In der linken Abbdilung vergessen wir einmal, dass wir einen Faktor A haben. Unsere Beobachtungen streuen um den globalen Mittelwert. Wie du dann aber rechts siehst, kommt ein Teil der Streuung durch die lokalen Mittelwerte des Faktors A. Wir können also die Streuung durch die unterschiedlichen Gruppenmittelwerte teilweise erklären. Diese Verschiebungen nennen wir dann auch $\beta_{A.1}$, $\beta_{A.2}$ und $\beta_{A.3}$. Wäre nur der Faktor A ursächlich für die Streuung, dann würden alle Beobachtungen auf den entsprechenden lokalen Mittelwerten liegen. Die Fehlerterme $\epsilon$ wären dann alle Null. Somit kannst du dann am Ende jeden Messwert y einer Beobachtung aus den Informationen des gloabeln Mittelwerts, dem Gruppenmittel und dem entspechenden Restfehler der Beobachtung zurückrechnen.</span>
<span id="cb117-509"><a href="#cb117-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-512"><a href="#cb117-512" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-513"><a href="#cb117-513" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-514"><a href="#cb117-514" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-515"><a href="#cb117-515" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-516"><a href="#cb117-516" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-single-cat-anova </span></span>
<span id="cb117-517"><a href="#cb117-517" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-518"><a href="#cb117-518" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb117-519"><a href="#cb117-519" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb117-520"><a href="#cb117-520" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung der Varianzzerlegung anhand eines Faktors A mit unterschiedlichen Gruppenmittelwerten. Die Verschiebung der einzelnen Gruppenmittelwerte wird mit $\\beta_{A.1}$, $\\beta_{A.2}$ und $\\beta_{A.3}$ bezeichnet. Die restliche Streuung dann als Fehler $\\epsilon$ der einzelnen Beobachtung zu dem zugehörigen Gruppenmittel. Somit kann jeder Messwert y einer Beobachtung aus den Informationen des gloabeln Mittelwerts, dem Gruppenmittel und dem entspechenden Restfehler der Beobachtung zurückrechnen werden *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb117-521"><a href="#cb117-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-522"><a href="#cb117-522" aria-hidden="true" tabindex="-1"></a>p_example_fac_1_total <span class="sc">+</span> p_example_fac1 <span class="sc">+</span></span>
<span id="cb117-523"><a href="#cb117-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb117-524"><a href="#cb117-524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">width =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb117-525"><a href="#cb117-525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>) <span class="sc">+</span></span>
<span id="cb117-526"><a href="#cb117-526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb117-527"><a href="#cb117-527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb117-528"><a href="#cb117-528" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-529"><a href="#cb117-529" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb117-530"><a href="#cb117-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-531"><a href="#cb117-531" aria-hidden="true" tabindex="-1"></a><span class="fu">### Effektschätzer</span></span>
<span id="cb117-532"><a href="#cb117-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-533"><a href="#cb117-533" aria-hidden="true" tabindex="-1"></a>Nachdem wir uns mit der Theorie der ANOVA beschäftigt haben und verstehen, wie der Haupteffekt des Faktors A bestimmt wird, müssen wir uns noch Fragen, wie stark ist denn der Effekt nun? Wir rechnen zwar die Abqweichungsquadrate der einzlenen lokalen Mittelwerte zum globalen Mittel mit $SS_A$ aus, aber was sagt uns nun der Wert? Hierzu müssen wir nochmal einen Schritt zurücktreten und über die Abweichungsquadrate im Allgmeinen sprechen. Die gesamten Abweichungquadrate jeder Beobachtung zum globalen Mittelwert $SS_{Total}$ setzen sich aus den Abweichungsquadraten vom Faktor $SS_{Faktor}$, der Interaktion $SS_{Interaktion}$ sowie dem Fehler $SS_{Error}$ zusammen. Wir haben dann folgenden Zusammenhang.</span>
<span id="cb117-534"><a href="#cb117-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-535"><a href="#cb117-535" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-536"><a href="#cb117-536" aria-hidden="true" tabindex="-1"></a>SS_{Total} = SS_{Faktor} + SS_{Interaktion} + SS_{Error} </span>
<span id="cb117-537"><a href="#cb117-537" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-538"><a href="#cb117-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-539"><a href="#cb117-539" aria-hidden="true" tabindex="-1"></a>mit</span>
<span id="cb117-540"><a href="#cb117-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-541"><a href="#cb117-541" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$SS_{Total}$ den gesamten Abweichungsquadraten jeder Beobachtung zum gloablen Mittel</span>
<span id="cb117-542"><a href="#cb117-542" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$SS_{Faktor}$ den Abweichungsquadraten der Faktoren im Modell</span>
<span id="cb117-543"><a href="#cb117-543" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$SS_{Interaktion}$ den Abweichungsquadraten möglicher Interaktionen der Faktoren</span>
<span id="cb117-544"><a href="#cb117-544" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$SS_{Error}$ dem nicht erkläreten Rest der Abweichungsquadrate</span>
<span id="cb117-545"><a href="#cb117-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-546"><a href="#cb117-546" aria-hidden="true" tabindex="-1"></a>Aus diesem Zusammenhang können wir dann verschiedene Effektschätzer berechnen, je nachdem wie wir dann die einzelnen Abweichungsquadrate ins Verhältnis setzen. Die Hilfeseite des R Pakets <span class="in">`{effectsize}`</span> unter <span class="co">[</span><span class="ot">Effect Sizes for ANOVAs</span><span class="co">](https://easystats.github.io/effectsize/articles/anovaES.html)</span> stellt eine Reihe von Effektschätzern für die ANOVA vor. Wir konzentrieren uns hier einmal auf die häufigsten angewendeten Effektschätzer. Es gibt immer mehr, aber da musst du dann nochmal selber in die Hilfeseite schauen. Dazu dann auch mehr in der Arbeit von @olejnik2003generalized mit dem Titel <span class="co">[</span><span class="ot">Generalized eta and omega squared statistics: measures of effect size for some common research designs</span><span class="co">](https://coshima.davidrjfikis.com/EPRS8540/uploadf07/olejnik_PsychMeth2003.pdf)</span>.</span>
<span id="cb117-547"><a href="#cb117-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-548"><a href="#cb117-548" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Eta$^2$ {.unnumbered .unlisted}</span></span>
<span id="cb117-549"><a href="#cb117-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-550"><a href="#cb117-550" aria-hidden="true" tabindex="-1"></a>Der häufigste angewendete Effektschätzer ist <span class="co">[</span><span class="ot">Eta squared</span><span class="co">](https://easystats.github.io/effectsize/articles/anovaES.html#eta2)</span> oder auch $\eta^2$ geschrieben. Wir können $\eta^2$ relativ einfach aus den Abweichungsquadraten des Faktors $SS_A$ geteilt durch die gesamten Abweichungsquadrate $SS_{Total}$ berechnen. Das $\eta^2$ funktioniert besonders gut in der Anwenbdung einer einfaktoriellen ANOVA. Wir haben dann folgenden Zusammenhang.</span>
<span id="cb117-551"><a href="#cb117-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-552"><a href="#cb117-552" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-553"><a href="#cb117-553" aria-hidden="true" tabindex="-1"></a>\eta^2 = \cfrac{SS_A}{SS_{Total}}</span>
<span id="cb117-554"><a href="#cb117-554" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-555"><a href="#cb117-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-556"><a href="#cb117-556" aria-hidden="true" tabindex="-1"></a>mit</span>
<span id="cb117-557"><a href="#cb117-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-558"><a href="#cb117-558" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$SS_A$ den Abweichungsquadraten der lokalen Mittel des Faktor A zum globalen Mittel</span>
<span id="cb117-559"><a href="#cb117-559" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$SS_{Total}$ den gesamten Abweichungsquadraten jeder Beobachtung zum gloablen Mittel</span>
<span id="cb117-560"><a href="#cb117-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-561"><a href="#cb117-561" aria-hidden="true" tabindex="-1"></a>Wir rechnen hier also im Prinzip einmal einen Anteil aus. Da es sich bei den Abweichungsquadraten faktisch um eine Varianz handelt, können wir sagen, dass wir mit $\eta^2$ den Anteil der Varianz berechnen, der durch den Faktor A erklärt wird. Ich habe den Zusammenhang nochmal in der folgenden @fig-ggplot-anova-eta-venn dargestellt. Auf der linken Seite finden wir ein $\eta^2$ von $0.2$ und damit machen die $SS_A$ nur einen geringen Anteil der $SS_{Total}$ aus. Wir sagen, dass 20% der Varianz in den Daten durch den Faktor A erklärt wird. Der meiste Anteil der Abweichungsquadrate macht der Fehler $SS_{Error}$ aus. In der rechten Abbildung sehen wir dann ein $\eta^2$ von $0.8$ und damit ist der Anteil von $SS_A$ an $SS_{Total}$ groß. Wir sagen, dass 80% der Varianz in den Daten durch den Faktor A erklärt wird.</span>
<span id="cb117-562"><a href="#cb117-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-565"><a href="#cb117-565" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-566"><a href="#cb117-566" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-567"><a href="#cb117-567" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-568"><a href="#cb117-568" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-569"><a href="#cb117-569" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-anova-eta-venn</span></span>
<span id="cb117-570"><a href="#cb117-570" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-571"><a href="#cb117-571" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4.5</span></span>
<span id="cb117-572"><a href="#cb117-572" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb117-573"><a href="#cb117-573" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung von $\\eta^2$ für eine einfaktorielle ANOVA mit dem Faktor A. Gezeigt wird der Anteil der Abweichungsquadrate $SS_A$ an den gesamten Abweichungsquadraten $SS_{Total}$. **(A)** Geringer Effekt mit einem $\\eta^2$ von $0.2$. Der Faktor A erklärt nur einen kleinen Teil der Varianz. **(B)**  Starker Effekt mit einem $\\eta^2$ von $0.8$. Der Fakotor A erklärt fast die gesamte Varianz. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb117-574"><a href="#cb117-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-575"><a href="#cb117-575" aria-hidden="true" tabindex="-1"></a>p1_eta_venn <span class="sc">+</span> p2_eta_venn <span class="sc">+</span></span>
<span id="cb117-576"><a href="#cb117-576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb117-577"><a href="#cb117-577" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb117-578"><a href="#cb117-578" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb117-579"><a href="#cb117-579" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-580"><a href="#cb117-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-581"><a href="#cb117-581" aria-hidden="true" tabindex="-1"></a>Das R Paket <span class="in">`{effectsize}`</span> hat auch die Funktion <span class="in">`interpret_eta_squared()`</span> implementiert, die ich persönlich nicht so sinnvoll halte, da wir das $\eta^2$ relativ gut biologisch und statistisch erklären können. Das $\eta^2$ sagt dann eben aus, ob wir große oder kleine Messwerte durch unsere Behandlung durch den Faktor A vorliegen haben.</span>
<span id="cb117-582"><a href="#cb117-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-583"><a href="#cb117-583" aria-hidden="true" tabindex="-1"></a>|                |                                               |</span>
<span id="cb117-584"><a href="#cb117-584" aria-hidden="true" tabindex="-1"></a>|----------------|-----------------------------------------------|</span>
<span id="cb117-585"><a href="#cb117-585" aria-hidden="true" tabindex="-1"></a>| $\eta^2 = 0.1$ | Faktor A erklärt 10% Varianz vom Messwert $y$ |</span>
<span id="cb117-586"><a href="#cb117-586" aria-hidden="true" tabindex="-1"></a>| $\eta^2 = 0.5$ | Faktor A erklärt 50% Varianz vom Messwert $y$ |</span>
<span id="cb117-587"><a href="#cb117-587" aria-hidden="true" tabindex="-1"></a>| $\eta^2 = 0.8$ | Faktor A erklärt 80% Varianz vom Messwert $y$ |</span>
<span id="cb117-588"><a href="#cb117-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-589"><a href="#cb117-589" aria-hidden="true" tabindex="-1"></a>: Interpretation einiger $\eta^2$ Werte für den Faktor A mit einer Behandlung. {#tbl-anova-eta2-inter}</span>
<span id="cb117-590"><a href="#cb117-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-591"><a href="#cb117-591" aria-hidden="true" tabindex="-1"></a>Wenn du ein geplantes Experiment durchführst bei dem du durch Randomisierung und andere Maßnahmen fast alle Einflussgrößen kontrollierst, dann sollest du als Varianzquelle nur onch deinen Behandlungsfaktor A übrigbehalten. So ist dann die Daumenregel, dass wir in einem geplanten Feldexperiment ein $\eta^2$ von mindestens $0.7$ erwarten sollten. Die Streuung deines Messwerts $y$ sollte dann eignentlich nur von deiner Behandlung abhängen.</span>
<span id="cb117-592"><a href="#cb117-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-593"><a href="#cb117-593" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Omega$^2$ und Epsilon$^2$ {.unnumbered .unlisted}</span></span>
<span id="cb117-594"><a href="#cb117-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-595"><a href="#cb117-595" aria-hidden="true" tabindex="-1"></a>Neben dem $\eta^2$ gibt es auch noch zwei weitere Effektschätzer mit dem <span class="co">[</span><span class="ot">Omega Squared</span><span class="co">](https://www.statisticshowto.com/omega-squared/)</span> als $\omega^2$ geschrieben sowie dem <span class="co">[</span><span class="ot">Epsilon Squared</span><span class="co">](https://www.statisticshowto.com/epsilon-squared/)</span> als $\epsilon^2$ dargestellt. Du findest dazu auf der Hilfeseite des R Pakets <span class="in">`{effectsize}`</span> unter <span class="co">[</span><span class="ot">Other Measures of Effect Size</span><span class="co">](https://easystats.github.io/effectsize/articles/anovaES.html#other-measures-of-effect-size)</span> noch weitere Informationen. Oder wie das R Paket <span class="in">`{effectsize}`</span> wie folgt schreibt.</span>
<span id="cb117-596"><a href="#cb117-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-597"><a href="#cb117-597" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Though Omega is the more popular choice (Albers and Lakens, 2018), Epsilon is analogous to adjusted R2 (Allen, 2017, p. 382), and has been found to be less biased (Carroll &amp; Nordholm, 1975)." --- [Other Measures of Effect Size](https://easystats.github.io/effectsize/articles/anovaES.html#other-measures-of-effect-size)*</span></span>
<span id="cb117-598"><a href="#cb117-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-599"><a href="#cb117-599" aria-hidden="true" tabindex="-1"></a>Beide Effektschätzer haben ihre Verwendung eher in der zweifaktoriellen ANOVA, wenn wir dann auch einen Interaktionsterm vorliegen haben. Die Interpretation ist dann nicht mehr so einfach wie bei dem $\eta^2$. Im Allgemeinen kannst du das $\epsilon^2$ wie das Bestimmtheitsmaß $R^2$ in der linearen Regression interpretieren. Ein $\epsilon^2$ gleich 0 ist als kein Effekt und ein $\epsilon^2$ gleich 1 als ein starker Effekt anzusehen. Hier verliert sich das Ganze aber ins ungefähre und ich würde empfehlen dann die Mittelwertsdifferenzen in einem Post-hoc Test zu berechnen. Diese Differenzen der Mittelwerte sind dann direkt interpretierbar und damit vorzuziehen.</span>
<span id="cb117-600"><a href="#cb117-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-601"><a href="#cb117-601" aria-hidden="true" tabindex="-1"></a>Für beide Effektschätzer gibt es dann die Funktionen <span class="in">`interpret_omega_squared()`</span> und <span class="in">`interpret_epsilon_squared()`</span> aus dem R Paket <span class="in">`{effectsize}`</span>, die dir dann bei der Interpretation des Effekts helfen. Hier ist dann nicht mehr eine so einfache biologische Interpretation wie bei dem $\eta^2$ möglich. Insbesondere bei noch komplexeren mehrfaktoriellen Modellen wird die Interpretation schwerer. Ich zeige dir dann die Anwendung einmal in den unteren Beispielen in R. Da einfach mal reingucken.</span>
<span id="cb117-602"><a href="#cb117-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-603"><a href="#cb117-603" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interaktion $f_A \times f_B$</span></span>
<span id="cb117-604"><a href="#cb117-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-605"><a href="#cb117-605" aria-hidden="true" tabindex="-1"></a>Wenn du mehr als einen Faktor $f_A$ in deinem Modell vorliegen hast, dann kannst du eine Interaktion zwischen den Faktoren vorliegen haben. In diesem Abschnitt schauen wir uns eine Interaktion zwischen einem Faktor $f_A$ und einem Faktor $f_B$ einmal theoretisch näher an. Wir schreiben in R einen Interaktionsterm mit dem Doppelpunkt <span class="in">`:`</span> zwischen den Variablennamen der beiden Faktoren. Wenn wir also die Interaktion zwischen dem Faktor $f_1$ und $f_2$ in R modellieren wollen, dann schreiben wir <span class="in">`fa:fb`</span>. In der mathematischen Schreibweise haben wir dann häufig die Form $f_A \times f_B$ vorliegen. Ich schreibe hier häufig dann die mathematische Notation im Fließtext und natürlich im R Code dann die entsprechende Notation in R.</span>
<span id="cb117-606"><a href="#cb117-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-607"><a href="#cb117-607" aria-hidden="true" tabindex="-1"></a>|                                         |   Mathematisch   |    R    |</span>
<span id="cb117-608"><a href="#cb117-608" aria-hidden="true" tabindex="-1"></a>|-----------------------------------------|:----------------:|:-------:|</span>
<span id="cb117-609"><a href="#cb117-609" aria-hidden="true" tabindex="-1"></a>| Interaktion zwischen Faktor $A$ und $B$ | $f_A \times f_B$ | <span class="in">`fa:fb`</span> |</span>
<span id="cb117-610"><a href="#cb117-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-611"><a href="#cb117-611" aria-hidden="true" tabindex="-1"></a>: Vergleich der Schreibweise einer Interaktion zwischen den Faktoren $f_A$ und $f_B$ einmal mathematisch und einmal in R. {#tbl-anova-inter-namen}</span>
<span id="cb117-612"><a href="#cb117-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-613"><a href="#cb117-613" aria-hidden="true" tabindex="-1"></a>Der folgende Abschnitt teilt sich grob in zwei Teile. Einmal der theoretische Hintergrund zur Interaktion und was dort eigentlich die Herausforderungen in der Modellierung sind sowie einen Abschnitt zur visuellen Überprüfung der Interaktion in einer zweifaktoriellen Analyse.</span>
<span id="cb117-614"><a href="#cb117-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-615"><a href="#cb117-615" aria-hidden="true" tabindex="-1"></a>Beginnen wir mit der eigentlichen Problemstellung in einer zweifaktoriellen ANOVA. Wenn wir zwei Faktoren haben, dann müssen wir ja die Abweichungsquadrate den jeweiligen Faktoren zuordnen. Wenn wir keien Interaktion vorliegen haben, dann haben wir den linken Fall in der unteren @fig-ggplot-anova-inter-circ vorliegen. Der Faktor A hat seine Abweichungsquadrate mit $SS_A$ und der Faktor B auch einen Anteil der Abweichungsquadrate mit $SS_B$ vorliegen. Der Rest von den gesamten Abweichungsquadraten $SS_{Total}$ geht dann in den Fehler mit $SS_{Error}$. Wenn wir aber eine Interaktion, wie in der rechten Abbildung vorliegen haben, dann können wir einen Teil der Abweichungsquadrate $SS_{A \times B}$ unterschiedlich zuordnen. Den die Interaktionsabweichungsquadrate $SS_{A \times B}$ könnten wir vollständig $SS_A$ oder $SS_B$ zurechnen oder aber irgendwie aufteilen. Daher gibt es jetzt verschiedene Typen von einer ANOVA, die sich eben darum drehen, wie wir die Interaktionsabweichungsquadrate $SS_{A \times B}$ verteilen.</span>
<span id="cb117-616"><a href="#cb117-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-619"><a href="#cb117-619" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-620"><a href="#cb117-620" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-621"><a href="#cb117-621" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-622"><a href="#cb117-622" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-623"><a href="#cb117-623" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-anova-inter-circ</span></span>
<span id="cb117-624"><a href="#cb117-624" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-625"><a href="#cb117-625" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4.5</span></span>
<span id="cb117-626"><a href="#cb117-626" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb117-627"><a href="#cb117-627" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung der Interaktion für eine zweifaktorielle ANOVA mit dem Faktor A und B. Gezeigt wird der Anteil der Abweichungsquadrate $SS_A$ und $SS_B$an den gesamten Abweichungsquadraten $SS_{Total}$. **(A)** Keine Interaktion. Alle Abweichungsquadrate können eindeutig einer Quelle zugeordnet werden. **(B)** Starke Interaktion. Ein Teil der Abweichungsquadrate $SS_{A \\times B}$ kann nicht eindeutig einem Faktor zugeordnet werden. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb117-628"><a href="#cb117-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-629"><a href="#cb117-629" aria-hidden="true" tabindex="-1"></a>p2_inter_venn <span class="sc">+</span> p1_inter_venn <span class="sc">+</span></span>
<span id="cb117-630"><a href="#cb117-630" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb117-631"><a href="#cb117-631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>) <span class="sc">+</span></span>
<span id="cb117-632"><a href="#cb117-632" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb117-633"><a href="#cb117-633" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))  </span>
<span id="cb117-634"><a href="#cb117-634" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-635"><a href="#cb117-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-636"><a href="#cb117-636" aria-hidden="true" tabindex="-1"></a>Das zentrale Problem bleibt also, wie will ich die Abweichungsquadrate berechnen? Will ich die gesamten Interaktionsabweichungsquadrate $SS_{A \times B}$ auf den Faktor A geben? Oder wie will ich die Verteilung darstellen. Hier gibt es jetzt bei der ANOVA drei verschiedene Typen. In dem Tutorium <span class="co">[</span><span class="ot">Anova – Type I/II/III SS explained</span><span class="co">](https://md.psych.bio.uni-goettingen.de/mv/unit/lm_cat/lm_cat_unbal_ss_explained.html)</span> findest du noch mehr Informationen und etwas Geschichte dazu. Ich fasse hier einmal die drei Typen zusammen und evrsuche mich mal an einer Empfehlung.</span>
<span id="cb117-637"><a href="#cb117-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-638"><a href="#cb117-638" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb117-639"><a href="#cb117-639" aria-hidden="true" tabindex="-1"></a><span class="fu">## Type I</span></span>
<span id="cb117-640"><a href="#cb117-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-641"><a href="#cb117-641" aria-hidden="true" tabindex="-1"></a>Die Type I ANOVA berechnet die Abweichungsquadrate in der sequenziellen Ordnung der Faktoren in dem Modell. Es werden also erst die Abweichungsquadrate für den Faktor A berechnet, dann für den Faktor B was noch von Faktor A an Abweichungsquadraten übrig ist. Am Ende wird dann die Interaktion betrachtet, wo wir dann den Anteil der Abweichungsquadrate finden, die nicht zu dem Faktor A oder Faktor B eindeutig zugeordnet werden konnten. Es macht also einen Unterschied wie du dein Modell baust. Insbesondere wenn du unterschiedliche Anzahlen an Beobachtungen in den Gruppen vorliegen hast.</span>
<span id="cb117-642"><a href="#cb117-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-643"><a href="#cb117-643" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-644"><a href="#cb117-644" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb117-645"><a href="#cb117-645" aria-hidden="true" tabindex="-1"></a>&amp;SS(A) \; \mbox{für den Faktor A} <span class="sc">\\</span></span>
<span id="cb117-646"><a href="#cb117-646" aria-hidden="true" tabindex="-1"></a>&amp;SS(B \mid A) \; \mbox{für den Faktor B gegeben Faktor A}<span class="sc">\\</span></span>
<span id="cb117-647"><a href="#cb117-647" aria-hidden="true" tabindex="-1"></a>&amp;SS(A \times B \mid B, A) \; \mbox{für die Interaktion gegeben Faktor B und A}</span>
<span id="cb117-648"><a href="#cb117-648" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb117-649"><a href="#cb117-649" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-650"><a href="#cb117-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-651"><a href="#cb117-651" aria-hidden="true" tabindex="-1"></a>Die Funktionen <span class="in">`aov()`</span> und <span class="in">`anova()`</span> in R rechnen immer eine Type I ANOVA. Es gibt hier nichts umzustellen, du musst hier auf die Ordnung der Faktoren in deinem Modell achten. Der wichtigere Faktor nach deiner wissenschaftlichen Fragestellung muss immer als erstes ins Modell.</span>
<span id="cb117-652"><a href="#cb117-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-653"><a href="#cb117-653" aria-hidden="true" tabindex="-1"></a><span class="fu">## Type II</span></span>
<span id="cb117-654"><a href="#cb117-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-655"><a href="#cb117-655" aria-hidden="true" tabindex="-1"></a>Die Type II ANOVA berechnet die Abweichungsquadrate eines Faktors unter der Berücksichtigung des anderen Faktors. Die Type II ANOVA ist damit der Type I ANOVA überlegen, was das finden eines signifkanten Unterschieds ausmacht. Darüber hinaus ist es auch egal welche Reihenfolge wir für unser Modell nehmen. Wenn deine beiden Faktoren im Modell also gleichwertig sind, dann ist die Type II ANOVA auf jeden Fall besser geeignet. Wichtig ist nur, dass die Type II ANOVA nur sinnvoll ist, wenn keine Interaktion zwischen den Faktoren vorliegt.</span>
<span id="cb117-656"><a href="#cb117-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-657"><a href="#cb117-657" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-658"><a href="#cb117-658" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb117-659"><a href="#cb117-659" aria-hidden="true" tabindex="-1"></a>&amp;SS(A \mid B) \; \mbox{für den Faktor A gegeben Faktor B} <span class="sc">\\</span></span>
<span id="cb117-660"><a href="#cb117-660" aria-hidden="true" tabindex="-1"></a>&amp;SS(B \mid A) \; \mbox{für den Faktor B gegeben Faktor A}<span class="sc">\\</span></span>
<span id="cb117-661"><a href="#cb117-661" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb117-662"><a href="#cb117-662" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-663"><a href="#cb117-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-664"><a href="#cb117-664" aria-hidden="true" tabindex="-1"></a>Die Type II ANOVA kannst du im R Paket <span class="in">`{car}`</span> mit der Funktion <span class="in">`Anova(..., type = "II")`</span> anwenden. Hier empfiehlt es sich erst eine Type I Anova in <span class="in">`aov()`</span> zu rechnen um zu schauen, ob eine signifikante Interaktion vorliegt. Wenn keine signifikante Interaktion zwischen den Faktoren in der Type I ANOVA vorliegt, dann ist die Type II ANOVA die bessere Wahl.</span>
<span id="cb117-665"><a href="#cb117-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-666"><a href="#cb117-666" aria-hidden="true" tabindex="-1"></a><span class="fu">## Type III</span></span>
<span id="cb117-667"><a href="#cb117-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-668"><a href="#cb117-668" aria-hidden="true" tabindex="-1"></a>Die Type III ANOVA verwenden wir, wenn wir eine Interaktion in unseren Daten vorliegen haben. Die Type III ANOVA berücksichtigt die jeweilige Interaktion und die Abweichungsquadrate des anderen Faktors B bei der Berechnung der Abweichungsquadrate des Faktors A. Insbesondere bei der Anwesenheit von einer signifkanten Interaktion liefert die Type III ANOVA passende Ergebnisse. Leider lassen sich dadurch die Haupteffekte der Faktoren A und B nicht ohne die Interaktion interpretieren. Da ist dann wieder die Frage im Raum, was will ich eigentlich in der ANOVA nachweisen und wie passt die ANOVA zu meiner wissenschaftlichen Fragestellung?</span>
<span id="cb117-669"><a href="#cb117-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-670"><a href="#cb117-670" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-671"><a href="#cb117-671" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb117-672"><a href="#cb117-672" aria-hidden="true" tabindex="-1"></a>&amp;SS(A \mid B,\, A \times B) \; \mbox{für den Faktor A gegeben Interaktion und Faktor B} <span class="sc">\\</span></span>
<span id="cb117-673"><a href="#cb117-673" aria-hidden="true" tabindex="-1"></a>&amp;SS(B \mid A,\, A \times B) \; \mbox{für den Faktor B gegeben Interaktion und Faktor A}<span class="sc">\\</span></span>
<span id="cb117-674"><a href="#cb117-674" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb117-675"><a href="#cb117-675" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-676"><a href="#cb117-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-677"><a href="#cb117-677" aria-hidden="true" tabindex="-1"></a>Wir können die TYPE III Anova in dem R Paket <span class="in">`{car}`</span> mit der Funktion <span class="in">`Anova(..., type = "III")`</span> rechnen. Hier musst du aber aufpassen, wie du das Modell baust, welches du in die Funktion <span class="in">`Anova()`</span> steckst. Dazu dann mehr gleich weiter unten zur Treamtent und Effect Kodierung. Als bessere Alternative bietet sich dann die Funktion <span class="in">`aov_car()`</span> aus dem R Paket <span class="in">`{afex}`</span> an. Heir wird das Modell passend zur Type III Anova kodiert.</span>
<span id="cb117-678"><a href="#cb117-678" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb117-679"><a href="#cb117-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-680"><a href="#cb117-680" aria-hidden="true" tabindex="-1"></a>Jetzt haben wir da einiges an Zeug gelesen und fragen uns nun, was soll ich denn verwenden? Ich versuche jetzt mich aml an zwei etwas gewagten Empfehlungen für die Modellierung der ANOVA.</span>
<span id="cb117-681"><a href="#cb117-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-682"><a href="#cb117-682" aria-hidden="true" tabindex="-1"></a>Keine Interaktion zwischen den Faktoren A und B</span>
<span id="cb117-683"><a href="#cb117-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-684"><a href="#cb117-684" aria-hidden="true" tabindex="-1"></a>:   Wir verwenden die Type II ANOVA aus dem R Paket <span class="in">`{car}`</span> mit der Funktion <span class="in">`Anova(..., type = "II")`</span>. Hier haben wir die besten Chancen einen Unterschied zu finden und wir müssen nicht entscheiden, welcher Faktor uns wichtiger ist. Die Reihenfolge spielt keine Rolle im Modell.</span>
<span id="cb117-685"><a href="#cb117-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-686"><a href="#cb117-686" aria-hidden="true" tabindex="-1"></a>Interaktion zwischen den Faktoren A und B</span>
<span id="cb117-687"><a href="#cb117-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-688"><a href="#cb117-688" aria-hidden="true" tabindex="-1"></a>:   Wir verwenden die Type III Anova aus dem R Paket <span class="in">`{afex}`</span> mit der Funktion <span class="in">`aov_car()`</span>. Dann wird die Interaktion in den Haupteffekten der Faktoren A und B berücksichtigt. Wie wir dann weitermachen ist dann noch eine andere Sache, aber <span class="in">`{emmeans}`</span> kann auch mit Interaktionen umgehen.</span>
<span id="cb117-689"><a href="#cb117-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-690"><a href="#cb117-690" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>" layout-valign="top"}</span>
<span id="cb117-691"><a href="#cb117-691" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/angel_01_small.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb117-692"><a href="#cb117-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-693"><a href="#cb117-693" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *Welcher ANOVA Typ nun konkret in deiner Modellierung der richtige Typ ist kann ich dir leider Allgemein nicht sagen. Fühl dich aber nicht verunsichert. Auch eine `aov()` liefert gut Ergebnisse im Zusammenspiel mit `{emmeans}` im Post-hoc Test. Das Aua hält der statistische Engel aus.*</span></span>
<span id="cb117-694"><a href="#cb117-694" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb117-695"><a href="#cb117-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-696"><a href="#cb117-696" aria-hidden="true" tabindex="-1"></a>Jetzt haben wir uns mit den Typen der ANOVA beschäftigt. Wie erkenne ich denn nun das wir eine vermutliche Interaktion in den Daten vorliegen haben? Hierfür kann ich dann die visuelle Überprüfung empfehlen. Eine explorative Datenanalyse ist immer der erste Schritt und auch eine vermeidliche Interaktion lässts ich gut erkennen. Dann kannst du auch schauen, ob deine ANOVA Modellierung zu den visualisierten Daten passt.</span>
<span id="cb117-697"><a href="#cb117-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-698"><a href="#cb117-698" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visuelle Überprüfung {.unnumbered .unlisted}</span></span>
<span id="cb117-699"><a href="#cb117-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-700"><a href="#cb117-700" aria-hidden="true" tabindex="-1"></a>Die visuelle Überprüfung der Interaktion zwischen zwei Faktoren A und B ist eigentlich die beste Möglichkeit einmal zu schauen, ob wir überhaupt eine Wechselwirkung zwischen den Leveln des Faktors A und den Leveln des Faktors B vorliegen haben. Wenn es mehr Faktoren sind, dann wird die Sache sehr viel unübersichtlicher. Aber wir schauen uns meistens nur die Interaktion zwischen zwei Faktoren an. Für diesen Fall ist die visuelle Überprüfung auf jeden Fall geeignet. Wir haben die Wahl zwischen einem Liniendiagramm, den Boxplots oder aber den meist schon vorhandenen Barplots.</span>
<span id="cb117-701"><a href="#cb117-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-702"><a href="#cb117-702" aria-hidden="true" tabindex="-1"></a>Wir betrachten hier alle drei Möglichkeiten der visuellen Überprüfung, wobei ich die Liniendiagramme mit den Mittelwerten der Faktorlevel auf jeden Fall bevorzuge. Die Boxplots gehen auch, sind aber schon etwas schwerer zu interpretieren. Von den Barplots würde ich abraten, man sieht dort wirklich schlecht eine Interaktion. In allen folgenden Abbildungen sind die Daten mehr oder minder gleich. Du musst selber entscheiden, wo du dann am besten was erkennst. Du findest den R Code für das Liniendiagramm weiter unten bei der Auswertung der zwei- und mehrfaktoriellen ANOVA.</span>
<span id="cb117-703"><a href="#cb117-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-704"><a href="#cb117-704" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb117-705"><a href="#cb117-705" aria-hidden="true" tabindex="-1"></a><span class="fu">## Liniendiagramm</span></span>
<span id="cb117-706"><a href="#cb117-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-709"><a href="#cb117-709" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-710"><a href="#cb117-710" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-711"><a href="#cb117-711" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-712"><a href="#cb117-712" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-713"><a href="#cb117-713" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-anova-inter-theo-line</span></span>
<span id="cb117-714"><a href="#cb117-714" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-715"><a href="#cb117-715" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4.5</span></span>
<span id="cb117-716"><a href="#cb117-716" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb117-717"><a href="#cb117-717" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung der Interaktion zwischen dem Faktor A mit drei Leveln und dem Faktor B mit zwei Leveln. Dargestellt sind die mit Linien verbundenen Mittelwerte aller Faktorkombinationen. Es empfiehlt sich den Faktor mit den meisten Leveln auf die x-Achse zu legen. **(A)** Keine Interaktion. Die Linien der Mittelwerte der Level des Faktors B laufen parallel über die drei Level des Faktors A. **(B)** Schwache Interaktion. Die Linien der Mittelwerte des Faktors B laufen aufeinander zu. **(C)** Starke Interaktion. Die Linien der Mittelwerte des Faktors B kreuzen sich.  *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb117-718"><a href="#cb117-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-719"><a href="#cb117-719" aria-hidden="true" tabindex="-1"></a>p1_inter_line_theo <span class="sc">+</span> p2_inter_line_theo <span class="sc">+</span> p3_inter_line_theo <span class="sc">+</span></span>
<span id="cb117-720"><a href="#cb117-720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb117-721"><a href="#cb117-721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>) <span class="sc">+</span></span>
<span id="cb117-722"><a href="#cb117-722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb117-723"><a href="#cb117-723" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb117-724"><a href="#cb117-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-725"><a href="#cb117-725" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-726"><a href="#cb117-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-727"><a href="#cb117-727" aria-hidden="true" tabindex="-1"></a><span class="fu">## Boxplot</span></span>
<span id="cb117-728"><a href="#cb117-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-731"><a href="#cb117-731" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-732"><a href="#cb117-732" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-733"><a href="#cb117-733" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-734"><a href="#cb117-734" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-735"><a href="#cb117-735" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-anova-inter-theo-box</span></span>
<span id="cb117-736"><a href="#cb117-736" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-737"><a href="#cb117-737" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4.5</span></span>
<span id="cb117-738"><a href="#cb117-738" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb117-739"><a href="#cb117-739" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung der Interaktion zwischen dem Faktor A mit drei Leveln und dem Faktor B mit zwei Leveln. Dargestellt sind die Boxplots aller Faktorkombinationen. Es empfiehlt sich den Faktor mit den meisten Leveln auf die x-Achse zu legen. **(A)** Keine Interaktion. Die Boxen folgen dem gleichem Muster mit B.2 ist immer über B.1 mit etwa gleichem Abstand. **(B)** Schwache Interaktion. Die Boxen sind unregelmäßig mit B.2 nur teilweise über B.1 und die Abstände sind unregelmäßig. **(C)** Starke Interaktion. Die Boxen sind unregelmäßig und folgen keinem wiederholenden Muster. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb117-740"><a href="#cb117-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-741"><a href="#cb117-741" aria-hidden="true" tabindex="-1"></a>p1_inter_box_theo <span class="sc">+</span> p2_inter_box_theo <span class="sc">+</span> p3_inter_box_theo <span class="sc">+</span></span>
<span id="cb117-742"><a href="#cb117-742" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb117-743"><a href="#cb117-743" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>) <span class="sc">+</span></span>
<span id="cb117-744"><a href="#cb117-744" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb117-745"><a href="#cb117-745" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb117-746"><a href="#cb117-746" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-747"><a href="#cb117-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-748"><a href="#cb117-748" aria-hidden="true" tabindex="-1"></a><span class="fu">## Barplot</span></span>
<span id="cb117-749"><a href="#cb117-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-752"><a href="#cb117-752" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-753"><a href="#cb117-753" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-754"><a href="#cb117-754" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-755"><a href="#cb117-755" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-756"><a href="#cb117-756" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-anova-inter-theo-bar</span></span>
<span id="cb117-757"><a href="#cb117-757" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-758"><a href="#cb117-758" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4.5</span></span>
<span id="cb117-759"><a href="#cb117-759" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb117-760"><a href="#cb117-760" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung der Interaktion zwischen dem Faktor A mit drei Leveln und dem Faktor B mit zwei Leveln. Dargestellt sind die Barplots der Mittelwerte aller Faktorkombinationen. Es empfiehlt sich den Faktor mit den meisten Leveln auf die x-Achse zu legen. **(A)** Keine Interaktion. Die Säulen folgen dem gleichem Muster mit B.2 ist immer über B.1 mit etwa gleichem Abstand. **(B)** Schwache Interaktion. Die Säulen sind unregelmäßig mit B.2 nur teilweise über B.1 und die Abstände sind unregelmäßig. **(C)** Starke Interaktion. Die Säulen sind unregelmäßig und folgen keinem wiederholenden Muster.  *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb117-761"><a href="#cb117-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-762"><a href="#cb117-762" aria-hidden="true" tabindex="-1"></a>p1_inter_bar_theo <span class="sc">+</span> p2_inter_bar_theo <span class="sc">+</span> p3_inter_bar_theo <span class="sc">+</span></span>
<span id="cb117-763"><a href="#cb117-763" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb117-764"><a href="#cb117-764" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>) <span class="sc">+</span></span>
<span id="cb117-765"><a href="#cb117-765" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb117-766"><a href="#cb117-766" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb117-767"><a href="#cb117-767" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-768"><a href="#cb117-768" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb117-769"><a href="#cb117-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-770"><a href="#cb117-770" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Interaktion in R {.unnumbered .unlisted}</span></span>
<span id="cb117-771"><a href="#cb117-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-772"><a href="#cb117-772" aria-hidden="true" tabindex="-1"></a>Wenn wir uns Interaktionen in einer mehrfaktoriellen ANOVA anschauen wollen dann gibt es einige Möglichkeiten. Ich zeige jetzt nicht alle R Pakete in den folgenden Beispielen. Deshalb hier nochmal eine kleine Liste, wo du nochmal schauen kannst, wenn du mehr Informationen zu der Bereücksichtigung von Interaktionen in R benötigst.</span>
<span id="cb117-773"><a href="#cb117-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-774"><a href="#cb117-774" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Das <span class="co">[</span><span class="ot">R Paket `{effectsize}`</span><span class="co">](https://easystats.github.io/effectsize/articles/anovaES.html#adding-interactions)</span> gibt nochmal ein Übersichtskapitel zu Interakionen in verschiedenen Modellen. Darüber hinaus diskutiert die Hilfeseite auch nochmal die verschiedenen Typen und Möglichkeiten eine ANOVA zu rechnen.</span>
<span id="cb117-775"><a href="#cb117-775" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Das <span class="co">[</span><span class="ot">R Paket `{interactions}`</span><span class="co">](https://interactions.jacob-long.com/)</span> enhält eine Reihe von Funktione, die eine Analyse der Interaktion in einem mehrfaktoriellen Modell erleichtern. Hier wird nicht nur auf auf Faktoren sondern auch auf kontinuierliche Werte als Einflussvariablen eingegangen. Ein sehr rundes Paket für die Analyse von Interaktionen.</span>
<span id="cb117-776"><a href="#cb117-776" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Das <span class="co">[</span><span class="ot">R Paket `{emmeans}`</span><span class="co">](https://cran.r-project.org/web/packages/emmeans/vignettes/interactions.html)</span> kann hier nicht fehlen, da wir ja meistens bis immer nach einer ANOVA einen Post-hoc Test rechnen wollen. Hier empfehle ich ja immer <span class="in">`{emmeans}`</span>. Daher hat natürlich auch <span class="in">`{emmeans}`</span> eine entsprechende Hilfeseite für die Berücksichtigung von Interaktionen in einem Modell.</span>
<span id="cb117-777"><a href="#cb117-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-778"><a href="#cb117-778" aria-hidden="true" tabindex="-1"></a>Damit wären wir dann auch schon durch. Den Rest an R Paketen zeige ich dann einmal weiter unten bei den Beispieln. So hat das R Paket <span class="in">`{afex}`</span> auch noch Möglichkeiten sich Interaktionen anzeigen zu lassen, aber das zeige ich dann teilweise in der Anwendung des Paketes weiter unten. Damit wären wir fast schon mit der Theorie durch. Als nächstes schauen wir uns dann die passenden Datensätze für die verschiedenen ANOVAs einmal an.</span>
<span id="cb117-779"><a href="#cb117-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-780"><a href="#cb117-780" aria-hidden="true" tabindex="-1"></a>::::: callout-note</span>
<span id="cb117-781"><a href="#cb117-781" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exkurs: Treatment coding vs. effect coding</span></span>
<span id="cb117-782"><a href="#cb117-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-783"><a href="#cb117-783" aria-hidden="true" tabindex="-1"></a>Worum geht es in diesem Exkurs? Zum einen geht es darum zu verstehen, wie die verschiedenen Modelle -- je nachdem wie die Modelle gebaut werden -- die Mittelwerte schätzen. Es gibt da nämlich verschiedene Arten dies zu tun. Eine dieser Arten nennt sich *treatment coding* und eine andere *effect coding*. Die erstere Codierung nutzen wir als Standard in der Modellierung in R. Das *effect coding* ist aber für die Berechnung und Interpretation einer Interaktion bei Faktoren viel besser geeignet. Also bevor wir jetzt lange rumreden, zeige ich dir den Unterschied an einem Beispiel. Wir haben folgende Datentabelle vorliegen.</span>
<span id="cb117-784"><a href="#cb117-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-787"><a href="#cb117-787" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-788"><a href="#cb117-788" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-789"><a href="#cb117-789" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-790"><a href="#cb117-790" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-791"><a href="#cb117-791" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-1fac-contr-sum</span></span>
<span id="cb117-792"><a href="#cb117-792" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Datentabelle von einem Faktor A mit drei Gruppen $A.1$, $A.2$ und $A.3$ je drei Beobachtungen."</span></span>
<span id="cb117-793"><a href="#cb117-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-794"><a href="#cb117-794" aria-hidden="true" tabindex="-1"></a>f1_contr_sum_tbl <span class="sc">|&gt;</span> </span>
<span id="cb117-795"><a href="#cb117-795" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pos =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb117-796"><a href="#cb117-796" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> fa, <span class="at">values_from =</span> rsp) <span class="sc">|&gt;</span> </span>
<span id="cb117-797"><a href="#cb117-797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>pos) <span class="sc">|&gt;</span> </span>
<span id="cb117-798"><a href="#cb117-798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tt</span>(<span class="at">width =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">align =</span> <span class="st">"c"</span>, <span class="at">theme =</span> <span class="st">"striped"</span>)</span>
<span id="cb117-799"><a href="#cb117-799" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-800"><a href="#cb117-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-801"><a href="#cb117-801" aria-hidden="true" tabindex="-1"></a>Dabei habe ich die Daten so gebaut, dass wir folgende Mittelwerte für die einzelnen Gruppen wiederfinden. Damit können wir jetzt ein Modell anpassen und schauen, wie das Modell unsere Mittelwerte abbildet.</span>
<span id="cb117-802"><a href="#cb117-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-805"><a href="#cb117-805" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-806"><a href="#cb117-806" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-807"><a href="#cb117-807" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-808"><a href="#cb117-808" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-809"><a href="#cb117-809" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-1fac-contr-sum-desc</span></span>
<span id="cb117-810"><a href="#cb117-810" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Mittelwerte der drei Gruppen $A.1$, $A.2$ und $A.3$ des Faktors A."</span></span>
<span id="cb117-811"><a href="#cb117-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-812"><a href="#cb117-812" aria-hidden="true" tabindex="-1"></a>f1_contr_sum_tbl  <span class="sc">|&gt;</span> </span>
<span id="cb117-813"><a href="#cb117-813" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fa) <span class="sc">|&gt;</span> </span>
<span id="cb117-814"><a href="#cb117-814" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Mittelwert =</span> <span class="fu">mean</span>(rsp)) <span class="sc">|&gt;</span> </span>
<span id="cb117-815"><a href="#cb117-815" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb117-816"><a href="#cb117-816" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">"Faktor A"</span>, <span class="st">"Mittelwert"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb117-817"><a href="#cb117-817" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tt</span>(<span class="at">width =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">align =</span> <span class="st">"c"</span>, <span class="at">theme =</span> <span class="st">"striped"</span>)</span>
<span id="cb117-818"><a href="#cb117-818" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-819"><a href="#cb117-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-820"><a href="#cb117-820" aria-hidden="true" tabindex="-1"></a>Wir haben jetzt hier zwei Möglichkeiten uns die Koeffizienten des Modells wiedergeben zu lassen. Wichtig ist, dass beide Kodierungen gleichwertig sind, was am Ende die Effekte angeht. Nur die Interpretation der numerischen Werte der Ausgabe der Modelle ist eben eine Andere. Es gibt noch mehr <span class="co">[</span><span class="ot">Contrast codings</span><span class="co">](https://stats.oarc.ucla.edu/r/library/r-library-contrast-coding-systems-for-categorical-variables/)</span>, je nachdem wie dein Messwert $y$ oder deine Faktoren $f$ beschaffen sind. Aber das geht hier entschieden zu weit.</span>
<span id="cb117-821"><a href="#cb117-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-822"><a href="#cb117-822" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb117-823"><a href="#cb117-823" aria-hidden="true" tabindex="-1"></a><span class="fu">## Treatment coding</span></span>
<span id="cb117-824"><a href="#cb117-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-825"><a href="#cb117-825" aria-hidden="true" tabindex="-1"></a>Im Falle des *treatment codings* ist der <span class="in">`(Intercept)`</span> der Mittelwert der Gruppe $A.1$ und die Koeffizienten von $A.2$ und $A.3$ mit <span class="in">`faA.2`</span> und <span class="in">`faA.3`</span> zeigen die Differenz zum Mittelwert der Gruppe $A.1$. Klingt wirr, ist aber mathematisch eine Lösung des Problems. Wir rechnen eben in einer Regression eine Steigung aus und die Differenzen sind eben Steigungen.</span>
<span id="cb117-826"><a href="#cb117-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-829"><a href="#cb117-829" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-830"><a href="#cb117-830" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(rsp <span class="sc">~</span> fa, f1_contr_sum_tbl, <span class="at">contrasts =</span> <span class="fu">list</span>(<span class="at">fa =</span> <span class="st">"contr.treatment"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb117-831"><a href="#cb117-831" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb117-832"><a href="#cb117-832" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-833"><a href="#cb117-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-834"><a href="#cb117-834" aria-hidden="true" tabindex="-1"></a><span class="fu">## Effect coding</span></span>
<span id="cb117-835"><a href="#cb117-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-836"><a href="#cb117-836" aria-hidden="true" tabindex="-1"></a>Im Falle des *effect codings* ist der <span class="in">`(Intercept)`</span> der gloable Mittelwert $\beta_0$ aller Beobachtungen. Damit sind dann die Koeffizienten <span class="in">`fa1`</span> die Differenz des lokalen Mittelwerts von $A.1$ zu dem globalen Mittelwert. Ebenso ist dies der Fall für den Koeffizienten <span class="in">`fa2`</span>, der die Differenz des lokalen Mittelwerts von $A.2$ zum globalen Mittel beschreibt. Wo ist jetzt der Koeffizient für $A.3$? Der fehlt, lässt sich aber leicht berechnen, da die Summe der lokalen Mittelwerte Null sein muss. Damit wäre $\bar{y}_{A.3}$ gleich 4.</span>
<span id="cb117-837"><a href="#cb117-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-840"><a href="#cb117-840" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-841"><a href="#cb117-841" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(rsp <span class="sc">~</span> fa, f1_contr_sum_tbl, <span class="at">contrasts =</span> <span class="fu">list</span>(<span class="at">fa =</span> <span class="st">"contr.sum"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb117-842"><a href="#cb117-842" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb117-843"><a href="#cb117-843" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-844"><a href="#cb117-844" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb117-845"><a href="#cb117-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-846"><a href="#cb117-846" aria-hidden="true" tabindex="-1"></a>Wir können uns die Sachlage auch einmal in der folgenden Abbildung einmal visualisieren. Auf der linken Seite siehst du das *treatment coding* mit den jeweiligen lokalen Mittelwerten und als rote Linie den y-Achsenabschnitt der jeweiligen Kodierung. Hier sieht man dann auch sehr schon auf der rechten Seite, dass das *effect coding* die Theorie der ANOVA viel besser abbildet.</span>
<span id="cb117-847"><a href="#cb117-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-850"><a href="#cb117-850" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-851"><a href="#cb117-851" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-852"><a href="#cb117-852" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-853"><a href="#cb117-853" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-854"><a href="#cb117-854" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-anova-f1-effect-coding</span></span>
<span id="cb117-855"><a href="#cb117-855" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-856"><a href="#cb117-856" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4.5</span></span>
<span id="cb117-857"><a href="#cb117-857" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb117-858"><a href="#cb117-858" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung der Mittelwerte des Datensatzes. **(A)** *Treatment Coding* mit dem `(Intercept)` auf dem Mittelwert der Gruppe $A.1$. Die Koeffizienten des Modells beschreiben die Differenz der anderen Gruppen zum Mittel der Gruppe $A.1$. **(B)** *Effect coding* mit dem `(Intercept)` auf dem globalen Mittelwert $\\beta_0$. Die Koeffizienten des Modells beschreiben die Abweichungen der Gruppenmittel zum globalen Mittel. Der Koeffizient für $A.3$ ist nicht im Modell enthalten, dargestellt als graue Fläche *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb117-859"><a href="#cb117-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-860"><a href="#cb117-860" aria-hidden="true" tabindex="-1"></a>p2_f1_contr_sum <span class="sc">+</span> p1_f1_contr_sum <span class="sc">+</span></span>
<span id="cb117-861"><a href="#cb117-861" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb117-862"><a href="#cb117-862" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb117-863"><a href="#cb117-863" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb117-864"><a href="#cb117-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-865"><a href="#cb117-865" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-866"><a href="#cb117-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-867"><a href="#cb117-867" aria-hidden="true" tabindex="-1"></a>Jetzt wo wir den Unterschied zwischen dem *treatment coding* und dem *effect coding* verstanden haben, können wir uns einmal den Interaktionsterm in einer zweifaktoriellen ANOVA mit *effect coding* anschauen. Wie wir gleich sehen werden ist die Interpretation etwas einfacher, wenn wir uns eine Interaktion im Sinne des *effect codings* bauen. Wir setzen dann eben alle Koeffizienten in den Bezug zum globalen Mittel. Das macht die Interpretation dann in einer zweifaktoriellen ANOVA einfacher.</span>
<span id="cb117-868"><a href="#cb117-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-869"><a href="#cb117-869" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb117-870"><a href="#cb117-870" aria-hidden="true" tabindex="-1"></a><span class="fu">## Effect coding ohne Interaktion</span></span>
<span id="cb117-871"><a href="#cb117-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-872"><a href="#cb117-872" aria-hidden="true" tabindex="-1"></a>Beginnen wir einmal mit dem *effect coding* ohne Interaktion. In diesem Fall haben wir einen einfacheren zweifaktoriellen Datensatz in folgender Tabelle mit dem Faktor A und drei Leveln sowie den Faktor B mit zwei Leveln vorliegen. Es sieht jetzt etwas größer aus, aber ich habe die Daten so gebaut, dass faktisch keine Streuung in den Daten ist.</span>
<span id="cb117-873"><a href="#cb117-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-876"><a href="#cb117-876" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-877"><a href="#cb117-877" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-878"><a href="#cb117-878" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-879"><a href="#cb117-879" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-880"><a href="#cb117-880" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-2fac-contr-sum-nointer</span></span>
<span id="cb117-881"><a href="#cb117-881" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Datentabelle ohne Interaktion zwischen einem Faktor A mit drei Gruppen $A.1$, $A.2$ und $A.3$ je drei Beobachtungen sowie einem Faktor B mit zwei Gruppen $B.1$ und $B.2$. Insgesamt liegen sechs Faktorkombinationen vor."</span></span>
<span id="cb117-882"><a href="#cb117-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-883"><a href="#cb117-883" aria-hidden="true" tabindex="-1"></a>f2_contr_sum_nointer_tbl <span class="sc">|&gt;</span> </span>
<span id="cb117-884"><a href="#cb117-884" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pos =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">6</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb117-885"><a href="#cb117-885" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>key) <span class="sc">|&gt;</span> </span>
<span id="cb117-886"><a href="#cb117-886" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> fb, <span class="at">values_from =</span> rsp) <span class="sc">|&gt;</span> </span>
<span id="cb117-887"><a href="#cb117-887" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>pos) <span class="sc">|&gt;</span> </span>
<span id="cb117-888"><a href="#cb117-888" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">""</span>, <span class="st">"B.1"</span>, <span class="st">"B.2"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb117-889"><a href="#cb117-889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tt</span>(<span class="at">width =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">align =</span> <span class="st">"c"</span>, <span class="at">theme =</span> <span class="st">"striped"</span>)</span>
<span id="cb117-890"><a href="#cb117-890" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-891"><a href="#cb117-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-892"><a href="#cb117-892" aria-hidden="true" tabindex="-1"></a>Jetzt können wir uns die Mittelwerte für jede der sechs Faktorkombinationen berechnen. Ich habe das einmal in der folgenden Tabelle gemacht. Ich finde es immer sehr schwer, hier was zu sehen, aber mit einer Visualisierung wird es gleich einfacher. Wenn keine Interaktion vorliegt, dann müssen die Level des Faktors B über die Level des Faktors A parallel wie in der folgenden @fig-ggplot-anova-f2-effect-coding-no-inter laufen.</span>
<span id="cb117-893"><a href="#cb117-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-896"><a href="#cb117-896" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-897"><a href="#cb117-897" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-898"><a href="#cb117-898" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-899"><a href="#cb117-899" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-900"><a href="#cb117-900" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-2fac-contr-sum-nointer-desc</span></span>
<span id="cb117-901"><a href="#cb117-901" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Mittelwerte der sechs Faktorkombination von Faktor A und Faktor B. Es liegt keine Interaktion in den Daten vor. Der Faktor B verhält sich über alle Level des Faktors A gleich."</span></span>
<span id="cb117-902"><a href="#cb117-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-903"><a href="#cb117-903" aria-hidden="true" tabindex="-1"></a>f2_contr_sum_nointer_tbl <span class="sc">|&gt;</span> </span>
<span id="cb117-904"><a href="#cb117-904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fa, fb) <span class="sc">|&gt;</span> </span>
<span id="cb117-905"><a href="#cb117-905" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Mittelwert =</span> <span class="fu">mean</span>(rsp)) <span class="sc">|&gt;</span> </span>
<span id="cb117-906"><a href="#cb117-906" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb117-907"><a href="#cb117-907" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">"Faktor A"</span>, <span class="st">"Faktor B"</span>, <span class="st">"Mittelwert"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb117-908"><a href="#cb117-908" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tt</span>(<span class="at">width =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">align =</span> <span class="st">"c"</span>, <span class="at">theme =</span> <span class="st">"striped"</span>)</span>
<span id="cb117-909"><a href="#cb117-909" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-910"><a href="#cb117-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-911"><a href="#cb117-911" aria-hidden="true" tabindex="-1"></a>Jetzt wollen wir einmal eine lineare Regression mit dem vollen Modell der beiden Faktoren und dem Interaktionsterm rechnen um die Koeffizienten als Effekte zu erhalten. Wenn wir ein *effect coding* in R nutzen wollen, dann müssen wir das der Funktion `lm()` mit der Option `contrast = ...` mitteilen. In R heißt dann *efffect coding* eben <span class="in">`contr.sum`</span> und damit leben wir dann. Wir ziehen uns die Koeffizienten und runden noch kurz.</span>
<span id="cb117-912"><a href="#cb117-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-915"><a href="#cb117-915" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-916"><a href="#cb117-916" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(rsp <span class="sc">~</span> fa <span class="sc">+</span> fb <span class="sc">+</span> fa<span class="sc">:</span>fb, f2_contr_sum_nointer_tbl, </span>
<span id="cb117-917"><a href="#cb117-917" aria-hidden="true" tabindex="-1"></a>   <span class="at">contrasts =</span> <span class="fu">list</span>(<span class="at">fa =</span> <span class="st">"contr.sum"</span>, <span class="at">fb =</span> <span class="st">"contr.sum"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb117-918"><a href="#cb117-918" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb117-919"><a href="#cb117-919" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-920"><a href="#cb117-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-921"><a href="#cb117-921" aria-hidden="true" tabindex="-1"></a>In unseren Daten ist keine Interaktion. Deshalb ist der Effekt der Interaktion mit $-3.33$ und $1.64$ für die beiden Interaktionsterme sehr klein. Den Hauptteil der Effekte machen die beiden Faktoren A und B aus. In der folgenden Tabelle siehst du einmal für den y-Wert $80$ wie sich die Effekte durch die Faktoren aufaddieren.</span>
<span id="cb117-922"><a href="#cb117-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-923"><a href="#cb117-923" aria-hidden="true" tabindex="-1"></a>| $y$  |     | $\beta_0$ | $\beta_{A.1}$ | $\beta_{B.1}$ | $\beta_{A.1 \times B.1}$ |</span>
<span id="cb117-924"><a href="#cb117-924" aria-hidden="true" tabindex="-1"></a>|------|-----|-----------|---------------|---------------|--------------------------|</span>
<span id="cb117-925"><a href="#cb117-925" aria-hidden="true" tabindex="-1"></a>| $80$ | $=$ | $120$     | $-60$         | $+23.3$       | $-3.3$                   |</span>
<span id="cb117-926"><a href="#cb117-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-927"><a href="#cb117-927" aria-hidden="true" tabindex="-1"></a>: Beispielhafte Berechnung des Messwertes $y$ für die Faktorkombination von $A.1$ und $B.1$ aus den Koeffizienten des *effect codings*. {#tbl-anova-01}</span>
<span id="cb117-928"><a href="#cb117-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-929"><a href="#cb117-929" aria-hidden="true" tabindex="-1"></a>Du kannst die obige Berechnung auch in der folgenden Abbildung mit den Effekten einmal nachvollziehen. Wir wollen ja den y-Wert $80$ vom y-Achsenabschnitt $120$ kommend erreichen. Der Wert $80$ kommt durch die Faktorkombination A.1 und B.1 zustande. Deshalb ziehen wir $-60$ vom y-Achsenabschnitt für den Effekt von A.1 ab und addieren $+23.33$ für den Effekt von B.1. Der Rest, der mit $-3.33$ dann noch übrig ist, geht auf das Konto der Interaktion von A.1 und B.1.</span>
<span id="cb117-930"><a href="#cb117-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-933"><a href="#cb117-933" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-934"><a href="#cb117-934" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-935"><a href="#cb117-935" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-936"><a href="#cb117-936" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-937"><a href="#cb117-937" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-anova-f2-effect-coding-no-inter</span></span>
<span id="cb117-938"><a href="#cb117-938" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-939"><a href="#cb117-939" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb117-940"><a href="#cb117-940" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb117-941"><a href="#cb117-941" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung des *effect coding* mit keiner Interaktion zwischen den Faktoren A und B. Die berechneten Effekte als Differenzen in Mittelwerten beziehen sich jeweils auf den globalen Mittelwert. Die Effekte für A.3 werden nicht vom Modell wiedergegeben sondern müssen aus dem Modell berechnet werden *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb117-942"><a href="#cb117-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-943"><a href="#cb117-943" aria-hidden="true" tabindex="-1"></a>p_f2_contr_sum_nointer</span>
<span id="cb117-944"><a href="#cb117-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-945"><a href="#cb117-945" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-946"><a href="#cb117-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-947"><a href="#cb117-947" aria-hidden="true" tabindex="-1"></a>Jetzt fehlen natürlich noch die Effekte für das Level A.3 aus dem Faktor A sowie die Effekte des Levels B.2 aus dem Faktor B. Auch müssen wir noch die letzte Interaktion von A.3 mit B.1 berechnen. Wichtig ist, dass alle Effekte als Mittelwertsdifferenzen zum globalen Mittel aufsummiert Null ergeben müssen. Das mache ich jetzt einmal für die fehlenden Effekte händisch.</span>
<span id="cb117-948"><a href="#cb117-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-949"><a href="#cb117-949" aria-hidden="true" tabindex="-1"></a>|   | $\beta_{A.1}$ oder <span class="in">`fa1`</span> | $\beta_{A.2}$ oder <span class="in">`fa2`</span> | $\beta_{A.3}$ oder <span class="in">`fa3`</span> |</span>
<span id="cb117-950"><a href="#cb117-950" aria-hidden="true" tabindex="-1"></a>|----|----|----|----|</span>
<span id="cb117-951"><a href="#cb117-951" aria-hidden="true" tabindex="-1"></a>| $\sum = 0$ | $-60$ | $+5$ | $+55$ |</span>
<span id="cb117-952"><a href="#cb117-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-953"><a href="#cb117-953" aria-hidden="true" tabindex="-1"></a>: Effekte von dem Faktor A. Den Effekt des Levels A.3 berechnen wir händisch. {#tbl-anova-02}</span>
<span id="cb117-954"><a href="#cb117-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-955"><a href="#cb117-955" aria-hidden="true" tabindex="-1"></a>|            | $\beta_{B.1}$ oder <span class="in">`fb1`</span> | $\beta_{B.2}$ oder <span class="in">`fb2`</span> |</span>
<span id="cb117-956"><a href="#cb117-956" aria-hidden="true" tabindex="-1"></a>|------------|--------------------------|--------------------------|</span>
<span id="cb117-957"><a href="#cb117-957" aria-hidden="true" tabindex="-1"></a>| $\sum = 0$ | $+23.33$                 | $-23.33$                 |</span>
<span id="cb117-958"><a href="#cb117-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-959"><a href="#cb117-959" aria-hidden="true" tabindex="-1"></a>: Effekte von dem Faktor B. Den Effekt des Levels B.2 berechnen wir händisch. {#tbl-anova-02}</span>
<span id="cb117-960"><a href="#cb117-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-961"><a href="#cb117-961" aria-hidden="true" tabindex="-1"></a>|   | $\beta_{A.1 \times B.1}$ oder <span class="in">`fa1:fb1`</span> | $\beta_{A.2 \times B.1}$ oder <span class="in">`fa2:fb1`</span> | $\beta_{A.3 \times B.1}$ oder <span class="in">`fa3:fb1`</span> |</span>
<span id="cb117-962"><a href="#cb117-962" aria-hidden="true" tabindex="-1"></a>|----|----|----|----|</span>
<span id="cb117-963"><a href="#cb117-963" aria-hidden="true" tabindex="-1"></a>| $\sum = 0$ | $-3.33$ | $+1.67$ | $+1.67$ |</span>
<span id="cb117-964"><a href="#cb117-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-965"><a href="#cb117-965" aria-hidden="true" tabindex="-1"></a>: Effekte der Interaktion zwischen dem Faktor A und dem Faktor B. Den Effekt der Interaktion von A.3 und B.1 berechnen wir händisch. {#tbl-anova-03}</span>
<span id="cb117-966"><a href="#cb117-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-967"><a href="#cb117-967" aria-hidden="true" tabindex="-1"></a><span class="fu">## Effect coding mit Interaktion</span></span>
<span id="cb117-968"><a href="#cb117-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-969"><a href="#cb117-969" aria-hidden="true" tabindex="-1"></a>Nachdem du einmal das *effect cosing* ohne Interaktion zwischen den Faktoren A und B verstanden hast, schauen wir usn das gleiche Setting nochmal mit Interaktion an. Wir haben wieder den Faktor A mit drei Leveln und den Faktor B mit zwei Leveln vorliegen. Jetzt haben wir aber in der folgenden Datentabelle eine Interaktion zwischen den beiden Faktoren vorliegen. Die Messwerte für die Faktorkombination A.1 und B.1 sind nicht in der Richtung und Werten gleich wie in der Faktorkombination A.3 und B.1. Das ist hier schwer in den Zahlen zu sehen, aber faktisch drehen sich die Werte einmal. In dem Level A.1 ist B.1 großer als B.2 aber in dem Level A.3 ist es genau umgekehrt. Eine klassische Interaktion finden wir hier.</span>
<span id="cb117-970"><a href="#cb117-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-973"><a href="#cb117-973" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-974"><a href="#cb117-974" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-975"><a href="#cb117-975" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-976"><a href="#cb117-976" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-977"><a href="#cb117-977" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-2fac-contr-sum-inter</span></span>
<span id="cb117-978"><a href="#cb117-978" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Datentabelle mit Interaktion zwischen einem Faktor A mit drei Gruppen $A.1$, $A.2$ und $A.3$ je drei Beobachtungen sowie einem Faktor B mit zwei Gruppen $B.1$ und $B.2$. Insgesamt liegen sechs Faktorkombinationen vor. Die Interaktion in den Daten von $B.1$ ist orange hervorgehoben."</span></span>
<span id="cb117-979"><a href="#cb117-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-980"><a href="#cb117-980" aria-hidden="true" tabindex="-1"></a>f2_contr_sum_inter_tbl <span class="sc">|&gt;</span> </span>
<span id="cb117-981"><a href="#cb117-981" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pos =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">6</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb117-982"><a href="#cb117-982" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>key) <span class="sc">|&gt;</span> </span>
<span id="cb117-983"><a href="#cb117-983" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> fb, <span class="at">values_from =</span> rsp) <span class="sc">|&gt;</span> </span>
<span id="cb117-984"><a href="#cb117-984" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>pos) <span class="sc">|&gt;</span> </span>
<span id="cb117-985"><a href="#cb117-985" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">""</span>, <span class="st">"B.1"</span>, <span class="st">"B.2"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb117-986"><a href="#cb117-986" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tt</span>(<span class="at">width =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">align =</span> <span class="st">"c"</span>, <span class="at">theme =</span> <span class="st">"striped"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb117-987"><a href="#cb117-987" aria-hidden="true" tabindex="-1"></a>  <span class="fu">style_tt</span>(<span class="at">i =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>), <span class="at">j =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"#D55E00"</span>,</span>
<span id="cb117-988"><a href="#cb117-988" aria-hidden="true" tabindex="-1"></a>           <span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb117-989"><a href="#cb117-989" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-990"><a href="#cb117-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-991"><a href="#cb117-991" aria-hidden="true" tabindex="-1"></a>Dann nochmal für alle sechs Faktorkombinationen den Mittlwert berechnet. Ich habe dir auch hier einmal die Interaktion farblich hervorgehoben. Du siehst den Zusammenhang aber sehr viel besser in der folgenden @fig-ggplot-anova-f2-effect-coding-inter. Die Linien der Mittelwerte kreuzen sich, es liegt eine Interaktion zwischen den Faktoren vor.</span>
<span id="cb117-992"><a href="#cb117-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-995"><a href="#cb117-995" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-996"><a href="#cb117-996" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-997"><a href="#cb117-997" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-998"><a href="#cb117-998" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-999"><a href="#cb117-999" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-2fac-contr-sum-inter-desc</span></span>
<span id="cb117-1000"><a href="#cb117-1000" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Mittelwerte der sechs Faktorkombination von Faktor A und Faktor B. Die Interaktion in den Mittelwerten von $B.1$ ist orange hervorgehoben."</span></span>
<span id="cb117-1001"><a href="#cb117-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1002"><a href="#cb117-1002" aria-hidden="true" tabindex="-1"></a>f2_contr_sum_inter_tbl <span class="sc">|&gt;</span> </span>
<span id="cb117-1003"><a href="#cb117-1003" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fa, fb) <span class="sc">|&gt;</span> </span>
<span id="cb117-1004"><a href="#cb117-1004" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Mittelwert =</span> <span class="fu">mean</span>(rsp)) <span class="sc">|&gt;</span> </span>
<span id="cb117-1005"><a href="#cb117-1005" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb117-1006"><a href="#cb117-1006" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">"Faktor A"</span>, <span class="st">"Faktor B"</span>, <span class="st">"Mittelwert"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb117-1007"><a href="#cb117-1007" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tt</span>(<span class="at">width =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">align =</span> <span class="st">"c"</span>, <span class="at">theme =</span> <span class="st">"striped"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb117-1008"><a href="#cb117-1008" aria-hidden="true" tabindex="-1"></a>  <span class="fu">style_tt</span>(<span class="at">i =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>), <span class="at">j =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"#D55E00"</span>,</span>
<span id="cb117-1009"><a href="#cb117-1009" aria-hidden="true" tabindex="-1"></a>           <span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb117-1010"><a href="#cb117-1010" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1011"><a href="#cb117-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1012"><a href="#cb117-1012" aria-hidden="true" tabindex="-1"></a>Auch hier wollen wir einmal eine lineare Regression mit dem vollen Modell der beiden Faktoren und dem Interaktionsterm rechnen um die Koeffizienten als Effekte zu erhalten. Wenn wir ein *effect coding* in R nutzen wollen, dann müssen wir das der Funktion `lm()` mit der Option `contrast = ...` mitteilen. In R heißt dann *efffect coding* eben <span class="in">`contr.sum`</span> und damit leben wir dann. Wir ziehen uns die Koeffizienten und runden noch kurz. Hier sehen wir dann die Effekte in der Interaktion auch numerisch klar. Die Koeffizienten der Interaktion sind sehr viel größer als die Haupteffekte der Faktoren.</span>
<span id="cb117-1013"><a href="#cb117-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1016"><a href="#cb117-1016" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1017"><a href="#cb117-1017" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(rsp <span class="sc">~</span> fa <span class="sc">+</span> fb <span class="sc">+</span> fa<span class="sc">:</span>fb, f2_contr_sum_inter_tbl, </span>
<span id="cb117-1018"><a href="#cb117-1018" aria-hidden="true" tabindex="-1"></a>   <span class="at">contrasts =</span> <span class="fu">list</span>(<span class="at">fa =</span> <span class="st">"contr.sum"</span>, <span class="at">fb =</span> <span class="st">"contr.sum"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb117-1019"><a href="#cb117-1019" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb117-1020"><a href="#cb117-1020" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1021"><a href="#cb117-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1022"><a href="#cb117-1022" aria-hidden="true" tabindex="-1"></a>Auch hier können wir einmal beispielhaft ausrechnen wie wir auf den y-Wert von $120$ kommen würden. Nur ein kleiner Teil des Wertes machen die Haupteffekte der Faktoren aus. Ein Großteil des Wertes wird von der Interaktion erkärt. Um auf den Wert von $210$ zu kommen reichen die Effekte von A.1 und B.1 nicht aus. Ein Großteil des Wertes muss durch eine Interaktion der beiden Level beschrieben werden.</span>
<span id="cb117-1023"><a href="#cb117-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1024"><a href="#cb117-1024" aria-hidden="true" tabindex="-1"></a>| $y$   |     | $\beta_0$ | $\beta_{A1}$ | $\beta_{B1}$ | $\beta_{A1:B1}$ |</span>
<span id="cb117-1025"><a href="#cb117-1025" aria-hidden="true" tabindex="-1"></a>|-------|-----|-----------|--------------|--------------|-----------------|</span>
<span id="cb117-1026"><a href="#cb117-1026" aria-hidden="true" tabindex="-1"></a>| $210$ | $=$ | $120$     | $+5$         | $+23.3$      | $+61.67$        |</span>
<span id="cb117-1027"><a href="#cb117-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1028"><a href="#cb117-1028" aria-hidden="true" tabindex="-1"></a>: Beispielhafte Berechnung des Messwertes $y$ für die Faktorkombination von $A.1$ und $B.1$ aus den Koeffizienten des *effect codings*. {#tbl-anova-namen}</span>
<span id="cb117-1029"><a href="#cb117-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1032"><a href="#cb117-1032" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1033"><a href="#cb117-1033" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-1034"><a href="#cb117-1034" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-1035"><a href="#cb117-1035" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-1036"><a href="#cb117-1036" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-anova-f2-effect-coding-inter</span></span>
<span id="cb117-1037"><a href="#cb117-1037" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-1038"><a href="#cb117-1038" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb117-1039"><a href="#cb117-1039" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb117-1040"><a href="#cb117-1040" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung des *effect coding* mit einer Interaktion zwischen den Faktoren A und B. Die Linien der Mittelwerte kreuzen sich. Die berechneten Effekte als Differenzen in Mittelwerten beziehen sich jeweils auf den globalen Mittelwert. Die Effekte für A.3 werden nicht vom Modell wiedergegeben sondern müssen aus dem Modell berechnet werden *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb117-1041"><a href="#cb117-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1042"><a href="#cb117-1042" aria-hidden="true" tabindex="-1"></a>p_f2_contr_sum_stat_inter</span>
<span id="cb117-1043"><a href="#cb117-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1044"><a href="#cb117-1044" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1045"><a href="#cb117-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1046"><a href="#cb117-1046" aria-hidden="true" tabindex="-1"></a>Jetzt fehlen natürlich noch die Effekte für das Level A.3 aus dem Faktor A sowie die Effekte des Levels B.2 aus dem Faktor B. Auch müssen wir noch die letzte Interaktion von A.3 mit B.1 berechnen. Das ist ja hier mit Interaktion der interessante Teil! Wichtig ist, dass alle Effekte als Mittelwertsdifferenzen zum globalen Mittel aufsummiert Null ergeben müssen. Das mache ich jetzt einmal für die fehlenden Effekte händisch.</span>
<span id="cb117-1047"><a href="#cb117-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1048"><a href="#cb117-1048" aria-hidden="true" tabindex="-1"></a>|   | $\beta_{A.1}$ oder <span class="in">`fa1`</span> | $\beta_{A.2}$ oder <span class="in">`fa2`</span> | $\beta_{A.3}$ oder <span class="in">`fa3`</span> |</span>
<span id="cb117-1049"><a href="#cb117-1049" aria-hidden="true" tabindex="-1"></a>|----|----|----|----|</span>
<span id="cb117-1050"><a href="#cb117-1050" aria-hidden="true" tabindex="-1"></a>| $\sum = 0$ | $+5$ | $+10$ | $-15$ |</span>
<span id="cb117-1051"><a href="#cb117-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1052"><a href="#cb117-1052" aria-hidden="true" tabindex="-1"></a>: Effekte von dem Faktor A. Den Effekt des Levels A.3 berechnen wir händisch. {#tbl-anova-01}</span>
<span id="cb117-1053"><a href="#cb117-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1054"><a href="#cb117-1054" aria-hidden="true" tabindex="-1"></a>|            | $\beta_{B.1}$ oder <span class="in">`fb1`</span> | $\beta_{B.2}$ oder <span class="in">`fb2`</span> |</span>
<span id="cb117-1055"><a href="#cb117-1055" aria-hidden="true" tabindex="-1"></a>|------------|--------------------------|--------------------------|</span>
<span id="cb117-1056"><a href="#cb117-1056" aria-hidden="true" tabindex="-1"></a>| $\sum = 0$ | $+23.33$                 | $-23.33$                 |</span>
<span id="cb117-1057"><a href="#cb117-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1058"><a href="#cb117-1058" aria-hidden="true" tabindex="-1"></a>: Effekte von dem Faktor B. Den Effekt des Levels B.2 berechnen wir händisch. {#tbl-anova-02}</span>
<span id="cb117-1059"><a href="#cb117-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1060"><a href="#cb117-1060" aria-hidden="true" tabindex="-1"></a>|   | $\beta_{A.1 \times B.1}$ oder <span class="in">`fa1:fb1`</span> | $\beta_{A.2 \times B.1}$ oder <span class="in">`fa2:fb1`</span> | $\beta_{A.3 \times B.1}$ oder <span class="in">`fa3:fb1`</span> |</span>
<span id="cb117-1061"><a href="#cb117-1061" aria-hidden="true" tabindex="-1"></a>|----|----|----|----|</span>
<span id="cb117-1062"><a href="#cb117-1062" aria-hidden="true" tabindex="-1"></a>| $\sum = 0$ | $+61.67$ | $6.67$ | $-68.33$ |</span>
<span id="cb117-1063"><a href="#cb117-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1064"><a href="#cb117-1064" aria-hidden="true" tabindex="-1"></a>: Effekte der Interaktion zwischen dem Faktor A und dem Faktor B. Den Effekt der Interaktion von A.3 und B.1 berechnen wir händisch. {#tbl-anova-03}</span>
<span id="cb117-1065"><a href="#cb117-1065" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb117-1066"><a href="#cb117-1066" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb117-1067"><a href="#cb117-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1068"><a href="#cb117-1068" aria-hidden="true" tabindex="-1"></a><span class="fu">## Genutzte R Pakete</span></span>
<span id="cb117-1069"><a href="#cb117-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1070"><a href="#cb117-1070" aria-hidden="true" tabindex="-1"></a>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</span>
<span id="cb117-1071"><a href="#cb117-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1072"><a href="#cb117-1072" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = TRUE}</span></span>
<span id="cb117-1073"><a href="#cb117-1073" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb117-1074"><a href="#cb117-1074" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb117-1075"><a href="#cb117-1075" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, magrittr, broom, WRS2, scales,</span></span>
<span id="cb117-1076"><a href="#cb117-1076" aria-hidden="true" tabindex="-1"></a><span class="in">               readxl, see, car, patchwork, emmeans,</span></span>
<span id="cb117-1077"><a href="#cb117-1077" aria-hidden="true" tabindex="-1"></a><span class="in">               interactions, effectsize, afex, report,</span></span>
<span id="cb117-1078"><a href="#cb117-1078" aria-hidden="true" tabindex="-1"></a><span class="in">               performance, conflicted)</span></span>
<span id="cb117-1079"><a href="#cb117-1079" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::mutate)</span></span>
<span id="cb117-1080"><a href="#cb117-1080" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::summarize)</span></span>
<span id="cb117-1081"><a href="#cb117-1081" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::filter)</span></span>
<span id="cb117-1082"><a href="#cb117-1082" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::arrange)</span></span>
<span id="cb117-1083"><a href="#cb117-1083" aria-hidden="true" tabindex="-1"></a><span class="in">cbbPalette &lt;- c("#000000", "#E69F00", "#56B4E9", "#009E73", </span></span>
<span id="cb117-1084"><a href="#cb117-1084" aria-hidden="true" tabindex="-1"></a><span class="in">                "#F0E442", "#0072B2", "#D55E00", "#CC79A7")</span></span>
<span id="cb117-1085"><a href="#cb117-1085" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1086"><a href="#cb117-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1087"><a href="#cb117-1087" aria-hidden="true" tabindex="-1"></a>An der Seite des Kapitels findest du den Link *Quellcode anzeigen*, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</span>
<span id="cb117-1088"><a href="#cb117-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1089"><a href="#cb117-1089" aria-hidden="true" tabindex="-1"></a><span class="fu">## Daten</span></span>
<span id="cb117-1090"><a href="#cb117-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1091"><a href="#cb117-1091" aria-hidden="true" tabindex="-1"></a>Wir immer bringe ich hier ein paar Datensätze mit damit wir dann verstehen, was eigentlich in den folgenden Analysen in R und den entsprechenden R Paketen passiert. Ich zeige hier an den Daten nur die Anwendung in R und nicht eine händische Berechnung der ANOVA. Deshalb fehlen dann hier auch die Mittelwerte und andere deskritptive Maßzahlen. Schauen wir jetzt also mal in unsere Beispieldaten für die einfaktorielle, zweifaktorielle und mehrfaktorielle ANOVA rein. Wie immer nehme ich hier als normalverteilten Messwert die Sprungweite von Floharten.</span>
<span id="cb117-1092"><a href="#cb117-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1093"><a href="#cb117-1093" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Einfaktorieller Datensatz {.unnumbered .unlisted}</span></span>
<span id="cb117-1094"><a href="#cb117-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1095"><a href="#cb117-1095" aria-hidden="true" tabindex="-1"></a>Beginnen wir mit einem einfaktoriellen Datensatz. Wir haben hier als Messwert die Sprungweite von Flöhen in <span class="sc">\[</span>cm<span class="sc">\]</span> vorliegen. Wissen wollen wir, ob sich die Sprungweite für drei verschiedene Floharten unterscheidet. Damit ist dann in unserem Modell der Faktor <span class="in">`animal`</span> und die Sprungweite <span class="in">`jump_length`</span> als Messwert. Ich lade einmal die Daten in das Objekt <span class="in">`fac1_tbl`</span> und ergänze noch eine ID Spalte für das R Paket <span class="in">`{afex}`</span>. Wir haben jeden Floh nur einmal gemessen, also kriegt jeder Floh eine eigene ID.</span>
<span id="cb117-1096"><a href="#cb117-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1099"><a href="#cb117-1099" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1100"><a href="#cb117-1100" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-1101"><a href="#cb117-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1102"><a href="#cb117-1102" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/flea_dog_cat_fox.xlsx"</span>) <span class="sc">|&gt;</span></span>
<span id="cb117-1103"><a href="#cb117-1103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb117-1104"><a href="#cb117-1104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal))<span class="sc">|&gt;</span> </span>
<span id="cb117-1105"><a href="#cb117-1105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="st">".id"</span>)</span>
<span id="cb117-1106"><a href="#cb117-1106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1107"><a href="#cb117-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1108"><a href="#cb117-1108" aria-hidden="true" tabindex="-1"></a>Dann schauen wir uns die Daten einmal in der folgenden Tabelle als Auszug einmal an. Wichtig ist hier nochmal, dass du eben einen Faktor <span class="in">`animal`</span> mit drei Leveln also Gruppen vorliegen hast. Wir wollen jetzt die drei Tierarten hinsichtlich ihrer Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span> miteinander vergleichen.</span>
<span id="cb117-1109"><a href="#cb117-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1112"><a href="#cb117-1112" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1113"><a href="#cb117-1113" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-1114"><a href="#cb117-1114" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-1115"><a href="#cb117-1115" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-1116"><a href="#cb117-1116" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-1fac-table</span></span>
<span id="cb117-1117"><a href="#cb117-1117" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Tabelle der Sprungweiten in [cm] als Messwert $y$ von Hunde-, Katzen- und Fuchsflöhen. Der Datensatz ist einfaktoriell, da wir nur einen Faktor vorliegen haben."</span></span>
<span id="cb117-1118"><a href="#cb117-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1119"><a href="#cb117-1119" aria-hidden="true" tabindex="-1"></a>fac1_raw_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/flea_dog_cat_fox.xlsx"</span>) <span class="sc">|&gt;</span></span>
<span id="cb117-1120"><a href="#cb117-1120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb117-1121"><a href="#cb117-1121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="st">".id"</span>)</span>
<span id="cb117-1122"><a href="#cb117-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1123"><a href="#cb117-1123" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(fac1_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>),</span>
<span id="cb117-1124"><a href="#cb117-1124" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(fac1_raw_tbl)),</span>
<span id="cb117-1125"><a href="#cb117-1125" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(fac1_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb117-1126"><a href="#cb117-1126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tt</span>(<span class="at">width =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">align =</span> <span class="st">"c"</span>, <span class="at">theme =</span> <span class="st">"striped"</span>)</span>
<span id="cb117-1127"><a href="#cb117-1127" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1128"><a href="#cb117-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1129"><a href="#cb117-1129" aria-hidden="true" tabindex="-1"></a>Und dann wollen wir uns noch einmal die Daten als einen einfachen Boxplot anschauen. Wir sehen, dass die Daten so gebaut sind, dass wir einen signifikanten Unterschied zwischend den Sprungweiten der Floharten erwarten. Die Boxen der Boxplots überlappen sich nicht und die Boxplots liegen auch nicht auf einer Ebene.</span>
<span id="cb117-1130"><a href="#cb117-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1133"><a href="#cb117-1133" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1134"><a href="#cb117-1134" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-1135"><a href="#cb117-1135" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-1136"><a href="#cb117-1136" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-1137"><a href="#cb117-1137" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-anova-boxplot-1fac</span></span>
<span id="cb117-1138"><a href="#cb117-1138" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-1139"><a href="#cb117-1139" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb117-1140"><a href="#cb117-1140" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb117-1141"><a href="#cb117-1141" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Beispielhafter einfaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten."</span></span>
<span id="cb117-1142"><a href="#cb117-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1143"><a href="#cb117-1143" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fac1_tbl, </span>
<span id="cb117-1144"><a href="#cb117-1144" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb117-1145"><a href="#cb117-1145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb117-1146"><a href="#cb117-1146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb117-1147"><a href="#cb117-1147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, </span>
<span id="cb117-1148"><a href="#cb117-1148" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fill =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb117-1149"><a href="#cb117-1149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flohart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>) <span class="sc">+</span></span>
<span id="cb117-1150"><a href="#cb117-1150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb117-1151"><a href="#cb117-1151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span>
<span id="cb117-1152"><a href="#cb117-1152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1153"><a href="#cb117-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1154"><a href="#cb117-1154" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zweifaktorieller Datensatz {.unnumbered .unlisted}</span></span>
<span id="cb117-1155"><a href="#cb117-1155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1156"><a href="#cb117-1156" aria-hidden="true" tabindex="-1"></a>Neben dem einfaktoriellen Datensatz wollen wir uns noch den häufigeren Fall mit zwei Faktoren anschauen. Wir haben also nicht nur die drei Floharten vorliegen und wollen wissen ob diese unterschiedlich weit springen. Darüber hinaus haben wir noch einen zweiten Faktor gewählt. Wir haben die Sprungweiten der Hunde-, Katzen- und Fuchsflöhe nämlich an zwei Messorten, der Stadt und dem Dorf, gemessen. Dadurch haben wir jetzt den Faktor <span class="in">`animal`</span> und den Faktor <span class="in">`site`</span> vorliegen. Wiederum fragen wir usn, ob sich die Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span> der drei Floharten in den beiden Messorten unterscheidet. Im Folgenden lade ich einmal den Datensatz in das Objekt <span class="in">`fac2_tbl`</span> und ergänze noch eine ID Spalte für das R Paket <span class="in">`{afex}`</span>. Wir haben jeden Floh nur einmal gemessen, also kriegt jeder Floh eine eigene ID.</span>
<span id="cb117-1157"><a href="#cb117-1157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1160"><a href="#cb117-1160" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1161"><a href="#cb117-1161" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-1162"><a href="#cb117-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1163"><a href="#cb117-1163" aria-hidden="true" tabindex="-1"></a>fac2_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/flea_dog_cat_fox_site.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb117-1164"><a href="#cb117-1164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, site, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb117-1165"><a href="#cb117-1165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"city"</span>, <span class="st">"village"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb117-1166"><a href="#cb117-1166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal),</span>
<span id="cb117-1167"><a href="#cb117-1167" aria-hidden="true" tabindex="-1"></a>         <span class="at">site =</span> <span class="fu">as_factor</span>(site))<span class="sc">|&gt;</span> </span>
<span id="cb117-1168"><a href="#cb117-1168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="st">".id"</span>)</span>
<span id="cb117-1169"><a href="#cb117-1169" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1170"><a href="#cb117-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1171"><a href="#cb117-1171" aria-hidden="true" tabindex="-1"></a>Betrachten wir als erstes einen Auszug aus der Datentabelle. Wir haben hier als Messwert oder Outcome $y$ die Sprungweite <span class="in">`jump_length`</span> vorliegen. Als ersten Faktor die Variable <span class="in">`animal`</span> und als zweiten Faktor die Variable <span class="in">`site`</span> festgelegt.</span>
<span id="cb117-1172"><a href="#cb117-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1175"><a href="#cb117-1175" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1176"><a href="#cb117-1176" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-1177"><a href="#cb117-1177" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-1178"><a href="#cb117-1178" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-1179"><a href="#cb117-1179" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-2fac-table</span></span>
<span id="cb117-1180"><a href="#cb117-1180" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Tabelle der Sprungweiten in [cm] als Messwert $y$ von Hunde-, Katzen- und Fuchsflöhen an zwei verschiedenen Messorten Stadt und Dorf. Der Datensatz ist zweifaktoriell, da wir einen Behandlungsfaktor mit `animal` und einen zweiten Faktor mit `site` vorliegen haben."</span></span>
<span id="cb117-1181"><a href="#cb117-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1182"><a href="#cb117-1182" aria-hidden="true" tabindex="-1"></a>fac2_raw_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/flea_dog_cat_fox_site.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb117-1183"><a href="#cb117-1183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, site, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb117-1184"><a href="#cb117-1184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"city"</span>, <span class="st">"village"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb117-1185"><a href="#cb117-1185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="st">".id"</span>)</span>
<span id="cb117-1186"><a href="#cb117-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1187"><a href="#cb117-1187" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(fac2_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>),</span>
<span id="cb117-1188"><a href="#cb117-1188" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(fac2_raw_tbl)),</span>
<span id="cb117-1189"><a href="#cb117-1189" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(fac2_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb117-1190"><a href="#cb117-1190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tt</span>(<span class="at">width =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">align =</span> <span class="st">"c"</span>, <span class="at">theme =</span> <span class="st">"striped"</span>)</span>
<span id="cb117-1191"><a href="#cb117-1191" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1192"><a href="#cb117-1192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1193"><a href="#cb117-1193" aria-hidden="true" tabindex="-1"></a>Auch hier schauen wir uns einmal die Daten in einem Boxplot an. Wir sehen zum einen den Effekt der Floharten. Hier sehen wir aber auch eine klare Interaktion in den Daten. Die Flöhe springen in der Stadt unterschiedlich weit als in dem Dorf. So ist der Effekt und damit der Unterschied zwischen den Floharten in der Stadt ein anderer als auf dem Dorf. Wir haben eine vermutliche Interaktion zwichen den beiden Faktoren <span class="in">`animal`</span> und <span class="in">`site`</span> vorliegen.</span>
<span id="cb117-1194"><a href="#cb117-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1197"><a href="#cb117-1197" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1198"><a href="#cb117-1198" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-1199"><a href="#cb117-1199" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-1200"><a href="#cb117-1200" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-1201"><a href="#cb117-1201" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-anova-boxplot-2fac</span></span>
<span id="cb117-1202"><a href="#cb117-1202" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-1203"><a href="#cb117-1203" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb117-1204"><a href="#cb117-1204" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb117-1205"><a href="#cb117-1205" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Beispielhafter zweifaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten und den beiden Messorten."</span></span>
<span id="cb117-1206"><a href="#cb117-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1207"><a href="#cb117-1207" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fac2_tbl, </span>
<span id="cb117-1208"><a href="#cb117-1208" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> site, <span class="at">y =</span> jump_length, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb117-1209"><a href="#cb117-1209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb117-1210"><a href="#cb117-1210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb117-1211"><a href="#cb117-1211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="fu">aes</span>(<span class="at">group =</span> animal), </span>
<span id="cb117-1212"><a href="#cb117-1212" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape=</span><span class="dv">23</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fill =</span> <span class="st">"gray50"</span>,</span>
<span id="cb117-1213"><a href="#cb117-1213" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.75</span>)) <span class="sc">+</span></span>
<span id="cb117-1214"><a href="#cb117-1214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flohart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>, <span class="at">fill =</span> <span class="st">"Tierart"</span>) <span class="sc">+</span></span>
<span id="cb117-1215"><a href="#cb117-1215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span>
<span id="cb117-1216"><a href="#cb117-1216" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1217"><a href="#cb117-1217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1218"><a href="#cb117-1218" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Multifaktorieller Datensatz {.unnumbered .unlisted}</span></span>
<span id="cb117-1219"><a href="#cb117-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1220"><a href="#cb117-1220" aria-hidden="true" tabindex="-1"></a>Als letzten Datensatz lade ich noch einen multifaktoriellen Datensatz. Wir haben hier mehrere Faktoren vorliegen. Neben den Floharten <span class="in">`animal`</span> haben wir auch den Entwicklungsstand <span class="in">`stage`</span> sowie die Messorte <span class="in">`site`</span> bestimmt. Dazu kommt dann noch der Faktor <span class="in">`season`</span> als Jahreszeit. Damit haben wir dann einen vierfaktoriellen oder kurz multifaktoriellen Datensatz vorliegen. Hier wird die Sachlage dann schnell unübersichtlich und solche mehrfaktoriellen Datensätze kommen in der Praxis eher selten vor. Im Folgenden lade ich einmal den Datensatz in das Objekt <span class="in">`fac4_tbl`</span> und ergänze noch eine ID Spalte für das R Paket <span class="in">`{afex}`</span>. Wir haben jeden Floh nur einmal gemessen, also kriegt jeder Floh eine eigene ID.</span>
<span id="cb117-1221"><a href="#cb117-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1224"><a href="#cb117-1224" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1225"><a href="#cb117-1225" aria-hidden="true" tabindex="-1"></a>fac4_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/fleas_complex_data.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"fac4"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb117-1226"><a href="#cb117-1226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, stage, site, season, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb117-1227"><a href="#cb117-1227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal),</span>
<span id="cb117-1228"><a href="#cb117-1228" aria-hidden="true" tabindex="-1"></a>         <span class="at">stage =</span> <span class="fu">factor</span>(stage, <span class="at">level =</span> <span class="fu">c</span>(<span class="st">"juvenile"</span>, <span class="st">"adult"</span>)),</span>
<span id="cb117-1229"><a href="#cb117-1229" aria-hidden="true" tabindex="-1"></a>         <span class="at">site =</span> <span class="fu">as_factor</span>(site),</span>
<span id="cb117-1230"><a href="#cb117-1230" aria-hidden="true" tabindex="-1"></a>         <span class="at">season =</span> <span class="fu">as_factor</span>(season),</span>
<span id="cb117-1231"><a href="#cb117-1231" aria-hidden="true" tabindex="-1"></a>         <span class="at">jump_length =</span> <span class="fu">round</span>(jump_length, <span class="dv">2</span>))<span class="sc">|&gt;</span> </span>
<span id="cb117-1232"><a href="#cb117-1232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="st">".id"</span>)</span>
<span id="cb117-1233"><a href="#cb117-1233" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1234"><a href="#cb117-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1235"><a href="#cb117-1235" aria-hidden="true" tabindex="-1"></a>Betrachten wir als erstes einen Auszug aus der Datentabelle. Wir haben hier als Messwert oder Outcome $y$ die Sprungweite <span class="in">`jump_length`</span> vorliegen. Als ersten Faktor die Variable <span class="in">`animal`</span> und als zweiten Faktor die Variable <span class="in">`site`</span> festgelegt sowie als dritten Faktor den Entwicklungsstand <span class="in">`stage`</span> der Flöhe.</span>
<span id="cb117-1236"><a href="#cb117-1236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1239"><a href="#cb117-1239" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1240"><a href="#cb117-1240" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-1241"><a href="#cb117-1241" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-1242"><a href="#cb117-1242" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-1243"><a href="#cb117-1243" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-fac3-table</span></span>
<span id="cb117-1244"><a href="#cb117-1244" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Tabelle der Sprungweiten in [cm] als Messwert $y$ von Hunde-, Katzen- und Fuchsflöhen an zwei verschiedenen Messorten Stadt und Dorf. Dazu wurde noch der Entwicklungsstand mit erwachsen und jugendlich erhoben. Der Datensatz ist dreifaktoriell, da wir einen Behandlungsfaktor mit `animal` und einen zweiten Faktor mit `site` vorliegen haben sowie den Entwicklungsstand `stage`."</span></span>
<span id="cb117-1245"><a href="#cb117-1245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1246"><a href="#cb117-1246" aria-hidden="true" tabindex="-1"></a>fac3_raw_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/fleas_complex_data.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"fac4"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb117-1247"><a href="#cb117-1247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, stage, site, season, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb117-1248"><a href="#cb117-1248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb117-1249"><a href="#cb117-1249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="st">".id"</span>)</span>
<span id="cb117-1250"><a href="#cb117-1250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1251"><a href="#cb117-1251" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(fac3_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>),</span>
<span id="cb117-1252"><a href="#cb117-1252" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(fac3_raw_tbl)),</span>
<span id="cb117-1253"><a href="#cb117-1253" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(fac3_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb117-1254"><a href="#cb117-1254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tt</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">align =</span> <span class="st">"c"</span>, <span class="at">theme =</span> <span class="st">"striped"</span>)</span>
<span id="cb117-1255"><a href="#cb117-1255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1256"><a href="#cb117-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1257"><a href="#cb117-1257" aria-hidden="true" tabindex="-1"></a>Wenn wir im Folgenden einmal die Boxplots betrachten, dann sehen wir auch einen Effekt der Floharten. Die Boxplots der Sprungweiten für die einzelnen Floharten sind unterschiedlich und liegen nicht auf einer Ebene. Die juvenilen und erwachsen Flöhe scheinen recht ähnlich zu springen. Wir sehen hier eventuell nur eine leichte Verschiedung. Darüber hinaus springen aber Dorfflöhe anders als Stadtflöhe. Hier wird es jetzt aber schwierig mit der visuellen Abschätzung, da müssen wir jetzt wirklich mal mit einer ANOVA ran und schauen was signifikant unterschiedlich ist.</span>
<span id="cb117-1258"><a href="#cb117-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1261"><a href="#cb117-1261" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1262"><a href="#cb117-1262" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-1263"><a href="#cb117-1263" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-1264"><a href="#cb117-1264" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-1265"><a href="#cb117-1265" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-anova-boxplot-3fac</span></span>
<span id="cb117-1266"><a href="#cb117-1266" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-1267"><a href="#cb117-1267" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 7</span></span>
<span id="cb117-1268"><a href="#cb117-1268" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb117-1269"><a href="#cb117-1269" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Beispielhafter vierfaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten und den beiden Messorten sowie dem Entwicklungstand der Flöhe an verschiedenen Jahreszeiten."</span></span>
<span id="cb117-1270"><a href="#cb117-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1271"><a href="#cb117-1271" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fac4_tbl, </span>
<span id="cb117-1272"><a href="#cb117-1272" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> stage, <span class="at">y =</span> jump_length, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb117-1273"><a href="#cb117-1273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb117-1274"><a href="#cb117-1274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb117-1275"><a href="#cb117-1275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="fu">aes</span>(<span class="at">group =</span> animal), </span>
<span id="cb117-1276"><a href="#cb117-1276" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape=</span><span class="dv">23</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fill =</span> <span class="st">"gray50"</span>,</span>
<span id="cb117-1277"><a href="#cb117-1277" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.75</span>)) <span class="sc">+</span></span>
<span id="cb117-1278"><a href="#cb117-1278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Entwicklungsstadium"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>, <span class="at">fill =</span> <span class="st">"Flohart"</span>) <span class="sc">+</span></span>
<span id="cb117-1279"><a href="#cb117-1279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> site<span class="sc">*</span>season) <span class="sc">+</span></span>
<span id="cb117-1280"><a href="#cb117-1280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb117-1281"><a href="#cb117-1281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb117-1282"><a href="#cb117-1282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1283"><a href="#cb117-1283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1284"><a href="#cb117-1284" aria-hidden="true" tabindex="-1"></a><span class="fu">## Test auf Normalverteilung und Varianzhomogenität {#sec-anova-test-pre}</span></span>
<span id="cb117-1285"><a href="#cb117-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1286"><a href="#cb117-1286" aria-hidden="true" tabindex="-1"></a>Die ANOVA hat als Annahme an deinen Messwert, dass dier Messwert normalverteilt ist. Ebenso müssen die Varianzen in den Leveln des Faktors gleich sein. Wir sprechen dann von varianzhomogenität. In dem folgenden Abschnitt testen wir einmal auf Normalverteilung in dem Messwert $y$ und Varianzmomogenität in den Faktoren $f_A$ und $f_B$. Die hier vorhandenen Ergebnisse schreibst du meistens nicht in deine Abschlussarbeit oder zeigst dort die hier vorgestellten Abbildungen. Das dient hier nur zur Überprüfung in deinem statistischen Arbeitsprozess. Du findest noch im Tutorium <span class="co">[</span><span class="ot">Testing the Assumptions of ANOVAs</span><span class="co">](https://cran.r-project.org/web/packages/afex/vignettes/assumptions_of_ANOVAs.html#homogeneity-of-variances)</span> ein paar mehr Informationen, wenn es um die ANOVA und die Annahmen geht.</span>
<span id="cb117-1287"><a href="#cb117-1287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1288"><a href="#cb117-1288" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb117-1289"><a href="#cb117-1289" aria-hidden="true" tabindex="-1"></a><span class="fu">## Achtung, bitte beachten!</span></span>
<span id="cb117-1290"><a href="#cb117-1290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1291"><a href="#cb117-1291" aria-hidden="true" tabindex="-1"></a>Wenn du keine normalverteilten Daten hast, dann wird häufig empfholen, dass du deinen Messwert $y$ transformieren sollst. Das ist eine Lösung, wenn du dann nur bei deiner ANOVA bleiben würdest oder dich die Effekte auf der Einheit des Messwert $y$ nicht interessieren. Durch eine Transformation von $y$ verlierst du immer die direkte biologische Interpretation der Effekte aus einem statistischen Test.</span>
<span id="cb117-1292"><a href="#cb117-1292" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb117-1293"><a href="#cb117-1293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1294"><a href="#cb117-1294" aria-hidden="true" tabindex="-1"></a>Ich zeige dir hier einmal die Funktionen <span class="in">`check_normality()`</span> und <span class="in">`check_homogeneity()`</span> aus dem R PAket <span class="in">`{performance}`</span>. Beide Funktionen funktionieren super und man muss nicht so viel programmieren um die Funktionen zum laufen zu kriegen. Dammit du was testen kannst, musst du auch ein Modell haben was du testen kannst. Ich nutze hier einmal das einfaktorielle, zweifaktorielle sowie mehrfaktorielle Modell aus einer linearen Regression. Da sind die Annhamen die gleichen wie bei einer ANOVA.</span>
<span id="cb117-1295"><a href="#cb117-1295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1296"><a href="#cb117-1296" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Normalverteilung des Messwerts $y$ {.unnumbered .unlisted}</span></span>
<span id="cb117-1297"><a href="#cb117-1297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1298"><a href="#cb117-1298" aria-hidden="true" tabindex="-1"></a>Wenn du überprüfen willst, ob dein Messwert $y$ einer Normalverteilung folgt, dann kannst du die Funktion <span class="in">`check_normality()`</span> nutzt. Die Funktion rechnet dann den <span class="co">[</span><span class="ot">Shapiro-Wilk-Test</span><span class="co">](https://de.wikipedia.org/wiki/Shapiro-Wilk-Test)</span> um auf eine Abweichung von der Normalverteilung zu testen. Hierzu ist anzumerken, dass der Test relativ empfindlich bei Abweichungen in den Verteilungsschwänzen ist. Darüber hinaus braucht der Shapiro-Wilk-Test auch etwas Fallzahl, damit er auf die Normalverteilung testen kann. Im Folgenden schauen wir uns den Code für ein einfaktorielles, zweifaktorielles und dreifaktorielles Modell einmal an. Am Ende des Abschnitts gehe ich nochmal darauf ein, was du machen kannst, wenn du keine Normalverteilung in deinem Messwert $y$ vorliegen hast.</span>
<span id="cb117-1299"><a href="#cb117-1299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1300"><a href="#cb117-1300" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb117-1301"><a href="#cb117-1301" aria-hidden="true" tabindex="-1"></a><span class="fu">## Einfaktoriell</span></span>
<span id="cb117-1302"><a href="#cb117-1302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1303"><a href="#cb117-1303" aria-hidden="true" tabindex="-1"></a>Beginnen wir wieder mit einem einfaktoriellen Modell. Wir wollen wissen, ob unsere Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span> über unsere verschiedenen Floharten normalverteilt ist. Wir bauen also erstmal das Modell und schicken es dann in die Funktion <span class="in">`check_normality()`</span> aus dem R Paket <span class="in">`{performance}`</span>.</span>
<span id="cb117-1304"><a href="#cb117-1304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1307"><a href="#cb117-1307" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1308"><a href="#cb117-1308" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1309"><a href="#cb117-1309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_normality</span>()</span>
<span id="cb117-1310"><a href="#cb117-1310" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1311"><a href="#cb117-1311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1312"><a href="#cb117-1312" aria-hidden="true" tabindex="-1"></a>Die Funktion sagt, dass wir eine Normalverteilung in unseren Daten vorliegen haben. Wir können uns auch einen Diagnoseplot wiedergeben lassen. Dafür müssen wir die Funktion nur an die Funktion <span class="in">`plot()`</span> weiterleiten. Das Schöne ist, dass die Abbildung uns auch gleich sagt, was wir zu erwarten haben um eine Normalverteilung anzunehmen.</span>
<span id="cb117-1313"><a href="#cb117-1313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1316"><a href="#cb117-1316" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1317"><a href="#cb117-1317" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-1318"><a href="#cb117-1318" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb117-1319"><a href="#cb117-1319" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-1320"><a href="#cb117-1320" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-check-anova-normal-f1</span></span>
<span id="cb117-1321"><a href="#cb117-1321" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-1322"><a href="#cb117-1322" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb117-1323"><a href="#cb117-1323" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb117-1324"><a href="#cb117-1324" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Schnelle Abbildung der Residuen aus `check_normality()` zur Überprüfung der Normalverteilung des Messwerts in einem einfaktoriellen Modell."</span></span>
<span id="cb117-1325"><a href="#cb117-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1326"><a href="#cb117-1326" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1327"><a href="#cb117-1327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_normality</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-1328"><a href="#cb117-1328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>() <span class="sc">+</span></span>
<span id="cb117-1329"><a href="#cb117-1329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>()</span>
<span id="cb117-1330"><a href="#cb117-1330" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1331"><a href="#cb117-1331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1332"><a href="#cb117-1332" aria-hidden="true" tabindex="-1"></a><span class="fu">## Zweifaktoriell</span></span>
<span id="cb117-1333"><a href="#cb117-1333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1334"><a href="#cb117-1334" aria-hidden="true" tabindex="-1"></a>Im zweifaktoriellen Fall ändert sich jetzt nur das Model. Wir haben eben zwei Faktoren vorliegen und diese müssen wir dann mit ins Modell nehmen. Ich habe hier auch gleich den Interaktionsterm mit ergänzt, ich teste gerne das Modell, was ich dann später auch auswerten möchte.</span>
<span id="cb117-1335"><a href="#cb117-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1338"><a href="#cb117-1338" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1339"><a href="#cb117-1339" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1340"><a href="#cb117-1340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_normality</span>()</span>
<span id="cb117-1341"><a href="#cb117-1341" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1342"><a href="#cb117-1342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1343"><a href="#cb117-1343" aria-hidden="true" tabindex="-1"></a>Auch hier haben wir eine Normalverteilung in den Daten vorliegen. Gerne schaue ich mir auch die Abbildung der Residuen einmal an und das geht dann flott über die Funktion <span class="in">`plot()`</span>. Da musst du nur die Ausgabe der Funktion <span class="in">`check_normality()`</span> weiterleiten. Die leichten Bögen in den Punkten kommen von den unterschiedlichen Faktoren und deren Effekten auf die Sprungweite.</span>
<span id="cb117-1344"><a href="#cb117-1344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1347"><a href="#cb117-1347" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1348"><a href="#cb117-1348" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-1349"><a href="#cb117-1349" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb117-1350"><a href="#cb117-1350" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-1351"><a href="#cb117-1351" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-check-anova-normal-f2</span></span>
<span id="cb117-1352"><a href="#cb117-1352" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-1353"><a href="#cb117-1353" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb117-1354"><a href="#cb117-1354" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb117-1355"><a href="#cb117-1355" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Schnelle Abbildung der Residuen aus `check_normality()` zur Überprüfung der Normalverteilung des Messwerts in einem zweifaktoriellen Modell."</span></span>
<span id="cb117-1356"><a href="#cb117-1356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1357"><a href="#cb117-1357" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1358"><a href="#cb117-1358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_normality</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-1359"><a href="#cb117-1359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>() <span class="sc">+</span></span>
<span id="cb117-1360"><a href="#cb117-1360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>()</span>
<span id="cb117-1361"><a href="#cb117-1361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1362"><a href="#cb117-1362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1363"><a href="#cb117-1363" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mehrfaktoriell</span></span>
<span id="cb117-1364"><a href="#cb117-1364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1365"><a href="#cb117-1365" aria-hidden="true" tabindex="-1"></a>Am Ende dann nochmal ein mehrfaktorielles Modell. Hier möchte ich dann auch alle Faktorkombinationen einmal testen und nutze dafür die Kurzschreibweise in R mit dem Malzeichen. Ich kann mir sonst nicht alle Kombinationen der drei Faktoren mit den entsprechenden Interaktionstermen merken. Deshalb lasse ich hier mal die beiden Jahreszeiten aus dem Modell raus.</span>
<span id="cb117-1366"><a href="#cb117-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1369"><a href="#cb117-1369" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1370"><a href="#cb117-1370" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>site<span class="sc">*</span>stage, <span class="at">data =</span> fac4_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1371"><a href="#cb117-1371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_normality</span>()</span>
<span id="cb117-1372"><a href="#cb117-1372" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1373"><a href="#cb117-1373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1374"><a href="#cb117-1374" aria-hidden="true" tabindex="-1"></a>Auch hier sehen wir, dass die Funktion normalverteilte Sprungweiten findet. Auch hier können wir uns die Residuen des Modells einmal in einer Abbildung anschauen. Hier haben wir auch wieder leichte Bögen in den Punkten aber das kommt durch die vielen Faktoren und deren Effekten. Solange alles in den gelben Bändern bleibt, ist alles in Ordnung.</span>
<span id="cb117-1375"><a href="#cb117-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1378"><a href="#cb117-1378" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1379"><a href="#cb117-1379" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-1380"><a href="#cb117-1380" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb117-1381"><a href="#cb117-1381" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-1382"><a href="#cb117-1382" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-check-anova-normal-f3</span></span>
<span id="cb117-1383"><a href="#cb117-1383" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-1384"><a href="#cb117-1384" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb117-1385"><a href="#cb117-1385" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb117-1386"><a href="#cb117-1386" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Schnelle Abbildung der Residuen aus `check_normality()` zur Überprüfung der Normalverteilung des Messwerts in einem mehrfaktoriellen Modell."</span></span>
<span id="cb117-1387"><a href="#cb117-1387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1388"><a href="#cb117-1388" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>site<span class="sc">*</span>stage, <span class="at">data =</span> fac4_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1389"><a href="#cb117-1389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_normality</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-1390"><a href="#cb117-1390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>() <span class="sc">+</span></span>
<span id="cb117-1391"><a href="#cb117-1391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>()</span>
<span id="cb117-1392"><a href="#cb117-1392" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1393"><a href="#cb117-1393" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb117-1394"><a href="#cb117-1394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1395"><a href="#cb117-1395" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Varianzhomogenität der Faktoren $f$ {.unnumbered .unlisted}</span></span>
<span id="cb117-1396"><a href="#cb117-1396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1397"><a href="#cb117-1397" aria-hidden="true" tabindex="-1"></a>Nachdem wir die Normalverteilung des Messwertes $y$ getestet haben, wollen wir jetzt noch schauen, ob unsere Faktoren einer Varianzhomogenität über die Gruppen genügt. Die Funktion <span class="in">`check_homogeneity()`</span> nutzt den <span class="co">[</span><span class="ot">Bartlett-Test</span><span class="co">](https://de.wikipedia.org/wiki/Bartlett-Test)</span> um auf eine Abweichung von der Varianzhomogenität zu testen. Es gibt noch verschiedene andere Tests, aber ich würde hier empfehlen bei eiem Test zu bleiben und dann mit dem Ergebnis zu leben. Wild verschiedene Tests auf Varianzhomogenität durchzuführen führt dann auch nur zu einem wilden Fruchtsalat an Ergebnissen mit denen keiner was anfangen kann. Im Folgenden schauen wir uns den Code für ein einfaktorielles, zweifaktorielles und dreifaktorielles Modell einmal an. Am Ende des Abschnitts gehe ich nochmal darauf ein, was du machen kannst, wenn du keine Varianzhomogenität in deinen Faktoren vorliegen hast.</span>
<span id="cb117-1398"><a href="#cb117-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1399"><a href="#cb117-1399" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb117-1400"><a href="#cb117-1400" aria-hidden="true" tabindex="-1"></a><span class="fu">## Einfaktoriell</span></span>
<span id="cb117-1401"><a href="#cb117-1401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1402"><a href="#cb117-1402" aria-hidden="true" tabindex="-1"></a>Beginnen wir wieder mit dem einfaktoriellen Modell. Wir stecken das Modell dann einfach in die Funktion <span class="in">`check_homogeneity()`</span> und erhalten die Information über die Varianzhomogenität wiedergegeben.</span>
<span id="cb117-1403"><a href="#cb117-1403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1406"><a href="#cb117-1406" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1407"><a href="#cb117-1407" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1408"><a href="#cb117-1408" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_homogeneity</span>()</span>
<span id="cb117-1409"><a href="#cb117-1409" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1410"><a href="#cb117-1410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1411"><a href="#cb117-1411" aria-hidden="true" tabindex="-1"></a>Wunderbar, wir haben keine Abweichung von der Varianzhomongenität. Wir können uns auch die Daten nochmal anschauen. Hier sehen wir aber schon, dass die Daten etwas heterogen *aussehen* der Test aber die Homogenität nicht ablehnt. Das ist immer schwierig bei kleinen Fallzahlen. Aber an irgendwas muss man eben glauben.</span>
<span id="cb117-1412"><a href="#cb117-1412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1415"><a href="#cb117-1415" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1416"><a href="#cb117-1416" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-1417"><a href="#cb117-1417" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb117-1418"><a href="#cb117-1418" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-1419"><a href="#cb117-1419" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-check-anova-variance-f1</span></span>
<span id="cb117-1420"><a href="#cb117-1420" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-1421"><a href="#cb117-1421" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb117-1422"><a href="#cb117-1422" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb117-1423"><a href="#cb117-1423" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Schnelle Abbildung der Residuen aus `check_homogeneity()` zur Überprüfung der Varianzhomogenität der Faktoren in einem einfaktoriellen Modell."</span></span>
<span id="cb117-1424"><a href="#cb117-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1425"><a href="#cb117-1425" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1426"><a href="#cb117-1426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_homogeneity</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-1427"><a href="#cb117-1427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>() <span class="sc">+</span></span>
<span id="cb117-1428"><a href="#cb117-1428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>()</span>
<span id="cb117-1429"><a href="#cb117-1429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1430"><a href="#cb117-1430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1431"><a href="#cb117-1431" aria-hidden="true" tabindex="-1"></a><span class="fu">## Zweifaktoriell</span></span>
<span id="cb117-1432"><a href="#cb117-1432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1433"><a href="#cb117-1433" aria-hidden="true" tabindex="-1"></a>Jetzt können wir mal schauen, was passiert wenn wir die Anzahl an möglichen Faktorkombinationen erhöhen indem wir ein zweifaktorielles Modell nutzen. Hier haben wir dann ja sechs Faktorkombinationen oder Gruppen die dann alle homogen in den Varianzen sein müssen.</span>
<span id="cb117-1434"><a href="#cb117-1434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1437"><a href="#cb117-1437" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1438"><a href="#cb117-1438" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1439"><a href="#cb117-1439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_homogeneity</span>()</span>
<span id="cb117-1440"><a href="#cb117-1440" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1441"><a href="#cb117-1441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1442"><a href="#cb117-1442" aria-hidden="true" tabindex="-1"></a>Wir haben auch hier Varianzhomogenität über alle Gruppen der Faktoren vorliegen. Wenn du dir jetzt die Abbildung zu dem Test anschaust, dann siehst du auch hier, dass die Violinplots eben dann doch alle etas anders aussehen. Wir haben aber hier auch das gleiche Problem wie bei dem einfaktoriellen Fall, wir haben eben dann doch recht wenig Fallzahl in unseren Daten.</span>
<span id="cb117-1443"><a href="#cb117-1443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1446"><a href="#cb117-1446" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1447"><a href="#cb117-1447" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-1448"><a href="#cb117-1448" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb117-1449"><a href="#cb117-1449" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-1450"><a href="#cb117-1450" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-check-anova-variance-f2</span></span>
<span id="cb117-1451"><a href="#cb117-1451" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-1452"><a href="#cb117-1452" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb117-1453"><a href="#cb117-1453" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb117-1454"><a href="#cb117-1454" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Schnelle Abbildung der Residuen aus `check_homogeneity()` zur Überprüfung der Varianzhomogenität der Faktoren in einem zweifaktoriellen Modell."</span></span>
<span id="cb117-1455"><a href="#cb117-1455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1456"><a href="#cb117-1456" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1457"><a href="#cb117-1457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_homogeneity</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-1458"><a href="#cb117-1458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>() <span class="sc">+</span></span>
<span id="cb117-1459"><a href="#cb117-1459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>()</span>
<span id="cb117-1460"><a href="#cb117-1460" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1461"><a href="#cb117-1461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1462"><a href="#cb117-1462" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mehrfaktoriell</span></span>
<span id="cb117-1463"><a href="#cb117-1463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1464"><a href="#cb117-1464" aria-hidden="true" tabindex="-1"></a>Am Ende dann nochmal ein mehrfaktorielles Modell. Hier möchte ich dann auch alle Faktorkombinationen einmal testen und nutze dafür die Kurzschreibweise in R mit dem Malzeichen. Ich kann mir sonst nicht alle Kombinationen der drei Faktoren mit den entsprechenden Interaktionstermen merken. In diesem Fall sind es dann ganze zwölf Kombinationen. Deshalb lasse ich hier mal die beiden Jahreszeiten aus dem Modell raus.</span>
<span id="cb117-1465"><a href="#cb117-1465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1468"><a href="#cb117-1468" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1469"><a href="#cb117-1469" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>site<span class="sc">*</span>stage, <span class="at">data =</span> fac4_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1470"><a href="#cb117-1470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_homogeneity</span>()</span>
<span id="cb117-1471"><a href="#cb117-1471" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1472"><a href="#cb117-1472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1473"><a href="#cb117-1473" aria-hidden="true" tabindex="-1"></a>Hier haben wir dann eine Abweichung von der Varianzhomogenität. Zum einen, weil ich die Daten so gebaut habe und zum anderen da wir jetzt echt viele Gruppen haben, wie du in der folgenden Abbidlugn sehen kannst. Es wird dann eben schwieriger in biologischen Echtdaten über viele Gruppen immer die gleiche Varianz zu haben. Irgendwann ist dann alles heterogen. Hier passt dann die Abbildung aber besser zu der Ausgabe des statistischen Tests.</span>
<span id="cb117-1474"><a href="#cb117-1474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1477"><a href="#cb117-1477" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1478"><a href="#cb117-1478" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-1479"><a href="#cb117-1479" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb117-1480"><a href="#cb117-1480" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-1481"><a href="#cb117-1481" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-check-anova-variance-f3</span></span>
<span id="cb117-1482"><a href="#cb117-1482" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-1483"><a href="#cb117-1483" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb117-1484"><a href="#cb117-1484" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb117-1485"><a href="#cb117-1485" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Schnelle Abbildung der Residuen aus `check_homogeneity()` zur Überprüfung der Varianzhomogenität der Faktoren in einem dreifaktoriellen Modell."</span></span>
<span id="cb117-1486"><a href="#cb117-1486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1487"><a href="#cb117-1487" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>site<span class="sc">*</span>stage, <span class="at">data =</span> fac4_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1488"><a href="#cb117-1488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_homogeneity</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-1489"><a href="#cb117-1489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>() </span>
<span id="cb117-1490"><a href="#cb117-1490" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1491"><a href="#cb117-1491" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb117-1492"><a href="#cb117-1492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1493"><a href="#cb117-1493" aria-hidden="true" tabindex="-1"></a>Weder Normalverteilung noch Varianzhomogenität?</span>
<span id="cb117-1494"><a href="#cb117-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1495"><a href="#cb117-1495" aria-hidden="true" tabindex="-1"></a>:   In dem Fall kannst du das R Paket <span class="in">`{WRS2}`</span> nutzen, was ich dir in den folgenden Tabs auch immer wieder vorstelle. Das Paket <span class="in">`{WRS2}`</span> kann mit getrimmten Mittelwerten mit nicht normalverteilten Daten sowie Vamrianzhterogenität umgehen. Das ist eine bessere Lösung als die nicht-parametrischen Verfahren, wenn du auf dem ANOVA Pfad bleiben willst.</span>
<span id="cb117-1496"><a href="#cb117-1496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1497"><a href="#cb117-1497" aria-hidden="true" tabindex="-1"></a>Das R Paket <span class="in">`{car}`</span> erlaubt unter der Annahme der Normalverteilung des Messwertes $y$ auch eine Varianzhterogenität zu modellieren. Hier musst du dann die entsprechende Option wählen. Alles dazu findest du dann weiter unten in den entsprechenden Tabs zu der ANOVA in <span class="in">`{car}`</span>.</span>
<span id="cb117-1498"><a href="#cb117-1498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1499"><a href="#cb117-1499" aria-hidden="true" tabindex="-1"></a>Eine weitere Möglichkeit ist es deine Daten zu transformieren, wie ich es oben schon erwähnt habe. Hier findest du dann im <span class="co">[</span><span class="ot">Kaptitel zur Transformation von Daten</span><span class="co">](#sec-eda-transform)</span> mehrere Optionen. Was da die beste Transformation ist, hängt dann stark von deiner wissenschaftlichen Fragestellung ab. Hier kann ich dann leider keine allgemeine Empfehlung abgeben.</span>
<span id="cb117-1500"><a href="#cb117-1500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1501"><a href="#cb117-1501" aria-hidden="true" tabindex="-1"></a><span class="fu">## Einfaktorielle ANOVA</span></span>
<span id="cb117-1502"><a href="#cb117-1502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1503"><a href="#cb117-1503" aria-hidden="true" tabindex="-1"></a>Was für eine Menge an Text und Abbildungen bevor wir hier dann endlich mit der einfaktoriellen ANOVA anfangen. Wenn du dir nichts zu dem allgemeinen Hintergrund oder theoretischen Hintergrund durchgelesen hast, ist das überhaupt kein Problem. Wir nutzen jetzt hier die ANOVA auf unserem einfaktoriellen Datensatz zu der Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span> von verschiedenen Floharten. Wir wollen wissen, ob sich die Sprungweite signifikant für die Hunde-, Katzen- oder Fuchsflöhe unterscheidet.</span>
<span id="cb117-1504"><a href="#cb117-1504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1505"><a href="#cb117-1505" aria-hidden="true" tabindex="-1"></a>Was sagt mir eine signifikante einfaktorielle ANOVA?</span>
<span id="cb117-1506"><a href="#cb117-1506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1507"><a href="#cb117-1507" aria-hidden="true" tabindex="-1"></a>:   Wenn wir ein signifikantes Ergebnis in einer einfaktoriellen ANOVA vorliegen haben, dann wissen wir nur, dass die Floharten alle nicht gleich weit springen. Eine signifikante ANOVA haben wir vorliegen, wenn der p-Werte kleiner ist das Signifikanzniveau $\alpha$ gleich 5% oder eben 0.05 als Kommazahl. Welche Floharten sich konkret unterscheiden müssen wir dann noch in einem Post-hoc Test herausfinden.</span>
<span id="cb117-1508"><a href="#cb117-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1509"><a href="#cb117-1509" aria-hidden="true" tabindex="-1"></a>Wir haben jetzt die Wahl zwischen vier Implementierungen in R und einer holprigen Lösung in Excel. Bitte rechne die einfaktorielle ANOVA in R. Welches Paket du jetzt in R nimmst, hängt dann wiederum zum Teil von deiner Fragestellung und deinen Daten ab. Meistens ist die Standardimplementierung in <span class="in">`{base}`</span> mit der Funktion <span class="in">`aov()`</span> ausreichend. Da ich dann aber auch immer mal wieder was anderes brauche, zeige ich hier einmal alles.</span>
<span id="cb117-1510"><a href="#cb117-1510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1511"><a href="#cb117-1511" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb117-1512"><a href="#cb117-1512" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{base}`</span></span>
<span id="cb117-1513"><a href="#cb117-1513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1514"><a href="#cb117-1514" aria-hidden="true" tabindex="-1"></a>Beginnen wir mit der Standardfunktion <span class="in">`aov()`</span> für die einfaktorielle ANOVA. Wir nehmen einfach ein Modell und spezifizieren noch die Datenquelle. Wichtig ist, dass die Reihenfolge der Faktoren in deinem Modell eine Rolle spielt. Ja, das ist bei einem Faktor egal, aber ich schreibe es hier schonmal. Dann nutze ich noch die Funktion <span class="in">`tidy()`</span> aus dem R Paket <span class="in">`{broom}`</span> für eine schönere Ausgabe. Dann habe ich alles zusammen.</span>
<span id="cb117-1515"><a href="#cb117-1515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1518"><a href="#cb117-1518" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1519"><a href="#cb117-1519" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1520"><a href="#cb117-1520" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()</span>
<span id="cb117-1521"><a href="#cb117-1521" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1522"><a href="#cb117-1522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1523"><a href="#cb117-1523" aria-hidden="true" tabindex="-1"></a>Wir können die Ausgabe der Funktion <span class="in">`aov()`</span> direkt weiter bei <span class="in">`{emmeans}`</span> verwenden. Die etwas allgemeinere Form eine einfaktorielle ANOVA zu rechnen, ist erst das lineare Modell zu schätzen. Hier nutze ich einmal eine lineare Regression mit der Funktion <span class="in">`lm()`</span>. Dann nutzen wir aber die Funktion <span class="in">`anova()`</span> um die ANOVA zu rechnen.</span>
<span id="cb117-1524"><a href="#cb117-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1527"><a href="#cb117-1527" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1528"><a href="#cb117-1528" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1529"><a href="#cb117-1529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-1530"><a href="#cb117-1530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()</span>
<span id="cb117-1531"><a href="#cb117-1531" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1532"><a href="#cb117-1532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1533"><a href="#cb117-1533" aria-hidden="true" tabindex="-1"></a>Wir sind am Ende aber nur am p-Wert interessiert und auch der ist hier signifikant, da der p-Wert unter dem Signifikanzniveau $\alpha$ gleich 5% liegt. Wie du siehst sind die Ergebnisse numerisch gleich. Warum dann überhaupt zwei Funktionen? Mit <span class="in">`lm()`</span> und <span class="in">`anova()`</span> bist du etwas flexibler was das genutzte Modell angeht.</span>
<span id="cb117-1534"><a href="#cb117-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1535"><a href="#cb117-1535" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{car}`</span></span>
<span id="cb117-1536"><a href="#cb117-1536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1537"><a href="#cb117-1537" aria-hidden="true" tabindex="-1"></a>Jetzt könnte man meinen, warum noch eine weitere Implementierung der ANOVA, wenn wir schon die Funktion <span class="in">`aov()`</span> haben? Die Funktion <span class="in">`aov()`</span> rechnet grundsätzlich Type I ANOVAs. Das macht jetzt bei einer einfaktoriellen ANOVA nichts aus, aber wir können eben in <span class="in">`{car}`</span> auch Type II und Type III ANOVAs rechnen. Darüber hinaus erlaubt das Paket auch für Varianzheterogenität in der ANOVA zu adjustieren.</span>
<span id="cb117-1538"><a href="#cb117-1538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1539"><a href="#cb117-1539" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Varianzhomogenität {.unnumbered .unlisted}</span></span>
<span id="cb117-1540"><a href="#cb117-1540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1541"><a href="#cb117-1541" aria-hidden="true" tabindex="-1"></a>In dem klassischen Aufruf der Funktion <span class="in">`Anova()`</span> nutzen wir wieder ein Modell und dann gebe ich dir wieder die aufgeräumte Ausgabe mit <span class="in">`tidy()`</span> wieder. Wenn du nichts extra angibst, dann rechnest du natürlich eine ANOVA unter der Annahme der Varianzhomogenität.</span>
<span id="cb117-1542"><a href="#cb117-1542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1545"><a href="#cb117-1545" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1546"><a href="#cb117-1546" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1547"><a href="#cb117-1547" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-1548"><a href="#cb117-1548" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()</span>
<span id="cb117-1549"><a href="#cb117-1549" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1550"><a href="#cb117-1550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1551"><a href="#cb117-1551" aria-hidden="true" tabindex="-1"></a>Wenn du die Zahlen mit der Funktion <span class="in">`aov()`</span> vergleichst, siehst du das da die gleichen Werte rauskommen. Das sollte natürlich auch in einer einfaktoriellen ANOVA mit den gleichen Annahmen so sein.</span>
<span id="cb117-1552"><a href="#cb117-1552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1553"><a href="#cb117-1553" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Varianzheterogenität {.unnumbered .unlisted}</span></span>
<span id="cb117-1554"><a href="#cb117-1554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1555"><a href="#cb117-1555" aria-hidden="true" tabindex="-1"></a>Der Vorteil des Pakets <span class="in">`{car}`</span> ist, dass wir in der Funktion <span class="in">`Anova()`</span> auch für Varianzheterogenität adjustieren können. Wir nutzen dazu die Option <span class="in">`white.adjust = TRUE`</span>. Ja, ich weiß, das ist überhaupt nicht naheliegend. Wenn wir das machen, dann werden die Abweichungsquadrate anders berechnet und unsere Ausgabe ändert sich entsprechend.</span>
<span id="cb117-1556"><a href="#cb117-1556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1559"><a href="#cb117-1559" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1560"><a href="#cb117-1560" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1561"><a href="#cb117-1561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>(<span class="at">white.adjust =</span> <span class="cn">TRUE</span>)  <span class="sc">|&gt;</span> </span>
<span id="cb117-1562"><a href="#cb117-1562" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()</span>
<span id="cb117-1563"><a href="#cb117-1563" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1564"><a href="#cb117-1564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1565"><a href="#cb117-1565" aria-hidden="true" tabindex="-1"></a>Wir sind am Ende aber nur am p-Wert interessiert und auch der ist hier signifikant, da der p-Wert unter dem Signifikanzniveau $\alpha$ gleich 5% liegt.</span>
<span id="cb117-1566"><a href="#cb117-1566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1567"><a href="#cb117-1567" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{afex}`</span></span>
<span id="cb117-1568"><a href="#cb117-1568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1569"><a href="#cb117-1569" aria-hidden="true" tabindex="-1"></a>Das R Paket <span class="in">`{afex}`</span> ist eigentlich für Messwiederholungen am besten geeignet, aber ich zeige es auch hier im einfaktoriellen Fall, dann hier geht es eben auch. Das einzige was etwas anders ist, ist das wir eine ID für die Funktion brauchen. Das Paket <span class="in">`{afex}`</span> möchte nämlich explizit wissen, welcher Wert zu welcher Beobachtung gehört.</span>
<span id="cb117-1570"><a href="#cb117-1570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1573"><a href="#cb117-1573" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1574"><a href="#cb117-1574" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> <span class="fu">Error</span>(.id), <span class="at">data =</span> fac1_tbl) </span>
<span id="cb117-1575"><a href="#cb117-1575" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1576"><a href="#cb117-1576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1577"><a href="#cb117-1577" aria-hidden="true" tabindex="-1"></a>Da die Berechnung dann auch noch etwas anders verläuft haben wir dann leicht andere Werte raus. Wir sind am Ende aber nur am p-Wert interessiert und auch der ist hier signifikant, da der p-Wert unter dem Signifikanzniveau $\alpha$ gleich 5% liegt.</span>
<span id="cb117-1578"><a href="#cb117-1578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1579"><a href="#cb117-1579" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{WRS2}`</span></span>
<span id="cb117-1580"><a href="#cb117-1580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1581"><a href="#cb117-1581" aria-hidden="true" tabindex="-1"></a>Jetzt wird es eigentlich erst spannend. Das <span class="co">[</span><span class="ot">R Paket `{WRS2}`</span><span class="co">](https://cran.r-project.org/web/packages/WRS2/vignettes/WRS2.pdf)</span> von @mair2020robust erlaubt es auch bei nicht normalverteilten Daten sowie Varianzheterogenität eine ANOVA zu rechnen. Ja, du könntest dir auch die ganzen Vortests sparen und gleich eien ANOVA mit dem R Paket <span class="in">`{WRS2}`</span> rechnen. Da wir es aber mit einer robusten Methode zu tun haben, werden deine Daten etwas getrimmt oder beschnitten. Wenn du also zu wenige Beobachtungen in den Gruppen hast, dann ist das R Paket <span class="in">`{WRS2}`</span> nicht die beste Idee.</span>
<span id="cb117-1582"><a href="#cb117-1582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1585"><a href="#cb117-1585" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1586"><a href="#cb117-1586" aria-hidden="true" tabindex="-1"></a><span class="fu">t1way</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span>
<span id="cb117-1587"><a href="#cb117-1587" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1588"><a href="#cb117-1588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1589"><a href="#cb117-1589" aria-hidden="true" tabindex="-1"></a>Wir kriegen neben dem p-Wert noch ein <span class="in">`Explanatory measure of effect size`</span> wiedergegeben. Du kannst den Wert wie folgt interpretieren. Ein Wert von 0.1 deutet auf einen kleinen, ein Wert von 0.3 auf einen mittleren und ab 0.5 auf einen Starken Effekt hin. Wir sind am Ende aber nur am p-Wert interessiert und auch der ist hier signifikant, da der p-Wert unter dem Signifikanzniveau $\alpha$ gleich 5% liegt.</span>
<span id="cb117-1590"><a href="#cb117-1590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1591"><a href="#cb117-1591" aria-hidden="true" tabindex="-1"></a>Geht es dann im Post-hoc Test dann einfach weiter? Ja, du kannst dann auch Funkionen aus dem <span class="in">`{WRS2}`</span> Paket nutzen oder aber du machst mit <span class="in">`{emmeans}`</span> weiter.</span>
<span id="cb117-1592"><a href="#cb117-1592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1593"><a href="#cb117-1593" aria-hidden="true" tabindex="-1"></a><span class="fu">## Excel</span></span>
<span id="cb117-1594"><a href="#cb117-1594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1595"><a href="#cb117-1595" aria-hidden="true" tabindex="-1"></a>Ja, du kannst auch eine einfakorielle ANOVA in Excel rechnen. Das ist dann mit etwas mehr Aufwand verbunden was die Daten angeht, aber am Ende kommt da auch was raus. Mehr dazu in dem folgenden Video. Empfehlen kann ich dir Excel nicht, aber manchmal muss das Schwein durchs Nadelöhr und dann ist das auch okay so.</span>
<span id="cb117-1596"><a href="#cb117-1596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1597"><a href="#cb117-1597" aria-hidden="true" tabindex="-1"></a>{{&lt; video https://youtu.be/we6vkvv8TNk &gt;}}</span>
<span id="cb117-1598"><a href="#cb117-1598" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb117-1599"><a href="#cb117-1599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1600"><a href="#cb117-1600" aria-hidden="true" tabindex="-1"></a>Nachdem wir einmal die p-Werte aus unserer einfaktoriellen ANOVA erhalten und dann noch geschaut haben, ob wir ein signifikantes Ergebnis haben, können wir jetzt weiter machen. Was fehlt noch? Wir müssen noch schauen, ob wir einen Effekt zwischen den Gruppen in unserem Faktor vorliegen haben. Eine Signifikanz bedeutet ja nicht gleich Relevanz und deshalb berechnen wir auch gerne einmal einen Effektschätzer. Ein Effektschätzer sagt dir, wie stark sich die Gruppen voneinander unterscheiden. Oder anders herum formuliert, wie stark ist der Einfluss des Faktors auf den Messwert?</span>
<span id="cb117-1601"><a href="#cb117-1601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1602"><a href="#cb117-1602" aria-hidden="true" tabindex="-1"></a>Dann müssen wir natürlich auch noch die Ergebnisse der einfaktoriellen ANOVA berichten. Dafür gibt es aber das <span class="co">[</span><span class="ot">R Paket `{report}`</span><span class="co">](https://easystats.github.io/report/)</span> welches dir dann bei der Interpretation der Ausgabe deiner ANOVA hilft. Nicht alle Varianten der ANOVA in R funktionieren mit dem Paket <span class="in">`{report}`</span>, deshalb hier nur ein Beispiel. Aber du kannst dich dann an der Ausgabe einmal orientieren.</span>
<span id="cb117-1603"><a href="#cb117-1603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1604"><a href="#cb117-1604" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb117-1605"><a href="#cb117-1605" aria-hidden="true" tabindex="-1"></a><span class="fu">## Effektschätzer</span></span>
<span id="cb117-1606"><a href="#cb117-1606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1607"><a href="#cb117-1607" aria-hidden="true" tabindex="-1"></a>Beginnen wir mit den drei Effektschätzern der ANOVA. Ich empfehle ja bei einer einfaktoriellen ANOVA immer das $\eta^2$ (eng. *eta squared*) als Effektmaß. Wir haben ja mit dem $\eta^2$ einen Wert für den Anteil der Varianz des Messwertes der durch den Behandlungsfaktor erklärt wird. Je mehr Vairanz durch die Behandlung erklärt wird, desto besser in unserem geplanten Experiment.</span>
<span id="cb117-1608"><a href="#cb117-1608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1611"><a href="#cb117-1611" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1612"><a href="#cb117-1612" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-1613"><a href="#cb117-1613" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-1614"><a href="#cb117-1614" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1615"><a href="#cb117-1615" aria-hidden="true" tabindex="-1"></a>  <span class="fu">eta_squared</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-1616"><a href="#cb117-1616" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interpret_eta_squared</span>(<span class="at">rules =</span> <span class="st">"field2013"</span>)</span>
<span id="cb117-1617"><a href="#cb117-1617" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1618"><a href="#cb117-1618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1619"><a href="#cb117-1619" aria-hidden="true" tabindex="-1"></a>Wir nehmen hier die Regeln nach @field2013discovering um zu entscheiden, wie bedeutend der Wert von $\eta^2$ ist. Hier kommt es dann aber auch auf das Experiment an. In einem geplanten Feldexperiment, wo nur die Gruppen variieren, sollte $\eta^2$ größer als 70% sein.</span>
<span id="cb117-1620"><a href="#cb117-1620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1621"><a href="#cb117-1621" aria-hidden="true" tabindex="-1"></a>Neben dem $\eta^2$ gibt es noch das $\epsilon^2$ (eng. *epsilon squared*) sowie das $\omega^2$ (eng. *omega squared*). Ich habe beide Maßzahlen weiter oben nochmal vorgestellt. Beide Effektschätzer sind eine Möglichkeit, aber ich würde bei einer einfaktoriellen ANOVA immer das $\eta^2$ vorziehen. Beide Effektschätzer haben dann eben nicht so die klare Interpretation. Kurz gesagt, ist $\epsilon^2$ wie das $\eta^2$ bei kleinen Fallzahlen.</span>
<span id="cb117-1622"><a href="#cb117-1622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1625"><a href="#cb117-1625" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1626"><a href="#cb117-1626" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-1627"><a href="#cb117-1627" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-1628"><a href="#cb117-1628" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1629"><a href="#cb117-1629" aria-hidden="true" tabindex="-1"></a>  <span class="fu">epsilon_squared</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-1630"><a href="#cb117-1630" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interpret_epsilon_squared</span>(<span class="at">rules =</span> <span class="st">"field2013"</span>)</span>
<span id="cb117-1631"><a href="#cb117-1631" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1632"><a href="#cb117-1632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1633"><a href="#cb117-1633" aria-hidden="true" tabindex="-1"></a>Dann hier nochmal das $\omega^2$, was seine Stärke bei mehreren Faktoren hat. Das $\omega^2$ ist das adjustierte $\eta^2$ für mehrere Faktoren. Daher ist es hier auch nur so mäßig von Interesse.</span>
<span id="cb117-1634"><a href="#cb117-1634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1637"><a href="#cb117-1637" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1638"><a href="#cb117-1638" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-1639"><a href="#cb117-1639" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-1640"><a href="#cb117-1640" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1641"><a href="#cb117-1641" aria-hidden="true" tabindex="-1"></a>  <span class="fu">omega_squared</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-1642"><a href="#cb117-1642" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interpret_omega_squared</span>(<span class="at">rules =</span> <span class="st">"field2013"</span>)</span>
<span id="cb117-1643"><a href="#cb117-1643" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1644"><a href="#cb117-1644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1645"><a href="#cb117-1645" aria-hidden="true" tabindex="-1"></a><span class="fu">## R Paket `{report}` {.unnumbered .unlisted}</span></span>
<span id="cb117-1646"><a href="#cb117-1646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1647"><a href="#cb117-1647" aria-hidden="true" tabindex="-1"></a>Das <span class="co">[</span><span class="ot">R Paket `{report}`</span><span class="co">](https://easystats.github.io/report/)</span> liefert nochmal die Möglichkeit sich die Ausgabe einer einfaktoriellen ANOVA in Textform wiedergeben zu lassen. Wie immer, wenn man alleine vor dem Rechner sitzt, ist das doch eine super Hilfestellung. Hier dann einmal mit der <span class="in">`Anova()`</span> Funktion aus dem R Paket <span class="in">`{car}`</span>.</span>
<span id="cb117-1648"><a href="#cb117-1648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1651"><a href="#cb117-1651" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1652"><a href="#cb117-1652" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1653"><a href="#cb117-1653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-1654"><a href="#cb117-1654" aria-hidden="true" tabindex="-1"></a>  <span class="fu">report</span>()</span>
<span id="cb117-1655"><a href="#cb117-1655" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1656"><a href="#cb117-1656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1657"><a href="#cb117-1657" aria-hidden="true" tabindex="-1"></a>Wir haben dann auch die Möglichkeit etwas schönere Tabellen uns wiedergeben zu lassen. Das funktioniert aber nicht bei jeder ANOVA Implementierung.</span>
<span id="cb117-1658"><a href="#cb117-1658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1661"><a href="#cb117-1661" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1662"><a href="#cb117-1662" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1663"><a href="#cb117-1663" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-1664"><a href="#cb117-1664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">report_table</span>()</span>
<span id="cb117-1665"><a href="#cb117-1665" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1666"><a href="#cb117-1666" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb117-1667"><a href="#cb117-1667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1668"><a href="#cb117-1668" aria-hidden="true" tabindex="-1"></a>Das war dann auch die einfaktorielle ANOVA. Wenn du die ANOVA in deiner Abschlussarbeit anwendest, musst du jetzt noch schauen, welche paarweisen Gruppenvergleiche in deinem Faktor signifikant sind. Jetzt könnte man sagen, dafür brauchst du eine signifikante ANOVA, aber meistens machen wir dann doch den ANOVA Pfad zu Ende.</span>
<span id="cb117-1669"><a href="#cb117-1669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1670"><a href="#cb117-1670" aria-hidden="true" tabindex="-1"></a><span class="fu">## Zweifaktorielle ANOVA</span></span>
<span id="cb117-1671"><a href="#cb117-1671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1672"><a href="#cb117-1672" aria-hidden="true" tabindex="-1"></a>Die zweifaktorielle ANOVA. Punkt. Gibt es eine häufigere genutzte Methode in den Agrarwissenschaften im Kontext eines geplanten Feldexperiments? Ich glaube eher nicht. Viele Versuche sind so gebaut, dass du die Versuche mit einer zweifaktoriellen ANOVA auswerten kannst oder aber die Versuche so über einen Faktor mittelst, dass dann auch dein mehrfaktorielles Experiment zu einem zweifaktoriellen wird.</span>
<span id="cb117-1673"><a href="#cb117-1673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1674"><a href="#cb117-1674" aria-hidden="true" tabindex="-1"></a>Auch hier überspringe ich dann den Teil mit dem allgemeinen und theoretischen Hintergrund und gehe dann auf die Implementierungen in R ein. Wir schauen uns hier das Beispiel der normalverteilten Sprungweiten in <span class="sc">\[</span>cm<span class="sc">\]</span> von Hunde-, Katzen-, und Fuchsflöhen an. Die Sprungweite wurde dann aber noch an zwei verschiedenen Orten gemessen, so dass wir ein zweifaktoriellens Design vorliegen haben.</span>
<span id="cb117-1675"><a href="#cb117-1675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1676"><a href="#cb117-1676" aria-hidden="true" tabindex="-1"></a>Was sagt mir eine signifikante zweifaktorielle ANOVA?</span>
<span id="cb117-1677"><a href="#cb117-1677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1678"><a href="#cb117-1678" aria-hidden="true" tabindex="-1"></a>:   Wenn wir ein signifikantes Ergebnis in einer zweifaktoriellen ANOVA vorliegen haben, dann wissen wir nur, dass die Floharten alle nicht gleich weit springen. Oder aber das sich die Messworte unterscheiden. Eine signifikante ANOVA haben wir vorliegen, wenn der p-Werte kleiner ist das Signifikanzniveau $\alpha$ gleich 5% oder eben 0.05 als Kommazahl. Welche Floharten oder Messorte sich konkret unterscheiden müssen wir dann noch in einem Post-hoc Test herausfinden.</span>
<span id="cb117-1679"><a href="#cb117-1679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1680"><a href="#cb117-1680" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbildung siehst die nochmal die möglichen Effekte zweier Faktoren A und B. Das ist nochmal wichtig, da mit du eine Idee davon kriegst, wann ein Faktor vermutliche signifikant ist und wie die beiden Faktoren zusammenspielen. Ich empfehle immer den Faktor mit den meisten Leveln auf die x-Achse zu legen. Wenn es deine Fragestellung verlangt, macht auch einen andere Sortierung natürlich auch Sinn. Die p-Werte sind in der Abbildung abgeschätzt und dienen der Orientierung. Wir haben eine keine signifikante und einmal eine signifikante Interaktion zwischen den Faktoren A und B vorliegen. Die Darstellung der signifikanten Interaktion ist eher beispielhaft zu sehen. Je nach Faktorkombination und Darstellung sehen dann die Abbildungen anders aus.</span>
<span id="cb117-1681"><a href="#cb117-1681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1682"><a href="#cb117-1682" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb117-1683"><a href="#cb117-1683" aria-hidden="true" tabindex="-1"></a><span class="fu">## Nicht signifikante Interaktion</span></span>
<span id="cb117-1684"><a href="#cb117-1684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1687"><a href="#cb117-1687" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1688"><a href="#cb117-1688" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-1689"><a href="#cb117-1689" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-1690"><a href="#cb117-1690" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-1691"><a href="#cb117-1691" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-anova-nsig-inter-box-2fac</span></span>
<span id="cb117-1692"><a href="#cb117-1692" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-1693"><a href="#cb117-1693" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 10</span></span>
<span id="cb117-1694"><a href="#cb117-1694" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb117-1695"><a href="#cb117-1695" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung möglicher Kombinationen von Effekten der Faktoren A mit den Leveln $A.1$, $A.2$ und $A.3$ sowie dem Faktor B  mit den Leveln $B.1$ und $B.2$ anhand von Boxplots. Eine nicht signifikante Interaktion $A \\times B$ wird dargestellt. Die p-Werte sind abgeschätzt. **(A)** Kein Effekt in A und B. Die Boxplots aller Gruppen liegen auf dem globalen Mittelwert.  **(B)** Effekt von B. Die Boxplots sind um den Effekt von B verschoben. Der Faktor A liegt auf einer Ebene in B. **(C)** Effekt von A. Die Boxplots sind um den Effekt von A verschoben. Der Faktor B zeigt keinen Unterschied im Faktor A.   **(D)** Effekt von A und B. Die Faktoren A und B sind zum globalen Mittel verschoben. Der Faktor B ist in A in gleicher Richtung und Wert verschoben. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb117-1696"><a href="#cb117-1696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1697"><a href="#cb117-1697" aria-hidden="true" tabindex="-1"></a>p00 <span class="sc">+</span> p01 <span class="sc">+</span> p10 <span class="sc">+</span> p11 <span class="sc">+</span></span>
<span id="cb117-1698"><a href="#cb117-1698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb117-1699"><a href="#cb117-1699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>) <span class="sc">+</span></span>
<span id="cb117-1700"><a href="#cb117-1700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb117-1701"><a href="#cb117-1701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb117-1702"><a href="#cb117-1702" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1703"><a href="#cb117-1703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1704"><a href="#cb117-1704" aria-hidden="true" tabindex="-1"></a><span class="fu">## Signifikante Interaktion</span></span>
<span id="cb117-1705"><a href="#cb117-1705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1708"><a href="#cb117-1708" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1709"><a href="#cb117-1709" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-1710"><a href="#cb117-1710" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb117-1711"><a href="#cb117-1711" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-1712"><a href="#cb117-1712" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-anova-sig-inter-box-2fac</span></span>
<span id="cb117-1713"><a href="#cb117-1713" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-1714"><a href="#cb117-1714" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 10</span></span>
<span id="cb117-1715"><a href="#cb117-1715" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb117-1716"><a href="#cb117-1716" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung möglicher Kombinationen von Effekten der Faktoren A mit den Leveln $A.1$, $A.2$ und $A.3$ sowie dem Faktor B  mit den Leveln $B.1$ und $B.2$ anhand von Boxplots. Eine signifikante Interaktion $A \\times B$ wird dargestellt. Die p-Werte sind abgeschätzt. Die grünen Pfeile zeigen in die Richtung der entsprechenden Effekte in den Faktorleveln von A. **(A)** Faktor A und B sind nicht signifikant, da die Interaktion den Effekt in B maskiert.  **(B)** Faktor B signifikant. Die Interaktion liegt im Level A.3 des Faktors A. **(C)** Faktor A signifikant. Die Interaktion maskiert den Effekt von B. **(D)**  Faktor A und B sind signifikant. Interaktion liegt in Level A.3 für Faktor B vor. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb117-1717"><a href="#cb117-1717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1718"><a href="#cb117-1718" aria-hidden="true" tabindex="-1"></a>p00_inter <span class="sc">+</span> p01_inter <span class="sc">+</span> p10_inter <span class="sc">+</span> p11_inter <span class="sc">+</span></span>
<span id="cb117-1719"><a href="#cb117-1719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb117-1720"><a href="#cb117-1720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>) <span class="sc">+</span></span>
<span id="cb117-1721"><a href="#cb117-1721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb117-1722"><a href="#cb117-1722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb117-1723"><a href="#cb117-1723" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1724"><a href="#cb117-1724" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb117-1725"><a href="#cb117-1725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1726"><a href="#cb117-1726" aria-hidden="true" tabindex="-1"></a>Wenn wir uns eine zweifaktorielle ANOVA anschauen, dann haben wir immer die Haupteffekte der Faktoren A und B sowie eine potenzielle Interaktion zwischen den beiden Faktoren vorliegen. Daher betrachte ich zuerst die Haupteffekte und schauen dabei aber auch, ob wir eine Interaktion vorliegen haben. Beachte auch hier, dein Ziel ist es dann den ANOVA Pfad mit einem Post-hoc Test abzuschließen. Die zweifaktorielle ANOVA alleine reicht alleine meist nicht aus. Du musst auch wissen, welche paarweisen Vergleiche dann signifikant sind.</span>
<span id="cb117-1727"><a href="#cb117-1727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1728"><a href="#cb117-1728" aria-hidden="true" tabindex="-1"></a><span class="fu">### Haupteffekte</span></span>
<span id="cb117-1729"><a href="#cb117-1729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1730"><a href="#cb117-1730" aria-hidden="true" tabindex="-1"></a>Im ersten Schritt wollen wir wissen, ob wir einen signifkanten Unterschied der Mittelwerte in den Gruppen des Faktors <span class="in">`animal`</span> und dem Faktor <span class="in">`site`</span> finden. Dann schauen wir noch, ob wir eine Interaktion vorliegen haben. Die Interaktion betrachten wir dann im Anschluss nochmal separat. Daher nennen wir jezt die Analyse der Faktoren auch Haupteffekte.</span>
<span id="cb117-1731"><a href="#cb117-1731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1732"><a href="#cb117-1732" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb117-1733"><a href="#cb117-1733" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{base}`</span></span>
<span id="cb117-1734"><a href="#cb117-1734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1735"><a href="#cb117-1735" aria-hidden="true" tabindex="-1"></a>Beginnen wir mit der Standardfunktion <span class="in">`aov()`</span> für die zweifaktorielle ANOVA. Wir nehmen einfach ein Modell und spezifizieren noch die Datenquelle. Wichtig ist, dass die Reihenfolge der Faktoren in deinem Modell eine Rolle spielt. Daher nehme immer deine wichtigere Behandlung als erstes in das Modell oder nutze eine Type II ANOVA im R Paket <span class="in">`{car}`</span>. Dann nutze ich noch die Funktion <span class="in">`tidy()`</span> aus dem R Paket <span class="in">`{broom}`</span> für eine schönere Ausgabe. Dann habe ich alles zusammen.</span>
<span id="cb117-1736"><a href="#cb117-1736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1739"><a href="#cb117-1739" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1740"><a href="#cb117-1740" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1741"><a href="#cb117-1741" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-1742"><a href="#cb117-1742" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value))</span>
<span id="cb117-1743"><a href="#cb117-1743" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1744"><a href="#cb117-1744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1745"><a href="#cb117-1745" aria-hidden="true" tabindex="-1"></a>Wir können die Ausgabe der Funktion <span class="in">`aov()`</span> direkt weiter bei <span class="in">`{emmeans}`</span> verwenden. Die etwas allgemeinere Form eine zweifaktorielle ANOVA zu rechnen, ist erst das lineare Modell zu schätzen. Auch hier ist die Reihenfolge von Wichtigkeit. Hier nutze ich einmal eine lineare Regression mit der Funktion <span class="in">`lm()`</span>. Dann nutzen wir aber die Funktion <span class="in">`anova()`</span> um die ANOVA zu rechnen.</span>
<span id="cb117-1746"><a href="#cb117-1746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1749"><a href="#cb117-1749" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1750"><a href="#cb117-1750" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1751"><a href="#cb117-1751" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-1752"><a href="#cb117-1752" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-1753"><a href="#cb117-1753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value))</span>
<span id="cb117-1754"><a href="#cb117-1754" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1755"><a href="#cb117-1755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1756"><a href="#cb117-1756" aria-hidden="true" tabindex="-1"></a>Wir sind am Ende aber nur am p-Wert der beiden Faktoren interessiert und auch der ist hier für die Floharten <span class="in">`animal`</span> signifikant, da der p-Wert unter dem Signifikanzniveau $\alpha$ gleich 5% liegt. Der p-Wert für den Messort <span class="in">`site`</span> ist dagegen nicht signifkant. Wir haben eine signifikante Interaktion <span class="in">`animal:site`</span> vorliegen. Wie du siehst sind die Ergebnisse numerisch gleich.</span>
<span id="cb117-1757"><a href="#cb117-1757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1758"><a href="#cb117-1758" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{car}`</span></span>
<span id="cb117-1759"><a href="#cb117-1759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1760"><a href="#cb117-1760" aria-hidden="true" tabindex="-1"></a>Jetzt könnte man meinen, warum noch eine weitere Implementierung der ANOVA, wenn wir schon die Funktion <span class="in">`aov()`</span> haben? Die Funktion <span class="in">`aov()`</span> rechnet grundsätzlich Type I ANOVAs. Das macht jetzt bei einer zweifaktoriellen ANOVA schon einen Unterschied welchen Typ ANOVA wir rechnen. Wir können eben in <span class="in">`{car}`</span> auch Type II und Type III ANOVAs rechnen. Darüber hinaus erlaubt das Paket auch für Varianzheterogenität in der ANOVA zu adjustieren.</span>
<span id="cb117-1761"><a href="#cb117-1761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1762"><a href="#cb117-1762" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Varianzhomogenität {.unnumbered .unlisted}</span></span>
<span id="cb117-1763"><a href="#cb117-1763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1764"><a href="#cb117-1764" aria-hidden="true" tabindex="-1"></a>In dem klassischen Aufruf der Funktion <span class="in">`Anova()`</span> nutzen wir wieder ein Modell und dann gebe ich dir wieder die aufgeräumte Ausgabe mit <span class="in">`tidy()`</span> wieder. Wenn du nichts extra angibst, dann rechnest du natürlich eine ANOVA unter der Annahme der Varianzhomogenität.</span>
<span id="cb117-1765"><a href="#cb117-1765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1766"><a href="#cb117-1766" aria-hidden="true" tabindex="-1"></a>Keine Interaktion zwischen den Faktoren A und B</span>
<span id="cb117-1767"><a href="#cb117-1767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1768"><a href="#cb117-1768" aria-hidden="true" tabindex="-1"></a>:   Wir rechnen dann eine Type II ANOVA, wenn wir keine Interaktion zwischen den Faktoren vorliegen haben. Ja, dass müssen wir dann natürlich vorab einmal Testen, dazu kannst du einfach die Funktion <span class="in">`aov()`</span> nutzen. Wenn wir keine Interaktion vorliegen haben, dann nehmen wir auch die Interaktion aus dem Modell und testen nur die Haupteffekte mit einer Type II ANOVA. Damit ist dann auch soweit alles in Ordnung.</span>
<span id="cb117-1769"><a href="#cb117-1769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1772"><a href="#cb117-1772" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1773"><a href="#cb117-1773" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1774"><a href="#cb117-1774" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>(<span class="at">type =</span> <span class="st">"II"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb117-1775"><a href="#cb117-1775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()  <span class="sc">|&gt;</span> </span>
<span id="cb117-1776"><a href="#cb117-1776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value))</span>
<span id="cb117-1777"><a href="#cb117-1777" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1778"><a href="#cb117-1778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1779"><a href="#cb117-1779" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass der Faktor <span class="in">`animal`</span> signifkant ist, da der p-Wert unter dem Signifikanzniveau $\alpha$ gleich 5% liegt. Die Messorte <span class="in">`site`</span> sind nicht signifikant.</span>
<span id="cb117-1780"><a href="#cb117-1780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1781"><a href="#cb117-1781" aria-hidden="true" tabindex="-1"></a>Interaktion zwischen den Faktoren A und B</span>
<span id="cb117-1782"><a href="#cb117-1782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1783"><a href="#cb117-1783" aria-hidden="true" tabindex="-1"></a>:   Wir rechnen dann eine Type III ANOVA, wenn wir eine Interaktion zwischen den beiden Faktoren vorliegen haben. Dann werden die Haupteffekte unter der Berücksichtigung der Interaktion berechnet. Aber Achtung, du musst leider in <span class="in">`{car}`</span> die Kontraste anders definieren sonst testet die Funktion <span class="in">`Anova()`</span> nicht das was sie soll. Da ist dann die Funktion <span class="in">`aov_car()`</span> aus dem Paket <span class="in">`{afex}`</span> anwenderfreundlicher.</span>
<span id="cb117-1784"><a href="#cb117-1784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1787"><a href="#cb117-1787" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1788"><a href="#cb117-1788" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl,</span>
<span id="cb117-1789"><a href="#cb117-1789" aria-hidden="true" tabindex="-1"></a>    <span class="at">contrasts =</span> <span class="fu">list</span>(</span>
<span id="cb117-1790"><a href="#cb117-1790" aria-hidden="true" tabindex="-1"></a>    <span class="at">animal =</span> <span class="st">"contr.sum"</span>,</span>
<span id="cb117-1791"><a href="#cb117-1791" aria-hidden="true" tabindex="-1"></a>    <span class="at">site =</span> <span class="st">"contr.sum"</span></span>
<span id="cb117-1792"><a href="#cb117-1792" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb117-1793"><a href="#cb117-1793" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>(<span class="at">type =</span> <span class="st">"III"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb117-1794"><a href="#cb117-1794" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()  <span class="sc">|&gt;</span> </span>
<span id="cb117-1795"><a href="#cb117-1795" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value))</span>
<span id="cb117-1796"><a href="#cb117-1796" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1797"><a href="#cb117-1797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1798"><a href="#cb117-1798" aria-hidden="true" tabindex="-1"></a>Hier ändert sich jetzt nicht soviel. Die Entscheidungen anhand des p-Wertes sind hier gleich zu der Type II ANOVA. Wir sehen aber eine deutliche Interaktion, daher müssen wir uns die Interaktion zwischen den Haupteffekten nochmal anschauen.</span>
<span id="cb117-1799"><a href="#cb117-1799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1800"><a href="#cb117-1800" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Varianzheterogenität {.unnumbered .unlisted}</span></span>
<span id="cb117-1801"><a href="#cb117-1801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1802"><a href="#cb117-1802" aria-hidden="true" tabindex="-1"></a>Der Vorteil des Pakets <span class="in">`{car}`</span> ist, dass wir in der Funktion <span class="in">`Anova()`</span> auch für Varianzheterogenität adjustieren können. Wir nutzen dazu die Option <span class="in">`white.adjust = TRUE`</span>. Ja, ich weiß, das ist überhaupt nicht naheliegend. Wenn wir das machen, dann werden die Abweichungsquadrate anders berechnet und unsere Ausgabe ändert sich entsprechend. Auch hier nutze ich dann mal die Type II ANOVA und betrachte nur die Haupteffekte.</span>
<span id="cb117-1803"><a href="#cb117-1803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1806"><a href="#cb117-1806" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1807"><a href="#cb117-1807" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1808"><a href="#cb117-1808" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>(<span class="at">white.adjust =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="st">"II"</span>)  <span class="sc">|&gt;</span> </span>
<span id="cb117-1809"><a href="#cb117-1809" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-1810"><a href="#cb117-1810" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value))</span>
<span id="cb117-1811"><a href="#cb117-1811" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1812"><a href="#cb117-1812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1813"><a href="#cb117-1813" aria-hidden="true" tabindex="-1"></a>Wir sind am Ende aber nur am p-Wert interessiert und auch der ist hier signifikant für den Faktor <span class="in">`animal`</span>, da der p-Wert unter dem Signifikanzniveau $\alpha$ gleich 5% liegt. Wir finden hier keinen signifikanten Unterschied für den Messort <span class="in">`site`</span>.</span>
<span id="cb117-1814"><a href="#cb117-1814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1815"><a href="#cb117-1815" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{afex}`</span></span>
<span id="cb117-1816"><a href="#cb117-1816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1817"><a href="#cb117-1817" aria-hidden="true" tabindex="-1"></a>Der Vorteil von dem R Paket <span class="in">`{afex}`</span> ist, dass wir hier mit der Funktion <span class="in">`aov_car()`</span> eine Type III ANOVA rechnen, die korrekt angepasst ist. Wir müssen also nicht noch extra ein Modell mit Kontrasten anpassen. Wir können auch die ANOVA Type II rechnen. Eine Besonderheit ist, dass wir einen Fehlerterm mit <span class="in">`Error()`</span> der Funktion übergeben müssen, damit <span class="in">`{afex}`</span> rechnen kann. Die Stärke von <span class="in">`{afex}`</span> liegt eigentlich in der repeated und mixed ANOVA. Dort brauchen wir dann die Information zwingend, welche Zeile zu welcher Beobachtung gehört.</span>
<span id="cb117-1818"><a href="#cb117-1818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1819"><a href="#cb117-1819" aria-hidden="true" tabindex="-1"></a>Interaktion zwischen den Faktoren A und B</span>
<span id="cb117-1820"><a href="#cb117-1820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1821"><a href="#cb117-1821" aria-hidden="true" tabindex="-1"></a>:   Wir rechnen dann eine Type III ANOVA, wenn wir eine Interaktion zwischen den Faktoren vorliegen haben. Die Funktion <span class="in">`aov_car()`</span> rechnet automatisch eine Type III ANOVA, wenn wir nichts anderes angeben. Das macht uns das Leben sehr viel einfacher. Wir müssen also nicht extra schauen, ob die Kontraste stimmen.</span>
<span id="cb117-1822"><a href="#cb117-1822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1825"><a href="#cb117-1825" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1826"><a href="#cb117-1826" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site <span class="sc">+</span> <span class="fu">Error</span>(.id), <span class="at">data =</span> fac2_tbl) </span>
<span id="cb117-1827"><a href="#cb117-1827" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1828"><a href="#cb117-1828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1829"><a href="#cb117-1829" aria-hidden="true" tabindex="-1"></a>An den Ergebnissen ändert sich nicht so viel. Wir haben eine signifikanten Unterschied für den Faktor <span class="in">`animal`</span> sowie für die Interaktion <span class="in">`animal:site`</span> vorliegen, da der p-Wert unter dem Signifikanzniveau $\alpha$ gleich 5% liegt.</span>
<span id="cb117-1830"><a href="#cb117-1830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1831"><a href="#cb117-1831" aria-hidden="true" tabindex="-1"></a>Keine Interaktion zwischen den Faktoren A und B</span>
<span id="cb117-1832"><a href="#cb117-1832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1833"><a href="#cb117-1833" aria-hidden="true" tabindex="-1"></a>:   Wir rechnen in <span class="in">`{afex}`</span> eine Type II ANOVA, wenn wir keine Interaktion zwischen den Faktoren vorliegen hätten. Hier müssen wir dann den Type extra angeben, damit nicht automatisch eine Type III ANOVA gerechnet wird.</span>
<span id="cb117-1834"><a href="#cb117-1834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1837"><a href="#cb117-1837" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1838"><a href="#cb117-1838" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> <span class="fu">Error</span>(.id), <span class="at">data =</span> fac2_tbl, <span class="at">type =</span> <span class="st">"II"</span>) </span>
<span id="cb117-1839"><a href="#cb117-1839" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1840"><a href="#cb117-1840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1841"><a href="#cb117-1841" aria-hidden="true" tabindex="-1"></a>Die Ergebnisse entsprechen aber hier auch der Type III ANOVA. Wir haben einen signifikanten Unterschied für den Faktor <span class="in">`animal`</span> und damit den Floharten vorliegen, da der p-Wert unter dem Signifikanzniveau $\alpha$ gleich 5% liegt. Die Messorte sind nicht signifikant.</span>
<span id="cb117-1842"><a href="#cb117-1842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1843"><a href="#cb117-1843" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{WRS2}`</span></span>
<span id="cb117-1844"><a href="#cb117-1844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1845"><a href="#cb117-1845" aria-hidden="true" tabindex="-1"></a>Jetzt wird es eigentlich wieder erst spannend. Das <span class="co">[</span><span class="ot">R Paket `{WRS2}`</span><span class="co">](https://cran.r-project.org/web/packages/WRS2/vignettes/WRS2.pdf)</span> von @mair2020robust erlaubt es auch bei nicht normalverteilten Daten sowie Varianzheterogenität eine ANOVA zu rechnen. Ja, du könntest dir auch die ganzen Vortests sparen und gleich eien ANOVA mit dem R Paket <span class="in">`{WRS2}`</span> rechnen. Da wir es aber mit einer robusten Methode zu tun haben, werden deine Daten etwas getrimmt oder beschnitten. Wenn du also zu wenige Beobachtungen in den Gruppen hast, dann ist das R Paket <span class="in">`{WRS2}`</span> nicht die beste Idee.</span>
<span id="cb117-1846"><a href="#cb117-1846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1849"><a href="#cb117-1849" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1850"><a href="#cb117-1850" aria-hidden="true" tabindex="-1"></a><span class="fu">t2way</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl)</span>
<span id="cb117-1851"><a href="#cb117-1851" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1852"><a href="#cb117-1852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1853"><a href="#cb117-1853" aria-hidden="true" tabindex="-1"></a>Wir sind am Ende aber nur am p-Wert interessiert und auch der ist hier für die Floharten <span class="in">`animal`</span> sowie der Interaktion <span class="in">`animal:site`</span> signifikant, da der p-Wert unter dem Signifikanzniveau $\alpha$ gleich 5% liegt. Wir erhalten hier keinen Effektschätzer wie bei der einfaktoriellen ANOVA. Dafür müssen wir uns nicht um die Annahmen kümmern.</span>
<span id="cb117-1854"><a href="#cb117-1854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1855"><a href="#cb117-1855" aria-hidden="true" tabindex="-1"></a><span class="fu">## Excel</span></span>
<span id="cb117-1856"><a href="#cb117-1856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1857"><a href="#cb117-1857" aria-hidden="true" tabindex="-1"></a>Ja, du kannst auch eine zweifakorielle ANOVA in Excel rechnen. Das ist dann mit etwas mehr Aufwand verbunden was die Daten angeht, aber am Ende kommt da auch was raus. Auch hier dann mehr dazu in dem folgenden Video. Ich würde es dir aber wirklich nicht empfehlen eine zweifaktorielle ANOVA in Excel zu rechen. Wirklich nicht.</span>
<span id="cb117-1858"><a href="#cb117-1858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1859"><a href="#cb117-1859" aria-hidden="true" tabindex="-1"></a>{{&lt; video https://youtu.be/ZkfRnsQkAD8 &gt;}}</span>
<span id="cb117-1860"><a href="#cb117-1860" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb117-1861"><a href="#cb117-1861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1862"><a href="#cb117-1862" aria-hidden="true" tabindex="-1"></a>Nachdem wir einmal die p-Werte aus unserer zweifaktoriellen ANOVA erhalten und dann noch geschaut haben, ob wir ein signifikantes Ergebnis haben, können wir jetzt weiter machen. Was fehlt noch? Wir müssen noch schauen, ob wir einen Effekt zwischen den Gruppen in unserem Faktoren vorliegen haben. Eine Signifikanz bedeutet ja nicht gleich Relevanz und deshalb berechnen wir auch gerne einmal einen Effektschätzer. Ein Effektschätzer sagt dir, wie stark sich die Gruppen voneinander unterscheiden. Oder anders herum formuliert, wie stark ist der Einfluss des Faktors auf den Messwert? Dann schauen wir uns noch die Möglichkeit einmal an mit dem R Paket <span class="in">`{report}`</span> eine bessere Ausgabe zu erhalten. Das funktioniert aber nicht bei allen Implementierungen.</span>
<span id="cb117-1863"><a href="#cb117-1863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1864"><a href="#cb117-1864" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb117-1865"><a href="#cb117-1865" aria-hidden="true" tabindex="-1"></a><span class="fu">## Effektschätzer</span></span>
<span id="cb117-1866"><a href="#cb117-1866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1867"><a href="#cb117-1867" aria-hidden="true" tabindex="-1"></a>Auch hier betrachten wir dann alle drei Effektschätzer $\eta^2$ (eng. *eta squared*) sowie das $\epsilon^2$ (eng. *epsilon squared*) und das $\omega^2$ (eng. *omega squared*). Hier ist dann zu beachten, dass das $\eta^2$ für mehrere Faktoren nicht mehr so gut den Anteil der Varianz, die duch die Behandlung erklärt wird, wiedergibt. Hier ist dann das $\epsilon^2$ sowie das $\omega^2$ besser geeignet. Die Interpretation ist gleich, aber wir haben eine bessere Schätzung der Werte unter Berücksichtigung der zwei Faktoren und der Interaktion. Die 95% Konfidenzintervalle sind meiner Meinung nach schwer zu interpretieren, wenn die Fallzahl klein ist.</span>
<span id="cb117-1868"><a href="#cb117-1868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1871"><a href="#cb117-1871" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1872"><a href="#cb117-1872" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-1873"><a href="#cb117-1873" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-1874"><a href="#cb117-1874" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1875"><a href="#cb117-1875" aria-hidden="true" tabindex="-1"></a>  <span class="fu">eta_squared</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-1876"><a href="#cb117-1876" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interpret_eta_squared</span>(<span class="at">rules =</span> <span class="st">"field2013"</span>)</span>
<span id="cb117-1877"><a href="#cb117-1877" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1878"><a href="#cb117-1878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1879"><a href="#cb117-1879" aria-hidden="true" tabindex="-1"></a>Wir nehmen hier die Regeln nach @field2013discovering um zu entscheiden, wie bedeutend der Wert von $\eta^2$ ist. Hier kommt es dann aber auch auf das Experiment an. In einem geplanten Feldexperiment, wo nur die Gruppen variieren, sollte $\eta^2$ größer als 70% sein.</span>
<span id="cb117-1880"><a href="#cb117-1880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1881"><a href="#cb117-1881" aria-hidden="true" tabindex="-1"></a>Dann schauen wir uns noch das $\epsilon^2$ einmal an. Auch hier haben wir ähnliche Werte. Der größte Teil der Varianz in unseren Sprungweiten, nähmlich fast 50%, wird von den Floharten erklärt. Der Rest fällt dann auf die Interaktion.</span>
<span id="cb117-1882"><a href="#cb117-1882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1885"><a href="#cb117-1885" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1886"><a href="#cb117-1886" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-1887"><a href="#cb117-1887" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-1888"><a href="#cb117-1888" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1889"><a href="#cb117-1889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">epsilon_squared</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-1890"><a href="#cb117-1890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interpret_epsilon_squared</span>(<span class="at">rules =</span> <span class="st">"field2013"</span>)</span>
<span id="cb117-1891"><a href="#cb117-1891" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1892"><a href="#cb117-1892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1893"><a href="#cb117-1893" aria-hidden="true" tabindex="-1"></a>Das $\omega^2$ berücksichtigt die Faktoren besser und adjustiert für die drei Berechnungen des $\omega^2$-Wertes für den Faktor <span class="in">`animal`</span> sowie <span class="in">`site`</span> und der Interaktion. Bei mehr als einem Faktor ist dann das $\omega^2$ vorzuziehen. Hier ist dann der erklärte Anteil der Varianz der Floharten auch etwas niedriger und nur noch bei 45%.</span>
<span id="cb117-1894"><a href="#cb117-1894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1897"><a href="#cb117-1897" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1898"><a href="#cb117-1898" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-1899"><a href="#cb117-1899" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-1900"><a href="#cb117-1900" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1901"><a href="#cb117-1901" aria-hidden="true" tabindex="-1"></a>  <span class="fu">omega_squared</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-1902"><a href="#cb117-1902" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interpret_omega_squared</span>(<span class="at">rules =</span> <span class="st">"field2013"</span>)</span>
<span id="cb117-1903"><a href="#cb117-1903" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1904"><a href="#cb117-1904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1905"><a href="#cb117-1905" aria-hidden="true" tabindex="-1"></a><span class="fu">## R Paket `{report}`</span></span>
<span id="cb117-1906"><a href="#cb117-1906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1907"><a href="#cb117-1907" aria-hidden="true" tabindex="-1"></a>Das <span class="co">[</span><span class="ot">R Paket `{report}`</span><span class="co">](https://easystats.github.io/report/)</span> liefert nochmal die Möglichkeit sich die Ausgabe einer zweifaktoriellen ANOVA in Textform wiedergeben zu lassen. Wie immer, wenn man alleine vor dem Rechner sitzt, ist das doch eine super Hilfestellung. Hier dann einmal mit der <span class="in">`Anova()`</span> Funktion aus dem R Paket <span class="in">`{car}`</span>. Ich mag hier besonders die Hilfe bei einer zweifaktoriellen ANOVA. Hier wird es dann sehr schnell sehr unübersichtlich und da ist doch die <span class="in">`report()`</span> Funktion hilfreich.</span>
<span id="cb117-1908"><a href="#cb117-1908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1911"><a href="#cb117-1911" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1912"><a href="#cb117-1912" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1913"><a href="#cb117-1913" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-1914"><a href="#cb117-1914" aria-hidden="true" tabindex="-1"></a>  <span class="fu">report</span>()</span>
<span id="cb117-1915"><a href="#cb117-1915" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1916"><a href="#cb117-1916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1917"><a href="#cb117-1917" aria-hidden="true" tabindex="-1"></a>Dann können wir uns die Ergebnistabelle der ANOVA nochmal schöner mit der Funktion <span class="in">`report_table()`</span> wiedergeben lassen. Wie immer funktioniert das Paket <span class="in">`{report}`</span> nicht mit jeder Implementierung der ANOVA.</span>
<span id="cb117-1918"><a href="#cb117-1918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1921"><a href="#cb117-1921" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1922"><a href="#cb117-1922" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1923"><a href="#cb117-1923" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-1924"><a href="#cb117-1924" aria-hidden="true" tabindex="-1"></a>  <span class="fu">report_table</span>()</span>
<span id="cb117-1925"><a href="#cb117-1925" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1926"><a href="#cb117-1926" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb117-1927"><a href="#cb117-1927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1928"><a href="#cb117-1928" aria-hidden="true" tabindex="-1"></a>Wenn du die ANOVA in deiner Abschlussarbeit anwendest, musst du jetzt noch schauen, welche paarweisen Gruppenvergleiche in deinem Faktor signifikant sind. Das würden wir dann in einem Post-hoc Test am Ende machen. Das war dann auch schon fast mit der zweifaktoriellen ANOVA, wenn es nicht noch die Interaktion zwischen den beiden Faktoren geben würde. Hier werfen wir dann nochmal einen Blick drauf.</span>
<span id="cb117-1929"><a href="#cb117-1929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1930"><a href="#cb117-1930" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interaktion</span></span>
<span id="cb117-1931"><a href="#cb117-1931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1932"><a href="#cb117-1932" aria-hidden="true" tabindex="-1"></a>In dem theoretischen Hintergrund habe ich dir verschiedene Arten gezeigt sich die Interaktion zu visualiseren. Ich nutze jetzt hier nur das Liniendiagramm in <span class="in">`{ggplot}`</span> und dann noch die Darstellung aus dem <span class="co">[</span><span class="ot">R Paket `{interactions}`</span><span class="co">](https://interactions.jacob-long.com/)</span>. Ebenso habe ich die Beschreibung der Abbildungen auf das wesentliche reduziert. Selten zeigst du diese Abbildungen prominent sondern eher im Anhang oder du nutzt diese Abbidlungen nur in deiner statistischen Analyse. Ich jedenfalls schaue mir gerne die Interaktion einmal an und vergleiche so die Abbildung mit den Ergebnissen einer ANOVA. Beides muss immer zusammenpassen.</span>
<span id="cb117-1933"><a href="#cb117-1933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1934"><a href="#cb117-1934" aria-hidden="true" tabindex="-1"></a>Was ist das Problem einer Interaktion?</span>
<span id="cb117-1935"><a href="#cb117-1935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1936"><a href="#cb117-1936" aria-hidden="true" tabindex="-1"></a>:   Wenn du eine Interaktion zwischen deinen beiden Faktoren vorliegen hast, dann kannst du keine allgemeine Aussage über die Gruppen der beiden Faktoren treffen. Die Effekte und Unterschiede, die du nachweist, hängen davon ab welche Faktorkombination du betrachtest. Manchmal willst du eien solche Interaktion zeigen, aber häufig wird eine Interaktion als störend in einem Experiment wahrgenommen.</span>
<span id="cb117-1937"><a href="#cb117-1937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1938"><a href="#cb117-1938" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb117-1939"><a href="#cb117-1939" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{ggplot}`</span></span>
<span id="cb117-1940"><a href="#cb117-1940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1941"><a href="#cb117-1941" aria-hidden="true" tabindex="-1"></a>Betrachten wir also einmal die Interaktion zwischen den beiden Faktoren <span class="in">`animal`</span> und <span class="in">`site`</span> anhand eines Liniendiagramms welches uns die Mittelwerte aller sechs Faktorkombinationen zeigt. Wenn wir *keine* Interaktion vorliegen haben, dann laufen die Linien parallel zueinander. Wenn wir *eine* Interaktion vorliegen haben, dann beginnen sich die Linien anzunähern oder bewegen sich voneinander weg. Bei einer starken Interaktion kreuzen sich die Geraden. Wir du in der folgenden Abbildung sehen kannst, haben wir eine starke Interaktion zwischen unseren beiden Faktoren vorliegen. Die Floharten verhalten sich nicht gleich über die beiden Messorte. Es macht eben einen Unterschied wo du die Floharten misst.</span>
<span id="cb117-1942"><a href="#cb117-1942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1945"><a href="#cb117-1945" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1946"><a href="#cb117-1946" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-1947"><a href="#cb117-1947" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb117-1948"><a href="#cb117-1948" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-1949"><a href="#cb117-1949" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-interactionplot-1</span></span>
<span id="cb117-1950"><a href="#cb117-1950" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-1951"><a href="#cb117-1951" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.5</span></span>
<span id="cb117-1952"><a href="#cb117-1952" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb117-1953"><a href="#cb117-1953" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Liniendigramm mit den Mittelwerten aller sechs Faktorkombinationen der beiden Faktoren `animal` und `site`. Die Linien kreuzen sich, es liegt eine starke Interaktion vor. Eine allgmeine Aussage über die Sprungweite und die Flohart lässt sich nicht unabhängig vom Messort treffen."</span></span>
<span id="cb117-1954"><a href="#cb117-1954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1955"><a href="#cb117-1955" aria-hidden="true" tabindex="-1"></a>fac2_tbl <span class="sc">|&gt;</span> </span>
<span id="cb117-1956"><a href="#cb117-1956" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length,</span>
<span id="cb117-1957"><a href="#cb117-1957" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> site, <span class="at">group =</span> site)) <span class="sc">+</span></span>
<span id="cb117-1958"><a href="#cb117-1958" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb117-1959"><a href="#cb117-1959" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb117-1960"><a href="#cb117-1960" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb117-1961"><a href="#cb117-1961" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span>
<span id="cb117-1962"><a href="#cb117-1962" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1963"><a href="#cb117-1963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1964"><a href="#cb117-1964" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{interactions}`</span></span>
<span id="cb117-1965"><a href="#cb117-1965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1966"><a href="#cb117-1966" aria-hidden="true" tabindex="-1"></a>Neben der händsich gebauten Variante in <span class="in">`{ggplot}`</span> gibt es auch das <span class="co">[</span><span class="ot">R Paket `{interactions}`</span><span class="co">](https://interactions.jacob-long.com/)</span> mit der Funktion <span class="in">`car_plot()`</span>. Hier übergeben wir ein Modell und erhalten dann aus dem Modell ein Liniendiagramm zur Bewertung der Interaktion. Wie immer kann das Paket mehr als diese eine Funktion. Aber hier soll es dann erstmal so reichen. Die Funktion erstellt dann noch Fehlerbalken, die meiner Meinung nach nicht sein müssten, aber ich lasse diese mal hier mit drin. Die Aussage ist aber die gleiche wie bei <span class="in">`{ggplot}`</span>, die Linien kreuzen sich, es ist von einer starken Interaktion auszugehen. Eine allgemeine Aussage über die Sprungweite und die Floharten ist nicht möglich ohne die Betrachtung des jeweiligen Messortes.</span>
<span id="cb117-1967"><a href="#cb117-1967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1970"><a href="#cb117-1970" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-1971"><a href="#cb117-1971" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-1972"><a href="#cb117-1972" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb117-1973"><a href="#cb117-1973" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-1974"><a href="#cb117-1974" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-interactionplot-2</span></span>
<span id="cb117-1975"><a href="#cb117-1975" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-1976"><a href="#cb117-1976" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.5</span></span>
<span id="cb117-1977"><a href="#cb117-1977" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb117-1978"><a href="#cb117-1978" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Liniendigramm mit den Mittelwerten aller sechs Faktorkombinationen der beiden Faktoren `animal` und `site`. Die Linien kreuzen sich, es liegt eine starke Interaktion vor. Eine allgmeine Aussage über die Sprungweite und die Flohart lässt sich nicht aunabhängig vom Messort treffen."</span></span>
<span id="cb117-1979"><a href="#cb117-1979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1980"><a href="#cb117-1980" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-1981"><a href="#cb117-1981" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat_plot</span>(<span class="at">modx =</span> site, <span class="at">pred =</span> animal, <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb117-1982"><a href="#cb117-1982" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb117-1983"><a href="#cb117-1983" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span>
<span id="cb117-1984"><a href="#cb117-1984" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-1985"><a href="#cb117-1985" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb117-1986"><a href="#cb117-1986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1987"><a href="#cb117-1987" aria-hidden="true" tabindex="-1"></a>Das war dann auch die zweifaktorielle ANOVA. Wenn du die ANOVA in deiner Abschlussarbeit anwendest, musst du jetzt noch schauen, welche paarweisen Gruppenvergleiche in deinen Faktoren signifikant sind. Jetzt könnte man sagen, dafür brauchst du eine signifikante ANOVA, aber meistens machen wir dann doch den ANOVA Pfad zu Ende und testen nochmal alles mit einem <span class="co">[</span><span class="ot">Post-hoc Test</span><span class="co">](#sec-posthoc)</span> durch.</span>
<span id="cb117-1988"><a href="#cb117-1988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1989"><a href="#cb117-1989" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mehrfaktorielle ANOVA</span></span>
<span id="cb117-1990"><a href="#cb117-1990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1991"><a href="#cb117-1991" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb117-1992"><a href="#cb117-1992" aria-hidden="true" tabindex="-1"></a><span class="fu">## Achtung, bitte beachten!</span></span>
<span id="cb117-1993"><a href="#cb117-1993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1994"><a href="#cb117-1994" aria-hidden="true" tabindex="-1"></a>Die Erfahrung aus meiner statistischen Beratung zeigt oft, dass du gar keine mehrfaktorielle ANOVA im eigentlichen Sinne vorliegen hast, sondern manchmal in den Daten und den Faktoren verloren bist. Deshalb empfiehlt es sich hier nochmal innezuhalten und zu überlegen, was deine Fragestellung ist und du *wirklich* alle Faktoren und deren Wechselwirkungen mit ins Modell nehmen willst.</span>
<span id="cb117-1995"><a href="#cb117-1995" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb117-1996"><a href="#cb117-1996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1997"><a href="#cb117-1997" aria-hidden="true" tabindex="-1"></a>Wenn es die zweifaktorielle ANOVA gibt dann gibt es natürlich auch noch mehr als nur zwei Faktoren in einer ANOVA. Wir können auch eine mherfaktorielle ANOVA rechnen. Ich habe hier einen vierfaktoriellen Datensatz, den wir uns aber als einen dreifaktoriellen Datensatz in <span class="in">`{WRS2}`</span> anschauen werden. Nicht jedes Paket kann mit mehr als drei Faktoren umgehen. Das hat den Grund, dass eigentlich in der Anwendung kaum Designs mit mehr als drei Behandlungsfaktoren auftreten. Die zusätzlichen Faktoren sind dann meistens Randomisierungseinheiten wie Block oder Spalte sowie Zeile.</span>
<span id="cb117-1998"><a href="#cb117-1998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-1999"><a href="#cb117-1999" aria-hidden="true" tabindex="-1"></a>Habe ich wirklich mehr als drei Behandlungsfaktoren?</span>
<span id="cb117-2000"><a href="#cb117-2000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2001"><a href="#cb117-2001" aria-hidden="true" tabindex="-1"></a>:   Das ist eine *sehr wichtige* Frage. Häufig kann es sein, dass du eben wirklich eine zeitliche Komponente als Fakotr mit in deeinen Daten hast. Dann willst du vielleicht eine <span class="co">[</span><span class="ot">repeated ANOVA oder eine mixed ANOVA</span><span class="co">](#sec-anova-mixed)</span> rechnen. Manchmal haben wir auch eine lokale Komponente mit drin, dann ist die Frage, ob du hier nicht über den Ort mittlen willst. Deshalb muss man hier immer sehr genau schauen, was ist eigentlich die wissenschaftliche Fragestellung und was habe ich in den Daten.</span>
<span id="cb117-2002"><a href="#cb117-2002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2003"><a href="#cb117-2003" aria-hidden="true" tabindex="-1"></a>Wir schauen usn als mehrfaktoriellen Datensatz jetzt einmal eine große Studie zu der Sprungweite von Floharten <span class="in">`animal`</span> in verschiedenen Orten <span class="in">`site`</span> sowie verschiedenen Entwicklungsstadien <span class="in">`stage`</span> an. Dann messen wir alles nochmal im Sommer und im Winter und haben so noch den Faktor <span class="in">`season`</span> mit in unserem Modell. Teilweise wird es jetzt in den verschiedenen Implementierungen recht wild, aber das liegt eben daran, dass so eine vierfaktorielle ANOVA eben dann doch schon ein echtes Extrem ist. Insbesondere bei der mehrfaktroiellen ANOVA bietet es sich an die Ergebnisse mit der Funktion <span class="in">`filter()`</span> nach den signifikanten p-Werten zu filtern, so dass alles übersichtlicher bleibt.</span>
<span id="cb117-2004"><a href="#cb117-2004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2005"><a href="#cb117-2005" aria-hidden="true" tabindex="-1"></a><span class="fu">### Haupteffekte</span></span>
<span id="cb117-2006"><a href="#cb117-2006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2007"><a href="#cb117-2007" aria-hidden="true" tabindex="-1"></a>In unserem Fall haben wir jetzt vier Haupteffekte. Das ist eher selten der Fall und man könnte auch meinen, dass die Modellierung der Jahreszeiten oder aber der Messorte so nicht unbedingt nötig ist, aber da wir auch nur zwei Jahreszeiten sowie zwei Messorte haben, machen wir das jetzt mal so. In der Praxis haben wir dann bei so vielen Faktoren dann nicht noch sehr viele Level pro Faktor. Denke an die Regel, dass du eben nur weißt, dass wir einen Gruppenunterschied irgendwo im Faktor haben, wenn der p-Wert kleiner als das Signifikanzniveau $\alpha$ gleich 5% ist.</span>
<span id="cb117-2008"><a href="#cb117-2008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2009"><a href="#cb117-2009" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb117-2010"><a href="#cb117-2010" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{base}`</span></span>
<span id="cb117-2011"><a href="#cb117-2011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2012"><a href="#cb117-2012" aria-hidden="true" tabindex="-1"></a>Dann wollen wir mal anfangen. Ich zeige jetzt hier nur die <span class="in">`aov()`</span> Variante. Du findest dann bei der zweifaktoriellen ANOVA auch den Code für die <span class="in">`lm()`</span> Variante mit der Funktion <span class="in">`anova()`</span>. Hier wird das dann aber viel zu viel Output, der dann einfach gleich ist. Darüber hinaus findest du die Modellierung dann auch im Tab zum R Paket <span class="in">`{car}`</span>. Ich schreibe hier einmal die Modellschreibweise mit dem Malzeichen <span class="in">`*`</span> da ich selber nie und nimmer alle Faktorkombinationen hinkriege noch tippen will. Bedenke hier, es kommt bei der <span class="in">`aov()`</span> auf die Reihenfolge der Faktoren an. Wir haben ja hier eine Type I ANOVA vorliegen.</span>
<span id="cb117-2013"><a href="#cb117-2013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2016"><a href="#cb117-2016" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-2017"><a href="#cb117-2017" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>stage<span class="sc">*</span>site<span class="sc">*</span>season, <span class="at">data =</span> fac4_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-2018"><a href="#cb117-2018" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-2019"><a href="#cb117-2019" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value))</span>
<span id="cb117-2020"><a href="#cb117-2020" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-2021"><a href="#cb117-2021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2022"><a href="#cb117-2022" aria-hidden="true" tabindex="-1"></a>Wir treten einen Schritt zurück und erschaudern bei dem Output. Hier hilft es dann wirklich nochmal die Funktion <span class="in">`filter()`</span> und <span class="in">`select()`</span> zu nutzen um sich einen kleineren Datensatz mit den wichtigen Informationen zu bauen. Ich sehe da sonst nichts mehr und wir übersehen dann mal schnell einen signifikanten p-Wert und das wäre ja nicht so gut.</span>
<span id="cb117-2023"><a href="#cb117-2023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2026"><a href="#cb117-2026" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-2027"><a href="#cb117-2027" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>stage<span class="sc">*</span>site<span class="sc">*</span>season, <span class="at">data =</span> fac4_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-2028"><a href="#cb117-2028" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-2029"><a href="#cb117-2029" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p.value <span class="sc">&lt;=</span> <span class="fl">0.05</span>) <span class="sc">|&gt;</span> </span>
<span id="cb117-2030"><a href="#cb117-2030" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, p.value) <span class="sc">|&gt;</span> </span>
<span id="cb117-2031"><a href="#cb117-2031" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value)) </span>
<span id="cb117-2032"><a href="#cb117-2032" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-2033"><a href="#cb117-2033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2034"><a href="#cb117-2034" aria-hidden="true" tabindex="-1"></a>Was sehen wir jetzt? Zum einen, dass wir signifikante Haupteffekte vorliegen haben. Der Entwicklungsstatus ist als einiziges nicht signifikant. Darüber hinaus haben wir noch eine Menge signifikante Interaktionen. Das schauen wir uns dann nochmal separat in dem Abschnitt zu den Interaktionen weiter unten an.</span>
<span id="cb117-2035"><a href="#cb117-2035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2036"><a href="#cb117-2036" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{car}`</span></span>
<span id="cb117-2037"><a href="#cb117-2037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2038"><a href="#cb117-2038" aria-hidden="true" tabindex="-1"></a>Jetzt könnte man meinen, warum noch eine weitere Implementierung der ANOVA, wenn wir schon die Funktion <span class="in">`aov()`</span> haben? Die Funktion <span class="in">`aov()`</span> rechnet grundsätzlich Type I ANOVAs. Das macht jetzt bei einer mehrfaktoriellen ANOVA schon einen gewaltigen Unterschied ausmachen welchen Typ ANOVA wir rechnen. Wir können eben in <span class="in">`{car}`</span> auch Type II und Type III ANOVAs rechnen. Darüber hinaus erlaubt das Paket auch für Varianzheterogenität in der ANOVA zu adjustieren.</span>
<span id="cb117-2039"><a href="#cb117-2039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2040"><a href="#cb117-2040" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Varianzhomogenität {.unnumbered .unlisted}</span></span>
<span id="cb117-2041"><a href="#cb117-2041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2042"><a href="#cb117-2042" aria-hidden="true" tabindex="-1"></a>In dem klassischen Aufruf der Funktion <span class="in">`Anova()`</span> nutzen wir ein Modell und dann gebe ich dir wieder die aufgeräumte Ausgabe mit <span class="in">`tidy()`</span> wieder. Wenn du nichts extra angibst, dann rechnest du natürlich eine ANOVA unter der Annahme der Varianzhomogenität.</span>
<span id="cb117-2043"><a href="#cb117-2043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2044"><a href="#cb117-2044" aria-hidden="true" tabindex="-1"></a>Keine Interaktion zwischen den Faktoren A und B</span>
<span id="cb117-2045"><a href="#cb117-2045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2046"><a href="#cb117-2046" aria-hidden="true" tabindex="-1"></a>:   Wir rechnen dann eine Type II ANOVA, wenn wir keine Interaktion zwischen den Faktoren vorliegen haben. Ja, dass müssen wir dann natürlich vorab einmal Testen, dazu kannst du einfach die Funktion <span class="in">`aov()`</span> nutzen. Wenn wir keine Interaktion vorliegen haben, dann nehmen wir auch die Interaktion aus dem Modell und testen nur die Haupteffekte mit einer Type II ANOVA. Manchmal ist das ganz gut, damit wir überhaupt mal eine Übersicht kriegen.</span>
<span id="cb117-2047"><a href="#cb117-2047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2050"><a href="#cb117-2050" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-2051"><a href="#cb117-2051" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> stage <span class="sc">+</span> site <span class="sc">+</span> season, <span class="at">data =</span> fac4_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-2052"><a href="#cb117-2052" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>(<span class="at">type =</span> <span class="st">"II"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb117-2053"><a href="#cb117-2053" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()  <span class="sc">|&gt;</span> </span>
<span id="cb117-2054"><a href="#cb117-2054" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value))</span>
<span id="cb117-2055"><a href="#cb117-2055" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-2056"><a href="#cb117-2056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2057"><a href="#cb117-2057" aria-hidden="true" tabindex="-1"></a>Interaktion zwischen den Faktoren A und B</span>
<span id="cb117-2058"><a href="#cb117-2058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2059"><a href="#cb117-2059" aria-hidden="true" tabindex="-1"></a>:   Wir rechnen dann eine Type III ANOVA, wenn wir eine Interaktion zwischen den beiden Faktoren vorliegen haben. Dann werden die Haupteffekte unter der Berücksichtigung der Interaktion berechnet. Aber Achtung, du musst leider in <span class="in">`{car}`</span> die Kontraste anders definieren sonst testet die Funktion <span class="in">`Anova()`</span> nicht das was sie soll. Da ist dann die Funktion <span class="in">`aov_car()`</span> aus dem Paket <span class="in">`{afex}`</span> anwenderfreundlicher.</span>
<span id="cb117-2060"><a href="#cb117-2060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2063"><a href="#cb117-2063" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-2064"><a href="#cb117-2064" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>stage<span class="sc">*</span>site<span class="sc">*</span>season, <span class="at">data =</span> fac4_tbl,</span>
<span id="cb117-2065"><a href="#cb117-2065" aria-hidden="true" tabindex="-1"></a>    <span class="at">contrasts =</span> <span class="fu">list</span>(</span>
<span id="cb117-2066"><a href="#cb117-2066" aria-hidden="true" tabindex="-1"></a>    <span class="at">animal =</span> <span class="st">"contr.sum"</span>,</span>
<span id="cb117-2067"><a href="#cb117-2067" aria-hidden="true" tabindex="-1"></a>    <span class="at">stage =</span> <span class="st">"contr.sum"</span>,</span>
<span id="cb117-2068"><a href="#cb117-2068" aria-hidden="true" tabindex="-1"></a>    <span class="at">site =</span> <span class="st">"contr.sum"</span>,</span>
<span id="cb117-2069"><a href="#cb117-2069" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="st">"contr.sum"</span></span>
<span id="cb117-2070"><a href="#cb117-2070" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb117-2071"><a href="#cb117-2071" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>(<span class="at">type =</span> <span class="st">"III"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb117-2072"><a href="#cb117-2072" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()  <span class="sc">|&gt;</span> </span>
<span id="cb117-2073"><a href="#cb117-2073" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value))</span>
<span id="cb117-2074"><a href="#cb117-2074" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-2075"><a href="#cb117-2075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2076"><a href="#cb117-2076" aria-hidden="true" tabindex="-1"></a>Auch hier hilft ein Filtern weiter. Ansonsten sieht man echt überhaupt nichts und wir kommen nur durcheinander. Was du auf jeden Fall schon mal siehst, wenn es mehr Faktoren werden, dann macht der Typ der ANOVA schon was aus. Wir haben hier am Ende aber die gleichen signifikanten Ergebnisse wie bei der <span class="in">`aov()`</span> vorliegen.</span>
<span id="cb117-2077"><a href="#cb117-2077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2080"><a href="#cb117-2080" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-2081"><a href="#cb117-2081" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>stage<span class="sc">*</span>site<span class="sc">*</span>season, <span class="at">data =</span> fac4_tbl,</span>
<span id="cb117-2082"><a href="#cb117-2082" aria-hidden="true" tabindex="-1"></a>    <span class="at">contrasts =</span> <span class="fu">list</span>(</span>
<span id="cb117-2083"><a href="#cb117-2083" aria-hidden="true" tabindex="-1"></a>    <span class="at">animal =</span> <span class="st">"contr.sum"</span>,</span>
<span id="cb117-2084"><a href="#cb117-2084" aria-hidden="true" tabindex="-1"></a>    <span class="at">stage =</span> <span class="st">"contr.sum"</span>,</span>
<span id="cb117-2085"><a href="#cb117-2085" aria-hidden="true" tabindex="-1"></a>    <span class="at">site =</span> <span class="st">"contr.sum"</span>,</span>
<span id="cb117-2086"><a href="#cb117-2086" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="st">"contr.sum"</span></span>
<span id="cb117-2087"><a href="#cb117-2087" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb117-2088"><a href="#cb117-2088" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>(<span class="at">type =</span> <span class="st">"III"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb117-2089"><a href="#cb117-2089" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-2090"><a href="#cb117-2090" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p.value <span class="sc">&lt;=</span> <span class="fl">0.05</span>) <span class="sc">|&gt;</span> </span>
<span id="cb117-2091"><a href="#cb117-2091" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, p.value) <span class="sc">|&gt;</span> </span>
<span id="cb117-2092"><a href="#cb117-2092" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value)) </span>
<span id="cb117-2093"><a href="#cb117-2093" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-2094"><a href="#cb117-2094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2095"><a href="#cb117-2095" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Varianzheterogenität {.unnumbered .unlisted}</span></span>
<span id="cb117-2096"><a href="#cb117-2096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2097"><a href="#cb117-2097" aria-hidden="true" tabindex="-1"></a>Der Vorteil des Pakets <span class="in">`{car}`</span> ist, dass wir in der Funktion <span class="in">`Anova()`</span> auch für Varianzheterogenität adjustieren können. Wir nutzen dazu die Option <span class="in">`white.adjust = TRUE`</span>. Ich gehe hier jetzt nicht näher auf die Ausgabe ein. Die Ausgabe ist analog zu den anderen Ergebnissen zu interpretieren. Ich habe hier jetzt gleich gefiltert damit die Ausgabe etwas aufgeräumter ist.</span>
<span id="cb117-2098"><a href="#cb117-2098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2101"><a href="#cb117-2101" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-2102"><a href="#cb117-2102" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>stage<span class="sc">*</span>site<span class="sc">*</span>season, <span class="at">data =</span> fac4_tbl,</span>
<span id="cb117-2103"><a href="#cb117-2103" aria-hidden="true" tabindex="-1"></a>    <span class="at">contrasts =</span> <span class="fu">list</span>(</span>
<span id="cb117-2104"><a href="#cb117-2104" aria-hidden="true" tabindex="-1"></a>    <span class="at">animal =</span> <span class="st">"contr.sum"</span>,</span>
<span id="cb117-2105"><a href="#cb117-2105" aria-hidden="true" tabindex="-1"></a>    <span class="at">stage =</span> <span class="st">"contr.sum"</span>,</span>
<span id="cb117-2106"><a href="#cb117-2106" aria-hidden="true" tabindex="-1"></a>    <span class="at">site =</span> <span class="st">"contr.sum"</span>,</span>
<span id="cb117-2107"><a href="#cb117-2107" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="st">"contr.sum"</span></span>
<span id="cb117-2108"><a href="#cb117-2108" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb117-2109"><a href="#cb117-2109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>(<span class="at">white.adjust =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="st">"III"</span>)  <span class="sc">|&gt;</span> </span>
<span id="cb117-2110"><a href="#cb117-2110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-2111"><a href="#cb117-2111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p.value <span class="sc">&lt;=</span> <span class="fl">0.05</span>) <span class="sc">|&gt;</span> </span>
<span id="cb117-2112"><a href="#cb117-2112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, p.value) <span class="sc">|&gt;</span> </span>
<span id="cb117-2113"><a href="#cb117-2113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value)) </span>
<span id="cb117-2114"><a href="#cb117-2114" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-2115"><a href="#cb117-2115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2116"><a href="#cb117-2116" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{afex}`</span></span>
<span id="cb117-2117"><a href="#cb117-2117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2118"><a href="#cb117-2118" aria-hidden="true" tabindex="-1"></a>Der Vorteil von dem R Paket <span class="in">`{afex}`</span> ist, dass wir hier mit der Funktion <span class="in">`aov_car()`</span> eine Type III ANOVA rechnen, die korrekt angepasst ist. Wir müssen also nicht noch extra ein Modell mit Kontrasten anpassen. Wir können auch die ANOVA Type II rechnen indem wir di Option <span class="in">`type = "II"`</span> wählen. Dazu dann einfach einmal bei der zweifaktoriellen ANOVA reinschauen, da zeige ich den Code dazu. Eine Besonderheit ist, dass wir einen Fehlerterm mit <span class="in">`Error()`</span> der Funktion übergeben müssen, damit <span class="in">`{afex}`</span> rechnen kann. Die Stärke von <span class="in">`{afex}`</span> liegt eigentlich in der repeated und mixed ANOVA. Dort brauchen wir dann die Information zwingend, welche Zeile zu welcher Beobachtung gehört. Ich verzichte hier auf die Aufteilung mit und ohne Interaktion.</span>
<span id="cb117-2119"><a href="#cb117-2119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2122"><a href="#cb117-2122" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-2123"><a href="#cb117-2123" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>stage<span class="sc">*</span>site<span class="sc">*</span>season <span class="sc">+</span> <span class="fu">Error</span>(.id), </span>
<span id="cb117-2124"><a href="#cb117-2124" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> fac4_tbl) </span>
<span id="cb117-2125"><a href="#cb117-2125" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-2126"><a href="#cb117-2126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2127"><a href="#cb117-2127" aria-hidden="true" tabindex="-1"></a>Ja, dann ist das Filtern der <span class="in">`{afex}`</span> Ausgabe dann doch etwas nerviger als gedacht. Dennoch solltest du das tun, denn dann sehen wir besser, was hier eigentlich signifikant ist. Die Ausgabe von <span class="in">`aov_car()`</span> kürzt so seltsam die p-Werte, so dass es noch unübersichtlicher wird für mich. Die Ausgabe ist dann wie immer zu interpretieren nur das wir eben schon alle signifkanten p-Werte gefiltert haben.</span>
<span id="cb117-2128"><a href="#cb117-2128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2131"><a href="#cb117-2131" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-2132"><a href="#cb117-2132" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>stage<span class="sc">*</span>site<span class="sc">*</span>season <span class="sc">+</span> <span class="fu">Error</span>(.id), </span>
<span id="cb117-2133"><a href="#cb117-2133" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> fac4_tbl) <span class="sc">|&gt;</span>  </span>
<span id="cb117-2134"><a href="#cb117-2134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"anova_table"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb117-2135"><a href="#cb117-2135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"term"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb117-2136"><a href="#cb117-2136" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-2137"><a href="#cb117-2137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pr_f <span class="sc">&lt;=</span> <span class="fl">0.05</span>) <span class="sc">|&gt;</span> </span>
<span id="cb117-2138"><a href="#cb117-2138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, pr_f) <span class="sc">|&gt;</span> </span>
<span id="cb117-2139"><a href="#cb117-2139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pr_f =</span> <span class="fu">pvalue</span>(pr_f)) </span>
<span id="cb117-2140"><a href="#cb117-2140" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-2141"><a href="#cb117-2141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2142"><a href="#cb117-2142" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{WRS2}`</span></span>
<span id="cb117-2143"><a href="#cb117-2143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2144"><a href="#cb117-2144" aria-hidden="true" tabindex="-1"></a>Das <span class="co">[</span><span class="ot">R Paket `{WRS2}`</span><span class="co">](https://cran.r-project.org/web/packages/WRS2/vignettes/WRS2.pdf)</span> von @mair2020robust erlaubt es auch bei nicht normalverteilten Daten sowie Varianzheterogenität eine ANOVA zu rechnen. Dabei ist die maximale Anzahl an Faktoren auf drei Faktoren begrenzt. Daher können wir auch nur eine dreifaktorielle ANOVA (eng. *three-way ANOVA*) rechnen. Ich habe mich dazu entschieden dann die Entwicklungsstatdien aus dem Modell zu nehmen, da diese ja in den anderen Implementierungen nicht signifikant waren. Daher kann es sich lohnen mal mit den Implementierungen zu spielen und zu schauen, was da so rauskommt.</span>
<span id="cb117-2145"><a href="#cb117-2145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2148"><a href="#cb117-2148" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-2149"><a href="#cb117-2149" aria-hidden="true" tabindex="-1"></a><span class="fu">t3way</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>site<span class="sc">*</span>season, <span class="at">data =</span> fac4_tbl)</span>
<span id="cb117-2150"><a href="#cb117-2150" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-2151"><a href="#cb117-2151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2152"><a href="#cb117-2152" aria-hidden="true" tabindex="-1"></a>In dem dreifaktoriellen Fall bleibt ja die Ergebnistabelle relativ übersichtlich. Wir sehen hier ähnliche Ergebnisse wie bei den anderen Implementierungen und die Entscheidungen nach dem p-Wert bleiben auch hier gleich. Einzig die Interaktionen zwischen den Jahreszeiten und Floharten sowie dem Messort sind nicht signifikant.</span>
<span id="cb117-2153"><a href="#cb117-2153" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb117-2154"><a href="#cb117-2154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2155"><a href="#cb117-2155" aria-hidden="true" tabindex="-1"></a>Nachdem wir einmal die p-Werte aus unserer mehrfaktoriellen ANOVA erhalten und dann noch geschaut haben, ob wir ein signifikantes Ergebnis haben, können wir jetzt weiter machen. Was fehlt noch? Wir müssen noch schauen, ob wir einen Effekt zwischen den Gruppen in unserem Faktoren vorliegen haben. Eine Signifikanz bedeutet ja nicht gleich Relevanz und deshalb berechnen wir auch gerne einmal einen Effektschätzer. Ein Effektschätzer sagt dir, wie stark sich die Gruppen voneinander unterscheiden. Oder anders herum formuliert, wie stark ist der Einfluss des Faktors auf den Messwert? Dann schauen wir uns noch die Möglichkeit einmal an mit dem R Paket <span class="in">`{report}`</span> eine bessere Ausgabe zu erhalten. Das funktioniert aber nicht bei allen Implementierungen. Insbesondere in einer mehrfaktoriellen ANOVA ist es jetzt wichtig zu schauen, ob die Interaktionen überhaupt eine Bedeutung haben oder wir die Interaktionen dann doch vom Effekt her als irrelevant betrachten können.</span>
<span id="cb117-2156"><a href="#cb117-2156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2157"><a href="#cb117-2157" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb117-2158"><a href="#cb117-2158" aria-hidden="true" tabindex="-1"></a><span class="fu">## Effektschätzer</span></span>
<span id="cb117-2159"><a href="#cb117-2159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2160"><a href="#cb117-2160" aria-hidden="true" tabindex="-1"></a>In einer mehrfaktoriellen ANOVA lassen wir den Effektschätzer für $\eta^2$ (eng. *eta squared*) weg und konzentrieren uns auf das $\epsilon^2$ (eng. *epsilon squared*) und das $\omega^2$ (eng. *omega squared*). Das $\eta^2$ ist nicht geeigent für mehrere Faktoren und da sind dann die anderen beiden Effektschätzer besser und auch für ausgelegt. Ich nutze dann noch die Filterfunktion um mir nur die Werte anzeigen zu lassen, die über $0.01$ liegen. Hier kannst du auch noch strenger filtern, aber filtern solltest du. Dann sortiere ich mir noch die Werte absteigend <span class="in">`desc()`</span> mit der Funktion <span class="in">`arrange()`</span>. Auch hier kannst du die Werte für die 95% Konfidenzintervalle bei unserer kleinen Fallzahl ignorieren.</span>
<span id="cb117-2161"><a href="#cb117-2161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2164"><a href="#cb117-2164" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-2165"><a href="#cb117-2165" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-2166"><a href="#cb117-2166" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-2167"><a href="#cb117-2167" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>stage<span class="sc">*</span>site<span class="sc">*</span>season, <span class="at">data =</span> fac4_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-2168"><a href="#cb117-2168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">epsilon_squared</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-2169"><a href="#cb117-2169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Epsilon2_partial <span class="sc">&gt;=</span> <span class="fl">0.01</span>) <span class="sc">|&gt;</span> </span>
<span id="cb117-2170"><a href="#cb117-2170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Epsilon2_partial)) <span class="sc">|&gt;</span> </span>
<span id="cb117-2171"><a href="#cb117-2171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interpret_epsilon_squared</span>()</span>
<span id="cb117-2172"><a href="#cb117-2172" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-2173"><a href="#cb117-2173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2174"><a href="#cb117-2174" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass die Interaktionen dann doch einen Teil der Varianz ausmachen. Die Werte addieren sich ja nicht mehr auf Eins auf, aber dennoch können wir die Werte realtiv zueinander vergleichen. Wir haben hier eben dann doch einen starken Einfluss auf die Sprungweite durch die Faktorombinationen und damit wo, wann und was wir messen. Wir sehen den gleichen Trend dann auch im Folgenden für die $\omega^2$ Werte.</span>
<span id="cb117-2175"><a href="#cb117-2175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2178"><a href="#cb117-2178" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-2179"><a href="#cb117-2179" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-2180"><a href="#cb117-2180" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-2181"><a href="#cb117-2181" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>stage<span class="sc">*</span>site<span class="sc">*</span>season, <span class="at">data =</span> fac4_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-2182"><a href="#cb117-2182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">omega_squared</span>() <span class="sc">|&gt;</span> </span>
<span id="cb117-2183"><a href="#cb117-2183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Omega2_partial <span class="sc">&gt;=</span> <span class="fl">0.01</span>) <span class="sc">|&gt;</span> </span>
<span id="cb117-2184"><a href="#cb117-2184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Omega2_partial)) <span class="sc">|&gt;</span> </span>
<span id="cb117-2185"><a href="#cb117-2185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interpret_omega_squared</span>()</span>
<span id="cb117-2186"><a href="#cb117-2186" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-2187"><a href="#cb117-2187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2188"><a href="#cb117-2188" aria-hidden="true" tabindex="-1"></a>Welche der beiden Maßzahlen der Effektschätzer sollest du nun berichten? Nach der Hilfeseite von dem R Paket <span class="in">`{effectsize}`</span> ist *"Omega is the more popular choice"*. Daher würde ich dann zu den $\omega^2$ Werten in einer mehrfaktoriellen ANOVA tendieren. Mehr dazu dann aber weiter oben im Abschnitt zu der theoretischen Betrachtung der Effektschätzer in der ANOVA. Mehr dazu dann auch unter <span class="co">[</span><span class="ot">Other Measures of Effect Size</span><span class="co">](https://easystats.github.io/effectsize/articles/anovaES.html#other-measures-of-effect-size)</span> auf der Hilfeseite des R Pakets <span class="in">`{effectsize}`</span>.</span>
<span id="cb117-2189"><a href="#cb117-2189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2190"><a href="#cb117-2190" aria-hidden="true" tabindex="-1"></a><span class="fu">## R Paket `{report}`</span></span>
<span id="cb117-2191"><a href="#cb117-2191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2192"><a href="#cb117-2192" aria-hidden="true" tabindex="-1"></a>Das <span class="co">[</span><span class="ot">R Paket `{report}`</span><span class="co">](https://easystats.github.io/report/)</span> liefert nochmal die Möglichkeit sich die Ausgabe einer zweifaktoriellen ANOVA in Textform wiedergeben zu lassen. Wie immer, wenn man alleine vor dem Rechner sitzt, ist das doch eine super Hilfestellung. Hier dann einmal mit der <span class="in">`Anova()`</span> Funktion aus dem R Paket <span class="in">`{car}`</span>. Ich mag hier besonders die Hilfe bei einer mehrfaktoriellen ANOVA. Hier wird es dann sehr schnell sehr unübersichtlich und da ist doch die <span class="in">`report()`</span> Funktion hilfreich.</span>
<span id="cb117-2193"><a href="#cb117-2193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2196"><a href="#cb117-2196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-2197"><a href="#cb117-2197" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>stage<span class="sc">*</span>site<span class="sc">*</span>season, <span class="at">data =</span> fac4_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-2198"><a href="#cb117-2198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>() <span class="sc">|&gt;</span></span>
<span id="cb117-2199"><a href="#cb117-2199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">report</span>()</span>
<span id="cb117-2200"><a href="#cb117-2200" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-2201"><a href="#cb117-2201" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb117-2202"><a href="#cb117-2202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2203"><a href="#cb117-2203" aria-hidden="true" tabindex="-1"></a>Wenn du die ANOVA in deiner Abschlussarbeit anwendest, musst du jetzt noch schauen, welche paarweisen Gruppenvergleiche in deinem Faktor signifikant sind. Das würden wir dann in einem <span class="co">[</span><span class="ot">Post-hoc Test</span><span class="co">](#sec-posthoc)</span> am Ende machen. Das war dann auch schon fast mit der mehrfaktoriellen ANOVA, wenn es nicht noch die Interaktion zwischen den Faktoren geben würde. Hier werfen wir dann nochmal einen Blick drauf, denn das ist jetzt schon noch ein bedeutender Teil.</span>
<span id="cb117-2204"><a href="#cb117-2204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2205"><a href="#cb117-2205" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interaktion</span></span>
<span id="cb117-2206"><a href="#cb117-2206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2207"><a href="#cb117-2207" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Auch Holzwege müssen zu Ende gegangen werden." --- Angela Merkel*</span></span>
<span id="cb117-2208"><a href="#cb117-2208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2209"><a href="#cb117-2209" aria-hidden="true" tabindex="-1"></a>Die Interaktion in einem mehrfaktoriellen Modell kann einen ganz schön ins schwitzen bringen, wenn man sich nicht sehr gut mit dem Experiment und dem dahinterliegenden biologischen Zusammenhängen auskennt. Schnell kann man da auf dem Holzweg gelangen und irrt durch die Daten. Hier möchte ich mir dann auch die Interaktionen einmal visualiseren, so dass ich eine Idee bekomme was in den Daten los ist. Wir wissen ja schon durch die ANOVA, wo wir hinschauen müssen und welche Interaktionen wir zu erwarten haben.</span>
<span id="cb117-2210"><a href="#cb117-2210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2211"><a href="#cb117-2211" aria-hidden="true" tabindex="-1"></a>Was sagt mir die signifikante Interaktion in einem mehrfaktoriellen Modell?</span>
<span id="cb117-2212"><a href="#cb117-2212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2213"><a href="#cb117-2213" aria-hidden="true" tabindex="-1"></a>:   Wir haben ja in unserer ANOVA zwei signifikante Interaktionen höherer Ordnung. Das heißt, wir haben nicht nur eine Interaktion zwischen zwei Faktoren sondern drei oder mehr Faktoren. Das ist immer schwer zu interpretieren, wenn man nicht die Abbildungen dazu sieht. In der Anwendung heißen signifikante Interaktionen höherer Ordnung, dass wir unsere Ergebnisse nicht über alle Faktorkombinationen verallgemeinern können.</span>
<span id="cb117-2214"><a href="#cb117-2214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2215"><a href="#cb117-2215" aria-hidden="true" tabindex="-1"></a>Da es bei den Interaktionen der höheren Ordnung schnell mal unübersichtlich wird habe ich nochmal eine Tabelle zur Erklärung erstellt. Dabei ist es wichtig zu wissen, dass die gesamte Interaktionen als ganzes zu sehen ist. Das macht es dann recht schwierig alles im Kopf zu behalten, welche Faktoren sich wie ändern sollen, damit wir eine Interaktion sehen. Oder andersherum, ich finde Interaktionen höhrer Ordnung auch immer schwer zu verstehen.</span>
<span id="cb117-2216"><a href="#cb117-2216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2217"><a href="#cb117-2217" aria-hidden="true" tabindex="-1"></a>| Interaktionsterm | Bedeutung |</span>
<span id="cb117-2218"><a href="#cb117-2218" aria-hidden="true" tabindex="-1"></a>|:---|:---|</span>
<span id="cb117-2219"><a href="#cb117-2219" aria-hidden="true" tabindex="-1"></a>| <span class="in">`animal:site:season`</span> | Die Interaktion zwischen dem Faktor <span class="in">`animal`</span> und <span class="in">`site`</span> und dem Faktor <span class="in">`season`</span>. Verhalten sich die Floharten an den Messorten und den Jahreszeiten gleich? |</span>
<span id="cb117-2220"><a href="#cb117-2220" aria-hidden="true" tabindex="-1"></a>| <span class="in">`animal:stage:site:season`</span> | Die Interaktion zwischen dem Faktor <span class="in">`animal`</span> und <span class="in">`site`</span> sowie <span class="in">`stage`</span> und dem Faktor <span class="in">`season`</span>. Verhalten sich die Floharten an den Messorten und den Jahreszeiten für beide Entwicklungsstadien gleich? |</span>
<span id="cb117-2221"><a href="#cb117-2221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2222"><a href="#cb117-2222" aria-hidden="true" tabindex="-1"></a>: Bedeutung der höhren Ordnungen der Interaktionsterme in der multifaktoriellen ANOVA. {#tbl-higher-interaction}</span>
<span id="cb117-2223"><a href="#cb117-2223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2224"><a href="#cb117-2224" aria-hidden="true" tabindex="-1"></a>Schauen wir uns einmal die Interaktionen in dem mehrfaktoriellen Datensatz einmal an. Ich zeige dir hier auch die Implementierung in dem <span class="co">[</span><span class="ot">R Paket `{interactions}`</span><span class="co">](https://interactions.jacob-long.com/)</span> für den dreifaktoriellen Fall. Wenn wir den vierfaktoriellen Fall vorliegen haben, dann müssen wir uns die Abbdilungen selber in <span class="in">`{ggplot}`</span> bauen.</span>
<span id="cb117-2225"><a href="#cb117-2225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2226"><a href="#cb117-2226" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb117-2227"><a href="#cb117-2227" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{ggplot}`</span></span>
<span id="cb117-2228"><a href="#cb117-2228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2229"><a href="#cb117-2229" aria-hidden="true" tabindex="-1"></a>Wenn wir mehr asl zwei Faktoren in einem Liniendiagramm abilden wollen, dann müssen wir uns entscheiden, welche zusätzliche Darstellung eines Faktors wir wollen. Ich zeige hier einmal die Lösung mit einem zusätzlichen Typ an Linien mit <span class="in">`linetype = stage`</span> sowie einer Aufteilung der Abbildung in zwei Unterabbildungen nach der Jahreszeit durch die Funktion <span class="in">`facet_wrap(~ season)`</span>. Dadurch erhalten wir verschiedene Linientypen für den Entwicklungszustand und spalten die Abbildung einmal nach der Jahreszeit der Messung auf.</span>
<span id="cb117-2230"><a href="#cb117-2230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2233"><a href="#cb117-2233" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-2234"><a href="#cb117-2234" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-2235"><a href="#cb117-2235" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb117-2236"><a href="#cb117-2236" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-2237"><a href="#cb117-2237" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-interactionplot-3a</span></span>
<span id="cb117-2238"><a href="#cb117-2238" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-2239"><a href="#cb117-2239" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.5</span></span>
<span id="cb117-2240"><a href="#cb117-2240" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb117-2241"><a href="#cb117-2241" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Liniendiagramm zur Überprüfung der Interaktion in einem vierfaktoriellen Versuchsdesign. Wenn sich die Linien kreuzen so ist von einer Interaktion auszugehen."</span></span>
<span id="cb117-2242"><a href="#cb117-2242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2243"><a href="#cb117-2243" aria-hidden="true" tabindex="-1"></a>fac4_tbl <span class="sc">|&gt;</span> </span>
<span id="cb117-2244"><a href="#cb117-2244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length,</span>
<span id="cb117-2245"><a href="#cb117-2245" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> site, <span class="at">linetype =</span> stage, </span>
<span id="cb117-2246"><a href="#cb117-2246" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> <span class="fu">interaction</span>(site, stage))) <span class="sc">+</span></span>
<span id="cb117-2247"><a href="#cb117-2247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb117-2248"><a href="#cb117-2248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb117-2249"><a href="#cb117-2249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb117-2250"><a href="#cb117-2250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb117-2251"><a href="#cb117-2251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> season)</span>
<span id="cb117-2252"><a href="#cb117-2252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-2253"><a href="#cb117-2253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2254"><a href="#cb117-2254" aria-hidden="true" tabindex="-1"></a>Wir sehen in der Abbildung mehrere Interaktionen. Ich versuche die Interaktionen einmal mit dem p-Wert und der Abbildung überein zu bringen. Eine Interaktion sollte man eigentlich immer sehen. Häufig muss man nur sehr genau schauen und mal die Faktoren durchpermutieren. Je nachdem was auf der x-Achse liegt siehst du was anderes leichter.</span>
<span id="cb117-2255"><a href="#cb117-2255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2256"><a href="#cb117-2256" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Interaktion <span class="in">`animal:stage`</span> mit dem p-Wert von $&lt;0.001$: Hier haben wir ein Überkreuzen der Linien von dem Faktor <span class="in">`animal`</span> und <span class="in">`stage`</span>. Adulte Katzenflöhe springen im Mittel weiter als adulte Flöhe. Dieser Zusammenhang dreht sich bei den Hunden um.</span>
<span id="cb117-2257"><a href="#cb117-2257" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Interaktion <span class="in">`animal:site`</span> mit dem p-Wert von $&lt;0.001$: Hier haben wir ein Überkreuzen der Linien von dem Faktor <span class="in">`animal`</span> und <span class="in">`site`</span>. Katzenflöhe springen in der Stadt weiter als auf dem Dorf. Dieser Zusammenhang dreht sich dann bei den Fuchsflöhen um. Dort springen die Dorffuchsflöhe weiter als die Stadtfuchsflöhe.</span>
<span id="cb117-2258"><a href="#cb117-2258" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Interaktion <span class="in">`animal:site:season`</span> mit dem p-Wert von $&lt;0.001$: Die Sprungweiten der Floharten der drei Tiere über die Messorte im Sommer und Winter sind mehr als nur verschoben. Die Mittelwerte der Sprungweiten der Füchse sind in der Stadt im Sommer niedriger als im Winter *im Bezug* zum Messort im Dorf.</span>
<span id="cb117-2259"><a href="#cb117-2259" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Interaktion <span class="in">`animal:stage:site:season`</span> mit dem p-Wert von $0.037$: Diese Interaktion ist jetzt die schwerste zu sehende Interaktion. Wir haben eben noch den Dreher der Sprungweiten bei den Hunden von Sommer zu Winter mit drin. Bei den Hunden verändert sich die Reihenfolge der Mittelwerte für <span class="in">`stage`</span> und <span class="in">`juvenile`</span> von Sommer zu Winter. Das Ganze kann man auch leicht bei den Katzenflöhen sehen.</span>
<span id="cb117-2260"><a href="#cb117-2260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2261"><a href="#cb117-2261" aria-hidden="true" tabindex="-1"></a>Jetzt können wir uns die Abbildung auch über die Funktion <span class="in">`facet_wrap(~ stage * season)`</span> für die Kombinationen an Entwicklungsstand und Jahreszeit einmal aufteilen. Dann haben wir nur die Farben für den Messort und die Floharten auf der x-Achse. Das ist manchmal dann auch etwas übersichtlicher, wenn du nicht so viele Gruppen in den Faktoren hast.</span>
<span id="cb117-2262"><a href="#cb117-2262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2265"><a href="#cb117-2265" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-2266"><a href="#cb117-2266" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-2267"><a href="#cb117-2267" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb117-2268"><a href="#cb117-2268" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-2269"><a href="#cb117-2269" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-interactionplot-3b</span></span>
<span id="cb117-2270"><a href="#cb117-2270" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-2271"><a href="#cb117-2271" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb117-2272"><a href="#cb117-2272" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb117-2273"><a href="#cb117-2273" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Liniendiagramm zur Überprüfung der Interaktion in einem vierfaktoriellen Versuchsdesign. Die Aufteilung erfolgt hier über die Faktorkombinationen von `stage * season`. Wenn sich die Linien kreuzen so ist von einer Interaktion auszugehen."</span></span>
<span id="cb117-2274"><a href="#cb117-2274" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb117-2275"><a href="#cb117-2275" aria-hidden="true" tabindex="-1"></a>fac4_tbl <span class="sc">|&gt;</span> </span>
<span id="cb117-2276"><a href="#cb117-2276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length,</span>
<span id="cb117-2277"><a href="#cb117-2277" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> site, <span class="at">group =</span> site)) <span class="sc">+</span></span>
<span id="cb117-2278"><a href="#cb117-2278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb117-2279"><a href="#cb117-2279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb117-2280"><a href="#cb117-2280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb117-2281"><a href="#cb117-2281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb117-2282"><a href="#cb117-2282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> stage <span class="sc">*</span> season) </span>
<span id="cb117-2283"><a href="#cb117-2283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-2284"><a href="#cb117-2284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2285"><a href="#cb117-2285" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{interactions}`</span></span>
<span id="cb117-2286"><a href="#cb117-2286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2287"><a href="#cb117-2287" aria-hidden="true" tabindex="-1"></a>In dem R Paket <span class="in">`{interactions}`</span> können wir nur maximal eine dreifaktorielle ANOVA mit Interaktion darstellen. Wir legen dafür den ersten Faktor mit der Option <span class="in">`modx =`</span> fest. Der zweite Faktor kommt dann in die Option <span class="in">`mod2 =`</span>. Der Faktor auf der x-Achse wird dann in der Option <span class="in">`pred =`</span> festgelegt. Dann können wir uns auch schon den Interaktionsplot einmal ansehen. Ich blende in der ersten Abbildung dann einmal den Faktor <span class="in">`season`</span> aus.</span>
<span id="cb117-2288"><a href="#cb117-2288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2291"><a href="#cb117-2291" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-2292"><a href="#cb117-2292" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-2293"><a href="#cb117-2293" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb117-2294"><a href="#cb117-2294" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-2295"><a href="#cb117-2295" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-interactionplot-4a</span></span>
<span id="cb117-2296"><a href="#cb117-2296" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-2297"><a href="#cb117-2297" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.5</span></span>
<span id="cb117-2298"><a href="#cb117-2298" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb117-2299"><a href="#cb117-2299" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Liniendiagramm mit Fehlerbalken zur Überprüfung der Interaktion in einem dreifaktoriellen Versuchsdesign. Wenn sich die Linien kreuzen so ist von einer Interaktion auszugehen. Der Faktor `season` wird ignoriert und ausgeblendet."</span></span>
<span id="cb117-2300"><a href="#cb117-2300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2301"><a href="#cb117-2301" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>stage<span class="sc">*</span>site<span class="sc">*</span>season, <span class="at">data =</span> fac4_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-2302"><a href="#cb117-2302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat_plot</span>(<span class="at">modx =</span> site, <span class="at">mod2 =</span> stage, <span class="at">pred =</span> animal,  <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb117-2303"><a href="#cb117-2303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb117-2304"><a href="#cb117-2304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span>
<span id="cb117-2305"><a href="#cb117-2305" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-2306"><a href="#cb117-2306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2307"><a href="#cb117-2307" aria-hidden="true" tabindex="-1"></a>Dann können wir uns die Abbildung auch nochmal mit dem ausgeblendeten Faktor <span class="in">`stage`</span> anschauen. Am Ende muss man festhalten, dass wir in einer vierfaktoriellen ANOVA natürlich nur bedingt uns die Interaktion in zerlegten dreifaktoriellen Abbildungen anschauen können. Auf der anderen Seite betrifft es dann natürlich nur die Interaktion <span class="in">`animal:stage:site:season`</span>, die wir nicht anschauen können. Das ist dann auch meistens verschmerzbar, da diese selten signifikant ist.</span>
<span id="cb117-2308"><a href="#cb117-2308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2311"><a href="#cb117-2311" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb117-2312"><a href="#cb117-2312" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb117-2313"><a href="#cb117-2313" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb117-2314"><a href="#cb117-2314" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb117-2315"><a href="#cb117-2315" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-interactionplot-4b</span></span>
<span id="cb117-2316"><a href="#cb117-2316" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb117-2317"><a href="#cb117-2317" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.5</span></span>
<span id="cb117-2318"><a href="#cb117-2318" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb117-2319"><a href="#cb117-2319" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Liniendiagramm mit Fehlerbalken zur Überprüfung der Interaktion in einem dreifaktoriellen Versuchsdesign. Wenn sich die Linien kreuzen so ist von einer Interaktion auszugehen. Der Faktor `stage` wird ignoriert und ausgeblendet."</span></span>
<span id="cb117-2320"><a href="#cb117-2320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2321"><a href="#cb117-2321" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal<span class="sc">*</span>stage<span class="sc">*</span>site<span class="sc">*</span>season, <span class="at">data =</span> fac4_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb117-2322"><a href="#cb117-2322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat_plot</span>(<span class="at">modx =</span> site, <span class="at">mod2 =</span> season, <span class="at">pred =</span> animal,  <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb117-2323"><a href="#cb117-2323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb117-2324"><a href="#cb117-2324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span>
<span id="cb117-2325"><a href="#cb117-2325" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb117-2326"><a href="#cb117-2326" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb117-2327"><a href="#cb117-2327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2328"><a href="#cb117-2328" aria-hidden="true" tabindex="-1"></a><span class="fu">## Am Ende</span></span>
<span id="cb117-2329"><a href="#cb117-2329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2330"><a href="#cb117-2330" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Auf dem Weg der Tugend wird dir viel Leid widerfahren, doch dein Lohn wird Achtung, Verehrung und Liebe der Menschen sein." --- [Herakles am Scheideweg](https://de.wikipedia.org/wiki/Herakles_am_Scheideweg)*</span></span>
<span id="cb117-2331"><a href="#cb117-2331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2332"><a href="#cb117-2332" aria-hidden="true" tabindex="-1"></a>Wie kommen wir jetzt zum Ende? Wenn du eine signifikante ANOVA vorliegen hast, dann musst du noch einen Post-hoc Test rechnen um herauszufinden, welche paarweisen Vergleiche signifkant sind. Diese paarweisen signifkanten Unterschiede sind es ja, die die ANOVA erst signifikant gemacht haben. Ehrlicherweise ist es meist so, dass du *immer* einen Post-hoc Test rechnest, da man sich nie sicher sein kann, ob die ANOVA nicht fälschlicherweise die Nullhypothese beibehalten hat. Oder einfach weil wir eben immer einen Post-hoc Test in einer Abschlussarbeit rechnen. Also, dann auf ins <span class="co">[</span><span class="ot">Kapitel zum Post-hoc Testen</span><span class="co">](#sec-posthoc)</span>.</span>
<span id="cb117-2333"><a href="#cb117-2333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2334"><a href="#cb117-2334" aria-hidden="true" tabindex="-1"></a><span class="fu">## Referenzen {.unnumbered}</span></span>
</code><button title="In die Zwischenablage kopieren" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Bio Data Science wurde von <a href="https://www.hs-osnabrueck.de/prof-dr-jochen-kruppa/">Jochen Kruppa-Scheetz</a> geschrieben.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-tests-anova2.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-tests-anova2.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Dieses Openbook wurde mit <a href="https://quarto.org/">Quarto</a> erstellt.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Ein Kochbuch mit Rezepten aus der Bio Data Science, Biostatistik, Biometrie und Statistik zum selber nachkochen!">

<title>44&nbsp; Simple lineare Regression – Bio Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./stat-modeling-basic.html" rel="next">
<link href="./stat-linear-reg-preface.html" rel="prev">
<link href="./cover2024_favi.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-05fe91a66cf75bbbb8c9664867fe5124.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-05a8b96638736df272eeeeef67138371.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="44&nbsp; Simple lineare Regression – Bio Data Science">
<meta property="og:description" content="Ein Kochbuch mit Rezepten der Bio Data Science, Biostatistik, Biometrie und Statistik">
<meta property="og:image" content="https://github.com/jkruppa/jkruppa.github.io/raw/master/cover2024.png">
<meta property="og:site_name" content="Bio Data Science">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-linear-reg-preface.html">Grundlagen des Modellierens</a></li><li class="breadcrumb-item"><a href="./stat-linear-reg-basic.html"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bio Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jkruppa/jkruppa.github.io/" title="Quellcode" class="quarto-navigation-tool px-1" aria-label="Quellcode"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Willkommen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bibliothek</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./forschungsprozess.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forschungsprozess</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abschlussarbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Abschlussarbeit</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./example-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datenbeispiele</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-database.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Von Datenbanken</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programmieren in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Daten in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Daten einlesen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Reguläre Ausdrücke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-purrr-furrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Ein <code>{purrr}</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Ein <code>{ggplot}</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-quarto-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Quarto und Shiny App</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorative Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Testen von Hypothesen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelle Designs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Versuchsplanung in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Einfache Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Fortgeschrittene Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-app.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistische Gruppenvergleiche</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Testen in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Der t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Die repeated / mixed ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-manova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Die MANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Der U-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Der Friedman Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Der Chi-Quadrat-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anteil-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Der Anteilstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-trendtest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Der Trendtest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-permutationstest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Der Permutationstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Der Post-hoc Test</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grundlagen des Modellierens</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Modelgüte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Korrelation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Ausreißer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Variablenselektion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Fehlende Werte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistisches Modellieren</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Modellieren in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-marginal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Marginal effect models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-beta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Beta Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-prob-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-robust-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Überlebenszeitanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-noninferiority.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Äquivalenz oder Nichtunterlegenheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Metaanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Fragebogenanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./time-space-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zeitliche und räumliche Analysen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-pseudo-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Pseudo Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Räumliche Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Klassifikation oder maschinelles Lernen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-pre-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Data preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title">Support vector machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">80</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./abspann.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abspann</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-spielecke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">Spielecke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./construction-zone.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">82</span>&nbsp; <span class="chapter-title">Baustelle</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#allgemeiner-hintergrund" id="toc-allgemeiner-hintergrund" class="nav-link active" data-scroll-target="#allgemeiner-hintergrund"><span class="header-section-number">44.1</span> Allgemeiner Hintergrund</a></li>
  <li><a href="#theoretischer-hintergrund" id="toc-theoretischer-hintergrund" class="nav-link" data-scroll-target="#theoretischer-hintergrund"><span class="header-section-number">44.2</span> Theoretischer Hintergrund</a></li>
  <li><a href="#genutzte-r-pakete" id="toc-genutzte-r-pakete" class="nav-link" data-scroll-target="#genutzte-r-pakete"><span class="header-section-number">44.3</span> Genutzte R Pakete</a></li>
  <li><a href="#daten" id="toc-daten" class="nav-link" data-scroll-target="#daten"><span class="header-section-number">44.4</span> Daten</a></li>
  <li><a href="#kausales-modell" id="toc-kausales-modell" class="nav-link" data-scroll-target="#kausales-modell"><span class="header-section-number">44.5</span> Kausales Modell</a>
  <ul class="collapse">
  <li><a href="#einkovariates-modell" id="toc-einkovariates-modell" class="nav-link" data-scroll-target="#einkovariates-modell"><span class="header-section-number">44.5.1</span> Einkovariates Modell</a></li>
  <li><a href="#einfaktorielles-modell" id="toc-einfaktorielles-modell" class="nav-link" data-scroll-target="#einfaktorielles-modell"><span class="header-section-number">44.5.2</span> Einfaktorielles Modell</a></li>
  </ul></li>
  <li><a href="#prädiktives-modell" id="toc-prädiktives-modell" class="nav-link" data-scroll-target="#prädiktives-modell"><span class="header-section-number">44.6</span> Prädiktives Modell</a>
  <ul class="collapse">
  <li><a href="#einkovariates-modell-1" id="toc-einkovariates-modell-1" class="nav-link" data-scroll-target="#einkovariates-modell-1"><span class="header-section-number">44.6.1</span> Einkovariates Modell</a></li>
  <li><a href="#einfaktorielles-modell-1" id="toc-einfaktorielles-modell-1" class="nav-link" data-scroll-target="#einfaktorielles-modell-1"><span class="header-section-number">44.6.2</span> Einfaktorielles Modell</a></li>
  </ul></li>
  <li><a href="#glossar" id="toc-glossar" class="nav-link" data-scroll-target="#glossar"><span class="header-section-number">44.7</span> Glossar</a></li>
  <li><a href="#referenzen" id="toc-referenzen" class="nav-link" data-scroll-target="#referenzen">Referenzen</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-linear-reg-basic.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-linear-reg-basic.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-linear-reg-preface.html">Grundlagen des Modellierens</a></li><li class="breadcrumb-item"><a href="./stat-linear-reg-basic.html"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-modeling-simple-stat" class="quarto-section-identifier"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code zeigen</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code verbergen</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Quellcode anzeigen</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><em>Letzte Änderung am 28. July 2025 um 08:59:52</em></p>
<blockquote class="blockquote">
<p><em>“Farewell to the Fairground; These rides aren’t working anymore.” — White Lies, Farewell to the Fairground</em></p>
</blockquote>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/caution.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="images/caution.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a></p>
</figure>
</div>
<div class="callout callout-style-simple callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stand des Kapitels: Konstruktion (seit 07.2025)
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dieses Kapitel wird in den nächsten Wochen geschrieben und ist damit meine aktuelle Großbaustelle. Ich plane zum Beginn des WiSe 2025/26 eine fertige Version des Kapitels erstellt zu haben. Während das Kapitel entsteht, funktioniert so manches dann nicht so wie es soll. Bitte daher hier dann abwarten.</p>
</div>
</div>
<p>In diesem Kapitel wollen wir mit den Grundlagen des statistischen Modellierens beginnen. Wir nutzen dazu die simple lineare Regression als eine Methode um zu Verstehen, was eigentlich das statistische Modellieren macht. Dabei konzentrieren wir uns auf die lineare Regression, da wir hier ein lineares Modell vorliegen haben. Wir wollen also eine Grade Linie durch Punkte ziehen. Die Punkte sind in einem Scatterplot mit einer x-Achse und einer y-Achse dargestellt. Das ist für den Anfang schwierig genug. Später können wir auch nicht lineare Zusammenhänge modellieren. Dann nutzen wir auch nur eine Einflussvariable und nennen deshalb auch die Regression eine simple lineare Regression. Später in den folgenden Kapiteln erweitern wir dann die Regression und schauen uns auch an, wie gut die Regression geklappt hat. Mit gut meine ich, in wie weit die Grade durch die Punkte auch den Zusammenhang zwischen den x-Werten und den y-Werte erklärt. Dazu dann mehr mehr in dem Kapitel zu der Modelgüte einer Regression.</p>
<section id="allgemeiner-hintergrund" class="level2" data-number="44.1">
<h2 data-number="44.1" class="anchored" data-anchor-id="allgemeiner-hintergrund"><span class="header-section-number">44.1</span> Allgemeiner Hintergrund</h2>
<p>Was macht also eine simple lineare Regression? Die Regression ist eine Methode um eine lineare Grade durch eine Punktewolke in einem Scatterplot zu zeichnen. Dabei haben wir nur eine Einflussvariable <span class="math inline">\(x\)</span> vorliegen, da unser Modell zuallerst simple sein soll. Der Messwert <span class="math inline">\(y\)</span> ist in diesem Kapitel noch normalverteilt und damit auch kontinuierlich. Wir wollen also den Zusammenhang zwischen zwei kontinuierlichen Variablen durch eine Regression bestimmen. Wir sprechen in diesem Zusammenhang mit einer kontinuierlichen Einflussvariable von einer Kovariate. In einem nächsten Schritt ändern wir dann die Einflussvariable auf eine kategoriale Einflussvariable. Wir haben dann einen Faktor mit unterschiedlichen Gruppen vorliegen. Beide Fälle wollen wir uns dann einmal anschauen. Beginnen wollen wir aber mit einer allgemeinern Betrachtung. Welche Modelltypen oder Fragestellungen gibt es eigentlich? Bevor wir damit anfangen, einmal etwas sprachlicher Hintergrund.</p>
<section id="sprachlicher-hintergrund" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="sprachlicher-hintergrund">Sprachlicher Hintergrund</h4>
<blockquote class="blockquote">
<p><em>“In statistics courses taught by statisticians we don’t use”independent variable” because we use independent on to mean stochastic independence. Instead we say predictor or covariate (either). And, similarly, we don’t say “dependent variable” either. We say response.” — <a href="https://www.reddit.com/r/AskStatistics/comments/qt1hvu/comment/hkigiks/?utm_source=share&amp;utm_medium=web3x&amp;utm_name=web3xcss&amp;utm_term=1&amp;utm_content=share_button">User berf auf r/AskStatistics</a></em></p>
</blockquote>
<p>Wenn wir uns mit dem statistischen Modellieren beschäftigen wollen, dann brauchen wir auch Worte um über das Thema reden zu können. Statistik wird in vielen Bereichen der Wissenschaft verwendet und in jedem Bereich nennen wir dann auch Dinge anders, die eigentlich gleich sind. Daher werde ich mir es hier herausnehmen und auch die Dinge so benennen, wie ich sie für didaktisch sinnvoll finde. Wir wollen hier was verstehen und lernen, somit brauchen wir auch eine klare Sprache.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/personal_opinion.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="images/personal_opinion.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p><em>“Jeder nennt in der Statistik sein Y und X wie er möchte. Da ich hier nicht nur von Y und X schreiben will, führe ich eben die Worte ein, die ich nutzen will. Damit sind die Worte dann auch richtig, da der Kontext definiert ist. Andere mögen es dann anders machen. Ich mache es eben dann so. Danke.” — Jochen Kruppa-Scheetz, meiner bescheidener Meinung nach.</em></p>
</blockquote>
</div>
</div>
</div>
<p>In dem folgenden Kasten erkläre ich nochmal den Gebrauch meiner Begriffe im statistischen Testen. Es ist wichtig, dass wir hier uns klar verstehen. Zum einen ist es angenehmer auch mal ein Wort für ein Symbol zu schreiben. Auf der anderen Seite möchte ich aber auch, dass du dann das Wort richtig einem Konzept im statistischen Modellieren zuordnen kannst. Deshalb einmal hier meine persönliche und didaktische Zusammenstellung meiner Wort im statistischen Modellieren. Du kannst dann immer zu dem Kasten zurückgehen, wenn wir mal ein Wort nicht mehr ganz klar ist. Die fetten Begriffe sind die üblichen in den folgenden Kapiteln. Die anderen Worte werden immer mal wieder in der Literatur genutzt.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Worte und Bedeutungen im statistischen Modellieren
</div>
</div>
<div class="callout-body-container callout-body">
<blockquote class="blockquote">
<p><em>“Die Grenzen meiner Sprache bedeuten die Grenzen meiner Welt.” — Ludwig Wittgenstein</em></p>
</blockquote>
<p>Hier kommt einmal die Tabelle mit den wichtigsten Begriffen im statistischen Modellieren und wie ich die Worte benutzen werde. Damit wir uns verstehen und du was lernen kannst. In anderen Büchern und Quellen findest du teilweise die Worte in einem anderen Sinnzusammenhang. Das ist gut so dort. Bei mir ist es anders.</p>
<div id="tbl-namen-regression" class="quarto-float quarto-figure quarto-figure-center anchored" data-tbl-colwidths="14, 10, 38, 38">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-namen-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;44.1— Zusammenfassende Tabelle des Sprachgebrauchs in meinem statistischen Modellieren. Die <em>fett</em> hervorgehobenen Bezeichnungen werden hier genutzt. (<em>LHS</em> = left hand side, <em>RHS</em> = right hand side)
</figcaption>
<div aria-describedby="tbl-namen-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 10%">
<col style="width: 38%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">Symbol</th>
<th>Deutsch</th>
<th>Englisch</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>LHS</em></td>
<td style="text-align: center;"><span class="math inline">\(Y\)</span> / <span class="math inline">\(y\)</span></td>
<td><strong>Messwert</strong> / Endpunkt / Outcome</td>
<td>response / outcome / endpoint</td>
</tr>
<tr class="even">
<td><em>RHS</em></td>
<td style="text-align: center;"><span class="math inline">\(X\)</span> / <span class="math inline">\(x\)</span></td>
<td><strong>Einflussvariable</strong> / Erklärende Variable / Fester Effekt</td>
<td>risk factor / explanatory / fixed effect</td>
</tr>
<tr class="odd">
<td><em>RHS</em></td>
<td style="text-align: center;"><span class="math inline">\(Z\)</span> / <span class="math inline">\(z\)</span></td>
<td><strong>Zufälliger Effekt</strong></td>
<td>random effect</td>
</tr>
<tr class="even">
<td><span class="math inline">\(X\)</span> ist kontinuierlich</td>
<td style="text-align: center;"><span class="math inline">\(c_1\)</span></td>
<td><strong>Kovariate</strong> 1</td>
<td>covariate 1</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(X\)</span> ist kategorial</td>
<td style="text-align: center;"><span class="math inline">\(f_A\)</span></td>
<td><strong>Faktor</strong> <span class="math inline">\(A\)</span> mit Level <span class="math inline">\(A.1\)</span> bis <span class="math inline">\(A.j\)</span></td>
<td>factor <span class="math inline">\(A\)</span> with levels <span class="math inline">\(A.1\)</span> to <span class="math inline">\(A.j\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</section>
<section id="das-modell" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="das-modell">Das Modell</h4>
<blockquote class="blockquote">
<p><em>“Models are about what changes, and what doesn’t. Some are useful.” — <a href="https://magesblog.com/post/modelling-change/">Markus Gesmann</a></em></p>
</blockquote>
<p>Fangen wir also erstmal allgemeiner an ein Modell und deren schreibweise zu verstehen. Was ist ein Modell im statistischen Sinne? Wenn du an ein Modell denkst und ein Modellauto oder aber ein Modell eines Hauses oder Landschaft vor dir siehst, dann ist das gar nicht so weit weg vonm einem statistischen Modell. Ein Modell eines Autos hat die Essenz eines Autos in sich. Wir erkennen das Auto wieder, haben aber natürlich nicht die gleichen Funktionalitäten wie bei einem echten Auto. So ist es auch bei dem statistischen Modellieren von Daten. Unser Auto sind also die erhobenen Daten und wir wollen ein Modell finden, was die Zusammenhänge und die Struktur in den Daten vereinfacht wiedergibt. Damit ist per se jedes Modell falsch, da es nur einen Teil der Wirklichkeit abbilden kann. Modelle sind aber manchmal nützlich. Wir können also erstmal wie folgt ein Modell zusammenfassen.</p>
<dl>
<dt>Was ist ein Modell?</dt>
<dd>
<p>Ein Modell vereinfacht. Dabei behält es die Essenz der modellierten Sache bei. Ein statistisches Modell versucht eine Struktur in Daten zu finden. Dabei modelliert es den Zusammenhang zwischen dem Messwert und Einflussvariablen. Wir sprechen hier auch gerne von einer Modellanpassung (eng. <em>fit</em>).</p>
</dd>
</dl>
<p>Allgemeiner gesprochen versucht ein statistisches Modell deine Daten in ein erklärbaren Teil und einen unerklärbaren Teil zu zerlegen. Dafür nutzen wir dann den Zusammenhang von den Messwerten und den Einflussvariablen. Wir sprechen hier auch gerne von einer Modellanpassung (eng. <em>fit</em>). Wir passen ein Modell den Daten an. Je mehr die Einflussvariablen unseren Messwert erklären können, desto weniger bleibt unerklärt und somit kleiner ist auch der Fehler. Hierbei müssen wir etwas mit dem Wort Fehler aufpassen. Wir haben fast immer einen unerklärten Anteil von unserem Messwert nach dem Modellieren. Wir nennen diesen Anteil Fehler, meinen damit aber nicht, dass das Modell per se fehlerhaft ist.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-in-R-model-abstract" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-in-R-model-abstract-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-linear-reg-basic_files/figure-html/fig-model-in-R-model-abstract-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Abbildung&nbsp;44.1— Der Zusammenhang von Daten, dem statistischen Modell und dem Fehler. Das Modell versucht durch ein statistisches Modell f(x) den Zusammenhang zwischen den Einflussvariablen dem Messwert zu erklären. Den Anteil des unerklärten Messwert geht in den Fehlerterm. [Zum Vergrößern anklicken]"><img src="stat-linear-reg-basic_files/figure-html/fig-model-in-R-model-abstract-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-in-R-model-abstract-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;44.1— Der Zusammenhang von Daten, dem statistischen Modell und dem Fehler. Das Modell versucht durch ein statistisches Modell <span class="math inline">\(f(x)\)</span> den Zusammenhang zwischen den Einflussvariablen dem Messwert zu erklären. Den Anteil des unerklärten Messwert geht in den Fehlerterm. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Da wir uns natürlich für die parktische Anwendung in R bewegen, nutzen wir auch die Modellschreibweise, die in R üblich ist. In R wird diese Schreibweise auch mit der Funktion <code>formula()</code> genutzt. Im Folgenden siehst du einmal ein Modell in einer abstrakten Form. Wir haben den Messwert <span class="math inline">\(Y\)</span> auf der linken Seite (eng. <em>left hand side</em>, abk. <em>LHS</em>) der Tilde und die Einflussvariablen <span class="math inline">\(X\)</span> auf der rechten Seite (eng. <em>right hand side</em>, abk. <em>RHS</em>). Dabei steht dann das <span class="math inline">\(X\)</span> hier einmal als Platzhalter und Sammelbegriff für verschiedene Arten von möglichen Variablen.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-in-R-03" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-in-R-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-linear-reg-basic_files/figure-html/fig-model-in-R-03-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Abbildung&nbsp;44.2— Statistische Modellschreibweise mit dem Messwert auf der linken Seite und den Einflussvariablen auf der rechten Seite der Tilde. [Zum Vergrößern anklicken]"><img src="stat-linear-reg-basic_files/figure-html/fig-model-in-R-03-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-in-R-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;44.2— Statistische Modellschreibweise mit dem Messwert auf der linken Seite und den Einflussvariablen auf der rechten Seite der Tilde. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wenn wir jetzt zu R wechseln, sieht es dann etwas anders aus, da wir die Platzhalter <span class="math inline">\(Y\)</span> für den Messwert und <span class="math inline">\(X\)</span> für die Einflussvariable durch die Namen der Spalten in unserem Datensatz ersetzen. Der Datendatz liegt dann als <code>tibble()</code> in R vor. Mehr dann dazu in den folgenden Beispielen in den jeweiligen Kapiteln zum Modellieren. Dann sieht das Modell in R wie in der folgenden Abbildung aus.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-in-R-20" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-in-R-20-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-linear-reg-basic_files/figure-html/fig-model-in-R-20-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Abbildung&nbsp;44.3— Statistische Modellschreibweise in R mit dem Messwert auf der linken Seite und den Einflussvariablen auf der rechten Seite der Tilde. Die Platzhalter Y und X werden durch die Spaltennamen im Datensatz ersetzt. [Zum Vergrößern anklicken]"><img src="stat-linear-reg-basic_files/figure-html/fig-model-in-R-20-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-in-R-20-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;44.3— Statistische Modellschreibweise in R mit dem Messwert auf der linken Seite und den Einflussvariablen auf der rechten Seite der Tilde. Die Platzhalter <span class="math inline">\(Y\)</span> und <span class="math inline">\(X\)</span> werden durch die Spaltennamen im Datensatz ersetzt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Jetzt haben wir verstanden über was wir sprechen wollen, was ein Modell ist und wie wir das Modell in R aufbauen. Dann können wir schon einen Schritt weitergehen und uns fragen, was wir wigentlich mit dem Modell machen wollen. Welche Forschungsfragen können wir denn mit einem statistischen Modell beantworten? Prinzipiell haben wir da zwei große Felder, die wir bearbeiten können.</p>
</section>
<section id="kausales-vs.-prädiktives-modell" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="kausales-vs.-prädiktives-modell">Kausales vs.&nbsp;prädiktives Modell</h4>
<blockquote class="blockquote">
<p><em>“Vor 2001 bestand Statistik gefühlt zu 10% aus der Prädiktion – heutzutage macht die Prädiktion die Mehrheit der Modellierungen aus.” — Gefühle einer anonymen Biometrikerin</em></p>
</blockquote>
<p>Wir können ein kausuales oder ein prädiktives Modell rechnen. Wenn wir ein kausales Modell rechnen, dann haben wir die Frage im Kopf, wie ändert sich der Messwert <span class="math inline">\(y\)</span>, wenn sich die Einflussvariable <span class="math inline">\(x\)</span> um eine Einheit ändert. Wir können die Einheit auch weglassen und allgmeiner nach der Änderung in <span class="math inline">\(y\)</span> durch die Änderung in <span class="math inline">\(x\)</span> sprechen. Es geht hier also um Steigung (eng. <em>slopes</em>) oder eben die Ableitung (eng. <em>derivative</em>) von <span class="math inline">\(dy/dx\)</span>. In einem hier besprochenen linearen Modell ist die Frage nach der Steigung einfach zu beantworten. Schwieriger wird es im nicht linearen Modell. Hier nutzen wir dann <a href="stat-modeling-marginal.html"><em>Marginal effect models</em></a> um die Steigungen entlang der Kurve zu bestimmen.</p>
<p>Eine andere Frage können wir durch ein prädiktives Modell oder eine Vorhersagen (eng. <em>predictions</em>) herausfinden. Hier wollen wir wissen, welche Messwerte ergeben sich durch unser Modell für neue Werte der Einflussvariablen. Das können wir durch eine Vorhersage erreichen. Auch hier ist das lineare Modell einfacher zu verstehen ale eine nicht lineare Kurve. Wir können einfach neue <span class="math inline">\(x\)</span>-Werte in die Formel der Gradengleichung einsetzen und erhalten die entsprechenden vorhergesagten <span class="math inline">\(y\)</span>-Werte wiedergegeben. Wenn wir kein normalverteilten Messwert haben, müssen wir hier nochmal etwas mehr aufpassen. Dazu dann aber auch mehr in den entsprechenden Kapiteln zu den verschiedenen Modellierungen.</p>
<dl>
<dt>Was sind Steigungen?</dt>
<dd>
<p>Die Traktion der Graden über die Werte auf der x-Achse hinweg. Wenn <span class="math inline">\(x\)</span> sich ändert, wir ändert sich dann der Messwert <span class="math inline">\(y\)</span>? In einem linearen Modell haben wir nur einen Wert als Koeffizienten für die Steigung.</p>
</dd>
<dt>Was ist die Vorhersage?</dt>
<dd>
<p>Die y-Werte auf der Graden für jeden beliebigen Wert auf der x-Achse. Welche Werte vom Messwert <span class="math inline">\(y\)</span> sagt das Modell für <span class="math inline">\(x\)</span>-Werte vorraus? Wenn wir eine neue Beobachtung machen, welchen Messwert würde sich gegeben der Einflussvariable einstellen?</p>
</dd>
</dl>
<p>Damit ergibt sich grob die folgende Abbildung als Möglichkeiten in dem statistischen Modellieren. Wir haben hier nur ein simples Modell vorliegen und betrachten hier nur eine Einflussvariable. Die Einflussvariable kann kontinuierliche oder eben kategorial sein. Im kausalen Modell wollen wir wissen, wie sich eine Änderung in der Einflussvariablen auf den Messwert auswirkt. In dem prädiktiven Modell wollen wir eine Vorhersage des Messwertes für neue Beobachtungen machen.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-scatter-modeling-R-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-modeling-R-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-linear-reg-basic_files/figure-html/fig-scatter-modeling-R-01-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Abbildung&nbsp;44.4— Das kausale und prädiktive Modell im statistischen Modellieren für den simplen Fall. In allen Fällen ist der Messwert y normalverteilt. (A) Kausales Modell – Wie verändert sich der Messwert y, wenn sich die kontinuierliche Einflussvariable x ändert? Wie ist der numerische Zusammenhang zwischen y und x? Eine Frage nach der Steigung der Graden. (B) Kausales Modell – Wie verändert sich der Messwert y, wenn sich die kategoriale Einflussvariable als Faktor f_A ändert? Wie ist der numerische Zusammenhang zwischen y und f_A? Eine Frage nach der Steigung der Graden. (C) Prädikitives Modell – Wenn y und x gemessen wurden, wie sehen dann die Werte von y für neue x-Werte aus? Können wir mit der Einflussvariable x die neuen Messwerte in y vorhersagen? [Zum Vergrößern anklicken]"><img src="stat-linear-reg-basic_files/figure-html/fig-scatter-modeling-R-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1440"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-modeling-R-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;44.4— Das kausale und prädiktive Modell im statistischen Modellieren für den simplen Fall. In allen Fällen ist der Messwert <span class="math inline">\(y\)</span> normalverteilt. <strong>(A)</strong> <em>Kausales Modell</em> – Wie verändert sich der Messwert <span class="math inline">\(y\)</span>, wenn sich die kontinuierliche Einflussvariable <span class="math inline">\(x\)</span> ändert? Wie ist der numerische Zusammenhang zwischen <span class="math inline">\(y\)</span> und <span class="math inline">\(x\)</span>? Eine Frage nach der Steigung der Graden. <strong>(B)</strong> <em>Kausales Modell</em> – Wie verändert sich der Messwert <span class="math inline">\(y\)</span>, wenn sich die kategoriale Einflussvariable als Faktor <span class="math inline">\(f_A\)</span> ändert? Wie ist der numerische Zusammenhang zwischen <span class="math inline">\(y\)</span> und <span class="math inline">\(f_A\)</span>? Eine Frage nach der Steigung der Graden. <strong>(C)</strong> <em>Prädikitives Modell</em> – Wenn <span class="math inline">\(y\)</span> und <span class="math inline">\(x\)</span> gemessen wurden, wie sehen dann die Werte von <span class="math inline">\(y\)</span> für neue <span class="math inline">\(x\)</span>-Werte aus? Können wir mit der Einflussvariable <span class="math inline">\(x\)</span> die neuen Messwerte in <span class="math inline">\(y\)</span> vorhersagen? <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Soviel zu dem allgemeinen Hintergrund. Nachdem wir jetzt auch die Fragestellungen erörtert haben, wollen wir jetzt einmal verstehen, wie die simple lineare Regression als ein statistisches Modell funktioniert und wie wir dort die Gradengleichung schätzen können. Die Berechungen kommen dann nochmal extra nach der Besprechung der Daten für die Beispiele.</p>
</section>
</section>
<section id="theoretischer-hintergrund" class="level2" data-number="44.2">
<h2 data-number="44.2" class="anchored" data-anchor-id="theoretischer-hintergrund"><span class="header-section-number">44.2</span> Theoretischer Hintergrund</h2>
<p>Beginnen wir damit was wir eigentlich erreichen wollen. In der folgenden Abbildung siehst du einmal die kontinuierliche Einflussvariable <span class="math inline">\(x\)</span> und den kontinuierlichen Messwert <span class="math inline">\(y\)</span> für sieben Beobachtungen. Jede der Beobachtungen hat einen Wert für <span class="math inline">\(x\)</span> und einen Wert für <span class="math inline">\(y\)</span>. Wir können dann einen Scatterplot zeichnen. Jetzt wollen wir die optimale lineare Grade durch die Punkte finden. Wir erhalten dann die Gradengleichung. Darüber hinaus wollen wir auch noch wissen, wie gut die Grade durch die Punkte läuft.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-lin-reg-theo-00" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lin-reg-theo-00-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-linear-reg-basic_files/figure-html/fig-lin-reg-theo-00-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Abbildung&nbsp;44.5— Visualisierung einer simplen linearen Regression mit einem kontinuierlichen Messwert (y) und einer kontinuierlichen Einflussvariable (x) dargestellt. Eine geschätzte grade wird durch die Punktewolke gelegt. Wie lautet die Gradengleichung und liegen die Punkte auf der Graden? [Zum Vergrößern anklicken]"><img src="stat-linear-reg-basic_files/figure-html/fig-lin-reg-theo-00-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lin-reg-theo-00-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;44.5— Visualisierung einer simplen linearen Regression mit einem kontinuierlichen Messwert (y) und einer kontinuierlichen Einflussvariable (x) dargestellt. Eine geschätzte grade wird durch die Punktewolke gelegt. Wie lautet die Gradengleichung und liegen die Punkte auf der Graden? <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wie finden wir die optimlare Grade? Hier kommt die <a href="https://de.wikipedia.org/wiki/Methode_der_kleinsten_Quadrate">Methode der kleinsten Quadrate</a> (eng. <em>least square method</em>) zum Einsatz. Die Methode ist alt und wird dem Mathematiker Carl Gauß zugeschrieben. Im Jahr 1801 nutze Gaus die Methode um die Bahn des Zwergplaneten Ceres für eien kurze Zeitspanne korrekt vorherzusagen. Wir wollen hier die Methode der kleinsten Quadrate anwenden, um eben die beste Grade durch die Punkte zu finden. Wie wir in den folgenden Abbildung sehen, hat die lineare Grade eine kleinere Summe an Abweichungsquadraten als die quadratische Funktion. Wir würden hier also die blaue Grade der orangenen Graden vorziehen. Prinzipiell müssten wir also eine belibige Anzahl an Graden testen, in der Praxis gibt es aber eine geschlossende Formel für die optimale lineare Grade. Bei nicht linearen Zusammenhängen sieht es dann etwas anders aus. Dazu aber später mehr in dem entsprechenden <a href="stat-modeling-non-linear.html">Kapitel zu nicht lineare Regression</a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-lin-reg-theo-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lin-reg-theo-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-linear-reg-basic_files/figure-html/fig-lin-reg-theo-02-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Abbildung&nbsp;44.6— Methode der kleinsten Quadrate zur Bestimmung der optimalen Grade durch eine Punktewolke. (A) Zwei Gradengleichungen werden beispielhaft durch die Punkte gelegt und die Abweichung der Punkte auf der Graden zu den beobachteten Werten quadriert. Anschließend werden die Abweichungsquadrate aufsummiert. (B) Je kleiner die Fläche der Abweichungsquadrate ist, desto besser passt die Grade zu den Punkten. Hier ist die Fläche der linearen Grade kleiner als der quadratischen Anpassung. [Zum Vergrößern anklicken]"><img src="stat-linear-reg-basic_files/figure-html/fig-lin-reg-theo-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1056"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lin-reg-theo-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;44.6— Methode der kleinsten Quadrate zur Bestimmung der optimalen Grade durch eine Punktewolke. <strong>(A)</strong> Zwei Gradengleichungen werden beispielhaft durch die Punkte gelegt und die Abweichung der Punkte auf der Graden zu den beobachteten Werten quadriert. Anschließend werden die Abweichungsquadrate aufsummiert. <strong>(B)</strong> Je kleiner die Fläche der Abweichungsquadrate ist, desto besser passt die Grade zu den Punkten. Hier ist die Fläche der linearen Grade kleiner als der quadratischen Anpassung. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/angel_01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="images/angel_01.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p><em>Wenn du jetzt denkst ‘Hä?’, dann besuche doch einmal die fantastische Seite <a href="https://setosa.io/ev/ordinary-least-squares-regression/">Explained Visually | Ordinary Least Squares Regression</a> um selber zu erfahren, was eine lineare Regression macht. Auf der Seite findest du interaktive Abbildungen, die dir das Konzept der linearen Regression sehr anschaulich nachvollziehen lassen.</em></p>
</blockquote>
</div>
</div>
</div>
<p>Am Ende modellieren oder minimieren wir die Varianz. Den nichts anders sind ja die Abweichungsquadrate. Je kleiner die Beobachtungen um die Grade streuen, desto besser passt auch die Grade zu den Punkten. Und eine quadratische Streuung in der Statistik ist nichts anderes als die Varianz, die wir schon aus der deskriptiven Statistik kennen.</p>
<p>Nachdem wir die Methode der kleinsten Quadrate durchgeführt haben, kriegen wir folgende Gradengleichung wieder. Die Grade wird durch die Koeffizienten des y-Achsenabschnitts (eng. <em>intercept</em>) und der Steigung (eng. <em>slope</em>) beschrieben. Der nicht durch die Gradengleichung erklärte Rest wird auch Fehler (eng. <em>error</em>) oder im Kontext der linearen Regression dann Residuen genannt.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-in-R-07" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-in-R-07-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-linear-reg-basic_files/figure-html/fig-model-in-R-07-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Abbildung&nbsp;44.7— Formelschreibweise der simplen linearen Regression beinhaltend die Koeffizienten \beta_0 für den y-Achsenabschnitt sowie \beta_1 für die Steigung der Graden für eine Einflussvariable x_1. Die Residuen werden durch \epsilon abgebildet. [Zum Vergrößern anklicken]"><img src="stat-linear-reg-basic_files/figure-html/fig-model-in-R-07-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-in-R-07-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;44.7— Formelschreibweise der simplen linearen Regression beinhaltend die Koeffizienten <span class="math inline">\(\beta_0\)</span> für den y-Achsenabschnitt sowie <span class="math inline">\(\beta_1\)</span> für die Steigung der Graden für eine Einflussvariable <span class="math inline">\(x_1\)</span>. Die Residuen werden durch <span class="math inline">\(\epsilon\)</span> abgebildet. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Die Grade wird somit durch eine Gradengleichung wie oben beschreiben. Du kennst vermutlich noch die Form <span class="math inline">\(y = mx + b\)</span>. In der folgenden Tabelle siehst du nochmal den Vergleich von der Schreibweise der linearen Regression in der Schule und in der Statistik. Darüber hinaus sind die deutschen Begriffe den englischen Begriffen gegenüber gestellt. Warum schreiben wir die Gleichung in der Form? Damit wir später noch weitere <span class="math inline">\(\beta_px_p\)</span>-Paare ergänzen könen und so <a href="stat-modeling-basic.html">multiple lineare Modelle</a> bauen können.</p>
<div id="tbl-reg-deu-eng" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-reg-deu-eng-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;44.2— Vergleich und Übersicht der schulischen vs.&nbsp;statistischen Begriffe in den linearen Regression sowie die deutschen und englischen Begriffe.
</figcaption>
<div aria-describedby="tbl-reg-deu-eng-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Schule</th>
<th style="text-align: center;">Statistik</th>
<th style="text-align: center;">Deutsch</th>
<th style="text-align: center;">Englisch</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(m\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\beta_1\)</span></td>
<td style="text-align: center;">Steigung</td>
<td style="text-align: center;">Slope</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(x\)</span></td>
<td style="text-align: center;"><span class="math inline">\(x_1\)</span></td>
<td style="text-align: center;">Einflussvariable</td>
<td style="text-align: center;">Risk factor</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(b\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\beta_0\)</span></td>
<td style="text-align: center;">y-Achsenabschnitt</td>
<td style="text-align: center;">Intercept</td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(\epsilon\)</span></td>
<td style="text-align: center;">Residuen</td>
<td style="text-align: center;">Residual</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Wir können jetzt die Gradengleichung auch gleich nochmal in der Visualisierung beschriften. In der folgenden Abbildung sehen wir die Visualisierung des kovariaten Beispieldatensatzes. Die Grade läuft durch die Punktewolke und wird durch die statistischen Maßzahlen bzw. Parameter <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span> sowie den <span class="math inline">\(\epsilon\)</span> beschrieben. Wir sehen, dass das <span class="math inline">\(\beta_0\)</span> den <em>Intercept</em> darstellt und das <span class="math inline">\(\beta_1\)</span> die Steigung der Graden. Wenn wir <span class="math inline">\(x\)</span> um 1 Einheit erhöhen <span class="math inline">\(x+1\)</span>, dann steigt der <span class="math inline">\(y\)</span> Wert um den Wert von <span class="math inline">\(\beta_1\)</span>. Die einzelnen Abweichungen der beobachteten <span class="math inline">\(y\)</span>-Wert zu den <span class="math inline">\(y\)</span>-Werten auf der Grade - auch <span class="math inline">\(\hat{y}\)</span> bezeichnet - werden als Residuen oder auch <span class="math inline">\(\epsilon\)</span> abgebildet.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-lin-reg-theo-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lin-reg-theo-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-linear-reg-basic_files/figure-html/fig-lin-reg-theo-01-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Abbildung&nbsp;44.8— Visualisierung einer simplen linearen Regression mit einem kontinuierlichen Messwert (y) und einer kontinuierlichen Einflussvariable (x) dargestellt. Eine geschätzte Grade wird durch die Punktewolke gelegt. Die Grade wird durch die Koeffizienten des Intercept \beta_0 sowie der Steigung \beta_1 beschrieben. [Zum Vergrößern anklicken]"><img src="stat-linear-reg-basic_files/figure-html/fig-lin-reg-theo-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lin-reg-theo-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;44.8— Visualisierung einer simplen linearen Regression mit einem kontinuierlichen Messwert (y) und einer kontinuierlichen Einflussvariable (x) dargestellt. Eine geschätzte Grade wird durch die Punktewolke gelegt. Die Grade wird durch die Koeffizienten des Intercept <span class="math inline">\(\beta_0\)</span> sowie der Steigung <span class="math inline">\(\beta_1\)</span> beschrieben. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Hier wird dann auch nochmal schneller klar, was der y-Achsenabschnitt ist und wie wir die Steigung zu interpretieren haben. Die Steigung sagt aus um welchen Wert sich der Messwert <span class="math inline">\(Y\)</span> ändert, wenn sich die Einflussvariable um eine Einheit erhöht. Die Residuen sind hier auch nochmal dargestellt und beschreiben eben den Rest oder Abstand, den die lineare Gradengleichung nicht an den Messwert beschreiben kann. Wir hätten nur keine Residuen, wenn die Graden sich durch alle Punkte schlängeln würde. Das geht jedoch mit einer linearen Funktion nicht. Außer die Punkte liegen alle auf einer Linie, was in einem biologischen System sehr selten vorkommt.</p>
<p>Schauen wir uns einmal den Zusammenhang von <span class="math inline">\(y\)</span>, den beobachteten Werten, und <span class="math inline">\(\hat{y}\)</span>, den geschätzen Werten auf der Grade in unserem Beispiel an. In der folgenden Tabelle sehen wir die Berechnung der einzelnen Residuen für die Grade aus der obigen Abbildung. Die Daten kannst du dir dann nochmal im Datenabschnitt anschauen. Wir nehmen jedes beobachtete <span class="math inline">\(y\)</span> und ziehen den Wert von <span class="math inline">\(y\)</span> auf der Grade, bezeichnet als <span class="math inline">\(\hat{y}\)</span>, ab. Diesen Schritt machen wir für jedes Wertepaar <span class="math inline">\((y_i; \hat{y}_i)\)</span>. In R werden die <span class="math inline">\(\hat{y}\)</span> auch angepasste Werte (eng <em>fitted values</em>) genannt. Die <span class="math inline">\(\epsilon\)</span> Werte werden dann Residuen (eng. <em>residuals</em>) bezeichnet.</p>
<div id="tbl-lin-reg-epsilon" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-lin-reg-epsilon-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;44.3— Zusammenhang zwischen den <span class="math inline">\(y\)</span>, den beobachteten Werten, und <span class="math inline">\(\hat{y}\)</span>, den geschätzen Werten auf der Grade. Wir nennen den Abstand <span class="math inline">\(y_i - \hat{y}_i\)</span> auch Residuum oder <em>Epsilon</em> <span class="math inline">\(\epsilon\)</span>.
</figcaption>
<div aria-describedby="tbl-lin-reg-epsilon-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">x</th>
<th style="text-align: center;">y</th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{\hat{y}}\)</span></th>
<th style="text-align: center;">Residuen (<span class="math inline">\(\boldsymbol{\epsilon}\)</span>)</th>
<th style="text-align: center;">Wert</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.8</td>
<td style="text-align: center;">1.2</td>
<td style="text-align: center;">1.38</td>
<td style="text-align: center;"><span class="math inline">\(\epsilon_1 = y_1 - \hat{y}_1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\epsilon_1 = 1.2 - 1.38 = -0.18\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">1.0</td>
<td style="text-align: center;">1.8</td>
<td style="text-align: center;">1.48</td>
<td style="text-align: center;"><span class="math inline">\(\epsilon_2 = y_2 - \hat{y}_2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\epsilon_2 = 1.8 - 1.48 = +0.32\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">1.2</td>
<td style="text-align: center;">1.3</td>
<td style="text-align: center;">1.58</td>
<td style="text-align: center;"><span class="math inline">\(\epsilon_3 = y_3 - \hat{y}_3\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\epsilon_3 = 1.3 - 1.58 = -0.28\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">1.9</td>
<td style="text-align: center;">1.7</td>
<td style="text-align: center;">1.94</td>
<td style="text-align: center;"><span class="math inline">\(\epsilon_4 = y_4 - \hat{y}_4\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\epsilon_4 = 1.7 - 1.94 = -0.24\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">2.0</td>
<td style="text-align: center;">2.6</td>
<td style="text-align: center;">1.99</td>
<td style="text-align: center;"><span class="math inline">\(\epsilon_5 = y_5 - \hat{y}_5\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\epsilon_5 = 2.6 - 1.99 = +0.61\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">2.7</td>
<td style="text-align: center;">1.8</td>
<td style="text-align: center;">2.34</td>
<td style="text-align: center;"><span class="math inline">\(\epsilon_6 = y_6 - \hat{y}_6\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\epsilon_6 = 1.8 - 2.34 = -0.54\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">2.8</td>
<td style="text-align: center;">2.7</td>
<td style="text-align: center;">2.40</td>
<td style="text-align: center;"><span class="math inline">\(\epsilon_7 = y_7 - \hat{y}_7\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\epsilon_7 = 2.7 - 2.40 = +0.30\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Die Residuen haben einen Mittelwert von <span class="math inline">\(\bar{\epsilon} = 0\)</span> und eine Varianz von <span class="math inline">\(s^2_{\epsilon} = 0.17\)</span>. Wir schreiben, dass die Residuen normalverteilt sind mit <span class="math inline">\(\epsilon \sim \mathcal{N}(0, s^2_{\epsilon})\)</span>. Wir zeichnen die Grade also so durch die Punktewolke, dass die Abstände zu den Punkten, die Residuen, im Mittel null sind. Die Optimierung erreichen wir in dem wir die Varianz der Residuuen minimieren. Folglich modellieren wir die Varianz.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Weitere Tutorien für die simple lineare Regression
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wir immer geht natürlich mehr als ich hier Vorstellen kann. Du findest im Folgenden Tutorien, die mich hier in dem Kapitel inspiriert haben. Ich habe mich ja in diesem Kapitel auf die Durchführbarkeit in R und die allgemeine Verständlichkeit konzentriert. Es geht aber natürlich wie immer auch mathematischer…</p>
<ul>
<li>Wir funktioniert nun so eine lineare Regression und was sind den jetzt eigentlich die Koeffizienten <span class="math inline">\(\beta_0\)</span> und <span class="math inline">\(\beta_1\)</span> eigentlich? Hier gibt es die fantastische Seite <a href="https://setosa.io/ev/ordinary-least-squares-regression/">Explained Visually | Ordinary Least Squares Regression</a>, die dir nochmal erlaubt selbe mit Punkten in einem Scatterplot zu spielen und zu sehen wie sich dann die Regressionsgleichung ändert.</li>
<li>Du kannst auf der Seite <a href="https://davetang.org/muse/2012/02/10/manual-linear-regression-analysis-using-r/">Manual linear regression analysis using R</a> nochmal weiter über die lineare Regression lesen. Der Blogpost ist sehr umfangreich und erklärt nochmal schrittweise, wie die lineare Regression in R per hand funktioniert.</li>
<li><a href="https://en.wikipedia.org/wiki/Simple_linear_regression#Fitting_the_regression_line">Simple Regression auf Wikipedia</a> mit weit mehr Informationen zu den Formeln und den Zusammenhängen. Ein toller zusammenfassender Artikel.</li>
<li>Mehr zum Modellieren findest du im Openbook “Statistical Thinking for the 21st Century” in den beiden Kapiteln <a href="https://statsthinking21.github.io/statsthinking21-core-site/fitting-models.html#what-is-a-model">Statistical Thinking for the 21st Century — What is a model?</a> und <a href="https://statsthinking21.github.io/statsthinking21-core-site/practical-example.html#the-process-of-statistical-modeling">Statistical Thinking for the 21st Century — Practical statistical modeling?</a></li>
</ul>
</div>
</div>
</section>
<section id="genutzte-r-pakete" class="level2" data-number="44.3">
<h2 data-number="44.3" class="anchored" data-anchor-id="genutzte-r-pakete"><span class="header-section-number">44.3</span> Genutzte R Pakete</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, magrittr, broom,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               readxl, ggpmisc, conflicted)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(magrittr<span class="sc">::</span>set_names)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(ggplot2<span class="sc">::</span>annotate)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>filter)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>An der Seite des Kapitels findest du den Link <em>Quellcode anzeigen</em>, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</p>
</section>
<section id="daten" class="level2" data-number="44.4">
<h2 data-number="44.4" class="anchored" data-anchor-id="daten"><span class="header-section-number">44.4</span> Daten</h2>
<p>Für unsere Anwendung schauen wir uns jetzt einmal drei Datensätze an. Zuerst einen Datensatz mit der Sprungweite als kontinuierlichen Messwert und dem GEwicht als kontinuierliche Einflussvariable. Wir haben hier also einen einkovariaten Datensatz vorliegen. Dann möchte ich noch den Fall mit einer kategorialen Einflussvariable betrachten. Hier nehmen wir dann die verschiedenen Floharten als Faktor mit in den Datensatz. Wir haben dann einen einfaktoriellen Datensatz. Am Ende möchte ich dir immer nochmal zeigen, wie in R theoretisch die Berechnungen läufen. Dafür nutze ich dann einen theoretischen Datensatz mit Schlangenlängen aus <span class="citation" data-cites="kery2010introduction">Kéry (<a href="#ref-kery2010introduction" role="doc-biblioref">2010</a>)</span>. Ich habe den Datensatz leicht angepasst.</p>
<section id="einkovariater-datensatz" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="einkovariater-datensatz">Einkovariater Datensatz</h4>
<p>Wir wollen uns erstmal mit einem einfachen Datenbeispiel beschäftigen. Wir können die lineare Regression auf sehr großen Datensätzen anwenden, wie auch auf sehr kleinen Datensätzen. Prinzipiell ist das Vorgehen gleich. Wir nutzen jetzt aber erstmal einen kleinen Datensatz mit <span class="math inline">\(n=7\)</span> Hundeflöhen als Beobachtungen. In der folgenden Tabelle ist der Datensatz <code>cov1_tbl</code> dargestellt. Wir wollen den Zusammenhang zwischen der Sprungweite in [cm] und dem Gewicht in [mg] für sieben Hundeflöhe modellieren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>cov1_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/regression_data.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"covariate"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann schauen wir uns die Daten einmal in der folgenden Tabelle einmal an. Wir haben die Sprungweite und das Gewicht von sieben Hundeflöhen gemessen. Die Daten sind nach dem gewicht der Flöhe sortiert. Die Einflussvariable ist das Gewicht und der Messwert die Sprungweite.</p>
<div class="cell">
<div id="tbl-1cov-table" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-1cov-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;44.4— Tabelle der Sprungweiten in [cm] als Messwert <span class="math inline">\(y\)</span> und dem Gewicht in [mg] von Hundeflöhen.
</figcaption>
<div aria-describedby="tbl-1cov-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">jump_length</th>
<th style="text-align: center;">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1.2</td>
<td style="text-align: center;">0.8</td>
</tr>
<tr class="even">
<td style="text-align: center;">1.8</td>
<td style="text-align: center;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1.3</td>
<td style="text-align: center;">1.2</td>
</tr>
<tr class="even">
<td style="text-align: center;">1.7</td>
<td style="text-align: center;">1.9</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2.6</td>
<td style="text-align: center;">2.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">1.8</td>
<td style="text-align: center;">2.7</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2.7</td>
<td style="text-align: center;">2.8</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>In der folgenden Abbildung sehen wir die Visualisierung der Daten <code>cov1_tbl</code> in einem Scatterplot mit einer geschätzen Grade durch die Punktewolke. Wir fragen uns, ob das Gewicht der Hundeflöhe einen Einfluss auf die Sprungweite der Flöhe hat. Da wir hier eine positive Steigung haben, können wir schließen, dass wir vermutlich einen positiven Zusammenhang vorliegen haben.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-scatter-lin-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-lin-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-linear-reg-basic_files/figure-html/fig-scatter-lin-01-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Abbildung&nbsp;44.9— Scatterplot der Beobachtungen der Sprungweite in [cm] und dem Gewicht in [mg] für sieben Hundeflöhe. Die Grade verläuft mittig durch die Punkte."><img src="stat-linear-reg-basic_files/figure-html/fig-scatter-lin-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-lin-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;44.9— Scatterplot der Beobachtungen der Sprungweite in [cm] und dem Gewicht in [mg] für sieben Hundeflöhe. Die Grade verläuft mittig durch die Punkte.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="einfaktorieller-datensatz" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="einfaktorieller-datensatz">Einfaktorieller Datensatz</h4>
<p>Etwas seltener in der reinen linearen Regression nutzen wir nur eine kategoriale Einflussvariable. Häufig sind wir dann hier schon in der einfaktoriellen ANOVA oder aber dem statistischen Gruppenvergleich. Hier wollen wir uns jetzt aber mal einen Datensatz mit der Sprungweite in [cm] als Messwert und der Tierart als kategoriale Einflussvariable anschauen. Wir haben die Sprungweite von Hunde-, Katzen- und Fuchsflöhen gemessen. Die Tierart ist unsere Gruppe und damit unserer Faktor.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/regression_data.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"factorial"</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann schauen wir uns die Daten einmal in der folgenden Tabelle als Auszug einmal an. Wichtig ist hier nochmal, dass du eben die Einflussvariable Tierart einen Faktor <code>animal</code> mit drei Leveln also Gruppen vorliegen hast. Wir wollen jetzt die drei Tierarten hinsichtlich ihrer Sprungweite in [cm] miteinander vergleichen.</p>
<div class="cell">
<div id="tbl-1fac-table" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-1fac-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;44.5— Tabelle der Sprungweiten in [cm] als Messwert <span class="math inline">\(y\)</span> von Hunde-, Katzen- und Fuchsflöhen. Der Datensatz ist einfaktoriell, da wir nur einen Faktor vorliegen haben.
</figcaption>
<div aria-describedby="tbl-1fac-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">animal</th>
<th style="text-align: center;">jump_length</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">5.7</td>
</tr>
<tr class="even">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">8.9</td>
</tr>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">11.8</td>
</tr>
<tr class="even">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">10.6</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">8.6</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">10.3</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Und dann wollen wir uns noch einmal die Daten als einen einfachen Boxplot anschauen. Wir sehen, dass die Daten so gebaut sind, dass wir einen signifikanten Unterschied zwischend den Sprungweiten der Floharten erwarten. Die Boxen der Boxplots überlappen sich nicht und die Boxplots liegen auch nicht auf einer Ebene.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-simple-reg-boxplot-1fac" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-simple-reg-boxplot-1fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-linear-reg-basic_files/figure-html/fig-ggplot-simple-reg-boxplot-1fac-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Abbildung&nbsp;44.10— Beispielhafter einfaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten."><img src="stat-linear-reg-basic_files/figure-html/fig-ggplot-simple-reg-boxplot-1fac-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-simple-reg-boxplot-1fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;44.10— Beispielhafter einfaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="theoretischer-datensatz" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="theoretischer-datensatz">Theoretischer Datensatz</h4>
<p>Abschließend kommen wir noch zu einem theoretischen Datensatz dem ich <span class="citation" data-cites="kery2010introduction">Kéry (<a href="#ref-kery2010introduction" role="doc-biblioref">2010</a>)</span> entlehnt habe. Ich möchte nochmal zeigen, wie R intern mit der Modellmatrix die Berechnungen durchführt. Das hat mich interessiert und deshalb habe ich es einmal für mein Verständnis aufgeschrieben. Wenn es dich auch interessiert, dann kannst du in den entsprechenden Tabs weiter unten einmal nachschauen. Hier also erstmal ein sehr simpler theoretischer Datensatz zu Körperlängen von Schlangen. Wir müssen hier dann noch die Faktoren einmal umwandeln, damit wir auch später die Modellmatrix sauber vorliegen haben. Deshalb hier die explizite Benennung der Level in der Funktion <code>factor()</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>snake_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/regression_data.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"theory"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">region =</span> <span class="fu">factor</span>(region, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"west"</span>, <span class="st">"nord"</span>)),</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="fu">factor</span>(color, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"schwarz"</span>, <span class="st">"rot"</span>, <span class="st">"blau"</span>)))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der folgenden Tabelle ist der Datensatz <code>snake_tbl</code> nochmal dargestellt. Wir haben die Schlangenlänge <code>svl</code> als Messwert <span class="math inline">\(y\)</span> sowie das Gewicht der Schlangen <code>mass</code> als kontinuierliche Einflussvariable, die Sammelregion <code>region</code> und die Farbe der Schlangen <code>color</code> und als kategoriale Einflussvariablen mit unterschiedlichen Anzahlen an Gruppen. Die Region <code>region</code> ist also ein Faktor mit zwei Leveln und die Schlangenfarbe <code>color</code> ein Faktor mit drei Leveln. Ich nutze den Datensatz also einmal als einen Spieldatensatz um die Modellierung theoretisch besser nachvollziehen zu können.</p>
<div class="cell">
<div id="tbl-snakes" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-snakes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;44.6— Datensatz zu den Körperlängen als Messwert von acht Schlangen mit verschiedenen Einflussvariablen. Die Einflussvariablen haben verschiedene Eigenschaften und müssen daher unterschiedliche modelliert werden.
</figcaption>
<div aria-describedby="tbl-snakes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">svl</th>
<th style="text-align: center;">mass</th>
<th style="text-align: center;">region</th>
<th style="text-align: center;">color</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">40</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">west</td>
<td style="text-align: center;">schwarz</td>
</tr>
<tr class="even">
<td style="text-align: center;">45</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">west</td>
<td style="text-align: center;">schwarz</td>
</tr>
<tr class="odd">
<td style="text-align: center;">39</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">west</td>
<td style="text-align: center;">rot</td>
</tr>
<tr class="even">
<td style="text-align: center;">51</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">nord</td>
<td style="text-align: center;">rot</td>
</tr>
<tr class="odd">
<td style="text-align: center;">52</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">nord</td>
<td style="text-align: center;">rot</td>
</tr>
<tr class="even">
<td style="text-align: center;">57</td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">nord</td>
<td style="text-align: center;">blau</td>
</tr>
<tr class="odd">
<td style="text-align: center;">58</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">nord</td>
<td style="text-align: center;">blau</td>
</tr>
<tr class="even">
<td style="text-align: center;">49</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">nord</td>
<td style="text-align: center;">blau</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
</section>
<section id="kausales-modell" class="level2" data-number="44.5">
<h2 data-number="44.5" class="anchored" data-anchor-id="kausales-modell"><span class="header-section-number">44.5</span> Kausales Modell</h2>
<p>Beginnen wir einmal mit dem kausalen Modell. Wir wollen also wissen, wie sich der Messwert <span class="math inline">\(y\)</span> ändert, wenn sich die Einflussvariable erhöht. Wir fragen hier also nach der Steigung. Da wir eine lineare Grade vorliegen haben, ist es eben einfach, wir müssen den Koeffizienten für die Steigung bestimmen und dann noch Testen. Wir wollen ja wissen, ob der Effekt auch signifikant ist. Mit dem Effekt meinen wir im Kontext der linearen Regression eben den Koeffizienten der Steigung. Wir betrachten jetzt also einmal das einkovariate Modell, mit einer kontinuierlichen Einflussvariable sowie einem faktoriellen Modell, mit einer kategorialen Variable. Der Messwert hier ist dann immer die kontinuierliche Sprungweite.</p>
<section id="einkovariates-modell" class="level3" data-number="44.5.1">
<h3 data-number="44.5.1" class="anchored" data-anchor-id="einkovariates-modell"><span class="header-section-number">44.5.1</span> Einkovariates Modell</h3>
<p>Die simple lineare Regression ist ein einkovariates Modell. Häufig wird das einkovariate Modell dann einfach nur die lineare Regression genannt. Wir haben einen kontinuierlichen Messwert sowie eine kontinuierliche Einflussvariable. Wir nennen die kontinuierliche Einflussvariable eine Kovariate. Es ergibt sich dann das folgende abstrakte simple Modell. Auf der linken Seite ist der MEsswert und auf der rechten Seite der Tilde ist unsere eine Kovariate.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-in-R-10" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-in-R-10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-linear-reg-basic_files/figure-html/fig-model-in-R-10-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Abbildung&nbsp;44.11— Schemantisches simples Modell mit einem Messwert Y und einer kontinuierlichen Einflussvariable als Kovariate c_1 dargestellt. [Zum Vergrößern anklicken]"><img src="stat-linear-reg-basic_files/figure-html/fig-model-in-R-10-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-in-R-10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;44.11— Schemantisches simples Modell mit einem Messwert <span class="math inline">\(Y\)</span> und einer kontinuierlichen Einflussvariable als Kovariate <span class="math inline">\(c_1\)</span> dargestellt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Jetzt können wir dieses theoretische Modell einmal auf unser Beispiel zu den Sprungweiten als kontinuierlichen Messwert sowie dem Körpergewicht als Kovariate anwenden. Du findest in den folgenden Tabs einmal die Auswertung in R durch die Funktionen sowie die theoretische Betrachtung, wie R das kovariate Modell intern verrechnet. Aus praktischer Sicht brauchts du nur den ersten Tab.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Praktisch in R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Theoretisch in R</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Für die lineare Regression nutzen wir die Funktion <code>lm()</code> (eng. <em>linear model</em>) mit der Formelschreibweise. Wir schreiben auf der linken Seite den Messwert und auf die rechte Seite der Tilde dann die Kovariate. Dann müssen wir noch angeben in welchem Datensatz die beiden Variablen als Spalten zu finden sind. Dann schieben wir noch die Modellanpassung (eng. <em>fit</em>) in ein Objekt um uns verschiedene Informationen später ausgeben zu lassen. Mit Modelanpassung meinen wir, dass wir schauen, ob wir ein Modell finden, was zu den Daten passt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>cov1_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> weight, <span class="at">data =</span> cov1_tbl) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Mit der Funktion <code>coef()</code> können wir dann die Koeffizienten der linearen Regression extrahieren. Wir erhalten einmal den Intercept als den y-Achsenabschnitt und die Steigung wieder. Die Steigung wird hier unter dem Namen der Spalte geschrieben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>cov1_fit <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)      weight 
  0.9686434   0.5096368 </code></pre>
</div>
</div>
<p>Wir erhalten also einen y-Achsenabschnitt <span class="math inline">\(\beta_0\)</span> von <span class="math inline">\(0.969\)</span> sowie eine Steigung <span class="math inline">\(\beta_1\)</span> von <span class="math inline">\(0.51\)</span> wiedergegeben. In der folgenden Abbildung sehen wir dann einmal die Gerade durch die Punkte zusammen mit der Gradengleichung. Ich nutze hier die Funktion <code>stat_poly_line()</code> und die Funktion <code>stat_poly_eq()</code> um mir die Grade sowie die Gradengleichung einzeichnen zu lassen. Beide Funktionen findest du in dem <a href="https://cran.rstudio.com/web/packages/ggpmisc/vignettes/user-guide.html">R Paket <code>{ggpmisc}</code></a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-in-R-c1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-in-R-c1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-linear-reg-basic_files/figure-html/fig-model-in-R-c1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Abbildung&nbsp;44.12— Scatterplot der Sprungweite in [cm] und dem Gewicht in [mg] von sieben Hundeflöhen. Die lineare Grade und die Gradengleichung wurden ergänzt. [Zum Vergrößern anklicken]"><img src="stat-linear-reg-basic_files/figure-html/fig-model-in-R-c1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-in-R-c1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;44.12— Scatterplot der Sprungweite in [cm] und dem Gewicht in [mg] von sieben Hundeflöhen. Die lineare Grade und die Gradengleichung wurden ergänzt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Eigentlich wollen wir ja ein kausales Modell rechnen, da wir an dem Effekt der Kovariate Gewicht in [mg] der Hundeflöhe interessiert sind. Wenn also die Kovariate <span class="math inline">\(c_1\)</span> um eine Einheit ansteigt, um wie viel verändert sich dann der Messwert <span class="math inline">\(y\)</span>?</p>
<p>Der Koeffizient <span class="math inline">\(\beta_1\)</span> als Steigung der Graden gibt uns also den Einfluss oder den kausalen Zusammenhang zwischen dem Messwert <span class="math inline">\(y\)</span> und der Kovariate <span class="math inline">\(c_1\)</span> wieder. Im einem ersten Schritt schauen wir uns die Ausgabe der Funktion <code>summary()</code> unseres Modells an.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>cov1_fit <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir erhalten dann folgende Ausgabe mit den entsprechenden Kurzerkläruungen von mir. Keine Angst, die gehen wir dann alle in den nächsten Paragraphen einmal durch.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-in-R-c1-summary" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-in-R-c1-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-linear-reg-basic_files/figure-html/fig-model-in-R-c1-summary-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Abbildung&nbsp;44.13— Annotierte Ausgabe der Funktion summary() aus einer linearen Modellanpassung mit der Funktion lm(). Die Ausgabe der Funktion teilt sich grob in drei informative Bereiche: Informationen zu den Residuen, Informationen zu den Koeffizienten und Informationen zu der Modelgüte. [Zum Vergrößern anklicken]"><img src="stat-linear-reg-basic_files/figure-html/fig-model-in-R-c1-summary-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-in-R-c1-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;44.13— Annotierte Ausgabe der Funktion <code>summary()</code> aus einer linearen Modellanpassung mit der Funktion <code>lm()</code>. Die Ausgabe der Funktion teilt sich grob in drei informative Bereiche: Informationen zu den Residuen, Informationen zu den Koeffizienten und Informationen zu der Modelgüte. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Zuerst sehen wir nochmal welche Funktion wir aufgerufen haben und welches Modell gerechnet wurde. Dann kommen die Informationen zu den Residuen. Wenn alle Beobachtungen auf der Graden liegen würden, dann wären alle Residuen gleich Null. Bei zu wenigen Beobachtungen erhalten wir dann leider keine zusammenfassende Information zu den Residuen. Die Information zum Median und den Quartilen müssen wir uns dann selber einmal bauen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>cov1_fit <span class="sc">|&gt;</span> <span class="fu">residuals</span>() <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-0.5447 -0.2586 -0.1764  0.0000  0.3130  0.6121 </code></pre>
</div>
</div>
<p>Die negativen Abweichungen und die positiven Abweichungen sollten sich auf Null aufaddieren. Der Median sollte ebenfalls dabei Null sein. Das 1st Quartile und das 3rd Quartile sollten ebenfalls im Betrag gleich sein. Deshalb sind auch die Residuen bei einer guten Modellanpassung normalverteilt mit einem Mittelwert von Null. Hier haben wir aber einigermaßen normalverteilte Residuen vorliegen. Die Residuen schauen wir uns aber nochmal im <a href="stat-linear-reg-quality.html">Kapitel zur Modelgüte</a> genauer an.</p>
<p>Der Reststandardfehler (R <code>Residual standard error</code>, abk. <em>RSE</em>) hat mehrere Vorteile. Er sagt dir direkt, wie genau die Vorhersagen des Modells unter Verwendung der Einheiten des Messwertes sind. Der Reststandardfehler gibt an, wie weit die Datenpunkte im Durchschnitt von der Graden entfernt sind.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Achtung, bitte beachten!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Du erhälst immer eine Grade und du erhälst faktisch immer eine Modellanpassung. Du musst dann selber entscheiden, ob dein Modell zu den Daten passt. Deshalb schauen wir uns auch die Residuen an und schauen, ob die Annahme der Normalverteilung an die Residuen erfüllt ist. Wenn dies nicht der Fall ist, dann passt unser Modell nicht zu den Daten und wir müssen ein anderes Modell ausprobieren.</p>
</div>
</div>
<p>Als nächstes erhalten wir die Informationen zu den Koeffizienten. Die Koeffizienten sind in einem simplen Modell der Intercept und die Steigung. Die Steigung hat immer den Namen der betrachteten Kovariate. Hier nochmal die Wiedergabe der Koeffizienten als Auszug von der obigen Tabelle.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>             Estimate Std. Error  t value   Pr(&gt;|t|)
(Intercept) 0.9686434  0.4447001 2.178195 0.08129789
weight      0.5096368  0.2315464 2.201013 0.07899303</code></pre>
</div>
</div>
<p>Das heißt, wir kriegen dort <span class="math inline">\(\beta_0\)</span> als y-Achsenabschnitt sowie die Steigung <span class="math inline">\(\beta_1\)</span> für das Gewicht. Dabei ist wichtig zu wissen, dass immer als erstes der y-Achsenabschnitt <code>(Intercept)</code> auftaucht. Dann die Steigung der Kovariate in dem Modell. Wir können die Gradengleichung wie folgt formulieren.</p>
<p><span class="math display">\[
jump\_length \sim 0.97 + 0.51 \cdot weight
\]</span></p>
<p>Was heißt die Gleichung nun? Wenn wir das Gewicht um eine Einheit erhöhen dann verändert sich die Sprungweite um den Wert von <span class="math inline">\(\beta_1\)</span>. Wir haben hier eine Steigung von <span class="math inline">\(0.51\)</span> vorliegen. Ohne Einheit keine Interpretation! Wir wissen, dass das Gewicht in [mg] gemessen wurde und die Sprungweite in [cm]. Damit können wir aussagen, dass wenn ein Floh 1 mg mehr wiegt der Floh 0.51 cm weiter springen würde. Schauen wir nochmal in die <em>saubere</em> Ausgabe der <code>tidy()</code> Funktion aus dem R Paket <code>{broom}</code>. Wir sehen nämlich noch einen <span class="math inline">\(p\)</span>-Wert für den Intercept und die Steigung vom Gewicht.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>cov1_fit <span class="sc">|&gt;</span> <span class="fu">tidy</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 (Intercept)    0.969     0.445      2.18  0.0813
2 weight         0.510     0.232      2.20  0.0790</code></pre>
</div>
</div>
<p>Da wir hier einen p-Wert für jeden Koeffizienten haben, müssen wir auch einen Test rechnen. Wenn wir einen <span class="math inline">\(p\)</span>-Wert sehen, dann brauchen wir eine Nullhypothese, die wir dann eventuell mit der Entscheidung am Signifikanzniveau <span class="math inline">\(\alpha\)</span> von 5% ablehnen können. Die Nullhypothese ist die Gleichheitshypothese. Wenn es also keinen Effekt von dem Gewicht auf die Sprungweite gebe, wie groß wäre dann <span class="math inline">\(\beta_1\)</span>? Wir hätten dann keine Steigung und die Grade würde parallel zur x-Achse laufen. Das <span class="math inline">\(\beta_1\)</span> wäre dann gleich Null. Die Nullhypothesen lauten dabei also jedesmal, dass die Koeffizienten gleich Null sind. Wir testen also, ob wir einen Intercept von Null und eine Steigung von Null als Nullhypothese ablehnen können. Wenn wir <span class="math inline">\(i\)</span> Koeffizienten haben, dann haben wir alle alle <span class="math inline">\(i\)</span> Koeffizienten die folgenden Hypothesenpaare.</p>
<p><span class="math display">\[
\begin{align*}
H_0: \beta_i &amp;= 0\\  
H_A: \beta_i &amp;\neq 0 \\   
\end{align*}
\]</span></p>
<p>Wir haben für jedes <span class="math inline">\(\beta_i\)</span> ein eigenes Hypothesenpaar. Meistens interessiert uns der Intercept nicht. Ob der Intercept nun durch die Null geht oder nicht ist eher von geringem Interesse. Spannender ist aber wie sich der <span class="math inline">\(p\)</span>-Wert berechnet. Der <span class="math inline">\(p\)</span>-Wert basiert auf einer t-Statistik, also auf dem t-Test. Wir rechnen für jeden Koeffizienten <span class="math inline">\(\beta_i\)</span> einen t-Test. Das machen wir in dem wir den Koeffizienten <code>estimate</code> durch den Fehler des Koeffizienten <code>std.error</code> teilen.</p>
<p><span class="math display">\[
\begin{align*}
T_{(Intercept)} &amp;= \cfrac{\mbox{estimate}}{\mbox{std.error}}  = \cfrac{0.969}{0.445} = 2.18\\  
T_{weight} &amp;= \cfrac{\mbox{estimate}}{\mbox{std.error}}  = \cfrac{0.510}{0.232} = 2.20\\   
\end{align*}
\]</span></p>
<p>Wir sehen in diesem Fall, dass weder der Intercept noch die Steigung vom Gewicht signifikant sind, da die p-Werte mit <span class="math inline">\(0.081\)</span> und <span class="math inline">\(0.079\)</span> leicht über dem Signifikanzniveau von <span class="math inline">\(\alpha\)</span> gleich 5% liegen. Wir haben aber einen starkes Indiz gegen die Nullhypothese, da die Wahrscheinlichkeit die Daten zu beobachten sehr gering ist unter der Annahme das die Nullhypothese gilt.</p>
<p>Zun Abschluß noch die Funktion <code>glance()</code> ebenfalls aus dem R Paket <code>{broom}</code>, die uns erlaubt noch die Qualitätsmaße der linearen Regression zu erhalten. Klar sehen wir die Werte auch alle in dem dritten Abschnitt der Ausgabe, aber hier haben wir nochmal alles zusammen. Wir müssen nämlich noch schauen, ob die Regression auch funktioniert hat. Die Überprüfung geht mit einer Kovariate sehr einfach. Wir können uns die Grade ja anschauen. Das geht dann mit einem Model mit mehreren Einflussvariablen nicht mehr und wir brauchen andere statistische Maßzahlen. Im <a href="stat-linear-reg-quality.html">Kapitel zur Modelgüte</a> diskutieren wir die statistischen Maßzahlen nochmal genauer. Hier reicht es zu wissen, dass wir ein hohes Bestimmtheitsmaß <span class="math inline">\(R^2\)</span> (eng. <em>r squared</em>) nahe Eins haben wollen. Unser Bestimmtheitsmaß liegt hier bei <span class="math inline">\(0.492\)</span> und ist somit gerade in Ordnung.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>cov1_fit <span class="sc">|&gt;</span> <span class="fu">glance</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.492         0.391 0.455      4.84  0.0790     1  -3.24  12.5  12.3
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
</div>
<p>Der p-Wert in der Ausgabe soll dich nicht irrtieren sondern dieser stammt aus einer ANOVA, die in diesem simplen Fall das gleiche testet wie der t-Test in der Zeile zum Gewicht. Wir erghhalten ja auch den gleichen p-Wert. Wir testen hier, ob unsere Kovariate einen Einfluss auf die Sprungweite im Allgemeinen hat. Hier nochmal die ANOVA ausgeschrieben mit der Funktion <code>aov()</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> weight, <span class="at">data =</span> cov1_tbl) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)  
weight       1  1.001  1.0011   4.844  0.079 .
Residuals    5  1.033  0.2066                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Ganz am Ende möchte ich dir noch die Funktion <code>augment()</code> aus dem Paket <code>{broom}</code> zeigen die dir kompakt alle Informationen zu den einzelnen Beobachtungen gibt. Die <code>.fitted</code>-Werte sind dabei die vorhergesagten Messwerte auf der Graden. Den Rest schauen wir uns dann noch in dem <a href="stat-linear-reg-quality.html">Kapitel zur Modelgüte</a> oder dem <a href="stat-modeling-outlier.html">Kapitel zu den Ausreißern</a> teilweise an.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>cov1_fit <span class="sc">|&gt;</span> <span class="fu">augment</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 8
  jump_length weight .fitted .resid  .hat .sigma .cooksd .std.resid
        &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;
1         1.2    0.8    1.38 -0.176 0.388  0.496  0.0778     -0.496
2         1.8    1      1.48  0.322 0.297  0.471  0.151       0.844
3         1.3    1.2    1.58 -0.280 0.228  0.483  0.0725     -0.701
4         1.7    1.9    1.94 -0.237 0.147  0.492  0.0275     -0.564
5         2.6    2      1.99  0.612 0.156  0.384  0.199       1.47 
6         1.8    2.7    2.34 -0.545 0.367  0.376  0.656      -1.51 
7         2.7    2.8    2.40  0.304 0.417  0.467  0.276       0.877</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/personal_opinion.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="images/personal_opinion.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p><em>“Warum das kovariate Modell nochmal so zerforschen? Weil es mich interessiert hat, wie die Modelle intern gerechnet werden. Vor allem liest man schnell von einer Modellmatrix im Zusammenhang der Modellierung. Hier also mal alles sehr zerforscht. Braucht man nicht um es anzuwenden, ist aber hilfreich zu wissen. Denke ich.” — Jochen Kruppa-Scheetz, meiner bescheidener Meinung nach.</em></p>
</blockquote>
</div>
</div>
</div>
<p>Fangen wir also einmal an das kovariate Modell zu zerforschen. In einem ersten Schritt wollen wir uns einmal das lineare Modell mit einer kontinuierlichen Einflussvariable anschauen. Daher bauen wir uns ein lineares Modell mit der Kovariate <code>mass</code> aus unseren Schlangendaten und der Körperlänge der Schlangen <code>svl</code> als Messwert. Die Schlangendaten habe ich extra so gebaut, dass wir uns hier leicht was anschauen können. Wir erinnern uns, dass die Einslussvariable <code>mass</code> eine kontinuierliche Variable ist, da wir hier nur Zahlen in der Spalte finden. Die Funktion <code>model.matrix()</code> gibt uns die Modellmatrix wieder.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(svl <span class="sc">~</span> mass, <span class="at">data =</span> snake_tbl) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 2
  `(Intercept)`  mass
          &lt;dbl&gt; &lt;dbl&gt;
1             1     6
2             1     8
3             1     5
4             1     7
5             1     9
6             1    11
7             1    12
8             1    10</code></pre>
</div>
</div>
<p>In der ersten Spalte ist der Intercept angegeben, danach folgt dann die Spalte <code>mass</code> als Kovariate. Wir können jetzt die Modellmatrix auch mathematisch schreiben und die <span class="math inline">\(y\)</span> Spalte für den Messwert <code>svl</code> ergänzen. Eben so ergänzen wir die Koeffizienten <span class="math inline">\(\beta_0\)</span> als Intercept und <span class="math inline">\(beta_{mass}\)</span> als Steigung aus der linearen Regression sowie die Residuen als Abweichung von der angepassten Grade.</p>
<p><span class="math display">\[
\begin{pmatrix}
  40 \\
  45 \\
  39 \\
  50 \\
  52 \\
  57 \\
  58 \\
  59 \\
\end{pmatrix}
=
  \begin{pmatrix}
  1 &amp; 6 \\
  1 &amp; 8 \\
  1 &amp; 5 \\
  1 &amp; 7 \\
  1 &amp; 9 \\
  1 &amp; 11\\
  1 &amp; 12\\
  1 &amp; 10\\
\end{pmatrix}
\times
  \begin{pmatrix}
  \beta_0 \\
  \beta_{mass}
\end{pmatrix} +
  \begin{pmatrix}
  \epsilon_1 \\
  \epsilon_2 \\
  \epsilon_3 \\
  \epsilon_4 \\
  \epsilon_5 \\
  \epsilon_6 \\
  \epsilon_7 \\
  \epsilon_8 \\
\end{pmatrix}
\]</span></p>
<p>Jetzt brauche wir natürlich die Koeffizienten aus dem linearen Modell, welches wir wie folgt mit der Funktion <code>lm()</code> fitten. Wir nutzen dann die Funktion <code>coef()</code> um uns die Koeffizienten aus dem Objekt <code>fit_1</code> wiedergeben zu lassen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>snake_cov_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(svl <span class="sc">~</span> mass, <span class="at">data =</span> snake_tbl) </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>snake_cov_fit <span class="sc">|&gt;</span> <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)        mass 
      26.71        2.61 </code></pre>
</div>
</div>
<p>Die Funktion <code>residuals()</code> gibt uns die Residuen der Graden aus dem Objekt <code>snake_cov_fit</code> wieder.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>snake_cov_fit <span class="sc">|&gt;</span> <span class="fu">residuals</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    1     2     3     4     5     6     7     8 
-2.36 -2.57 -0.75  6.04  1.82  1.61  0.00 -3.79 </code></pre>
</div>
</div>
<p>Wir können jetzt die Koeffizienten in die Modellmatrix ergänzen. Wir haben den Intercept mit <span class="math inline">\(\beta_0 = 26.71\)</span> geschätzt. Weiter ergänzen wir die Steigung aus dem linearen Modell für <code>mass</code> mit <span class="math inline">\(\beta_{mass}=2.61\)</span>. Ebenfalls setzen wir Werte für die Residuen für jede der Beobachtungen in die Gleichung ein. Wir erhalten dann folgende ausgefüllte Gleichung.</p>
<p><span class="math display">\[
\begin{pmatrix}
  40 \\
  45 \\
  39 \\
  50 \\
  52 \\
  57 \\
  58 \\
  59 \\
\end{pmatrix}
=
  \begin{pmatrix}
  26.71 &amp; \phantom{0}6 \cdot 2.61\\
  26.71 &amp; \phantom{0}8 \cdot 2.61\\
  26.71 &amp; \phantom{0}5 \cdot 2.61\\
  26.71 &amp; \phantom{0}7 \cdot 2.61\\
  26.71 &amp; \phantom{0}9 \cdot 2.61\\
  26.71 &amp; 11\cdot 2.61\\
  26.71 &amp; 12\cdot 2.61\\
  26.71 &amp; 10\cdot 2.61\\
\end{pmatrix}
  +
  \begin{pmatrix}
  -2.36\\
  -2.57\\
  -0.75 \\
  +6.04\\
  +1.82\\
  +1.61\\
  \phantom{+}0.00\\
  -3.79\\
\end{pmatrix}
\]</span></p>
<p>Wir können jetzt diese gewaltige Sammlung an Matrixen einmal auflösen. Steht denn nun wirklich rechts das Gleiche wie links von der Gleichung? Wir bauen uns die Zahlen von der rechten Seite der Gleichung einmal in R nach und schauen auf das Ergebnis. Wie du siehst ergänzen wir hier noch eine Reihe von Additionen um den Intercept mit der Steigung zu verbinden. Steht ja auch so in der Gleichung des linearen Modells drin, alles wird mit einem Plus miteinander verbunden.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fl">26.71</span> <span class="sc">+</span>  <span class="dv">6</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">-</span> <span class="fl">2.36</span>,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.71</span> <span class="sc">+</span>  <span class="dv">8</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">-</span> <span class="fl">2.57</span>,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.71</span> <span class="sc">+</span>  <span class="dv">5</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">-</span> <span class="fl">0.75</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.71</span> <span class="sc">+</span>  <span class="dv">7</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">+</span> <span class="fl">6.04</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.71</span> <span class="sc">+</span>  <span class="dv">9</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">+</span> <span class="fl">1.82</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.71</span> <span class="sc">+</span> <span class="dv">11</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">+</span> <span class="fl">1.61</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.71</span> <span class="sc">+</span> <span class="dv">12</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">+</span> <span class="fl">0.00</span>,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.71</span> <span class="sc">+</span> <span class="dv">10</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">-</span> <span class="fl">3.79</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 40 45 39 51 52 57 58 49</code></pre>
</div>
</div>
<p>Oh ha! Die Zahlen, die wir rauskriegen, sind die gleichen Werte die unser Messwert der Schlangenlänge hat. Das heißt, die ganze Sache hat funktioniert. Wir können die Schlangenlänge durch die Kovariate der Körpermasse mit zwei Koeffizienten aus einem linearen Modell erklären.</p>
</div>
</div>
</div>
<p>Dann kommt hier noch ein kleiner Einschub. So wie Gauß kannst du auch die lineare Regression händisch ausrechnen. Das macht sicherlich auch dem einen oder anderen Spaß, aber nicht jedem. Ich zeige dir in dem folgenden Kasten einmal wie sich das einkovariate Modell händisch auflösen lässt. Und ja, ich nutze dann auch hier R um die Funktionen durchzuführen. Am Ende ist es dann aber auch eher ein großer Taschenrechner, den ich mit R nutze. Viel Spaß beim nachmachen.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Simple lineare Regression händisch
</div>
</div>
<div class="callout-body-container callout-body">
<p>Gut, das war jetzt die theoretische Abhandlung der linearen Regression ohne eine mathematische Formel. Es geht natürlich auch mit den nackten Zahlen. In der folgenden Tabelle siehst du einmal sieben Beobachtungen mit dem Körpergewicht als <span class="math inline">\(y\)</span> sowie der Körpergröße als <span class="math inline">\(x\)</span>. Wir wollen jetzt einmal die Regressionsgleichung bestimmen. Wir sehen also unsere Werte für <span class="math inline">\(\beta_0\)</span> und <span class="math inline">\(\beta_1\)</span> aus?</p>
<div class="cell">
<div id="tbl-example-by-hand-01" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example-by-hand-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;44.7— Sieben Messungen der Körpergröße <span class="math inline">\(x\)</span> und dem zugehörigen Körpergewicht <span class="math inline">\(y\)</span>.
</figcaption>
<div aria-describedby="tbl-example-by-hand-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">height</th>
<th style="text-align: center;">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">167</td>
<td style="text-align: center;">70</td>
</tr>
<tr class="even">
<td style="text-align: center;">188</td>
<td style="text-align: center;">83</td>
</tr>
<tr class="odd">
<td style="text-align: center;">176</td>
<td style="text-align: center;">81</td>
</tr>
<tr class="even">
<td style="text-align: center;">186</td>
<td style="text-align: center;">90</td>
</tr>
<tr class="odd">
<td style="text-align: center;">192</td>
<td style="text-align: center;">94</td>
</tr>
<tr class="even">
<td style="text-align: center;">205</td>
<td style="text-align: center;">100</td>
</tr>
<tr class="odd">
<td style="text-align: center;">198</td>
<td style="text-align: center;">106</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Damit wir einmal wissen, was wir als Lösung erhalten würden, hier einmal die lineare Regression mit der Funktion <span class="math inline">\(lm()\)</span> und die entsprechenden Werte für den <code>(Intercept)</code> und der Steigung.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(weight <span class="sc">~</span> height, <span class="at">data =</span> by_hand_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)      height 
 -75.390377    0.877845 </code></pre>
</div>
</div>
<p>Wir suchen dann damit die folgende Regressionsgleichung mit der Körpergröße als <span class="math inline">\(x\)</span> und dem zugehörigen Körpergewicht als <span class="math inline">\(y\)</span>.</p>
<p><span class="math display">\[
weight = \beta_0 + \beta_1 \cdot height
\]</span></p>
<p>Da es dann immer etwas schwer ist, sich den Zusammenhang zwischen Körpergewicht und Körpergröße vorzustellen, habe ich nochmal in der folgenden Abbildung den Scatterplot der Daten erstellt. Die rote Grade stellt die Regressiongleichung dar. Wir erhalten ein y-Achsenabschnitt mit <span class="math inline">\(\beta_0\)</span> von <span class="math inline">\(-75.39\)</span> sowie eine Steigung mit <span class="math inline">\(\beta_1\)</span> von <span class="math inline">\(0.88\)</span> aus unseren Daten.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(by_hand_tbl, <span class="fu">aes</span>(height, weight)) <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> \(x) <span class="sc">-</span><span class="fl">75.39</span> <span class="sc">+</span> <span class="fl">0.88</span> <span class="sc">*</span> x, <span class="at">color =</span> <span class="st">"#CC79A7"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-example-by-hand-03" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example-by-hand-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-linear-reg-basic_files/figure-html/fig-example-by-hand-03-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Abbildung&nbsp;44.14— Scatterplot der sieben Messungen der Körpergröße x und dem zugehörigen Körpergewicht y sowie der RegressionsGrade mit y = -75.39 + 0.88 \cdot x. Die Grade verlauf wie erwartet mittig durch die Punktewolke."><img src="stat-linear-reg-basic_files/figure-html/fig-example-by-hand-03-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example-by-hand-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;44.14— Scatterplot der sieben Messungen der Körpergröße <span class="math inline">\(x\)</span> und dem zugehörigen Körpergewicht <span class="math inline">\(y\)</span> sowie der RegressionsGrade mit <span class="math inline">\(y = -75.39 + 0.88 \cdot x\)</span>. Die Grade verlauf wie erwartet mittig durch die Punktewolke.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Jetzt stellt sich die Frage, wie wir <em>händisch</em> die Werte für den y-Achsenabschnitt mit <span class="math inline">\(\beta_0\)</span> sowie der Steigung mit <span class="math inline">\(\beta_1\)</span> berechnen. Dafür gibt es jeweils eine Formel. Hier müssen wir dann sehr viele Summen berechnen, was ich dann gleich einmal in einer Tabelle zusammenfasse.</p>
<dl>
<dt>Formel für y-Achsenabschnitt mit <span class="math inline">\(\beta_0\)</span></dt>
<dd>
<p><span class="math display">\[
\beta_0 = \cfrac{(\Sigma Y)(\Sigma X^2) - (\Sigma X)(\Sigma XY)}{n(\Sigma X^2) - (\Sigma X)^2}
\]</span></p>
</dd>
<dt>Formel für Steigung mit <span class="math inline">\(\beta_1\)</span></dt>
<dd>
<p><span class="math display">\[
\beta_1 = \cfrac{n(\Sigma XY) - (\Sigma X)(\Sigma Y)}{n(\Sigma X^2) - (\Sigma X)^2}
\]</span></p>
</dd>
</dl>
<p>In der folgenden Tabelle siehst du nochmal die originalen Datenpunkte und dann die entsprechenden Werte für das Produkt von <code>weight</code> und <code>height</code> mit <span class="math inline">\(XY\)</span> und dann die jeweiligen Quadrate der beiden mit <span class="math inline">\(X^2\)</span> und <span class="math inline">\(Y^2\)</span>. Wir brauchen dann aber nicht diese Werte sondern die Summen der Werte. Das Summieren lagere ich dann nochmal in eine weitere Tabelle aus.</p>
<div class="cell">
<div id="tbl-example-by-hand-02" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example-by-hand-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;44.8— Berechnungen des Produkts von <span class="math inline">\(X\)</span> und <span class="math inline">\(Y\)</span> sowie deren Quadrate mit <span class="math inline">\(X^2\)</span> und <span class="math inline">\(Y^2\)</span>.
</figcaption>
<div aria-describedby="tbl-example-by-hand-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">height</th>
<th style="text-align: center;">weight</th>
<th style="text-align: center;"><span class="math inline">\(XY\)</span></th>
<th style="text-align: center;"><span class="math inline">\(X^2\)</span></th>
<th style="text-align: center;"><span class="math inline">\(Y^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">167</td>
<td style="text-align: center;">70</td>
<td style="text-align: center;">11690</td>
<td style="text-align: center;">27889</td>
<td style="text-align: center;">4900</td>
</tr>
<tr class="even">
<td style="text-align: center;">188</td>
<td style="text-align: center;">83</td>
<td style="text-align: center;">15604</td>
<td style="text-align: center;">35344</td>
<td style="text-align: center;">6889</td>
</tr>
<tr class="odd">
<td style="text-align: center;">176</td>
<td style="text-align: center;">81</td>
<td style="text-align: center;">14256</td>
<td style="text-align: center;">30976</td>
<td style="text-align: center;">6561</td>
</tr>
<tr class="even">
<td style="text-align: center;">186</td>
<td style="text-align: center;">90</td>
<td style="text-align: center;">16740</td>
<td style="text-align: center;">34596</td>
<td style="text-align: center;">8100</td>
</tr>
<tr class="odd">
<td style="text-align: center;">192</td>
<td style="text-align: center;">94</td>
<td style="text-align: center;">18048</td>
<td style="text-align: center;">36864</td>
<td style="text-align: center;">8836</td>
</tr>
<tr class="even">
<td style="text-align: center;">205</td>
<td style="text-align: center;">100</td>
<td style="text-align: center;">20500</td>
<td style="text-align: center;">42025</td>
<td style="text-align: center;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: center;">198</td>
<td style="text-align: center;">106</td>
<td style="text-align: center;">20988</td>
<td style="text-align: center;">39204</td>
<td style="text-align: center;">11236</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>In der abschließenden Tabelle findest du dann einmal die Summen der beobachteten Werte <span class="math inline">\(X\)</span> und <span class="math inline">\(Y\)</span> sowie des Produkts von <span class="math inline">\(X\)</span> und <span class="math inline">\(Y\)</span> sowie deren Quadrate mit <span class="math inline">\(X^2\)</span> und <span class="math inline">\(Y^2\)</span>. Damit haben wir dann alles zusammen um die Formel oben zu füllen.</p>
<div class="cell">
<div id="tbl-example-by-hand-03" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example-by-hand-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;44.9— Summe der Datenpunkte für <span class="math inline">\(X\)</span> und <span class="math inline">\(Y\)</span> sowie des Produkts von <span class="math inline">\(X\)</span> und <span class="math inline">\(Y\)</span> sowie deren Quadrate mit <span class="math inline">\(X^2\)</span> und <span class="math inline">\(Y^2\)</span>
</figcaption>
<div aria-describedby="tbl-example-by-hand-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 15%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">height <span class="math inline">\((\Sigma X)\)</span></th>
<th style="text-align: center;">weight <span class="math inline">\((\Sigma Y)\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\Sigma XY\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\Sigma X^2\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\Sigma Y^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1312</td>
<td style="text-align: center;">624</td>
<td style="text-align: center;">117826</td>
<td style="text-align: center;">246898</td>
<td style="text-align: center;">56522</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Ich habe dann die ganzen Summen einmal händisch berechnet und dann in den Formeln von oben eingesetzt. Wir erhalten dann für den y-Achsenabschnitt <span class="math inline">\(\beta_0\)</span> folgenden Wert.</p>
<p><span class="math display">\[
\beta_0 = \cfrac{624 \cdot 246898 - 1312 \cdot 117826}{7\cdot 246898 - 1312^2} = -75.39038
\]</span></p>
<p>Die ganze Berechnung habe ich dann auch einmal für die Steigung <span class="math inline">\(\beta_1\)</span> ebenfalls einmal durchgeführt.</p>
<p><span class="math display">\[
b_1 = \cfrac{7\cdot 117826 - 1312\cdot624}{7\cdot246898 - 1312^2} = 0.877845
\]</span></p>
<p>Wir sehen, es kommen die gleichen Werte für den y-Achsenabschnitt <span class="math inline">\(\beta_0\)</span> und die Steigung <span class="math inline">\(\beta_1\)</span> raus. Das hat ja schonmal sehr gut geklappt. Eine andere Art die gleiche Werte effizienter zu berechnen ist die Matrixberechnung der Koeffizienten der linearen Regression. Wir könnten dann auch komplexere Modelle mit mehr als nur einem <span class="math inline">\(x\)</span> und einem <span class="math inline">\(\beta_1\)</span> berechnen. Die grundlegende Formel siehst du einmal im Folgenden dargestellt.</p>
<p><span class="math display">\[
\begin{pmatrix}
\beta_0 \\
\beta_1
\end{pmatrix}
= \mathbf{(X^T X)^{−1}(X^T Y)}
\]</span></p>
<p>Wir brauchen jetzt einiges an Matrixrechnung um die jeweiligen Formelteile zu berechnen. Ich habe dir in den folgenden Tabs einmal Schritt für Schritt die einzelnen Teile berechnet. Wir immer machen wir das eigentlich nicht so richtig per Hand, sondern nutzen einen Computer. Prinzipiell wäre eine händische Lösung natürlich möglich.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true"><span class="math inline">\(X\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false"><span class="math inline">\(Y\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false"><span class="math inline">\(X^T\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false"><span class="math inline">\(X^T X\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false"><span class="math inline">\(X^T Y\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-6" role="tab" aria-controls="tabset-2-6" aria-selected="false"><span class="math inline">\((X^T X)^{−1}\)</span></a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="dv">167</span>, <span class="dv">188</span>, <span class="dv">176</span>, <span class="dv">186</span>, <span class="dv">192</span>, <span class="dv">205</span>, <span class="dv">198</span>))</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">7</span>), X) </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>X </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    1  167
[2,]    1  188
[3,]    1  176
[4,]    1  186
[5,]    1  192
[6,]    1  205
[7,]    1  198</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="dv">70</span>, <span class="dv">83</span>, <span class="dv">81</span>, <span class="dv">90</span>, <span class="dv">94</span>, <span class="dv">100</span>, <span class="dv">106</span>))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>Y</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]   70
[2,]   83
[3,]   81
[4,]   90
[5,]   94
[6,]  100
[7,]  106</code></pre>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>Xt <span class="ot">&lt;-</span> <span class="fu">t</span>(X) </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>Xt</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5] [,6] [,7]
[1,]    1    1    1    1    1    1    1
[2,]  167  188  176  186  192  205  198</code></pre>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>XtX <span class="ot">&lt;-</span> Xt <span class="sc">%*%</span> X</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>XtX</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]   [,2]
[1,]    7   1312
[2,] 1312 246898</code></pre>
</div>
</div>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>XtY <span class="ot">&lt;-</span> Xt <span class="sc">%*%</span> Y</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>XtY</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       [,1]
[1,]    624
[2,] 117826</code></pre>
</div>
</div>
</div>
<div id="tabset-2-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-6-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>XtXinv <span class="ot">&lt;-</span> <span class="fu">solve</span>(XtX)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>XtXinv</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]         [,2]
[1,] 35.5658312 -0.188994526
[2,] -0.1889945  0.001008355</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Am Ende müssen wir dann alle Teile in der Form <span class="math inline">\(\mathbf{(X^T X)^{−1}(X^T Y)}\)</span> einmal zusammenbringen. Das siehst dann in R wie folgt aus. Wir erhalten dann eine Matrix wieder wobei die erste Zeile der y-Achsenabschnitt <span class="math inline">\(\beta_0\)</span> und die zweite Zeile die Steigung <span class="math inline">\(\beta_1\)</span> ist. Wir erhalten fast die gleichen Werte wie auch schon oben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>XtXinv <span class="sc">%*%</span> Xt <span class="sc">%*%</span> Y</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]
[1,] -75.390377
[2,]   0.877845</code></pre>
</div>
</div>
<p>Wenn du dich tiefer in die Thematik einlesen willst, dann sind hier weitere Quellen zu der Thematik unter den folgenden Links und Tutorien.</p>
<ul>
<li><a href="https://bradleyboehmke.github.io/HOML/linear-regression.html">Hands-On Machine Learning with R | Linear Regression</a></li>
<li><a href="https://davetang.org/muse/2012/02/10/manual-linear-regression-analysis-using-r/">Manual linear regression analysis using R</a></li>
<li><a href="https://towardsdatascience.com/linear-regression-by-hand-python-and-r-79994d47f68">Linear Regression by Hand</a></li>
<li><a href="https://www.statology.org/linear-regression-by-hand/">How to Perform Linear Regression by Hand</a></li>
<li><a href="https://lasanthiwatagoda.github.io/STT4830ClassRepo/RCodes/Ch5Script.html">Matrix Approach to Simple Linear Regression in R</a></li>
</ul>
</div>
</div>
<p>Damit haben wir das einkovariate Modell abgeschlossen. Hier ist dann auch meistens Ende, wenn wir von der klassischen linearen Regression reden. Wir haben unseren kontinuierlichen Messwert und dann noch unsere kontinuierliche Einflussvariable. Dann legen wir eine Grade durch die Punkte und erhalten die Gradengleichung. Damit sind wir dann zufrieden. Eventuell wollen wir dann noch die Modellgüte betrachten oder aber noch die Korrelation berechnen. Das können wir dann noch machen. Hier wollen wir dann nochmal den Fall der kategorialen Einflussvariable anschauen.</p>
</section>
<section id="einfaktorielles-modell" class="level3" data-number="44.5.2">
<h3 data-number="44.5.2" class="anchored" data-anchor-id="einfaktorielles-modell"><span class="header-section-number">44.5.2</span> Einfaktorielles Modell</h3>
<p>Hier stoplerst du vielleicht einmal, denn was wir uns hier anschauen ist sehr nah an der einfaktoriellen ANOVA dran. Dort haben wir ja auch einen kontinuierlichen Messwert und einen Faktor. Wir wollen wissen, ob sich die Level des Faktors als Gruppen untereinander in dem mittleren Messwerten unterscheiden oder ob alle Gruppenmittel gleich sind. Ja, da gibt es jetzt gewisse Überschneidungen und vieles ist dann auch gleich. Insbesondere der Fall mit einem Faktor und zwei Leveln ist dann von einem Student t-Test algorithmisch nicht zu unterscheiden. Hier steigen wir also dann einmal in die einfaktoriellen Modelle aus der sich des statistischen Modellierens ein.</p>
<p>Heir unterscheiden wir dann zwei einfaktorielle Modelle. Zuerst schauen wir uns einmal ein einfaktorielles Modell mit einem Faktor und zwei Leveln an. Wir haben eben die Sprungweite der HUnde- und Katzenflöhe vorliegen. Dann betrachten wir noch ein Modell mit mehr als zwei Gruppen. Wir brschränken uns gleich mal auf drei Gruppen indem wir einfach noch die Fuchsflöhe mit in unsere Betrachtung nehmen. Es gehen auch mehr als Gruppen, aber dann wird die Ausgabe nur länger, die Interpretation bleibt gleich.</p>
<section id="f_a-mit-2-leveln" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="f_a-mit-2-leveln"><span class="math inline">\(f_A\)</span> mit 2 Leveln</h4>
<p>Unser einfaktorielles Modell mit einem Faktor und zwei Leveln sieht dann wie folgt aus. Wir haben auf der linken Seite unseren kontinuierlichen Messwert <span class="math inline">\(Y\)</span> vorliegen und auf der rechten Seite dann unseren Faktor <span class="math inline">\(f_A\)</span>. Der Faktor hat nur zwei Gruppen und deshalb auch nur zwei Level.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-in-R-15" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-in-R-15-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-linear-reg-basic_files/figure-html/fig-model-in-R-15-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19" title="Abbildung&nbsp;44.15— Schemantisches simples Modell mit einem Messwert Y und einer kategorialen Einflussvariablen als Faktor f_A mit zwei Leveln dargestellt. [Zum Vergrößern anklicken]"><img src="stat-linear-reg-basic_files/figure-html/fig-model-in-R-15-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-in-R-15-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;44.15— Schemantisches simples Modell mit einem Messwert <span class="math inline">\(Y\)</span> und einer kategorialen Einflussvariablen als Faktor <span class="math inline">\(f_A\)</span> mit zwei Leveln dargestellt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="f_a-mit-2-leveln-1" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="f_a-mit-2-leveln-1"><span class="math inline">\(f_A\)</span> mit &gt;2 Leveln</h4>
<p>Unser einfaktorielles Modell mit einem Faktor und drei Leveln sieht dann fast gleich aus. Wir haben auf der linken Seite unseren kontinuierlichen Messwert <span class="math inline">\(Y\)</span> vorliegen und auf der rechten Seite dann unseren Faktor <span class="math inline">\(f_A\)</span>. Der Faktor hat jetzt aber drei Gruppen und deshalb auch nur drei Level.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-in-R-11" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-in-R-11-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-linear-reg-basic_files/figure-html/fig-model-in-R-11-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20" title="Abbildung&nbsp;44.16— Schemantisches simples Modell mit einem Messwert Y und einer kategorialen Einflussvariablen als Faktor f_A mit drei Leveln dargestellt. [Zum Vergrößern anklicken]"><img src="stat-linear-reg-basic_files/figure-html/fig-model-in-R-11-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-in-R-11-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;44.16— Schemantisches simples Modell mit einem Messwert <span class="math inline">\(Y\)</span> und einer kategorialen Einflussvariablen als Faktor <span class="math inline">\(f_A\)</span> mit drei Leveln dargestellt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Jetzt können wir uns die Auswertung einmal praktisch in R anschauen. Dafür nutze ich dann einmal den einfaktoriellen Datensatz nur mit den Hunde- und Katzenflöhen für den Fall eines Faktors mit zwei Leveln. Dann erweitere ich noch die Tierart um die Fuchsflöhe um dann drei Level vorliegen zu haben. Dann habe ich noch in dem anderen Tab mir die Sachlage theoretisch in R angeschaut, da es mich nochmal interessiert hat, wie die Berechnung intern laufen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Praktisch in R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Theoretisch in R</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Dann wollen wir einmal das einfaktorielle Modell auf unseren Daten zu den Sprungweiten der Floharten rechnen. Wir bauen uns dann einmal einen Datensatz nur mit den Hunde- und Katzenflöhen. Dann haben wir zwei Gruppen oder zwei Level vorliegen. Im Prinzip ist das der Student t-Test Fall und so ist dann auch das Ergebnis. Danach betrachten wir dann noch den Fall, dass wir mit den Füchsen drei Tierarten vorliegen haben. Das ist dann der einfaktoriellen ANOVA sehr viel näher. Wir sehen dann auch gleich, dass wir in der Ausgabe der <code>lm()</code> Funktion auch schon gleich eine ANOVA gerechnet kriegen.</p>
<section id="f_a-mit-2-leveln-2" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="f_a-mit-2-leveln-2"><span class="math inline">\(f_A\)</span> mit 2 Leveln</h4>
<p>In dem folgenden Schritt entferne ich einmal die Fuchsflöhe aus den Daten. Wir haben dann nur zwei Gruppen, die Hunde- und Katzenflöhe, vorliegen. Die Sprungweite ist dann unser kontinuierlicher Messwert und die Tierart dann der Faktor.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>fac1_2lvl_tbl <span class="ot">&lt;-</span> fac1_tbl <span class="sc">|&gt;</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(animal <span class="sc">!=</span> <span class="st">"fox"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir uns schon unser einfaktorielles Modell mit einem Faktor mit zwei Leveln bauen. Wir müssen hier auch nichts angeben. Ich mache das hier nur um dann gleich nochmal zu unterscheiden, wenn wir mehre Level im Faktor haben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>fac1_2lvl_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_2lvl_tbl) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt kommt eigentlich der spannende Teil. Was sind die Koeffizienten unseres einfaktoriellen Modells? Wir erhalten einen Intercept wiedergeben sowie die Steigung von der Tierart der Katzenflöhe. Das ist auf den ersten Blick seltsam. Aber denk daran, dass in R die Level intern als Nummern codiert sind. Die Hunde haben daher das Level 1 und die Katzen das Level 2. Sehr vereinfacht ausgedrückt, können wir sagen, wenn wir also von Hunden zu Katzen wechseln ist das nichts anderes als die Einheit der Einflussvariable um Eins zu erhöhen. Soweit als simple Erklärung. Mehr dazu udn auch richtiger in dem nächste Tab zur Theorie in R.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>fac1_2lvl_fit <span class="sc">|&gt;</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)   animalcat 
       8.13       -3.39 </code></pre>
</div>
</div>
<p>Und was sind jetzt die beiden Zahlen genau? Die <span class="math inline">\(8.13cm\)</span> sind der Mittelwert der Sprungweiten der Hundeflöhe. Du siehst hier den Zusammenhang nochmal in der folgenden Abbildung visualsiert. Wie du siehst liegen die Hundeflöhe auf der y-Achse und der Mittelwert der Sprungweiten der Hundeflöhe entspricht dem Intercept. Der Koeffizient <code>animalcat</code> ist nichts anders als die Mittelwertsdifferenz der Hunde- und Katzenflöhe. Rechne gerne einmal nach oder schaue genau in den Abbildung.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-in-R-fa-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-in-R-fa-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-linear-reg-basic_files/figure-html/fig-model-in-R-fa-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21" title="Abbildung&nbsp;44.17— Scatterplot der Sprungweiten der Hunde- und Katzenflöhe. Der Intercept des einfaktoriellen Modells liegt auf dem Mittelwert der Hundeflöhe. Der Koeffizient der Steigung ist die Differenz des Mittelwerts der Katzen- und Hundeflöhe. [Zum Vergrößern anklicken]"><img src="stat-linear-reg-basic_files/figure-html/fig-model-in-R-fa-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-in-R-fa-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;44.17— Scatterplot der Sprungweiten der Hunde- und Katzenflöhe. Der Intercept des einfaktoriellen Modells liegt auf dem Mittelwert der Hundeflöhe. Der Koeffizient der Steigung ist die Differenz des Mittelwerts der Katzen- und Hundeflöhe. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Dann schauen wir einmal genauer in die Ausgabe der Funktion <code>summary()</code> unseres einfaktoriellen Modells. Auch hier erhalten wir wieder eine Menge Informationen sowie statistischen Tests, dir wir hier dann so wie einen Student t-Test interpretieren können.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>fac1_2lvl_fit <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir erhalten dann folgende Ausgabe mit den entsprechenden Kurzerkläruungen von mir. Keine Angst, die gehen wir dann alle in den nächsten Paragraphen einmal durch.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-in-R-f1-2lvl-summary" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-in-R-f1-2lvl-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-linear-reg-basic_files/figure-html/fig-model-in-R-f1-2lvl-summary-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22" title="Abbildung&nbsp;44.18— Annotierte Ausgabe der Funktion summary() aus einer linearen Modellanpassung mit der Funktion lm(). Die Ausgabe der Funktion teilt sich grob in drei informative Bereiche: Informationen zu den Residuen, Informationen zu den Koeffizienten undS Informationen zu der Modelgüte. [Zum Vergrößern anklicken]"><img src="stat-linear-reg-basic_files/figure-html/fig-model-in-R-f1-2lvl-summary-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-in-R-f1-2lvl-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;44.18— Annotierte Ausgabe der Funktion <code>summary()</code> aus einer linearen Modellanpassung mit der Funktion <code>lm()</code>. Die Ausgabe der Funktion teilt sich grob in drei informative Bereiche: Informationen zu den Residuen, Informationen zu den Koeffizienten undS Informationen zu der Modelgüte. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir erhalten auch hier die Informationen zu den Residuen. Wir wollen hier einen Median von Null und gleiche absolute Werte für das 1st und 3rd Quartile haben. Ebenso sollte der minimale und maximale Wert vom Betrag her ähnlich sein. Wenn das vorliegt, dann können wir von normalverteilten Residuen ausgehen und das Modell sollte von der Seite aus stimmen.</p>
<p>Wenn wir die Koeffizienten betrachten, dann können wir zum einen die Frage beantworten, ob der Mittelwert der Sprungweiten der Hundeflöhe sich signifikant von Null unterscheidet. Meistens interessiert und das nicht so sehr. Dann kommt die Steigung, also die Differenz des Mittelwerts der Hundeflöhe zu dem Mittelwert der Katzenflöhe. Hier springen also die Katzenflöhe <span class="math inline">\(-3.386cm\)</span> weniger weit als die Hundeflöhe. Hier testen wir dann, ob sich die Differenz signifikant von Null unterscheidet. Das ist dann aber nichts anderes als der Student t-Test, der uns auch die gleichen Zahlen liefert.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_2lvl_tbl, <span class="at">var.equal =</span> <span class="cn">TRUE</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  jump_length by animal
t = 3.1253, df = 12, p-value = 0.008768
alternative hypothesis: true difference in means between group dog and group cat is not equal to 0
95 percent confidence interval:
 1.025339 5.746089
sample estimates:
mean in group dog mean in group cat 
         8.128571          4.742857 </code></pre>
</div>
</div>
<p>Dann betrachten wir nochmal den Standardfehler der Residuen (abk. <em>RSE</em>, eng. <em>residual standard error</em>) sowie das Bestimmtheitsmaß <span class="math inline">\(R^2\)</span>. Standardfehler der Residuen sollte klein sein und kann hier mit <span class="math inline">\(\pm2cm\)</span> als gering angesehen werden. Wir können den Fehler ja direkt auf der Einheit der Sprungweiten interpretieren. Das Bestimmtheitsmaß ist nicht so super, wir sind hier weit von der Eins entfernt, dass heißt das die einzelnen Beobachtungen dann doch um die lokalen Mittelwerte entprechend streuen. Die Tierart ist dann doch nicht die einzige Ursache für die Sprungweitenunterschiede. Hier mag dann das Geschlecht oder das Gewicht als weitere Einflussvariablen noch eine Rolle spielen.</p>
<p>Am Ende dann noch die einfaktorielle ANOVA, die wir ja auch in der Ausgabe dann noch berechnet kriegen. Da hat man dann schon mehr als man eigentlich braucht zusammen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_2lvl_tbl) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value  Pr(&gt;F)   
animal       1  40.12   40.12   9.767 0.00877 **
Residuals   12  49.29    4.11                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Die Nutzung eines linearen Modells mit einem Fakotr mit nur zwei Leveln mag jetzt ertsmal übertrieben scheinen, aber wir können hier einmal nachvollziehen, wie die Koeffizienten zu interpretieren sind.</p>
</section>
<section id="f_a-mit-2-leveln-3" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="f_a-mit-2-leveln-3"><span class="math inline">\(f_A\)</span> mit &gt;2 Leveln</h4>
<p>So und jetzt wird es eigentlich erst interessant. Wir wollen das faktorielle Modell einmal mit drei Leveln rechnen. Damit haben wir dann ja nicht mehr zwei Gruppen vorliegen sondern mit den zusätzlichen Fuchsflöhen drei Gruppen. Jetzt ändert sich erstmal nichts an dem Modell, wir haben hier den gleichen Aufruf. Wir nutzen jetzt eben den vollen Datensatz mit allen drei Tierarten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>fac1_3lvl_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Die Koeffizienten können wir uns dann auch gleich wiedergeben lassen. Hier sehen wir dann auch das gleiche Bild wie eben schon. Wir haben anscheinend den Intercept auf dem Mittelwert der Sprungweiten der Hundeflöhe liegen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>fac1_3lvl_fit <span class="sc">|&gt;</span> </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)   animalcat   animalfox 
       8.13       -3.39        1.03 </code></pre>
</div>
</div>
<p>Auch hier hilft dann einmal die folgende Visualisierung. Wir haben den Intercept auf dem Mittelwert der Sprungweiten der Hundeflöhe liegen. Die Hundeflöhe springen im Mittel eben <span class="math inline">\(8.13cm\)</span> weit. Die anderen Koeffizienten sind die Änderung im Mittelwert in Bezug zu den Hundeflöhen. Wir haben hier also dann eben wieder eine Steigung aber immer in Referenz zu dem Intercept. Du kannst di Differenzen auch gut in der Abbildung nachvollziehen.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-in-R-fa-21" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-in-R-fa-21-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-linear-reg-basic_files/figure-html/fig-model-in-R-fa-21-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23" title="Abbildung&nbsp;44.19— Scatterplot der Sprungweiten der Hunde-, Katzen- und Fuchsflöhe. Der Intercept des einfaktoriellen Modells liegt auf dem Mittelwert der Hundeflöhe. Der Koeffizient der Steigung ist die Differenz des Mittelwerts der Katzen- und Hundeflöhe sowie die Differenz des Mittelwerts der Fuchs- und Hundeflöhe. [Zum Vergrößern anklicken]"><img src="stat-linear-reg-basic_files/figure-html/fig-model-in-R-fa-21-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-in-R-fa-21-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;44.19— Scatterplot der Sprungweiten der Hunde-, Katzen- und Fuchsflöhe. Der Intercept des einfaktoriellen Modells liegt auf dem Mittelwert der Hundeflöhe. Der Koeffizient der Steigung ist die Differenz des Mittelwerts der Katzen- und Hundeflöhe sowie die Differenz des Mittelwerts der Fuchs- und Hundeflöhe. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Dann schauen wir einmal genauer in die Ausgabe der Funktion <code>summary()</code> unseres einfaktoriellen Modells. Auch hier erhalten wir wieder eine Menge Informationen sowie statistischen Tests, dir wir hier dann <em>zeilenweise</em> so wie einen Student t-Test interpretieren können. Das heißt, dass eben die Differenz der Mittelwerte im Bezug zu den Hundeflöhen gegen die Null testen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>fac1_3lvl_fit <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir erhalten dann folgende Ausgabe mit den entsprechenden Kurzerkläruungen von mir. Keine Angst, die gehen wir dann alle in den nächsten Paragraphen einmal durch.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-in-R-f1-3lvl-summary" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-in-R-f1-3lvl-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-linear-reg-basic_files/figure-html/fig-model-in-R-f1-3lvl-summary-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24" title="Abbildung&nbsp;44.20— Annotierte Ausgabe der Funktion summary() aus einer linearen Modellanpassung mit der Funktion lm(). Die Ausgabe der Funktion teilt sich grob in drei informative Bereiche: Informationen zu den Residuen, Informationen zu den Koeffizienten und Informationen zu der Modelgüte. [Zum Vergrößern anklicken]"><img src="stat-linear-reg-basic_files/figure-html/fig-model-in-R-f1-3lvl-summary-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-in-R-f1-3lvl-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;44.20— Annotierte Ausgabe der Funktion <code>summary()</code> aus einer linearen Modellanpassung mit der Funktion <code>lm()</code>. Die Ausgabe der Funktion teilt sich grob in drei informative Bereiche: Informationen zu den Residuen, Informationen zu den Koeffizienten und Informationen zu der Modelgüte. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir erhalten auch hier die Informationen zu den Residuen. Wir wollen hier einen Median von Null und gleiche absolute Werte für das 1st und 3rd Quartile haben. Ebenso sollte der minimale und maximale Wert vom Betrag her ähnlich sein. Wenn das vorliegt, dann können wir von normalverteilten Residuen ausgehen und das Modell sollte von der Seite aus stimmen.</p>
<p>Wenn wir die Koeffizienten betrachten, dann können wir zum einen die Frage beantworten, ob der Mittelwert der Sprungweiten der Hundeflöhe sich signifikant von Null unterscheidet. Das war das Gleiche wie schon in dem obigen Modell mit zwei Leveln so. Meistens interessiert und das nicht so sehr. Dann kommt die Steigung, also die Differenz des Mittelwerts der Hundeflöhe zu dem Mittelwert der Katzenflöhe. Hier springen also die Katzenflöhe <span class="math inline">\(-3.386cm\)</span> weniger weit als die Hundeflöhe. Hier testen wir dann, ob sich die Differenz signifikant von Null unterscheidet. Danach kommt dann der Test, ob sich die Differenz des Mittelwerts der Hundeflöhe zu dem Mittelwert der Fuchsflöhe signifikant unetrscheidet. Hier springen also die Fuchsflöhe <span class="math inline">\(1.029cm\)</span> weiter als die Hundeflöhe. Wir erhalten keinen Test für die Differenz zwischen den Katzen- und Fuchsflöhen. Hier musst du dann auf die Posthoc-Tests ausweichen.</p>
<p>Am Ende dann noch die einfaktorielle ANOVA, die wir ja auch in der Ausgabe dann noch berechnet kriegen. Hier kann die ANOVA signifkant sein und die Steigungen dennoch nicht. Das liegt eben daran, dass du nicht alle paarweisen Vergleiche hier im Modell durch die Steigungen testen kannst. Deshalb ist die ANOVA in der Modellausgabe aus dieser Sicht dann doch sinnvoll.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
animal       2  74.68   37.34   11.89 0.000511 ***
Residuals   18  56.53    3.14                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Damit sind wir hier mit dieser Orchidee durch. Spannender wird es dann, wenn wir im multiplen linearen Modell verschiedene Kovariaten und Faktoren in einem Modell miteinander verbinden und dann gemeinsam zu interpretieren versuchen. Dazu dann aber mehr in den entsprechenden <a href="stat-modeling-basic.html">Kapiteln zur multiplen linearen Regression</a> und dem <a href="stat-modeling-R.html">Modellieren in R</a>.</p>
</section>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Schön das wir eine etwas wirre Wiedergabe der Koeffizienten in einem faktoriellen Modell haben. Warum das so ist, wird dir klarer, wenn wir uns die Modellierung einmal etwas genauer anschauen. Wir modellieren nämlich nicht direkt die Steigung. Sonst würden wir ja bei den Koeffizienten immer ein vielfaches der Differenz zum Intercept erhalten. Das ist nicht der Fall und warum das so ist, wollen wir mal zerforschen.</p>
<section id="f_a-mit-2-leveln-4" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="f_a-mit-2-leveln-4"><span class="math inline">\(f_A\)</span> mit 2 Leveln</h4>
<p>In einem ersten Schritt wollen wir uns einmal das Modell mit einem Faktor mit 2 Leveln anschauen. Wir bauen uns hier ein Modell mit dem Datensatz der Körperlängen der Schlangen. Daher können wir dann die Variable <code>region</code> verwenden. Wir haben ja nur zwei Regionen in denen wir die Schlangen gesammelt haben. Die Funktion <code>model.matrix()</code> gibt uns die Modelmatrix wieder.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(svl <span class="sc">~</span> region, <span class="at">data =</span> snake_tbl) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 2
  `(Intercept)` regionnord
          &lt;dbl&gt;      &lt;dbl&gt;
1             1          0
2             1          0
3             1          0
4             1          1
5             1          1
6             1          1
7             1          1
8             1          1</code></pre>
</div>
</div>
<p>In der ersten Spalte ist der Intercept angegeben, danach folgt dann die Spalte <code>regionwest</code>. In dieser Spalte steht die Dummykodierung für die Variable <code>region</code>. Die ersten drei Schlangen kommen nicht aus der Region <code>nord</code> und werden deshalb mit einen Wert von 0 versehen. Die nächsten fünf Schlangen kommen aus der Region <code>nord</code> und erhalten daher eine 1 in der Spalte. Die Spalte gibt im Prinzip eine ja/nein Antwort auf die Frage in dem Spaltennamen. Also in unserem Fall ist es die Frage: <em>“Kommt die Schlange aus der Region <code>nord?</code>”</em>.</p>
<p>Das sieht hier sehr seltsam aus, ist aber am Ende eine andere Art der Kodierung. Wir sprechen hier auch von der <a href="https://de.wikipedia.org/wiki/Dummy-Variable">Dummykodierung</a> damit wir dann die kategorialen Variablen in einem stattstischen Modell abbilden können. In der multiplen linearen Modellierung ist es dann noch wichtiger.</p>
<p>Wir können die Modellmatrix auch mathematisch schreiben und die <span class="math inline">\(y\)</span> Spalte für das Outcome <code>svl</code> ergänzen. Eben so ergänzen wir die <span class="math inline">\(\beta\)</span>-Werte als mögliche Koeffizienten aus der linearen Regression sowie die Residuen als Abweichung von der gefitteten Grade. Wir sehen dann hier einmal die Dummykodierung für zwei Level eines Faktors.</p>
<p><span class="math display">\[
\begin{pmatrix}
  40 \\
  45 \\
  39 \\
  50 \\
  52 \\
  57 \\
  58 \\
  59 \\
\end{pmatrix}
=
  \begin{pmatrix}
  1 &amp;  0  \\
  1 &amp;  0 \\
  1 &amp;  0\\
  1 &amp;  1\\
  1 &amp;  1 \\
  1 &amp;  1 \\
  1 &amp;  1 \\
  1 &amp;  1 \\
\end{pmatrix}
\times
  \begin{pmatrix}
  \beta_0 \\
  \beta^{region}_{nord} \\
\end{pmatrix} +
  \begin{pmatrix}
  \epsilon_1 \\
  \epsilon_2 \\
  \epsilon_3 \\
  \epsilon_4 \\
  \epsilon_5 \\
  \epsilon_6 \\
  \epsilon_7 \\
  \epsilon_8 \\
\end{pmatrix}
\]</span></p>
<p>Jetzt brauche wir die Koeffizienten aus dem linearen Modell, welches wir wie folgt fitten. Wir nutzen dann die Funktion <code>coef()</code> um uns die Koeffizienten wiedergeben zu lassen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>fit_1fac_2lvl <span class="ot">&lt;-</span> <span class="fu">lm</span>(svl <span class="sc">~</span> region, <span class="at">data =</span> snake_tbl) </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>fit_1fac_2lvl <span class="sc">|&gt;</span> <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)  regionnord 
      41.33       12.07 </code></pre>
</div>
</div>
<p>Die Funktion <code>residuals()</code> gibt uns die Residuen der Graden wieder.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>fit_1fac_2lvl <span class="sc">|&gt;</span> <span class="fu">residuals</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    1     2     3     4     5     6     7     8 
-1.33  3.67 -2.33 -2.40 -1.40  3.60  4.60 -4.40 </code></pre>
</div>
</div>
<p>Wir können jetzt die Koeffizienten ergänzen mit <span class="math inline">\(\beta_0 = 41.33\)</span> für den Intercept. Weiter ergänzen wir die Koeffizienten für die Region und das Level <code>nord</code> mit <span class="math inline">\(\beta^{region}_{nord} = 12.07\)</span>. Ebenfalls setzen wir Werte für die Residuen für jede der Beobachtungen in die Gleichung ein. Hier sehen wir dann wunderbar, warum der Intercept der Mittelwert der Schlangen in der Region <code>west</code> sind. Der Unterschied zu den Schlangen in der Region <code>nord</code> ist ja der Koeffizient <span class="math inline">\(\beta^{region}_{nord}\)</span>. Den Rechnen wir nur ein, wenn wir auch eine Schlange aus der Region <code>nord</code> haben.</p>
<p><span class="math display">\[
\begin{pmatrix}
  40 \\
  45 \\
  39 \\
  50 \\
  52 \\
  57 \\
  58 \\
  59 \\
\end{pmatrix}
=
  \begin{pmatrix}
  41.33 &amp; 0 \cdot 12.07  \\
  41.33 &amp; 0 \cdot 12.07  \\
  41.33 &amp; 0 \cdot 12.07  \\
  41.33 &amp; 1 \cdot 12.07  \\
  41.33 &amp; 1 \cdot 12.07  \\
  41.33 &amp; 1 \cdot 12.07  \\
  41.33 &amp; 1 \cdot 12.07  \\
  41.33 &amp; 1 \cdot 12.07  \\
\end{pmatrix} +
  \begin{pmatrix}
  -1.33\\
  +3.67 \\
  -2.33 \\
  -2.40 \\
  -1.40 \\
  +3.60 \\
  +4.60 \\
  -4.40 \\
\end{pmatrix}
\]</span></p>
<p>Wir können jetzt diese gewaltige Sammlung an Matrixen einmal auflösen. Steht denn nun wirklich rechts das Gleiche wie links von der Gleichung? Wir bauen uns die Zahlen von der rechten Seite der Gleichung einmal in R nach und schauen auf das Ergebnis.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">-</span> <span class="fl">1.33</span>,</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">+</span> <span class="fl">3.67</span>,</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">-</span> <span class="fl">2.33</span>,</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">-</span> <span class="fl">2.40</span>,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">-</span> <span class="fl">1.40</span>,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">+</span> <span class="fl">3.60</span>,</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">+</span> <span class="fl">4.60</span>,</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">-</span> <span class="fl">4.40</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 40 45 39 51 52 57 58 49</code></pre>
</div>
</div>
<p>Wir kriegen am Ende die gleichen Körperlängen der Schlangen wiedergegeben. Das hat also alles so funktioniert wie es sollte. Auch hier sehen wir, dass der Wert des Koeffzienten <span class="math inline">\(\beta^{region}_{nord} = 12.07\)</span> nur im Fall von Schlangen aus der Region <code>nord</code> zu tragen kommt. Das sind dann eben auch die letzten fünf Schlangen. Wenn du das Prinzip verstanden hast, dann wird dir die Dummykodierung im folgenden Fall mit mehr Leveln noch klarer.</p>
</section>
<section id="f_a-mit-2-leveln-5" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="f_a-mit-2-leveln-5"><span class="math inline">\(f_A\)</span> mit &gt;2 Leveln</h4>
<p>Im nächsten Schritt wollen wir uns einmal das Modell mit einem Faktor mit drei Leveln anschauen. Prinzipiell geht es auch mit noch mehr Leveln, dann erweitern wir aber die Modellmatrix immer nur um eine weitere Spalte. Wir bauen uns hier nun ein Modell mit der Variable <code>color</code>, die ja drei Level hat. Die Funktion <code>model.matrix()</code> gibt uns die Modelmatrix wieder. Wir haben ja drei Farben der Schlangenhaut mit schwarz, rot und blauer Haut vorliegen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(svl <span class="sc">~</span> color, <span class="at">data =</span> snake_tbl) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
  `(Intercept)` colorrot colorblau
          &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1             1        0         0
2             1        0         0
3             1        1         0
4             1        1         0
5             1        1         0
6             1        0         1
7             1        0         1
8             1        0         1</code></pre>
</div>
</div>
<p>In der ersten Spalte ist der Intercept angegeben, danach folgt dann die Spalten für <code>color</code>. Die Spalten <code>colorrot</code> und <code>colorblau</code> geben jeweils an, ob die Schlange das Level <code>rot</code> hat oder <code>blau</code> oder keins von beiden. Wenn die Schlange weder rot noch blau ist, dann sind beide Spalten mit einer 0 versehen. Dann ist die Schlange schwarz.</p>
<p>Wir können die Modellmatrix auch mathematisch schreiben und die <span class="math inline">\(y\)</span> Spalte für das Outcome <code>svl</code> ergänzen. Eben so ergänzen wir die <span class="math inline">\(\beta\)</span>-Werte als mögliche Koeefizienten aus der linearen Regression sowie die Residuen als Abweichung von der gefitteten Grade.</p>
<p><span class="math display">\[
\begin{pmatrix}
  40 \\
  45 \\
  39 \\
  50 \\
  52 \\
  57 \\
  58 \\
  59 \\
\end{pmatrix}
=
  \begin{pmatrix}
  1 &amp; 0 &amp; 0 \\
  1 &amp; 0 &amp; 0\\
  1 &amp; 1 &amp; 0\\
  1 &amp; 1 &amp; 0\\
  1 &amp; 1 &amp; 0\\
  1 &amp; 0 &amp; 1\\
  1 &amp; 0 &amp; 1\\
  1 &amp; 0 &amp; 1\\
\end{pmatrix}
\times
  \begin{pmatrix}
  \beta_0 \\
  \beta^{color}_{rot} \\
  \beta^{color}_{blau} \\
\end{pmatrix} +
  \begin{pmatrix}
  \epsilon_1 \\
  \epsilon_2 \\
  \epsilon_3 \\
  \epsilon_4 \\
  \epsilon_5 \\
  \epsilon_6 \\
  \epsilon_7 \\
  \epsilon_8 \\
\end{pmatrix}
\]</span></p>
<p>Jetzt brauche wir die Koeffizienten aus dem linearen Modell, welches wir wie folgt fitten. Wir nutzen dann die Funktion <code>coef()</code> um uns die Koeffizienten wiedergeben zu lassen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>fit_1fac_2lvl <span class="ot">&lt;-</span> <span class="fu">lm</span>(svl <span class="sc">~</span> color, <span class="at">data =</span> snake_tbl) </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>fit_1fac_2lvl <span class="sc">|&gt;</span> <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)    colorrot   colorblau 
      42.50        4.83       12.17 </code></pre>
</div>
</div>
<p>Die Funktion <code>residuals()</code> gibt uns die Residuen der Graden wieder.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>fit_1fac_2lvl <span class="sc">|&gt;</span> <span class="fu">residuals</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    1     2     3     4     5     6     7     8 
-2.50  2.50 -8.33  3.67  4.67  2.33  3.33 -5.67 </code></pre>
</div>
</div>
<p>Wir können jetzt die Koeffizienten ergänzen mit <span class="math inline">\(\beta_0 = 25\)</span> für den Intercept. Weiter ergänzen wir die Koeffizienten für die Farbe und das Level <code>rot</code> mit <span class="math inline">\(\beta^{color}_{rot} = 4.83\)</span> und für die Farbe und das Level <code>blau</code> mit <span class="math inline">\(\beta^{color}_{blau} = 12.17\)</span>. Ebenfalls setzen wir Werte für die Residuen für jede der Beobachtungen in die Gleichung ein. Auch hier sehen wir dann sehr gut, dass der Intercept der Mittelwert der schwarzen Schlangen sein muss. Die Änderung der Körperlängen der roten und blauen Schlangen zu den schwarzen Schlangen geben dann die Koeffizienten wieder.</p>
<p><span class="math display">\[
\begin{pmatrix}
  40 \\
  45 \\
  39 \\
  50 \\
  52 \\
  57 \\
  58 \\
  59 \\
\end{pmatrix}
=
  \begin{pmatrix}
  42.50 &amp; 0 \cdot 4.83&amp; 0 \cdot 12.17 \\
  42.50 &amp; 0 \cdot 4.83&amp; 0 \cdot 12.17\\
  42.50 &amp; 1 \cdot 4.83&amp; 0 \cdot 12.17\\
  42.50 &amp; 1 \cdot 4.83&amp; 0 \cdot 12.17\\
  42.50 &amp; 1 \cdot 4.83&amp; 0 \cdot 12.17\\
  42.50 &amp; 0 \cdot 4.83&amp; 1 \cdot 12.17\\
  42.50 &amp; 0 \cdot 4.83&amp; 1 \cdot 12.17\\
  42.50 &amp; 0 \cdot 4.83&amp; 1 \cdot 12.17\\
\end{pmatrix} +
  \begin{pmatrix}
  -2.50 \\
  +2.50 \\
  -8.33 \\
  +3.67 \\
  +4.67 \\
  +2.33 \\
  +3.33 \\
  -5.67 \\
\end{pmatrix}
\]</span></p>
<p>Wir können jetzt diese gewaltige Sammlung an Matrixen einmal auflösen. Steht denn nun wirklich rechts das Gleiche wie links von der Gleichung? Wir bauen uns die Zahlen von der rechten Seite der Gleichung einmal in R nach und schauen auf das Ergebnis.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">-</span> <span class="fl">2.50</span>,</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">+</span> <span class="fl">2.50</span>,</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">-</span> <span class="fl">8.33</span>,</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">+</span> <span class="fl">3.67</span>,</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">+</span> <span class="fl">4.67</span>,</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">+</span> <span class="fl">2.33</span>,</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">+</span> <span class="fl">3.33</span>,</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">-</span> <span class="fl">5.67</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 40 45 39 51 52 33 34 25</code></pre>
</div>
</div>
<p>Wir kriegen auch hier am Ende die gleichen Körperlängen der Schlangen wiedergegeben. Das hat also alles so funktioniert wie es sollte. Je nachdem welche Farbe unsere Schlange hat, nutzen wir eben einen anderen Koeffizienten. Die Koeffizienten, die wir nicht brauchen, multiplizieren wir mit Null und daher kommen diese Koeffizienten auch nicht mit in die Berechnung der Schlangenkörperlänge.</p>
</section>
</div>
</div>
</div>
<p>Damit sind wir mit dem einkovariaten und einfaktoriellen Modell durch. Wir haben jetzt verstanden, wie wir die Koeffizienten der beiden verschiedenen Modelle kausal erklären und verwenden können. In den einfaktoriellen Modell wollen wir dann meistens nicht nur die Änderung zu der Gruppe im Intercept berechnen. Daher ist das einfaktorielle Modell eher der Vorschritt für die ANOVA oder aber den Post-hoc Test. Wir wollen jetzt nochmal in die Prädiktion schauen und verstehen, wie wir dann neue Werte für unseren Messwert für bekannte oder unbekannte Werte der Einflussvariable berechnen können.</p>
</section>
</section>
</section>
<section id="prädiktives-modell" class="level2" data-number="44.6">
<h2 data-number="44.6" class="anchored" data-anchor-id="prädiktives-modell"><span class="header-section-number">44.6</span> Prädiktives Modell</h2>
<section id="einkovariates-modell-1" class="level3" data-number="44.6.1">
<h3 data-number="44.6.1" class="anchored" data-anchor-id="einkovariates-modell-1"><span class="header-section-number">44.6.1</span> Einkovariates Modell</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>cov1_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> weight, <span class="at">data =</span> cov1_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>cov1_new_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">weight =</span> <span class="fu">c</span>(<span class="fl">1.7</span>, <span class="fl">1.4</span>, <span class="fl">2.1</span>, <span class="fl">3.0</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Neue x-Werte</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Alte x-Werte</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(cov1_fit, <span class="at">newdata =</span> cov1_new_tbl) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   1    2    3    4 
1.84 1.68 2.04 2.50 </code></pre>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>cov1_fit <span class="sc">|&gt;</span> <span class="fu">augment</span>() <span class="sc">|&gt;</span> </span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(jump_length, weight, .fitted, .resid)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 4
  jump_length weight .fitted .resid
        &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
1         1.2    0.8    1.38 -0.176
2         1.8    1      1.48  0.322
3         1.3    1.2    1.58 -0.280
4         1.7    1.9    1.94 -0.237
5         2.6    2      1.99  0.612
6         1.8    2.7    2.34 -0.545
7         2.7    2.8    2.40  0.304</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-scatter-lin-pred" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-lin-pred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-linear-reg-basic_files/figure-html/fig-scatter-lin-pred-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25" title="Abbildung&nbsp;44.21— Scatterplot der alten Beobachtungen der Sprungweite in [cm] und dem Gewicht in [mg]. Sowie der neuen vorhergesagten Beobachtungen auf der Graden."><img src="stat-linear-reg-basic_files/figure-html/fig-scatter-lin-pred-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-lin-pred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;44.21— Scatterplot der <em>alten</em> Beobachtungen der Sprungweite in [cm] und dem Gewicht in [mg]. Sowie der <em>neuen</em> vorhergesagten Beobachtungen auf der Graden.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="einfaktorielles-modell-1" class="level3" data-number="44.6.2">
<h3 data-number="44.6.2" class="anchored" data-anchor-id="einfaktorielles-modell-1"><span class="header-section-number">44.6.2</span> Einfaktorielles Modell</h3>
<p>Neben dem kausalen Modell gibt es auch die Möglichkeit ein prädiktives Modell zu rechnen. Im Prinzip ist die Sprache hier etwas ungenau. Wir verwenden das gefittete Modell nur anders. Anstatt das Modell <code>fit_1</code> in die Funktion <code>summary()</code> zu pipen, pipen wir die das Modell in die Funktion <code>predict()</code>. Die Funktion <code>predict()</code> kann dann für neue Daten über die Option <code>newdata =</code> das <span class="math inline">\(y\)</span> vorhersagen.</p>
<p>In unserem Fall müssen wir uns deshalb ein <code>tibble</code> mit einer Spalte bauen. Wir haben ja oben im Modell auch nur ein <span class="math inline">\(x_1\)</span> mit aufgenommen. Später können wir natürlich auch für multiple Modelle die Vorhersage machen. Wichtig ist, dass die Namen gleich sind. Das heißt in dem neuen Datensatz müssen die Spalten <em>exakt</em> so heißen wir in dem alten Datensatz in dem das Modell gefittet wurde.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> weight, <span class="at">data =</span> cov1_tbl)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>simple_new_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">weight =</span> <span class="fu">c</span>(<span class="fl">1.7</span>, <span class="fl">1.4</span>, <span class="fl">2.1</span>, <span class="fl">3.0</span>)) </span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit_1, <span class="at">newdata =</span> simple_new_tbl) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   1    2    3    4 
1.84 1.68 2.04 2.50 </code></pre>
</div>
</div>
<p>Wie wir sehen ist die Anwendung recht einfach. Wir haben die vier <code>jump_length</code> Werte vorhergesagt bekommen, die sich mit dem Fit des Modells mit den neuen <code>weight</code> Werten ergeben. In <a href="#fig-scatter-lin-pred" class="quarto-xref">Abbildung&nbsp;<span>44.21</span></a> sehen wir die Visualisierung der vier vorhergesagten Werte. Die Werte müssen auf der Graden liegen.</p>
<p>Wir werden später in der <a href="classification-basic.html">Klassifikation</a>, der Vorhersage von <span class="math inline">\(0/1\)</span>-Werten, sowie in der multiplen Regression noch andere Prädktionen und deren Maßzahlen kennen lernen. Im Rahmen der simplen Regression soll dies aber erstmal hier genügen.</p>
</section>
</section>
<section id="glossar" class="level2" data-number="44.7">
<h2 data-number="44.7" class="anchored" data-anchor-id="glossar"><span class="header-section-number">44.7</span> Glossar</h2>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Glossar zum statistischen Modellieren
</div>
</div>
<div class="callout-body-container callout-body">
<div id="tbl-glossar-regression" class="quarto-float quarto-figure quarto-figure-center anchored" data-tbl-colwidths="25, 75">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-glossar-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;44.10— Gossar der häufig verwendeten Symbole und Fachbegriffe im statistischen Modellieren.
</figcaption>
<div aria-describedby="tbl-glossar-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 75%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Symbol</th>
<th>Deutsch</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(RHS \sim LHS\)</span></td>
<td>Modellschreibweise mit der rechten Seite (eng. <em>right hand site</em>) und der linken Seite (eng. <em>left hand side</em>)</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(RHS\)</span></td>
<td>Rechte Seite der Tilde in der Modellschreibweise (eng. <em>right hand site</em>)</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(LHS\)</span></td>
<td>Linke Seite der Tilde in der Modellschreibweise (eng. <em>left hand site</em>)</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(Y \sim X\)</span></td>
<td>Modelschreibweise mit Platzhaltervariable X und Y</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(Y / y\)</span></td>
<td>Messwert</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(X / x\)</span></td>
<td>Einflussvariable</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\epsilon\)</span></td>
<td>Residuen oder Fehler aus einer Regressionsanalyse</td>
</tr>
<tr class="even">
<td style="text-align: center;">Fehler</td>
<td>Abweichung der vorhergesagten y-Werte durch das Modell auf der Graden zu den beobachteten y-Werten in den Daten.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\beta_0\)</span></td>
<td>Intercept oder y-Achsenabschnitt</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\beta_1\)</span></td>
<td>Steigung der ersten Einflussvariable</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Intercept</td>
<td>y-Achsenabschnitt</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\hat{y}\)</span></td>
<td>Vorhergesagte y-Werte durch das Modell auf der Graden</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Kovariate</td>
<td>Kontinuierliche Einflussvariable</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(c_1\)</span></td>
<td>Kovariate</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Faktor</td>
<td>Kategoriale Einflussvariable</td>
</tr>
<tr class="even">
<td style="text-align: center;">Level</td>
<td>Gruppen eines Faktors</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(f_A\)</span></td>
<td>Faktor</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(A.1, ..., A.3\)</span></td>
<td>Level eines Faktors als Gruppen</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\mathcal{N}(0, 1)\)</span></td>
<td>Standardnormalverteilung mit einem Mittelwert von 0 und einer Varianz von 1</td>
</tr>
<tr class="even">
<td style="text-align: center;">Zufälliger Effekt</td>
<td>Faktor in einem gemischten Modell, der aus einer zufälligen Population stammt</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(Z / z\)</span></td>
<td>Zufälliger Effekt</td>
</tr>
<tr class="even">
<td style="text-align: center;">Fester Effekt</td>
<td>Faktor in einem gemischten Modell, der aus einer experimentellen Population stammt</td>
</tr>
<tr class="odd">
<td style="text-align: center;">schätzen</td>
<td>Berechnung der Koeffizienten in einem statistischen Modell</td>
</tr>
<tr class="even">
<td style="text-align: center;">Koeffizienten</td>
<td>Steigung und Intercept in einem statistischen Modell. Allgemeiner die Parameter die ein statistsiches Modell wiedergibt und die Grade beschreibt.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Residuen</td>
<td>Unerklärter Rest durch die Modellierung. Konkret der Abstand zwischen den y-Messwerten und den y-Werten auf der Geraden.</td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</section>
<section id="referenzen" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="referenzen">Referenzen</h2>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-kery2010introduction" class="csl-entry" role="listitem">
Kéry, M. (2010). <em>Introduction to WinBUGS for ecologists: Bayesian approach to regression, ANOVA, mixed models and related analyses</em>. Academic Press.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./stat-linear-reg-preface.html" class="pagination-link" aria-label="Grundlagen des Modellierens">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Grundlagen des Modellierens</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./stat-modeling-basic.html" class="pagination-link" aria-label="Multiple lineare Regression">
        <span class="nav-page-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Quellcode</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb84" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = FALSE}</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, readxl, knitr, kableExtra, see,</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="in">               broom, ggimage)</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="in">cov1_tbl &lt;- read_xlsx("data/regression_data.xlsx", sheet = "covariate")</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="in">source("images/R/stat-modeling-R.R")</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="in">source("images/R/stat-linear-reg-basic.R")</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(20250708)</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a><span class="in">theme_modeling &lt;- function() {</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(panel.grid.minor = element_blank(),</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a><span class="in">          plot.background = element_rect(fill = "white", color = NA),</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a><span class="in">          plot.title = element_text(size = 16, face = "bold"),</span></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a><span class="in">          plot.subtitle = element_text(size = 12, face = "italic"),</span></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a><span class="in">          plot.caption = element_text(face = "italic"),</span></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a><span class="in">          axis.title = element_text(size = 12, face = "bold"),</span></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a><span class="in">          axis.text = element_text(size = 12),</span></span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a><span class="in">          strip.text = element_text(face = "bold"),</span></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a><span class="in">          strip.background = element_rect(fill = "grey80", color = NA))</span></span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a><span class="fu"># Simple lineare Regression {#sec-modeling-simple-stat}</span></span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>*Letzte Änderung am `r format(fs::file_info("stat-linear-reg-basic.qmd")$modification_time, '%d. %B %Y um %H:%M:%S')`*</span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Farewell to the Fairground; These rides aren't working anymore." --- White Lies, Farewell to the Fairground*</span></span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/caution.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a>::: {.callout-caution appearance="simple"}</span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a><span class="fu">## Stand des Kapitels: Konstruktion (seit 07.2025)</span></span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-33"><a href="#cb84-33" aria-hidden="true" tabindex="-1"></a>Dieses Kapitel wird in den nächsten Wochen geschrieben und ist damit meine aktuelle Großbaustelle. Ich plane zum Beginn des WiSe 2025/26 eine fertige Version des Kapitels erstellt zu haben. Während das Kapitel entsteht, funktioniert so manches dann nicht so wie es soll. Bitte daher hier dann abwarten.</span>
<span id="cb84-34"><a href="#cb84-34" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb84-35"><a href="#cb84-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-36"><a href="#cb84-36" aria-hidden="true" tabindex="-1"></a>In diesem Kapitel wollen wir mit den Grundlagen des statistischen Modellierens beginnen. Wir nutzen dazu die simple lineare Regression als eine Methode um zu Verstehen, was eigentlich das statistische Modellieren macht. Dabei konzentrieren wir uns auf die lineare Regression, da wir hier ein lineares Modell vorliegen haben. Wir wollen also eine Grade Linie durch Punkte ziehen. Die Punkte sind in einem Scatterplot mit einer x-Achse und einer y-Achse dargestellt. Das ist für den Anfang schwierig genug. Später können wir auch nicht lineare Zusammenhänge modellieren. Dann nutzen wir auch nur eine Einflussvariable und nennen deshalb auch die Regression eine simple lineare Regression. Später in den folgenden Kapiteln erweitern wir dann die Regression und schauen uns auch an, wie gut die Regression geklappt hat. Mit gut meine ich, in wie weit die Grade durch die Punkte auch den Zusammenhang zwischen den x-Werten und den y-Werte erklärt. Dazu dann mehr mehr in dem Kapitel zu der Modelgüte einer Regression.</span>
<span id="cb84-37"><a href="#cb84-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-38"><a href="#cb84-38" aria-hidden="true" tabindex="-1"></a><span class="fu">## Allgemeiner Hintergrund</span></span>
<span id="cb84-39"><a href="#cb84-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-40"><a href="#cb84-40" aria-hidden="true" tabindex="-1"></a>Was macht also eine simple lineare Regression? Die Regression ist eine Methode um eine lineare Grade durch eine Punktewolke in einem Scatterplot zu zeichnen. Dabei haben wir nur eine Einflussvariable $x$ vorliegen, da unser Modell zuallerst simple sein soll. Der Messwert $y$ ist in diesem Kapitel noch normalverteilt und damit auch kontinuierlich. Wir wollen also den Zusammenhang zwischen zwei kontinuierlichen Variablen durch eine Regression bestimmen. Wir sprechen in diesem Zusammenhang mit einer kontinuierlichen Einflussvariable von einer Kovariate. In einem nächsten Schritt ändern wir dann die Einflussvariable auf eine kategoriale Einflussvariable. Wir haben dann einen Faktor mit unterschiedlichen Gruppen vorliegen. Beide Fälle wollen wir uns dann einmal anschauen. Beginnen wollen wir aber mit einer allgemeinern Betrachtung. Welche Modelltypen oder Fragestellungen gibt es eigentlich? Bevor wir damit anfangen, einmal etwas sprachlicher Hintergrund.</span>
<span id="cb84-41"><a href="#cb84-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-42"><a href="#cb84-42" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Sprachlicher Hintergrund {.unnumbered .unlisted}</span></span>
<span id="cb84-43"><a href="#cb84-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-44"><a href="#cb84-44" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"In statistics courses taught by statisticians we don't use "independent variable" because we use independent on to mean stochastic independence. Instead we say predictor or covariate (either). And, similarly, we don't say "dependent variable" either. We say response." --- [User berf auf r/AskStatistics](https://www.reddit.com/r/AskStatistics/comments/qt1hvu/comment/hkigiks/?utm_source=share&amp;utm_medium=web3x&amp;utm_name=web3xcss&amp;utm_term=1&amp;utm_content=share_button)*</span></span>
<span id="cb84-45"><a href="#cb84-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-46"><a href="#cb84-46" aria-hidden="true" tabindex="-1"></a>Wenn wir uns mit dem statistischen Modellieren beschäftigen wollen, dann brauchen wir auch Worte um über das Thema reden zu können. Statistik wird in vielen Bereichen der Wissenschaft verwendet und in jedem Bereich nennen wir dann auch Dinge anders, die eigentlich gleich sind. Daher werde ich mir es hier herausnehmen und auch die Dinge so benennen, wie ich sie für didaktisch sinnvoll finde. Wir wollen hier was verstehen und lernen, somit brauchen wir auch eine klare Sprache.</span>
<span id="cb84-47"><a href="#cb84-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-48"><a href="#cb84-48" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>" layout-valign="top"}</span>
<span id="cb84-49"><a href="#cb84-49" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/personal_opinion.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb84-50"><a href="#cb84-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-51"><a href="#cb84-51" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Jeder nennt in der Statistik sein Y und X wie er möchte. Da ich hier nicht nur von Y und X schreiben will, führe ich eben die Worte ein, die ich nutzen will. Damit sind die Worte dann auch richtig, da der Kontext definiert ist. Andere mögen es dann anders machen. Ich mache es eben dann so. Danke." --- Jochen Kruppa-Scheetz, meiner bescheidener Meinung nach.*</span></span>
<span id="cb84-52"><a href="#cb84-52" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb84-53"><a href="#cb84-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-54"><a href="#cb84-54" aria-hidden="true" tabindex="-1"></a>In dem folgenden Kasten erkläre ich nochmal den Gebrauch meiner Begriffe im statistischen Testen. Es ist wichtig, dass wir hier uns klar verstehen. Zum einen ist es angenehmer auch mal ein Wort für ein Symbol zu schreiben. Auf der anderen Seite möchte ich aber auch, dass du dann das Wort richtig einem Konzept im statistischen Modellieren zuordnen kannst. Deshalb einmal hier meine persönliche und didaktische Zusammenstellung meiner Wort im statistischen Modellieren. Du kannst dann immer zu dem Kasten zurückgehen, wenn wir mal ein Wort nicht mehr ganz klar ist. Die fetten Begriffe sind die üblichen in den folgenden Kapiteln. Die anderen Worte werden immer mal wieder in der Literatur genutzt.</span>
<span id="cb84-55"><a href="#cb84-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-56"><a href="#cb84-56" aria-hidden="true" tabindex="-1"></a>{{&lt; include stat-modeling/stat-modeling-callout-words.qmd &gt;}}</span>
<span id="cb84-57"><a href="#cb84-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-58"><a href="#cb84-58" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Das Modell {.unnumbered .unlisted}</span></span>
<span id="cb84-59"><a href="#cb84-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-60"><a href="#cb84-60" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Models are about what changes, and what doesn't. Some are useful." --- [Markus Gesmann](https://magesblog.com/post/modelling-change/)*</span></span>
<span id="cb84-61"><a href="#cb84-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-62"><a href="#cb84-62" aria-hidden="true" tabindex="-1"></a>Fangen wir also erstmal allgemeiner an ein Modell und deren schreibweise zu verstehen. Was ist ein Modell im statistischen Sinne? Wenn du an ein Modell denkst und ein Modellauto oder aber ein Modell eines Hauses oder Landschaft vor dir siehst, dann ist das gar nicht so weit weg vonm einem statistischen Modell. Ein Modell eines Autos hat die Essenz eines Autos in sich. Wir erkennen das Auto wieder, haben aber natürlich nicht die gleichen Funktionalitäten wie bei einem echten Auto. So ist es auch bei dem statistischen Modellieren von Daten. Unser Auto sind also die erhobenen Daten und wir wollen ein Modell finden, was die Zusammenhänge und die Struktur in den Daten vereinfacht wiedergibt. Damit ist per se jedes Modell falsch, da es nur einen Teil der Wirklichkeit abbilden kann. Modelle sind aber manchmal nützlich. Wir können also erstmal wie folgt ein Modell zusammenfassen.</span>
<span id="cb84-63"><a href="#cb84-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-64"><a href="#cb84-64" aria-hidden="true" tabindex="-1"></a>Was ist ein Modell?</span>
<span id="cb84-65"><a href="#cb84-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-66"><a href="#cb84-66" aria-hidden="true" tabindex="-1"></a>:   Ein Modell vereinfacht. Dabei behält es die Essenz der modellierten Sache bei. Ein statistisches Modell versucht eine Struktur in Daten zu finden. Dabei modelliert es den Zusammenhang zwischen dem Messwert und Einflussvariablen. Wir sprechen hier auch gerne von einer Modellanpassung (eng. *fit*).</span>
<span id="cb84-67"><a href="#cb84-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-68"><a href="#cb84-68" aria-hidden="true" tabindex="-1"></a>Allgemeiner gesprochen versucht ein statistisches Modell deine Daten in ein erklärbaren Teil und einen unerklärbaren Teil zu zerlegen. Dafür nutzen wir dann den Zusammenhang von den Messwerten und den Einflussvariablen. Wir sprechen hier auch gerne von einer Modellanpassung (eng. *fit*). Wir passen ein Modell den Daten an. Je mehr die Einflussvariablen unseren Messwert erklären können, desto weniger bleibt unerklärt und somit kleiner ist auch der Fehler. Hierbei müssen wir etwas mit dem Wort Fehler aufpassen. Wir haben fast immer einen unerklärten Anteil von unserem Messwert nach dem Modellieren. Wir nennen diesen Anteil Fehler, meinen damit aber nicht, dass das Modell per se fehlerhaft ist.</span>
<span id="cb84-69"><a href="#cb84-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-72"><a href="#cb84-72" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-73"><a href="#cb84-73" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-74"><a href="#cb84-74" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb84-75"><a href="#cb84-75" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb84-76"><a href="#cb84-76" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb84-77"><a href="#cb84-77" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 1.5</span></span>
<span id="cb84-78"><a href="#cb84-78" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb84-79"><a href="#cb84-79" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Der Zusammenhang von Daten, dem statistischen Modell und dem Fehler. Das Modell versucht durch ein statistisches Modell $f(x)$ den Zusammenhang zwischen den Einflussvariablen dem Messwert zu erklären. Den Anteil des unerklärten Messwert geht in den Fehlerterm. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb84-80"><a href="#cb84-80" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-in-R-model-abstract</span></span>
<span id="cb84-81"><a href="#cb84-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-82"><a href="#cb84-82" aria-hidden="true" tabindex="-1"></a>p_model_abstract </span>
<span id="cb84-83"><a href="#cb84-83" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-84"><a href="#cb84-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-85"><a href="#cb84-85" aria-hidden="true" tabindex="-1"></a>Da wir uns natürlich für die parktische Anwendung in R bewegen, nutzen wir auch die Modellschreibweise, die in R üblich ist. In R wird diese Schreibweise auch mit der Funktion <span class="in">`formula()`</span> genutzt. Im Folgenden siehst du einmal ein Modell in einer abstrakten Form. Wir haben den Messwert $Y$ auf der linken Seite (eng. *left hand side*, abk. *LHS*) der Tilde und die Einflussvariablen $X$ auf der rechten Seite (eng. *right hand side*, abk. *RHS*). Dabei steht dann das $X$ hier einmal als Platzhalter und Sammelbegriff für verschiedene Arten von möglichen Variablen.</span>
<span id="cb84-86"><a href="#cb84-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-89"><a href="#cb84-89" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-90"><a href="#cb84-90" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-91"><a href="#cb84-91" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb84-92"><a href="#cb84-92" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb84-93"><a href="#cb84-93" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb84-94"><a href="#cb84-94" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 2</span></span>
<span id="cb84-95"><a href="#cb84-95" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb84-96"><a href="#cb84-96" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Statistische Modellschreibweise mit dem Messwert auf der linken Seite und den Einflussvariablen auf der rechten Seite der Tilde. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb84-97"><a href="#cb84-97" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-in-R-03</span></span>
<span id="cb84-98"><a href="#cb84-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-99"><a href="#cb84-99" aria-hidden="true" tabindex="-1"></a>p_lhs_rhs</span>
<span id="cb84-100"><a href="#cb84-100" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-101"><a href="#cb84-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-102"><a href="#cb84-102" aria-hidden="true" tabindex="-1"></a>Wenn wir jetzt zu R wechseln, sieht es dann etwas anders aus, da wir die Platzhalter $Y$ für den Messwert und $X$ für die Einflussvariable durch die Namen der Spalten in unserem Datensatz ersetzen. Der Datendatz liegt dann als <span class="in">`tibble()`</span> in R vor. Mehr dann dazu in den folgenden Beispielen in den jeweiligen Kapiteln zum Modellieren. Dann sieht das Modell in R wie in der folgenden Abbildung aus.</span>
<span id="cb84-103"><a href="#cb84-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-106"><a href="#cb84-106" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-107"><a href="#cb84-107" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-108"><a href="#cb84-108" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb84-109"><a href="#cb84-109" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb84-110"><a href="#cb84-110" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb84-111"><a href="#cb84-111" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 2</span></span>
<span id="cb84-112"><a href="#cb84-112" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb84-113"><a href="#cb84-113" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Statistische Modellschreibweise in R mit dem Messwert auf der linken Seite und den Einflussvariablen auf der rechten Seite der Tilde. Die Platzhalter $Y$ und $X$ werden durch die Spaltennamen im Datensatz ersetzt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb84-114"><a href="#cb84-114" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-in-R-20</span></span>
<span id="cb84-115"><a href="#cb84-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-116"><a href="#cb84-116" aria-hidden="true" tabindex="-1"></a>p_lhs_rhs_r</span>
<span id="cb84-117"><a href="#cb84-117" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-118"><a href="#cb84-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-119"><a href="#cb84-119" aria-hidden="true" tabindex="-1"></a>Jetzt haben wir verstanden über was wir sprechen wollen, was ein Modell ist und wie wir das Modell in R aufbauen. Dann können wir schon einen Schritt weitergehen und uns fragen, was wir wigentlich mit dem Modell machen wollen. Welche Forschungsfragen können wir denn mit einem statistischen Modell beantworten? Prinzipiell haben wir da zwei große Felder, die wir bearbeiten können.</span>
<span id="cb84-120"><a href="#cb84-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-121"><a href="#cb84-121" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Kausales vs. prädiktives Modell {.unnumbered .unlisted}</span></span>
<span id="cb84-122"><a href="#cb84-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-123"><a href="#cb84-123" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Vor 2001 bestand Statistik gefühlt zu 10% aus der Prädiktion -- heutzutage macht die Prädiktion die Mehrheit der Modellierungen aus." --- Gefühle einer anonymen Biometrikerin*</span></span>
<span id="cb84-124"><a href="#cb84-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-125"><a href="#cb84-125" aria-hidden="true" tabindex="-1"></a>Wir können ein kausuales oder ein prädiktives Modell rechnen. Wenn wir ein kausales Modell rechnen, dann haben wir die Frage im Kopf, wie ändert sich der Messwert $y$, wenn sich die Einflussvariable $x$ um eine Einheit ändert. Wir können die Einheit auch weglassen und allgmeiner nach der Änderung in $y$ durch die Änderung in $x$ sprechen. Es geht hier also um Steigung (eng. *slopes*) oder eben die Ableitung (eng. *derivative*) von $dy/dx$. In einem hier besprochenen linearen Modell ist die Frage nach der Steigung einfach zu beantworten. Schwieriger wird es im nicht linearen Modell. Hier nutzen wir dann [*Marginal effect models*](#sec-marginal) um die Steigungen entlang der Kurve zu bestimmen.</span>
<span id="cb84-126"><a href="#cb84-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-127"><a href="#cb84-127" aria-hidden="true" tabindex="-1"></a>Eine andere Frage können wir durch ein prädiktives Modell oder eine Vorhersagen (eng. *predictions*) herausfinden. Hier wollen wir wissen, welche Messwerte ergeben sich durch unser Modell für neue Werte der Einflussvariablen. Das können wir durch eine Vorhersage erreichen. Auch hier ist das lineare Modell einfacher zu verstehen ale eine nicht lineare Kurve. Wir können einfach neue $x$-Werte in die Formel der Gradengleichung einsetzen und erhalten die entsprechenden vorhergesagten $y$-Werte wiedergegeben. Wenn wir kein normalverteilten Messwert haben, müssen wir hier nochmal etwas mehr aufpassen. Dazu dann aber auch mehr in den entsprechenden Kapiteln zu den verschiedenen Modellierungen.</span>
<span id="cb84-128"><a href="#cb84-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-129"><a href="#cb84-129" aria-hidden="true" tabindex="-1"></a>Was sind Steigungen?</span>
<span id="cb84-130"><a href="#cb84-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-131"><a href="#cb84-131" aria-hidden="true" tabindex="-1"></a>:   Die Traktion der Graden über die Werte auf der x-Achse hinweg. Wenn $x$ sich ändert, wir ändert sich dann der Messwert $y$? In einem linearen Modell haben wir nur einen Wert als Koeffizienten für die Steigung.</span>
<span id="cb84-132"><a href="#cb84-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-133"><a href="#cb84-133" aria-hidden="true" tabindex="-1"></a>Was ist die Vorhersage?</span>
<span id="cb84-134"><a href="#cb84-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-135"><a href="#cb84-135" aria-hidden="true" tabindex="-1"></a>:   Die y-Werte auf der Graden für jeden beliebigen Wert auf der x-Achse. Welche Werte vom Messwert $y$ sagt das Modell für $x$-Werte vorraus? Wenn wir eine neue Beobachtung machen, welchen Messwert würde sich gegeben der Einflussvariable einstellen?</span>
<span id="cb84-136"><a href="#cb84-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-137"><a href="#cb84-137" aria-hidden="true" tabindex="-1"></a>Damit ergibt sich grob die folgende Abbildung als Möglichkeiten in dem statistischen Modellieren. Wir haben hier nur ein simples Modell vorliegen und betrachten hier nur eine Einflussvariable. Die Einflussvariable kann kontinuierliche oder eben kategorial sein. Im kausalen Modell wollen wir wissen, wie sich eine Änderung in der Einflussvariablen auf den Messwert auswirkt. In dem prädiktiven Modell wollen wir eine Vorhersage des Messwertes für neue Beobachtungen machen.</span>
<span id="cb84-138"><a href="#cb84-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-141"><a href="#cb84-141" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-142"><a href="#cb84-142" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb84-143"><a href="#cb84-143" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-144"><a href="#cb84-144" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb84-145"><a href="#cb84-145" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-scatter-modeling-R-01</span></span>
<span id="cb84-146"><a href="#cb84-146" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb84-147"><a href="#cb84-147" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb84-148"><a href="#cb84-148" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 15</span></span>
<span id="cb84-149"><a href="#cb84-149" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Das kausale und prädiktive Modell im statistischen Modellieren für den simplen Fall. In allen Fällen ist der Messwert $y$ normalverteilt. **(A)** *Kausales Modell* -- Wie verändert sich der Messwert $y$, wenn sich die kontinuierliche Einflussvariable $x$ ändert? Wie ist der numerische Zusammenhang zwischen $y$ und $x$? Eine Frage nach der Steigung der Graden. **(B)** *Kausales Modell* -- Wie verändert sich der Messwert $y$, wenn sich die kategoriale Einflussvariable als Faktor $f_A$ ändert? Wie ist der numerische Zusammenhang zwischen $y$ und $f_A$? Eine Frage nach der Steigung der Graden. **(C)** *Prädikitives Modell* -- Wenn $y$ und $x$ gemessen wurden, wie sehen dann die Werte von $y$ für neue $x$-Werte aus? Können wir mit der Einflussvariable $x$ die neuen Messwerte in $y$ vorhersagen? *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb84-150"><a href="#cb84-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-151"><a href="#cb84-151" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"images/R/stat-modeling-R-01.R"</span>)</span>
<span id="cb84-152"><a href="#cb84-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-153"><a href="#cb84-153" aria-hidden="true" tabindex="-1"></a>p11 <span class="sc">+</span> p14 <span class="sc">+</span> p12 <span class="sc">+</span> </span>
<span id="cb84-154"><a href="#cb84-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb84-155"><a href="#cb84-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>) </span>
<span id="cb84-156"><a href="#cb84-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-157"><a href="#cb84-157" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-158"><a href="#cb84-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-159"><a href="#cb84-159" aria-hidden="true" tabindex="-1"></a>Soviel zu dem allgemeinen Hintergrund. Nachdem wir jetzt auch die Fragestellungen erörtert haben, wollen wir jetzt einmal verstehen, wie die simple lineare Regression als ein statistisches Modell funktioniert und wie wir dort die Gradengleichung schätzen können. Die Berechungen kommen dann nochmal extra nach der Besprechung der Daten für die Beispiele.</span>
<span id="cb84-160"><a href="#cb84-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-161"><a href="#cb84-161" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theoretischer Hintergrund</span></span>
<span id="cb84-162"><a href="#cb84-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-163"><a href="#cb84-163" aria-hidden="true" tabindex="-1"></a>Beginnen wir damit was wir eigentlich erreichen wollen. In der folgenden Abbildung siehst du einmal die kontinuierliche Einflussvariable $x$ und den kontinuierlichen Messwert $y$ für sieben Beobachtungen. Jede der Beobachtungen hat einen Wert für $x$ und einen Wert für $y$. Wir können dann einen Scatterplot zeichnen. Jetzt wollen wir die optimale lineare Grade durch die Punkte finden. Wir erhalten dann die Gradengleichung. Darüber hinaus wollen wir auch noch wissen, wie gut die Grade durch die Punkte läuft.</span>
<span id="cb84-164"><a href="#cb84-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-167"><a href="#cb84-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-168"><a href="#cb84-168" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb84-169"><a href="#cb84-169" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-170"><a href="#cb84-170" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb84-171"><a href="#cb84-171" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-lin-reg-theo-00</span></span>
<span id="cb84-172"><a href="#cb84-172" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb84-173"><a href="#cb84-173" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.75</span></span>
<span id="cb84-174"><a href="#cb84-174" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb84-175"><a href="#cb84-175" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung einer simplen linearen Regression mit einem kontinuierlichen Messwert (y) und einer kontinuierlichen Einflussvariable (x) dargestellt. Eine geschätzte grade wird durch die Punktewolke gelegt. Wie lautet die Gradengleichung und liegen die Punkte auf der Graden? *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb84-176"><a href="#cb84-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-177"><a href="#cb84-177" aria-hidden="true" tabindex="-1"></a>p1_theo_00 </span>
<span id="cb84-178"><a href="#cb84-178" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-179"><a href="#cb84-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-180"><a href="#cb84-180" aria-hidden="true" tabindex="-1"></a>Wie finden wir die optimlare Grade? Hier kommt die <span class="co">[</span><span class="ot">Methode der kleinsten Quadrate</span><span class="co">](https://de.wikipedia.org/wiki/Methode_der_kleinsten_Quadrate)</span> (eng. *least square method*) zum Einsatz. Die Methode ist alt und wird dem Mathematiker Carl Gauß zugeschrieben. Im Jahr 1801 nutze Gaus die Methode um die Bahn des Zwergplaneten Ceres für eien kurze Zeitspanne korrekt vorherzusagen. Wir wollen hier die Methode der kleinsten Quadrate anwenden, um eben die beste Grade durch die Punkte zu finden. Wie wir in den folgenden Abbildung sehen, hat die lineare Grade eine kleinere Summe an Abweichungsquadraten als die quadratische Funktion. Wir würden hier also die blaue Grade der orangenen Graden vorziehen. Prinzipiell müssten wir also eine belibige Anzahl an Graden testen, in der Praxis gibt es aber eine geschlossende Formel für die optimale lineare Grade. Bei nicht linearen Zusammenhängen sieht es dann etwas anders aus. Dazu aber später mehr in dem entsprechenden <span class="co">[</span><span class="ot">Kapitel zu nicht lineare Regression</span><span class="co">](#sec-non-linear)</span>.</span>
<span id="cb84-181"><a href="#cb84-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-184"><a href="#cb84-184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-185"><a href="#cb84-185" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb84-186"><a href="#cb84-186" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-187"><a href="#cb84-187" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb84-188"><a href="#cb84-188" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-lin-reg-theo-02</span></span>
<span id="cb84-189"><a href="#cb84-189" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb84-190"><a href="#cb84-190" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5.5</span></span>
<span id="cb84-191"><a href="#cb84-191" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 11</span></span>
<span id="cb84-192"><a href="#cb84-192" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap:  "Methode der kleinsten Quadrate zur Bestimmung der optimalen Grade durch eine Punktewolke. **(A)** Zwei Gradengleichungen werden beispielhaft durch die Punkte gelegt und die Abweichung der Punkte auf der Graden zu den beobachteten Werten quadriert. Anschließend werden die Abweichungsquadrate aufsummiert. **(B)** Je kleiner die Fläche der Abweichungsquadrate ist, desto besser passt die Grade zu den Punkten. Hier ist die Fläche der linearen Grade kleiner als der quadratischen Anpassung. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb84-193"><a href="#cb84-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-194"><a href="#cb84-194" aria-hidden="true" tabindex="-1"></a>p_square_01 <span class="sc">+</span> p_square_02 <span class="sc">+</span></span>
<span id="cb84-195"><a href="#cb84-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb84-196"><a href="#cb84-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb84-197"><a href="#cb84-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb84-198"><a href="#cb84-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-199"><a href="#cb84-199" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-200"><a href="#cb84-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-201"><a href="#cb84-201" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>" layout-valign="center"}</span>
<span id="cb84-202"><a href="#cb84-202" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/angel_01.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb84-203"><a href="#cb84-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-204"><a href="#cb84-204" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *Wenn du jetzt denkst 'Hä?', dann besuche doch einmal die fantastische Seite [Explained Visually \| Ordinary Least Squares Regression](https://setosa.io/ev/ordinary-least-squares-regression/) um selber zu erfahren, was eine lineare Regression macht. Auf der Seite findest du interaktive Abbildungen, die dir das Konzept der linearen Regression sehr anschaulich nachvollziehen lassen.*</span></span>
<span id="cb84-205"><a href="#cb84-205" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb84-206"><a href="#cb84-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-207"><a href="#cb84-207" aria-hidden="true" tabindex="-1"></a>Am Ende modellieren oder minimieren wir die Varianz. Den nichts anders sind ja die Abweichungsquadrate. Je kleiner die Beobachtungen um die Grade streuen, desto besser passt auch die Grade zu den Punkten. Und eine quadratische Streuung in der Statistik ist nichts anderes als die Varianz, die wir schon aus der deskriptiven Statistik kennen.</span>
<span id="cb84-208"><a href="#cb84-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-209"><a href="#cb84-209" aria-hidden="true" tabindex="-1"></a>Nachdem wir die Methode der kleinsten Quadrate durchgeführt haben, kriegen wir folgende Gradengleichung wieder. Die Grade wird durch die Koeffizienten des y-Achsenabschnitts (eng. *intercept*) und der Steigung (eng. *slope*) beschrieben. Der nicht durch die Gradengleichung erklärte Rest wird auch Fehler (eng. *error*) oder im Kontext der linearen Regression dann Residuen genannt.</span>
<span id="cb84-210"><a href="#cb84-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-213"><a href="#cb84-213" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-214"><a href="#cb84-214" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-215"><a href="#cb84-215" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb84-216"><a href="#cb84-216" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb84-217"><a href="#cb84-217" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb84-218"><a href="#cb84-218" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 2.25</span></span>
<span id="cb84-219"><a href="#cb84-219" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb84-220"><a href="#cb84-220" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Formelschreibweise der simplen linearen Regression beinhaltend die Koeffizienten $\\beta_0$ für den y-Achsenabschnitt sowie $\\beta_1$ für die Steigung der Graden für eine Einflussvariable $x_1$. Die Residuen werden durch $\\epsilon$ abgebildet. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb84-221"><a href="#cb84-221" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-in-R-07</span></span>
<span id="cb84-222"><a href="#cb84-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-223"><a href="#cb84-223" aria-hidden="true" tabindex="-1"></a>p_simple_model</span>
<span id="cb84-224"><a href="#cb84-224" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-225"><a href="#cb84-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-226"><a href="#cb84-226" aria-hidden="true" tabindex="-1"></a>Die Grade wird somit durch eine Gradengleichung wie oben beschreiben. Du kennst vermutlich noch die Form $y = mx + b$. In der folgenden Tabelle siehst du nochmal den Vergleich von der Schreibweise der linearen Regression in der Schule und in der Statistik. Darüber hinaus sind die deutschen Begriffe den englischen Begriffen gegenüber gestellt. Warum schreiben wir die Gleichung in der Form? Damit wir später noch weitere $\beta_px_p$-Paare ergänzen könen und so <span class="co">[</span><span class="ot">multiple lineare Modelle</span><span class="co">](#sec-mult-reg-basic)</span> bauen können.</span>
<span id="cb84-227"><a href="#cb84-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-228"><a href="#cb84-228" aria-hidden="true" tabindex="-1"></a>| Schule | Statistik  |      Deutsch      |  Englisch   |</span>
<span id="cb84-229"><a href="#cb84-229" aria-hidden="true" tabindex="-1"></a>|:------:|:----------:|:-----------------:|:-----------:|</span>
<span id="cb84-230"><a href="#cb84-230" aria-hidden="true" tabindex="-1"></a>|  $m$   | $\beta_1$  |     Steigung      |    Slope    |</span>
<span id="cb84-231"><a href="#cb84-231" aria-hidden="true" tabindex="-1"></a>|  $x$   |   $x_1$    | Einflussvariable  | Risk factor |</span>
<span id="cb84-232"><a href="#cb84-232" aria-hidden="true" tabindex="-1"></a>|  $b$   | $\beta_0$  | y-Achsenabschnitt |  Intercept  |</span>
<span id="cb84-233"><a href="#cb84-233" aria-hidden="true" tabindex="-1"></a>|        | $\epsilon$ |     Residuen      |  Residual   |</span>
<span id="cb84-234"><a href="#cb84-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-235"><a href="#cb84-235" aria-hidden="true" tabindex="-1"></a>: Vergleich und Übersicht der schulischen vs. statistischen Begriffe in den linearen Regression sowie die deutschen und englischen Begriffe. {#tbl-reg-deu-eng}</span>
<span id="cb84-236"><a href="#cb84-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-237"><a href="#cb84-237" aria-hidden="true" tabindex="-1"></a>Wir können jetzt die Gradengleichung auch gleich nochmal in der Visualisierung beschriften. In der folgenden Abbildung sehen wir die Visualisierung des kovariaten Beispieldatensatzes. Die Grade läuft durch die Punktewolke und wird durch die statistischen Maßzahlen bzw. Parameter $\beta_0$, $\beta_1$ sowie den $\epsilon$ beschrieben. Wir sehen, dass das $\beta_0$ den *Intercept* darstellt und das $\beta_1$ die Steigung der Graden. Wenn wir $x$ um 1 Einheit erhöhen $x+1$, dann steigt der $y$ Wert um den Wert von $\beta_1$. Die einzelnen Abweichungen der beobachteten $y$-Wert zu den $y$-Werten auf der Grade - auch $\hat{y}$ bezeichnet - werden als Residuen oder auch $\epsilon$ abgebildet.</span>
<span id="cb84-238"><a href="#cb84-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-241"><a href="#cb84-241" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-242"><a href="#cb84-242" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb84-243"><a href="#cb84-243" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-244"><a href="#cb84-244" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb84-245"><a href="#cb84-245" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-lin-reg-theo-01</span></span>
<span id="cb84-246"><a href="#cb84-246" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb84-247"><a href="#cb84-247" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.75</span></span>
<span id="cb84-248"><a href="#cb84-248" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb84-249"><a href="#cb84-249" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung einer simplen linearen Regression mit einem kontinuierlichen Messwert (y) und einer kontinuierlichen Einflussvariable (x) dargestellt. Eine geschätzte Grade wird durch die Punktewolke gelegt. Die Grade wird durch die Koeffizienten des Intercept $\\beta_0$ sowie der Steigung $\\beta_1$ beschrieben. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb84-250"><a href="#cb84-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-251"><a href="#cb84-251" aria-hidden="true" tabindex="-1"></a>p1_theo_01</span>
<span id="cb84-252"><a href="#cb84-252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-253"><a href="#cb84-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-254"><a href="#cb84-254" aria-hidden="true" tabindex="-1"></a>Hier wird dann auch nochmal schneller klar, was der y-Achsenabschnitt ist und wie wir die Steigung zu interpretieren haben. Die Steigung sagt aus um welchen Wert sich der Messwert $Y$ ändert, wenn sich die Einflussvariable um eine Einheit erhöht. Die Residuen sind hier auch nochmal dargestellt und beschreiben eben den Rest oder Abstand, den die lineare Gradengleichung nicht an den Messwert beschreiben kann. Wir hätten nur keine Residuen, wenn die Graden sich durch alle Punkte schlängeln würde. Das geht jedoch mit einer linearen Funktion nicht. Außer die Punkte liegen alle auf einer Linie, was in einem biologischen System sehr selten vorkommt.</span>
<span id="cb84-255"><a href="#cb84-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-256"><a href="#cb84-256" aria-hidden="true" tabindex="-1"></a>Schauen wir uns einmal den Zusammenhang von $y$, den beobachteten Werten, und $\hat{y}$, den geschätzen Werten auf der Grade in unserem Beispiel an. In der folgenden Tabelle sehen wir die Berechnung der einzelnen Residuen für die Grade aus der obigen Abbildung. Die Daten kannst du dir dann nochmal im Datenabschnitt anschauen. Wir nehmen jedes beobachtete $y$ und ziehen den Wert von $y$ auf der Grade, bezeichnet als $\hat{y}$, ab. Diesen Schritt machen wir für jedes Wertepaar $(y_i; \hat{y}_i)$. In R werden die $\hat{y}$ auch angepasste Werte (eng *fitted values*) genannt. Die $\epsilon$ Werte werden dann Residuen (eng. *residuals*) bezeichnet.</span>
<span id="cb84-257"><a href="#cb84-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-258"><a href="#cb84-258" aria-hidden="true" tabindex="-1"></a>| x | y | $\boldsymbol{\hat{y}}$ | Residuen ($\boldsymbol{\epsilon}$) | Wert |</span>
<span id="cb84-259"><a href="#cb84-259" aria-hidden="true" tabindex="-1"></a>|:--:|:--:|:--:|:--:|:--:|</span>
<span id="cb84-260"><a href="#cb84-260" aria-hidden="true" tabindex="-1"></a>| 0.8 | 1.2 | 1.38 | $\epsilon_1 = y_1 - \hat{y}_1$ | $\epsilon_1 = 1.2 - 1.38 = -0.18$ |</span>
<span id="cb84-261"><a href="#cb84-261" aria-hidden="true" tabindex="-1"></a>| 1.0 | 1.8 | 1.48 | $\epsilon_2 = y_2 - \hat{y}_2$ | $\epsilon_2 = 1.8 - 1.48 = +0.32$ |</span>
<span id="cb84-262"><a href="#cb84-262" aria-hidden="true" tabindex="-1"></a>| 1.2 | 1.3 | 1.58 | $\epsilon_3 = y_3 - \hat{y}_3$ | $\epsilon_3 = 1.3 - 1.58 = -0.28$ |</span>
<span id="cb84-263"><a href="#cb84-263" aria-hidden="true" tabindex="-1"></a>| 1.9 | 1.7 | 1.94 | $\epsilon_4 = y_4 - \hat{y}_4$ | $\epsilon_4 = 1.7 - 1.94 = -0.24$ |</span>
<span id="cb84-264"><a href="#cb84-264" aria-hidden="true" tabindex="-1"></a>| 2.0 | 2.6 | 1.99 | $\epsilon_5 = y_5 - \hat{y}_5$ | $\epsilon_5 = 2.6 - 1.99 = +0.61$ |</span>
<span id="cb84-265"><a href="#cb84-265" aria-hidden="true" tabindex="-1"></a>| 2.7 | 1.8 | 2.34 | $\epsilon_6 = y_6 - \hat{y}_6$ | $\epsilon_6 = 1.8 - 2.34 = -0.54$ |</span>
<span id="cb84-266"><a href="#cb84-266" aria-hidden="true" tabindex="-1"></a>| 2.8 | 2.7 | 2.40 | $\epsilon_7 = y_7 - \hat{y}_7$ | $\epsilon_7 = 2.7 - 2.40 = +0.30$ |</span>
<span id="cb84-267"><a href="#cb84-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-268"><a href="#cb84-268" aria-hidden="true" tabindex="-1"></a>: Zusammenhang zwischen den $y$, den beobachteten Werten, und $\hat{y}$, den geschätzen Werten auf der Grade. Wir nennen den Abstand $y_i - \hat{y}_i$ auch Residuum oder *Epsilon* $\epsilon$. {#tbl-lin-reg-epsilon}</span>
<span id="cb84-269"><a href="#cb84-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-272"><a href="#cb84-272" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-273"><a href="#cb84-273" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb84-274"><a href="#cb84-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-275"><a href="#cb84-275" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.18</span>, <span class="fl">0.32</span>, <span class="sc">-</span><span class="fl">0.28</span>, <span class="sc">-</span><span class="fl">0.24</span>, <span class="fl">0.61</span>, <span class="sc">-</span><span class="fl">0.54</span>, <span class="fl">0.30</span>)</span>
<span id="cb84-276"><a href="#cb84-276" aria-hidden="true" tabindex="-1"></a>mean_e <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(epsilon), <span class="dv">2</span>)</span>
<span id="cb84-277"><a href="#cb84-277" aria-hidden="true" tabindex="-1"></a>var_e <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">var</span>(epsilon), <span class="dv">2</span>)</span>
<span id="cb84-278"><a href="#cb84-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-279"><a href="#cb84-279" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-280"><a href="#cb84-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-281"><a href="#cb84-281" aria-hidden="true" tabindex="-1"></a>Die Residuen haben einen Mittelwert von $\bar{\epsilon} = <span class="in">`r mean_e`</span>$ und eine Varianz von $s^2_{\epsilon} = <span class="in">`r var_e`</span>$. Wir schreiben, dass die Residuen normalverteilt sind mit $\epsilon \sim \mathcal{N}(0, s^2_{\epsilon})$. Wir zeichnen die Grade also so durch die Punktewolke, dass die Abstände zu den Punkten, die Residuen, im Mittel null sind. Die Optimierung erreichen wir in dem wir die Varianz der Residuuen minimieren. Folglich modellieren wir die Varianz.</span>
<span id="cb84-282"><a href="#cb84-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-283"><a href="#cb84-283" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb84-284"><a href="#cb84-284" aria-hidden="true" tabindex="-1"></a><span class="fu">## Weitere Tutorien für die simple lineare Regression</span></span>
<span id="cb84-285"><a href="#cb84-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-286"><a href="#cb84-286" aria-hidden="true" tabindex="-1"></a>Wir immer geht natürlich mehr als ich hier Vorstellen kann. Du findest im Folgenden Tutorien, die mich hier in dem Kapitel inspiriert haben. Ich habe mich ja in diesem Kapitel auf die Durchführbarkeit in R und die allgemeine Verständlichkeit konzentriert. Es geht aber natürlich wie immer auch mathematischer...</span>
<span id="cb84-287"><a href="#cb84-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-288"><a href="#cb84-288" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Wir funktioniert nun so eine lineare Regression und was sind den jetzt eigentlich die Koeffizienten $\beta_0$ und $\beta_1$ eigentlich? Hier gibt es die fantastische Seite <span class="co">[</span><span class="ot">Explained Visually \| Ordinary Least Squares Regression</span><span class="co">](https://setosa.io/ev/ordinary-least-squares-regression/)</span>, die dir nochmal erlaubt selbe mit Punkten in einem Scatterplot zu spielen und zu sehen wie sich dann die Regressionsgleichung ändert.</span>
<span id="cb84-289"><a href="#cb84-289" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Du kannst auf der Seite <span class="co">[</span><span class="ot">Manual linear regression analysis using R</span><span class="co">](https://davetang.org/muse/2012/02/10/manual-linear-regression-analysis-using-r/)</span> nochmal weiter über die lineare Regression lesen. Der Blogpost ist sehr umfangreich und erklärt nochmal schrittweise, wie die lineare Regression in R per hand funktioniert.</span>
<span id="cb84-290"><a href="#cb84-290" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Simple Regression auf Wikipedia</span><span class="co">](https://en.wikipedia.org/wiki/Simple_linear_regression#Fitting_the_regression_line)</span> mit weit mehr Informationen zu den Formeln und den Zusammenhängen. Ein toller zusammenfassender Artikel.</span>
<span id="cb84-291"><a href="#cb84-291" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Mehr zum Modellieren findest du im Openbook "Statistical Thinking for the 21st Century" in den beiden Kapiteln <span class="co">[</span><span class="ot">Statistical Thinking for the 21st Century --- What is a model?</span><span class="co">](https://statsthinking21.github.io/statsthinking21-core-site/fitting-models.html#what-is-a-model)</span> und <span class="co">[</span><span class="ot">Statistical Thinking for the 21st Century --- Practical statistical modeling?</span><span class="co">](https://statsthinking21.github.io/statsthinking21-core-site/practical-example.html#the-process-of-statistical-modeling)</span></span>
<span id="cb84-292"><a href="#cb84-292" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb84-293"><a href="#cb84-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-294"><a href="#cb84-294" aria-hidden="true" tabindex="-1"></a><span class="fu">## Genutzte R Pakete</span></span>
<span id="cb84-295"><a href="#cb84-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-296"><a href="#cb84-296" aria-hidden="true" tabindex="-1"></a>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</span>
<span id="cb84-297"><a href="#cb84-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-298"><a href="#cb84-298" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = TRUE}</span></span>
<span id="cb84-299"><a href="#cb84-299" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb84-300"><a href="#cb84-300" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, magrittr, broom,</span></span>
<span id="cb84-301"><a href="#cb84-301" aria-hidden="true" tabindex="-1"></a><span class="in">               readxl, ggpmisc, conflicted)</span></span>
<span id="cb84-302"><a href="#cb84-302" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(magrittr::set_names)</span></span>
<span id="cb84-303"><a href="#cb84-303" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(ggplot2::annotate)</span></span>
<span id="cb84-304"><a href="#cb84-304" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::filter)</span></span>
<span id="cb84-305"><a href="#cb84-305" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-306"><a href="#cb84-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-307"><a href="#cb84-307" aria-hidden="true" tabindex="-1"></a>An der Seite des Kapitels findest du den Link *Quellcode anzeigen*, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</span>
<span id="cb84-308"><a href="#cb84-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-309"><a href="#cb84-309" aria-hidden="true" tabindex="-1"></a><span class="fu">## Daten</span></span>
<span id="cb84-310"><a href="#cb84-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-311"><a href="#cb84-311" aria-hidden="true" tabindex="-1"></a>Für unsere Anwendung schauen wir uns jetzt einmal drei Datensätze an. Zuerst einen Datensatz mit der Sprungweite als kontinuierlichen Messwert und dem GEwicht als kontinuierliche Einflussvariable. Wir haben hier also einen einkovariaten Datensatz vorliegen. Dann möchte ich noch den Fall mit einer kategorialen Einflussvariable betrachten. Hier nehmen wir dann die verschiedenen Floharten als Faktor mit in den Datensatz. Wir haben dann einen einfaktoriellen Datensatz. Am Ende möchte ich dir immer nochmal zeigen, wie in R theoretisch die Berechnungen läufen. Dafür nutze ich dann einen theoretischen Datensatz mit Schlangenlängen aus @kery2010introduction. Ich habe den Datensatz leicht angepasst.</span>
<span id="cb84-312"><a href="#cb84-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-313"><a href="#cb84-313" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Einkovariater Datensatz {.unnumbered .unlisted}</span></span>
<span id="cb84-314"><a href="#cb84-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-315"><a href="#cb84-315" aria-hidden="true" tabindex="-1"></a>Wir wollen uns erstmal mit einem einfachen Datenbeispiel beschäftigen. Wir können die lineare Regression auf sehr großen Datensätzen anwenden, wie auch auf sehr kleinen Datensätzen. Prinzipiell ist das Vorgehen gleich. Wir nutzen jetzt aber erstmal einen kleinen Datensatz mit $n=7$ Hundeflöhen als Beobachtungen. In der folgenden Tabelle ist der Datensatz <span class="in">`cov1_tbl`</span> dargestellt. Wir wollen den Zusammenhang zwischen der Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span> und dem Gewicht in <span class="sc">\[</span>mg<span class="sc">\]</span> für sieben Hundeflöhe modellieren.</span>
<span id="cb84-316"><a href="#cb84-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-319"><a href="#cb84-319" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-320"><a href="#cb84-320" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-321"><a href="#cb84-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-322"><a href="#cb84-322" aria-hidden="true" tabindex="-1"></a>cov1_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/regression_data.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"covariate"</span>)</span>
<span id="cb84-323"><a href="#cb84-323" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-324"><a href="#cb84-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-325"><a href="#cb84-325" aria-hidden="true" tabindex="-1"></a>Dann schauen wir uns die Daten einmal in der folgenden Tabelle einmal an. Wir haben die Sprungweite und das Gewicht von sieben Hundeflöhen gemessen. Die Daten sind nach dem gewicht der Flöhe sortiert. Die Einflussvariable ist das Gewicht und der Messwert die Sprungweite.</span>
<span id="cb84-326"><a href="#cb84-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-329"><a href="#cb84-329" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-330"><a href="#cb84-330" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb84-331"><a href="#cb84-331" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-332"><a href="#cb84-332" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb84-333"><a href="#cb84-333" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-1cov-table</span></span>
<span id="cb84-334"><a href="#cb84-334" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Tabelle der Sprungweiten in [cm] als Messwert $y$  und dem Gewicht in [mg] von Hundeflöhen."</span></span>
<span id="cb84-335"><a href="#cb84-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-336"><a href="#cb84-336" aria-hidden="true" tabindex="-1"></a><span class="fu">read_xlsx</span>(<span class="st">"data/regression_data.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"covariate"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb84-337"><a href="#cb84-337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb84-338"><a href="#cb84-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-339"><a href="#cb84-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-340"><a href="#cb84-340" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbildung sehen wir die Visualisierung der Daten <span class="in">`cov1_tbl`</span> in einem Scatterplot mit einer geschätzen Grade durch die Punktewolke. Wir fragen uns, ob das Gewicht der Hundeflöhe einen Einfluss auf die Sprungweite der Flöhe hat. Da wir hier eine positive Steigung haben, können wir schließen, dass wir vermutlich einen positiven Zusammenhang vorliegen haben.</span>
<span id="cb84-341"><a href="#cb84-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-344"><a href="#cb84-344" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-345"><a href="#cb84-345" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb84-346"><a href="#cb84-346" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-347"><a href="#cb84-347" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-scatter-lin-01</span></span>
<span id="cb84-348"><a href="#cb84-348" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb84-349"><a href="#cb84-349" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.5</span></span>
<span id="cb84-350"><a href="#cb84-350" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb84-351"><a href="#cb84-351" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Scatterplot der Beobachtungen der Sprungweite in \\[cm\\] und dem Gewicht in \\[mg\\] für sieben Hundeflöhe. Die Grade verläuft mittig durch die Punkte."</span></span>
<span id="cb84-352"><a href="#cb84-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-353"><a href="#cb84-353" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cov1_tbl, <span class="fu">aes</span>(weight, jump_length)) <span class="sc">+</span></span>
<span id="cb84-354"><a href="#cb84-354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb84-355"><a href="#cb84-355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">fullrange =</span> <span class="cn">TRUE</span>,</span>
<span id="cb84-356"><a href="#cb84-356" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"#56B4E9"</span>) <span class="sc">+</span></span>
<span id="cb84-357"><a href="#cb84-357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb84-358"><a href="#cb84-358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Gewicht der Flöhe in [mg]"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>) <span class="sc">+</span></span>
<span id="cb84-359"><a href="#cb84-359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fl">3.5</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fl">3.5</span>)</span>
<span id="cb84-360"><a href="#cb84-360" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-361"><a href="#cb84-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-362"><a href="#cb84-362" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Einfaktorieller Datensatz {.unnumbered .unlisted}</span></span>
<span id="cb84-363"><a href="#cb84-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-364"><a href="#cb84-364" aria-hidden="true" tabindex="-1"></a>Etwas seltener in der reinen linearen Regression nutzen wir nur eine kategoriale Einflussvariable. Häufig sind wir dann hier schon in der einfaktoriellen ANOVA oder aber dem statistischen Gruppenvergleich. Hier wollen wir uns jetzt aber mal einen Datensatz mit der Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span> als Messwert und der Tierart als kategoriale Einflussvariable anschauen. Wir haben die Sprungweite von Hunde-, Katzen- und Fuchsflöhen gemessen. Die Tierart ist unsere Gruppe und damit unserer Faktor.</span>
<span id="cb84-365"><a href="#cb84-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-368"><a href="#cb84-368" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-369"><a href="#cb84-369" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-370"><a href="#cb84-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-371"><a href="#cb84-371" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/regression_data.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"factorial"</span>) <span class="sc">|&gt;</span></span>
<span id="cb84-372"><a href="#cb84-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb84-373"><a href="#cb84-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal))</span>
<span id="cb84-374"><a href="#cb84-374" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-375"><a href="#cb84-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-376"><a href="#cb84-376" aria-hidden="true" tabindex="-1"></a>Dann schauen wir uns die Daten einmal in der folgenden Tabelle als Auszug einmal an. Wichtig ist hier nochmal, dass du eben die Einflussvariable Tierart einen Faktor <span class="in">`animal`</span> mit drei Leveln also Gruppen vorliegen hast. Wir wollen jetzt die drei Tierarten hinsichtlich ihrer Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span> miteinander vergleichen.</span>
<span id="cb84-377"><a href="#cb84-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-380"><a href="#cb84-380" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-381"><a href="#cb84-381" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb84-382"><a href="#cb84-382" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-383"><a href="#cb84-383" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb84-384"><a href="#cb84-384" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-1fac-table</span></span>
<span id="cb84-385"><a href="#cb84-385" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Tabelle der Sprungweiten in [cm] als Messwert $y$ von Hunde-, Katzen- und Fuchsflöhen. Der Datensatz ist einfaktoriell, da wir nur einen Faktor vorliegen haben."</span></span>
<span id="cb84-386"><a href="#cb84-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-387"><a href="#cb84-387" aria-hidden="true" tabindex="-1"></a>fac1_raw_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/flea_dog_cat_fox.xlsx"</span>) <span class="sc">|&gt;</span></span>
<span id="cb84-388"><a href="#cb84-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, jump_length) </span>
<span id="cb84-389"><a href="#cb84-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-390"><a href="#cb84-390" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(fac1_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>),</span>
<span id="cb84-391"><a href="#cb84-391" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(fac1_raw_tbl)),</span>
<span id="cb84-392"><a href="#cb84-392" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(fac1_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb84-393"><a href="#cb84-393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb84-394"><a href="#cb84-394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-395"><a href="#cb84-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-396"><a href="#cb84-396" aria-hidden="true" tabindex="-1"></a>Und dann wollen wir uns noch einmal die Daten als einen einfachen Boxplot anschauen. Wir sehen, dass die Daten so gebaut sind, dass wir einen signifikanten Unterschied zwischend den Sprungweiten der Floharten erwarten. Die Boxen der Boxplots überlappen sich nicht und die Boxplots liegen auch nicht auf einer Ebene.</span>
<span id="cb84-397"><a href="#cb84-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-400"><a href="#cb84-400" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-401"><a href="#cb84-401" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-402"><a href="#cb84-402" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb84-403"><a href="#cb84-403" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb84-404"><a href="#cb84-404" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-simple-reg-boxplot-1fac</span></span>
<span id="cb84-405"><a href="#cb84-405" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb84-406"><a href="#cb84-406" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.5</span></span>
<span id="cb84-407"><a href="#cb84-407" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb84-408"><a href="#cb84-408" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Beispielhafter einfaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten."</span></span>
<span id="cb84-409"><a href="#cb84-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-410"><a href="#cb84-410" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fac1_tbl, </span>
<span id="cb84-411"><a href="#cb84-411" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb84-412"><a href="#cb84-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb84-413"><a href="#cb84-413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb84-414"><a href="#cb84-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, </span>
<span id="cb84-415"><a href="#cb84-415" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fill =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb84-416"><a href="#cb84-416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flohart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>) <span class="sc">+</span></span>
<span id="cb84-417"><a href="#cb84-417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb84-418"><a href="#cb84-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span>
<span id="cb84-419"><a href="#cb84-419" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-420"><a href="#cb84-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-421"><a href="#cb84-421" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Theoretischer Datensatz {.unnumbered .unlisted}</span></span>
<span id="cb84-422"><a href="#cb84-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-423"><a href="#cb84-423" aria-hidden="true" tabindex="-1"></a>Abschließend kommen wir noch zu einem theoretischen Datensatz dem ich @kery2010introduction entlehnt habe. Ich möchte nochmal zeigen, wie R intern mit der Modellmatrix die Berechnungen durchführt. Das hat mich interessiert und deshalb habe ich es einmal für mein Verständnis aufgeschrieben. Wenn es dich auch interessiert, dann kannst du in den entsprechenden Tabs weiter unten einmal nachschauen. Hier also erstmal ein sehr simpler theoretischer Datensatz zu Körperlängen von Schlangen. Wir müssen hier dann noch die Faktoren einmal umwandeln, damit wir auch später die Modellmatrix sauber vorliegen haben. Deshalb hier die explizite Benennung der Level in der Funktion <span class="in">`factor()`</span>.</span>
<span id="cb84-424"><a href="#cb84-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-427"><a href="#cb84-427" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-428"><a href="#cb84-428" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-429"><a href="#cb84-429" aria-hidden="true" tabindex="-1"></a>snake_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/regression_data.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"theory"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb84-430"><a href="#cb84-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">region =</span> <span class="fu">factor</span>(region, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"west"</span>, <span class="st">"nord"</span>)),</span>
<span id="cb84-431"><a href="#cb84-431" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="fu">factor</span>(color, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"schwarz"</span>, <span class="st">"rot"</span>, <span class="st">"blau"</span>)))</span>
<span id="cb84-432"><a href="#cb84-432" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-433"><a href="#cb84-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-434"><a href="#cb84-434" aria-hidden="true" tabindex="-1"></a>In der folgenden Tabelle ist der Datensatz <span class="in">`snake_tbl`</span> nochmal dargestellt. Wir haben die Schlangenlänge <span class="in">`svl`</span> als Messwert $y$ sowie das Gewicht der Schlangen <span class="in">`mass`</span> als kontinuierliche Einflussvariable, die Sammelregion <span class="in">`region`</span> und die Farbe der Schlangen <span class="in">`color`</span> und als kategoriale Einflussvariablen mit unterschiedlichen Anzahlen an Gruppen. Die Region <span class="in">`region`</span> ist also ein Faktor mit zwei Leveln und die Schlangenfarbe <span class="in">`color`</span> ein Faktor mit drei Leveln. Ich nutze den Datensatz also einmal als einen Spieldatensatz um die Modellierung theoretisch besser nachvollziehen zu können.</span>
<span id="cb84-435"><a href="#cb84-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-438"><a href="#cb84-438" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-439"><a href="#cb84-439" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-440"><a href="#cb84-440" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb84-441"><a href="#cb84-441" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Datensatz zu den Körperlängen als Messwert von acht Schlangen mit verschiedenen Einflussvariablen. Die Einflussvariablen haben verschiedene Eigenschaften und müssen daher unterschiedliche modelliert werden."</span></span>
<span id="cb84-442"><a href="#cb84-442" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-snakes</span></span>
<span id="cb84-443"><a href="#cb84-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-444"><a href="#cb84-444" aria-hidden="true" tabindex="-1"></a>snake_tbl <span class="sc">|&gt;</span> </span>
<span id="cb84-445"><a href="#cb84-445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb84-446"><a href="#cb84-446" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-447"><a href="#cb84-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-448"><a href="#cb84-448" aria-hidden="true" tabindex="-1"></a><span class="fu">## Kausales Modell</span></span>
<span id="cb84-449"><a href="#cb84-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-450"><a href="#cb84-450" aria-hidden="true" tabindex="-1"></a>Beginnen wir einmal mit dem kausalen Modell. Wir wollen also wissen, wie sich der Messwert $y$ ändert, wenn sich die Einflussvariable erhöht. Wir fragen hier also nach der Steigung. Da wir eine lineare Grade vorliegen haben, ist es eben einfach, wir müssen den Koeffizienten für die Steigung bestimmen und dann noch Testen. Wir wollen ja wissen, ob der Effekt auch signifikant ist. Mit dem Effekt meinen wir im Kontext der linearen Regression eben den Koeffizienten der Steigung. Wir betrachten jetzt also einmal das einkovariate Modell, mit einer kontinuierlichen Einflussvariable sowie einem faktoriellen Modell, mit einer kategorialen Variable. Der Messwert hier ist dann immer die kontinuierliche Sprungweite.</span>
<span id="cb84-451"><a href="#cb84-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-452"><a href="#cb84-452" aria-hidden="true" tabindex="-1"></a><span class="fu">### Einkovariates Modell</span></span>
<span id="cb84-453"><a href="#cb84-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-454"><a href="#cb84-454" aria-hidden="true" tabindex="-1"></a>Die simple lineare Regression ist ein einkovariates Modell. Häufig wird das einkovariate Modell dann einfach nur die lineare Regression genannt. Wir haben einen kontinuierlichen Messwert sowie eine kontinuierliche Einflussvariable. Wir nennen die kontinuierliche Einflussvariable eine Kovariate. Es ergibt sich dann das folgende abstrakte simple Modell. Auf der linken Seite ist der MEsswert und auf der rechten Seite der Tilde ist unsere eine Kovariate.</span>
<span id="cb84-455"><a href="#cb84-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-458"><a href="#cb84-458" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-459"><a href="#cb84-459" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-460"><a href="#cb84-460" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb84-461"><a href="#cb84-461" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb84-462"><a href="#cb84-462" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb84-463"><a href="#cb84-463" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 2</span></span>
<span id="cb84-464"><a href="#cb84-464" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb84-465"><a href="#cb84-465" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Schemantisches simples Modell mit einem Messwert $Y$ und einer kontinuierlichen Einflussvariable als Kovariate $c_1$ dargestellt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb84-466"><a href="#cb84-466" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-in-R-10</span></span>
<span id="cb84-467"><a href="#cb84-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-468"><a href="#cb84-468" aria-hidden="true" tabindex="-1"></a>p_1cov_model </span>
<span id="cb84-469"><a href="#cb84-469" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-470"><a href="#cb84-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-471"><a href="#cb84-471" aria-hidden="true" tabindex="-1"></a>Jetzt können wir dieses theoretische Modell einmal auf unser Beispiel zu den Sprungweiten als kontinuierlichen Messwert sowie dem Körpergewicht als Kovariate anwenden. Du findest in den folgenden Tabs einmal die Auswertung in R durch die Funktionen sowie die theoretische Betrachtung, wie R das kovariate Modell intern verrechnet. Aus praktischer Sicht brauchts du nur den ersten Tab.</span>
<span id="cb84-472"><a href="#cb84-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-473"><a href="#cb84-473" aria-hidden="true" tabindex="-1"></a>::::: panel-tabset</span>
<span id="cb84-474"><a href="#cb84-474" aria-hidden="true" tabindex="-1"></a><span class="fu">## Praktisch in R</span></span>
<span id="cb84-475"><a href="#cb84-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-476"><a href="#cb84-476" aria-hidden="true" tabindex="-1"></a>Für die lineare Regression nutzen wir die Funktion <span class="in">`lm()`</span> (eng. *linear model*) mit der Formelschreibweise. Wir schreiben auf der linken Seite den Messwert und auf die rechte Seite der Tilde dann die Kovariate. Dann müssen wir noch angeben in welchem Datensatz die beiden Variablen als Spalten zu finden sind. Dann schieben wir noch die Modellanpassung (eng. *fit*) in ein Objekt um uns verschiedene Informationen später ausgeben zu lassen. Mit Modelanpassung meinen wir, dass wir schauen, ob wir ein Modell finden, was zu den Daten passt.</span>
<span id="cb84-477"><a href="#cb84-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-480"><a href="#cb84-480" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-481"><a href="#cb84-481" aria-hidden="true" tabindex="-1"></a>cov1_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> weight, <span class="at">data =</span> cov1_tbl) </span>
<span id="cb84-482"><a href="#cb84-482" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-483"><a href="#cb84-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-484"><a href="#cb84-484" aria-hidden="true" tabindex="-1"></a>Mit der Funktion <span class="in">`coef()`</span> können wir dann die Koeffizienten der linearen Regression extrahieren. Wir erhalten einmal den Intercept als den y-Achsenabschnitt und die Steigung wieder. Die Steigung wird hier unter dem Namen der Spalte geschrieben.</span>
<span id="cb84-485"><a href="#cb84-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-488"><a href="#cb84-488" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-489"><a href="#cb84-489" aria-hidden="true" tabindex="-1"></a>cov1_fit <span class="sc">|&gt;</span> </span>
<span id="cb84-490"><a href="#cb84-490" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>()</span>
<span id="cb84-491"><a href="#cb84-491" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-492"><a href="#cb84-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-493"><a href="#cb84-493" aria-hidden="true" tabindex="-1"></a>Wir erhalten also einen y-Achsenabschnitt $\beta_0$ von $0.969$ sowie eine Steigung $\beta_1$ von $0.51$ wiedergegeben. In der folgenden Abbildung sehen wir dann einmal die Gerade durch die Punkte zusammen mit der Gradengleichung. Ich nutze hier die Funktion <span class="in">`stat_poly_line()`</span> und die Funktion <span class="in">`stat_poly_eq()`</span> um mir die Grade sowie die Gradengleichung einzeichnen zu lassen. Beide Funktionen findest du in dem <span class="co">[</span><span class="ot">R Paket `{ggpmisc}`</span><span class="co">](https://cran.rstudio.com/web/packages/ggpmisc/vignettes/user-guide.html)</span>.</span>
<span id="cb84-494"><a href="#cb84-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-497"><a href="#cb84-497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-498"><a href="#cb84-498" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-499"><a href="#cb84-499" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb84-500"><a href="#cb84-500" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb84-501"><a href="#cb84-501" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb84-502"><a href="#cb84-502" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.5</span></span>
<span id="cb84-503"><a href="#cb84-503" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb84-504"><a href="#cb84-504" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Scatterplot der Sprungweite in [cm] und dem Gewicht in [mg] von sieben Hundeflöhen. Die lineare Grade und die Gradengleichung wurden ergänzt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb84-505"><a href="#cb84-505" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-in-R-c1</span></span>
<span id="cb84-506"><a href="#cb84-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-507"><a href="#cb84-507" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cov1_tbl, <span class="fu">aes</span>(weight, jump_length)) <span class="sc">+</span></span>
<span id="cb84-508"><a href="#cb84-508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb84-509"><a href="#cb84-509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb84-510"><a href="#cb84-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb84-511"><a href="#cb84-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb84-512"><a href="#cb84-512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_line</span>(<span class="at">color =</span> <span class="st">"#56B4E9"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb84-513"><a href="#cb84-513" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fullrange =</span> <span class="cn">TRUE</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb84-514"><a href="#cb84-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">use_label</span>(<span class="st">"eq"</span>), <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb84-515"><a href="#cb84-515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Einkovariates Modell"</span>,</span>
<span id="cb84-516"><a href="#cb84-516" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Zusammenhang zwischen Sprungweite und Gewicht von Flöhen"</span>,</span>
<span id="cb84-517"><a href="#cb84-517" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Gewicht [mg]"</span>, <span class="at">y =</span> <span class="st">"Sprungweite [cm]"</span>)</span>
<span id="cb84-518"><a href="#cb84-518" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-519"><a href="#cb84-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-520"><a href="#cb84-520" aria-hidden="true" tabindex="-1"></a>Eigentlich wollen wir ja ein kausales Modell rechnen, da wir an dem Effekt der Kovariate Gewicht in <span class="sc">\[</span>mg<span class="sc">\]</span> der Hundeflöhe interessiert sind. Wenn also die Kovariate $c_1$ um eine Einheit ansteigt, um wie viel verändert sich dann der Messwert $y$?</span>
<span id="cb84-521"><a href="#cb84-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-522"><a href="#cb84-522" aria-hidden="true" tabindex="-1"></a>Der Koeffizient $\beta_1$ als Steigung der Graden gibt uns also den Einfluss oder den kausalen Zusammenhang zwischen dem Messwert $y$ und der Kovariate $c_1$ wieder. Im einem ersten Schritt schauen wir uns die Ausgabe der Funktion <span class="in">`summary()`</span> unseres Modells an.</span>
<span id="cb84-523"><a href="#cb84-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-526"><a href="#cb84-526" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-527"><a href="#cb84-527" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb84-528"><a href="#cb84-528" aria-hidden="true" tabindex="-1"></a>cov1_fit <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb84-529"><a href="#cb84-529" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-530"><a href="#cb84-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-531"><a href="#cb84-531" aria-hidden="true" tabindex="-1"></a>Wir erhalten dann folgende Ausgabe mit den entsprechenden Kurzerkläruungen von mir. Keine Angst, die gehen wir dann alle in den nächsten Paragraphen einmal durch.</span>
<span id="cb84-532"><a href="#cb84-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-535"><a href="#cb84-535" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-536"><a href="#cb84-536" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-537"><a href="#cb84-537" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb84-538"><a href="#cb84-538" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb84-539"><a href="#cb84-539" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb84-540"><a href="#cb84-540" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4.5</span></span>
<span id="cb84-541"><a href="#cb84-541" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb84-542"><a href="#cb84-542" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Annotierte Ausgabe der Funktion `summary()` aus einer linearen Modellanpassung mit der Funktion `lm()`. Die Ausgabe der Funktion teilt sich grob in drei informative Bereiche: Informationen zu den Residuen, Informationen zu den Koeffizienten und Informationen zu der Modelgüte. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb84-543"><a href="#cb84-543" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-in-R-c1-summary</span></span>
<span id="cb84-544"><a href="#cb84-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-545"><a href="#cb84-545" aria-hidden="true" tabindex="-1"></a>p_lm_summary_explained </span>
<span id="cb84-546"><a href="#cb84-546" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-547"><a href="#cb84-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-548"><a href="#cb84-548" aria-hidden="true" tabindex="-1"></a>Zuerst sehen wir nochmal welche Funktion wir aufgerufen haben und welches Modell gerechnet wurde. Dann kommen die Informationen zu den Residuen. Wenn alle Beobachtungen auf der Graden liegen würden, dann wären alle Residuen gleich Null. Bei zu wenigen Beobachtungen erhalten wir dann leider keine zusammenfassende Information zu den Residuen. Die Information zum Median und den Quartilen müssen wir uns dann selber einmal bauen.</span>
<span id="cb84-549"><a href="#cb84-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-552"><a href="#cb84-552" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-553"><a href="#cb84-553" aria-hidden="true" tabindex="-1"></a>cov1_fit <span class="sc">|&gt;</span> <span class="fu">residuals</span>() <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb84-554"><a href="#cb84-554" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-555"><a href="#cb84-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-556"><a href="#cb84-556" aria-hidden="true" tabindex="-1"></a>Die negativen Abweichungen und die positiven Abweichungen sollten sich auf Null aufaddieren. Der Median sollte ebenfalls dabei Null sein. Das 1st Quartile und das 3rd Quartile sollten ebenfalls im Betrag gleich sein. Deshalb sind auch die Residuen bei einer guten Modellanpassung normalverteilt mit einem Mittelwert von Null. Hier haben wir aber einigermaßen normalverteilte Residuen vorliegen. Die Residuen schauen wir uns aber nochmal im <span class="co">[</span><span class="ot">Kapitel zur Modelgüte</span><span class="co">](#sec-lin-reg-quality)</span> genauer an.</span>
<span id="cb84-557"><a href="#cb84-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-558"><a href="#cb84-558" aria-hidden="true" tabindex="-1"></a>Der Reststandardfehler (R <span class="in">`Residual standard error`</span>, abk. *RSE*) hat mehrere Vorteile. Er sagt dir direkt, wie genau die Vorhersagen des Modells unter Verwendung der Einheiten des Messwertes sind. Der Reststandardfehler gibt an, wie weit die Datenpunkte im Durchschnitt von der Graden entfernt sind.</span>
<span id="cb84-559"><a href="#cb84-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-560"><a href="#cb84-560" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb84-561"><a href="#cb84-561" aria-hidden="true" tabindex="-1"></a><span class="fu">## Achtung, bitte beachten!</span></span>
<span id="cb84-562"><a href="#cb84-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-563"><a href="#cb84-563" aria-hidden="true" tabindex="-1"></a>Du erhälst immer eine Grade und du erhälst faktisch immer eine Modellanpassung. Du musst dann selber entscheiden, ob dein Modell zu den Daten passt. Deshalb schauen wir uns auch die Residuen an und schauen, ob die Annahme der Normalverteilung an die Residuen erfüllt ist. Wenn dies nicht der Fall ist, dann passt unser Modell nicht zu den Daten und wir müssen ein anderes Modell ausprobieren.</span>
<span id="cb84-564"><a href="#cb84-564" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb84-565"><a href="#cb84-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-566"><a href="#cb84-566" aria-hidden="true" tabindex="-1"></a>Als nächstes erhalten wir die Informationen zu den Koeffizienten. Die Koeffizienten sind in einem simplen Modell der Intercept und die Steigung. Die Steigung hat immer den Namen der betrachteten Kovariate. Hier nochmal die Wiedergabe der Koeffizienten als Auszug von der obigen Tabelle.</span>
<span id="cb84-567"><a href="#cb84-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-570"><a href="#cb84-570" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-571"><a href="#cb84-571" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb84-572"><a href="#cb84-572" aria-hidden="true" tabindex="-1"></a>cov1_fit <span class="sc">|&gt;</span> <span class="fu">summary</span>() <span class="sc">|&gt;</span> <span class="fu">coef</span>()</span>
<span id="cb84-573"><a href="#cb84-573" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-574"><a href="#cb84-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-575"><a href="#cb84-575" aria-hidden="true" tabindex="-1"></a>Das heißt, wir kriegen dort $\beta_0$ als y-Achsenabschnitt sowie die Steigung $\beta_1$ für das Gewicht. Dabei ist wichtig zu wissen, dass immer als erstes der y-Achsenabschnitt <span class="in">`(Intercept)`</span> auftaucht. Dann die Steigung der Kovariate in dem Modell. Wir können die Gradengleichung wie folgt formulieren.</span>
<span id="cb84-576"><a href="#cb84-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-577"><a href="#cb84-577" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb84-578"><a href="#cb84-578" aria-hidden="true" tabindex="-1"></a>jump<span class="sc">\_</span>length \sim 0.97 + 0.51 \cdot weight</span>
<span id="cb84-579"><a href="#cb84-579" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb84-580"><a href="#cb84-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-581"><a href="#cb84-581" aria-hidden="true" tabindex="-1"></a>Was heißt die Gleichung nun? Wenn wir das Gewicht um eine Einheit erhöhen dann verändert sich die Sprungweite um den Wert von $\beta_1$. Wir haben hier eine Steigung von $0.51$ vorliegen. Ohne Einheit keine Interpretation! Wir wissen, dass das Gewicht in <span class="sc">\[</span>mg<span class="sc">\]</span> gemessen wurde und die Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span>. Damit können wir aussagen, dass wenn ein Floh 1 mg mehr wiegt der Floh 0.51 cm weiter springen würde. Schauen wir nochmal in die *saubere* Ausgabe der <span class="in">`tidy()`</span> Funktion aus dem R Paket <span class="in">`{broom}`</span>. Wir sehen nämlich noch einen $p$-Wert für den Intercept und die Steigung vom Gewicht.</span>
<span id="cb84-582"><a href="#cb84-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-585"><a href="#cb84-585" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-586"><a href="#cb84-586" aria-hidden="true" tabindex="-1"></a>cov1_fit <span class="sc">|&gt;</span> <span class="fu">tidy</span>()</span>
<span id="cb84-587"><a href="#cb84-587" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-588"><a href="#cb84-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-589"><a href="#cb84-589" aria-hidden="true" tabindex="-1"></a>Da wir hier einen p-Wert für jeden Koeffizienten haben, müssen wir auch einen Test rechnen. Wenn wir einen $p$-Wert sehen, dann brauchen wir eine Nullhypothese, die wir dann eventuell mit der Entscheidung am Signifikanzniveau $\alpha$ von 5% ablehnen können. Die Nullhypothese ist die Gleichheitshypothese. Wenn es also keinen Effekt von dem Gewicht auf die Sprungweite gebe, wie groß wäre dann $\beta_1$? Wir hätten dann keine Steigung und die Grade würde parallel zur x-Achse laufen. Das $\beta_1$ wäre dann gleich Null. Die Nullhypothesen lauten dabei also jedesmal, dass die Koeffizienten gleich Null sind. Wir testen also, ob wir einen Intercept von Null und eine Steigung von Null als Nullhypothese ablehnen können. Wenn wir $i$ Koeffizienten haben, dann haben wir alle alle $i$ Koeffizienten die folgenden Hypothesenpaare.</span>
<span id="cb84-590"><a href="#cb84-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-591"><a href="#cb84-591" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb84-592"><a href="#cb84-592" aria-hidden="true" tabindex="-1"></a>\begin{align*} </span>
<span id="cb84-593"><a href="#cb84-593" aria-hidden="true" tabindex="-1"></a>H_0: \beta_i &amp;= 0<span class="sc">\\</span>  </span>
<span id="cb84-594"><a href="#cb84-594" aria-hidden="true" tabindex="-1"></a>H_A: \beta_i &amp;\neq 0 <span class="sc">\\</span>   </span>
<span id="cb84-595"><a href="#cb84-595" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb84-596"><a href="#cb84-596" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb84-597"><a href="#cb84-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-598"><a href="#cb84-598" aria-hidden="true" tabindex="-1"></a>Wir haben für jedes $\beta_i$ ein eigenes Hypothesenpaar. Meistens interessiert uns der Intercept nicht. Ob der Intercept nun durch die Null geht oder nicht ist eher von geringem Interesse. Spannender ist aber wie sich der $p$-Wert berechnet. Der $p$-Wert basiert auf einer t-Statistik, also auf dem t-Test. Wir rechnen für jeden Koeffizienten $\beta_i$ einen t-Test. Das machen wir in dem wir den Koeffizienten <span class="in">`estimate`</span> durch den Fehler des Koeffizienten <span class="in">`std.error`</span> teilen.</span>
<span id="cb84-599"><a href="#cb84-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-600"><a href="#cb84-600" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb84-601"><a href="#cb84-601" aria-hidden="true" tabindex="-1"></a>\begin{align*} </span>
<span id="cb84-602"><a href="#cb84-602" aria-hidden="true" tabindex="-1"></a>T_{(Intercept)} &amp;= \cfrac{\mbox{estimate}}{\mbox{std.error}}  = \cfrac{0.969}{0.445} = 2.18<span class="sc">\\</span>  </span>
<span id="cb84-603"><a href="#cb84-603" aria-hidden="true" tabindex="-1"></a>T_{weight} &amp;= \cfrac{\mbox{estimate}}{\mbox{std.error}}  = \cfrac{0.510}{0.232} = 2.20<span class="sc">\\</span>   </span>
<span id="cb84-604"><a href="#cb84-604" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb84-605"><a href="#cb84-605" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb84-606"><a href="#cb84-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-607"><a href="#cb84-607" aria-hidden="true" tabindex="-1"></a>Wir sehen in diesem Fall, dass weder der Intercept noch die Steigung vom Gewicht signifikant sind, da die p-Werte mit $0.081$ und $0.079$ leicht über dem Signifikanzniveau von $\alpha$ gleich 5% liegen. Wir haben aber einen starkes Indiz gegen die Nullhypothese, da die Wahrscheinlichkeit die Daten zu beobachten sehr gering ist unter der Annahme das die Nullhypothese gilt.</span>
<span id="cb84-608"><a href="#cb84-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-609"><a href="#cb84-609" aria-hidden="true" tabindex="-1"></a>Zun Abschluß noch die Funktion <span class="in">`glance()`</span> ebenfalls aus dem R Paket <span class="in">`{broom}`</span>, die uns erlaubt noch die Qualitätsmaße der linearen Regression zu erhalten. Klar sehen wir die Werte auch alle in dem dritten Abschnitt der Ausgabe, aber hier haben wir nochmal alles zusammen. Wir müssen nämlich noch schauen, ob die Regression auch funktioniert hat. Die Überprüfung geht mit einer Kovariate sehr einfach. Wir können uns die Grade ja anschauen. Das geht dann mit einem Model mit mehreren Einflussvariablen nicht mehr und wir brauchen andere statistische Maßzahlen. Im <span class="co">[</span><span class="ot">Kapitel zur Modelgüte</span><span class="co">](#sec-lin-reg-quality)</span> diskutieren wir die statistischen Maßzahlen nochmal genauer. Hier reicht es zu wissen, dass wir ein hohes Bestimmtheitsmaß $R^2$ (eng. *r squared*) nahe Eins haben wollen. Unser Bestimmtheitsmaß liegt hier bei $0.492$ und ist somit gerade in Ordnung.</span>
<span id="cb84-610"><a href="#cb84-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-613"><a href="#cb84-613" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-614"><a href="#cb84-614" aria-hidden="true" tabindex="-1"></a>cov1_fit <span class="sc">|&gt;</span> <span class="fu">glance</span>() </span>
<span id="cb84-615"><a href="#cb84-615" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-616"><a href="#cb84-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-617"><a href="#cb84-617" aria-hidden="true" tabindex="-1"></a>Der p-Wert in der Ausgabe soll dich nicht irrtieren sondern dieser stammt aus einer ANOVA, die in diesem simplen Fall das gleiche testet wie der t-Test in der Zeile zum Gewicht. Wir erghhalten ja auch den gleichen p-Wert. Wir testen hier, ob unsere Kovariate einen Einfluss auf die Sprungweite im Allgemeinen hat. Hier nochmal die ANOVA ausgeschrieben mit der Funktion <span class="in">`aov()`</span>.</span>
<span id="cb84-618"><a href="#cb84-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-621"><a href="#cb84-621" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-622"><a href="#cb84-622" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> weight, <span class="at">data =</span> cov1_tbl) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb84-623"><a href="#cb84-623" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-624"><a href="#cb84-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-625"><a href="#cb84-625" aria-hidden="true" tabindex="-1"></a>Ganz am Ende möchte ich dir noch die Funktion <span class="in">`augment()`</span> aus dem Paket <span class="in">`{broom}`</span> zeigen die dir kompakt alle Informationen zu den einzelnen Beobachtungen gibt. Die <span class="in">`.fitted`</span>-Werte sind dabei die vorhergesagten Messwerte auf der Graden. Den Rest schauen wir uns dann noch in dem <span class="co">[</span><span class="ot">Kapitel zur Modelgüte</span><span class="co">](#sec-lin-reg-quality)</span> oder dem <span class="co">[</span><span class="ot">Kapitel zu den Ausreißern</span><span class="co">](#sec-outlier)</span> teilweise an.</span>
<span id="cb84-626"><a href="#cb84-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-629"><a href="#cb84-629" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-630"><a href="#cb84-630" aria-hidden="true" tabindex="-1"></a>cov1_fit <span class="sc">|&gt;</span> <span class="fu">augment</span>()</span>
<span id="cb84-631"><a href="#cb84-631" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-632"><a href="#cb84-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-633"><a href="#cb84-633" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theoretisch in R</span></span>
<span id="cb84-634"><a href="#cb84-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-635"><a href="#cb84-635" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>" layout-valign="top"}</span>
<span id="cb84-636"><a href="#cb84-636" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/personal_opinion.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb84-637"><a href="#cb84-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-638"><a href="#cb84-638" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Warum das kovariate Modell nochmal so zerforschen? Weil es mich interessiert hat, wie die Modelle intern gerechnet werden. Vor allem liest man schnell von einer Modellmatrix im Zusammenhang der Modellierung. Hier also mal alles sehr zerforscht. Braucht man nicht um es anzuwenden, ist aber hilfreich zu wissen. Denke ich." --- Jochen Kruppa-Scheetz, meiner bescheidener Meinung nach.*</span></span>
<span id="cb84-639"><a href="#cb84-639" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb84-640"><a href="#cb84-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-641"><a href="#cb84-641" aria-hidden="true" tabindex="-1"></a>Fangen wir also einmal an das kovariate Modell zu zerforschen. In einem ersten Schritt wollen wir uns einmal das lineare Modell mit einer kontinuierlichen Einflussvariable anschauen. Daher bauen wir uns ein lineares Modell mit der Kovariate <span class="in">`mass`</span> aus unseren Schlangendaten und der Körperlänge der Schlangen <span class="in">`svl`</span> als Messwert. Die Schlangendaten habe ich extra so gebaut, dass wir uns hier leicht was anschauen können. Wir erinnern uns, dass die Einslussvariable <span class="in">`mass`</span> eine kontinuierliche Variable ist, da wir hier nur Zahlen in der Spalte finden. Die Funktion <span class="in">`model.matrix()`</span> gibt uns die Modellmatrix wieder.</span>
<span id="cb84-642"><a href="#cb84-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-645"><a href="#cb84-645" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-646"><a href="#cb84-646" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(svl <span class="sc">~</span> mass, <span class="at">data =</span> snake_tbl) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span>
<span id="cb84-647"><a href="#cb84-647" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-648"><a href="#cb84-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-649"><a href="#cb84-649" aria-hidden="true" tabindex="-1"></a>In der ersten Spalte ist der Intercept angegeben, danach folgt dann die Spalte <span class="in">`mass`</span> als Kovariate. Wir können jetzt die Modellmatrix auch mathematisch schreiben und die $y$ Spalte für den Messwert <span class="in">`svl`</span> ergänzen. Eben so ergänzen wir die Koeffizienten $\beta_0$ als Intercept und $beta_{mass}$ als Steigung aus der linearen Regression sowie die Residuen als Abweichung von der angepassten Grade.</span>
<span id="cb84-650"><a href="#cb84-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-651"><a href="#cb84-651" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb84-652"><a href="#cb84-652" aria-hidden="true" tabindex="-1"></a> \begin{pmatrix}</span>
<span id="cb84-653"><a href="#cb84-653" aria-hidden="true" tabindex="-1"></a>  40 <span class="sc">\\</span></span>
<span id="cb84-654"><a href="#cb84-654" aria-hidden="true" tabindex="-1"></a>  45 <span class="sc">\\</span></span>
<span id="cb84-655"><a href="#cb84-655" aria-hidden="true" tabindex="-1"></a>  39 <span class="sc">\\</span></span>
<span id="cb84-656"><a href="#cb84-656" aria-hidden="true" tabindex="-1"></a>  50 <span class="sc">\\</span></span>
<span id="cb84-657"><a href="#cb84-657" aria-hidden="true" tabindex="-1"></a>  52 <span class="sc">\\</span></span>
<span id="cb84-658"><a href="#cb84-658" aria-hidden="true" tabindex="-1"></a>  57 <span class="sc">\\</span></span>
<span id="cb84-659"><a href="#cb84-659" aria-hidden="true" tabindex="-1"></a>  58 <span class="sc">\\</span></span>
<span id="cb84-660"><a href="#cb84-660" aria-hidden="true" tabindex="-1"></a>  59 <span class="sc">\\</span></span>
<span id="cb84-661"><a href="#cb84-661" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb84-662"><a href="#cb84-662" aria-hidden="true" tabindex="-1"></a> =</span>
<span id="cb84-663"><a href="#cb84-663" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb84-664"><a href="#cb84-664" aria-hidden="true" tabindex="-1"></a>  1 &amp; 6 <span class="sc">\\</span></span>
<span id="cb84-665"><a href="#cb84-665" aria-hidden="true" tabindex="-1"></a>  1 &amp; 8 <span class="sc">\\</span></span>
<span id="cb84-666"><a href="#cb84-666" aria-hidden="true" tabindex="-1"></a>  1 &amp; 5 <span class="sc">\\</span></span>
<span id="cb84-667"><a href="#cb84-667" aria-hidden="true" tabindex="-1"></a>  1 &amp; 7 <span class="sc">\\</span></span>
<span id="cb84-668"><a href="#cb84-668" aria-hidden="true" tabindex="-1"></a>  1 &amp; 9 <span class="sc">\\</span></span>
<span id="cb84-669"><a href="#cb84-669" aria-hidden="true" tabindex="-1"></a>  1 &amp; 11<span class="sc">\\</span></span>
<span id="cb84-670"><a href="#cb84-670" aria-hidden="true" tabindex="-1"></a>  1 &amp; 12<span class="sc">\\</span></span>
<span id="cb84-671"><a href="#cb84-671" aria-hidden="true" tabindex="-1"></a>  1 &amp; 10<span class="sc">\\</span></span>
<span id="cb84-672"><a href="#cb84-672" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb84-673"><a href="#cb84-673" aria-hidden="true" tabindex="-1"></a> \times</span>
<span id="cb84-674"><a href="#cb84-674" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb84-675"><a href="#cb84-675" aria-hidden="true" tabindex="-1"></a>  \beta_0 <span class="sc">\\</span></span>
<span id="cb84-676"><a href="#cb84-676" aria-hidden="true" tabindex="-1"></a>  \beta_{mass} </span>
<span id="cb84-677"><a href="#cb84-677" aria-hidden="true" tabindex="-1"></a> \end{pmatrix} +</span>
<span id="cb84-678"><a href="#cb84-678" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb84-679"><a href="#cb84-679" aria-hidden="true" tabindex="-1"></a>  \epsilon_1 <span class="sc">\\</span></span>
<span id="cb84-680"><a href="#cb84-680" aria-hidden="true" tabindex="-1"></a>  \epsilon_2 <span class="sc">\\</span></span>
<span id="cb84-681"><a href="#cb84-681" aria-hidden="true" tabindex="-1"></a>  \epsilon_3 <span class="sc">\\</span></span>
<span id="cb84-682"><a href="#cb84-682" aria-hidden="true" tabindex="-1"></a>  \epsilon_4 <span class="sc">\\</span></span>
<span id="cb84-683"><a href="#cb84-683" aria-hidden="true" tabindex="-1"></a>  \epsilon_5 <span class="sc">\\</span></span>
<span id="cb84-684"><a href="#cb84-684" aria-hidden="true" tabindex="-1"></a>  \epsilon_6 <span class="sc">\\</span></span>
<span id="cb84-685"><a href="#cb84-685" aria-hidden="true" tabindex="-1"></a>  \epsilon_7 <span class="sc">\\</span></span>
<span id="cb84-686"><a href="#cb84-686" aria-hidden="true" tabindex="-1"></a>  \epsilon_8 <span class="sc">\\</span></span>
<span id="cb84-687"><a href="#cb84-687" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb84-688"><a href="#cb84-688" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb84-689"><a href="#cb84-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-690"><a href="#cb84-690" aria-hidden="true" tabindex="-1"></a>Jetzt brauche wir natürlich die Koeffizienten aus dem linearen Modell, welches wir wie folgt mit der Funktion <span class="in">`lm()`</span> fitten. Wir nutzen dann die Funktion <span class="in">`coef()`</span> um uns die Koeffizienten aus dem Objekt <span class="in">`fit_1`</span> wiedergeben zu lassen.</span>
<span id="cb84-691"><a href="#cb84-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-694"><a href="#cb84-694" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-695"><a href="#cb84-695" aria-hidden="true" tabindex="-1"></a>snake_cov_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(svl <span class="sc">~</span> mass, <span class="at">data =</span> snake_tbl) </span>
<span id="cb84-696"><a href="#cb84-696" aria-hidden="true" tabindex="-1"></a>snake_cov_fit <span class="sc">|&gt;</span> <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb84-697"><a href="#cb84-697" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-698"><a href="#cb84-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-699"><a href="#cb84-699" aria-hidden="true" tabindex="-1"></a>Die Funktion <span class="in">`residuals()`</span> gibt uns die Residuen der Graden aus dem Objekt <span class="in">`snake_cov_fit`</span> wieder.</span>
<span id="cb84-700"><a href="#cb84-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-703"><a href="#cb84-703" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-704"><a href="#cb84-704" aria-hidden="true" tabindex="-1"></a>snake_cov_fit <span class="sc">|&gt;</span> <span class="fu">residuals</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb84-705"><a href="#cb84-705" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-706"><a href="#cb84-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-707"><a href="#cb84-707" aria-hidden="true" tabindex="-1"></a>Wir können jetzt die Koeffizienten in die Modellmatrix ergänzen. Wir haben den Intercept mit $\beta_0 = 26.71$ geschätzt. Weiter ergänzen wir die Steigung aus dem linearen Modell für <span class="in">`mass`</span> mit $\beta_{mass}=2.61$. Ebenfalls setzen wir Werte für die Residuen für jede der Beobachtungen in die Gleichung ein. Wir erhalten dann folgende ausgefüllte Gleichung.</span>
<span id="cb84-708"><a href="#cb84-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-709"><a href="#cb84-709" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb84-710"><a href="#cb84-710" aria-hidden="true" tabindex="-1"></a> \begin{pmatrix}</span>
<span id="cb84-711"><a href="#cb84-711" aria-hidden="true" tabindex="-1"></a>  40 <span class="sc">\\</span></span>
<span id="cb84-712"><a href="#cb84-712" aria-hidden="true" tabindex="-1"></a>  45 <span class="sc">\\</span></span>
<span id="cb84-713"><a href="#cb84-713" aria-hidden="true" tabindex="-1"></a>  39 <span class="sc">\\</span></span>
<span id="cb84-714"><a href="#cb84-714" aria-hidden="true" tabindex="-1"></a>  50 <span class="sc">\\</span></span>
<span id="cb84-715"><a href="#cb84-715" aria-hidden="true" tabindex="-1"></a>  52 <span class="sc">\\</span></span>
<span id="cb84-716"><a href="#cb84-716" aria-hidden="true" tabindex="-1"></a>  57 <span class="sc">\\</span></span>
<span id="cb84-717"><a href="#cb84-717" aria-hidden="true" tabindex="-1"></a>  58 <span class="sc">\\</span></span>
<span id="cb84-718"><a href="#cb84-718" aria-hidden="true" tabindex="-1"></a>  59 <span class="sc">\\</span></span>
<span id="cb84-719"><a href="#cb84-719" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb84-720"><a href="#cb84-720" aria-hidden="true" tabindex="-1"></a> =</span>
<span id="cb84-721"><a href="#cb84-721" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb84-722"><a href="#cb84-722" aria-hidden="true" tabindex="-1"></a>  26.71 &amp; \phantom{0}6 \cdot 2.61<span class="sc">\\</span></span>
<span id="cb84-723"><a href="#cb84-723" aria-hidden="true" tabindex="-1"></a>  26.71 &amp; \phantom{0}8 \cdot 2.61<span class="sc">\\</span></span>
<span id="cb84-724"><a href="#cb84-724" aria-hidden="true" tabindex="-1"></a>  26.71 &amp; \phantom{0}5 \cdot 2.61<span class="sc">\\</span></span>
<span id="cb84-725"><a href="#cb84-725" aria-hidden="true" tabindex="-1"></a>  26.71 &amp; \phantom{0}7 \cdot 2.61<span class="sc">\\</span></span>
<span id="cb84-726"><a href="#cb84-726" aria-hidden="true" tabindex="-1"></a>  26.71 &amp; \phantom{0}9 \cdot 2.61<span class="sc">\\</span></span>
<span id="cb84-727"><a href="#cb84-727" aria-hidden="true" tabindex="-1"></a>  26.71 &amp; 11\cdot 2.61<span class="sc">\\</span></span>
<span id="cb84-728"><a href="#cb84-728" aria-hidden="true" tabindex="-1"></a>  26.71 &amp; 12\cdot 2.61<span class="sc">\\</span></span>
<span id="cb84-729"><a href="#cb84-729" aria-hidden="true" tabindex="-1"></a>  26.71 &amp; 10\cdot 2.61<span class="sc">\\</span></span>
<span id="cb84-730"><a href="#cb84-730" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb84-731"><a href="#cb84-731" aria-hidden="true" tabindex="-1"></a>  +</span>
<span id="cb84-732"><a href="#cb84-732" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb84-733"><a href="#cb84-733" aria-hidden="true" tabindex="-1"></a>  -2.36<span class="sc">\\</span></span>
<span id="cb84-734"><a href="#cb84-734" aria-hidden="true" tabindex="-1"></a>  -2.57<span class="sc">\\</span></span>
<span id="cb84-735"><a href="#cb84-735" aria-hidden="true" tabindex="-1"></a>  -0.75 <span class="sc">\\</span></span>
<span id="cb84-736"><a href="#cb84-736" aria-hidden="true" tabindex="-1"></a>  +6.04<span class="sc">\\</span></span>
<span id="cb84-737"><a href="#cb84-737" aria-hidden="true" tabindex="-1"></a>  +1.82<span class="sc">\\</span></span>
<span id="cb84-738"><a href="#cb84-738" aria-hidden="true" tabindex="-1"></a>  +1.61<span class="sc">\\</span></span>
<span id="cb84-739"><a href="#cb84-739" aria-hidden="true" tabindex="-1"></a>  \phantom{+}0.00<span class="sc">\\</span></span>
<span id="cb84-740"><a href="#cb84-740" aria-hidden="true" tabindex="-1"></a>  -3.79<span class="sc">\\</span></span>
<span id="cb84-741"><a href="#cb84-741" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb84-742"><a href="#cb84-742" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb84-743"><a href="#cb84-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-744"><a href="#cb84-744" aria-hidden="true" tabindex="-1"></a>Wir können jetzt diese gewaltige Sammlung an Matrixen einmal auflösen. Steht denn nun wirklich rechts das Gleiche wie links von der Gleichung? Wir bauen uns die Zahlen von der rechten Seite der Gleichung einmal in R nach und schauen auf das Ergebnis. Wie du siehst ergänzen wir hier noch eine Reihe von Additionen um den Intercept mit der Steigung zu verbinden. Steht ja auch so in der Gleichung des linearen Modells drin, alles wird mit einem Plus miteinander verbunden.</span>
<span id="cb84-745"><a href="#cb84-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-748"><a href="#cb84-748" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-749"><a href="#cb84-749" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fl">26.71</span> <span class="sc">+</span>  <span class="dv">6</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">-</span> <span class="fl">2.36</span>,</span>
<span id="cb84-750"><a href="#cb84-750" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.71</span> <span class="sc">+</span>  <span class="dv">8</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">-</span> <span class="fl">2.57</span>,</span>
<span id="cb84-751"><a href="#cb84-751" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.71</span> <span class="sc">+</span>  <span class="dv">5</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">-</span> <span class="fl">0.75</span>,</span>
<span id="cb84-752"><a href="#cb84-752" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.71</span> <span class="sc">+</span>  <span class="dv">7</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">+</span> <span class="fl">6.04</span>,</span>
<span id="cb84-753"><a href="#cb84-753" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.71</span> <span class="sc">+</span>  <span class="dv">9</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">+</span> <span class="fl">1.82</span>,</span>
<span id="cb84-754"><a href="#cb84-754" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.71</span> <span class="sc">+</span> <span class="dv">11</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">+</span> <span class="fl">1.61</span>,</span>
<span id="cb84-755"><a href="#cb84-755" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.71</span> <span class="sc">+</span> <span class="dv">12</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">+</span> <span class="fl">0.00</span>,</span>
<span id="cb84-756"><a href="#cb84-756" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.71</span> <span class="sc">+</span> <span class="dv">10</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">-</span> <span class="fl">3.79</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>() </span>
<span id="cb84-757"><a href="#cb84-757" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-758"><a href="#cb84-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-759"><a href="#cb84-759" aria-hidden="true" tabindex="-1"></a>Oh ha! Die Zahlen, die wir rauskriegen, sind die gleichen Werte die unser Messwert der Schlangenlänge hat. Das heißt, die ganze Sache hat funktioniert. Wir können die Schlangenlänge durch die Kovariate der Körpermasse mit zwei Koeffizienten aus einem linearen Modell erklären.</span>
<span id="cb84-760"><a href="#cb84-760" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb84-761"><a href="#cb84-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-762"><a href="#cb84-762" aria-hidden="true" tabindex="-1"></a>Dann kommt hier noch ein kleiner Einschub. So wie Gauß kannst du auch die lineare Regression händisch ausrechnen. Das macht sicherlich auch dem einen oder anderen Spaß, aber nicht jedem. Ich zeige dir in dem folgenden Kasten einmal wie sich das einkovariate Modell händisch auflösen lässt. Und ja, ich nutze dann auch hier R um die Funktionen durchzuführen. Am Ende ist es dann aber auch eher ein großer Taschenrechner, den ich mit R nutze. Viel Spaß beim nachmachen.</span>
<span id="cb84-763"><a href="#cb84-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-764"><a href="#cb84-764" aria-hidden="true" tabindex="-1"></a>:::: callout-note</span>
<span id="cb84-765"><a href="#cb84-765" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simple lineare Regression händisch</span></span>
<span id="cb84-766"><a href="#cb84-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-767"><a href="#cb84-767" aria-hidden="true" tabindex="-1"></a>Gut, das war jetzt die theoretische Abhandlung der linearen Regression ohne eine mathematische Formel. Es geht natürlich auch mit den nackten Zahlen. In der folgenden Tabelle siehst du einmal sieben Beobachtungen mit dem Körpergewicht als $y$ sowie der Körpergröße als $x$. Wir wollen jetzt einmal die Regressionsgleichung bestimmen. Wir sehen also unsere Werte für $\beta_0$ und $\beta_1$ aus?</span>
<span id="cb84-768"><a href="#cb84-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-771"><a href="#cb84-771" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-772"><a href="#cb84-772" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb84-773"><a href="#cb84-773" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-774"><a href="#cb84-774" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb84-775"><a href="#cb84-775" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-example-by-hand-01</span></span>
<span id="cb84-776"><a href="#cb84-776" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Sieben Messungen der Körpergröße $x$ und dem zugehörigen Körpergewicht $y$."</span></span>
<span id="cb84-777"><a href="#cb84-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-778"><a href="#cb84-778" aria-hidden="true" tabindex="-1"></a>by_hand_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">height =</span> <span class="fu">c</span>(<span class="dv">167</span>, <span class="dv">188</span>, <span class="dv">176</span>, <span class="dv">186</span>, <span class="dv">192</span>, <span class="dv">205</span>, <span class="dv">198</span>),</span>
<span id="cb84-779"><a href="#cb84-779" aria-hidden="true" tabindex="-1"></a>                      <span class="at">weight =</span> <span class="fu">c</span>(<span class="dv">70</span>, <span class="dv">83</span>, <span class="dv">81</span>, <span class="dv">90</span>, <span class="dv">94</span>, <span class="dv">100</span>, <span class="dv">106</span>)) </span>
<span id="cb84-780"><a href="#cb84-780" aria-hidden="true" tabindex="-1"></a>by_hand_tbl <span class="sc">|&gt;</span> </span>
<span id="cb84-781"><a href="#cb84-781" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb84-782"><a href="#cb84-782" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-783"><a href="#cb84-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-784"><a href="#cb84-784" aria-hidden="true" tabindex="-1"></a>Damit wir einmal wissen, was wir als Lösung erhalten würden, hier einmal die lineare Regression mit der Funktion $lm()$ und die entsprechenden Werte für den <span class="in">`(Intercept)`</span> und der Steigung.</span>
<span id="cb84-785"><a href="#cb84-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-788"><a href="#cb84-788" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-789"><a href="#cb84-789" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(weight <span class="sc">~</span> height, <span class="at">data =</span> by_hand_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb84-790"><a href="#cb84-790" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>()</span>
<span id="cb84-791"><a href="#cb84-791" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-792"><a href="#cb84-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-793"><a href="#cb84-793" aria-hidden="true" tabindex="-1"></a>Wir suchen dann damit die folgende Regressionsgleichung mit der Körpergröße als $x$ und dem zugehörigen Körpergewicht als $y$.</span>
<span id="cb84-794"><a href="#cb84-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-795"><a href="#cb84-795" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb84-796"><a href="#cb84-796" aria-hidden="true" tabindex="-1"></a>weight = \beta_0 + \beta_1 \cdot height</span>
<span id="cb84-797"><a href="#cb84-797" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb84-798"><a href="#cb84-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-799"><a href="#cb84-799" aria-hidden="true" tabindex="-1"></a>Da es dann immer etwas schwer ist, sich den Zusammenhang zwischen Körpergewicht und Körpergröße vorzustellen, habe ich nochmal in der folgenden Abbildung den Scatterplot der Daten erstellt. Die rote Grade stellt die Regressiongleichung dar. Wir erhalten ein y-Achsenabschnitt mit $\beta_0$ von $-75.39$ sowie eine Steigung mit $\beta_1$ von $0.88$ aus unseren Daten.</span>
<span id="cb84-800"><a href="#cb84-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-803"><a href="#cb84-803" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-804"><a href="#cb84-804" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb84-805"><a href="#cb84-805" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-806"><a href="#cb84-806" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-example-by-hand-03</span></span>
<span id="cb84-807"><a href="#cb84-807" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb84-808"><a href="#cb84-808" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.5</span></span>
<span id="cb84-809"><a href="#cb84-809" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb84-810"><a href="#cb84-810" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Scatterplot der sieben Messungen der Körpergröße $x$ und dem zugehörigen Körpergewicht $y$ sowie der RegressionsGrade mit $y = -75.39 + 0.88 \\cdot x$. Die Grade verlauf wie erwartet mittig durch die Punktewolke."</span></span>
<span id="cb84-811"><a href="#cb84-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-812"><a href="#cb84-812" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(by_hand_tbl, <span class="fu">aes</span>(height, weight)) <span class="sc">+</span></span>
<span id="cb84-813"><a href="#cb84-813" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb84-814"><a href="#cb84-814" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb84-815"><a href="#cb84-815" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> \(x) <span class="sc">-</span><span class="fl">75.39</span> <span class="sc">+</span> <span class="fl">0.88</span> <span class="sc">*</span> x, <span class="at">color =</span> <span class="st">"#CC79A7"</span>)</span>
<span id="cb84-816"><a href="#cb84-816" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-817"><a href="#cb84-817" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-818"><a href="#cb84-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-819"><a href="#cb84-819" aria-hidden="true" tabindex="-1"></a>Jetzt stellt sich die Frage, wie wir *händisch* die Werte für den y-Achsenabschnitt mit $\beta_0$ sowie der Steigung mit $\beta_1$ berechnen. Dafür gibt es jeweils eine Formel. Hier müssen wir dann sehr viele Summen berechnen, was ich dann gleich einmal in einer Tabelle zusammenfasse.</span>
<span id="cb84-820"><a href="#cb84-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-821"><a href="#cb84-821" aria-hidden="true" tabindex="-1"></a>Formel für y-Achsenabschnitt mit $\beta_0$</span>
<span id="cb84-822"><a href="#cb84-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-823"><a href="#cb84-823" aria-hidden="true" tabindex="-1"></a>:   $$</span>
<span id="cb84-824"><a href="#cb84-824" aria-hidden="true" tabindex="-1"></a>    \beta_0 = \cfrac{(\Sigma Y)(\Sigma X^2) - (\Sigma X)(\Sigma XY)}{n(\Sigma X^2) - (\Sigma X)^2}</span>
<span id="cb84-825"><a href="#cb84-825" aria-hidden="true" tabindex="-1"></a>    $$</span>
<span id="cb84-826"><a href="#cb84-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-827"><a href="#cb84-827" aria-hidden="true" tabindex="-1"></a>Formel für Steigung mit $\beta_1$</span>
<span id="cb84-828"><a href="#cb84-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-829"><a href="#cb84-829" aria-hidden="true" tabindex="-1"></a>:   $$</span>
<span id="cb84-830"><a href="#cb84-830" aria-hidden="true" tabindex="-1"></a>    \beta_1 = \cfrac{n(\Sigma XY) - (\Sigma X)(\Sigma Y)}{n(\Sigma X^2) - (\Sigma X)^2} </span>
<span id="cb84-831"><a href="#cb84-831" aria-hidden="true" tabindex="-1"></a>    $$</span>
<span id="cb84-832"><a href="#cb84-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-833"><a href="#cb84-833" aria-hidden="true" tabindex="-1"></a>In der folgenden Tabelle siehst du nochmal die originalen Datenpunkte und dann die entsprechenden Werte für das Produkt von <span class="in">`weight`</span> und <span class="in">`height`</span> mit $XY$ und dann die jeweiligen Quadrate der beiden mit $X^2$ und $Y^2$. Wir brauchen dann aber nicht diese Werte sondern die Summen der Werte. Das Summieren lagere ich dann nochmal in eine weitere Tabelle aus.</span>
<span id="cb84-834"><a href="#cb84-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-837"><a href="#cb84-837" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-838"><a href="#cb84-838" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb84-839"><a href="#cb84-839" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-840"><a href="#cb84-840" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb84-841"><a href="#cb84-841" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-example-by-hand-02</span></span>
<span id="cb84-842"><a href="#cb84-842" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Berechnungen des Produkts von $X$ und $Y$ sowie deren Quadrate mit $X^2$ und $Y^2$."</span></span>
<span id="cb84-843"><a href="#cb84-843" aria-hidden="true" tabindex="-1"></a>by_hand_tbl <span class="sc">|&gt;</span> </span>
<span id="cb84-844"><a href="#cb84-844" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">a =</span> height <span class="sc">*</span> weight,</span>
<span id="cb84-845"><a href="#cb84-845" aria-hidden="true" tabindex="-1"></a>         <span class="at">b =</span> height<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb84-846"><a href="#cb84-846" aria-hidden="true" tabindex="-1"></a>         <span class="at">c =</span> weight<span class="sc">^</span><span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb84-847"><a href="#cb84-847" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">"height"</span>, <span class="st">"weight"</span>, <span class="st">"$XY$"</span>, <span class="st">"$X^2$"</span>, <span class="st">"$Y^2$"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb84-848"><a href="#cb84-848" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb84-849"><a href="#cb84-849" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-850"><a href="#cb84-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-851"><a href="#cb84-851" aria-hidden="true" tabindex="-1"></a>In der abschließenden Tabelle findest du dann einmal die Summen der beobachteten Werte $X$ und $Y$ sowie des Produkts von $X$ und $Y$ sowie deren Quadrate mit $X^2$ und $Y^2$. Damit haben wir dann alles zusammen um die Formel oben zu füllen.</span>
<span id="cb84-852"><a href="#cb84-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-855"><a href="#cb84-855" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-856"><a href="#cb84-856" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb84-857"><a href="#cb84-857" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-858"><a href="#cb84-858" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb84-859"><a href="#cb84-859" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-example-by-hand-03</span></span>
<span id="cb84-860"><a href="#cb84-860" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Summe der Datenpunkte für $X$ und $Y$ sowie des Produkts von $X$ und $Y$ sowie deren Quadrate mit $X^2$ und $Y^2$"</span></span>
<span id="cb84-861"><a href="#cb84-861" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">height =</span> <span class="fu">sum</span>(by_hand_tbl<span class="sc">$</span>height),</span>
<span id="cb84-862"><a href="#cb84-862" aria-hidden="true" tabindex="-1"></a>       <span class="at">weight =</span> <span class="fu">sum</span>(by_hand_tbl<span class="sc">$</span>weight),</span>
<span id="cb84-863"><a href="#cb84-863" aria-hidden="true" tabindex="-1"></a>       <span class="at">a =</span> <span class="fu">sum</span>(by_hand_tbl<span class="sc">$</span>height <span class="sc">*</span> by_hand_tbl<span class="sc">$</span>weight), </span>
<span id="cb84-864"><a href="#cb84-864" aria-hidden="true" tabindex="-1"></a>       <span class="at">b =</span> <span class="fu">sum</span>(by_hand_tbl<span class="sc">$</span>height<span class="sc">^</span><span class="dv">2</span>), </span>
<span id="cb84-865"><a href="#cb84-865" aria-hidden="true" tabindex="-1"></a>       <span class="at">c =</span> <span class="fu">sum</span>(by_hand_tbl<span class="sc">$</span>weight<span class="sc">^</span><span class="dv">2</span>),) <span class="sc">|&gt;</span> </span>
<span id="cb84-866"><a href="#cb84-866" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">"height $(</span><span class="sc">\\</span><span class="st">Sigma X)$"</span>, <span class="st">"weight $(</span><span class="sc">\\</span><span class="st">Sigma Y)$"</span>, <span class="st">"$</span><span class="sc">\\</span><span class="st">Sigma XY$"</span>, <span class="st">"$</span><span class="sc">\\</span><span class="st">Sigma X^2$"</span>, <span class="st">"$</span><span class="sc">\\</span><span class="st">Sigma Y^2$"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb84-867"><a href="#cb84-867" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb84-868"><a href="#cb84-868" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-869"><a href="#cb84-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-870"><a href="#cb84-870" aria-hidden="true" tabindex="-1"></a>Ich habe dann die ganzen Summen einmal händisch berechnet und dann in den Formeln von oben eingesetzt. Wir erhalten dann für den y-Achsenabschnitt $\beta_0$ folgenden Wert.</span>
<span id="cb84-871"><a href="#cb84-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-872"><a href="#cb84-872" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb84-873"><a href="#cb84-873" aria-hidden="true" tabindex="-1"></a>\beta_0 = \cfrac{624 \cdot 246898 - 1312 \cdot 117826}{7\cdot 246898 - 1312^2} = -75.39038</span>
<span id="cb84-874"><a href="#cb84-874" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb84-875"><a href="#cb84-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-876"><a href="#cb84-876" aria-hidden="true" tabindex="-1"></a>Die ganze Berechnung habe ich dann auch einmal für die Steigung $\beta_1$ ebenfalls einmal durchgeführt.</span>
<span id="cb84-877"><a href="#cb84-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-878"><a href="#cb84-878" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb84-879"><a href="#cb84-879" aria-hidden="true" tabindex="-1"></a>b_1 = \cfrac{7\cdot 117826 - 1312\cdot624}{7\cdot246898 - 1312^2} = 0.877845</span>
<span id="cb84-880"><a href="#cb84-880" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb84-881"><a href="#cb84-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-882"><a href="#cb84-882" aria-hidden="true" tabindex="-1"></a>Wir sehen, es kommen die gleichen Werte für den y-Achsenabschnitt $\beta_0$ und die Steigung $\beta_1$ raus. Das hat ja schonmal sehr gut geklappt. Eine andere Art die gleiche Werte effizienter zu berechnen ist die Matrixberechnung der Koeffizienten der linearen Regression. Wir könnten dann auch komplexere Modelle mit mehr als nur einem $x$ und einem $\beta_1$ berechnen. Die grundlegende Formel siehst du einmal im Folgenden dargestellt.</span>
<span id="cb84-883"><a href="#cb84-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-884"><a href="#cb84-884" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb84-885"><a href="#cb84-885" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix}</span>
<span id="cb84-886"><a href="#cb84-886" aria-hidden="true" tabindex="-1"></a>\beta_0 <span class="sc">\\</span> </span>
<span id="cb84-887"><a href="#cb84-887" aria-hidden="true" tabindex="-1"></a>\beta_1 </span>
<span id="cb84-888"><a href="#cb84-888" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}</span>
<span id="cb84-889"><a href="#cb84-889" aria-hidden="true" tabindex="-1"></a>= \mathbf{(X^T X)^{−1}(X^T Y)}</span>
<span id="cb84-890"><a href="#cb84-890" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb84-891"><a href="#cb84-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-892"><a href="#cb84-892" aria-hidden="true" tabindex="-1"></a>Wir brauchen jetzt einiges an Matrixrechnung um die jeweiligen Formelteile zu berechnen. Ich habe dir in den folgenden Tabs einmal Schritt für Schritt die einzelnen Teile berechnet. Wir immer machen wir das eigentlich nicht so richtig per Hand, sondern nutzen einen Computer. Prinzipiell wäre eine händische Lösung natürlich möglich.</span>
<span id="cb84-893"><a href="#cb84-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-894"><a href="#cb84-894" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb84-895"><a href="#cb84-895" aria-hidden="true" tabindex="-1"></a><span class="fu">## $X$</span></span>
<span id="cb84-896"><a href="#cb84-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-899"><a href="#cb84-899" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-900"><a href="#cb84-900" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="dv">167</span>, <span class="dv">188</span>, <span class="dv">176</span>, <span class="dv">186</span>, <span class="dv">192</span>, <span class="dv">205</span>, <span class="dv">198</span>))</span>
<span id="cb84-901"><a href="#cb84-901" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">7</span>), X) </span>
<span id="cb84-902"><a href="#cb84-902" aria-hidden="true" tabindex="-1"></a>X </span>
<span id="cb84-903"><a href="#cb84-903" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-904"><a href="#cb84-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-905"><a href="#cb84-905" aria-hidden="true" tabindex="-1"></a><span class="fu">## $Y$</span></span>
<span id="cb84-906"><a href="#cb84-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-909"><a href="#cb84-909" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-910"><a href="#cb84-910" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="dv">70</span>, <span class="dv">83</span>, <span class="dv">81</span>, <span class="dv">90</span>, <span class="dv">94</span>, <span class="dv">100</span>, <span class="dv">106</span>))</span>
<span id="cb84-911"><a href="#cb84-911" aria-hidden="true" tabindex="-1"></a>Y</span>
<span id="cb84-912"><a href="#cb84-912" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-913"><a href="#cb84-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-914"><a href="#cb84-914" aria-hidden="true" tabindex="-1"></a><span class="fu">## $X^T$</span></span>
<span id="cb84-915"><a href="#cb84-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-918"><a href="#cb84-918" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-919"><a href="#cb84-919" aria-hidden="true" tabindex="-1"></a>Xt <span class="ot">&lt;-</span> <span class="fu">t</span>(X) </span>
<span id="cb84-920"><a href="#cb84-920" aria-hidden="true" tabindex="-1"></a>Xt</span>
<span id="cb84-921"><a href="#cb84-921" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-922"><a href="#cb84-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-923"><a href="#cb84-923" aria-hidden="true" tabindex="-1"></a><span class="fu">## $X^T X$</span></span>
<span id="cb84-924"><a href="#cb84-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-927"><a href="#cb84-927" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-928"><a href="#cb84-928" aria-hidden="true" tabindex="-1"></a>XtX <span class="ot">&lt;-</span> Xt <span class="sc">%*%</span> X</span>
<span id="cb84-929"><a href="#cb84-929" aria-hidden="true" tabindex="-1"></a>XtX</span>
<span id="cb84-930"><a href="#cb84-930" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-931"><a href="#cb84-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-932"><a href="#cb84-932" aria-hidden="true" tabindex="-1"></a><span class="fu">## $X^T Y$</span></span>
<span id="cb84-933"><a href="#cb84-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-936"><a href="#cb84-936" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-937"><a href="#cb84-937" aria-hidden="true" tabindex="-1"></a>XtY <span class="ot">&lt;-</span> Xt <span class="sc">%*%</span> Y</span>
<span id="cb84-938"><a href="#cb84-938" aria-hidden="true" tabindex="-1"></a>XtY</span>
<span id="cb84-939"><a href="#cb84-939" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-940"><a href="#cb84-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-941"><a href="#cb84-941" aria-hidden="true" tabindex="-1"></a><span class="fu">## $(X^T X)^{−1}$</span></span>
<span id="cb84-942"><a href="#cb84-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-945"><a href="#cb84-945" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-946"><a href="#cb84-946" aria-hidden="true" tabindex="-1"></a>XtXinv <span class="ot">&lt;-</span> <span class="fu">solve</span>(XtX)</span>
<span id="cb84-947"><a href="#cb84-947" aria-hidden="true" tabindex="-1"></a>XtXinv</span>
<span id="cb84-948"><a href="#cb84-948" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-949"><a href="#cb84-949" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb84-950"><a href="#cb84-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-951"><a href="#cb84-951" aria-hidden="true" tabindex="-1"></a>Am Ende müssen wir dann alle Teile in der Form $\mathbf{(X^T X)^{−1}(X^T Y)}$ einmal zusammenbringen. Das siehst dann in R wie folgt aus. Wir erhalten dann eine Matrix wieder wobei die erste Zeile der y-Achsenabschnitt $\beta_0$ und die zweite Zeile die Steigung $\beta_1$ ist. Wir erhalten fast die gleichen Werte wie auch schon oben.</span>
<span id="cb84-952"><a href="#cb84-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-955"><a href="#cb84-955" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-956"><a href="#cb84-956" aria-hidden="true" tabindex="-1"></a>XtXinv <span class="sc">%*%</span> Xt <span class="sc">%*%</span> Y</span>
<span id="cb84-957"><a href="#cb84-957" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-958"><a href="#cb84-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-959"><a href="#cb84-959" aria-hidden="true" tabindex="-1"></a>Wenn du dich tiefer in die Thematik einlesen willst, dann sind hier weitere Quellen zu der Thematik unter den folgenden Links und Tutorien.</span>
<span id="cb84-960"><a href="#cb84-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-961"><a href="#cb84-961" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Hands-On Machine Learning with R \| Linear Regression</span><span class="co">](https://bradleyboehmke.github.io/HOML/linear-regression.html)</span></span>
<span id="cb84-962"><a href="#cb84-962" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Manual linear regression analysis using R</span><span class="co">](https://davetang.org/muse/2012/02/10/manual-linear-regression-analysis-using-r/)</span></span>
<span id="cb84-963"><a href="#cb84-963" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Linear Regression by Hand</span><span class="co">](https://towardsdatascience.com/linear-regression-by-hand-python-and-r-79994d47f68)</span></span>
<span id="cb84-964"><a href="#cb84-964" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">How to Perform Linear Regression by Hand</span><span class="co">](https://www.statology.org/linear-regression-by-hand/)</span></span>
<span id="cb84-965"><a href="#cb84-965" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Matrix Approach to Simple Linear Regression in R</span><span class="co">](https://lasanthiwatagoda.github.io/STT4830ClassRepo/RCodes/Ch5Script.html)</span></span>
<span id="cb84-966"><a href="#cb84-966" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb84-967"><a href="#cb84-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-968"><a href="#cb84-968" aria-hidden="true" tabindex="-1"></a>Damit haben wir das einkovariate Modell abgeschlossen. Hier ist dann auch meistens Ende, wenn wir von der klassischen linearen Regression reden. Wir haben unseren kontinuierlichen Messwert und dann noch unsere kontinuierliche Einflussvariable. Dann legen wir eine Grade durch die Punkte und erhalten die Gradengleichung. Damit sind wir dann zufrieden. Eventuell wollen wir dann noch die Modellgüte betrachten oder aber noch die Korrelation berechnen. Das können wir dann noch machen. Hier wollen wir dann nochmal den Fall der kategorialen Einflussvariable anschauen.</span>
<span id="cb84-969"><a href="#cb84-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-970"><a href="#cb84-970" aria-hidden="true" tabindex="-1"></a><span class="fu">### Einfaktorielles Modell</span></span>
<span id="cb84-971"><a href="#cb84-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-972"><a href="#cb84-972" aria-hidden="true" tabindex="-1"></a>Hier stoplerst du vielleicht einmal, denn was wir uns hier anschauen ist sehr nah an der einfaktoriellen ANOVA dran. Dort haben wir ja auch einen kontinuierlichen Messwert und einen Faktor. Wir wollen wissen, ob sich die Level des Faktors als Gruppen untereinander in dem mittleren Messwerten unterscheiden oder ob alle Gruppenmittel gleich sind. Ja, da gibt es jetzt gewisse Überschneidungen und vieles ist dann auch gleich. Insbesondere der Fall mit einem Faktor und zwei Leveln ist dann von einem Student t-Test algorithmisch nicht zu unterscheiden. Hier steigen wir also dann einmal in die einfaktoriellen Modelle aus der sich des statistischen Modellierens ein.</span>
<span id="cb84-973"><a href="#cb84-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-974"><a href="#cb84-974" aria-hidden="true" tabindex="-1"></a>Heir unterscheiden wir dann zwei einfaktorielle Modelle. Zuerst schauen wir uns einmal ein einfaktorielles Modell mit einem Faktor und zwei Leveln an. Wir haben eben die Sprungweite der HUnde- und Katzenflöhe vorliegen. Dann betrachten wir noch ein Modell mit mehr als zwei Gruppen. Wir brschränken uns gleich mal auf drei Gruppen indem wir einfach noch die Fuchsflöhe mit in unsere Betrachtung nehmen. Es gehen auch mehr als Gruppen, aber dann wird die Ausgabe nur länger, die Interpretation bleibt gleich.</span>
<span id="cb84-975"><a href="#cb84-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-976"><a href="#cb84-976" aria-hidden="true" tabindex="-1"></a><span class="fu">#### $f_A$ mit 2 Leveln {.unnumbered .unlisted}</span></span>
<span id="cb84-977"><a href="#cb84-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-978"><a href="#cb84-978" aria-hidden="true" tabindex="-1"></a>Unser einfaktorielles Modell mit einem Faktor und zwei Leveln sieht dann wie folgt aus. Wir haben auf der linken Seite unseren kontinuierlichen Messwert $Y$ vorliegen und auf der rechten Seite dann unseren Faktor $f_A$. Der Faktor hat nur zwei Gruppen und deshalb auch nur zwei Level.</span>
<span id="cb84-979"><a href="#cb84-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-982"><a href="#cb84-982" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-983"><a href="#cb84-983" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-984"><a href="#cb84-984" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb84-985"><a href="#cb84-985" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb84-986"><a href="#cb84-986" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb84-987"><a href="#cb84-987" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 2</span></span>
<span id="cb84-988"><a href="#cb84-988" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb84-989"><a href="#cb84-989" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Schemantisches simples Modell mit einem Messwert $Y$ und einer kategorialen Einflussvariablen als Faktor $f_A$ mit zwei Leveln dargestellt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb84-990"><a href="#cb84-990" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-in-R-15</span></span>
<span id="cb84-991"><a href="#cb84-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-992"><a href="#cb84-992" aria-hidden="true" tabindex="-1"></a>p_1fac_2lvl_model</span>
<span id="cb84-993"><a href="#cb84-993" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-994"><a href="#cb84-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-995"><a href="#cb84-995" aria-hidden="true" tabindex="-1"></a><span class="fu">#### $f_A$ mit \&gt;2 Leveln {.unnumbered .unlisted}</span></span>
<span id="cb84-996"><a href="#cb84-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-997"><a href="#cb84-997" aria-hidden="true" tabindex="-1"></a>Unser einfaktorielles Modell mit einem Faktor und drei Leveln sieht dann fast gleich aus. Wir haben auf der linken Seite unseren kontinuierlichen Messwert $Y$ vorliegen und auf der rechten Seite dann unseren Faktor $f_A$. Der Faktor hat jetzt aber drei Gruppen und deshalb auch nur drei Level.</span>
<span id="cb84-998"><a href="#cb84-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1001"><a href="#cb84-1001" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1002"><a href="#cb84-1002" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-1003"><a href="#cb84-1003" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb84-1004"><a href="#cb84-1004" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb84-1005"><a href="#cb84-1005" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb84-1006"><a href="#cb84-1006" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 2</span></span>
<span id="cb84-1007"><a href="#cb84-1007" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb84-1008"><a href="#cb84-1008" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Schemantisches simples Modell mit einem Messwert $Y$ und einer kategorialen Einflussvariablen als Faktor $f_A$ mit drei Leveln dargestellt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb84-1009"><a href="#cb84-1009" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-in-R-11</span></span>
<span id="cb84-1010"><a href="#cb84-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1011"><a href="#cb84-1011" aria-hidden="true" tabindex="-1"></a>p_1fac_3lvl_model</span>
<span id="cb84-1012"><a href="#cb84-1012" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1013"><a href="#cb84-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1014"><a href="#cb84-1014" aria-hidden="true" tabindex="-1"></a>Jetzt können wir uns die Auswertung einmal praktisch in R anschauen. Dafür nutze ich dann einmal den einfaktoriellen Datensatz nur mit den Hunde- und Katzenflöhen für den Fall eines Faktors mit zwei Leveln. Dann erweitere ich noch die Tierart um die Fuchsflöhe um dann drei Level vorliegen zu haben. Dann habe ich noch in dem anderen Tab mir die Sachlage theoretisch in R angeschaut, da es mich nochmal interessiert hat, wie die Berechnung intern laufen.</span>
<span id="cb84-1015"><a href="#cb84-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1016"><a href="#cb84-1016" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb84-1017"><a href="#cb84-1017" aria-hidden="true" tabindex="-1"></a><span class="fu">## Praktisch in R</span></span>
<span id="cb84-1018"><a href="#cb84-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1019"><a href="#cb84-1019" aria-hidden="true" tabindex="-1"></a>Dann wollen wir einmal das einfaktorielle Modell auf unseren Daten zu den Sprungweiten der Floharten rechnen. Wir bauen uns dann einmal einen Datensatz nur mit den Hunde- und Katzenflöhen. Dann haben wir zwei Gruppen oder zwei Level vorliegen. Im Prinzip ist das der Student t-Test Fall und so ist dann auch das Ergebnis. Danach betrachten wir dann noch den Fall, dass wir mit den Füchsen drei Tierarten vorliegen haben. Das ist dann der einfaktoriellen ANOVA sehr viel näher. Wir sehen dann auch gleich, dass wir in der Ausgabe der <span class="in">`lm()`</span> Funktion auch schon gleich eine ANOVA gerechnet kriegen.</span>
<span id="cb84-1020"><a href="#cb84-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1021"><a href="#cb84-1021" aria-hidden="true" tabindex="-1"></a><span class="fu">#### $f_A$ mit 2 Leveln {.unnumbered .unlisted}</span></span>
<span id="cb84-1022"><a href="#cb84-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1023"><a href="#cb84-1023" aria-hidden="true" tabindex="-1"></a>In dem folgenden Schritt entferne ich einmal die Fuchsflöhe aus den Daten. Wir haben dann nur zwei Gruppen, die Hunde- und Katzenflöhe, vorliegen. Die Sprungweite ist dann unser kontinuierlicher Messwert und die Tierart dann der Faktor.</span>
<span id="cb84-1024"><a href="#cb84-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1027"><a href="#cb84-1027" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1028"><a href="#cb84-1028" aria-hidden="true" tabindex="-1"></a>fac1_2lvl_tbl <span class="ot">&lt;-</span> fac1_tbl <span class="sc">|&gt;</span> </span>
<span id="cb84-1029"><a href="#cb84-1029" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(animal <span class="sc">!=</span> <span class="st">"fox"</span>)</span>
<span id="cb84-1030"><a href="#cb84-1030" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1031"><a href="#cb84-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1032"><a href="#cb84-1032" aria-hidden="true" tabindex="-1"></a>Dann können wir uns schon unser einfaktorielles Modell mit einem Faktor mit zwei Leveln bauen. Wir müssen hier auch nichts angeben. Ich mache das hier nur um dann gleich nochmal zu unterscheiden, wenn wir mehre Level im Faktor haben.</span>
<span id="cb84-1033"><a href="#cb84-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1036"><a href="#cb84-1036" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1037"><a href="#cb84-1037" aria-hidden="true" tabindex="-1"></a>fac1_2lvl_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_2lvl_tbl) </span>
<span id="cb84-1038"><a href="#cb84-1038" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1039"><a href="#cb84-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1040"><a href="#cb84-1040" aria-hidden="true" tabindex="-1"></a>Jetzt kommt eigentlich der spannende Teil. Was sind die Koeffizienten unseres einfaktoriellen Modells? Wir erhalten einen Intercept wiedergeben sowie die Steigung von der Tierart der Katzenflöhe. Das ist auf den ersten Blick seltsam. Aber denk daran, dass in R die Level intern als Nummern codiert sind. Die Hunde haben daher das Level 1 und die Katzen das Level 2. Sehr vereinfacht ausgedrückt, können wir sagen, wenn wir also von Hunden zu Katzen wechseln ist das nichts anderes als die Einheit der Einflussvariable um Eins zu erhöhen. Soweit als simple Erklärung. Mehr dazu udn auch richtiger in dem nächste Tab zur Theorie in R.</span>
<span id="cb84-1041"><a href="#cb84-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1044"><a href="#cb84-1044" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1045"><a href="#cb84-1045" aria-hidden="true" tabindex="-1"></a>fac1_2lvl_fit <span class="sc">|&gt;</span> </span>
<span id="cb84-1046"><a href="#cb84-1046" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb84-1047"><a href="#cb84-1047" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1048"><a href="#cb84-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1049"><a href="#cb84-1049" aria-hidden="true" tabindex="-1"></a>Und was sind jetzt die beiden Zahlen genau? Die $8.13cm$ sind der Mittelwert der Sprungweiten der Hundeflöhe. Du siehst hier den Zusammenhang nochmal in der folgenden Abbildung visualsiert. Wie du siehst liegen die Hundeflöhe auf der y-Achse und der Mittelwert der Sprungweiten der Hundeflöhe entspricht dem Intercept. Der Koeffizient <span class="in">`animalcat`</span> ist nichts anders als die Mittelwertsdifferenz der Hunde- und Katzenflöhe. Rechne gerne einmal nach oder schaue genau in den Abbildung.</span>
<span id="cb84-1050"><a href="#cb84-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1053"><a href="#cb84-1053" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1054"><a href="#cb84-1054" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-1055"><a href="#cb84-1055" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb84-1056"><a href="#cb84-1056" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb84-1057"><a href="#cb84-1057" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb84-1058"><a href="#cb84-1058" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb84-1059"><a href="#cb84-1059" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb84-1060"><a href="#cb84-1060" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Scatterplot der Sprungweiten der Hunde- und Katzenflöhe. Der Intercept des einfaktoriellen Modells liegt auf dem Mittelwert der Hundeflöhe. Der Koeffizient der Steigung ist die Differenz des Mittelwerts der Katzen- und Hundeflöhe. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb84-1061"><a href="#cb84-1061" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-in-R-fa-1</span></span>
<span id="cb84-1062"><a href="#cb84-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1063"><a href="#cb84-1063" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fac1_2lvl_tbl, <span class="fu">aes</span>(animal, jump_length)) <span class="sc">+</span></span>
<span id="cb84-1064"><a href="#cb84-1064" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb84-1065"><a href="#cb84-1065" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb84-1066"><a href="#cb84-1066" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb84-1067"><a href="#cb84-1067" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">8.13</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span></span>
<span id="cb84-1068"><a href="#cb84-1068" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb84-1069"><a href="#cb84-1069" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"label"</span>, </span>
<span id="cb84-1070"><a href="#cb84-1070" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(..y.., <span class="dv">2</span>)), <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fl">0.12</span>)) <span class="sc">+</span></span>
<span id="cb84-1071"><a href="#cb84-1071" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Hund"</span>, <span class="st">"Katze"</span>)) <span class="sc">+</span></span>
<span id="cb84-1072"><a href="#cb84-1072" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Einfaktorielles Modell mit zwei Leveln"</span>,</span>
<span id="cb84-1073"><a href="#cb84-1073" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Intercept ist der Mittelwert der Sprungweiten der Hundeflöhe"</span>,</span>
<span id="cb84-1074"><a href="#cb84-1074" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Tierart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>)</span>
<span id="cb84-1075"><a href="#cb84-1075" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1076"><a href="#cb84-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1077"><a href="#cb84-1077" aria-hidden="true" tabindex="-1"></a>Dann schauen wir einmal genauer in die Ausgabe der Funktion <span class="in">`summary()`</span> unseres einfaktoriellen Modells. Auch hier erhalten wir wieder eine Menge Informationen sowie statistischen Tests, dir wir hier dann so wie einen Student t-Test interpretieren können.</span>
<span id="cb84-1078"><a href="#cb84-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1081"><a href="#cb84-1081" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1082"><a href="#cb84-1082" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb84-1083"><a href="#cb84-1083" aria-hidden="true" tabindex="-1"></a>fac1_2lvl_fit <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb84-1084"><a href="#cb84-1084" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1085"><a href="#cb84-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1086"><a href="#cb84-1086" aria-hidden="true" tabindex="-1"></a>Wir erhalten dann folgende Ausgabe mit den entsprechenden Kurzerkläruungen von mir. Keine Angst, die gehen wir dann alle in den nächsten Paragraphen einmal durch.</span>
<span id="cb84-1087"><a href="#cb84-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1090"><a href="#cb84-1090" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1091"><a href="#cb84-1091" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-1092"><a href="#cb84-1092" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb84-1093"><a href="#cb84-1093" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb84-1094"><a href="#cb84-1094" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb84-1095"><a href="#cb84-1095" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4.5</span></span>
<span id="cb84-1096"><a href="#cb84-1096" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb84-1097"><a href="#cb84-1097" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Annotierte Ausgabe der Funktion `summary()` aus einer linearen Modellanpassung mit der Funktion `lm()`. Die Ausgabe der Funktion teilt sich grob in drei informative Bereiche: Informationen zu den Residuen, Informationen zu den Koeffizienten undS Informationen zu der Modelgüte. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb84-1098"><a href="#cb84-1098" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-in-R-f1-2lvl-summary</span></span>
<span id="cb84-1099"><a href="#cb84-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1100"><a href="#cb84-1100" aria-hidden="true" tabindex="-1"></a>p_lm_summary_fac1_explained </span>
<span id="cb84-1101"><a href="#cb84-1101" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1102"><a href="#cb84-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1103"><a href="#cb84-1103" aria-hidden="true" tabindex="-1"></a>Wir erhalten auch hier die Informationen zu den Residuen. Wir wollen hier einen Median von Null und gleiche absolute Werte für das 1st und 3rd Quartile haben. Ebenso sollte der minimale und maximale Wert vom Betrag her ähnlich sein. Wenn das vorliegt, dann können wir von normalverteilten Residuen ausgehen und das Modell sollte von der Seite aus stimmen.</span>
<span id="cb84-1104"><a href="#cb84-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1105"><a href="#cb84-1105" aria-hidden="true" tabindex="-1"></a>Wenn wir die Koeffizienten betrachten, dann können wir zum einen die Frage beantworten, ob der Mittelwert der Sprungweiten der Hundeflöhe sich signifikant von Null unterscheidet. Meistens interessiert und das nicht so sehr. Dann kommt die Steigung, also die Differenz des Mittelwerts der Hundeflöhe zu dem Mittelwert der Katzenflöhe. Hier springen also die Katzenflöhe $-3.386cm$ weniger weit als die Hundeflöhe. Hier testen wir dann, ob sich die Differenz signifikant von Null unterscheidet. Das ist dann aber nichts anderes als der Student t-Test, der uns auch die gleichen Zahlen liefert.</span>
<span id="cb84-1106"><a href="#cb84-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1109"><a href="#cb84-1109" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1110"><a href="#cb84-1110" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_2lvl_tbl, <span class="at">var.equal =</span> <span class="cn">TRUE</span>) </span>
<span id="cb84-1111"><a href="#cb84-1111" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1112"><a href="#cb84-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1113"><a href="#cb84-1113" aria-hidden="true" tabindex="-1"></a>Dann betrachten wir nochmal den Standardfehler der Residuen (abk. *RSE*, eng. *residual standard error*) sowie das Bestimmtheitsmaß $R^2$. Standardfehler der Residuen sollte klein sein und kann hier mit $\pm2cm$ als gering angesehen werden. Wir können den Fehler ja direkt auf der Einheit der Sprungweiten interpretieren. Das Bestimmtheitsmaß ist nicht so super, wir sind hier weit von der Eins entfernt, dass heißt das die einzelnen Beobachtungen dann doch um die lokalen Mittelwerte entprechend streuen. Die Tierart ist dann doch nicht die einzige Ursache für die Sprungweitenunterschiede. Hier mag dann das Geschlecht oder das Gewicht als weitere Einflussvariablen noch eine Rolle spielen.</span>
<span id="cb84-1114"><a href="#cb84-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1115"><a href="#cb84-1115" aria-hidden="true" tabindex="-1"></a>Am Ende dann noch die einfaktorielle ANOVA, die wir ja auch in der Ausgabe dann noch berechnet kriegen. Da hat man dann schon mehr als man eigentlich braucht zusammen.</span>
<span id="cb84-1116"><a href="#cb84-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1119"><a href="#cb84-1119" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1120"><a href="#cb84-1120" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_2lvl_tbl) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb84-1121"><a href="#cb84-1121" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1122"><a href="#cb84-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1123"><a href="#cb84-1123" aria-hidden="true" tabindex="-1"></a>Die Nutzung eines linearen Modells mit einem Fakotr mit nur zwei Leveln mag jetzt ertsmal übertrieben scheinen, aber wir können hier einmal nachvollziehen, wie die Koeffizienten zu interpretieren sind.</span>
<span id="cb84-1124"><a href="#cb84-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1125"><a href="#cb84-1125" aria-hidden="true" tabindex="-1"></a><span class="fu">#### $f_A$ mit \&gt;2 Leveln {.unnumbered .unlisted}</span></span>
<span id="cb84-1126"><a href="#cb84-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1127"><a href="#cb84-1127" aria-hidden="true" tabindex="-1"></a>So und jetzt wird es eigentlich erst interessant. Wir wollen das faktorielle Modell einmal mit drei Leveln rechnen. Damit haben wir dann ja nicht mehr zwei Gruppen vorliegen sondern mit den zusätzlichen Fuchsflöhen drei Gruppen. Jetzt ändert sich erstmal nichts an dem Modell, wir haben hier den gleichen Aufruf. Wir nutzen jetzt eben den vollen Datensatz mit allen drei Tierarten.</span>
<span id="cb84-1128"><a href="#cb84-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1131"><a href="#cb84-1131" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1132"><a href="#cb84-1132" aria-hidden="true" tabindex="-1"></a>fac1_3lvl_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) </span>
<span id="cb84-1133"><a href="#cb84-1133" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1134"><a href="#cb84-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1135"><a href="#cb84-1135" aria-hidden="true" tabindex="-1"></a>Die Koeffizienten können wir uns dann auch gleich wiedergeben lassen. Hier sehen wir dann auch das gleiche Bild wie eben schon. Wir haben anscheinend den Intercept auf dem Mittelwert der Sprungweiten der Hundeflöhe liegen.</span>
<span id="cb84-1136"><a href="#cb84-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1139"><a href="#cb84-1139" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1140"><a href="#cb84-1140" aria-hidden="true" tabindex="-1"></a>fac1_3lvl_fit <span class="sc">|&gt;</span> </span>
<span id="cb84-1141"><a href="#cb84-1141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb84-1142"><a href="#cb84-1142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1143"><a href="#cb84-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1144"><a href="#cb84-1144" aria-hidden="true" tabindex="-1"></a>Auch hier hilft dann einmal die folgende Visualisierung. Wir haben den Intercept auf dem Mittelwert der Sprungweiten der Hundeflöhe liegen. Die Hundeflöhe springen im Mittel eben $8.13cm$ weit. Die anderen Koeffizienten sind die Änderung im Mittelwert in Bezug zu den Hundeflöhen. Wir haben hier also dann eben wieder eine Steigung aber immer in Referenz zu dem Intercept. Du kannst di Differenzen auch gut in der Abbildung nachvollziehen.</span>
<span id="cb84-1145"><a href="#cb84-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1148"><a href="#cb84-1148" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1149"><a href="#cb84-1149" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-1150"><a href="#cb84-1150" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb84-1151"><a href="#cb84-1151" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb84-1152"><a href="#cb84-1152" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb84-1153"><a href="#cb84-1153" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb84-1154"><a href="#cb84-1154" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb84-1155"><a href="#cb84-1155" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Scatterplot der Sprungweiten der Hunde-,  Katzen- und Fuchsflöhe. Der Intercept des einfaktoriellen Modells liegt auf dem Mittelwert der Hundeflöhe. Der Koeffizient der Steigung ist die Differenz des Mittelwerts der Katzen- und Hundeflöhe sowie die Differenz des Mittelwerts der Fuchs- und Hundeflöhe. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb84-1156"><a href="#cb84-1156" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-in-R-fa-21</span></span>
<span id="cb84-1157"><a href="#cb84-1157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1158"><a href="#cb84-1158" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fac1_tbl, <span class="fu">aes</span>(animal, jump_length)) <span class="sc">+</span></span>
<span id="cb84-1159"><a href="#cb84-1159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb84-1160"><a href="#cb84-1160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb84-1161"><a href="#cb84-1161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb84-1162"><a href="#cb84-1162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">8.13</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span></span>
<span id="cb84-1163"><a href="#cb84-1163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb84-1164"><a href="#cb84-1164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"label"</span>, </span>
<span id="cb84-1165"><a href="#cb84-1165" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(..y.., <span class="dv">2</span>)), <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fl">0.17</span>)) <span class="sc">+</span></span>
<span id="cb84-1166"><a href="#cb84-1166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Hund"</span>, <span class="st">"Katze"</span>, <span class="st">"Fuchs"</span>)) <span class="sc">+</span></span>
<span id="cb84-1167"><a href="#cb84-1167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Einfaktorielles Modell mit drei Leveln"</span>,</span>
<span id="cb84-1168"><a href="#cb84-1168" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Intercept ist der Mittelwert der Sprungweiten der Hundeflöhe"</span>,</span>
<span id="cb84-1169"><a href="#cb84-1169" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Tierart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>)</span>
<span id="cb84-1170"><a href="#cb84-1170" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1171"><a href="#cb84-1171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1172"><a href="#cb84-1172" aria-hidden="true" tabindex="-1"></a>Dann schauen wir einmal genauer in die Ausgabe der Funktion <span class="in">`summary()`</span> unseres einfaktoriellen Modells. Auch hier erhalten wir wieder eine Menge Informationen sowie statistischen Tests, dir wir hier dann *zeilenweise* so wie einen Student t-Test interpretieren können. Das heißt, dass eben die Differenz der Mittelwerte im Bezug zu den Hundeflöhen gegen die Null testen.</span>
<span id="cb84-1173"><a href="#cb84-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1176"><a href="#cb84-1176" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1177"><a href="#cb84-1177" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb84-1178"><a href="#cb84-1178" aria-hidden="true" tabindex="-1"></a>fac1_3lvl_fit <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb84-1179"><a href="#cb84-1179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1180"><a href="#cb84-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1181"><a href="#cb84-1181" aria-hidden="true" tabindex="-1"></a>Wir erhalten dann folgende Ausgabe mit den entsprechenden Kurzerkläruungen von mir. Keine Angst, die gehen wir dann alle in den nächsten Paragraphen einmal durch.</span>
<span id="cb84-1182"><a href="#cb84-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1185"><a href="#cb84-1185" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1186"><a href="#cb84-1186" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-1187"><a href="#cb84-1187" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb84-1188"><a href="#cb84-1188" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb84-1189"><a href="#cb84-1189" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb84-1190"><a href="#cb84-1190" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4.5</span></span>
<span id="cb84-1191"><a href="#cb84-1191" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb84-1192"><a href="#cb84-1192" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Annotierte Ausgabe der Funktion `summary()` aus einer linearen Modellanpassung mit der Funktion `lm()`. Die Ausgabe der Funktion teilt sich grob in drei informative Bereiche: Informationen zu den Residuen, Informationen zu den Koeffizienten und Informationen zu der Modelgüte. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb84-1193"><a href="#cb84-1193" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-in-R-f1-3lvl-summary</span></span>
<span id="cb84-1194"><a href="#cb84-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1195"><a href="#cb84-1195" aria-hidden="true" tabindex="-1"></a>p_lm_summary_fac1_3lvl_explained</span>
<span id="cb84-1196"><a href="#cb84-1196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1197"><a href="#cb84-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1198"><a href="#cb84-1198" aria-hidden="true" tabindex="-1"></a>Wir erhalten auch hier die Informationen zu den Residuen. Wir wollen hier einen Median von Null und gleiche absolute Werte für das 1st und 3rd Quartile haben. Ebenso sollte der minimale und maximale Wert vom Betrag her ähnlich sein. Wenn das vorliegt, dann können wir von normalverteilten Residuen ausgehen und das Modell sollte von der Seite aus stimmen.</span>
<span id="cb84-1199"><a href="#cb84-1199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1200"><a href="#cb84-1200" aria-hidden="true" tabindex="-1"></a>Wenn wir die Koeffizienten betrachten, dann können wir zum einen die Frage beantworten, ob der Mittelwert der Sprungweiten der Hundeflöhe sich signifikant von Null unterscheidet. Das war das Gleiche wie schon in dem obigen Modell mit zwei Leveln so. Meistens interessiert und das nicht so sehr. Dann kommt die Steigung, also die Differenz des Mittelwerts der Hundeflöhe zu dem Mittelwert der Katzenflöhe. Hier springen also die Katzenflöhe $-3.386cm$ weniger weit als die Hundeflöhe. Hier testen wir dann, ob sich die Differenz signifikant von Null unterscheidet. Danach kommt dann der Test, ob sich die Differenz des Mittelwerts der Hundeflöhe zu dem Mittelwert der Fuchsflöhe signifikant unetrscheidet. Hier springen also die Fuchsflöhe $1.029cm$ weiter als die Hundeflöhe. Wir erhalten keinen Test für die Differenz zwischen den Katzen- und Fuchsflöhen. Hier musst du dann auf die Posthoc-Tests ausweichen.</span>
<span id="cb84-1201"><a href="#cb84-1201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1202"><a href="#cb84-1202" aria-hidden="true" tabindex="-1"></a>Am Ende dann noch die einfaktorielle ANOVA, die wir ja auch in der Ausgabe dann noch berechnet kriegen. Hier kann die ANOVA signifkant sein und die Steigungen dennoch nicht. Das liegt eben daran, dass du nicht alle paarweisen Vergleiche hier im Modell durch die Steigungen testen kannst. Deshalb ist die ANOVA in der Modellausgabe aus dieser Sicht dann doch sinnvoll.</span>
<span id="cb84-1203"><a href="#cb84-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1206"><a href="#cb84-1206" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1207"><a href="#cb84-1207" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb84-1208"><a href="#cb84-1208" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1209"><a href="#cb84-1209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1210"><a href="#cb84-1210" aria-hidden="true" tabindex="-1"></a>Damit sind wir hier mit dieser Orchidee durch. Spannender wird es dann, wenn wir im multiplen linearen Modell verschiedene Kovariaten und Faktoren in einem Modell miteinander verbinden und dann gemeinsam zu interpretieren versuchen. Dazu dann aber mehr in den entsprechenden <span class="co">[</span><span class="ot">Kapiteln zur multiplen linearen Regression</span><span class="co">](#sec-mult-reg-basic)</span> und dem <span class="co">[</span><span class="ot">Modellieren in R</span><span class="co">](#sec-modeling-R)</span>.</span>
<span id="cb84-1211"><a href="#cb84-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1212"><a href="#cb84-1212" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theoretisch in R</span></span>
<span id="cb84-1213"><a href="#cb84-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1214"><a href="#cb84-1214" aria-hidden="true" tabindex="-1"></a>Schön das wir eine etwas wirre Wiedergabe der Koeffizienten in einem faktoriellen Modell haben. Warum das so ist, wird dir klarer, wenn wir uns die Modellierung einmal etwas genauer anschauen. Wir modellieren nämlich nicht direkt die Steigung. Sonst würden wir ja bei den Koeffizienten immer ein vielfaches der Differenz zum Intercept erhalten. Das ist nicht der Fall und warum das so ist, wollen wir mal zerforschen.</span>
<span id="cb84-1215"><a href="#cb84-1215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1216"><a href="#cb84-1216" aria-hidden="true" tabindex="-1"></a><span class="fu">#### $f_A$ mit 2 Leveln {.unnumbered .unlisted}</span></span>
<span id="cb84-1217"><a href="#cb84-1217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1218"><a href="#cb84-1218" aria-hidden="true" tabindex="-1"></a>In einem ersten Schritt wollen wir uns einmal das Modell mit einem Faktor mit 2 Leveln anschauen. Wir bauen uns hier ein Modell mit dem Datensatz der Körperlängen der Schlangen. Daher können wir dann die Variable <span class="in">`region`</span> verwenden. Wir haben ja nur zwei Regionen in denen wir die Schlangen gesammelt haben. Die Funktion <span class="in">`model.matrix()`</span> gibt uns die Modelmatrix wieder.</span>
<span id="cb84-1219"><a href="#cb84-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1222"><a href="#cb84-1222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1223"><a href="#cb84-1223" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(svl <span class="sc">~</span> region, <span class="at">data =</span> snake_tbl) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span>
<span id="cb84-1224"><a href="#cb84-1224" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1225"><a href="#cb84-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1226"><a href="#cb84-1226" aria-hidden="true" tabindex="-1"></a>In der ersten Spalte ist der Intercept angegeben, danach folgt dann die Spalte <span class="in">`regionwest`</span>. In dieser Spalte steht die Dummykodierung für die Variable <span class="in">`region`</span>. Die ersten drei Schlangen kommen nicht aus der Region <span class="in">`nord`</span> und werden deshalb mit einen Wert von 0 versehen. Die nächsten fünf Schlangen kommen aus der Region <span class="in">`nord`</span> und erhalten daher eine 1 in der Spalte. Die Spalte gibt im Prinzip eine ja/nein Antwort auf die Frage in dem Spaltennamen. Also in unserem Fall ist es die Frage: *"Kommt die Schlange aus der Region `nord?`"*.</span>
<span id="cb84-1227"><a href="#cb84-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1228"><a href="#cb84-1228" aria-hidden="true" tabindex="-1"></a>Das sieht hier sehr seltsam aus, ist aber am Ende eine andere Art der Kodierung. Wir sprechen hier auch von der <span class="co">[</span><span class="ot">Dummykodierung</span><span class="co">](https://de.wikipedia.org/wiki/Dummy-Variable)</span> damit wir dann die kategorialen Variablen in einem stattstischen Modell abbilden können. In der multiplen linearen Modellierung ist es dann noch wichtiger.</span>
<span id="cb84-1229"><a href="#cb84-1229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1230"><a href="#cb84-1230" aria-hidden="true" tabindex="-1"></a>Wir können die Modellmatrix auch mathematisch schreiben und die $y$ Spalte für das Outcome <span class="in">`svl`</span> ergänzen. Eben so ergänzen wir die $\beta$-Werte als mögliche Koeffizienten aus der linearen Regression sowie die Residuen als Abweichung von der gefitteten Grade. Wir sehen dann hier einmal die Dummykodierung für zwei Level eines Faktors.</span>
<span id="cb84-1231"><a href="#cb84-1231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1232"><a href="#cb84-1232" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb84-1233"><a href="#cb84-1233" aria-hidden="true" tabindex="-1"></a> \begin{pmatrix}</span>
<span id="cb84-1234"><a href="#cb84-1234" aria-hidden="true" tabindex="-1"></a>  40 <span class="sc">\\</span></span>
<span id="cb84-1235"><a href="#cb84-1235" aria-hidden="true" tabindex="-1"></a>  45 <span class="sc">\\</span></span>
<span id="cb84-1236"><a href="#cb84-1236" aria-hidden="true" tabindex="-1"></a>  39 <span class="sc">\\</span></span>
<span id="cb84-1237"><a href="#cb84-1237" aria-hidden="true" tabindex="-1"></a>  50 <span class="sc">\\</span></span>
<span id="cb84-1238"><a href="#cb84-1238" aria-hidden="true" tabindex="-1"></a>  52 <span class="sc">\\</span></span>
<span id="cb84-1239"><a href="#cb84-1239" aria-hidden="true" tabindex="-1"></a>  57 <span class="sc">\\</span></span>
<span id="cb84-1240"><a href="#cb84-1240" aria-hidden="true" tabindex="-1"></a>  58 <span class="sc">\\</span></span>
<span id="cb84-1241"><a href="#cb84-1241" aria-hidden="true" tabindex="-1"></a>  59 <span class="sc">\\</span></span>
<span id="cb84-1242"><a href="#cb84-1242" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb84-1243"><a href="#cb84-1243" aria-hidden="true" tabindex="-1"></a> =</span>
<span id="cb84-1244"><a href="#cb84-1244" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb84-1245"><a href="#cb84-1245" aria-hidden="true" tabindex="-1"></a>  1 &amp;  0  <span class="sc">\\</span></span>
<span id="cb84-1246"><a href="#cb84-1246" aria-hidden="true" tabindex="-1"></a>  1 &amp;  0 <span class="sc">\\</span></span>
<span id="cb84-1247"><a href="#cb84-1247" aria-hidden="true" tabindex="-1"></a>  1 &amp;  0<span class="sc">\\</span></span>
<span id="cb84-1248"><a href="#cb84-1248" aria-hidden="true" tabindex="-1"></a>  1 &amp;  1<span class="sc">\\</span></span>
<span id="cb84-1249"><a href="#cb84-1249" aria-hidden="true" tabindex="-1"></a>  1 &amp;  1 <span class="sc">\\</span></span>
<span id="cb84-1250"><a href="#cb84-1250" aria-hidden="true" tabindex="-1"></a>  1 &amp;  1 <span class="sc">\\</span></span>
<span id="cb84-1251"><a href="#cb84-1251" aria-hidden="true" tabindex="-1"></a>  1 &amp;  1 <span class="sc">\\</span></span>
<span id="cb84-1252"><a href="#cb84-1252" aria-hidden="true" tabindex="-1"></a>  1 &amp;  1 <span class="sc">\\</span></span>
<span id="cb84-1253"><a href="#cb84-1253" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb84-1254"><a href="#cb84-1254" aria-hidden="true" tabindex="-1"></a> \times</span>
<span id="cb84-1255"><a href="#cb84-1255" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb84-1256"><a href="#cb84-1256" aria-hidden="true" tabindex="-1"></a>  \beta_0 <span class="sc">\\</span></span>
<span id="cb84-1257"><a href="#cb84-1257" aria-hidden="true" tabindex="-1"></a>  \beta^{region}_{nord} <span class="sc">\\</span></span>
<span id="cb84-1258"><a href="#cb84-1258" aria-hidden="true" tabindex="-1"></a> \end{pmatrix} +</span>
<span id="cb84-1259"><a href="#cb84-1259" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb84-1260"><a href="#cb84-1260" aria-hidden="true" tabindex="-1"></a>  \epsilon_1 <span class="sc">\\</span></span>
<span id="cb84-1261"><a href="#cb84-1261" aria-hidden="true" tabindex="-1"></a>  \epsilon_2 <span class="sc">\\</span></span>
<span id="cb84-1262"><a href="#cb84-1262" aria-hidden="true" tabindex="-1"></a>  \epsilon_3 <span class="sc">\\</span></span>
<span id="cb84-1263"><a href="#cb84-1263" aria-hidden="true" tabindex="-1"></a>  \epsilon_4 <span class="sc">\\</span></span>
<span id="cb84-1264"><a href="#cb84-1264" aria-hidden="true" tabindex="-1"></a>  \epsilon_5 <span class="sc">\\</span></span>
<span id="cb84-1265"><a href="#cb84-1265" aria-hidden="true" tabindex="-1"></a>  \epsilon_6 <span class="sc">\\</span></span>
<span id="cb84-1266"><a href="#cb84-1266" aria-hidden="true" tabindex="-1"></a>  \epsilon_7 <span class="sc">\\</span></span>
<span id="cb84-1267"><a href="#cb84-1267" aria-hidden="true" tabindex="-1"></a>  \epsilon_8 <span class="sc">\\</span></span>
<span id="cb84-1268"><a href="#cb84-1268" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb84-1269"><a href="#cb84-1269" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb84-1270"><a href="#cb84-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1271"><a href="#cb84-1271" aria-hidden="true" tabindex="-1"></a>Jetzt brauche wir die Koeffizienten aus dem linearen Modell, welches wir wie folgt fitten. Wir nutzen dann die Funktion <span class="in">`coef()`</span> um uns die Koeffizienten wiedergeben zu lassen.</span>
<span id="cb84-1272"><a href="#cb84-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1275"><a href="#cb84-1275" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1276"><a href="#cb84-1276" aria-hidden="true" tabindex="-1"></a>fit_1fac_2lvl <span class="ot">&lt;-</span> <span class="fu">lm</span>(svl <span class="sc">~</span> region, <span class="at">data =</span> snake_tbl) </span>
<span id="cb84-1277"><a href="#cb84-1277" aria-hidden="true" tabindex="-1"></a>fit_1fac_2lvl <span class="sc">|&gt;</span> <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb84-1278"><a href="#cb84-1278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1279"><a href="#cb84-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1280"><a href="#cb84-1280" aria-hidden="true" tabindex="-1"></a>Die Funktion <span class="in">`residuals()`</span> gibt uns die Residuen der Graden wieder.</span>
<span id="cb84-1281"><a href="#cb84-1281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1284"><a href="#cb84-1284" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1285"><a href="#cb84-1285" aria-hidden="true" tabindex="-1"></a>fit_1fac_2lvl <span class="sc">|&gt;</span> <span class="fu">residuals</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb84-1286"><a href="#cb84-1286" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1287"><a href="#cb84-1287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1288"><a href="#cb84-1288" aria-hidden="true" tabindex="-1"></a>Wir können jetzt die Koeffizienten ergänzen mit $\beta_0 = 41.33$ für den Intercept. Weiter ergänzen wir die Koeffizienten für die Region und das Level <span class="in">`nord`</span> mit $\beta^{region}_{nord} = 12.07$. Ebenfalls setzen wir Werte für die Residuen für jede der Beobachtungen in die Gleichung ein. Hier sehen wir dann wunderbar, warum der Intercept der Mittelwert der Schlangen in der Region `west` sind. Der Unterschied zu den Schlangen in der Region `nord` ist ja der Koeffizient $\beta^{region}_{nord}$. Den Rechnen wir nur ein, wenn wir auch eine Schlange aus der Region <span class="in">`nord`</span> haben.</span>
<span id="cb84-1289"><a href="#cb84-1289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1290"><a href="#cb84-1290" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb84-1291"><a href="#cb84-1291" aria-hidden="true" tabindex="-1"></a> \begin{pmatrix}</span>
<span id="cb84-1292"><a href="#cb84-1292" aria-hidden="true" tabindex="-1"></a>  40 <span class="sc">\\</span></span>
<span id="cb84-1293"><a href="#cb84-1293" aria-hidden="true" tabindex="-1"></a>  45 <span class="sc">\\</span></span>
<span id="cb84-1294"><a href="#cb84-1294" aria-hidden="true" tabindex="-1"></a>  39 <span class="sc">\\</span></span>
<span id="cb84-1295"><a href="#cb84-1295" aria-hidden="true" tabindex="-1"></a>  50 <span class="sc">\\</span></span>
<span id="cb84-1296"><a href="#cb84-1296" aria-hidden="true" tabindex="-1"></a>  52 <span class="sc">\\</span></span>
<span id="cb84-1297"><a href="#cb84-1297" aria-hidden="true" tabindex="-1"></a>  57 <span class="sc">\\</span></span>
<span id="cb84-1298"><a href="#cb84-1298" aria-hidden="true" tabindex="-1"></a>  58 <span class="sc">\\</span></span>
<span id="cb84-1299"><a href="#cb84-1299" aria-hidden="true" tabindex="-1"></a>  59 <span class="sc">\\</span></span>
<span id="cb84-1300"><a href="#cb84-1300" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb84-1301"><a href="#cb84-1301" aria-hidden="true" tabindex="-1"></a> =</span>
<span id="cb84-1302"><a href="#cb84-1302" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb84-1303"><a href="#cb84-1303" aria-hidden="true" tabindex="-1"></a>  41.33 &amp; 0 \cdot 12.07  <span class="sc">\\</span></span>
<span id="cb84-1304"><a href="#cb84-1304" aria-hidden="true" tabindex="-1"></a>  41.33 &amp; 0 \cdot 12.07  <span class="sc">\\</span></span>
<span id="cb84-1305"><a href="#cb84-1305" aria-hidden="true" tabindex="-1"></a>  41.33 &amp; 0 \cdot 12.07  <span class="sc">\\</span></span>
<span id="cb84-1306"><a href="#cb84-1306" aria-hidden="true" tabindex="-1"></a>  41.33 &amp; 1 \cdot 12.07  <span class="sc">\\</span></span>
<span id="cb84-1307"><a href="#cb84-1307" aria-hidden="true" tabindex="-1"></a>  41.33 &amp; 1 \cdot 12.07  <span class="sc">\\</span></span>
<span id="cb84-1308"><a href="#cb84-1308" aria-hidden="true" tabindex="-1"></a>  41.33 &amp; 1 \cdot 12.07  <span class="sc">\\</span></span>
<span id="cb84-1309"><a href="#cb84-1309" aria-hidden="true" tabindex="-1"></a>  41.33 &amp; 1 \cdot 12.07  <span class="sc">\\</span></span>
<span id="cb84-1310"><a href="#cb84-1310" aria-hidden="true" tabindex="-1"></a>  41.33 &amp; 1 \cdot 12.07  <span class="sc">\\</span></span>
<span id="cb84-1311"><a href="#cb84-1311" aria-hidden="true" tabindex="-1"></a> \end{pmatrix} +</span>
<span id="cb84-1312"><a href="#cb84-1312" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb84-1313"><a href="#cb84-1313" aria-hidden="true" tabindex="-1"></a>  -1.33<span class="sc">\\</span></span>
<span id="cb84-1314"><a href="#cb84-1314" aria-hidden="true" tabindex="-1"></a>  +3.67 <span class="sc">\\</span></span>
<span id="cb84-1315"><a href="#cb84-1315" aria-hidden="true" tabindex="-1"></a>  -2.33 <span class="sc">\\</span></span>
<span id="cb84-1316"><a href="#cb84-1316" aria-hidden="true" tabindex="-1"></a>  -2.40 <span class="sc">\\</span></span>
<span id="cb84-1317"><a href="#cb84-1317" aria-hidden="true" tabindex="-1"></a>  -1.40 <span class="sc">\\</span></span>
<span id="cb84-1318"><a href="#cb84-1318" aria-hidden="true" tabindex="-1"></a>  +3.60 <span class="sc">\\</span></span>
<span id="cb84-1319"><a href="#cb84-1319" aria-hidden="true" tabindex="-1"></a>  +4.60 <span class="sc">\\</span></span>
<span id="cb84-1320"><a href="#cb84-1320" aria-hidden="true" tabindex="-1"></a>  -4.40 <span class="sc">\\</span></span>
<span id="cb84-1321"><a href="#cb84-1321" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb84-1322"><a href="#cb84-1322" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb84-1323"><a href="#cb84-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1324"><a href="#cb84-1324" aria-hidden="true" tabindex="-1"></a>Wir können jetzt diese gewaltige Sammlung an Matrixen einmal auflösen. Steht denn nun wirklich rechts das Gleiche wie links von der Gleichung? Wir bauen uns die Zahlen von der rechten Seite der Gleichung einmal in R nach und schauen auf das Ergebnis.</span>
<span id="cb84-1325"><a href="#cb84-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1328"><a href="#cb84-1328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1329"><a href="#cb84-1329" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">-</span> <span class="fl">1.33</span>,</span>
<span id="cb84-1330"><a href="#cb84-1330" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">+</span> <span class="fl">3.67</span>,</span>
<span id="cb84-1331"><a href="#cb84-1331" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">-</span> <span class="fl">2.33</span>,</span>
<span id="cb84-1332"><a href="#cb84-1332" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">-</span> <span class="fl">2.40</span>,</span>
<span id="cb84-1333"><a href="#cb84-1333" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">-</span> <span class="fl">1.40</span>,</span>
<span id="cb84-1334"><a href="#cb84-1334" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">+</span> <span class="fl">3.60</span>,</span>
<span id="cb84-1335"><a href="#cb84-1335" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">+</span> <span class="fl">4.60</span>,</span>
<span id="cb84-1336"><a href="#cb84-1336" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">-</span> <span class="fl">4.40</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>() </span>
<span id="cb84-1337"><a href="#cb84-1337" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1338"><a href="#cb84-1338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1339"><a href="#cb84-1339" aria-hidden="true" tabindex="-1"></a>Wir kriegen am Ende die gleichen Körperlängen der Schlangen wiedergegeben. Das hat also alles so funktioniert wie es sollte. Auch hier sehen wir, dass der Wert des Koeffzienten $\beta^{region}_{nord} = 12.07$ nur im Fall von Schlangen aus der Region <span class="in">`nord`</span> zu tragen kommt. Das sind dann eben auch die letzten fünf Schlangen. Wenn du das Prinzip verstanden hast, dann wird dir die Dummykodierung im folgenden Fall mit mehr Leveln noch klarer.</span>
<span id="cb84-1340"><a href="#cb84-1340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1341"><a href="#cb84-1341" aria-hidden="true" tabindex="-1"></a><span class="fu">#### $f_A$ mit \&gt;2 Leveln {.unnumbered .unlisted}</span></span>
<span id="cb84-1342"><a href="#cb84-1342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1343"><a href="#cb84-1343" aria-hidden="true" tabindex="-1"></a>Im nächsten Schritt wollen wir uns einmal das Modell mit einem Faktor mit drei Leveln anschauen. Prinzipiell geht es auch mit noch mehr Leveln, dann erweitern wir aber die Modellmatrix immer nur um eine weitere Spalte. Wir bauen uns hier nun ein Modell mit der Variable <span class="in">`color`</span>, die ja drei Level hat. Die Funktion <span class="in">`model.matrix()`</span> gibt uns die Modelmatrix wieder. Wir haben ja drei Farben der Schlangenhaut mit schwarz, rot und blauer Haut vorliegen.</span>
<span id="cb84-1344"><a href="#cb84-1344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1347"><a href="#cb84-1347" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1348"><a href="#cb84-1348" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(svl <span class="sc">~</span> color, <span class="at">data =</span> snake_tbl) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span>
<span id="cb84-1349"><a href="#cb84-1349" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1350"><a href="#cb84-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1351"><a href="#cb84-1351" aria-hidden="true" tabindex="-1"></a>In der ersten Spalte ist der Intercept angegeben, danach folgt dann die Spalten für <span class="in">`color`</span>. Die Spalten <span class="in">`colorrot`</span> und <span class="in">`colorblau`</span> geben jeweils an, ob die Schlange das Level <span class="in">`rot`</span> hat oder <span class="in">`blau`</span> oder keins von beiden. Wenn die Schlange weder rot noch blau ist, dann sind beide Spalten mit einer 0 versehen. Dann ist die Schlange schwarz.</span>
<span id="cb84-1352"><a href="#cb84-1352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1353"><a href="#cb84-1353" aria-hidden="true" tabindex="-1"></a>Wir können die Modellmatrix auch mathematisch schreiben und die $y$ Spalte für das Outcome <span class="in">`svl`</span> ergänzen. Eben so ergänzen wir die $\beta$-Werte als mögliche Koeefizienten aus der linearen Regression sowie die Residuen als Abweichung von der gefitteten Grade.</span>
<span id="cb84-1354"><a href="#cb84-1354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1355"><a href="#cb84-1355" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb84-1356"><a href="#cb84-1356" aria-hidden="true" tabindex="-1"></a> \begin{pmatrix}</span>
<span id="cb84-1357"><a href="#cb84-1357" aria-hidden="true" tabindex="-1"></a>  40 <span class="sc">\\</span></span>
<span id="cb84-1358"><a href="#cb84-1358" aria-hidden="true" tabindex="-1"></a>  45 <span class="sc">\\</span></span>
<span id="cb84-1359"><a href="#cb84-1359" aria-hidden="true" tabindex="-1"></a>  39 <span class="sc">\\</span></span>
<span id="cb84-1360"><a href="#cb84-1360" aria-hidden="true" tabindex="-1"></a>  50 <span class="sc">\\</span></span>
<span id="cb84-1361"><a href="#cb84-1361" aria-hidden="true" tabindex="-1"></a>  52 <span class="sc">\\</span></span>
<span id="cb84-1362"><a href="#cb84-1362" aria-hidden="true" tabindex="-1"></a>  57 <span class="sc">\\</span></span>
<span id="cb84-1363"><a href="#cb84-1363" aria-hidden="true" tabindex="-1"></a>  58 <span class="sc">\\</span></span>
<span id="cb84-1364"><a href="#cb84-1364" aria-hidden="true" tabindex="-1"></a>  59 <span class="sc">\\</span></span>
<span id="cb84-1365"><a href="#cb84-1365" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb84-1366"><a href="#cb84-1366" aria-hidden="true" tabindex="-1"></a> =</span>
<span id="cb84-1367"><a href="#cb84-1367" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb84-1368"><a href="#cb84-1368" aria-hidden="true" tabindex="-1"></a>  1 &amp; 0 &amp; 0 <span class="sc">\\</span></span>
<span id="cb84-1369"><a href="#cb84-1369" aria-hidden="true" tabindex="-1"></a>  1 &amp; 0 &amp; 0<span class="sc">\\</span></span>
<span id="cb84-1370"><a href="#cb84-1370" aria-hidden="true" tabindex="-1"></a>  1 &amp; 1 &amp; 0<span class="sc">\\</span></span>
<span id="cb84-1371"><a href="#cb84-1371" aria-hidden="true" tabindex="-1"></a>  1 &amp; 1 &amp; 0<span class="sc">\\</span></span>
<span id="cb84-1372"><a href="#cb84-1372" aria-hidden="true" tabindex="-1"></a>  1 &amp; 1 &amp; 0<span class="sc">\\</span></span>
<span id="cb84-1373"><a href="#cb84-1373" aria-hidden="true" tabindex="-1"></a>  1 &amp; 0 &amp; 1<span class="sc">\\</span></span>
<span id="cb84-1374"><a href="#cb84-1374" aria-hidden="true" tabindex="-1"></a>  1 &amp; 0 &amp; 1<span class="sc">\\</span></span>
<span id="cb84-1375"><a href="#cb84-1375" aria-hidden="true" tabindex="-1"></a>  1 &amp; 0 &amp; 1<span class="sc">\\</span></span>
<span id="cb84-1376"><a href="#cb84-1376" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb84-1377"><a href="#cb84-1377" aria-hidden="true" tabindex="-1"></a> \times</span>
<span id="cb84-1378"><a href="#cb84-1378" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb84-1379"><a href="#cb84-1379" aria-hidden="true" tabindex="-1"></a>  \beta_0 <span class="sc">\\</span></span>
<span id="cb84-1380"><a href="#cb84-1380" aria-hidden="true" tabindex="-1"></a>  \beta^{color}_{rot} <span class="sc">\\</span></span>
<span id="cb84-1381"><a href="#cb84-1381" aria-hidden="true" tabindex="-1"></a>  \beta^{color}_{blau} <span class="sc">\\</span></span>
<span id="cb84-1382"><a href="#cb84-1382" aria-hidden="true" tabindex="-1"></a> \end{pmatrix} +</span>
<span id="cb84-1383"><a href="#cb84-1383" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb84-1384"><a href="#cb84-1384" aria-hidden="true" tabindex="-1"></a>  \epsilon_1 <span class="sc">\\</span></span>
<span id="cb84-1385"><a href="#cb84-1385" aria-hidden="true" tabindex="-1"></a>  \epsilon_2 <span class="sc">\\</span></span>
<span id="cb84-1386"><a href="#cb84-1386" aria-hidden="true" tabindex="-1"></a>  \epsilon_3 <span class="sc">\\</span></span>
<span id="cb84-1387"><a href="#cb84-1387" aria-hidden="true" tabindex="-1"></a>  \epsilon_4 <span class="sc">\\</span></span>
<span id="cb84-1388"><a href="#cb84-1388" aria-hidden="true" tabindex="-1"></a>  \epsilon_5 <span class="sc">\\</span></span>
<span id="cb84-1389"><a href="#cb84-1389" aria-hidden="true" tabindex="-1"></a>  \epsilon_6 <span class="sc">\\</span></span>
<span id="cb84-1390"><a href="#cb84-1390" aria-hidden="true" tabindex="-1"></a>  \epsilon_7 <span class="sc">\\</span></span>
<span id="cb84-1391"><a href="#cb84-1391" aria-hidden="true" tabindex="-1"></a>  \epsilon_8 <span class="sc">\\</span></span>
<span id="cb84-1392"><a href="#cb84-1392" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb84-1393"><a href="#cb84-1393" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb84-1394"><a href="#cb84-1394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1395"><a href="#cb84-1395" aria-hidden="true" tabindex="-1"></a>Jetzt brauche wir die Koeffizienten aus dem linearen Modell, welches wir wie folgt fitten. Wir nutzen dann die Funktion <span class="in">`coef()`</span> um uns die Koeffizienten wiedergeben zu lassen.</span>
<span id="cb84-1396"><a href="#cb84-1396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1399"><a href="#cb84-1399" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1400"><a href="#cb84-1400" aria-hidden="true" tabindex="-1"></a>fit_1fac_2lvl <span class="ot">&lt;-</span> <span class="fu">lm</span>(svl <span class="sc">~</span> color, <span class="at">data =</span> snake_tbl) </span>
<span id="cb84-1401"><a href="#cb84-1401" aria-hidden="true" tabindex="-1"></a>fit_1fac_2lvl <span class="sc">|&gt;</span> <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb84-1402"><a href="#cb84-1402" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1403"><a href="#cb84-1403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1404"><a href="#cb84-1404" aria-hidden="true" tabindex="-1"></a>Die Funktion <span class="in">`residuals()`</span> gibt uns die Residuen der Graden wieder.</span>
<span id="cb84-1405"><a href="#cb84-1405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1408"><a href="#cb84-1408" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1409"><a href="#cb84-1409" aria-hidden="true" tabindex="-1"></a>fit_1fac_2lvl <span class="sc">|&gt;</span> <span class="fu">residuals</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb84-1410"><a href="#cb84-1410" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1411"><a href="#cb84-1411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1412"><a href="#cb84-1412" aria-hidden="true" tabindex="-1"></a>Wir können jetzt die Koeffizienten ergänzen mit $\beta_0 = 25$ für den Intercept. Weiter ergänzen wir die Koeffizienten für die Farbe und das Level <span class="in">`rot`</span> mit $\beta^{color}_{rot} = 4.83$ und für die Farbe und das Level `blau` mit $\beta^{color}_{blau} = 12.17$. Ebenfalls setzen wir Werte für die Residuen für jede der Beobachtungen in die Gleichung ein. Auch hier sehen wir dann sehr gut, dass der Intercept der Mittelwert der schwarzen Schlangen sein muss. Die Änderung der Körperlängen der roten und blauen Schlangen zu den schwarzen Schlangen geben dann die Koeffizienten wieder.</span>
<span id="cb84-1413"><a href="#cb84-1413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1414"><a href="#cb84-1414" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb84-1415"><a href="#cb84-1415" aria-hidden="true" tabindex="-1"></a> \begin{pmatrix}</span>
<span id="cb84-1416"><a href="#cb84-1416" aria-hidden="true" tabindex="-1"></a>  40 <span class="sc">\\</span></span>
<span id="cb84-1417"><a href="#cb84-1417" aria-hidden="true" tabindex="-1"></a>  45 <span class="sc">\\</span></span>
<span id="cb84-1418"><a href="#cb84-1418" aria-hidden="true" tabindex="-1"></a>  39 <span class="sc">\\</span></span>
<span id="cb84-1419"><a href="#cb84-1419" aria-hidden="true" tabindex="-1"></a>  50 <span class="sc">\\</span></span>
<span id="cb84-1420"><a href="#cb84-1420" aria-hidden="true" tabindex="-1"></a>  52 <span class="sc">\\</span></span>
<span id="cb84-1421"><a href="#cb84-1421" aria-hidden="true" tabindex="-1"></a>  57 <span class="sc">\\</span></span>
<span id="cb84-1422"><a href="#cb84-1422" aria-hidden="true" tabindex="-1"></a>  58 <span class="sc">\\</span></span>
<span id="cb84-1423"><a href="#cb84-1423" aria-hidden="true" tabindex="-1"></a>  59 <span class="sc">\\</span></span>
<span id="cb84-1424"><a href="#cb84-1424" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb84-1425"><a href="#cb84-1425" aria-hidden="true" tabindex="-1"></a> =</span>
<span id="cb84-1426"><a href="#cb84-1426" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb84-1427"><a href="#cb84-1427" aria-hidden="true" tabindex="-1"></a>  42.50 &amp; 0 \cdot 4.83&amp; 0 \cdot 12.17 <span class="sc">\\</span></span>
<span id="cb84-1428"><a href="#cb84-1428" aria-hidden="true" tabindex="-1"></a>  42.50 &amp; 0 \cdot 4.83&amp; 0 \cdot 12.17<span class="sc">\\</span></span>
<span id="cb84-1429"><a href="#cb84-1429" aria-hidden="true" tabindex="-1"></a>  42.50 &amp; 1 \cdot 4.83&amp; 0 \cdot 12.17<span class="sc">\\</span></span>
<span id="cb84-1430"><a href="#cb84-1430" aria-hidden="true" tabindex="-1"></a>  42.50 &amp; 1 \cdot 4.83&amp; 0 \cdot 12.17<span class="sc">\\</span></span>
<span id="cb84-1431"><a href="#cb84-1431" aria-hidden="true" tabindex="-1"></a>  42.50 &amp; 1 \cdot 4.83&amp; 0 \cdot 12.17<span class="sc">\\</span></span>
<span id="cb84-1432"><a href="#cb84-1432" aria-hidden="true" tabindex="-1"></a>  42.50 &amp; 0 \cdot 4.83&amp; 1 \cdot 12.17<span class="sc">\\</span></span>
<span id="cb84-1433"><a href="#cb84-1433" aria-hidden="true" tabindex="-1"></a>  42.50 &amp; 0 \cdot 4.83&amp; 1 \cdot 12.17<span class="sc">\\</span></span>
<span id="cb84-1434"><a href="#cb84-1434" aria-hidden="true" tabindex="-1"></a>  42.50 &amp; 0 \cdot 4.83&amp; 1 \cdot 12.17<span class="sc">\\</span></span>
<span id="cb84-1435"><a href="#cb84-1435" aria-hidden="true" tabindex="-1"></a> \end{pmatrix} +</span>
<span id="cb84-1436"><a href="#cb84-1436" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb84-1437"><a href="#cb84-1437" aria-hidden="true" tabindex="-1"></a>  -2.50 <span class="sc">\\</span></span>
<span id="cb84-1438"><a href="#cb84-1438" aria-hidden="true" tabindex="-1"></a>  +2.50 <span class="sc">\\</span></span>
<span id="cb84-1439"><a href="#cb84-1439" aria-hidden="true" tabindex="-1"></a>  -8.33 <span class="sc">\\</span></span>
<span id="cb84-1440"><a href="#cb84-1440" aria-hidden="true" tabindex="-1"></a>  +3.67 <span class="sc">\\</span></span>
<span id="cb84-1441"><a href="#cb84-1441" aria-hidden="true" tabindex="-1"></a>  +4.67 <span class="sc">\\</span></span>
<span id="cb84-1442"><a href="#cb84-1442" aria-hidden="true" tabindex="-1"></a>  +2.33 <span class="sc">\\</span></span>
<span id="cb84-1443"><a href="#cb84-1443" aria-hidden="true" tabindex="-1"></a>  +3.33 <span class="sc">\\</span></span>
<span id="cb84-1444"><a href="#cb84-1444" aria-hidden="true" tabindex="-1"></a>  -5.67 <span class="sc">\\</span></span>
<span id="cb84-1445"><a href="#cb84-1445" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb84-1446"><a href="#cb84-1446" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb84-1447"><a href="#cb84-1447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1448"><a href="#cb84-1448" aria-hidden="true" tabindex="-1"></a>Wir können jetzt diese gewaltige Sammlung an Matrixen einmal auflösen. Steht denn nun wirklich rechts das Gleiche wie links von der Gleichung? Wir bauen uns die Zahlen von der rechten Seite der Gleichung einmal in R nach und schauen auf das Ergebnis.</span>
<span id="cb84-1449"><a href="#cb84-1449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1452"><a href="#cb84-1452" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1453"><a href="#cb84-1453" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">-</span> <span class="fl">2.50</span>,</span>
<span id="cb84-1454"><a href="#cb84-1454" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">+</span> <span class="fl">2.50</span>,</span>
<span id="cb84-1455"><a href="#cb84-1455" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">-</span> <span class="fl">8.33</span>,</span>
<span id="cb84-1456"><a href="#cb84-1456" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">+</span> <span class="fl">3.67</span>,</span>
<span id="cb84-1457"><a href="#cb84-1457" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">+</span> <span class="fl">4.67</span>,</span>
<span id="cb84-1458"><a href="#cb84-1458" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">+</span> <span class="fl">2.33</span>,</span>
<span id="cb84-1459"><a href="#cb84-1459" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">+</span> <span class="fl">3.33</span>,</span>
<span id="cb84-1460"><a href="#cb84-1460" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">-</span> <span class="fl">5.67</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>()</span>
<span id="cb84-1461"><a href="#cb84-1461" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1462"><a href="#cb84-1462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1463"><a href="#cb84-1463" aria-hidden="true" tabindex="-1"></a>Wir kriegen auch hier am Ende die gleichen Körperlängen der Schlangen wiedergegeben. Das hat also alles so funktioniert wie es sollte. Je nachdem welche Farbe unsere Schlange hat, nutzen wir eben einen anderen Koeffizienten. Die Koeffizienten, die wir nicht brauchen, multiplizieren wir mit Null und daher kommen diese Koeffizienten auch nicht mit in die Berechnung der Schlangenkörperlänge.</span>
<span id="cb84-1464"><a href="#cb84-1464" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb84-1465"><a href="#cb84-1465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1466"><a href="#cb84-1466" aria-hidden="true" tabindex="-1"></a>Damit sind wir mit dem einkovariaten und einfaktoriellen Modell durch. Wir haben jetzt verstanden, wie wir die Koeffizienten der beiden verschiedenen Modelle kausal erklären und verwenden können. In den einfaktoriellen Modell wollen wir dann meistens nicht nur die Änderung zu der Gruppe im Intercept berechnen. Daher ist das einfaktorielle Modell eher der Vorschritt für die ANOVA oder aber den Post-hoc Test. Wir wollen jetzt nochmal in die Prädiktion schauen und verstehen, wie wir dann neue Werte für unseren Messwert für bekannte oder unbekannte Werte der Einflussvariable berechnen können.</span>
<span id="cb84-1467"><a href="#cb84-1467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1468"><a href="#cb84-1468" aria-hidden="true" tabindex="-1"></a><span class="fu">## Prädiktives Modell</span></span>
<span id="cb84-1469"><a href="#cb84-1469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1470"><a href="#cb84-1470" aria-hidden="true" tabindex="-1"></a><span class="fu">### Einkovariates Modell</span></span>
<span id="cb84-1471"><a href="#cb84-1471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1474"><a href="#cb84-1474" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1475"><a href="#cb84-1475" aria-hidden="true" tabindex="-1"></a>cov1_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> weight, <span class="at">data =</span> cov1_tbl)</span>
<span id="cb84-1476"><a href="#cb84-1476" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1477"><a href="#cb84-1477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1480"><a href="#cb84-1480" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1481"><a href="#cb84-1481" aria-hidden="true" tabindex="-1"></a>cov1_new_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">weight =</span> <span class="fu">c</span>(<span class="fl">1.7</span>, <span class="fl">1.4</span>, <span class="fl">2.1</span>, <span class="fl">3.0</span>))</span>
<span id="cb84-1482"><a href="#cb84-1482" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1483"><a href="#cb84-1483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1484"><a href="#cb84-1484" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb84-1485"><a href="#cb84-1485" aria-hidden="true" tabindex="-1"></a><span class="fu">## Neue x-Werte</span></span>
<span id="cb84-1486"><a href="#cb84-1486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1489"><a href="#cb84-1489" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1490"><a href="#cb84-1490" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(cov1_fit, <span class="at">newdata =</span> cov1_new_tbl) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb84-1491"><a href="#cb84-1491" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1492"><a href="#cb84-1492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1493"><a href="#cb84-1493" aria-hidden="true" tabindex="-1"></a><span class="fu">## Alte x-Werte</span></span>
<span id="cb84-1494"><a href="#cb84-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1497"><a href="#cb84-1497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1498"><a href="#cb84-1498" aria-hidden="true" tabindex="-1"></a>cov1_fit <span class="sc">|&gt;</span> <span class="fu">augment</span>() <span class="sc">|&gt;</span> </span>
<span id="cb84-1499"><a href="#cb84-1499" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(jump_length, weight, .fitted, .resid)</span>
<span id="cb84-1500"><a href="#cb84-1500" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1501"><a href="#cb84-1501" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb84-1502"><a href="#cb84-1502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1505"><a href="#cb84-1505" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1506"><a href="#cb84-1506" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb84-1507"><a href="#cb84-1507" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb84-1508"><a href="#cb84-1508" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-scatter-lin-pred</span></span>
<span id="cb84-1509"><a href="#cb84-1509" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb84-1510"><a href="#cb84-1510" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.5</span></span>
<span id="cb84-1511"><a href="#cb84-1511" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb84-1512"><a href="#cb84-1512" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Scatterplot der *alten* Beobachtungen der Sprungweite in \\[cm\\] und dem Gewicht in \\[mg\\]. Sowie der *neuen* vorhergesagten Beobachtungen auf der Graden."</span></span>
<span id="cb84-1513"><a href="#cb84-1513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1514"><a href="#cb84-1514" aria-hidden="true" tabindex="-1"></a>pred_tbl <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(<span class="fu">mutate</span>(cov1_tbl, <span class="at">status =</span> <span class="st">"beobachtet"</span>),</span>
<span id="cb84-1515"><a href="#cb84-1515" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">tibble</span>(<span class="at">weight =</span> <span class="fu">c</span>(<span class="fl">1.7</span>, <span class="fl">1.4</span>, <span class="fl">2.1</span>, <span class="fl">3.0</span>),</span>
<span id="cb84-1516"><a href="#cb84-1516" aria-hidden="true" tabindex="-1"></a>                             <span class="at">jump_length =</span> <span class="fu">predict</span>(fit_1, <span class="at">newdata =</span> <span class="fu">tibble</span>(weight)),</span>
<span id="cb84-1517"><a href="#cb84-1517" aria-hidden="true" tabindex="-1"></a>                             <span class="at">status =</span> <span class="st">"vorhergesagt"</span>))</span>
<span id="cb84-1518"><a href="#cb84-1518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1519"><a href="#cb84-1519" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred_tbl, <span class="fu">aes</span>(weight, jump_length, <span class="at">color =</span> status, <span class="at">shape =</span> status)) <span class="sc">+</span></span>
<span id="cb84-1520"><a href="#cb84-1520" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">fullrange =</span> <span class="cn">TRUE</span>, </span>
<span id="cb84-1521"><a href="#cb84-1521" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"#56B4E9"</span>, <span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb84-1522"><a href="#cb84-1522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">""</span>, <span class="at">shape =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb84-1523"><a href="#cb84-1523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb84-1524"><a href="#cb84-1524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb84-1525"><a href="#cb84-1525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb84-1526"><a href="#cb84-1526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fl">3.5</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fl">3.5</span>)</span>
<span id="cb84-1527"><a href="#cb84-1527" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1528"><a href="#cb84-1528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1529"><a href="#cb84-1529" aria-hidden="true" tabindex="-1"></a><span class="fu">### Einfaktorielles Modell</span></span>
<span id="cb84-1530"><a href="#cb84-1530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1531"><a href="#cb84-1531" aria-hidden="true" tabindex="-1"></a>Neben dem kausalen Modell gibt es auch die Möglichkeit ein prädiktives Modell zu rechnen. Im Prinzip ist die Sprache hier etwas ungenau. Wir verwenden das gefittete Modell nur anders. Anstatt das Modell <span class="in">`fit_1`</span> in die Funktion <span class="in">`summary()`</span> zu pipen, pipen wir die das Modell in die Funktion <span class="in">`predict()`</span>. Die Funktion <span class="in">`predict()`</span> kann dann für neue Daten über die Option <span class="in">`newdata =`</span> das $y$ vorhersagen.</span>
<span id="cb84-1532"><a href="#cb84-1532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1533"><a href="#cb84-1533" aria-hidden="true" tabindex="-1"></a>In unserem Fall müssen wir uns deshalb ein <span class="in">`tibble`</span> mit einer Spalte bauen. Wir haben ja oben im Modell auch nur ein $x_1$ mit aufgenommen. Später können wir natürlich auch für multiple Modelle die Vorhersage machen. Wichtig ist, dass die Namen gleich sind. Das heißt in dem neuen Datensatz müssen die Spalten *exakt* so heißen wir in dem alten Datensatz in dem das Modell gefittet wurde.</span>
<span id="cb84-1534"><a href="#cb84-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1537"><a href="#cb84-1537" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb84-1538"><a href="#cb84-1538" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> weight, <span class="at">data =</span> cov1_tbl)</span>
<span id="cb84-1539"><a href="#cb84-1539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1540"><a href="#cb84-1540" aria-hidden="true" tabindex="-1"></a>simple_new_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">weight =</span> <span class="fu">c</span>(<span class="fl">1.7</span>, <span class="fl">1.4</span>, <span class="fl">2.1</span>, <span class="fl">3.0</span>)) </span>
<span id="cb84-1541"><a href="#cb84-1541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1542"><a href="#cb84-1542" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit_1, <span class="at">newdata =</span> simple_new_tbl) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb84-1543"><a href="#cb84-1543" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb84-1544"><a href="#cb84-1544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1545"><a href="#cb84-1545" aria-hidden="true" tabindex="-1"></a>Wie wir sehen ist die Anwendung recht einfach. Wir haben die vier <span class="in">`jump_length`</span> Werte vorhergesagt bekommen, die sich mit dem Fit des Modells mit den neuen <span class="in">`weight`</span> Werten ergeben. In @fig-scatter-lin-pred sehen wir die Visualisierung der vier vorhergesagten Werte. Die Werte müssen auf der Graden liegen.</span>
<span id="cb84-1546"><a href="#cb84-1546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1547"><a href="#cb84-1547" aria-hidden="true" tabindex="-1"></a>Wir werden später in der <span class="co">[</span><span class="ot">Klassifikation</span><span class="co">](#sec-class-basic)</span>, der Vorhersage von $0/1$-Werten, sowie in der multiplen Regression noch andere Prädktionen und deren Maßzahlen kennen lernen. Im Rahmen der simplen Regression soll dies aber erstmal hier genügen.</span>
<span id="cb84-1548"><a href="#cb84-1548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1549"><a href="#cb84-1549" aria-hidden="true" tabindex="-1"></a><span class="fu">## Glossar</span></span>
<span id="cb84-1550"><a href="#cb84-1550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1551"><a href="#cb84-1551" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb84-1552"><a href="#cb84-1552" aria-hidden="true" tabindex="-1"></a><span class="fu">## Glossar zum statistischen Modellieren</span></span>
<span id="cb84-1553"><a href="#cb84-1553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1554"><a href="#cb84-1554" aria-hidden="true" tabindex="-1"></a>| Symbol | Deutsch |</span>
<span id="cb84-1555"><a href="#cb84-1555" aria-hidden="true" tabindex="-1"></a>|:--:|----|</span>
<span id="cb84-1556"><a href="#cb84-1556" aria-hidden="true" tabindex="-1"></a>| $RHS \sim LHS$ | Modellschreibweise mit der rechten Seite (eng. *right hand site*) und der linken Seite (eng. *left hand side*) |</span>
<span id="cb84-1557"><a href="#cb84-1557" aria-hidden="true" tabindex="-1"></a>| $RHS$ | Rechte Seite der Tilde in der Modellschreibweise (eng. *right hand site*) |</span>
<span id="cb84-1558"><a href="#cb84-1558" aria-hidden="true" tabindex="-1"></a>| $LHS$ | Linke Seite der Tilde in der Modellschreibweise (eng. *left hand site*) |</span>
<span id="cb84-1559"><a href="#cb84-1559" aria-hidden="true" tabindex="-1"></a>| $Y \sim X$ | Modelschreibweise mit Platzhaltervariable X und Y |</span>
<span id="cb84-1560"><a href="#cb84-1560" aria-hidden="true" tabindex="-1"></a>| $Y / y$ | Messwert |</span>
<span id="cb84-1561"><a href="#cb84-1561" aria-hidden="true" tabindex="-1"></a>| $X / x$ | Einflussvariable |</span>
<span id="cb84-1562"><a href="#cb84-1562" aria-hidden="true" tabindex="-1"></a>| $\epsilon$ | Residuen oder Fehler aus einer Regressionsanalyse |</span>
<span id="cb84-1563"><a href="#cb84-1563" aria-hidden="true" tabindex="-1"></a>| Fehler | Abweichung der vorhergesagten y-Werte durch das Modell auf der Graden zu den beobachteten y-Werten in den Daten. |</span>
<span id="cb84-1564"><a href="#cb84-1564" aria-hidden="true" tabindex="-1"></a>| $\beta_0$ | Intercept oder y-Achsenabschnitt |</span>
<span id="cb84-1565"><a href="#cb84-1565" aria-hidden="true" tabindex="-1"></a>| $\beta_1$ | Steigung der ersten Einflussvariable |</span>
<span id="cb84-1566"><a href="#cb84-1566" aria-hidden="true" tabindex="-1"></a>| Intercept | y-Achsenabschnitt |</span>
<span id="cb84-1567"><a href="#cb84-1567" aria-hidden="true" tabindex="-1"></a>| $\hat{y}$ | Vorhergesagte y-Werte durch das Modell auf der Graden |</span>
<span id="cb84-1568"><a href="#cb84-1568" aria-hidden="true" tabindex="-1"></a>| Kovariate | Kontinuierliche Einflussvariable |</span>
<span id="cb84-1569"><a href="#cb84-1569" aria-hidden="true" tabindex="-1"></a>| $c_1$ | Kovariate |</span>
<span id="cb84-1570"><a href="#cb84-1570" aria-hidden="true" tabindex="-1"></a>| Faktor | Kategoriale Einflussvariable |</span>
<span id="cb84-1571"><a href="#cb84-1571" aria-hidden="true" tabindex="-1"></a>| Level | Gruppen eines Faktors |</span>
<span id="cb84-1572"><a href="#cb84-1572" aria-hidden="true" tabindex="-1"></a>| $f_A$ | Faktor |</span>
<span id="cb84-1573"><a href="#cb84-1573" aria-hidden="true" tabindex="-1"></a>| $A.1, ..., A.3$ | Level eines Faktors als Gruppen |</span>
<span id="cb84-1574"><a href="#cb84-1574" aria-hidden="true" tabindex="-1"></a>| $\mathcal{N}(0, 1)$ | Standardnormalverteilung mit einem Mittelwert von 0 und einer Varianz von 1 |</span>
<span id="cb84-1575"><a href="#cb84-1575" aria-hidden="true" tabindex="-1"></a>| Zufälliger Effekt | Faktor in einem gemischten Modell, der aus einer zufälligen Population stammt |</span>
<span id="cb84-1576"><a href="#cb84-1576" aria-hidden="true" tabindex="-1"></a>| $Z / z$ | Zufälliger Effekt |</span>
<span id="cb84-1577"><a href="#cb84-1577" aria-hidden="true" tabindex="-1"></a>| Fester Effekt | Faktor in einem gemischten Modell, der aus einer experimentellen Population stammt |</span>
<span id="cb84-1578"><a href="#cb84-1578" aria-hidden="true" tabindex="-1"></a>| schätzen | Berechnung der Koeffizienten in einem statistischen Modell |</span>
<span id="cb84-1579"><a href="#cb84-1579" aria-hidden="true" tabindex="-1"></a>| Koeffizienten | Steigung und Intercept in einem statistischen Modell. Allgemeiner die Parameter die ein statistsiches Modell wiedergibt und die Grade beschreibt. |</span>
<span id="cb84-1580"><a href="#cb84-1580" aria-hidden="true" tabindex="-1"></a>| Residuen | Unerklärter Rest durch die Modellierung. Konkret der Abstand zwischen den y-Messwerten und den y-Werten auf der Geraden. |</span>
<span id="cb84-1581"><a href="#cb84-1581" aria-hidden="true" tabindex="-1"></a>|  |  |</span>
<span id="cb84-1582"><a href="#cb84-1582" aria-hidden="true" tabindex="-1"></a>|  |  |</span>
<span id="cb84-1583"><a href="#cb84-1583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1584"><a href="#cb84-1584" aria-hidden="true" tabindex="-1"></a>: Gossar der häufig verwendeten Symbole und Fachbegriffe im statistischen Modellieren. {#tbl-glossar-regression tbl-colwidths="25, 75"}</span>
<span id="cb84-1585"><a href="#cb84-1585" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb84-1586"><a href="#cb84-1586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-1587"><a href="#cb84-1587" aria-hidden="true" tabindex="-1"></a><span class="fu">## Referenzen {.unnumbered}</span></span>
</code><button title="In die Zwischenablage kopieren" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Bio Data Science wurde von <a href="https://www.hs-osnabrueck.de/prof-dr-jochen-kruppa/">Jochen Kruppa-Scheetz</a> geschrieben.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-linear-reg-basic.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-linear-reg-basic.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Dieses Openbook wurde mit <a href="https://quarto.org/">Quarto</a> erstellt.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>
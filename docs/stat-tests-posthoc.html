<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Skript Bio Data Science - 32&nbsp; Multiple Vergleiche oder Post-hoc Tests</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./stat-linear-reg-preface.html" rel="next">
<link href="./stat-tests-pretest.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-tests-preface.html">Frequentistische Hypothesentests</a></li><li class="breadcrumb-item"><a href="./stat-tests-posthoc.html"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Multiple Vergleiche oder Post-hoc Tests</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Skript Bio Data Science</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Willkommen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Literatur</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forschungsprozess</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abschlussarbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Abschlussarbeit</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./example-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datenbeispiele</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen auf Hunden und Katzen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats-foxes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats-length-weight.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von vielen Flöhen auf Hunden und Katzen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programmieren in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Buchstaben und Zahlen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Daten einlesen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Reguläre Ausdrücke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-purrr-furrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Ein <code>purrr</code> Cookbook</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorative Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Frequentistische Hypothesentests</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Der t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Der Wilcoxon-Mann-Whitney-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Friedman Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Der <span class="math inline">\(\mathcal{X}^2\)</span>-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Pre-Tests oder Vortest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Multiple Vergleiche oder Post-hoc Tests</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grundlagen der linearen Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Maßzahlen der Modelgüte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Korrelation</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistisches Modellieren</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Variablenselektion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Ausreißer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Imputation fehlender Werte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-robust-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Überlebenszeitanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-noninferiority.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Äquivalenz oder Nichtunterlegenheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Metaanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-permutationstest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Permutationstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelles Design</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Versuchsplanung in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Einfache Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Fortgeschrittene Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Klassifikation oder maschinelles Lernen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-pre-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Data preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Support vector machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./abspann.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abspann</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-spielecke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Spielecke</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
<li><a href="#genutzte-r-pakete-f%C3%BCr-das-kapitel" id="toc-genutzte-r-pakete-für-das-kapitel" class="nav-link active" data-scroll-target="#genutzte-r-pakete-f%C3%BCr-das-kapitel"><span class="header-section-number">32.1</span> Genutzte R Pakete für das Kapitel</a></li>
  <li>
<a href="#daten" id="toc-daten" class="nav-link" data-scroll-target="#daten"><span class="header-section-number">32.2</span> Daten</a>
  <ul class="collapse">
<li><a href="#hypothesen-f%C3%BCr-multiple-vergleiche" id="toc-hypothesen-für-multiple-vergleiche" class="nav-link" data-scroll-target="#hypothesen-f%C3%BCr-multiple-vergleiche"><span class="header-section-number">32.2.1</span> Hypothesen für multiple Vergleiche</a></li>
  </ul>
</li>
  <li>
<a href="#sec-posthoc-pairwise" id="toc-sec-posthoc-pairwise" class="nav-link" data-scroll-target="#sec-posthoc-pairwise"><span class="header-section-number">32.3</span> Gruppenvergleiche mit <code>pairwise.*.test()</code></a>
  <ul class="collapse">
<li><a href="#paarweiser-t-test" id="toc-paarweiser-t-test" class="nav-link" data-scroll-target="#paarweiser-t-test"><span class="header-section-number">32.3.1</span> Paarweiser t Test</a></li>
  <li><a href="#paarweiser-wilcoxon-test" id="toc-paarweiser-wilcoxon-test" class="nav-link" data-scroll-target="#paarweiser-wilcoxon-test"><span class="header-section-number">32.3.2</span> Paarweiser Wilcoxon Test</a></li>
  </ul>
</li>
  <li>
<a href="#sec-posthoc-multcomp" id="toc-sec-posthoc-multcomp" class="nav-link" data-scroll-target="#sec-posthoc-multcomp"><span class="header-section-number">32.4</span> Gruppenvergleich mit dem <code>multcomp</code> Paket</a>
  <ul class="collapse">
<li><a href="#gruppenvergleiche-mit-multcomp-in-r" id="toc-gruppenvergleiche-mit-multcomp-in-r" class="nav-link" data-scroll-target="#gruppenvergleiche-mit-multcomp-in-r"><span class="header-section-number">32.4.1</span> Gruppenvergleiche mit <code>multcomp</code> in R</a></li>
  </ul>
</li>
  <li>
<a href="#sec-posthoc-emmeans" id="toc-sec-posthoc-emmeans" class="nav-link" data-scroll-target="#sec-posthoc-emmeans"><span class="header-section-number">32.5</span> Gruppenvergleich mit dem <code>emmeans</code> Paket</a>
  <ul class="collapse">
<li><a href="#gruppenvergleiche-mit-emmeans-in-r" id="toc-gruppenvergleiche-mit-emmeans-in-r" class="nav-link" data-scroll-target="#gruppenvergleiche-mit-emmeans-in-r"><span class="header-section-number">32.5.1</span> Gruppenvergleiche mit <code>emmeans</code> in R</a></li>
  </ul>
</li>
  <li>
<a href="#gruppenvergleich-unter-varianzheterogenit%C3%A4t" id="toc-gruppenvergleich-unter-varianzheterogenität" class="nav-link" data-scroll-target="#gruppenvergleich-unter-varianzheterogenit%C3%A4t"><span class="header-section-number">32.6</span> Gruppenvergleich unter Varianzheterogenität</a>
  <ul class="collapse">
<li><a href="#sec-posthoc-ght" id="toc-sec-posthoc-ght" class="nav-link" data-scroll-target="#sec-posthoc-ght"><span class="header-section-number">32.6.1</span> Games-Howell-Test</a></li>
  <li><a href="#generalized-least-squares" id="toc-generalized-least-squares" class="nav-link" data-scroll-target="#generalized-least-squares"><span class="header-section-number">32.6.2</span> Generalized Least Squares</a></li>
  <li><a href="#robuste-sch%C3%A4tzung-von-standardfehlern" id="toc-robuste-schätzung-von-standardfehlern" class="nav-link" data-scroll-target="#robuste-sch%C3%A4tzung-von-standardfehlern"><span class="header-section-number">32.6.3</span> Robuste Schätzung von Standardfehlern</a></li>
  </ul>
</li>
  <li>
<a href="#sec-compact-letter" id="toc-sec-compact-letter" class="nav-link" data-scroll-target="#sec-compact-letter"><span class="header-section-number">32.7</span> Compact letter display</a>
  <ul class="collapse">
<li><a href="#f%C3%BCr-pairwise..test" id="toc-für-pairwise..test" class="nav-link" data-scroll-target="#f%C3%BCr-pairwise..test"><span class="header-section-number">32.7.1</span> … für <code>pairwise.*.test()</code></a></li>
  <li><a href="#f%C3%BCr-das-paket-multcomp" id="toc-für-das-paket-multcomp" class="nav-link" data-scroll-target="#f%C3%BCr-das-paket-multcomp"><span class="header-section-number">32.7.2</span> … für das Paket <code>multcomp</code></a></li>
  <li><a href="#f%C3%BCr-das-paket-emmeans" id="toc-für-das-paket-emmeans" class="nav-link" data-scroll-target="#f%C3%BCr-das-paket-emmeans"><span class="header-section-number">32.7.3</span> … für das Paket <code>emmeans</code></a></li>
  <li><a href="#f%C3%BCr-den-games-howell-test" id="toc-für-den-games-howell-test" class="nav-link" data-scroll-target="#f%C3%BCr-den-games-howell-test"><span class="header-section-number">32.7.4</span> … für den Games-Howell-Test</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-posthoc" class="quarto-section-identifier"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Multiple Vergleiche oder Post-hoc Tests</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p><em>Version vom August 27, 2023 um 12:27:10</em></p>
<p>In diesem Kapitel wollen wir uns mit den multipen Vergleichen beschäftigen. Das heißt, wir wollen statistisch Testen, ob sich die Level eines Faktors voneinander unterscheiden. Eventuell hast du schon eine einfaktorielle ANOVA gerechnet, wie in <a href="stat-tests-anova.html#sec-fac1"><span>Kapitel&nbsp;24.2</span></a> beschrieben. Oder aber du hast eine mehrfaktorielle ANOVA gerechnet wie in <a href="stat-tests-anova.html#sec-fac2"><span>Kapitel&nbsp;24.3</span></a> gezeigt. In beiden Fällen hast du jetzt einen signifikanten Faktor, der mehr als zwei Level hat. Du willst nun wissen, <em>welche</em> der Gruppenmittelwerte der Level sich signifikant unterscheiden. Hierfür können wir verschiedene Ansätze wählen.</p>
<ol type="1">
<li>Wir haben eine einfaktorielle ANOVA gerechnet und nutzen nun paarweise Vergleiche um herauszufinden welche Gruppenmittelwerte sich unterscheiden (siehe <a href="#sec-posthoc-pairwise"><span>Kapitel&nbsp;32.3</span></a>)</li>
<li>Wir haben eine mehrfaktorielle ANOVA gerechnet und haben daher mehrere Faktoren. Wir nutzen nun entweder das R Paket <code>multcomp</code> (siehe <a href="#sec-posthoc-multcomp"><span>Kapitel&nbsp;32.4</span></a>) oder das R Paket <code>emmeans</code> (siehe <a href="#sec-posthoc-emmeans"><span>Kapitel&nbsp;32.5</span></a>) um herauszufinden welche Gruppenmittelwerte sich unterscheiden.</li>
</ol>
<p>Wenn wir multiple Mittelwertsvergleiche rechnen, dann tritt das Problem des multipen Testens auf. Im <a href="stat-tests-theorie.html#sec-statistisches-testen-alpha-adjust"><span>Kapitel&nbsp;21.3</span></a> kannst du mehr über die Problematik erfahren und wie wir mit der <span class="math inline">\(\alpha\)</span> Inflation umgehen. Hier in diesem Kapitel gehe ich jetzt davon aus, dass dir die <span class="math inline">\(\alpha\)</span> Adjustierung ein Begriff ist.</p>
<p>Der paarweise Mittelwertsvergleich wird auch gerne Tukey Test genannt. Das heißt, dass der Tukey Test alle Gruppen miteinander vergleicht. Der Tukey Test wird daher auch gerne <em>all pair</em> Vergleich genannt.</p>
<section id="genutzte-r-pakete-für-das-kapitel" class="level2" data-number="32.1"><h2 data-number="32.1" class="anchored" data-anchor-id="genutzte-r-pakete-für-das-kapitel">
<span class="header-section-number">32.1</span> Genutzte R Pakete für das Kapitel</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">tidyverse</span>, <span class="va">magrittr</span>, <span class="va">broom</span>, <span class="va">nlme</span>,</span>
<span>               <span class="va">multcomp</span>, <span class="va">emmeans</span>, <span class="va">ggpubr</span>, <span class="va">multcompView</span>,</span>
<span>               <span class="va">rstatix</span>, <span class="va">conflicted</span>, <span class="va">see</span>, <span class="va">rcompanion</span><span class="op">)</span></span>
<span><span class="fu">conflict_prefer</span><span class="op">(</span><span class="st">"select"</span>, <span class="st">"dplyr"</span><span class="op">)</span></span>
<span><span class="fu">conflict_prefer</span><span class="op">(</span><span class="st">"filter"</span>, <span class="st">"dplyr"</span><span class="op">)</span></span>
<span><span class="fu">conflict_prefer</span><span class="op">(</span><span class="st">"mutate"</span>, <span class="st">"dplyr"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Am Ende des Kapitels findest du nochmal den gesamten R Code in einem Rutsch zum selber durchführen oder aber kopieren.</p>
</section><section id="daten" class="level2" data-number="32.2"><h2 data-number="32.2" class="anchored" data-anchor-id="daten">
<span class="header-section-number">32.2</span> Daten</h2>
<p>Wir nutzen in diesem Kapitel den Datensatz aus dem Beispiel in <a href="example-fleas-dogs-cats-foxes.html"><span>Kapitel&nbsp;6</span></a>. Wir haben als Outcome die Sprunglänge in [cm] von Flöhen. Die Sprunglänge haben wir an Flöhen von Hunde, Katzen und Füchsen gemessen. Der Datensatz ist also recht übeerschaubar. Wir haben ein normalverteiltes <span class="math inline">\(y\)</span> mit <code>jump_length</code> sowie einen multinomialverteiltes <span class="math inline">\(y\)</span> mit <code>grade</code> und einen Faktor <code>animal</code> mit drei Leveln.</p>
<p>Du kannst dir komplexere Auswertungen in dem Skript <a href="https://jkruppa.github.io/application/">Beispielhaften Auswertungen</a> anschauen. Dort sammelt sich mit der Zeit Auswertungen vom Fachbereich an. Daher finden sich dort auch Beispiele für multiple Vergleiche.</p>
<p>Im Folgenden laden wir den Datensatz <code>flea_dog_cat_fox.csv</code> und selektieren mit der Funktion <code>select()</code> die benötigten Spalten. Abschließend müssen wir die Spalte <code>animal</code>noch in einen Faktor umwandeln. Damit ist unsere Vorbereitung des Datensatzes abgeschlossen.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fac1_tbl</span> <span class="op">&lt;-</span> <span class="fu">read_csv2</span><span class="op">(</span><span class="st">"data/flea_dog_cat_fox.csv"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">animal</span>, <span class="va">jump_length</span>, <span class="va">grade</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>animal <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">animal</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In der <a href="#tbl-data-posthoc-1">Tabelle&nbsp;<span>32.1</span></a> ist der Datensatz <code>fac1_tbl</code> nochmal dargestellt.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-data-posthoc-1" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tabelle&nbsp;32.1— Selektierter Datensatz mit einer normalverteilten Variable <code>jump_length</code> sowie der multinominalverteilten Variable <code>grade</code> und einem Faktor <code>animal</code> mit drei Leveln.</caption>
<thead><tr class="header">
<th style="text-align: center;">animal</th>
<th style="text-align: center;">jump_length</th>
<th style="text-align: center;">grade</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">5.7</td>
<td style="text-align: center;">8</td>
</tr>
<tr class="even">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">8.9</td>
<td style="text-align: center;">8</td>
</tr>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">11.8</td>
<td style="text-align: center;">6</td>
</tr>
<tr class="even">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">8.2</td>
<td style="text-align: center;">8</td>
</tr>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">5.6</td>
<td style="text-align: center;">7</td>
</tr>
<tr class="even">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">9.1</td>
<td style="text-align: center;">7</td>
</tr>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">7.6</td>
<td style="text-align: center;">9</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">3.2</td>
<td style="text-align: center;">7</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">2.2</td>
<td style="text-align: center;">5</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">5.4</td>
<td style="text-align: center;">7</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">4.1</td>
<td style="text-align: center;">6</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">4.3</td>
<td style="text-align: center;">6</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">7.9</td>
<td style="text-align: center;">6</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">6.1</td>
<td style="text-align: center;">5</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">7.7</td>
<td style="text-align: center;">5</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">8.1</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">9.1</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">9.7</td>
<td style="text-align: center;">5</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">10.6</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">8.6</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">10.3</td>
<td style="text-align: center;">3</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Wir werden nun den Datensatz <code>fac1_tbl</code> in den folgenden Abschnitten immer wieder nutzen.</p>
<section id="hypothesen-für-multiple-vergleiche" class="level3" data-number="32.2.1"><h3 data-number="32.2.1" class="anchored" data-anchor-id="hypothesen-für-multiple-vergleiche">
<span class="header-section-number">32.2.1</span> Hypothesen für multiple Vergleiche</h3>
<p>Als wir eine ANOVA gerechnet hatten, hatten wir nur eine Nullhypothese und eine Alternativehypothese. Wenn wir Nullhypothese abgelehnt hatten, wussten wir nur, dass sich mindestens ein paarweiser Vergleich unterschiedet. Multiple Vergleich lösen nun dieses Problem und führen ein Hypothesen<em>paar</em> für jeden paarweisen Vergleich ein. Zum einen rechnen wir damit <span class="math inline">\(k\)</span> Tests und haben damit auch <span class="math inline">\(k\)</span> Hypothesenpaare (siehe auch <a href="stat-tests-theorie.html#sec-statistisches-testen-alpha-adjust"><span>Kapitel&nbsp;21.3</span></a> zur Problematik des wiederholten Testens).</p>
<p>Wenn wir zum Beispiel alle Level des Faktors <code>animal</code> miteinander Vergleichen wollen, dann rechnen wir <span class="math inline">\(k=3\)</span> paarweise Vergleiche. Im Folgenden sind alle drei Hypothesenpaare dargestellt.</p>
<p><span class="math display">\[
\begin{aligned}
H_{01}: &amp;\; \bar{y}_{cat} = \bar{y}_{dog}\\
H_{A1}: &amp;\; \bar{y}_{cat} \ne \bar{y}_{dog}\\
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
H_{02}: &amp;\; \bar{y}_{cat} = \bar{y}_{fox}\\
H_{A2}: &amp;\; \bar{y}_{cat} \ne \bar{y}_{fox}\\
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
H_{03}: &amp;\; \bar{y}_{dog} = \bar{y}_{fox}\\
H_{A3}: &amp;\; \bar{y}_{dog} \ne \bar{y}_{fox}\\
\end{aligned}
\]</span></p>
<p>Wenn wir drei Vergleiche rechnen, dann haben wir eine <span class="math inline">\(\alpha\)</span> Inflation vorliegen. Wir sagen, dass wir für das multiple Testen adjustieren müssen. In R gibt es eine Reihe von Adjustierungsverfahren. Wir nehmen meist Bonferroni oder das Verfahren, was in der jeweiligen Funktion als Standard (eng. <em>default</em>) gesetzt ist.</p>
<p>Wir adjustieren grundsätzlich die <span class="math inline">\(p\)</span>-Werte und erhalten adjustierte <span class="math inline">\(p\)</span>-Werte aus den jeweiligen Funktionen in R. Die adjustierten p-Werte können wir dann mit dem Signifikanzniveau von <span class="math inline">\(\alpha\)</span> gleich 5% vergleichen.</p>
</section></section><section id="sec-posthoc-pairwise" class="level2 page-columns page-full" data-number="32.3"><h2 data-number="32.3" class="anchored" data-anchor-id="sec-posthoc-pairwise">
<span class="header-section-number">32.3</span> Gruppenvergleiche mit <code>pairwise.*.test()</code>
</h2>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="">Die Funktion <code>pairwise.*.test()</code> ist <em>veraltet</em>, wir nutzen das R Paket <code>emmeans</code>oder das R Paket <code>multcomp</code>.</span></div></div>
<p>Wenn wir nur einen Faktor mit mehr als zwei Leveln vorliegen haben, dann können wir die Funktion <code>pairwise.*.test()</code> nutzen. Der Stern <code>*</code> steht entweder als Platzhalter für <code>t</code> für den t-Test oder aber für <code>wilcox</code> für den Wilcoxon Test. Die Funktion ist relativ einfach zu nutzen und liefert auch sofort die entsprechenden p-Werte.</p>
<p>Die Funktion <code>pairwise.*.test()</code> ist in dem Sinne <em>veraltet</em>, da wir keine 95% Konfidenzintervalle generieren können. Da die Funktion aber immer mal wieder angefragt wird, ist die Funktion hier nochmal aufgeführt.</p>
<section id="paarweiser-t-test" class="level3 page-columns page-full" data-number="32.3.1"><h3 data-number="32.3.1" class="anchored" data-anchor-id="paarweiser-t-test">
<span class="header-section-number">32.3.1</span> Paarweiser t Test</h3>
<p>Wir nutzen den paarweisen t-Test,</p>
<ul>
<li>wenn wir ein normalverteiltes <span class="math inline">\(y\)</span> vorliegen haben, wie <code>jump_length</code>.</li>
<li>wenn wir <em>nur</em> einen Faktor mit mehr als zwei Leveln vorliegen haben, wie <code>animal</code>.</li>
<li>wenn wir Varianzhomogenität über alle Level vorliegen haben, dann nutzen wir die Option <code>pool.sd = TRUE</code>. Wenn wir Varianzheterogenität über alle Level des Faktors vorliegen haben, dann nutzen wir <code>pool.sd = FALSE</code>.</li>
</ul>
<p>Die Funktion <code>pairwise.t.test</code> kann nicht mit Datensätzen arbeiten sondern nur mit Vektoren. Daher können wir der Funktion auch keine <code>formula</code> übergeben sondern müssen die Vektoren aus dem Datensatz mit <code>fac1_tbl$jump_length</code> für das Outcome und mit <code>fac1_tbl$animal</code> für die Gruppierende Variable benennen. Das ist umständlich und daher auch fehleranfällig. Wir können auch den <code>%$%</code>-Operator aus dem R Paket <code>magrittr</code> nutzen um die Problematik zu umgehen. Weiter unten siehst du dann einmal beide Anwendungen.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Mehr zu <code>mutate_if()</code> erfährst du auf der <a href="https://dplyr.tidyverse.org/reference/mutate_all.html">Hilfeseite von mutate()</a></p>
</div></div><p>Als Adjustierungsmethode für den <span class="math inline">\(\alpha\)</span> Fehler wählen wir die Bonferroni-Methode mit <code>p.adjust.method = "bonferroni"</code> aus. Da wir eine etwas unübersichtliche Ausgabe in R erhalten nutzen wir die Funktion <code>tidy()</code>um die Ausgabe in ein sauberes <code>tibble</code> zu verwandeln. Abschließend runden wir noch alle numerischen Spalten mit der Funktion <code>round</code> auf drei Stellen hinter dem Komma.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/pairwise.t.test.html">pairwise.t.test</a></span><span class="op">(</span><span class="va">fac1_tbl</span><span class="op">$</span><span class="va">jump_length</span>, <span class="va">fac1_tbl</span><span class="op">$</span><span class="va">animal</span>,</span>
<span>                p.adjust.method <span class="op">=</span> <span class="st">"bonferroni"</span>,</span>
<span>                pool.sd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="va">tidy</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate_if</span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">round</span>, <span class="fl">3</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  group1 group2 p.value
  &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;
1 cat    dog      0.007
2 fox    dog      0.876
3 fox    cat      0.001</code></pre>
</div>
</div>
<p>Und das ganze nochmal mit dem <code>%$%</code>-Operator aus dem R Paket <code>magrittr</code>. In diesem Fall können wir uns das <code>$</code> sparen und greifen direkt auf die Spalten des Datensatzes zu.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fac1_tbl</span> <span class="op">%$%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/pairwise.t.test.html">pairwise.t.test</a></span><span class="op">(</span><span class="va">jump_length</span>, <span class="va">animal</span>,</span>
<span>                  p.adjust.method <span class="op">=</span> <span class="st">"bonferroni"</span>,</span>
<span>                  pool.sd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="va">tidy</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate_if</span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">round</span>, <span class="fl">3</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  group1 group2 p.value
  &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;
1 cat    dog      0.007
2 fox    dog      0.876
3 fox    cat      0.001</code></pre>
</div>
</div>
<p>Wir erhalten in einem Tibble die adjustierten p-Werte nach Bonferroni. Wir können daher die adjustierten p-Werte ganz normal mit dem Signifikanzniveau <span class="math inline">\(\alpha\)</span> von 5% vergleichen. Wenn du keine adjustierten p-Werte möchtest, dann nutze die Option <code>p.adjust.method = "none"</code>. Wir sehen, dass der Gruppenvergleich <code>cat - dog</code> signifikant ist, der Gruppenvergleich <code>fox - dog</code> nicht signifikant ist und der Gruppenvergleich <code>fox - cat</code> wiederum signifikant ist.</p>
<p>Leider können wir uns keine Konfidenzintervalle wiedergeben lassen, so dass die Funktion nicht dem Stand der Wissenschaft und deren Ansprüchen genügt.</p>
<p>Im Folgenden wollen wir uns nochmal die Visualisierung mit dem R Paket <code>ggpubr</code> anschauen. Die <a href="https://rpkgs.datanovia.com/ggpubr/index.html">Hilfeseite des R Pakets <code>ggpubr</code></a> liefert noch eine Menge weitere Beispiele für den simplen Fall eines Modells <span class="math inline">\(y ~ x\)</span>, also von einem <span class="math inline">\(y\)</span> und einem Faktor <span class="math inline">\(x\)</span>.</p>
<p>Um die <a href="#fig-ggpubr-1">Abbildung&nbsp;<span>32.1</span></a> zu erstellen müssen wir als erstes die Funktion <code>compare_mean()</code> nutzen um mit der <code>formula</code> Syntax einen t-Test zu rechnen. wir adjustieren die p-Werte nach Bonferroni. Anschließend erstellen wir einen Boxplot mit der Funktion <code>ggboxplot()</code> und speichern die Ausgabe in dem Objekt <code>p</code>. Wie in <code>ggplot</code> üblich können wir jetzt auf das Layer <code>p</code> über das <code>+</code>-Zeichen noch weitere Layer ergänzen. Wir nutzen die Funktion <code>stat_pvalue_manual()</code> um die asjustierten p-Werte aus dem Objekt <code>stat_test_obj</code> zu ergänzen. Abschließend wollen wir noch den p-Wert einer einfaktoriellen ANOVA als globalen Test ergänzen.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">stat_test_obj</span> <span class="op">&lt;-</span> <span class="fu">compare_means</span><span class="op">(</span></span>
<span> <span class="va">jump_length</span> <span class="op">~</span> <span class="va">animal</span>, data <span class="op">=</span> <span class="va">fac1_tbl</span>,</span>
<span> method <span class="op">=</span> <span class="st">"t.test"</span>,</span>
<span> p.adjust.method <span class="op">=</span> <span class="st">"bonferroni"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggboxplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">fac1_tbl</span>, x <span class="op">=</span> <span class="st">"animal"</span>, y <span class="op">=</span> <span class="st">"jump_length"</span>,</span>
<span>               color <span class="op">=</span> <span class="st">"animal"</span>, palette <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span><span class="op">)</span>,</span>
<span>               add <span class="op">=</span> <span class="st">"jitter"</span>, shape <span class="op">=</span> <span class="st">"animal"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">stat_pvalue_manual</span><span class="op">(</span><span class="va">stat_test_obj</span>, label <span class="op">=</span> <span class="st">"p.adj"</span>, y.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">13</span>, <span class="fl">16</span>, <span class="fl">19</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_compare_means</span><span class="op">(</span>label.y <span class="op">=</span> <span class="fl">20</span>, method <span class="op">=</span> <span class="st">"anova"</span><span class="op">)</span>    </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ggpubr-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-tests-posthoc_files/figure-html/fig-ggpubr-1-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Abbildung&nbsp;32.1— Boxplot der Sprungweiten [cm] von Hunden und Katzen ergänzt um den paarweisen Vergleich mit dem t-Test und den Bonferroni adjustierten p-Werten.</figcaption></figure>
</div>
</div>
</div>
</section><section id="paarweiser-wilcoxon-test" class="level3 page-columns page-full" data-number="32.3.2"><h3 data-number="32.3.2" class="anchored" data-anchor-id="paarweiser-wilcoxon-test">
<span class="header-section-number">32.3.2</span> Paarweiser Wilcoxon Test</h3>
<p>Wir nutzen den paarweisen Wilxocon Test,</p>
<ul>
<li>wenn wir ein <em>nicht</em>-normalverteiltes <span class="math inline">\(y\)</span> vorliegen haben, wie <code>grade</code>.</li>
<li>wenn wir <em>nur</em> einen Faktor mit mehr als zwei Leveln vorliegen haben, wie <code>animal</code>.</li>
</ul>
<p>Die Funktion <code>pairwise.wilcox.test</code> kann nicht mit Datensätzen arbeiten sondern nur mit Vektoren. Daher können wir der Funktion auch keine <code>formula</code> übergeben sondern müssen die Vektoren aus dem Datensatz mit <code>fac1_tbl$jump_length</code> für das Outcome und mit <code>fac1_tbl$animal</code> für die Gruppierende Variable benennen. Das ist umständlich und dhaer auch fehleranfällig.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Mehr zu <code>mutate_if()</code> erfährst du auf der <a href="https://dplyr.tidyverse.org/reference/mutate_all.html">Hilfeseite von mutate()</a></p>
</div></div><p>Als Adjustierungsmethode für den <span class="math inline">\(\alpha\)</span> Fehler wählen wir die Bonferroni-Methode mit <code>p.adjust.method = "bonferroni"</code> aus. Da wir eine etwas unübersichtliche Ausgabe in R erhalten nutzen wir die Funktion <code>tidy()</code>um die Ausgabe in ein saubers <code>tibble</code> zu verwandeln. Abschließend runden wir noch alle numerischen Spalten mit der Funktion <code>round</code> auf drei Stellen hinter dem Komma.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/pairwise.wilcox.test.html">pairwise.wilcox.test</a></span><span class="op">(</span><span class="va">fac1_tbl</span><span class="op">$</span><span class="va">grade</span>, <span class="va">fac1_tbl</span><span class="op">$</span><span class="va">animal</span>,</span>
<span>                     p.adjust.method <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="va">tidy</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate_if</span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">round</span>, <span class="fl">3</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  group1 group2 p.value
  &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;
1 cat    dog      0.045
2 fox    dog      0.005
3 fox    cat      0.011</code></pre>
</div>
</div>
<p>Wir erhalten in einem Tibble die adujstierten p-Werte nach Bonferroni. Wir können daher die adjustierten p-Werte ganz normal mit dem Signifikanzniveau <span class="math inline">\(\alpha\)</span> von 5% vergleichen. Wir sehen, dass der Gruppenvergleich <code>cat - dog</code> knapp signifikant ist, der Gruppenvergleich <code>fox - dog</code> ebenfalls signifkant ist und der Gruppenvergleich <code>fox - cat</code> auch signifkant ist.</p>
<p>Leider können wir uns keine Konfidenzintervalle wiedergeben lassen, so dass die Funktion nicht dem Stand der Wissenschaft und deren Ansprüchen genügt.</p>
<p>Im Folgenden wollen wir uns nochmal die Visualisierung mit dem R Paket <code>ggpubr</code> anschauen. Die <a href="https://rpkgs.datanovia.com/ggpubr/index.html">Hilfeseite des R Pakets <code>ggpubr</code></a> liefert noch eine Menge weitere Beispiele für den simplen Fall eines Modells <span class="math inline">\(y ~ x\)</span>, also von einem <span class="math inline">\(y\)</span> und einem Faktor <span class="math inline">\(x\)</span>.</p>
<p>Um die <a href="#fig-ggpubr-2">Abbildung&nbsp;<span>32.2</span></a> zu erstellen müssen wir als erstes die Funktion <code>compare_mean()</code> nutzen um mit der <code>formula</code> Syntax einen Wilcoxon Test zu rechnen. wir adjustieren die p-Werte nach Bonferroni. Anschließend erstellen wir einen Boxplot mit der Funktion <code>ggboxplot()</code> und speichern die Ausgabe in dem Objekt <code>p</code>. Wie in <code>ggplot</code> üblich können wir jetzt auf das Layer <code>p</code> über das <code>+</code>-Zeichen noch weitere Layer ergänzen. Wir nutzen die Funktion <code>stat_pvalue_manual()</code> um die asjustierten p-Werte aus dem Objekt <code>stat_test_obj</code> zu ergänzen. Abschließend wollen wir noch den p-Wert eines Kruskal Wallis als globalen Test ergänzen.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">stat_test_obj</span> <span class="op">&lt;-</span> <span class="fu">compare_means</span><span class="op">(</span></span>
<span> <span class="va">grade</span> <span class="op">~</span> <span class="va">animal</span>, data <span class="op">=</span> <span class="va">fac1_tbl</span>,</span>
<span> method <span class="op">=</span> <span class="st">"wilcox.test"</span>,</span>
<span> p.adjust.method <span class="op">=</span> <span class="st">"bonferroni"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggboxplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">fac1_tbl</span>, x <span class="op">=</span> <span class="st">"animal"</span>, y <span class="op">=</span> <span class="st">"grade"</span>,</span>
<span>               color <span class="op">=</span> <span class="st">"animal"</span>, palette <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span><span class="op">)</span>,</span>
<span>               add <span class="op">=</span> <span class="st">"jitter"</span>, shape <span class="op">=</span> <span class="st">"animal"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">stat_pvalue_manual</span><span class="op">(</span><span class="va">stat_test_obj</span>, label <span class="op">=</span> <span class="st">"p.adj"</span>, y.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">13</span>, <span class="fl">16</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_compare_means</span><span class="op">(</span>label.y <span class="op">=</span> <span class="fl">20</span>, method <span class="op">=</span> <span class="st">"kruskal.test"</span><span class="op">)</span>    </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ggpubr-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-tests-posthoc_files/figure-html/fig-ggpubr-2-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Abbildung&nbsp;32.2— Boxplot der Sprungweiten [cm] von Hunden und Katzen ergänzt um den paarweisen Vergleich mit dem Wilcoxon Test und den Bonferroni adjustierten p-Werten.</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="sec-posthoc-multcomp" class="level2 page-columns page-full" data-number="32.4"><h2 data-number="32.4" class="anchored" data-anchor-id="sec-posthoc-multcomp">
<span class="header-section-number">32.4</span> Gruppenvergleich mit dem <code>multcomp</code> Paket</h2>
<p>Wir drehen hier einmal die Erklärung um. Wir machen erst die Anwendung in R und sollte dich dann noch mehr über die statistischen Hintergründe der Funktionen interessieren, folgt ein Abschnitt noch zur Theorie. Du wirst die Funktionen aus <code>multcomp</code> vermutlich in deiner Abschlussarbeit brauchen. Häufig werden multiple Gruppenvergleiche in Abschlussarbeiten gerechnet.</p>
<section id="gruppenvergleiche-mit-multcomp-in-r" class="level3 page-columns page-full" data-number="32.4.1"><h3 data-number="32.4.1" class="anchored" data-anchor-id="gruppenvergleiche-mit-multcomp-in-r">
<span class="header-section-number">32.4.1</span> Gruppenvergleiche mit <code>multcomp</code> in R</h3>

<div class="no-row-height column-margin column-container"><div class="">
<p>Die Ausgabe von <code>multcomp</code> können über die Funktion <code>tidy()</code> aufgeräumt werden. Mehr dazu unter der <a href="https://broom.tidymodels.org/reference/tidy.glht.html">Hilfeseite von <code>tidy</code>() zu multcomp</a>.</p>
</div></div><p>Als erstes brauchen wir ein lineares Modell für die Verwendung von <code>multcomp</code>. Normalerweise verenden wir das gleiche Modell, was wir schon in der ANOVA verwendet haben. Wir nutzen hier ein simples lineares Modell mit nur einem Faktor. Im Prinzip kann das Modell auch größer sein, davon schauen wir uns dann später im Verlauf des Kapitels noch welche an.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">jump_length</span> <span class="op">~</span> <span class="va">animal</span>, data <span class="op">=</span> <span class="va">fac1_tbl</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir haben das Objeckt <code>fit_1</code> mit der Funktion <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> erstellt. Im Modell sind jetzt alle Mittelwerte und die entsprechenden Varianzen geschätzt worden. Mit <code>summary(fit_1)</code> kannst du dir gerne das Modell auch nochmal anschauen.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Wenn wir keinen <em>all-pair</em> Vergleich rechnen wollen, dann können wir auch einen <em>many-to-one</em> Vergleich mit dem <code>Dunnett</code> Kontrast rechnen.</p>
</div></div><p>Im Anschluß nutzen wir die Funktion <code>glht()</code> um den multiplen vergleich zu rechnen. Als erstes musst du wissen, dass wenn wir <em>alle</em> Vergleiche rechnen wollen, wir einen <em>all-pair</em> Vergleich rechnen. In der Statistik heißt dieser Typ von Vergleich <code>Tukey</code>. Wir wollen jetzt als für den Faktor <code>animal</code> einen multiplen <code>Tukey</code>-Vergleich rechnen. Nichts anders sagt <code>mcp(animal = "Tukey")</code> aus, dabei steht <code>mcp</code> für <em>multiple comparison procedure</em>. Mit dem hinteren Teil der Funktion weiß jetzt die Funktion <code>glht()</code> was gerechnet werden soll. Wir müssen jetzt der Funktion nur noch mitgeben auf was der multiple vergleich gerehcnet werden soll, mit dem Objekt <code>fit_1</code>. Wir speichern die Ausgabe der Funktion in <code>comp_1_obj</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">comp_1_obj</span> <span class="op">&lt;-</span> <span class="fu">glht</span><span class="op">(</span><span class="va">fit_1</span>, linfct <span class="op">=</span> <span class="fu">mcp</span><span class="op">(</span>animal <span class="op">=</span> <span class="st">"Tukey"</span><span class="op">)</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Mit dem Objekt <code>comp_1_fit</code> können wir noch nicht soviel anfangen. Der Inhalt ist etwas durcheinander und wir wollen noch die Konfidenzintervalle haben. Daher pipen wir <code>comp_1_fit</code> erstmal in die Funktion <code>tidy()</code> und alssen mit der Option <code>conf.int = TRUE</code> die simultanen 95% Konfidenzintervalle berechnen. Dann nutzen wir die Funktion <code>select()</code> um die wichtigen Spalten zu selektieren. Abschließend mutieren wir noch alle numerischen Spalten in dem wir auf die dritte Kommastelle runden. Wir speichern alles in das Objekt <code>res_1_obj</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">res_1_obj</span> <span class="op">&lt;-</span> <span class="va">comp_1_obj</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tidy</span><span class="op">(</span>conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">contrast</span>, <span class="va">estimate</span>, <span class="va">adj.p.value</span>, </span>
<span>         <span class="va">conf.low</span>, <span class="va">conf.high</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate_if</span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">round</span>, <span class="fl">3</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir lassen uns dann den Inhalt von dem Objekt <code>res_1_obj</code> ausgeben.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">res_1_obj</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  contrast  estimate adj.p.value conf.low conf.high
  &lt;chr&gt;        &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 cat - dog    -3.39       0.006    -5.80    -0.968
2 fox - dog     1.03       0.535    -1.39     3.45 
3 fox - cat     4.41       0         2.00     6.83 </code></pre>
</div>
</div>
<p>Wir erhalten ein <code>tibble()</code> mit fünf Spalten. Zum einen den <code>contrast</code>, der den Vergleich widerspiegelt. Wir vergleichen im ersten Kontrast die Katzen- mit den Hundeflöhen, wobei wir <code>cat - dog</code> rechnen. Also wirklich der Mittelwert der Sprungweite der Katzenflöhe <em>minus</em> den Mittelwert der Sprungweite der Hundeflöhe rechnen. In der Spalte <code>estimate</code> sehen wir den Mittelwertsunterschied. Der Mittelwertsunterschied ist in der <em>Richtung</em> nicht ohne den Kontrast zu interpretieren. Danach erhalten wir die adjustierten <span class="math inline">\(p\)</span>-Wert sowie die simultanen 95% Konfidenzintervalle.</p>
<p>Wir können die Nullhypothese ablehnen für den Vergleiche<code>cat - dog</code> mit einem p-Wert von <span class="math inline">\(0.006\)</span> sowie für den Vergleich <span class="math inline">\(fox - cat\)</span> mit einem p-Wert von <span class="math inline">\(0.001\)</span>. Beide p-Werte liegen unter dem Signifikanzniveau von <span class="math inline">\(\alpha\)</span> gleich 5%.</p>
<p>Wenn es die unadjustierten <span class="math inline">\(p\)</span>-Werte sein sollen, dann müssen wir nochmal das <code>glht</code>-Objekt in die Funktion <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> stecken und dann die Option <code>test = adjusted("none")</code> wählen. Dann können wir weiter machen wie gewohnt.</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">comp_1_obj</span>, test <span class="op">=</span> <span class="fu">adjusted</span><span class="op">(</span><span class="st">"none"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tidy</span><span class="op">(</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 7
  term   contrast  null.value estimate std.error statistic  p.value
  &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 animal cat - dog          0    -3.39     0.947     -3.57 0.00217 
2 animal fox - dog          0     1.03     0.947      1.09 0.292   
3 animal fox - cat          0     4.41     0.947      4.66 0.000195</code></pre>
</div>
</div>
<p>In <a href="#fig-multcomp-1">Abbildung&nbsp;<span>32.3</span></a> sind die simultanen und damit adjustierten 95% Konfidenzintervalle nochmal in einem <code>ggplot</code> visualisiert. Die Kontraste und die Position hängen von dem Faktorlevel ab. Mit der Funktion <code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code> kannst du die Sortierung der Level einem Faktor ändern und somit auch Position auf den Achsen.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  <span class="fu">ggplot</span><span class="op">(</span><span class="va">res_1_obj</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">contrast</span>, y<span class="op">=</span><span class="va">estimate</span>, </span>
<span>                        ymin<span class="op">=</span><span class="va">conf.low</span>, ymax<span class="op">=</span><span class="va">conf.high</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_hline</span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">0</span>, linetype<span class="op">=</span><span class="st">"11"</span>, colour<span class="op">=</span><span class="st">"grey60"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_errorbar</span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-multcomp-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-tests-posthoc_files/figure-html/fig-multcomp-1-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption class="figure-caption">Abbildung&nbsp;32.3— Simultane 95% Konfidenzintervalle für den paarweisen Vergleich der Sprungweiten in [cm] der Hunde-, Katzen- und Fuchsflöhe.</figcaption></figure>
</div>
</div>
</div>
<p>Die Entscheidung gegen die Nullhypothese anhand der simultanen 95% Konfidenzintervalle ist inhaltlich gleich, wie die Entscheidung anhand der p-Werte. Wir entscheiden gegen die Nullhypothese, wenn die 0 nicht mit im Konfindenzintervall enthalten ist. Wir wählen hier die 0 zur Entscheidung gegen die Nullhypothese, weil wir einen Mittelwertsvergleich rechnen.</p>
<p>Für den Vergleich <code>fox -dog</code> ist die 0 im 95% Konfidenzintervall, wir können daher die Nullhypothese nicht ablehnen. Das 95% Konfidenzintervall ist nicht signifikant. Bei dem Vergleich <code>fox - cat</code> sowie dem Vergleich <code>cat - dog</code> ist jeweils die 0 nicht im 95% Konfidenzintervall enthalten. Beide 95% Konfidenzintervalle sind signifikant, wir können die Nullhypothese ablehnen.</p>
</section></section><section id="sec-posthoc-emmeans" class="level2 page-columns page-full" data-number="32.5"><h2 data-number="32.5" class="anchored" data-anchor-id="sec-posthoc-emmeans">
<span class="header-section-number">32.5</span> Gruppenvergleich mit dem <code>emmeans</code> Paket</h2>
<p>Im Folgenden wollen wir uns mit einem anderen R Paket beschäftigen was auch multiple Vergleiche rechnen kann. In diesem Kapitel nutzen wir das R Paket <code>emmeans</code>. Im Prinzip kann <code>emmeans</code> das Gleiche wir das R Paket <code>multcomp</code>. Beide Pakete rechnen dir einen multipen Vergleich. Das Paket <code>emmeans</code> kann noch mit <em>nested comparisons</em> umgehen. Deshlb hier nochmal die Vorstellung von <code>emmeans</code>. Du kannst aber für eine simple Auswertung mit nur einem Faktor beide Pakete verwenden.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Wir können hier nicht alles erklären und im Detail durchgehen. Hier gibt es noch ein aufwendiges Tutorium zu <code>emmeans</code>: <a href="https://aosmith.rbind.io/2019/03/25/getting-started-with-emmeans/">Getting started with emmeans</a>.</p>
<p>Daneben gibt es auch noch die <a href="https://cran.r-project.org/web/packages/emmeans/vignettes/basics.html#contents">Einführung mit Theorie auf der Seite des R Paktes</a></p>
<p>Es gibt hier auch ein weiteres englischsprachiges Tutorium <a href="https://yuzar-blog.netlify.app/posts/2022-12-29-emmeans2interactions/">Don’t Ignore Interactions - Unleash the Full Power of Models with {emmeans} R-package</a> oder <a href="https://yuzar-blog.netlify.app/posts/2022-11-29-emmeans/">{emmeans} Game-Changing R-package Squeezes Hidden Knowledge out of Models!</a>. <strong>DISCLAIMER:</strong> Der Text ist gut, die Bebilderung des entsprechenden Videos geht so leider mal gar nicht…</p>
</div></div><section id="gruppenvergleiche-mit-emmeans-in-r" class="level3 page-columns page-full" data-number="32.5.1"><h3 data-number="32.5.1" class="anchored" data-anchor-id="gruppenvergleiche-mit-emmeans-in-r">
<span class="header-section-number">32.5.1</span> Gruppenvergleiche mit <code>emmeans</code> in R</h3>
<p>Um den multiplen Vergleich in <code>emmeans</code> durchführen zu können brauchen wir zuerst ein lineares Modell, was uns die notwenidgen Parameter wie Mittelwerte und Standardabweichungen liefert. Wir nutzen in unserem simplen Beispiel ein lineares Modell mit einer Einflussvariable <span class="math inline">\(x\)</span> und nehmen an, dass unser Outcome <span class="math inline">\(y\)</span> normalverteilt ist. Achtung, hier muss natürlich das <span class="math inline">\(x\)</span> ein Faktor sein. Dann können wir ganz einfach die Funktion <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> nutzen. Im Folgenden fitten wir das Modell <code>fit_2</code> was wir dann auch weiter nutzen werden.</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">jump_length</span> <span class="op">~</span> <span class="va">animal</span>, data <span class="op">=</span> <span class="va">fac1_tbl</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Der multiple Vergleich in <code>emmeans</code> ist mehrschrittig. Wir pipen unser Modell aus <code>fit_2</code> in die Funktion <code>emmeans()</code>. Wir geben mit <code>~ animal</code> an, dass wir über die Level des Faktors <code>animal</code> einen Vergleich rechnen wollen. Wir adjustieren die <span class="math inline">\(p\)</span>-Werte nach Bonferroni. Danach pipen wir weiter in die Funktion <code>contrast()</code> wo der eigentliche Vergleich festgelegt wird. In unserem Fall wollen wir einen <em>many-to-one</em> Vergleich rechnen. Alle Gruppen zu der Gruppe <code>fox</code>. Du kannst mit <code>ref =</code> auch ein anderes Level deines Faktors wählen.</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">comp_2_obj</span> <span class="op">&lt;-</span> <span class="va">fit_2</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">emmeans</span><span class="op">(</span><span class="op">~</span> <span class="va">animal</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">contrast</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"trt.vs.ctrl"</span>, ref <span class="op">=</span> <span class="st">"fox"</span>, adjust <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">comp_2_obj</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast  estimate    SE df t.ratio p.value
 dog - fox    -1.03 0.947 18  -1.086  0.5837
 cat - fox    -4.41 0.947 18  -4.660  0.0004

P value adjustment: bonferroni method for 2 tests </code></pre>
</div>
</div>
<p>Wir können auch einen anderen Kontrast wählen. Wir überschreiben jetzt das Objekt <code>comp_2_obj</code> mit dem Kontrast <em>all-pair</em>, der alle möglichen Vergleiche rechnet. In <code>emmeans</code> heißt der <em>all-pair</em> Kontrast <em>pairwise</em>.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Die Ausgabe von <code>emmeans</code> können über die Funktion <code>tidy()</code> aufgeräumt werden. Mehr dazu unter der <a href="https://broom.tidymodels.org/reference/tidy.emmGrid.html">Hilfeseite von <code>tidy</code>() zu emmeans</a>.</p>
</div></div><div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">comp_2_obj</span> <span class="op">&lt;-</span> <span class="va">fit_2</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">emmeans</span><span class="op">(</span><span class="op">~</span> <span class="va">animal</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">contrast</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"pairwise"</span>, adjust <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">comp_2_obj</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast  estimate    SE df t.ratio p.value
 dog - cat     3.39 0.947 18   3.574  0.0065
 dog - fox    -1.03 0.947 18  -1.086  0.8756
 cat - fox    -4.41 0.947 18  -4.660  0.0006

P value adjustment: bonferroni method for 3 tests </code></pre>
</div>
</div>
<p>Wir können das Ergebnis auch noch mit der Funktion <code>tidy()</code> weiter aufräumen und dann die Spalten selektieren, die wir brauchen. Häufig benötigen wir nicht alle Spalten, die eine Funktion wiedergibt.</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">res_2_obj</span> <span class="op">&lt;-</span> <span class="va">comp_2_obj</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tidy</span><span class="op">(</span>conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">contrast</span>, <span class="va">estimate</span>, <span class="va">adj.p.value</span>, <span class="va">conf.low</span>, <span class="va">conf.high</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="va">round</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res_2_obj</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  contrast  estimate adj.p.value conf.low conf.high
  &lt;chr&gt;        &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 dog - cat     3.39      0.0065    0.886      5.89
2 dog - fox    -1.03      0.876    -3.53       1.47
3 cat - fox    -4.41      0.0006   -6.91      -1.91</code></pre>
</div>
</div>
<p>Abschließend wollen wir noch die 95% Konfidenzintervalle in <a href="#fig-emmeans-1">Abbildung&nbsp;<span>32.4</span></a> abbilden. Hier ist es bei <code>emmeans</code> genauso wie bei <code>multcomp</code>. Wir können das Objekt <code>res_2_obj</code> direkt in <code>ggplot()</code> weiterverwenden und uns die 95% Konfidenzintervalle einmal plotten.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  <span class="fu">ggplot</span><span class="op">(</span><span class="va">res_2_obj</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">contrast</span>, y<span class="op">=</span><span class="va">estimate</span>, ymin<span class="op">=</span><span class="va">conf.low</span>, ymax<span class="op">=</span><span class="va">conf.high</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_hline</span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">0</span>, linetype<span class="op">=</span><span class="st">"11"</span>, colour<span class="op">=</span><span class="st">"grey60"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_errorbar</span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-emmeans-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-tests-posthoc_files/figure-html/fig-emmeans-1-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption class="figure-caption">Abbildung&nbsp;32.4— Die 95% Konfidenzintervalle für den <em>allpair</em>-Vergleich des simplen Datensatzes.</figcaption></figure>
</div>
</div>
</div>
<p>In <a href="#fig-emmeans-3">Abbildung&nbsp;<span>32.5</span></a> sehen wir die Ergebnisse des multiplen Vergleiches nochmal anders als <em>Pairwise P-value plot</em> dargestellt. Wir haben auf der y-Achse zu Abwechselung mal die Gruppen dargestellt und auf der x-Achse die <span class="math inline">\(p\)</span>-Werte. In den Kästchen sind die Effekte der Gruppen nochmal gezeigt. In unserem Fall die Mittelwerte der Sprungweiten für die drei Gruppen. Wir sehen jetzt immer den <span class="math inline">\(p\)</span>-Wert für den jeweiligen Vergleich durch eine farbige Linie miteinander verbunden. So können wir nochmal eine andere Übersicht über das Ergebnis des multiplen Vergleich kriegen.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_2</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">emmeans</span><span class="op">(</span><span class="op">~</span> <span class="va">animal</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pwpp</span><span class="op">(</span>adjust <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-emmeans-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-tests-posthoc_files/figure-html/fig-emmeans-3-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption class="figure-caption">Abbildung&nbsp;32.5— Visualisierung der Ergebnisse im Pairwise P-value plot.</figcaption></figure>
</div>
</div>
</div>
<p>Auch haben wir die Möglichkeit un die <span class="math inline">\(p\)</span>-Werte mit der Funktion <code>pwpm()</code> als eine Matrix ausgeben zu lassen. Wir erhalten in dem oberen Triangel die <span class="math inline">\(p\)</span>-Wert für den jeweiligen Vergleich. In dem unteren Triangel die geschätzten Mittelwertsunterschiede. Auf der Diagonalen dann die geschätzten Mittelwerte für die jeweilige Gruppe. So haben wir nochmal alles sehr kompakt zusammen dargestellt.</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_2</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">emmeans</span><span class="op">(</span><span class="op">~</span> <span class="va">animal</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pwpm</span><span class="op">(</span>adjust <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       dog    cat    fox
dog [8.13] 0.0065 0.8756
cat   3.39 [4.74] 0.0006
fox  -1.03  -4.41 [9.16]

Row and column labels: animal
Upper triangle: P values   adjust = "bonferroni"
Diagonal: [Estimates] (emmean) 
Lower triangle: Comparisons (estimate)   earlier vs. later</code></pre>
</div>
</div>
<p>Wir wollen uns noch einen etwas komplizierteren Fall anschauen, indem sich <code>emmeans</code> von <code>multcomp</code> in der Anwendung unterscheidet. Wir laden den Datensatz <code>flea_dog_cat_fox_site.csv</code> in dem wir <em>zwei</em> Faktoren haben. Damit können wir dann ein Modell mit einem Interaktionsterm bauen. Wir erinnern uns, dass wir in der zweifaktoriellen ANOAV eine signifikante Interaktion zwischen den beiden Faktoren <code>animal</code> und <code>site</code> festgestelt hatten.</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fac2_tbl</span> <span class="op">&lt;-</span> <span class="fu">read_csv2</span><span class="op">(</span><span class="st">"data/flea_dog_cat_fox_site.csv"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">animal</span>, <span class="va">site</span>, <span class="va">jump_length</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>animal <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">animal</span><span class="op">)</span>,</span>
<span>         site <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">site</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir erhalten das Objekt <code>fac2_tbl</code> mit dem Datensatz in <a href="#tbl-data-emmeans-1">Tabelle&nbsp;<span>32.2</span></a> nochmal dargestellt.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-data-emmeans-1" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tabelle&nbsp;32.2— Selektierter Datensatz mit einer normalverteilten Variable <code>jump_length</code> und einem Faktor <code>animal</code> mit drei Leveln sowie dem Faktor <code>site</code> mit vier Leveln.</caption>
<thead><tr class="header">
<th style="text-align: center;">animal</th>
<th style="text-align: center;">site</th>
<th style="text-align: center;">jump_length</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">12.04</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">11.98</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">16.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">13.42</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">12.37</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">16.36</td>
</tr>
<tr class="odd">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">field</td>
<td style="text-align: center;">16.38</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">field</td>
<td style="text-align: center;">14.59</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">field</td>
<td style="text-align: center;">14.03</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">field</td>
<td style="text-align: center;">13.63</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">field</td>
<td style="text-align: center;">14.09</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">field</td>
<td style="text-align: center;">15.52</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>In <a href="#fig-boxplot-emmeans-1">Abbildung&nbsp;<span>32.6</span></a> sehen wir nochmal die Daten visualisiert. Wichtig ist hier, dass wir <em>zwei</em> Faktoren vorliegen haben. Den Faktor <code>animal</code> und den Faktor <code>site</code>. Dabei ist der Faktor <code>animal</code> in dem Faktor <code>site</code> genested. Wir messen jedes Level des Faktors <code>animal</code> jeweils in jedem Level des Faktors <code>site</code>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-boxplot-emmeans-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-tests-posthoc_files/figure-html/fig-boxplot-emmeans-1-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Abbildung&nbsp;32.6— Boxplot der Sprungweiten [cm] von Hunden und Katzen gemessen an verschiedenen Orten.</figcaption></figure>
</div>
</div>
</div>
<p>Wir rechnen ein multiples lineares Modell mit einem Interaktionsterm. Daher packen wir beide Faktoren in das Modell sowie die Intraktion zwischen den beiden Faktoren. Wir erhalten nach dem fitten des Modells das Objekt <code>fit_3</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">jump_length</span> <span class="op">~</span> <span class="va">animal</span> <span class="op">+</span> <span class="va">site</span> <span class="op">+</span> <span class="va">animal</span><span class="op">:</span><span class="va">site</span>, data <span class="op">=</span> <span class="va">fac2_tbl</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Der Unterschied zu unserem vorherigen multiplen Vergleich ist nun, dass wir auch einen multiplen Vergleich für <em>animal nested in site</em> rechnen können. Dafür müssen wir den Vergleich in der Form <code>animal | site</code> schreiben. Wir erhalten dann die Vergleiche der Level des faktors <code>animal</code> <em>getrennt</em> für die Level es Faktors <code>site</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">comp_3_obj</span> <span class="op">&lt;-</span> <span class="va">fit_3</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">emmeans</span><span class="op">(</span><span class="op">~</span> <span class="va">animal</span> <span class="op">|</span> <span class="va">site</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">contrast</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"pairwise"</span>, adjust <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">comp_3_obj</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>site = city:
 contrast  estimate    SE  df t.ratio p.value
 cat - dog   -3.101 0.771 108  -4.022  0.0003
 cat - fox   -6.538 0.771 108  -8.479  &lt;.0001
 dog - fox   -3.437 0.771 108  -4.457  0.0001

site = smalltown:
 contrast  estimate    SE  df t.ratio p.value
 cat - dog   -4.308 0.771 108  -5.587  &lt;.0001
 cat - fox   -4.064 0.771 108  -5.271  &lt;.0001
 dog - fox    0.244 0.771 108   0.316  1.0000

site = village:
 contrast  estimate    SE  df t.ratio p.value
 cat - dog   -1.316 0.771 108  -1.707  0.2722
 cat - fox   -1.729 0.771 108  -2.242  0.0809
 dog - fox   -0.413 0.771 108  -0.536  1.0000

site = field:
 contrast  estimate    SE  df t.ratio p.value
 cat - dog   -0.982 0.771 108  -1.274  0.6167
 cat - fox    1.366 0.771 108   1.772  0.2379
 dog - fox    2.348 0.771 108   3.045  0.0088

P value adjustment: bonferroni method for 3 tests </code></pre>
</div>
</div>
<p>Wir können uns das Ergebnis auch etwas schöner ausgeben lassen. Wir nutzen hier noch die Funktion <code><a href="https://rdrr.io/r/base/format.pval.html">format.pval()</a></code> um die <span class="math inline">\(p\)</span>-Werte besser zu formatieren. Die <span class="math inline">\(p\)</span>-Wert, die kleiner sind als 0.001 werden als <code>&lt;0.001</code> ausgegeben und die anderen <span class="math inline">\(p\)</span>-Werte auf zwei Nachstellen nach dem Komma gerundet.</p>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">comp_3_obj</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="va">summary</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="va">as_tibble</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">contrast</span>, <span class="va">site</span>, <span class="va">p.value</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>p.value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="va">p.value</span>, eps <span class="op">=</span> <span class="fl">0.001</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 3
   contrast  site      p.value
   &lt;fct&gt;     &lt;fct&gt;     &lt;chr&gt;  
 1 cat - dog city      &lt;0.001 
 2 cat - fox city      &lt;0.001 
 3 dog - fox city      &lt;0.001 
 4 cat - dog smalltown &lt;0.001 
 5 cat - fox smalltown &lt;0.001 
 6 dog - fox smalltown 1.00   
 7 cat - dog village   0.27   
 8 cat - fox village   0.08   
 9 dog - fox village   1.00   
10 cat - dog field     0.62   
11 cat - fox field     0.24   
12 dog - fox field     0.01   </code></pre>
</div>
</div>
<p>In der Ausgabe können wir erkennen, dass die Vergleich in der Stadt alle signifkant sind. Jedoch erkennen wir keine signifikanten Ergebnisse mehr in dem Dorf und im Feld ist nur der Vergleich <code>dog - fox</code> signifkant. Hier solltest du nochmal beachten, warum wir die Analyse getrennt machen. In der zweifaktoriellen ANOVA haben wir gesehen, dass ein signifkanter Interaktionsterm zwischen den beiden Faktoren <code>animal</code> und <code>site</code> vorliegt.</p>
<p>Wir wollen uns noch über die Funktion <code><a href="https://rdrr.io/r/stats/confint.html">confint()</a></code> die 95% Konfidenzintervalle wiedergeben lassen.</p>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">res_3_obj</span> <span class="op">&lt;-</span> <span class="va">comp_3_obj</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">contrast</span>, <span class="va">site</span>, <span class="va">estimate</span>, conf.low <span class="op">=</span> <span class="va">lower.CL</span>, conf.high <span class="op">=</span> <span class="va">upper.CL</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">res_3_obj</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 5
   contrast  site      estimate conf.low conf.high
   &lt;fct&gt;     &lt;fct&gt;        &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
 1 cat - dog city        -3.10    -4.98     -1.23 
 2 cat - fox city        -6.54    -8.41     -4.66 
 3 dog - fox city        -3.44    -5.31     -1.56 
 4 cat - dog smalltown   -4.31    -6.18     -2.43 
 5 cat - fox smalltown   -4.06    -5.94     -2.19 
 6 dog - fox smalltown    0.244   -1.63      2.12 
 7 cat - dog village     -1.32    -3.19      0.559
 8 cat - fox village     -1.73    -3.60      0.146
 9 dog - fox village     -0.413   -2.29      1.46 
10 cat - dog field       -0.982   -2.86      0.893
11 cat - fox field        1.37    -0.509     3.24 
12 dog - fox field        2.35     0.473     4.22 </code></pre>
</div>
</div>
<p>Besonders mit den 95% Konfiendezintervallen sehen wir nochmal den Interaktionseffekt zwischen den beiden Faktoren <code>animal</code> und <code>site</code>. So dreht sich der Effekt von zum Beispiel <code>dog - fox</code> von <span class="math inline">\(-3.44\)</span> in dem Level <code>city</code> zu <span class="math inline">\(+2.35\)</span> in dem Level <code>field</code>. Wir haben eine Interaktion vorliegen und deshalb die Analyse getrennt für jeden Level des Faktors <code>site</code> durchgeführt.</p>
<p><a href="#fig-emmeans-2">Abbildung&nbsp;<span>32.7</span></a> zeigt die entsprechenden 95% Konfidenzintervalle. Wir müssen hier etwas mit der <code>position</code> spielen, so dass die Punkte und der <code>geom_errorbar</code> richtig liegen.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  <span class="fu">ggplot</span><span class="op">(</span><span class="va">res_3_obj</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">contrast</span>, y<span class="op">=</span><span class="va">estimate</span>, ymin<span class="op">=</span><span class="va">conf.low</span>, ymax<span class="op">=</span><span class="va">conf.high</span>,</span>
<span>                        color <span class="op">=</span> <span class="va">site</span>, group <span class="op">=</span> <span class="va">site</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_hline</span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">0</span>, linetype<span class="op">=</span><span class="st">"11"</span>, colour<span class="op">=</span><span class="st">"grey60"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_errorbar</span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.1</span>, position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_point</span><span class="op">(</span>position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_color_okabeito</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-emmeans-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-tests-posthoc_files/figure-html/fig-emmeans-2-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption class="figure-caption">Abbildung&nbsp;32.7— Die 95% Konfidenzintervalle für den <em>allpair</em>-Vergleich des Models mit Interaktionseffekt.</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="gruppenvergleich-unter-varianzheterogenität" class="level2" data-number="32.6"><h2 data-number="32.6" class="anchored" data-anchor-id="gruppenvergleich-unter-varianzheterogenität">
<span class="header-section-number">32.6</span> Gruppenvergleich unter Varianzheterogenität</h2>
<p>Bis jetzt sind wir von Varianzhomogenität über alle Gruppen in unserer Behandlung ausgegangen. Oder aber konkret auf unser Beispiel, die Tierarten haben alle die gleiche Varianz. Jetzt gibt es aber häufiger mal den Fall, da können oder wollen wir nicht an Varianzhomogenität über alle Gruppen glauben. Deshalb gibt es hier noch Alternativen, von denen ich ein paar Vorstellen werde.</p>
<section id="sec-posthoc-ght" class="level3" data-number="32.6.1"><h3 data-number="32.6.1" class="anchored" data-anchor-id="sec-posthoc-ght">
<span class="header-section-number">32.6.1</span> Games-Howell-Test</h3>
<p>Der Games-Howell-Test ist eine Alternative zu dem Paket <code>multcomp</code> und dem Paket <code>emmeans</code> für ein einfaktorielles Design. Wir nutzen den Games-Howell-Test, wenn die Annahme der Homogenität der Varianzen, der zum Vergleich aller möglichen Kombinationen von Gruppenunterschieden verwendet wird, verletzt ist. Dieser Post-Hoc-Test liefert Konfidenzintervalle für die Unterschiede zwischen den Gruppenmitteln und zeigt, ob die Unterschiede statistisch signifikant sind. Der Test basiert auf der Welch’schen Freiheitsgradkorrektur und adjustiert die <span class="math inline">\(p\)</span>-Werte. Der Test vergleicht also die Differenz zwischen den einzelnen Mittelwertpaaren mit einer Adjustierung für den Mehrfachtest. Es besteht also keine Notwendigkeit, zusätzliche p-Wert-Korrekturen vorzunehmen. Mit dem Games-Howell-Test ist nur ein <em>all-pair</em> Vergleich möglich.</p>
<p>Für den Games-Howell-Test aus dem Paket <code>rstatix</code> müssen wir kein lineares Modell fitten. Wir schreiben einfach die wie in einem t-Test das Outcome und den Faktor mit den Gruppenleveln in die Funktion <code>games_howell_test()</code>. Wir erhalten dann direkt das Ergebnis des Games-Howell-Test. Wir nutzen in diesem Beispiel die Daten aus dem Objekt <code>fac1_tbl</code> zu sehen in <a href="#tbl-data-posthoc-1">Tabelle&nbsp;<span>32.1</span></a>.</p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_4</span> <span class="op">&lt;-</span> <span class="fu">games_howell_test</span><span class="op">(</span><span class="va">jump_length</span> <span class="op">~</span> <span class="va">animal</span>, data <span class="op">=</span> <span class="va">fac1_tbl</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir wollen aber nicht mit der Ausgabe arbeiten sondern machen uns noch ein wenig Arbeit und passen die Ausgabe an. Zum einen brauchen wir noch die Kontraste und wir wollen die <span class="math inline">\(p\)</span>-Werte auch ansprechend formatieren. Wir erhalten das Objekt <code>res_4_obj</code> und geben uns die Ausgabe wieder.</p>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">res_4_obj</span> <span class="op">&lt;-</span> <span class="va">fit_4</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="va">as_tibble</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>contrast <span class="op">=</span> <span class="fu">str_c</span><span class="op">(</span><span class="va">group1</span>, <span class="st">"-"</span>, <span class="va">group2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">contrast</span>, <span class="va">estimate</span>, <span class="va">p.adj</span>, <span class="va">conf.low</span>, <span class="va">conf.high</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>p.adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="va">p.adj</span>, eps <span class="op">=</span> <span class="fl">0.001</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res_4_obj</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  contrast estimate p.adj conf.low conf.high
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 dog-cat     -3.39 0.02     -6.28    -0.490
2 dog-fox      1.03 0.52     -1.52     3.57 
3 cat-fox      4.41 0.00      2.12     6.71 </code></pre>
</div>
</div>
<p>Wir erhalten ein <code>tibble()</code> mit fünf Spalten. Zum einen den <code>contrast</code>, der den Vergleich widerspiegelt, den haben wir uns selber mit der Funktion <code>mutate()</code> und <code>str_c()</code> aus den Spalten <code>group1</code> und <code>group2</code> gebaut. Wir vergleichen im ersten Kontrast die Katzen- mit den Hundeflöhen, wobei wir <code>dog-cat</code> rechnen. Also wirklich den Mittelwert der Sprungweite der Hundeflöhe <em>minus</em> den Mittelwert der Sprungweite der Katzenflöhe rechnen. In der Spalte <code>estimate</code> sehen wir den Mittelwertsunterschied. Der Mittelwertsunterschied ist in der <em>Richtung</em> nicht ohne den Kontrast zu interpretieren. Danach erhalten wir die adjustierten <span class="math inline">\(p\)</span>-Wert sowie die simultanen 95% Konfidenzintervalle.</p>
<p>Wir können die Nullhypothese ablehnen für den Vergleiche <code>dog - cat</code> mit einem p-Wert von <span class="math inline">\(0.02\)</span> sowie für den Vergleich <span class="math inline">\(cat - fox\)</span> mit einem p-Wert von <span class="math inline">\(0.00\)</span>. Beide p-Werte liegen unter dem Signifikanzniveau von <span class="math inline">\(\alpha\)</span> gleich 5%.</p>
<p>In <a href="#fig-ght-1">Abbildung&nbsp;<span>32.8</span></a> sind die simultanen 95% Konfidenzintervalle nochmal in einem <code>ggplot</code> visualisiert. Die Kontraste und die Position hängen von dem Faktorlevel ab.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  <span class="fu">ggplot</span><span class="op">(</span><span class="va">res_4_obj</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">contrast</span>, y<span class="op">=</span><span class="va">estimate</span>, ymin<span class="op">=</span><span class="va">conf.low</span>, ymax<span class="op">=</span><span class="va">conf.high</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_hline</span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">0</span>, linetype<span class="op">=</span><span class="st">"11"</span>, colour<span class="op">=</span><span class="st">"grey60"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_errorbar</span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.1</span>, position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_point</span><span class="op">(</span>position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ght-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-tests-posthoc_files/figure-html/fig-ght-1-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption class="figure-caption">Abbildung&nbsp;32.8— Die 95% Konfidenzintervalle für den <em>allpair</em>-Vergleich des Games-Howell-Test.</figcaption></figure>
</div>
</div>
</div>
<p>Die Entscheidungen nach den 95% Konfidenzintervallen sind die gleichen wie nach dem <span class="math inline">\(p\)</span>-Wert. Da wir hier es mit einem Mittelwertsvergleich zu tun haben, ist die Entscheidung gegen die Nullhypothese zu treffen wenn die 0 im Konfidenzintervall ist.</p>
</section><section id="generalized-least-squares" class="level3" data-number="32.6.2"><h3 data-number="32.6.2" class="anchored" data-anchor-id="generalized-least-squares">
<span class="header-section-number">32.6.2</span> Generalized Least Squares</h3>
<p>Neben dem Games-Howell-Test gibt es auch die Möglichkeit <em>Generalized Least Squares</em> zu nutzen. Hier haben wir dann auch die Möglichkeit mehrfaktorielle Modelle zu schätzen und dann auch wieder <code>emmeans</code> zu nutzen. Das ist natürlich super, weil wir dann wieder in dem <code>emmeans</code> Framework sind und alle Funktionen von oben nutzen können. Deshalb hier auch nur die Modellanpassung, den Rest kopierst du dir dann von oben dazu.</p>
<p>Die Funktion <code>gls()</code> aus dem R Paket <code>nlme</code> passt ein lineares Modell unter Verwendung der verallgemeinerten kleinsten Quadrate an. Die Fehler dürfen dabei aber korreliert oder aber ungleiche Varianzen haben. Damit haben wir ein Modell, was wir nutzen können, wenn wir Varianzheterogenität vorliegen haben. Hier einmal das simple Beispiel für die Tierarten. Wir nehmen wieder die ganz normale Formelschreiweise. Wir können jetzt aber über die Option <code>weights =</code> angeben, wie wir die Varianz modellieren wollen. Die Schreibweise mag etwas ungewohnt sein, aber es gibt wirklich viele Arten die Varainz zu modellieren. Hier machen wir uns es einfach und nutzen die Helferfunktion <code>varIdent</code> und modellieren dann für jedes Tier eine eigene Gruppenvarianz.</p>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gls_fac1_fit</span> <span class="op">&lt;-</span> <span class="fu">gls</span><span class="op">(</span><span class="va">jump_length</span> <span class="op">~</span> <span class="va">animal</span>, </span>
<span>                    weights <span class="op">=</span> <span class="fu">varIdent</span><span class="op">(</span>form <span class="op">=</span>  <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">animal</span><span class="op">)</span>, </span>
<span>                    data <span class="op">=</span> <span class="va">fac1_tbl</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Dann können wir die Modellanpasssung auch schon in <code>emmeans()</code> weiterleiten und schauen uns mal das Ergebnis gleich an. Wir achten jetzt auf die Spalte <code>SE</code>, die uns ja den Fehler der Mittelwerte für jede Gruppe wiedergibt.</p>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gls_fac1_fit</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">emmeans</span><span class="op">(</span><span class="op">~</span> <span class="va">animal</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> animal emmean    SE   df lower.CL upper.CL
 dog      8.13 0.811 6.01     6.15     10.1
 cat      4.74 0.719 6.01     2.98      6.5
 fox      9.16 0.415 6.00     8.14     10.2

Degrees-of-freedom method: satterthwaite 
Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Wir sehen, dass wir für jedes Tier eine eigene Varianz über den Standardfehler <code>SE</code> geschätzt haben. Das war es ja auch was wir wollten. Bis hierhin wäre es auch mit dem Games-Howell-Test gegangen. Was ist aber, wenn wir ein zweifaktorielles design mit Interaktion schätzen wollen? Das können wir analog wie eben machen. Wir erweitern einfach das Modell um die Terme <code>site</code> für den zweiten Faktor und den Interaktionsterm <code>animal:site</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gls_fac2_fit</span> <span class="op">&lt;-</span> <span class="fu">gls</span><span class="op">(</span><span class="va">jump_length</span> <span class="op">~</span> <span class="va">animal</span> <span class="op">+</span> <span class="va">site</span> <span class="op">+</span> <span class="va">animal</span><span class="op">:</span><span class="va">site</span>, </span>
<span>                    weights <span class="op">=</span> <span class="fu">varIdent</span><span class="op">(</span>form <span class="op">=</span>  <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">animal</span><span class="op">)</span>, </span>
<span>                    data <span class="op">=</span> <span class="va">fac2_tbl</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Dann können wir uns wieder die multiplen Vergleiche getrennt für die Interaktionsterme wiedergeben lassen. Blöderweise haben jetzt alle Messorte <code>site</code> die gleiche Varianz für jede Tierart, aber auch da können wir noch ran.</p>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gls_fac2_fit</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">emmeans</span><span class="op">(</span><span class="op">~</span> <span class="va">animal</span> <span class="op">|</span> <span class="va">site</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>site = city:
 animal emmean    SE   df lower.CL upper.CL
 cat      13.6 0.603 36.0     12.4     14.8
 dog      16.7 0.581 36.1     15.5     17.9
 fox      20.1 0.437 36.0     19.2     21.0

site = smalltown:
 animal emmean    SE   df lower.CL upper.CL
 cat      13.7 0.603 36.0     12.5     15.0
 dog      18.0 0.581 36.1     16.9     19.2
 fox      17.8 0.437 36.0     16.9     18.7

site = village:
 animal emmean    SE   df lower.CL upper.CL
 cat      15.2 0.603 36.0     14.0     16.5
 dog      16.6 0.581 36.1     15.4     17.7
 fox      17.0 0.437 36.0     16.1     17.9

site = field:
 animal emmean    SE   df lower.CL upper.CL
 cat      16.2 0.603 36.0     15.0     17.4
 dog      17.2 0.581 36.1     16.0     18.3
 fox      14.8 0.437 36.0     13.9     15.7

Degrees-of-freedom method: satterthwaite 
Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Die eigentliche Stärke von <code>gls()</code> kommt eigentlich erst zu tragen, wenn wir auch noch erlauben, dass wir die Varianz <em>über alle</em> Tierarten, Messsorte und Interaktionen variieren kann. Das machen wir, in dem wir einfach <code>animal*site</code> zu der <code>varIdent()</code> Funktion ergänzen.</p>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gls_fac2_fit</span> <span class="op">&lt;-</span> <span class="fu">gls</span><span class="op">(</span><span class="va">jump_length</span> <span class="op">~</span> <span class="va">animal</span> <span class="op">+</span> <span class="va">site</span> <span class="op">+</span> <span class="va">animal</span><span class="op">:</span><span class="va">site</span>, </span>
<span>                    weights <span class="op">=</span> <span class="fu">varIdent</span><span class="op">(</span>form <span class="op">=</span>  <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">animal</span><span class="op">*</span><span class="va">site</span><span class="op">)</span>, </span>
<span>                    data <span class="op">=</span> <span class="va">fac2_tbl</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Dann noch schnell in <code>emmeans()</code> gesteckt und sich das Ergebnis angeschaut.</p>
<div class="cell">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gls_fac2_fit</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">emmeans</span><span class="op">(</span><span class="op">~</span> <span class="va">animal</span> <span class="op">|</span> <span class="va">site</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>site = city:
 animal emmean    SE   df lower.CL upper.CL
 cat      13.6 0.594 7.87     12.2     15.0
 dog      16.7 0.713 8.86     15.1     18.3
 fox      20.1 0.365 9.00     19.3     20.9

site = smalltown:
 animal emmean    SE   df lower.CL upper.CL
 cat      13.7 0.433 8.99     12.8     14.7
 dog      18.0 0.614 9.53     16.7     19.4
 fox      17.8 0.433 8.98     16.8     18.8

site = village:
 animal emmean    SE   df lower.CL upper.CL
 cat      15.2 0.743 8.93     13.6     16.9
 dog      16.6 0.384 9.00     15.7     17.4
 fox      17.0 0.548 8.71     15.7     18.2

site = field:
 animal emmean    SE   df lower.CL upper.CL
 cat      16.2 0.601 6.66     14.8     17.6
 dog      17.2 0.563 8.38     15.9     18.5
 fox      14.8 0.378 9.00     14.0     15.7

Degrees-of-freedom method: satterthwaite 
Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Wie du jetzt siehst schätzen wir die Varianz für jede Tierart und jeden Messort separat. Wir haben also wirklich jede Varianz einzeln zugeordnet. Die Frage ist immer, ob das notwendig ist, denn wir brauchen auch eine gewisse Fallzahl, damit die Modelle funktionieren. Aber das kommt jetzt sehr auf deine Fragestellung an und müssten wir nochmal konkret besprechen.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Weitere Literatur
</div>
</div>
<div class="callout-body-container callout-body">
<p>Auf der Seite DSFAIR gibt es noch einen Artikel zu <code>emmeans</code> und der Frage <a href="https://schmidtpaul.github.io/dsfair_quarto/ch/summaryarticles/whyseequal.html">Why are the StdErr all the same?</a> und dazu dann auch passend die Publikation <a href="https://www.cambridge.org/core/services/aop-cambridge-core/content/view/92DB0AF151C157B9C6E2FA40F9C9B635/S0014479719000401a.pdf/analyzing-designed-experiments-should-we-report-standard-deviations-or-standard-errors-of-the-mean-or-standard-errors-of-the-difference-or-what.pdf">Analyzing designed experiments: Should we report standard deviations or standard errors of the mean or standard errors of the difference or what?</a></p>
</div>
</div>
</section><section id="robuste-schätzung-von-standardfehlern" class="level3" data-number="32.6.3"><h3 data-number="32.6.3" class="anchored" data-anchor-id="robuste-schätzung-von-standardfehlern">
<span class="header-section-number">32.6.3</span> Robuste Schätzung von Standardfehlern</h3>
<p>Wir immer gibt es noch eine Möglichkeit die Varianzheterogenität zu behandeln. Wir nutzen jetzt hier einmal die Funktionen aus dem R Paket <code>sandwich</code>, die es uns ermöglichen Varianzheterogenität (eng. <em>heteroskedasticity</em>) zu modellieren. Es ist eigentlich super einfach, wir müssen als erstes wieder unser Modell anpassen. Hier einmal mit einer simplen linearen Regression.</p>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lm_fac1_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">jump_length</span> <span class="op">~</span> <span class="va">animal</span>, data <span class="op">=</span> <span class="va">fac1_tbl</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Dann können wir auch schon für einen Gruppenvergleich direkt in der Funktion <code>emmeans</code> für die Varianzheterogenität adjustieren. Es gibt verschiedene mögliche Sandwich-Schätzer, aber wir nehmen jetzt mal einen der häufigsten mit <code>vcovHC</code>. Wie immer gilt, es gibt ja nach Datenlage bessere und schlechtere Schätzer. Wir laden jetzt nicht das ganze Paket, sondern nur die Funktion mit <code><a href="https://sandwich.R-Forge.R-project.org/reference/vcovHAC.html">sandwich::vcovHAC</a></code>. Achtung, hinter der Option <code>vcov.</code> ist ein <em>Punkt</em>. Ohne den Aufruf <code>vcov. =</code> funktioniert die Funktion dann nicht.</p>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">em_obj</span> <span class="op">&lt;-</span> <span class="va">lm_fac1_fit</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">emmeans</span><span class="op">(</span><span class="op">~</span> <span class="va">animal</span>, method <span class="op">=</span> <span class="st">"pairwise"</span>, vcov. <span class="op">=</span> <span class="fu">sandwich</span><span class="fu">::</span><span class="va"><a href="https://sandwich.R-Forge.R-project.org/reference/vcovHAC.html">vcovHAC</a></span><span class="op">)</span></span>
<span><span class="va">em_obj</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> animal emmean    SE df lower.CL upper.CL
 dog      8.13 0.633 18     6.80     9.46
 cat      4.74 0.810 18     3.04     6.44
 fox      9.16 0.468 18     8.17    10.14

Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Wir du siehst, die Standardfehler sind jetzt nicht mehr über alle Gruppen gleich. Dann können wir uns auch die paarweisen Vergleiche ausgeben lassen.</p>
<div class="cell">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">contr_obj</span> <span class="op">&lt;-</span> <span class="va">em_obj</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">contrast</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"pairwise"</span>, adjust <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Oder aber wir lassen uns das <em>compact letter display</em> wiedergeben.</p>
<div class="cell">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cld_obj</span> <span class="op">&lt;-</span> <span class="va">em_obj</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">cld</span><span class="op">(</span>Letters <span class="op">=</span> <span class="va">letters</span>, adjust <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exkurs: Robuste Schätzung von Standardfehlern, Konfidenzintervallen und p-Werten
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Wenn du noch etwas weiter gehen möchtest, dann kannst du dir noch die Hilfeseite von dem R Paket <code>performance</code> <a href="https://easystats.github.io/parameters/articles/model_parameters_robust.html?q=Heteroskedasticity#robust-covariance-matrix-estimation-from-model-parameters">Robust Estimation of Standard Errors, Confidence Intervals, and p-values</a> anschauen. Die Idee ist hier, dass wir die Varianz/Kovarianz robuster daher mit der Berücksichtigung von Varianzheterogenität (eng. <em>heteroskedasticity</em>) schätzen.</p>
</div>
</div>
</div>
</section></section><section id="sec-compact-letter" class="level2 page-columns page-full" data-number="32.7"><h2 data-number="32.7" class="anchored" data-anchor-id="sec-compact-letter">
<span class="header-section-number">32.7</span> Compact letter display</h2>
<p>In der Pflanzenernährung ist es nicht unüblich sehr viele Substrate miteinander zu vergleichen. Oder andersherum, wenn wir sehr viele Gruppen haben, dann kann die Darstellung in einem <em>all-pair</em> Vergleich sehr schnell sehr unübersichltich werden. Deshalb wure das <em>compact letter display</em> entwickelt.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p><a href="https://schmidtpaul.github.io/DSFAIR/compactletterdisplay.html">Compact Letter Display (CLD) - What is it?</a>. Das <em>compact letter display</em> zeigt an, bei welchen Vergleichen der Behandlungen die Nullhypothese gilt. Daher werden die <em>nicht</em> signifikanten Ergebnisse visualisiert.</p>
</div></div><p>Schauen wir uns aber zurerst einmal ein größeres Beispiel mit neun Behandlungen mit jeweils zwanzig Beobachtungen an. Wir erstellen uns den Datensatz in der Form, dass sich die Mittelwerte für die Behandlungen teilweise unterscheiden.</p>
<div class="cell">
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">20220914</span><span class="op">)</span></span>
<span><span class="va">data_tbl</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/gl.html">gl</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">9</span>, k <span class="op">=</span> <span class="fl">20</span>, </span>
<span>                            labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pos_crtl"</span>, <span class="st">"neg_ctrl"</span>, <span class="st">"treat_A"</span>, <span class="st">"treat_B"</span>, </span>
<span>                                       <span class="st">"treat_C"</span>, <span class="st">"treat_D"</span>, <span class="st">"treat_E"</span>, <span class="st">"treat_F"</span>, </span>
<span>                                       <span class="st">"treat_G"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   rsp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">10</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">22</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">24</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">35</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">37</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">43</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">50</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In der <a href="#fig-boxplot-cld-1">Abbildung&nbsp;<span>32.9</span></a> ist der Datensatz <code>data_tbl</code> nochmal als Boxplot dargestellt.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-boxplot-cld-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-tests-posthoc_files/figure-html/fig-boxplot-cld-1-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Abbildung&nbsp;32.9— Boxplot der Beispieldaten.</figcaption></figure>
</div>
</div>
</div>
<p>Wir sehen, dass sich die positive Kontrolle von dem Rest der Behandlungen unterscheidet. Danach haben wir ein Plateau mit der negativen Kontrolle und der Behanldung A und der Behandlung B. Nach diesem Plateau haben wir einen Sprung und sehen einen leicht linearen Anstieg der Mittelwerte der Behandlungen.</p>
<p>Schauen wir uns zuerst einmal an, wie ein <em>compact letter display</em> aussehen würde, wenn kein Effekt vorliegen würde. Daher die Nullhypothese ist wahr und die Mittelwerte der Gruppen unterscheiden sich nicht. Wir nutzen hier einmal ein kleineres Beispiel mit den Behandlungslevels <code>ctrl</code>, <code>treat_A</code> und <code>treat_B</code>. Alle drei Behandlungslevel haben einen Mittelwert von 10. Es gilt die Nullhypothese und wir erhalten folgendes <em>compact letter display</em> in <a href="#tbl-no-effect-cld">Tabelle&nbsp;<span>32.3</span></a>.</p>
<div id="tbl-no-effect-cld" class="anchored">
<table class="table">
<caption>Tabelle&nbsp;32.3— Das <em>compact letter display</em> für drei Behandlungen nach einem paarweisen Vergleich. Die Nullhypothese gilt, es gibt keinen Mittelwertsunterschied.</caption>
<colgroup>
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 21%">
<col style="width: 21%">
<col style="width: 21%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">Behandlung</th>
<th style="text-align: center;">Mittelwert</th>
<th style="text-align: center;"><span class="math inline">\(\phantom{a}\)</span></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">ctrl</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">a</td>
<td style="text-align: center;"><span class="math inline">\(\phantom{a}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\phantom{a}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">treat_A</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">a</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">treat_B</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">a</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
<p>Das Gegenteil sehen wir in der <a href="#tbl-effect-cld">Tabelle&nbsp;<span>32.4</span></a>. Hier haben wir ein <em>compact letter display</em> wo sich alle drei Mittelwerte mit 10, 15 und 20 voneinander klar unterscheiden. Die Nullhypothese gilt für keinen der möglichen paarweisen Vergleiche.</p>
<div id="tbl-effect-cld" class="anchored">
<table class="table">
<caption>Tabelle&nbsp;32.4— Das <em>compact letter display</em> für drei Behandlungen nach einem paarweisen Vergleich. Die Nullhypothese gilt nicht, es gibt einen Mittelwertsunterschied.</caption>
<colgroup>
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 21%">
<col style="width: 21%">
<col style="width: 21%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">Behandlung</th>
<th style="text-align: center;">Mittelwert</th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">ctrl</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">a</td>
<td style="text-align: center;"><span class="math inline">\(\phantom{a}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\phantom{a}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">treat_A</td>
<td style="text-align: center;">15</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">b</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">treat_B</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;"><span class="math inline">\(\phantom{a}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">c</td>
</tr>
</tbody>
</table>
</div>
<p>Schauen wir uns nun die Implementierung des <em>compact letter display</em> für die verschiedenen Möglichkeiten der Multiplen Vergleiche einmal an.</p>
<section id="für-pairwise..test" class="level3" data-number="32.7.1"><h3 data-number="32.7.1" class="anchored" data-anchor-id="für-pairwise..test">
<span class="header-section-number">32.7.1</span> … für <code>pairwise.*.test()</code>
</h3>
<p>Wenn wir für die Funktionen <code>pairwise.*.test()</code> das <em>compact letter display</em> berechnen wollen, dann müssen wir etwas ausholen. Denn wir müssen dafür die Funktion <code>multcompLetters()</code> nutzen. Diese Funktion braucht die <span class="math inline">\(p\)</span>-Werte als Matrix und diese Matrix der <span class="math inline">\(p\)</span>-Werte kriegen wir über die Funktion <code>fullPTable()</code>. Am Ende haben wir aber dann das was wir wollten. Ich habe hier nochmal das einfache Beispiel mit den Sprungweiten von oben genommen.</p>
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/pairwise.t.test.html">pairwise.t.test</a></span><span class="op">(</span><span class="va">fac1_tbl</span><span class="op">$</span><span class="va">jump_length</span>, <span class="va">fac1_tbl</span><span class="op">$</span><span class="va">animal</span>,</span>
<span>                p.adjust.method <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">extract2</span><span class="op">(</span><span class="st">"p.value"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">fullPTable</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">multcompLetters</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>dog cat fox 
"a" "b" "a" </code></pre>
</div>
</div>
<p>Als Ergebnis erhalten wir, dass Hund- und Fuchsflöhe gleich weit springen, beide teilen sich den gleichen Buchstaben. Katzenflöhe springen unterschiedlich zu Hunden- und Fuchsflöhen. Das Vorgehen ändert sich dann nicht, wenn wir eine andere Funktion wie <code><a href="https://rdrr.io/r/stats/pairwise.wilcox.test.html">pairwise.wilcox.test()</a></code> nehmen.</p>
</section><section id="für-das-paket-multcomp" class="level3 page-columns page-full" data-number="32.7.2"><h3 data-number="32.7.2" class="anchored" data-anchor-id="für-das-paket-multcomp">
<span class="header-section-number">32.7.2</span> … für das Paket <code>multcomp</code>
</h3>
<p>Wir schauen uns zuerst einmal die Implementierung des <em>compact letter display</em> in dem Paket <code>multcomp</code> an. Wir nutzen die Funktion <code>multcompLetters()</code> aus dem Paket <code>multcompView</code> um uns das <em>compact letter display</em> wiedergeben zu lassen. Davor müssen wir noch einige Schritte an Sortierung und Umbenennung durchführen. Das hat den Grund, dass die Funktion <code>multcompLetters()</code> <em>nur</em> einen benannten Vektor mit <span class="math inline">\(p\)</span>-Werten akzeptiert. Das heist wir müssen aus der Funktion <code>glht()</code> die adjustierten <span class="math inline">\(p\)</span>-Werte extrahieren und dann einen Vektor der Vergleiche bzw. Kontraste in der Form <code>A-B</code> bauen. Also ohne Leerzeichen und in der Beschreibung der Level der Behandlung <code>trt</code>. Die Funktion <code>pull()</code> erlaubt uns einen Spalte als Vektor aus einem <code>tibble()</code> zu ziehen und dann nach der Spalte <code>contrast</code> zu benennen.</p>
<div class="cell">
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">multcomp_cld</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">rsp</span>  <span class="op">~</span> <span class="va">trt</span>, data <span class="op">=</span> <span class="va">data_tbl</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">glht</span><span class="op">(</span>linfct <span class="op">=</span> <span class="fu">mcp</span><span class="op">(</span>trt <span class="op">=</span> <span class="st">"Tukey"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="va">tidy</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>contrast <span class="op">=</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="va">contrast</span>, <span class="st">"\\s"</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">adj.p.value</span>, <span class="va">contrast</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">multcompLetters</span><span class="op">(</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir erhalten dann folgendes <em>compact letter display</em> für die paarweisen Vergleiche aus <code>multcomp</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">multcomp_cld</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>neg_ctrl  treat_A  treat_B  treat_C  treat_D  treat_E  treat_F  treat_G 
     "a"      "a"      "a"      "b"     "bc"     "cd"      "d"      "e" 
pos_crtl 
     "f" </code></pre>
</div>
</div>
<p>Leider sind diese Buchstaben in dieser Form schwer zu verstehen. Deshalb gibt es noch die Funktion <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> in dem Paket <code>multcompView</code> um uns die Buchstaben mit den Leveln der Behandlung einmal ausgeben zu lassen. Wir erhalten dann folgende Abbildung.</p>
<div class="cell">
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">multcomp_cld</span> <span class="op">%&gt;%</span> <span class="va">plot</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="stat-tests-posthoc_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="">In dem <em>compact letter display</em> bedeuten gleiche Buchstaben, dass die Behandlungen gleich sind. Es gilt die Nullhypothese für diesen Vergleich.</span></div></div>
<p>Was sehen wir hier? Kombinieren wir einmal das <em>compact letter display</em> mit den Leveln der Behandlung und den Mittelwerten der Behandlungen in einer <a href="#tbl-mean-to-letter-multcomp">Tabelle&nbsp;<span>32.5</span></a>. Wenn die Mittelwerte <em>gleich</em> sind, dann erhalten die Behandlungslevel den gleichen Buchstaben. Die Mittelwerte vom <code>neg_ctrl</code>, <code>treat_A</code> und <code>treat_B</code> sind nahezu gleich, also damit nicht signifikant. Deshalb erhalten diese Behandlungslevel ein <code>a</code>. Ebenso sind die MIttelwerte von <code>treat_C</code> und <code>treat_D</code> nahezu gleich, dehalb erhalten beide ein <code>b</code>. Das machen wir immer so weiter und konzentrieren uns also auf die <em>nicht</em> signifikanten Ergebnisse. Denn gleiche Buchstaben bedeuten, dass die Behandlungen gleich sind. Wir sehen hier also, bei welchen Vergleichen die Nullhypothese gilt.</p>
<div id="tbl-mean-to-letter-multcomp" class="anchored">
<table class="table">
<caption>Tabelle&nbsp;32.5— Kombination der Level der Behandlungen und deren Mittelwerte zur Generieung sowie dem <em>compact letter display</em> generiert aus den adjustierten <span class="math inline">\(p\)</span>-Werten aus <code>multcomp</code>. Gleiche Buchstaben bedeuten <em>kein</em> signifikanter Unterschied.</caption>
<thead><tr class="header">
<th style="text-align: center;">Behandlung</th>
<th style="text-align: center;">Mittelwert</th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">neg_ctrl</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">a</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">treat_A</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;">a</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">treat_B</td>
<td style="text-align: center;">24</td>
<td style="text-align: center;">a</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">treat_C</td>
<td style="text-align: center;">35</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">b</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">treat_D</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">b</td>
<td style="text-align: center;">c</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">treat_E</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">c</td>
<td style="text-align: center;">d</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">treat_F</td>
<td style="text-align: center;">43</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">d</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">treat_G</td>
<td style="text-align: center;">45</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">e</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">pos_crtl</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">f</td>
</tr>
</tbody>
</table>
</div>
<p>Wir können dann die Buchstaben auch in den Boxplot ergaänzen. Die y-Position kann je nach Belieben dann noch angepasst werden. zum Beispiel könnten hier auch die Mittelwerte aus einer <code>summarise()</code> Funktion ergänzt werden und so die y-Position angepasst werden.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">letters_tbl</span> <span class="op">&lt;-</span> <span class="va">multcomp_cld</span><span class="op">$</span><span class="va">Letters</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">enframe</span><span class="op">(</span><span class="st">"trt"</span>, <span class="st">"label"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>rsp <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">data_tbl</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">trt</span>, y <span class="op">=</span> <span class="va">rsp</span>, </span>
<span>                     fill <span class="op">=</span> <span class="va">trt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_okabeito</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.15</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_text</span><span class="op">(</span>data <span class="op">=</span> <span class="va">letters_tbl</span>, </span>
<span>            <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">trt</span> , y <span class="op">=</span> <span class="va">rsp</span>, label <span class="op">=</span> <span class="va">label</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-boxplot-cld-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-tests-posthoc_files/figure-html/fig-boxplot-cld-2-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Abbildung&nbsp;32.10— Boxplot der Beispieldaten zusammen mit den <em>compact letter display</em>.</figcaption></figure>
</div>
</div>
</div>
</section><section id="für-das-paket-emmeans" class="level3" data-number="32.7.3"><h3 data-number="32.7.3" class="anchored" data-anchor-id="für-das-paket-emmeans">
<span class="header-section-number">32.7.3</span> … für das Paket <code>emmeans</code>
</h3>
<p>In dem Paket <code>emmeans</code> ist das <em>compact letter display</em> ebenfalls implementiert und wir müssen nicht die Funktion <code>multcompLetters()</code> nutzen. Durch die direkte Implementierung ist es etwas einfacher sich das <em>compact letter display</em> anzeigen zu lassen. Das Problem ist dann später sich die Buchstaben zu extrahieren um die <a href="#fig-boxplot-cld-3">Abbildung&nbsp;<span>32.11</span></a> zu ergänzen. Wir nutzen in <code>emmeans</code> die Funktion <code>cld()</code> um das <em>compact letter display</em> zu erstellen.</p>
<div class="cell">
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">emmeans_cld</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">rsp</span>  <span class="op">~</span> <span class="va">trt</span>, data <span class="op">=</span> <span class="va">data_tbl</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">emmeans</span><span class="op">(</span><span class="op">~</span> <span class="va">trt</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">cld</span><span class="op">(</span>Letters <span class="op">=</span> <span class="va">letters</span>, adjust <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir erhalten dann die etwas besser sortierte Ausgabe für die Behandlungen wieder.</p>
<div class="cell">
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">emmeans_cld</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> trt      emmean   SE  df lower.CL upper.CL .group 
 pos_crtl   9.67 1.12 171     6.51     12.8  a     
 neg_ctrl  20.02 1.12 171    16.86     23.2   b    
 treat_A   20.97 1.12 171    17.81     24.1   b    
 treat_B   23.35 1.12 171    20.19     26.5   b    
 treat_C   34.96 1.12 171    31.80     38.1    c   
 treat_D   37.46 1.12 171    34.30     40.6    cd  
 treat_E   40.17 1.12 171    37.01     43.3     de 
 treat_F   43.23 1.12 171    40.07     46.4      e 
 treat_G   50.51 1.12 171    47.35     53.7       f

Confidence level used: 0.95 
Conf-level adjustment: bonferroni method for 9 estimates 
P value adjustment: bonferroni method for 36 tests 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Wie die Ausgabe von <code>cld()</code> richtig anmerkt, können <em>compact letter display</em> irreführend sein weil sie eben <strong>Nicht</strong>-Unterschiede anstatt von signifikanten Unterschieden anzeigen. Zum Anderen sehen wir aber auch, dass wir 36 statistische Tests gerechnet haben und somit zu einem Signifikanzniveau von <span class="math inline">\(\cfrac{\alpha}{k} = \cfrac{0.05}{36} \approx 0.0014\)</span> testen. Wir brauchen also schon sehr große Unterschiede oder aber eine sehr kleine Streuung um hier signifikante Effekte nachweisen zu können.</p>
<p>In <a href="#tbl-mean-to-letter-emmeans">Tabelle&nbsp;<span>32.6</span></a> sehen wir das Ergebnis des <em>compact letter display</em> nochmal mit den Mittelwerten der Behandlungslevel zusammen dargestellt. Wir sehen wieder, dass sich <code>pos_crtl</code> von allen anderen Behandlungen unterscheidet, deshalb hat nur die Behandlung <code>pos_crtl</code> den Buchstaben <code>a</code>. Die Mittelwerte vom <code>neg_ctrl</code>, <code>treat_A</code> und <code>treat_B</code> sind nahezu gleich, also damit nicht signifikant. Deshalb erhalten diese Behandlungslevel ein <code>b</code>. Wir gehen so alle Vergleiche einmal durch.</p>
<div id="tbl-mean-to-letter-emmeans" class="anchored">
<table class="table">
<caption>Tabelle&nbsp;32.6— Kombination der Level der Behandlungen und deren Mittelwerte zur Generieung sowie dem <em>compact letter display</em> generiert aus den adjustierten <span class="math inline">\(p\)</span>-Werten aus <code>emmeans</code>. Gleiche Buchstaben bedeuten <em>kein</em> signifikanter Unterschied.</caption>
<thead><tr class="header">
<th style="text-align: center;">Behandlung</th>
<th style="text-align: center;">Mittelwert</th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">pos_crtl</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">a</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">neg_ctrl</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">b</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">treat_A</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">b</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">treat_B</td>
<td style="text-align: center;">24</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">b</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">treat_C</td>
<td style="text-align: center;">35</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">c</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">treat_D</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">c</td>
<td style="text-align: center;">d</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">treat_E</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">d</td>
<td style="text-align: center;">e</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">treat_F</td>
<td style="text-align: center;">43</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">e</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">treat_G</td>
<td style="text-align: center;">45</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">f</td>
</tr>
</tbody>
</table>
</div>
<p>Abschließend können wir die Buchstaben aus dem <em>compact letter display</em> noch in die <a href="#fig-boxplot-cld-3">Abbildung&nbsp;<span>32.11</span></a> ergänzen. Hier müssen wir etwas mehr machen um die Buchstaben aus dem Objekt <code>emmeans_cld</code> zu bekommen. Du kannst dann noch die y-Position anpassen wenn du möchtest.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">letters_tbl</span> <span class="op">&lt;-</span> <span class="va">emmeans_cld</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="va">tidy</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">trt</span>, label <span class="op">=</span> <span class="va">.group</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>rsp <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">data_tbl</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">trt</span>, y <span class="op">=</span> <span class="va">rsp</span>, </span>
<span>                     fill <span class="op">=</span> <span class="va">trt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_okabeito</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.15</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_text</span><span class="op">(</span>data <span class="op">=</span> <span class="va">letters_tbl</span>, </span>
<span>            <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">trt</span> , y <span class="op">=</span> <span class="va">rsp</span>, label <span class="op">=</span> <span class="va">label</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-boxplot-cld-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-tests-posthoc_files/figure-html/fig-boxplot-cld-3-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Abbildung&nbsp;32.11— Boxplot der Beispieldaten zusammen mit den <em>compact letter display</em>.</figcaption></figure>
</div>
</div>
</div>
</section><section id="für-den-games-howell-test" class="level3" data-number="32.7.4"><h3 data-number="32.7.4" class="anchored" data-anchor-id="für-den-games-howell-test">
<span class="header-section-number">32.7.4</span> … für den Games-Howell-Test</h3>
<p>Abschließend wollen wir uns die Implementierung des <em>compact letter display</em> für den Games-Howell-Test einmal anschauen. Es gilt vieles von dem in diesem Abschnitt schon gesagtes. Wir nutzen die Funktion <code>multcompLetters()</code> aus dem Paket <code>multcompView</code> um uns das <em>compact letter display</em> aus dem Games-Howell-Test wiedergeben zu lassen. Davor müssen wir noch einige Schritte an Sortierung und Umbenennung durchführen. Das hat den Grund, dass die Funktion <code>multcompLetters()</code> <em>nur</em> einen benannten Vektor mit <span class="math inline">\(p\)</span>-Werten akzeptiert. Die Funktion <code>pull()</code> erlaubt uns einen Spalte als Vektor aus einem <code>tibble()</code> zu ziehen und dann nach der Spalte <code>contrast</code> zu benennen.</p>
<div class="cell">
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ght_cld</span> <span class="op">&lt;-</span> <span class="fu">games_howell_test</span><span class="op">(</span><span class="va">rsp</span> <span class="op">~</span> <span class="va">trt</span>, data <span class="op">=</span> <span class="va">data_tbl</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>contrast <span class="op">=</span> <span class="fu">str_c</span><span class="op">(</span><span class="va">group1</span>, <span class="st">"-"</span>, <span class="va">group2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">p.adj</span>, <span class="va">contrast</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">multcompLetters</span><span class="op">(</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Das <em>compact letter display</em> kennen wir schon aus der obigen Beschreibung.</p>
<div class="cell">
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ght_cld</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>pos_crtl neg_ctrl  treat_A  treat_B  treat_C  treat_D  treat_E  treat_F 
     "a"      "b"      "b"      "b"      "c"     "cd"      "d"      "d" 
 treat_G 
     "e" </code></pre>
</div>
</div>
<p>Wir können uns dann auch das <em>compact letter display</em> als übersichtlicheren Plot wiedergeben lassen.</p>
<div class="cell">
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ght_cld</span> <span class="op">%&gt;%</span> <span class="va">plot</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="stat-tests-posthoc_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Um die Zusammenhänge besser zu verstehen ist in <a href="#tbl-mean-to-letter-ght">Tabelle&nbsp;<span>32.7</span></a> nochmal die Kombination der Level der Behandlungen und deren Mittelwerte zur Generieung sowie dem <em>compact letter display</em> dargestellt. Wir sehen wieder, dass sich <code>pos_crtl</code> von allen anderen Behandlungen unterscheidet, deshalb hat nur die Behandlung <code>pos_crtl</code> den Buchstaben <code>a</code>. Die Mittelwerte vom <code>neg_ctrl</code>, <code>treat_A</code> und <code>treat_B</code> sind nahezu gleich, also damit nicht signifikant. Deshalb erhalten diese Behandlungslevel ein <code>b</code>. In der Form können wir alle Vergleiche einmal durchgehen.</p>
<div id="tbl-mean-to-letter-ght" class="anchored">
<table class="table">
<caption>Tabelle&nbsp;32.7— Kombination der Level der Behandlungen und deren Mittelwerte zur Generieung sowie dem <em>compact letter display</em> generiert aus den adjustierten <span class="math inline">\(p\)</span>-Werten aus dem Games-Howell-Test. Gleiche Buchstaben bedeuten <em>kein</em> signifikanter Unterschied.</caption>
<thead><tr class="header">
<th style="text-align: center;">Behandlung</th>
<th style="text-align: center;">Mittelwert</th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">pos_crtl</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">a</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">neg_ctrl</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">b</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">treat_A</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">b</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">treat_B</td>
<td style="text-align: center;">24</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">b</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">treat_C</td>
<td style="text-align: center;">35</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">c</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">treat_D</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">c</td>
<td style="text-align: center;">d</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">treat_E</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">d</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">treat_F</td>
<td style="text-align: center;">43</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">d</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">treat_G</td>
<td style="text-align: center;">45</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">e</td>
</tr>
</tbody>
</table>
</div>
<p>Wir können dann auch in <a href="#fig-boxplot-cld-4">Abbildung&nbsp;<span>32.12</span></a> sehen, wie das <em>compact letter display</em> mit den Boxplots verbunden wird.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">letters_tbl</span> <span class="op">&lt;-</span> <span class="va">ght_cld</span><span class="op">$</span><span class="va">Letters</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">enframe</span><span class="op">(</span><span class="st">"trt"</span>, <span class="st">"label"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>rsp <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">data_tbl</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">trt</span>, y <span class="op">=</span> <span class="va">rsp</span>, </span>
<span>                     fill <span class="op">=</span> <span class="va">trt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_okabeito</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.15</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_text</span><span class="op">(</span>data <span class="op">=</span> <span class="va">letters_tbl</span>, </span>
<span>            <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">trt</span> , y <span class="op">=</span> <span class="va">rsp</span>, label <span class="op">=</span> <span class="va">label</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-boxplot-cld-4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-tests-posthoc_files/figure-html/fig-boxplot-cld-4-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Abbildung&nbsp;32.12— Boxplot der Beispieldaten zusammen mit den <em>compact letter display</em>.</figcaption></figure>
</div>
</div>
</div>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./stat-tests-pretest.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Pre-Tests oder Vortest</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./stat-linear-reg-preface.html" class="pagination-link">
        <span class="nav-page-text">Grundlagen der linearen Regression</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Skript Bio Data Science - 53&nbsp; Clusteranalysen</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./stat-modeling-pca.html" rel="next">
<link href="./stat-modeling-permutationstest.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-modeling-preface.html">Statistisches Modellieren</a></li><li class="breadcrumb-item"><a href="./stat-modeling-cluster.html"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Skript Bio Data Science</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Willkommen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Literatur</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forschungsprozess</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abschlussarbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Abschlussarbeit</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./example-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datenbeispiele</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen auf Hunden und Katzen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats-foxes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats-length-weight.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von vielen Flöhen auf Hunden und Katzen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programmieren in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Buchstaben und Zahlen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Daten einlesen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Reguläre Ausdrücke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-purrr-furrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Ein <code>purrr</code> Cookbook</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorative Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Frequentistische Hypothesentests</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Der t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Der Wilcoxon-Mann-Whitney-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Friedman Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Der <span class="math inline">\(\mathcal{X}^2\)</span>-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Pre-Tests oder Vortest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Multiple Vergleiche oder Post-hoc Tests</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grundlagen der linearen Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Maßzahlen der Modelgüte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Korrelation</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistisches Modellieren</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Variablenselektion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Ausreißer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Imputation fehlender Werte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-robust-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Überlebenszeitanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-noninferiority.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Äquivalenz oder Nichtunterlegenheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Metaanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-permutationstest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Permutationstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-cluster.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelles Design</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Grundlagen der Versuchsplanung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Fortgeschrittene Versuchsplanung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Klassifikation oder maschinelles Lernen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-pre-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Data preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Support vector machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
 <span class="menu-text">Anhang</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-spielecke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spielecke</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
<li><a href="#genutzte-r-pakete" id="toc-genutzte-r-pakete" class="nav-link active" data-scroll-target="#genutzte-r-pakete"><span class="header-section-number">53.1</span> Genutzte R Pakete</a></li>
  <li><a href="#daten" id="toc-daten" class="nav-link" data-scroll-target="#daten"><span class="header-section-number">53.2</span> Daten</a></li>
  <li>
<a href="#daten-preprocessing" id="toc-daten-preprocessing" class="nav-link" data-scroll-target="#daten-preprocessing"><span class="header-section-number">53.3</span> Daten preprocessing</a>
  <ul class="collapse">
<li><a href="#normalisieren" id="toc-normalisieren" class="nav-link" data-scroll-target="#normalisieren"><span class="header-section-number">53.3.1</span> Normalisieren</a></li>
  <li><a href="#standardisieren" id="toc-standardisieren" class="nav-link" data-scroll-target="#standardisieren"><span class="header-section-number">53.3.2</span> Standardisieren</a></li>
  <li><a href="#das-data.frame-problem" id="toc-das-data.frame-problem" class="nav-link" data-scroll-target="#das-data.frame-problem"><span class="header-section-number">53.3.3</span> Das <code>data.frame()</code> Problem</a></li>
  </ul>
</li>
  <li><a href="#distanzma%C3%9Fe" id="toc-distanzmaße" class="nav-link" data-scroll-target="#distanzma%C3%9Fe"><span class="header-section-number">53.4</span> Distanzmaße</a></li>
  <li>
<a href="#algorithmen-f%C3%BCrs-clustern" id="toc-algorithmen-fürs-clustern" class="nav-link" data-scroll-target="#algorithmen-f%C3%BCrs-clustern"><span class="header-section-number">53.5</span> Algorithmen fürs Clustern</a>
  <ul class="collapse">
<li><a href="#sec-clust-dendro" id="toc-sec-clust-dendro" class="nav-link" data-scroll-target="#sec-clust-dendro"><span class="header-section-number">53.5.1</span> Hierarchische Clusteranalyse</a></li>
  <li><a href="#dendrogramm" id="toc-dendrogramm" class="nav-link" data-scroll-target="#dendrogramm"><span class="header-section-number">53.5.2</span> Dendrogramm</a></li>
  <li><a href="#sec-clust-knn" id="toc-sec-clust-knn" class="nav-link" data-scroll-target="#sec-clust-knn"><span class="header-section-number">53.5.3</span> k-means Clusteranalyse</a></li>
  <li><a href="#silhouettenplot" id="toc-silhouettenplot" class="nav-link" data-scroll-target="#silhouettenplot"><span class="header-section-number">53.5.4</span> Silhouettenplot</a></li>
  <li><a href="#sec-clust-heat" id="toc-sec-clust-heat" class="nav-link" data-scroll-target="#sec-clust-heat"><span class="header-section-number">53.5.5</span> Heatmap</a></li>
  </ul>
</li>
  <li>
<a href="#sec-clust-tidyclust" id="toc-sec-clust-tidyclust" class="nav-link" data-scroll-target="#sec-clust-tidyclust"><span class="header-section-number">53.6</span> Datenanalyse mit <code>tidyclust</code></a>
  <ul class="collapse">
<li><a href="#hierarchical-clustering" id="toc-hierarchical-clustering" class="nav-link" data-scroll-target="#hierarchical-clustering"><span class="header-section-number">53.6.1</span> Hierarchical Clustering</a></li>
  <li><a href="#k-means-clustering" id="toc-k-means-clustering" class="nav-link" data-scroll-target="#k-means-clustering"><span class="header-section-number">53.6.2</span> k-means Clustering</a></li>
  </ul>
</li>
  <li><a href="#referenzen" id="toc-referenzen" class="nav-link" data-scroll-target="#referenzen">Referenzen</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-cluster-analysis" class="quarto-section-identifier"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p><em>Version vom August 04, 2023 um 10:24:32</em></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/caution.png" class="img-fluid figure-img" style="width:50.0%"></p>
</figure>
</div>
<blockquote class="blockquote">
<p><em>“Cluster together like stars!” — Henry Miller</em></p>
</blockquote>
<p>In diesem Kapitel wollen wir uns mit der Clusteranalyse beschäftigen. Zuerst was verstehen wir unter einem Cluster? Ein Cluster ist ein Zusammenschluss von ähnlichen Beobachtungen. Nun stellt sich zuerst die Frage, was heißt ähnlich? Wir brauchen also Maßzahlen für die Ähnlichkeit zwischen zwei und mehreren Beobachtungen. In unserem Datensatz haben wir ja nicht nur zwei Beobachtungen, also Zeilen, sondern sehr viel mehr. Im Weiteren haben wir in erster Linie kein Outcome <span class="math inline">\(y\)</span>. Wir nehmen alle Spalten <span class="math inline">\(x\)</span> aus unseren Daten und versuchen anhand der Spalten Gruppen über die Beobachtungen in den Zeilen zu bilden. Manchmal wollen wir dann <em>nachräglich</em> die Cluster nach einer Spalte in unseren ursprünglichen Daten einfärben oder benennen. Dieses Benennen von bekannten Zuordnungen hat aber erstmal mit dem Clusteralgorithmus nichts zu tun. Wir schauen uns im Folgenden diese Schwerpunktthemen an.</p>
<ul>
<li>Die <strong>hierarchisches Clustern</strong> über Dendrogramme in <a href="#sec-clust-dendro"><span>Kapitel&nbsp;53.5.1</span></a>
</li>
<li>Das <strong>k-NN</strong> oder nächste Nachbarn Clustern in <a href="#sec-clust-knn"><span>Kapitel&nbsp;53.5.3</span></a>
</li>
<li>Die <strong>Heatmaps</strong> verbreitet in der genetischen Analysen in <a href="#sec-clust-heat"><span>Kapitel&nbsp;53.5.5</span></a>
</li>
<li>Einmal das hierarchisches Clustern und k-NN über das R Paket <code>tidyclust</code> in <a href="#sec-clust-tidyclust"><span>Kapitel&nbsp;53.6</span></a>
</li>
</ul>
<p>Wie immer können wir nicht alles erschlagen.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Weitere Tutorien für die Clusteranalyse
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Wie immer gibt es eine Vielzahl an tollen Tutorien, die eine Clusteranalyse gut erklären. Ich habe hier einmal eine Auswahl zusammengestellt und du kannst dich da ja mal vertiefend mit beschäftigen, wenn du willst. Teile der Tutorien findest du vermutlich hier im Kapitel wieder.</p>
<ul>
<li>Das R Paket <code>dendextend</code> <a href="https://cran.r-project.org/web/packages/dendextend/vignettes/dendextend.html">Introduction to dendextend</a> um Dendrogramme wirklich schön zu zeichnen.</li>
<li>Das R Paket <code>pheatmap</code> <a href="https://davetang.github.io/muse/pheatmap.html">Making a heatmap in R with the pheatmap package</a> um Heatmaps mit allem was das Herz begehrt zu bauen. Dann haben wir noch das R Paket <a href="https://jokergoo.github.io/ComplexHeatmap-reference/book/index.html">ComplexHeatmap</a>, was sich vom R Paket <code>pheatmap</code> inspirieren lies. Das geht dann aber hier zu weit, schauen da, wenn du wirklich Heatmaps brauchst.</li>
</ul>
</div>
</div>
</div>
<p>Wir wollen uns die Clusteranalyse an zwei Spieldaten anschauen sowie einmal an den echten Daten zu den Gummibärchen. Eigentlich werden ja auch gerne Fragebögen mit der Clusteranalyse ausgewertet, aber hier muss ich nochmal warten bis ich ein gutes Beispiel in den Beratungen hatte. Dann ergänze ich ein Beispiel bei dem Skript zu den <a href="https://jkruppa.github.io/application/">Beispielhaften Auswertungen</a>.</p>
<section id="genutzte-r-pakete" class="level2" data-number="53.1"><h2 data-number="53.1" class="anchored" data-anchor-id="genutzte-r-pakete">
<span class="header-section-number">53.1</span> Genutzte R Pakete</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">20230727</span><span class="op">)</span></span>
<span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">tidyverse</span>, <span class="va">magrittr</span>, <span class="va">palmerpenguins</span>, <span class="va">readxl</span>,</span>
<span>               <span class="va">ggdendro</span>, <span class="va">broom</span>, <span class="va">cluster</span>, <span class="va">factoextra</span>, <span class="va">FactoMineR</span>, </span>
<span>               <span class="va">pheatmap</span>, <span class="va">tidyclust</span>, <span class="va">dlookr</span>, <span class="va">janitor</span>, <span class="va">corrplot</span>,</span>
<span>               <span class="va">dendextend</span>, <span class="va">conflicted</span><span class="op">)</span></span>
<span><span class="fu">conflict_prefer</span><span class="op">(</span><span class="st">"select"</span>, <span class="st">"dplyr"</span><span class="op">)</span></span>
<span><span class="fu">conflict_prefer</span><span class="op">(</span><span class="st">"filter"</span>, <span class="st">"dplyr"</span><span class="op">)</span></span>
<span><span class="fu">conflict_prefer</span><span class="op">(</span><span class="st">"mutate"</span>, <span class="st">"dplyr"</span><span class="op">)</span></span>
<span><span class="fu">conflicts_prefer</span><span class="op">(</span><span class="fu">dlookr</span><span class="fu">::</span><span class="va"><a href="https://choonghyunryu.github.io/dlookr/reference/transform.html">transform</a></span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Am Ende des Kapitels findest du nochmal den gesamten R Code in einem Rutsch zum selber durchführen oder aber kopieren.</p>
</section><section id="daten" class="level2 page-columns page-full" data-number="53.2"><h2 data-number="53.2" class="anchored" data-anchor-id="daten">
<span class="header-section-number">53.2</span> Daten</h2>
<p>Beginnen wir mit einem normierten Datensatz aus dem R Paket <code>cluster</code>. Der Datensatz <code>animals</code> wurde von mir noch mit ein paar Tieren ergänzt und schaut sich sechs Eigenschaften von 23 Tieren an. Wir wollen im Folgenden nun herausfinden, ob wir anhand der Eigenschaften in den Spalten die Tiere in den Zeilen in Gruppen einordnen können. Einige der Tiere sind ja näher miteinander verwandt als andere Tiere. Die ursprünglichen Daten liefen noch auf einem <span class="math inline">\(1/2\)</span>-System, das ändern wir dann zu <span class="math inline">\(0/1\)</span> damit wir dann auch besser mit den Daten arbeiten können. Für die Algorithmen ist es egal, aber ich habe lieber <span class="math inline">\(1\)</span> gleich ja und <span class="math inline">\(0\)</span> gleich nein.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">animals_tbl</span> <span class="op">&lt;-</span> <span class="fu">read_excel</span><span class="op">(</span><span class="st">"data/cluster_animal.xlsx"</span>, sheet <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">clean_names</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Schauen wir uns einmal den Datensatz in der <a href="stat-modeling-pca.html#tbl-cluster-01">Tabelle&nbsp;<span>54.3</span></a> an. Wir sehen, dass wir noch einige fehlende Werte in den Daten vorliegen haben. Das ist manchmal ein Problem, deshalb werden wir im Laufe der Analyse die <code>NA</code> Werte mit <code><a href="https://rdrr.io/r/stats/na.fail.html">na.omit()</a></code> entfernen.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-cluster-01" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tabelle&nbsp;53.1— Übersicht über die 23 Tiere mit den sechs Eigenschaften in den Spalten. Eine 1 bedeutet, dass die Eigenschaft vorliegt; eine 0 das die Eigenschaft nicht vorliegt.</caption>
<colgroup>
<col style="width: 15%">
<col style="width: 18%">
<col style="width: 6%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 20%">
<col style="width: 7%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">animal</th>
<th style="text-align: center;">warm_blooded</th>
<th style="text-align: center;">fly</th>
<th style="text-align: center;">vertebrate</th>
<th style="text-align: center;">threatened</th>
<th style="text-align: center;">live_in_groups</th>
<th style="text-align: center;">hair</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">ant</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">bee</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">centipede</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">chimpanzee</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">cow</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">dolphin</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">duck</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">eagle</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">earthworm</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">elephant</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">fly</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">frog</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">herring</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">horse</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">human</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">lion</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">lizard</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">lobster</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">rabbit</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">salmon</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">spider</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">whale</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Der Tierdatensatz ist schön, da wir es hier nur mit 0/1 Werten zu tun haben. Wir werden später in dem preprocessing der Daten sehen, dass wir alle Spalten in der gleichen Spannweite der Werte wollen. Das klingt immer etwas kryptisch, aber der nächste Datensatz über verschiedene Kreaturen macht es deutlicher.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Eine andere Art die Daten zu Gruppieren kannst du im Tutorium <a href="https://rpubs.com/askieswe/clustering">Clustering Creatures</a> nochmal nachvollziehen.</p>
</div></div><p>Im Folgenen einmal der Datensatz, den wir dann in der gleichen Exceldatei finden nur eben auf dem zweiten Tabellenblatt. Wir reinigen noch die Namen und setzen die <code>creature</code>-Spalte auf Klein geschrieben. Wie du siehst, haben wir dann nur 15 Kreaturen und drei Spalten mit dem Gewicht, der Herzrate und dem maximalen möglichen Alter.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">creature_tbl</span> <span class="op">&lt;-</span> <span class="fu">read_excel</span><span class="op">(</span><span class="st">"data/cluster_animal.xlsx"</span>, sheet <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">clean_names</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>creature <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span><span class="op">(</span><span class="va">creature</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In der <a href="stat-modeling-pca.html#tbl-cluster-02">Tabelle&nbsp;<span>54.4</span></a> sehen wir nochmal die Daten dargestellt und hier erkennst du auch gut, wo das Problem liegt. Die Masse der Tiere reicht von <span class="math inline">\(6g\)</span> beim Hamster bis <span class="math inline">\(120000000g\)</span> beim Wal. Diese Spannweiten in einer Spalte und zwischen den Spalten führt dann zu Problemen bei den Algorithmen. Deshalb müssen wir hier Daten nochmal normalisieren oder aber standardisieren. Je nachdem was da besser passt.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-cluster-02" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tabelle&nbsp;53.2— Übersicht über die 15 Kreaturen mit den drei Eigenschaften in den Spalten. Wir haben hier sehr große Unterschiede in den Datenwerten. Daher müssen wir vor dem Clustern nochmal normalisieren.</caption>
<thead><tr class="header">
<th style="text-align: center;">creature</th>
<th style="text-align: center;">mass_grams</th>
<th style="text-align: center;">heart_rate_bpm</th>
<th style="text-align: center;">longevity_years</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">human</td>
<td style="text-align: center;">9.0e+04</td>
<td style="text-align: center;">60</td>
<td style="text-align: center;">70</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">2.0e+03</td>
<td style="text-align: center;">150</td>
<td style="text-align: center;">15</td>
</tr>
<tr class="odd">
<td style="text-align: center;">small dog</td>
<td style="text-align: center;">2.0e+03</td>
<td style="text-align: center;">100</td>
<td style="text-align: center;">10</td>
</tr>
<tr class="even">
<td style="text-align: center;">medium dog</td>
<td style="text-align: center;">5.0e+03</td>
<td style="text-align: center;">90</td>
<td style="text-align: center;">15</td>
</tr>
<tr class="odd">
<td style="text-align: center;">large dog</td>
<td style="text-align: center;">8.0e+03</td>
<td style="text-align: center;">75</td>
<td style="text-align: center;">17</td>
</tr>
<tr class="even">
<td style="text-align: center;">hamster</td>
<td style="text-align: center;">6.0e+01</td>
<td style="text-align: center;">450</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">chicken</td>
<td style="text-align: center;">1.5e+03</td>
<td style="text-align: center;">275</td>
<td style="text-align: center;">15</td>
</tr>
<tr class="even">
<td style="text-align: center;">monkey</td>
<td style="text-align: center;">5.0e+03</td>
<td style="text-align: center;">190</td>
<td style="text-align: center;">15</td>
</tr>
<tr class="odd">
<td style="text-align: center;">horse</td>
<td style="text-align: center;">1.2e+06</td>
<td style="text-align: center;">44</td>
<td style="text-align: center;">40</td>
</tr>
<tr class="even">
<td style="text-align: center;">cow</td>
<td style="text-align: center;">8.0e+05</td>
<td style="text-align: center;">65</td>
<td style="text-align: center;">22</td>
</tr>
<tr class="odd">
<td style="text-align: center;">pig</td>
<td style="text-align: center;">1.5e+05</td>
<td style="text-align: center;">70</td>
<td style="text-align: center;">25</td>
</tr>
<tr class="even">
<td style="text-align: center;">rabbit</td>
<td style="text-align: center;">1.0e+03</td>
<td style="text-align: center;">205</td>
<td style="text-align: center;">9</td>
</tr>
<tr class="odd">
<td style="text-align: center;">elephant</td>
<td style="text-align: center;">5.0e+06</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">70</td>
</tr>
<tr class="even">
<td style="text-align: center;">giraffe</td>
<td style="text-align: center;">9.0e+05</td>
<td style="text-align: center;">65</td>
<td style="text-align: center;">20</td>
</tr>
<tr class="odd">
<td style="text-align: center;">large whale</td>
<td style="text-align: center;">1.2e+08</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">80</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Im Weiteren betrachten wir noch das Beispiel der Gummibärchendaten. Auch hier haben wir echte Daten vorliegen, so dass wir eventuell Ausreißer entdecken könnten. Da wir hier fehlende Werte in den Daten haben, entfernen wir alle fehlenden Werte mit der Funktion <code><a href="https://rdrr.io/r/stats/na.fail.html">na.omit()</a></code>. Damit löschen wir jede Zeile in den Daten, wo mindestens ein fehlender Wert auftritt. Da wir hier mittlerweile sehr viele Daten vorliegen haben, wollen wir das Problem auf die beiden Quellen <em>FU Berlin</em> und dem <em>Girls and Boys Day</em> eingrenzen.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gummi_tbl</span> <span class="op">&lt;-</span> <span class="fu">read_excel</span><span class="op">(</span><span class="st">"data/gummibears.xlsx"</span><span class="op">)</span>  <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">module</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FU Berlin"</span>, <span class="st">"Girls and Boys Day"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">gender</span>, <span class="va">age</span>, <span class="va">height</span>, <span class="va">semester</span>, <span class="va">most_liked</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>gender <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">gender</span><span class="op">)</span>,</span>
<span>         most_liked <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">most_liked</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Auch hier schauen wir uns in der Tabelle die ersten sieben Beobachtungen von den 192 Beobachtungen an. Wir sehen, dass wir hier mal ganz unterschiedliche Typen an Daten haben. Zum einen sehen wir dichotome Daten, wie das Geschlecht, sowie numerisch wie Alter und Größe, dann noch das Semester mit einer eher geordneten Struktur und nochmal ein Faktor mit sechs Stufen. Das schauen wir uns dann nochmal am Ende an, was wir dann machen können.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-cluster-03" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tabelle&nbsp;53.3— Auszuga us den Gummibärchendaten für die ersten sieben Beobachtungen.</caption>
<thead><tr class="header">
<th style="text-align: left;">gender</th>
<th style="text-align: right;">age</th>
<th style="text-align: right;">height</th>
<th style="text-align: left;">semester</th>
<th style="text-align: right;">most_liked</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">m</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">193</td>
<td style="text-align: left;">10</td>
<td style="text-align: right;">lightred</td>
</tr>
<tr class="even">
<td style="text-align: left;">w</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">159</td>
<td style="text-align: left;">6</td>
<td style="text-align: right;">yellow</td>
</tr>
<tr class="odd">
<td style="text-align: left;">w</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">159</td>
<td style="text-align: left;">6</td>
<td style="text-align: right;">white</td>
</tr>
<tr class="even">
<td style="text-align: left;">w</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">180</td>
<td style="text-align: left;">10</td>
<td style="text-align: right;">white</td>
</tr>
<tr class="odd">
<td style="text-align: left;">m</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">180</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">white</td>
</tr>
<tr class="even">
<td style="text-align: left;">m</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">180</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">green</td>
</tr>
<tr class="odd">
<td style="text-align: left;">w</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">163</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">green</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Bevor wir jetzt aber die Daten clustern können, müssen wir die Daten vorher nochmal aufbereiten, damit die Algorithmen mit den Daten arbeiten können. Dann müssen wir am Ende auch noch vom <code>tibble()</code> in den <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code> wechseln, da wir die Zeilennamen häufig brauchen. Wenn du beim <code>tibble()</code> bleiben willst, dann gibt es am Ende noch eine mögliche Lösung für dich.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Weitere Datensätze fürs Clustern
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Andere mögliche Datensätze für die Zukunft: <code>chorSub</code>, <code>flower</code>, <code>plantTraits</code>, <code>pluton</code>, <code>ruspini</code> und <code>agriculture</code>. Die Datensätze sind teilweise im R Paket <code>cluster</code> enthalten.</p>
<p>Im Weiteren noch die <a href="https://allisonhorst.github.io/palmerpenguins/index.html">Palmer Penguins</a> mit dem Datensatz <code>penguins</code> aus dem R Paket <code>palmerpenguins</code>.</p>
</div>
</div>
</div>
</section><section id="daten-preprocessing" class="level2" data-number="53.3"><h2 data-number="53.3" class="anchored" data-anchor-id="daten-preprocessing">
<span class="header-section-number">53.3</span> Daten preprocessing</h2>
<p>Wir können die Daten so wir wie sie vorliegen haben in einem Clusteralgorithmus verwenden. Wir führen also keine Transformation der Daten durch, wir nutzen die Daten untransformiert. Dieses untransfomierte Verwenden der Daten führt aber meist dazu, dass Variablen nicht im gleichen Maße berücksichtigt werden. Es macht eben einen Unterschied, ob wir wie bei dem Alter sehr viele verschiedene Werte haben als beim Geschlecht. Es macht auch einen Unterschied, ob das Alter numerische Werte von 20 bis 60 haben kann und das Semester nur numerische Werte von 1 bis 10.</p>
<p>In dem <a href="eda-transform.html"><span>Kapitel&nbsp;18</span></a> findest du die hier verwendeten Standardfunktionen in R aus dem Paket <code>dlookr</code> für die Normalisierung sowie Standardisierung mit der Funktion <code><a href="https://rdrr.io/r/base/transform.html">transform()</a></code>. Wenn es komplexer wird, dann empfehle ich den Workflow, wie er im <a href="classification-pre-processing.html"><span>Kapitel&nbsp;60</span></a> für die Klassifikation von Daten vorgestellt wird. Am Ende des Kapitels zeige ich dir auf den Gummibärechendaten, wie dann alles einmal zusammenkommt.</p>
<section id="normalisieren" class="level3" data-number="53.3.1"><h3 data-number="53.3.1" class="anchored" data-anchor-id="normalisieren">
<span class="header-section-number">53.3.1</span> Normalisieren</h3>
<p>Wenn wir Normalisieren dann Zwängen wir Variablen in ein Intervall von <span class="math inline">\([0;1]\)</span>. Es gehen natürlich auch andere Intervalle, aber das Intervall von 0 bis 1 ist wohl das häufigste Intervall was genutzt wird. Dazu nutzen wir die Funktion <code><a href="https://rdrr.io/r/base/transform.html">transform()</a></code> aus dem R Paket <code>dlookr</code> und mit der Option <code>minmax</code> kriegen wir dann alle Werte einer Spalte zwischen 0 und 1. Dann machen wir das mal schnell mit den Daten aus dem Kreaturendatensatz.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">norm_creature_tbl</span> <span class="op">&lt;-</span> <span class="va">creature_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>mass_grams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html">transform</a></span><span class="op">(</span><span class="va">mass_grams</span>, <span class="st">"minmax"</span><span class="op">)</span>,</span>
<span>         heart_rate_bpm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html">transform</a></span><span class="op">(</span><span class="va">heart_rate_bpm</span>, <span class="st">"minmax"</span><span class="op">)</span>,</span>
<span>         longevity_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html">transform</a></span><span class="op">(</span><span class="va">longevity_years</span>, <span class="st">"minmax"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">norm_creature_tbl</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 4
   creature    mass_grams   heart_rate_bpm longevity_years
   &lt;chr&gt;       &lt;transfrm&gt;   &lt;transfrm&gt;     &lt;transfrm&gt;     
 1 human       7.495004e-04 0.09302326     0.87012987     
 2 cat         1.616667e-05 0.30232558     0.15584416     
 3 small dog   1.616667e-05 0.18604651     0.09090909     
 4 medium dog  4.116669e-05 0.16279070     0.15584416     
 5 large dog   6.616670e-05 0.12790698     0.18181818     
 6 hamster     0.000000e+00 1.00000000     0.00000000     
 7 chicken     1.200001e-05 0.59302326     0.15584416     
 8 monkey      4.116669e-05 0.39534884     0.15584416     
 9 horse       9.999505e-03 0.05581395     0.48051948     
10 cow         6.666170e-03 0.10465116     0.24675325     
11 pig         1.249501e-03 0.11627907     0.28571429     
12 rabbit      7.833337e-06 0.43023256     0.07792208     
13 elephant    4.166619e-02 0.02325581     0.87012987     
14 giraffe     7.499504e-03 0.10465116     0.22077922     
15 large whale 1.000000e+00 0.00000000     1.00000000     </code></pre>
</div>
</div>
<p>Wir sehen hier, dass in der Spalte <code>mass_grams</code> der Wal den maximalen Wert 1 kriegt und der Hamster den Wert 0. Alle anderen Kreaturen spannen sich numerisch zwischen diesen beiden Extremen auf. Das Gleiche erkenne wir dann auch bei der Herzrate und den Lebenspanne. Hier sind dann auch immer der Hamster und der Wal die extremsten numerischen Vertreter in den Spalten.</p>
<p>Hier helfen natürlich auch die Funktionen von dem R Paket <code>dplyr</code> und der <a href="https://dplyr.tidyverse.org/reference/across.html">Hilfsseite von <code>across()</code></a> um mehrere Spalten schneller in <code>mutate</code> zu transformieren. Aber wir üben hier nur begrenzt Programmierung und es ist dann an dir dieses Problem zu lösen.</p>
</section><section id="standardisieren" class="level3" data-number="53.3.2"><h3 data-number="53.3.2" class="anchored" data-anchor-id="standardisieren">
<span class="header-section-number">53.3.2</span> Standardisieren</h3>
<p>Die Standardisierung zwingt Variablen in eine <span class="math inline">\(\mathcal{N(0,1)}\)</span> Standardnormalverteilung. Das heißt, wir transformieren alle Variablen auf einen Mittelwert von <span class="math inline">\(0\)</span> und einer Standardabweichung von <span class="math inline">\(1\)</span>. Das macht dann auch die Daten sehr schon gleichförmig. Wir wollen also für unseren Gummibärchendatensatz, dass das Alter einen Mittelwert von 0 und eien Standardabweichung von 1 kriegt. Hier nutzen wir auch die Funktion <code><a href="https://rdrr.io/r/base/transform.html">transform()</a></code> aus dem R Paket <code>dlookr</code> mit der Option <code>zscore</code>. Es macht keinen Sinn Faktoren zu standardisieren, wir standardisieren nur numerische Spalte und das Semester zu transformieren ist schon so eine grenzwertige Sache.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">scale_gummi_tbl</span> <span class="op">&lt;-</span> <span class="va">gummi_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>gender <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">gender</span><span class="op">)</span>,</span>
<span>         age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html">transform</a></span><span class="op">(</span><span class="va">age</span>, <span class="st">"zscore"</span><span class="op">)</span>,</span>
<span>         height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html">transform</a></span><span class="op">(</span><span class="va">height</span>, <span class="st">"zscore"</span><span class="op">)</span>,</span>
<span>         semester <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html">transform</a></span><span class="op">(</span><span class="va">semester</span>, <span class="st">"zscore"</span><span class="op">)</span>,</span>
<span>         most_liked <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">most_liked</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">scale_gummi_tbl</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 192 × 5
   gender age         height     semester   most_liked
   &lt;fct&gt;  &lt;transfrm&gt;  &lt;transfrm&gt; &lt;transfrm&gt; &lt;fct&gt;     
 1 m       1.80953590  2.3007223  2.5534970 lightred  
 2 w      -0.37262314 -1.3535636  1.0237890 yellow    
 3 w      -0.37262314 -1.3535636  1.0237890 white     
 4 w       1.96540440  0.9034953  2.5534970 white     
 5 m      -0.21675464  0.9034953 -0.1234921 white     
 6 m      -0.21675464  0.9034953 -0.1234921 green     
 7 w      -0.37262314 -0.9236476 -0.1234921 green     
 8 m      -0.21675464 -0.1712947 -0.1234921 green     
 9 m      -0.06088613  0.4735793 -0.1234921 white     
10 m      -0.52849164  0.9034953 -0.1234921 lightred  
# ℹ 182 more rows</code></pre>
</div>
</div>
<p>Wie beim Normalisieren helfen hier natürlich auch die Funktionen von dem R Paket <code>dplyr</code> und der <a href="https://dplyr.tidyverse.org/reference/across.html">Hilfsseite von <code>across()</code></a> um mehrere Spalten schneller in <code>mutate</code> zu transformieren. Wie oben schon angemerkt, dass ist dann deine Fingerübung.</p>
</section><section id="das-data.frame-problem" class="level3" data-number="53.3.3"><h3 data-number="53.3.3" class="anchored" data-anchor-id="das-data.frame-problem">
<span class="header-section-number">53.3.3</span> Das <code>data.frame()</code> Problem</h3>
<p>Leider ist es so, dass fast alle Pakete im Kontext der Clusteranalyse mit den Zeilennamen bzw. <code><a href="https://rdrr.io/r/base/row.names.html">row.names()</a></code> eines <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code> arbeiten. Das hat den Grund, dass wir gut das Label in den Zeilennamen parken können, ohne das uns eine Spalte in den Auswertungen stört. Meistens ist das Label ja ein <code>character</code> und soll gar nicht in den Clusteralgorithmus mit rein. Deshalb müssen wir hier einmal unsere <code>tibble()</code> in einen <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code> umwandeln. Die <code>tibble()</code> haben aus gutem Grund keine Zeilennamen, die Zeilennamen sind ein Ärgernis und Quelle von Fehlern und aus gutem Grund nicht in einem <code>tibble()</code> drin. Hier brauchen wir die Zeilennamen aber.</p>
<p>Wir bauen uns also einmal einen <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code> für unseren Tierdatensatz und setzen die Tiernamen als Zeilennamen bzw. <code><a href="https://rdrr.io/r/base/row.names.html">row.names()</a></code>. Wir entfernen dann auch noch schnell alle fehlenden Werte, denn wir wollen usn hier nicht noch mit der Imputation von fehlenden Werten beschäftigen.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">animals_df</span> <span class="op">&lt;-</span> <span class="va">animals_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">set_rownames</span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">animal</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">animal</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Das Ganze machen wir dann auch noch einmal für die normalisierten Kreaturendaten. Wir wollen dann ja nur auf den normalisierten Daten weitermachen.</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">norm_creature_df</span> <span class="op">&lt;-</span> <span class="va">norm_creature_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">set_rownames</span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">creature</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">creature</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wie eben gesagt, ist es teilweise echt nervig immer die <code><a href="https://rdrr.io/r/base/row.names.html">row.names()</a></code> mit zu nehmen und alles ein <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code> zu nutzen. Insbesondere wenn die Daten sehr groß werden, kann kann es sehr ungünstig sein, alles in einem <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code> zu lagern. Deshalb gibt es das Paket <a href="https://tidyclust.tidymodels.org/index.html">tidyclust</a>, welches ich am Ende nochmal vorstelle.</p>
</section></section><section id="distanzmaße" class="level2" data-number="53.4"><h2 data-number="53.4" class="anchored" data-anchor-id="distanzmaße">
<span class="header-section-number">53.4</span> Distanzmaße</h2>
<p>Wie nah oder weit entfernt sind jetzt zwei Beobachtungen? Wenn wir die Distanz von zwei Beobachtungen zueinander haben, wie weit ist dann eine dritte Beobachtung entfernt? Aus den paarweisen Abständen aller Beobachtungen zueinander können wir dann Cluster bilden. Wir brauchen aber zuallerst die Distanzen der Beobachtungen zuaeinander. Wir betrachten dabei im Folgenden immer die Distanzen zwischen den Zeilen des Datensatzes. Das heißt, wir wollen immer die Distanzen zwischen den Beobachtungen berechnen. Wie nah oder fern sind sich zwei Beobachtungen gegeben den Spalten? Wir schauen uns einmal zwei sehr intuitive Distanzmaße mit der euklidischen sowie der manhattan Distanz an.</p>
<dl>
<dt>Euklidische Distanz</dt>
<dd>
<p>Die euklidische Distanz <span class="math inline">\(d_E\)</span> ist einfach die Wurzel des quadratischen Abstands zwischen zwei Punkten <span class="math inline">\(p\)</span> und <span class="math inline">\(q\)</span>. <span class="math display">\[
d_E(p,q) = \sqrt{(p-q)^2}
\]</span></p>
</dd>
<dt>Manhattan Distanz</dt>
<dd>
<p>Die manhattan Distanz <span class="math inline">\(d_M\)</span> ist einfach der absolute Abstands zwischen zwei Punkten <span class="math inline">\(p\)</span> und <span class="math inline">\(q\)</span>.<span class="math display">\[
d_M(p,q) = \lvert p-q \rvert
\]</span></p>
</dd>
</dl>
<p>Es gibt noch viel mehr Distanzen, die du berechnen kannst. Je nach R Paket sind unterschiedlich Distanzen dann auszuwählen. Hier eine generelle Empfehlung zu geben ist mir unmöglich. Da müssen wir dann zusammen mal schauen, was für deine Daten dann konkret passt.</p>
<ul>
<li>Die Funktion <code><a href="https://rdrr.io/r/stats/dist.html">dist()</a></code> als die Standardfunktion: Die Funktion akzeptiert nur numerische Daten als Eingabe und das zu verwendende Abstandsmaß muss eines der Folgenden sein: <code>euclidean</code>, <code>maximum</code>, <code>manhattan</code>, <code>canberra</code>, <code>binary</code> oder <code>minkowski</code>. Die Hilfeseite <code>?dist()</code> liefert mehr Informationen über die Distanzmaße.</li>
<li>Die Funktion <code>get_dist()</code> aus dem R Paket <code>factoextra</code>: Die Funktion akzeptiert nur numerische Daten als Eingabe. Im Vergleich zur Standardfunktion <code><a href="https://rdrr.io/r/stats/dist.html">dist()</a></code> unterstützt sie korrelationsbasierte Abstandsmaße einschließlich der Methoden <code>pearson</code>, <code>kendall</code> und <code>spearman</code>.</li>
<li>Die Funktion <code>daisy()</code> aus dem R Paket <code>cluster</code>: Die Funktion kann mit anderen Variablentypen umgehen als numerisch, also auch mit Kategorien und Faktoren. In diesem Fall wird automatisch der Gower-Koeffizient als Metrik verwendet. Der Gower-Koeffizient ist eines der beliebtesten Näherungsmaße für gemischte Datentypen. Weitere Einzelheiten findest du auf der Hilfeseite der Funktion <code>?daisy</code>.</li>
<li>Die Funktion <code>PCA()</code> aus dem R Paket <code>FactoMineR</code>: Die Funktion erlaubt es dir eine Hauptkomponentenanalyse zu rechnen. Das ist aber dann ein eigens Thema für sich. In dem <a href="stat-modeling-pca.html"><span>Kapitel&nbsp;54</span></a> erkläre ich nochmal die Hauptkomponentenanalyse und zeige dort auch, wie du mit den Ergebnissen einer Hauptkomponentenanalyse clustern kannst.</li>
</ul>
<p>Wenn du deine Daten transformierst, dann werden auch die Abstandmaße ähnlicher. Zum Beispiel werden durch die Standardisierung die folgenden Abstandsmaße kelinere Werte ergeben: Euklidisch, Manhattan und die Korrelation. Das ist aber nicht so schlimm, wenn du nicht untransformierte Daten mit transformierten Daten vergleichst.</p>
<p>Die Funktion <code>fviz_dist()</code> aus dem R Paket <code>factorextra</code> ermöglicht dir die Distanzmatrix zu visualisieren. In der <a href="#fig-dist-01">Abbildung&nbsp;<span>53.1</span></a> kannst du dir die Distanzmatrix der Funktion <code><a href="https://rdrr.io/r/stats/dist.html">dist()</a></code> als Heatmap anzuschauen. Wir nutzen die Distanzmatrix dann aber gleich um auf den Distanzen Cluster zu bilden.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">animals_df</span>  <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">fviz_dist</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-dist-01" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-cluster_files/figure-html/fig-dist-01-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Abbildung&nbsp;53.1— Heatmap der euklidischen Distanzen des Tierdatensatzes. Die Matrix ist symmetrisch. Hohe, blaue Werte bedeuten eine große Distanz dagegen kleine,rote Werte eine geringe Distanz zwischen den Beobachtungen.</figcaption></figure>
</div>
</div>
</div>
<p>Wenn du also die Distanzen zwischen deinen Beobachtungen berechnet hast, kannst du mit der Distanzmatrix entweder hierarchisch Clustern oder über den <span class="math inline">\(k\)</span>-NN Algorithmus Gruppen bilden.</p>
</section><section id="algorithmen-fürs-clustern" class="level2 page-columns page-full" data-number="53.5"><h2 data-number="53.5" class="anchored" data-anchor-id="algorithmen-fürs-clustern">
<span class="header-section-number">53.5</span> Algorithmen fürs Clustern</h2>
<section id="sec-clust-dendro" class="level3" data-number="53.5.1"><h3 data-number="53.5.1" class="anchored" data-anchor-id="sec-clust-dendro">
<span class="header-section-number">53.5.1</span> Hierarchische Clusteranalyse</h3>
<p>Es gibt vier gängige Ansätze für die Cluster-Cluster-Distanzierung, auch <em>Linkage</em> genannt:</p>
<ul>
<li>
<em>single linkage</em>: Der Abstand zwischen zwei Clustern ist der Abstand zwischen den beiden nächstgelegenen Beobachtungen. In R nutzen wir dann <code>single</code> als Option.</li>
<li>
<em>average linkage</em>: Der Abstand zwischen zwei Clustern ist der Durchschnitt aller Abstände zwischen den Beobachtungen in einem Cluster und den Beobachtungen im anderen Cluster. In R ist es dann die Option <code>average</code>.</li>
<li>
<em>complete linkage</em>: Der Abstand zwischen zwei Clustern ist der Abstand zwischen den beiden am weitesten entfernten Beobachtungen. Auch hier passt es dann mit dem Optionnamen von <code>complete</code>.</li>
<li>
<em>centroid method</em>: Der Abstand zwischen zwei Clustern ist der Abstand zwischen ihren geometrischen Mittel oder Medianen. Hier nutzen wir die Option <code>median</code>.</li>
<li>
<em>ward method</em>: Der Abstand zwischen zwei Clustern ist proportional zur Zunahme der Fehlerquadratsumme, die sich aus der Verbindung der beiden Cluster ergeben würde. Die Fehlerquadratsumme wird als Summe der quadrierten Abstände zwischen den Beobachtungen in einem Cluster und dem Schwerpunkt des Clusters berechnet. In R haben wir hier die Wahl zwischen <code>ward.D</code> und <code>ward.D2</code>. Wenn, dann nutze bitte <code>ward.D2</code> da es sich um die neuere Implementierung handelt, die weniger fehleranfällig ist.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">h_clust_animal</span> <span class="op">&lt;-</span> <span class="va">animals_df</span>  <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"ward.D"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">grp_animal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html">cutree</a></span><span class="op">(</span><span class="va">h_clust_animal</span> , k<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">grp_animal</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       ant        bee        cat  centipede chimpanzee        cow    dolphin 
         1          1          2          1          3          2          3 
      duck      eagle  earthworm   elephant        fly    herring      horse 
         3          3          1          3          1          1          2 
     human     lizard     rabbit      whale 
         3          1          2          3 </code></pre>
</div>
</div>
<p>Wir nehmen jetzt mal die normalisierten Kreaturen</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">h_clust_creature</span> <span class="op">&lt;-</span> <span class="va">norm_creature_df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">.</span>, method <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="va">.</span>, method <span class="op">=</span> <span class="st">"ward.D"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">grp_creature</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html">cutree</a></span><span class="op">(</span><span class="va">h_clust_creature</span> , k<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">grp_creature</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      human         cat   small dog  medium dog   large dog     hamster 
          1           2           3           3           3           2 
    chicken      monkey       horse         cow         pig      rabbit 
          2           2           3           3           3           2 
   elephant     giraffe large whale 
          1           3           1 </code></pre>
</div>
</div>
</section><section id="dendrogramm" class="level3 page-columns page-full" data-number="53.5.2"><h3 data-number="53.5.2" class="anchored" data-anchor-id="dendrogramm">
<span class="header-section-number">53.5.2</span> Dendrogramm</h3>
<div class="page-columns page-full">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggdendrogram</span><span class="op">(</span><span class="va">h_clust_animal</span><span class="op">)</span></span>
<span><span class="fu">ggdendrogram</span><span class="op">(</span><span class="va">h_clust_creature</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-cluster-01" class="cell column-page quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-cluster-01-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-cluster_files/figure-html/fig-cluster-01-1.png" class="img-fluid figure-img" data-ref-parent="fig-cluster-01" width="576"></p>
<figcaption class="figure-caption">(a) Verteilung der beobachteten Werte.</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-cluster-01-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-cluster_files/figure-html/fig-cluster-01-2.png" class="img-fluid figure-img" data-ref-parent="fig-cluster-01" width="576"></p>
<figcaption class="figure-caption">(b) Verteilung der theoretischen Werte.</figcaption></figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;53.2— dst.</figcaption><p></p>
</figure>
</div>
</div>
<p><a href="https://cran.r-project.org/web/packages/dendextend/vignettes/dendextend.html">Introduction to dendextend</a></p>
<p><a href="https://cran.r-project.org/web/packages/dendextend/vignettes/Cluster_Analysis.html">Hierarchical cluster analysis on famous data sets - enhanced with the dendextend package</a></p>
<div class="page-columns page-full">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">fviz_dend</span><span class="op">(</span><span class="va">h_clust_animal</span>, cex <span class="op">=</span> <span class="fl">0.5</span>, k <span class="op">=</span> <span class="fl">4</span>, palette <span class="op">=</span> <span class="st">"jco"</span><span class="op">)</span> </span>
<span><span class="fu">fviz_dend</span><span class="op">(</span><span class="va">h_clust_creature</span>, cex <span class="op">=</span> <span class="fl">0.5</span>, k <span class="op">=</span> <span class="fl">4</span>, palette <span class="op">=</span> <span class="st">"jco"</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-cluster-04" class="cell column-page quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-cluster-04-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-cluster_files/figure-html/fig-cluster-04-1.png" class="img-fluid figure-img" data-ref-parent="fig-cluster-04" width="480"></p>
<figcaption class="figure-caption">(a) within cluster sums of squares</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-cluster-04-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-cluster_files/figure-html/fig-cluster-04-2.png" class="img-fluid figure-img" data-ref-parent="fig-cluster-04" width="480"></p>
<figcaption class="figure-caption">(b) gap statistics.</figcaption></figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;53.3— dst.</figcaption><p></p>
</figure>
</div>
</div>
</section><section id="sec-clust-knn" class="level3 page-columns page-full" data-number="53.5.3"><h3 data-number="53.5.3" class="anchored" data-anchor-id="sec-clust-knn">
<span class="header-section-number">53.5.3</span> k-means Clusteranalyse</h3>
<p><a href="https://uc-r.github.io/kmeans_clustering">K-means Cluster Analysis</a></p>
<p>Siehe auch <code>pam()</code> aus dem R Paket <code>cluster</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">knn_animal</span> <span class="op">&lt;-</span> <span class="va">animals_df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span>centers <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">knn_creature</span> <span class="op">&lt;-</span> <span class="va">norm_creature_df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span>centers <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="page-columns page-full">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">fviz_cluster</span><span class="op">(</span><span class="va">knn_animal</span>, data <span class="op">=</span> <span class="va">animals_df</span>, palette <span class="op">=</span> <span class="st">"jco"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu">expansion</span><span class="op">(</span>add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu">expansion</span><span class="op">(</span>add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">fviz_cluster</span><span class="op">(</span><span class="va">knn_creature</span>, data <span class="op">=</span> <span class="va">norm_creature_df</span>, palette <span class="op">=</span> <span class="st">"jco"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu">expansion</span><span class="op">(</span>add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu">expansion</span><span class="op">(</span>add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-cluster-03" class="cell column-page quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-cluster-03-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-cluster_files/figure-html/fig-cluster-03-1.png" class="img-fluid figure-img" data-ref-parent="fig-cluster-03" width="576"></p>
<figcaption class="figure-caption">(a) within cluster sums of squares</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-cluster-03-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-cluster_files/figure-html/fig-cluster-03-2.png" class="img-fluid figure-img" data-ref-parent="fig-cluster-03" width="576"></p>
<figcaption class="figure-caption">(b) gap statistics.</figcaption></figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;53.4— dst.</figcaption><p></p>
</figure>
</div>
</div>
<p>Was ist das optimale <span class="math inline">\(k\)</span> für die Anzahl an Gruppen?</p>
<div class="page-columns page-full">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">animals_df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">fviz_nbclust</span><span class="op">(</span><span class="va">kmeans</span>, method <span class="op">=</span> <span class="st">"wss"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">norm_creature_df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">fviz_nbclust</span><span class="op">(</span><span class="va">kmeans</span>, method <span class="op">=</span> <span class="st">"gap_stat"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-cluster-02" class="cell column-page quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-cluster-02-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-cluster_files/figure-html/fig-cluster-02-1.png" class="img-fluid figure-img" data-ref-parent="fig-cluster-02" width="576"></p>
<figcaption class="figure-caption">(a) within cluster sums of squares</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-cluster-02-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-cluster_files/figure-html/fig-cluster-02-2.png" class="img-fluid figure-img" data-ref-parent="fig-cluster-02" width="576"></p>
<figcaption class="figure-caption">(b) gap statistics.</figcaption></figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;53.5— dst.</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">creature_tbl</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">longevity_years</span>, <span class="va">heart_rate_bpm</span>, label <span class="op">=</span> <span class="va">creature</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_label</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">knn_creature</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"white"</span>, </span>
<span>             fontface <span class="op">=</span> <span class="st">"bold"</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-cluster-05" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-cluster_files/figure-html/fig-cluster-05-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Abbildung&nbsp;53.6— .</figcaption></figure>
</div>
</div>
</div>
</section><section id="silhouettenplot" class="level3 page-columns page-full" data-number="53.5.4"><h3 data-number="53.5.4" class="anchored" data-anchor-id="silhouettenplot">
<span class="header-section-number">53.5.4</span> Silhouettenplot</h3>
<p>Um das Ergebnis der Gruppenfindung zu beurteilen, eignet sich ein Silhouettenplot. Ein Silhouettenplot zeigt für jede Beobachtung i die Silhouettenbreite <span class="math inline">\(s_i\)</span>, welche definiert ist als normierte Differenz der kleinsten Distanz zu den Beobachtungen außerhalb der eigenen Gruppe und dem Mittelwert der Distanzen innerhalb einer Gruppe. Die Silhouettenbreite <span class="math inline">\(s_i\)</span> kann jeden Wert im Intervall [-1, 1] annehmen und wird folgendermaßen interpretiert.</p>
<ul>
<li>
<span class="math inline">\(s_i = 1\)</span> Die Beobachtung ist dem “richtigen” Cluster zugeordnet.</li>
<li>
<span class="math inline">\(s_i = 0\)</span> Die Beobachtung hätte ebenso gut einer anderen Gruppe zugeordnet werden können.</li>
<li>
<span class="math inline">\(s_i = -1\)</span> Die Beobachtung ist schlecht zugeordnet.</li>
</ul>
<p>Es kann darüber hinaus die durchschnittliche Silhouettenbreite über alle Beobachtungen berechnet werden, womit sich die Gruppenbildung als Ganzes beurteilen lässt. Die durchschnittliche Silhouettenbreite wird analog interpretiert.</p>
<p>Was ist mit tidyclust::silhouette?</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">silhouette_creature_tbl</span> <span class="op">&lt;-</span> <span class="fu">cluster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cluster/man/silhouette.html">silhouette</a></span><span class="op">(</span><span class="va">knn_creature</span><span class="op">$</span><span class="va">cluster</span>, </span>
<span>                                      <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">norm_creature_df</span>, <span class="st">"canberra"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>creature <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">norm_creature_df</span><span class="op">)</span>,</span>
<span>         cluster <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">silhouette_animals_tbl</span> <span class="op">&lt;-</span> <span class="fu">cluster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cluster/man/silhouette.html">silhouette</a></span><span class="op">(</span><span class="va">knn_animal</span><span class="op">$</span><span class="va">cluster</span>, </span>
<span>                                      <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">animals_df</span>, <span class="st">"canberra"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>animal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">animals_df</span><span class="op">)</span>,</span>
<span>         cluster <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="page-columns page-full">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">silhouette_creature_tbl</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">creature</span>, y <span class="op">=</span> <span class="va">sil_width</span>, fill <span class="op">=</span> <span class="va">cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">silhouette_animals_tbl</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">animal</span>, y <span class="op">=</span> <span class="va">sil_width</span>, fill <span class="op">=</span> <span class="va">cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-cluster-08" class="cell column-page quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-cluster-08-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-cluster_files/figure-html/fig-cluster-08-1.png" class="img-fluid figure-img" data-ref-parent="fig-cluster-08" width="576"></p>
<figcaption class="figure-caption">(a) within cluster sums of squares</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-cluster-08-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-cluster_files/figure-html/fig-cluster-08-2.png" class="img-fluid figure-img" data-ref-parent="fig-cluster-08" width="576"></p>
<figcaption class="figure-caption">(b) gap statistics.</figcaption></figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;53.7— dst.</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">silhouette_creature_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">sil_width</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">sil_width</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  `mean(sil_width)` `sd(sil_width)`
              &lt;dbl&gt;           &lt;dbl&gt;
1             0.204           0.318</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">silhouette_animals_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">sil_width</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">sil_width</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  `mean(sil_width)` `sd(sil_width)`
              &lt;dbl&gt;           &lt;dbl&gt;
1             0.271           0.300</code></pre>
</div>
</div>
</section><section id="sec-clust-heat" class="level3 page-columns page-full" data-number="53.5.5"><h3 data-number="53.5.5" class="anchored" data-anchor-id="sec-clust-heat">
<span class="header-section-number">53.5.5</span> Heatmap</h3>
<p>Heatmaps visualisieren die Distanzen zwischen Beobachtungen indem Heatmaps die numerischen Distanzwerte in einer Farbskala darstellen. Wenn es um Heatmaps in R geht, dann gibt es so viele Möglichkeiten eine Heatmap in R zu erstellen, so dass ich hier nur einen Ausschnitt aus den Sammlungen vorstellen kann. Ich selber mag gerne das R Paket <code>pheatmap</code> mit dem guten Tutorium <a href="https://davetang.github.io/muse/pheatmap.html">Making a heatmap in R with the pheatmap package</a>. Am Anfang des Kapitels wird dieses Paket auch als empfehlenswert genannt. Daneben schauen wir uns nochmal die Heatmaps in dem R Paket <code>gplots</code> mit der Funktion <code>heatmap.2()</code> an.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Weitere Tutorien für die Erstellung einer Heatmap
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Wie immer gibt es eine Vielzahl an tollen Tutorien, die eine Heatmap gut erklären. Ich habe hier einmal eine Auswahl zusammengestellt und du kannst dich da ja mal vertiefend mit beschäftigen, wenn du willst. Teile der Tutorien findest du vermutlich hier im Kapitel wieder.</p>
<ul>
<li>Eine Übersicht zu <a href="https://www.datanovia.com/en/lessons/heatmap-in-r-static-and-interactive-visualization/">Heatmap in R: Static and Interactive Visualization</a>
</li>
<li>Das Tutorium <a href="https://cran.r-project.org/web/packages/dendextend/vignettes/Cluster_Analysis.html#heatmap-1">Hierarchical cluster analysis on famous data sets</a>.</li>
<li>Das R Paket <code>heatmaps</code> <a href="https://bioconductor.org/packages/release/bioc/vignettes/heatmaps/inst/doc/heatmaps.html">Tutorial heatmaps</a> liefert nochmal Beispiele mit genetischen Datensätzen.</li>
<li>Das R Paket <a href="https://jokergoo.github.io/ComplexHeatmap-reference/book/index.html">ComplexHeatmap</a>, was sich vom R Paket <code>pheatmap</code> inspirieren lies. Das geht dann aber hier zu weit, schauen da, wenn du wirklich Heatmaps brauchst.</li>
</ul>
</div>
</div>
</div>
<p>In der <a href="#fig-cluster-09">Abbildung&nbsp;<span>53.8</span></a> sehen wir einmal die Funktion <code>pheatmap()</code> und die sich daraus ergebenden Heatmaps. Die Ähnlihckeit wird einmal in der Legende angegeben. Je nach gewünschten Distanzmaß, kommt da eben was anderes bei raus. Du musst dir da einmal die Hilfeseite zu anschauen ober aber das Tutorium. In unserem Fall wollte ich vier Schnitte für die Spalten des Dendrogramms bei den Tierdaten haben. Bei den Kreaturen habe ich nur zwei Schritte gewählt.</p>
<div class="page-columns page-full">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pheatmap</span><span class="op">(</span><span class="va">animals_df</span>, cutree_cols <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu">pheatmap</span><span class="op">(</span><span class="va">norm_creature_df</span>, cutree_cols <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-cluster-09" class="cell column-page quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-cluster-09-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-cluster_files/figure-html/fig-cluster-09-1.png" class="img-fluid figure-img" data-ref-parent="fig-cluster-09" width="576"></p>
<figcaption class="figure-caption">(a) Tierdaten <code>animals_df</code></figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-cluster-09-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-cluster_files/figure-html/fig-cluster-09-2.png" class="img-fluid figure-img" data-ref-parent="fig-cluster-09" width="576"></p>
<figcaption class="figure-caption">(b) Kreaturendaten <code>norm_creature_df</code></figcaption></figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;53.8— Darstellung der Ähnlichkeiten zwischen den Datensätzen mit der Funktion <code>pheatmap()</code>. Auch hier gibt es dann eine Menge möglicher Optionen, hier nur sehr sparsam gezeigt.</figcaption><p></p>
</figure>
</div>
</div>
<p>Die Funktion <code>heatmap.2()</code> liefert sehr viel mehr Optionen und erlaubt noch etwas feinere Abstimmungen. Du kannst ziemlich einfach noch Dendrogramme für die Zeilen und Spalten ergänzen. Damit die Erstellung der Dendrogramme nicht so fehleranfällig ist, packe ich mir den Code immer in eine Funktion und entscheide dann nach der Option <code>dim</code>, ob ich die Daten transponieren oder nicht-transponieren muss. Die Spalten rechne ich auf den untransponierten Daten und die Zeilen mache ich zu Spalten durch das Transponieren mit der Funktion <code><a href="https://rdrr.io/r/base/t.html">t()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">get_dendro_margin</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">tbl</span>, <span class="va">k</span>, <span class="va">dim</span> <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">dim</span> <span class="op">==</span> <span class="st">"row"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">tmp_tbl</span> <span class="op">&lt;-</span> <span class="va">tbl</span> <span class="op">%&gt;%</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"man"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"ward.D"</span><span class="op">)</span> </span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">tmp_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"man"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"com"</span><span class="op">)</span> </span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">dendro_obj</span> <span class="op">&lt;-</span> <span class="va">tmp_tbl</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="va">as.dendrogram</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="va">ladderize</span><span class="op">%&gt;%</span></span>
<span>    <span class="fu">color_branches</span><span class="op">(</span>k <span class="op">=</span> <span class="va">k</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">dendro_obj</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Also einmal das Dendrogramm für vier Gruppen über die Zeilen gebaut. Wir nutzen <span class="math inline">\(k = 4\)</span> für die Anzahl an einzufärbenden Gruppen sowie die Option <code>dim = "row"</code> um über die untransponierten Zeilen zu Clustern. Das machen wir jetzt einmal für den Tierdatensatz und dann einmal für den Kreaturendatensatz.</p>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dend_animal_r</span> <span class="op">&lt;-</span> <span class="fu">get_dendro_margin</span><span class="op">(</span><span class="va">animals_df</span>, k <span class="op">=</span> <span class="fl">4</span>, dim <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span></span>
<span><span class="va">dend_creature_r</span> <span class="op">&lt;-</span> <span class="fu">get_dendro_margin</span><span class="op">(</span><span class="va">norm_creature_df</span>, k <span class="op">=</span> <span class="fl">4</span>, dim <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Das Ganze dann nochmal über die Spalten auf gleicher Weise nur dann eben mit der Option <code>dim = "col"</code>. Hier haben wir aber nur drei Spalten in den Daten, da können wir dann keine drei Gruppen einfärben. Das wären ja dann die drei Spalten per se.</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dend_animal_c</span> <span class="op">&lt;-</span> <span class="fu">get_dendro_margin</span><span class="op">(</span><span class="va">animals_df</span>, k <span class="op">=</span> <span class="fl">3</span>, dim <span class="op">=</span> <span class="st">"col"</span><span class="op">)</span></span>
<span><span class="va">dend_creature_c</span> <span class="op">&lt;-</span> <span class="fu">get_dendro_margin</span><span class="op">(</span><span class="va">norm_creature_df</span>, k <span class="op">=</span> <span class="fl">2</span>, dim <span class="op">=</span> <span class="st">"col"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In der <a href="#fig-cluster-12">Abbildung&nbsp;<span>53.9</span></a> kommt dann alles einmal zusammen. Wie du siehst, hat die Funktion <code>heatmap.2()</code> noch eine Menge zusätzliche Optionen. Ich habe hier einfach mal ein paar behalten mit denen du dann mal rumspielen kannst.</p>
<div class="page-columns page-full">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">gplots</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gplots/man/heatmap.2.html">heatmap.2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">animals_df</span><span class="op">)</span>, </span>
<span>          main <span class="op">=</span> <span class="st">"Eigenschaften von Tieren"</span>,</span>
<span>          srtCol <span class="op">=</span> <span class="fl">35</span>,</span>
<span>          Rowv <span class="op">=</span> <span class="va">dend_animal_r</span>, Colv <span class="op">=</span> <span class="va">dend_animal_c</span>,</span>
<span>          trace<span class="op">=</span><span class="st">"row"</span>, hline <span class="op">=</span> <span class="cn">NA</span>, tracecol <span class="op">=</span> <span class="st">"darkgrey"</span>,         </span>
<span>          margins <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">5</span><span class="op">)</span>, key.xlab <span class="op">=</span> <span class="st">"no / yes"</span>,</span>
<span>          denscol <span class="op">=</span> <span class="st">"grey"</span>, density.info <span class="op">=</span> <span class="st">"density"</span>,</span>
<span>          col <span class="op">=</span> <span class="fu">gplots</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gplots/man/colorpanel.html">bluered</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu">gplots</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gplots/man/heatmap.2.html">heatmap.2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">norm_creature_df</span><span class="op">)</span>, </span>
<span>          main <span class="op">=</span> <span class="st">"Eigenschaften von Kreaturen"</span>,</span>
<span>          srtCol <span class="op">=</span> <span class="fl">35</span>,</span>
<span>          Rowv <span class="op">=</span> <span class="va">dend_creature_r</span>, Colv <span class="op">=</span> <span class="va">dend_creature_c</span>,</span>
<span>          trace <span class="op">=</span> <span class="st">"row"</span>, hline <span class="op">=</span> <span class="cn">NA</span>, tracecol <span class="op">=</span> <span class="st">"darkgrey"</span>,         </span>
<span>          margins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">7</span><span class="op">)</span>, key.xlab <span class="op">=</span> <span class="st">"no / yes"</span>,</span>
<span>          denscol <span class="op">=</span> <span class="st">"grey"</span>, density.info <span class="op">=</span> <span class="st">"density"</span>,</span>
<span>          col <span class="op">=</span> <span class="fu">gplots</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gplots/man/colorpanel.html">bluered</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-cluster-12" class="cell column-page quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-cluster-12-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-cluster_files/figure-html/fig-cluster-12-1.png" class="img-fluid figure-img" data-ref-parent="fig-cluster-12" width="576"></p>
<figcaption class="figure-caption">(a) Tierdaten <code>animals_df</code></figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-cluster-12-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-cluster_files/figure-html/fig-cluster-12-2.png" class="img-fluid figure-img" data-ref-parent="fig-cluster-12" width="576"></p>
<figcaption class="figure-caption">(b) Kreaturendaten <code>norm_creature_df</code></figcaption></figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;53.9— Darstellung der Ähnlichkeiten zwischen den Datensätzen mit der Funktion <code>heatmap.2()</code>. Auch hier gibt es dann eine Menge möglicher Optionen.</figcaption><p></p>
</figure>
</div>
</div>
</section></section><section id="sec-clust-tidyclust" class="level2 page-columns page-full" data-number="53.6"><h2 data-number="53.6" class="anchored" data-anchor-id="sec-clust-tidyclust">
<span class="header-section-number">53.6</span> Datenanalyse mit <code>tidyclust</code>
</h2>
<p>Wie du schon oben gesehen hast, ist es teilweise echt nervig immer die <code><a href="https://rdrr.io/r/base/row.names.html">row.names()</a></code> mit zu nehmen oder alles ein <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code> zu nutzen. Insbesondere wenn die Daten sehr groß werden, kann kann es sehr ungünstig sein, alles in einem <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code> zu lagern. Deshalb gibt es das Paket <a href="https://tidyclust.tidymodels.org/index.html">tidyclust</a>, was ich hier nochmal vorstellen möchte. Die Visualisierungen von oben können alle genutzt werden. Der Vorteil ist eben, dass wir hier in der <code>tidy</code>-Welt sind und uns auch die <code>recipes()</code> aus dem Klassifikationskapiteln zu nutze machen können. Da ist dann das Normalisierieren und andere Vorbereitungsschritte der Daten viel einfacher. Damit wir auch mal die Datenanalyse mit einem großen Datensatz sehen, nutze ich hier einmal den Datensatz der Gummibärchendaten. Im Folgenden analysieren wir also die Gummibärchendaten einmal mit dem R Paket <code>tidyclust</code>.</p>
<section id="hierarchical-clustering" class="level3 page-columns page-full" data-number="53.6.1"><h3 data-number="53.6.1" class="anchored" data-anchor-id="hierarchical-clustering">
<span class="header-section-number">53.6.1</span> Hierarchical Clustering</h3>

<div class="no-row-height column-margin column-container"><div class="">
<p><a href="https://tidyclust.tidymodels.org/articles/hier_clust.html">tidyclust Hilfeseite für das Hierarchical Clustering</a></p>
</div></div><div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">hc_spec</span> <span class="op">&lt;-</span> <span class="fu">hier_clust</span><span class="op">(</span>num_clusters <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                       linkage_method <span class="op">=</span> <span class="st">"average"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">hc_fit</span> <span class="op">&lt;-</span> <span class="va">hc_spec</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">fit</span><span class="op">(</span><span class="op">~</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">height</span> <span class="op">+</span> <span class="va">semester</span> <span class="op">+</span> <span class="va">most_liked</span>,</span>
<span>      data <span class="op">=</span> <span class="va">gummi_tbl</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wenn es zu lang wird dann auch <code>fit(~ .)</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggdendrogram</span><span class="op">(</span><span class="va">hc_fit</span><span class="op">$</span><span class="va">fit</span>, rotate <span class="op">=</span> <span class="cn">FALSE</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-cluster-11" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-cluster_files/figure-html/fig-cluster-11-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Abbildung&nbsp;53.10— .</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">hc_summary</span> <span class="op">&lt;-</span> <span class="va">hc_fit</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">extract_fit_summary</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hc_summary</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"cluster_assignments"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] Cluster_1 Cluster_2 Cluster_2 Cluster_2 Cluster_2 Cluster_2 Cluster_2
Levels: Cluster_1 Cluster_2 Cluster_3</code></pre>
</div>
</div>
</section><section id="k-means-clustering" class="level3 page-columns page-full" data-number="53.6.2"><h3 data-number="53.6.2" class="anchored" data-anchor-id="k-means-clustering">
<span class="header-section-number">53.6.2</span> k-means Clustering</h3>

<div class="no-row-height column-margin column-container"><div class="">
<p><a href="https://tidyclust.tidymodels.org/articles/k_means.html">tidyclust Hilfeseite für das k-means Clustering</a></p>
</div></div><div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kmeans_spec</span> <span class="op">&lt;-</span> <span class="fu">k_means</span><span class="op">(</span>num_clusters <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">kmeans_spec</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>K Means Cluster Specification (partition)

Main Arguments:
  num_clusters = 3

Computational engine: stats </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kmeans_spec_lloyd</span> <span class="op">&lt;-</span> <span class="fu">k_means</span><span class="op">(</span>num_clusters <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"stats"</span>, algorithm <span class="op">=</span> <span class="st">"Lloyd"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kmeans_fit</span> <span class="op">&lt;-</span> <span class="va">kmeans_spec</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">fit</span><span class="op">(</span><span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">height</span> <span class="op">+</span> <span class="va">semester</span>,</span>
<span>      data <span class="op">=</span> <span class="va">gummi_tbl</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kmeans_fit</span><span class="op">$</span><span class="va">fit</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>K-means clustering with 3 clusters of sizes 92, 23, 77

Cluster means:
       age   height semester
1 22.65217 179.4891 3.967391
2 35.56522 166.2174 1.304348
3 20.63636 163.7662 3.155844

Clustering vector:
  1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20 
  1   3   3   1   1   1   3   3   1   1   3   3   1   1   3   1   3   3   3   3 
 21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40 
  1   3   1   1   3   1   1   1   1   1   1   1   1   3   1   3   1   3   1   1 
 41  42  43  44  45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60 
  1   1   3   1   1   3   1   1   1   3   1   1   1   3   1   3   1   1   1   1 
 61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80 
  1   3   1   3   1   2   3   2   3   3   1   3   2   3   1   1   1   2   2   2 
 81  82  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 
  2   1   2   1   1   1   1   3   2   1   1   3   1   3   3   3   3   3   1   2 
101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 
  3   1   1   3   1   2   3   3   2   2   2   2   3   2   2   3   2   2   2   3 
121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 
  1   2   2   2   1   3   3   3   1   3   3   3   3   1   1   1   1   1   3   3 
141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 
  1   3   3   3   3   3   3   1   1   1   1   1   1   1   3   1   1   1   1   3 
161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 
  3   1   1   1   1   1   1   1   1   1   3   3   3   1   1   3   1   3   1   3 
181 182 183 184 185 186 187 188 189 190 191 192 
  3   3   3   3   3   3   1   3   3   3   3   3 

Within cluster sum of squares by cluster:
[1] 4716.761 2046.435 3643.740
 (between_SS / total_SS =  59.5 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kmeans_fit</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">extract_cluster_assignment</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 192 × 1
   .cluster 
   &lt;fct&gt;    
 1 Cluster_1
 2 Cluster_2
 3 Cluster_2
 4 Cluster_1
 5 Cluster_1
 6 Cluster_1
 7 Cluster_2
 8 Cluster_2
 9 Cluster_1
10 Cluster_1
# ℹ 182 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kmeans_summary</span> <span class="op">&lt;-</span> <span class="va">kmeans_fit</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">extract_fit_summary</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">tibble</span><span class="op">(</span></span>
<span>  orig_labels <span class="op">=</span> <span class="va">kmeans_summary</span><span class="op">$</span><span class="va">orig_labels</span>,</span>
<span>  standard_labels <span class="op">=</span> <span class="va">kmeans_summary</span><span class="op">$</span><span class="va">cluster_assignments</span></span>
<span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 192 × 2
   orig_labels standard_labels
         &lt;int&gt; &lt;fct&gt;          
 1           1 Cluster_1      
 2           3 Cluster_2      
 3           3 Cluster_2      
 4           1 Cluster_1      
 5           1 Cluster_1      
 6           1 Cluster_1      
 7           3 Cluster_2      
 8           3 Cluster_2      
 9           1 Cluster_1      
10           1 Cluster_1      
# ℹ 182 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kmeans_fit</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">extract_centroids</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  .cluster    age height semester
  &lt;fct&gt;     &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
1 Cluster_1  22.7   179.     3.97
2 Cluster_2  20.6   164.     3.16
3 Cluster_3  35.6   166.     1.30</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kmeans_fit</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">tidyclust</span><span class="fu">::</span><span class="fu"><a href="https://tidyclust.tidymodels.org/reference/silhouette_avg.html">silhouette_avg</a></span><span class="op">(</span><span class="fu">select</span><span class="op">(</span><span class="va">gummi_tbl</span>, <span class="va">age</span>, <span class="va">height</span>, <span class="va">semester</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  .metric        .estimator .estimate
  &lt;chr&gt;          &lt;chr&gt;          &lt;dbl&gt;
1 silhouette_avg standard       0.415</code></pre>
</div>
</div>
</section></section><section id="referenzen" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="referenzen">Referenzen</h2>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./stat-modeling-permutationstest.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Permutationstest</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./stat-modeling-pca.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>
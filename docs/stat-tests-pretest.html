<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.552">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Ein Kochbuch mit Rezepten aus der Bio Data Science, Biostatistik, Biometrie und Statistik">

<title>Bio Data Science - 22&nbsp; Der Pre-Test oder Vortest</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./experimental-design-preface.html" rel="next">
<link href="./stat-tests-effect.html" rel="prev">
<link href="./cover2024_favi.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>
<meta name="mermaid-theme" content="neutral">
<script src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Bio Data Science - 22&nbsp; Der Pre-Test oder Vortest">
<meta property="og:description" content="Ein Kochbuch mit Rezepten der Bio Data Science, Biostatistik, Biometrie und Statistik">
<meta property="og:image" content="https://github.com/jkruppa/jkruppa.github.io/raw/master/cover2024.png">
<meta property="og:site_name" content="Bio Data Science">
</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-tests-preface-theory.html">Testen von Hypothesen</a></li><li class="breadcrumb-item"><a href="./stat-tests-pretest.html"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bio Data Science</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/jkruppa/jkruppa.github.io/" title="Quellcode" class="quarto-navigation-tool px-1" aria-label="Quellcode"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Dunkelmodus umschalten"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Willkommen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bibliothek</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./forschungsprozess.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forschungsprozess</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abschlussarbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Abschlussarbeit</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./example-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datenbeispiele</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programmieren in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Buchstaben und Zahlen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Daten einlesen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Reguläre Ausdrücke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-purrr-furrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Ein <code>purrr</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-quarto-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Quarto und Shiny App</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorative Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Testen von Hypothesen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelle Designs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Versuchsplanung in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Einfache Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Fortgeschrittene Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-app.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistische Gruppenvergleiche</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Testen in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Der t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Der Wilcoxon-Mann-Whitney-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Der Friedman Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Der <span class="math inline">\(\mathcal{X}^2\)</span>-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anteil-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Der Anteilstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-trendtest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Der Trendtest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-permutationstest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Der Permutationstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Der Post-hoc-Test</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grundlagen des Modellierens</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Modelgüte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Korrelation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Ausreißer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Variablenselektion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Fehlende Werte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistisches Modellieren</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Modellieren in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-beta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Beta Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-prob-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-robust-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Überlebenszeitanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-noninferiority.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Äquivalenz oder Nichtunterlegenheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Metaanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Fragebogenanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./time-space-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zeitliche und räumliche Analysen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-pseudo-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Pseudo Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Räumliche Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Klassifikation oder maschinelles Lernen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-pre-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Data preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Support vector machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./abspann.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abspann</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-spielecke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">Spielecke</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#genutzte-r-pakete" id="toc-genutzte-r-pakete" class="nav-link active" data-scroll-target="#genutzte-r-pakete"><span class="header-section-number">22.1</span> Genutzte R Pakete</a></li>
  <li><a href="#die-flowchart-die-jeder-möchte" id="toc-die-flowchart-die-jeder-möchte" class="nav-link" data-scroll-target="#die-flowchart-die-jeder-möchte"><span class="header-section-number">22.2</span> Die Flowchart, die jeder möchte…</a></li>
  <li><a href="#pre-test-auf-varianzhomogenität" id="toc-pre-test-auf-varianzhomogenität" class="nav-link" data-scroll-target="#pre-test-auf-varianzhomogenität"><span class="header-section-number">22.3</span> Pre-Test auf Varianzhomogenität</a>
  <ul class="collapse">
  <li><a href="#varianzen-sind-homogen-fallzahl-niedrig" id="toc-varianzen-sind-homogen-fallzahl-niedrig" class="nav-link" data-scroll-target="#varianzen-sind-homogen-fallzahl-niedrig"><span class="header-section-number">22.3.1</span> Varianzen sind homogen, Fallzahl niedrig</a></li>
  <li><a href="#varianzen-sind-heterogen-fallzahl-niedrig" id="toc-varianzen-sind-heterogen-fallzahl-niedrig" class="nav-link" data-scroll-target="#varianzen-sind-heterogen-fallzahl-niedrig"><span class="header-section-number">22.3.2</span> Varianzen sind heterogen, Fallzahl niedrig</a></li>
  </ul></li>
  <li><a href="#pre-test-auf-normalverteilung" id="toc-pre-test-auf-normalverteilung" class="nav-link" data-scroll-target="#pre-test-auf-normalverteilung"><span class="header-section-number">22.4</span> Pre-Test auf Normalverteilung</a>
  <ul class="collapse">
  <li><a href="#approximativ-normalverteilt-niedrige-fallzahl" id="toc-approximativ-normalverteilt-niedrige-fallzahl" class="nav-link" data-scroll-target="#approximativ-normalverteilt-niedrige-fallzahl"><span class="header-section-number">22.4.1</span> Approximativ normalverteilt, niedrige Fallzahl</a></li>
  <li><a href="#nicht-normalverteilt-niedrige-fallzahl" id="toc-nicht-normalverteilt-niedrige-fallzahl" class="nav-link" data-scroll-target="#nicht-normalverteilt-niedrige-fallzahl"><span class="header-section-number">22.4.2</span> Nicht normalverteilt, niedrige Fallzahl</a></li>
  <li><a href="#testen-der-normalverteilungsannahme-in-mehreren-gruppen" id="toc-testen-der-normalverteilungsannahme-in-mehreren-gruppen" class="nav-link" data-scroll-target="#testen-der-normalverteilungsannahme-in-mehreren-gruppen"><span class="header-section-number">22.4.3</span> Testen der Normalverteilungsannahme in mehreren Gruppen</a></li>
  </ul></li>
  <li><a href="#visuelle-überprüfung" id="toc-visuelle-überprüfung" class="nav-link" data-scroll-target="#visuelle-überprüfung"><span class="header-section-number">22.5</span> Visuelle Überprüfung</a></li>
  <li><a href="#referenzen" id="toc-referenzen" class="nav-link" data-scroll-target="#referenzen">Referenzen</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-tests-pretest.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-tests-pretest.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-tests-preface-theory.html">Testen von Hypothesen</a></li><li class="breadcrumb-item"><a href="./stat-tests-pretest.html"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-pretest" class="quarto-section-identifier"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code zeigen</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code verbergen</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Quellcode anzeigen</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><em>Letzte Änderung am 16. May 2024 um 19:54:11</em></p>
<blockquote class="blockquote">
<p><em>“I struggle with some demons; They were middle class and tame.” — Leonard Cohen, You Want It Darker</em></p>
</blockquote>
<p>Der Pre-Test, ein Kapitel was ich nicht mag. Also eher weniger das Kapitel als den Pre-Test. Auf der einen Seite sind die Pre-Tests hoffnungslos veraltet. Pre-Tests stammen aus einer Zeit in der man sich nicht einfach die Daten angucken konnte. Mit angucken meine ich dann in <code>ggplot</code> visualisieren. Die Idee hinter Pre-Test ist eigentlich die Angst selber die Entscheidung zu treffen, ob die Daten varianzhomogen oder normalverteilt sind. Eine bessere Lösung ist immer noch das Outcome <span class="math inline">\(y\)</span> zu transformieren (siehe <a href="eda-transform.html" class="quarto-xref"><span>Kapitel 18</span></a>) und dann das untransformierte Modell mit transformierten Modell zu vergleichen (siehe <a href="stat-modeling-basic.html#sec-model-basic-compare" class="quarto-xref"><span>Kapitel 41.6</span></a>). Auf der anderen Seite ist der Pre-Test eine Art übermächtiger Entscheider. Dabei sind die Formel sehr trivial und das Konzept eher simpel. Wir können uns aber folgende Faustregel merken:</p>
<ol type="1">
<li>Wir testen die Varianzhomogenität auf dem <em>ganzen</em> Datensatz.</li>
<li>Wir testen die Abweichung von der Normalverteilung für jede Behandlungsgruppe <em>getrennt</em>.</li>
</ol>
<p>Neben dieser Angst eine Entscheidung zu treffen, hilft einem der Pre-Test zur Varianzhomogenität und der Pre-Test zur Normalverteilung bei kleiner Fallzahl auch nicht wirklich weiter, wie wir gleich sehen werden. Beide Pre-Tests funktionieren erst bei wirklich hohen Fallzahlen gut. Mit hohen Fallzahlen meine ich, Fallzahlen von über 20 Beobachtungen <em>je Gruppe</em> bzw. Level des Faktors. Bei kleiner Fallzahl, also der üblichen Anzahl von weniger als zehn Wiederholungen, können wir auch nur die Boxplots oder Dotplots anschauen. Darüber hinaus können wir uns auch schnell ins Abseits testen, so dass wir gar keinen Test mehr übrig haben um unsere Daten auszuwerten.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/angel_01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="images/angel_01.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p>Probleme mit dem Pre-Tests ist, dass die Fallzahl in unseren Daten <span class="math inline">\(D\)</span> oft <strong>viel zu klein</strong> ist um eine eindeutige Aussage zu treffen.</p>
</blockquote>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Visuelle Überprüfung der Normalverteilung und Varianzheterogenität
</div>
</div>
<div class="callout-body-container callout-body">
<p>Das <a href="https://olsrr.rsquaredacademy.com/articles/intro.html">R Paket <code>{olsrr}</code></a> erlaubt eine weitreichende Diagnostik auf einem normalverteilten Outcome <span class="math inline">\(y\)</span>. Es ist besser sich die Diagnostikplots anzuschauen, als die statistischen Pre-Tests zu rechnen. Besonders bei kleiner Fallzahl. Wenn du dazu dann noch Literatur für deine Abschlussarbeit brauchst, dann nutze doch die Arbeit von <span class="citation" data-cites="zuur2010protocol">Zuur u.&nbsp;a. (<a href="#ref-zuur2010protocol" role="doc-biblioref">2010</a>)</span> mit dem Artikel <a href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/j.2041-210X.2009.00001.x">A protocol for data exploration to avoid common statistical problems</a> oder aber die Arbeit von <span class="citation" data-cites="kozak2018s">Kozak und Piepho (<a href="#ref-kozak2018s" role="doc-biblioref">2018</a>)</span> mit dem Artikel <a href="https://onlinelibrary.wiley.com/doi/pdf/10.1111/jac.12220?casa_token=22Jm83-kW-MAAAAA:yh0EVuGiGHWDsuPiVP8ZLj51OCasdpIiVWUcYv3Q8dGaIo0yMeNZNwkHIk1ibTCsLhkxbLKZrwZSByo">What’s normal anyway? Residual plots are more telling than significance tests when checking ANOVA assumptions</a>.</p>
<p>Es ist grundsätzlich besser verschiedene Modelle zu fitten und dann sich in <a href="stat-linear-reg-quality.html" class="quarto-xref"><span>Kapitel 42</span></a> die Güte oder Qualität der Modelle anzuschauen. Jedenfalls ist das meiner Meinung nach die bessere Lösung. Da aber immer wieder nach den Pre-Tests gefragt wird, habe ich auch dieses Kapitel erschaffen.</p>
<p>Ich habe dir am Ende des Kapitels nochmal den einfachen Weg dein Modell zu überprüfen an einem etwas komplexeren Datensatz aufgezeigt. Schau dir dazu dann die <a href="#fig-pretest-check-model" class="quarto-xref">Abbildung&nbsp;<span>22.16</span></a> einmal an. Diese Abbildung kannst du dann auch nachbauen und in deinen Anhang packen sowie dich mit der Referenz drauf beziehen.</p>
</div>
</div>
<section id="genutzte-r-pakete" class="level2" data-number="22.1">
<h2 data-number="22.1" class="anchored" data-anchor-id="genutzte-r-pakete"><span class="header-section-number">22.1</span> Genutzte R Pakete</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, magrittr, olsrr,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               broom, car, performance, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               see, scales, readxl, nlme,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               conflicted)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>filter)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>select)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>An der Seite des Kapitels findest du den Link <em>Quellcode anzeigen</em>, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</p>
</section>
<section id="die-flowchart-die-jeder-möchte" class="level2" data-number="22.2">
<h2 data-number="22.2" class="anchored" data-anchor-id="die-flowchart-die-jeder-möchte"><span class="header-section-number">22.2</span> Die Flowchart, die jeder möchte…</h2>
<p>Dann hier mal gleich zu Beginn die Flowchart, die jeder gerne möchte. In der <a href="#fig-mermaid-pretest-01" class="quarto-xref">Abbildung&nbsp;<span>22.1</span></a> sehen wir einmal dargestellt, welches statistische Modell wir rechnen können um dann eine ANOVA und ein Posthoc-Test anzuschließen. Wie du auf den ersten Blick siehst, ist es immer besser auf der linken Seite der Flowchart zu sein. Viele Merkmale in den Agrarwissenschaften folgen per se einer Normalverteilung, so dass sich nur die Frage nach der Varianzhomogenität stellt.</p>
<div class="cell" data-fig-width="6" data-layout-align="default">
<div class="cell-output-display">
<div id="fig-mermaid-pretest-01" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mermaid-pretest-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>
<pre class="mermaid mermaid-js" data-label="fig-mermaid-pretest-01">flowchart TD
    A("Normalverteiltes Outcome
       in jeder Versuchsgruppe"):::factor --- B(((ja))) --&gt; B1 
    A("Normalverteiltes Outcome
       in jeder Versuchsgruppe"):::factor --- F(((nein))) --&gt; B2
    subgraph B1["Mittelwertsvergleiche"]
    C("Varianzhomogenität
       über alle Gruppen"):::factor --- D((("ja"))) --&gt; E("lm()"):::factor
    C("Varianzhomogenität
       über alle Gruppen"):::factor --- J(((nein))) --&gt; K("gls()"):::factor 
    end
    subgraph B2["Medianvergleiche, OR oder RR"]
    G("Varianzhomogenität
       über alle Gruppen"):::factor --- H(((ja))) --&gt; I("rq()"):::factor  
    G("Varianzhomogenität
       über alle Gruppen"):::factor --- L(((nein))) 
    end
    classDef factor fill:#56B4E9,stroke:#333,stroke-width:0.75px
</pre>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mermaid-pretest-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;22.1— Flowchart für die Entscheidung welches statistische Modell gerechnet werden kann: <code>lm()</code>, lineare Regression, <code>gls()</code>, generalized least squares Regression, <code>rq()</code>, Quantilesregression. Die Funktionen finden sich teilweise in eigenen R Paketen. Bei einem nicht-normalverteilten Outcome mit Varianzheterogenität über die Gruppen müssen wir nochmal gemeinsam in die Daten schauen.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Du findest die vorgeschlagenen Funktionen dann in den entsprechenden Kapiteln zur ANOVA und den Posthoc-Tests. Du kannst dir dann dort den Code zusammensuchen. Je nach deiner Datenlage musst du dann nochmal etwas an dem R Code programmieren. Beachte, dass die Funktionen sich teilweise in eigenen R Paketen finden lassen. So ist die Funktion <code>gls()</code> im R Paket <code>{nlme}</code> und die Funktion <code>rq()</code> im R Paket <code>{quantreg}</code> zu finden. Du kannst auch bei Varianzheterogenität das R Paket <code>{sandwich}</code> nutzen und einen entsprechend angepassten Varianzschätzer. Mehr findest du dazu bei den Posthoc-Test in dem Abschnitt zu dem <a href="stat-tests-posthoc.html#sec-posthoc-var-heterogen">Gruppenvergleich unter Varianzheterogenität</a> oder gleich im ersten Zerforschenbeispiel zum einfaktoriellen Barplot.</p>
<p>Und dann auch gleich hier, weil es so schön passt, die Zerforschenbeispiele zu der obigen Flowchart. Im Prinzip kannst du einmal rein schauen und sehen, ob die Abbildung dem entspricht was du möchtest. Mehr zu dem Code findest du dann in den entsprechenden Kapiteln zu den multiplen Vergleichen oder aber der Regressionen.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Zerforschen: Einfaktorieller Barplot mit <code>lm()</code>, <code>gls()</code> oder <code>sandwich</code>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In diesem Zerforschenbeispiel wollen wir uns einen einfaktoriellen Barplot oder Säulendiagramm anschauen. Daher fangen wir mit der folgenden Abbildung einmal an. Wir haben hier ein Säulendiagramm mit <em>compact letter display</em> vorliegen. Daher brauchen wir eigentlich gar nicht so viele Zahlen. Für jede der vier Behandlungen jeweils einmal einen Mittelwert für die Höhe der Säule sowie einmal die Standardabweichung. Die Standardabweichung addieren und subtrahieren wir dann jeweils von dem Mittelwert und schon haben wir die Fehlerbalken. Für eine detaillierte Betrachtung der Erstellung der Abbildung schauen einmal in das Kapitel zum <a href="eda-ggplot.html#sec-eda-barplot">Barplot oder Balkendiagramm oder Säulendiagramm</a>.</p>
<div id="fig-ur-barplot" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ur-barplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/zerforschen_barplot_simple.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" data-glightbox="description: .lightbox-desc-2"><img src="images/eda/zerforschen_barplot_simple.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ur-barplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;22.2— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein simples Säulendiagramm mit sehr für Farbblinde ungünstigen Farben. Es sind die Mittelwerte sowie die Standardabweichung durch die Fehlerbalken dargestellt.
</figcaption>
</figure>
</div>
<p>Als erstes brauchen wir die Daten. Die Daten habe ich mir in dem Datensatz <code>zerforschen_barplot_simple.xlsx</code> selber ausgedacht. Ich habe einfach die obige Abbildung genommen und den Mittelwert abgeschätzt. Dann habe ich die vier Werte alle um den Mittelwert streuen lassen. Dabei habe ich darauf geachtet, dass die Streuung dann in der letzten Behandlung am größten ist.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>barplot_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/zerforschen_barplot_simple.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt =</span> <span class="fu">factor</span>(trt, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"water"</span>, <span class="st">"rqflex"</span>, <span class="st">"nitra"</span>, <span class="st">"laqua"</span>),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wasserdestilation"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"RQflex Nitra"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Nitrachek"</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Laqua Nitrat"</span>)))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>barplot_tbl </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 2
   trt               nitrat
   &lt;fct&gt;              &lt;dbl&gt;
 1 Wasserdestilation    135
 2 Wasserdestilation    130
 3 Wasserdestilation    145
 4 Wasserdestilation    135
 5 RQflex Nitra         120
 6 RQflex Nitra         130
 7 RQflex Nitra         135
 8 RQflex Nitra         135
 9 Nitrachek            100
10 Nitrachek            120
11 Nitrachek            130
12 Nitrachek            130
13 Laqua Nitrat         230
14 Laqua Nitrat         210
15 Laqua Nitrat         205
16 Laqua Nitrat         220</code></pre>
</div>
</div>
<p>Im Folgenden sparen wir uns den Aufruf mit <code>group_by()</code> den du aus dem <a href="eda-ggplot.html#sec-eda-barplot">Kapitel zum Barplot</a> schon kennst. Wir machen das alles zusammen in der Funktion <code>emmeans()</code> aus dem gleichnamigen R Paket. Der Vorteil ist, dass wir dann auch gleich die Gruppenvergleiche und auch das <em>compact letter display</em> erhalten. Einzig die Standardabweichung <span class="math inline">\(s\)</span> wird uns nicht wiedergegeben sondern der Standardfehler <span class="math inline">\(SE\)</span>. Da aber folgernder Zusammenhang vorliegt, können wir gleich den Standardfehler in die Standardabweichung umrechnen.</p>
<p><span class="math display">\[
SE = \cfrac{s}{\sqrt{n}}
\]</span></p>
<p>Wir rechnen also gleich einfach den Standardfehler <span class="math inline">\(SE\)</span> mal der <span class="math inline">\(\sqrt{n}\)</span> um dann die Standardabweichung zu erhalten. In unserem Fall ist <span class="math inline">\(n=4\)</span> nämlich die Anzahl Beobachtungen je Gruppe. Wenn du mal etwas unterschiedliche Anzahlen hast, dann kannst du auch einfach den Mittelwert der Fallzahl der Gruppen nehmen. Da überfahren wir zwar einen statistischen Engel, aber der Genauigkeit ist genüge getan.</p>
<p>In den beiden Tabs siehst du jetzt einmal die Modellierung unter der Annahme der Varianzhomogenität mit der Funktion <code>lm()</code> und einmal die Modellierung unter der Annahme der Varianzheterogenität mit der Funktion <code>gls()</code> aus dem R Paket <code>nlme</code>. Wie immer lässt sich an Boxplots visuell überprüfen, ob wir Homogenität oder Heterogenität vorliegen haben. Oder aber du schaust nochmal in das Kapitel <a href="#sec-pretest">Der Pre-Test oder Vortest</a>, wo du mehr erfährst.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="zerforschen-emmeans-barplot-1fac">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Varianzhomogenität</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Varianzheterogenität (<code>gls</code>)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Varianzheterogenität (<code>vcovHAC</code>)</a></li></ul>
<div class="tab-content" data-group="zerforschen-emmeans-barplot-1fac">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Hier gehen wir nicht weiter auf die Funktionen ein, bitte schaue dann einmal in dem Abschnitt zu <a href="stat-tests-posthoc.html#sec-posthoc-emmeans">Gruppenvergleich mit dem <code>emmeans</code> Paket</a>. Wir entfernen aber noch die Leerzeichen bei den Buchstaben mit der Funktion <code>str_trim()</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>emmeans_homogen_tbl <span class="ot">&lt;-</span> <span class="fu">lm</span>(nitrat <span class="sc">~</span> trt, <span class="at">data =</span> barplot_tbl) <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt) <span class="sc">|&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group),</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd =</span> SE <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">4</span>)) </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>emmeans_homogen_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 8
  trt               emmean    SE    df lower.CL upper.CL .group    sd
  &lt;fct&gt;              &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
1 Nitrachek           120   5.08    12     109.     131. a       10.2
2 RQflex Nitra        130   5.08    12     119.     141. ab      10.2
3 Wasserdestilation   136.  5.08    12     125.     147. b       10.2
4 Laqua Nitrat        216.  5.08    12     205.     227. c       10.2</code></pre>
</div>
</div>
<p>In dem Objekt <code>emmeans_homogen_tbl</code> ist jetzt alles enthalten für unsere Barplots mit dem <em>compact letter display</em>. Wie dir vielleicht auffällt sind alle Standardfehler und damit alle Standardabweichungen für alle Gruppen gleich, das war ja auch unsere Annahme mit der Varianzhomogenität.</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Hier gehen wir nicht weiter auf die Funktionen ein, bitte schaue dann einmal in dem Abschnitt zu <a href="stat-tests-posthoc.html#sec-posthoc-emmeans">Gruppenvergleich mit dem <code>emmeans</code> Paket</a> und natürlich in den Abschnitt zu dem <a href="stat-tests-posthoc.html#sec-posthoc-var-heterogen">Gruppenvergleich unter Varianzheterogenität</a>. Wir entfernen aber noch die Leerzeichen bei den Buchstaben mit der Funktion <code>str_trim()</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>emmeans_hetrogen_gls_tbl <span class="ot">&lt;-</span> <span class="fu">gls</span>(nitrat <span class="sc">~</span> trt, <span class="at">data =</span> barplot_tbl, </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> trt)) <span class="sc">|&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt) <span class="sc">|&gt;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd =</span> SE <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">4</span>)) </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>emmeans_hetrogen_gls_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 8
  trt               emmean    SE    df lower.CL upper.CL .group    sd
  &lt;fct&gt;              &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
1 Nitrachek           120   7.07  3.00     97.5     143. a      14.1 
2 RQflex Nitra        130   3.54  3.00    119.      141. a       7.07
3 Wasserdestilation   136.  3.15  3.00    126.      146. a       6.29
4 Laqua Nitrat        216.  5.54  3.00    199.      234. b      11.1 </code></pre>
</div>
</div>
<p>In dem Objekt <code>emmeans_hetrogen_gls_tbl</code> ist jetzt alles enthalten für unsere Barplots mit dem <em>compact letter display</em>. In diesem Fall hier sind die Standardfehler und damit auch die Standardabweichungen nicht alle gleich, wir haben ja für jede Gruppe eine eigene Standardabweichung angenommen. Die Varianzen sollten ja auch heterogen sein.</p>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>Hier gehen wir nicht weiter auf die Funktionen ein, bitte schaue dann einmal in dem Abschnitt zu <a href="stat-tests-posthoc.html#sec-posthoc-emmeans">Gruppenvergleich mit dem <code>emmeans</code> Paket</a> und natürlich in den Abschnitt zu dem <a href="stat-tests-posthoc.html#sec-posthoc-var-heterogen">Gruppenvergleich unter Varianzheterogenität</a>. Wir entfernen aber noch die Leerzeichen bei den Buchstaben mit der Funktion <code>str_trim()</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>emmeans_hetrogen_vcov_tbl <span class="ot">&lt;-</span> <span class="fu">lm</span>(nitrat <span class="sc">~</span> trt, <span class="at">data =</span> barplot_tbl) <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt, <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHAC) <span class="sc">|&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd =</span> SE <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">4</span>)) </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>emmeans_hetrogen_vcov_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 8
  trt               emmean    SE    df lower.CL upper.CL .group    sd
  &lt;fct&gt;              &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
1 Nitrachek           120   7.84    12     103.     137. a      15.7 
2 RQflex Nitra        130   3.92    12     121.     139. a       7.84
3 Wasserdestilation   136.  2.06    12     132.     141. a       4.12
4 Laqua Nitrat        216.  4.94    12     205.     227. b       9.88</code></pre>
</div>
</div>
<p>In dem Objekt <code>emmeans_hetrogen_vcov_tbl</code> ist jetzt alles enthalten für unsere Barplots mit dem <em>compact letter display</em>. In diesem Fall hier sind die Standardfehler und damit auch die Standardabweichungen nicht alle gleich, wir haben ja für jede Gruppe eine eigene Standardabweichung angenommen. Die Varianzen sollten ja auch heterogen sein.</p>
</div>
</div>
</div>
<p>Und dann haben wir auch schon die Abbildungen hier erstellt. Ja vielleicht passen die Standardabweichungen nicht so richtig, da könnte man nochmal an den Daten spielen und die Werte solange ändern, bis es besser passt. Du hast aber jetzt eine Idee, wie der Aufbau funktioniert. Die beiden Tabs zeigen dir dann die Abbildungen für die beiden Annahmen der Varianzhomogenität oder Varianzheterogenität. Der Code ist der gleiche für die drei Abbildungen, die Daten <code>emmeans_homogen_tbl</code> oder <code>emmeans_hetrogen_gls_tbl</code> ober <code>emmeans_hetrogen_vcov_tbl</code> sind das Ausschlaggebende.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="zerforschen-emmeans-barplot-1fac">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Varianzhomogenität</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Varianzheterogenität (<code>gls</code>)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Varianzheterogenität (<code>vcovHAC</code>)</a></li></ul>
<div class="tab-content" data-group="zerforschen-emmeans-barplot-1fac">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> emmeans_homogen_tbl, <span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> emmean, <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>sd, <span class="at">ymax =</span> emmean<span class="sc">+</span>sd), </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Nitrat-Konzentration </span><span class="sc">\n</span><span class="st"> im Tannensaft [mg/L]"</span>) <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">250</span>) <span class="sc">+</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span> </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> emmean <span class="sc">+</span> sd <span class="sc">+</span> <span class="dv">10</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-simple-emmeans-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-simple-emmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-pretest_files/figure-html/fig-ggplot-zerforschen-barplot-simple-emmeans-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" data-glightbox="description: .lightbox-desc-3"><img src="stat-tests-pretest_files/figure-html/fig-ggplot-zerforschen-barplot-simple-emmeans-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-simple-emmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;22.3— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut mit den Informationen aus der Funktion <code>emmeans()</code>. Das <em>compact letter display</em> wird dann über das <em>geom_text()</em> gesetzt.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> emmeans_hetrogen_gls_tbl, <span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> emmean, <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>sd, <span class="at">ymax =</span> emmean<span class="sc">+</span>sd), </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Nitrat-Konzentration </span><span class="sc">\n</span><span class="st"> im Tannensaft [mg/L]"</span>) <span class="sc">+</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">250</span>) <span class="sc">+</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span> </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> emmean <span class="sc">+</span> sd <span class="sc">+</span> <span class="dv">10</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-simple-emmeans-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-simple-emmeans-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-pretest_files/figure-html/fig-ggplot-zerforschen-barplot-simple-emmeans-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" data-glightbox="description: .lightbox-desc-4"><img src="stat-tests-pretest_files/figure-html/fig-ggplot-zerforschen-barplot-simple-emmeans-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-simple-emmeans-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;22.4— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut mit den Informationen aus der Funktion <code>emmeans()</code>. Das <em>compact letter display</em> wird dann über das <em>geom_text()</em> gesetzt. Die Varianzheterogenität nach der Funktion <code>gls()</code> im obigen Modell berücksichtigt.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> emmeans_hetrogen_vcov_tbl, <span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> emmean, <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>sd, <span class="at">ymax =</span> emmean<span class="sc">+</span>sd), </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Nitrat-Konzentration </span><span class="sc">\n</span><span class="st"> im Tannensaft [mg/L]"</span>) <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">250</span>) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span> </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> emmean <span class="sc">+</span> sd <span class="sc">+</span> <span class="dv">10</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-simple-emmeans-3" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-simple-emmeans-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-pretest_files/figure-html/fig-ggplot-zerforschen-barplot-simple-emmeans-3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" data-glightbox="description: .lightbox-desc-5"><img src="stat-tests-pretest_files/figure-html/fig-ggplot-zerforschen-barplot-simple-emmeans-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-simple-emmeans-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;22.5— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut mit den Informationen aus der Funktion <code>emmeans()</code>. Das <em>compact letter display</em> wird dann über das <em>geom_text()</em> gesetzt. Die Varianzheterogenität nach der Funktion <code>sandwich::vcovHAC</code> im obigen Modell berücksichtigt.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Am Ende kannst du dann folgenden Code noch hinter deinen <code>ggplot</code> Code ausführen um dann deine Abbildung als <code>*.png</code>-Datei zu speichern. Dann hast du die Abbildung super nachgebaut und sie sieht auch wirklich besser aus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"my_ggplot_barplot.png"</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Zerforschen: Zweifaktorieller Barplot mit <code>lm()</code> oder <code>gls()</code>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In diesem Zerforschenbeispiel wollen wir uns einen zweifaktoriellen Barplot anschauen. Wir haben hier ein Säulendiagramm mit <em>compact letter display</em> vorliegen. Daher brauchen wir eigentlich gar nicht so viele Zahlen. Für jede der vier Zeitpunkte und der Kontrolle jeweils einmal einen Mittelwert für die Höhe der Säule sowie einmal die Standardabweichung. Da wir hier aber noch mit <code>emmeans()</code> eine Gruppenvergleich rechnen wollen, brauchen wir mehr Beobachtungen. Wir erschaffen uns also fünf Beobachtungen je Zeit/Jod-Kombination. Für eine detaillierte Betrachtung der Erstellung der Abbildung schauen einmal in das Kapitel zum <a href="eda-ggplot.html#sec-eda-barplot">Barplot oder Balkendiagramm oder Säulendiagramm</a>.</p>
<div id="fig-ur-barplot-02" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ur-barplot-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/zerforschen_barplot_2fac.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" data-glightbox="description: .lightbox-desc-6"><img src="images/eda/zerforschen_barplot_2fac.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ur-barplot-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;22.6— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein Barplot mit den zwei Faktoren Zeit und die Iodine Form.
</figcaption>
</figure>
</div>
<p>Als erstes brauchen wir die Daten. Die Daten habe ich mir in dem Datensatz <code>zerforschen_barplot_2fac_target_emmeans.xlsx</code> selber ausgedacht. Ich habe einfach die obige Abbildung genommen und den Mittelwert abgeschätzt. Dann habe ich die fünf Werte alle um den Mittelwert streuen lassen. Ich brauche hier eigentlich mehr als fünf Werte, sonst kriegen wir bei <code>emmeans()</code> und der Interaktion im <code>gls()</code>-Modell Probleme, aber da gibt es dann bei kleinen Fallzahlen noch ein Workaround. Bitte nicht mit weniger als fünf Beobachtungen versuchen, dann wird es schwierig mit der Konsistenz der Schätzer aus dem Modell.</p>
<p>Ach, und ganz wichtig. Wir entfernen die Kontrolle, da wir die Kontrolle nur mit einer Iodid-Stufe gemessen haben. Dann können wir weder die Interaktion rechnen, noch anständig eine Interpretation durchführen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>barplot_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/zerforschen_barplot_2fac_target_emmeans.xlsx"</span>)  <span class="sc">|&gt;</span>  </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">factor</span>(time, </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"ctrl"</span>, <span class="st">"7"</span>, <span class="st">"11"</span>, <span class="st">"15"</span>, <span class="st">"19"</span>),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Contr."</span>, <span class="st">"07:00"</span>, <span class="st">"11:00"</span>, <span class="st">"15:00"</span>, <span class="st">"19:00"</span>)),</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">as_factor</span>(type)) <span class="sc">|&gt;</span> </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(time <span class="sc">!=</span> <span class="st">"Contr."</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>barplot_tbl </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 3
   time  type  iodine
   &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt;
 1 07:00 KIO3      50
 2 07:00 KIO3      55
 3 07:00 KIO3      60
 4 07:00 KIO3      52
 5 07:00 KIO3      62
 6 07:00 KI        97
 7 07:00 KI        90
 8 07:00 KI        83
 9 07:00 KI        81
10 07:00 KI        98
# ℹ 30 more rows</code></pre>
</div>
</div>
<p>Im Folgenden sparen wir uns den Aufruf mit <code>group_by()</code> den du aus dem <a href="eda-ggplot.html#sec-eda-barplot">Kapitel zum Barplot</a> schon kennst. Wir machen das alles zusammen in der Funktion <code>emmeans()</code> aus dem gleichnamigen R Paket. Der Vorteil ist, dass wir dann auch gleich die Gruppenvergleiche und auch das <em>compact letter display</em> erhalten. Einzig die Standardabweichung <span class="math inline">\(s\)</span> wird uns nicht wiedergegeben sondern der Standardfehler <span class="math inline">\(SE\)</span>. Da aber folgernder Zusammenhang vorliegt, können wir gleich den Standardfehler in die Standardabweichung umrechnen.</p>
<p><span class="math display">\[
SE = \cfrac{s}{\sqrt{n}}
\]</span></p>
<p>Wir rechnen also gleich einfach den Standardfehler <span class="math inline">\(SE\)</span> mal der <span class="math inline">\(\sqrt{n}\)</span> um dann die Standardabweichung zu erhalten. In unserem Fall ist <span class="math inline">\(n=5\)</span> nämlich die Anzahl Beobachtungen je Gruppe. Wenn du mal etwas unterschiedliche Anzahlen hast, dann kannst du auch einfach den Mittelwert der Fallzahl der Gruppen nehmen. Da überfahren wir zwar einen statistischen Engel, aber der Genauigkeit ist genüge getan.</p>
<p>In den beiden Tabs siehst du jetzt einmal die Modellierung unter der Annahme der Varianzhomogenität mit der Funktion <code>lm()</code> und einmal die Modellierung unter der Annahme der Varianzheterogenität mit der Funktion <code>gls()</code> aus dem R Paket <code>nlme</code>. Wie immer lässt sich an Boxplots visuell überprüfen, ob wir Homogenität oder Heterogenität vorliegen haben. Oder aber du schaust nochmal in das Kapitel <a href="#sec-pretest">Der Pre-Test oder Vortest</a>, wo du mehr erfährst.</p>
<p>Wenn du <em>jeden</em> Boxplot miteinander vergleichen willst, dann musst du in dem Code <code>emmeans(~ time * type)</code> setzen. Dann berechnet dir <code>emmeans</code> für jede Faktorkombination einen paarweisen Vergleich.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="zerforschen-emmeans-barplot-2fac">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Varianzhomogenität</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Varianzheterogenität</a></li></ul>
<div class="tab-content" data-group="zerforschen-emmeans-barplot-2fac">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Hier gehen wir nicht weiter auf die Funktionen ein, bitte schaue dann einmal in dem Abschnitt zu <a href="stat-tests-posthoc.html#sec-posthoc-emmeans">Gruppenvergleich mit dem <code>emmeans</code> Paket</a>. Wir entfernen aber noch die Leerzeichen bei den Buchstaben mit der Funktion <code>str_trim()</code>. Wir rechnen hier die Vergleiche getrennt für die beiden Jodformen. Wenn du alles mit allem Vergleichen willst, dann setze bitte <code>emmeans(~ time * type)</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>emmeans_homogen_tbl <span class="ot">&lt;-</span> <span class="fu">lm</span>(iodine <span class="sc">~</span> time <span class="sc">+</span> type <span class="sc">+</span> time<span class="sc">:</span>type, <span class="at">data =</span> barplot_tbl) <span class="sc">|&gt;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> time <span class="sc">|</span> type) <span class="sc">|&gt;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd =</span> SE <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">5</span>)) </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>emmeans_homogen_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 9
  time  type  emmean    SE    df lower.CL upper.CL .group    sd
  &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
1 07:00 KIO3    55.8  5.58    32     44.4     67.2 a       12.5
2 11:00 KIO3    75.2  5.58    32     63.8     86.6 b       12.5
3 15:00 KIO3    81    5.58    32     69.6     92.4 b       12.5
4 19:00 KIO3    84.2  5.58    32     72.8     95.6 b       12.5
5 07:00 KI      89.8  5.58    32     78.4    101.  a       12.5
6 19:00 KI      90    5.58    32     78.6    101.  a       12.5
7 15:00 KI     124    5.58    32    113.     135.  b       12.5
8 11:00 KI     152    5.58    32    141.     163.  c       12.5</code></pre>
</div>
</div>
<p>In dem Objekt <code>emmeans_homogen_tbl</code> ist jetzt alles enthalten für unsere Barplots mit dem <em>compact letter display</em>. Wie dir vielleicht auffällt sind alle Standardfehler und damit alle Standardabweichungen für alle Gruppen gleich, das war ja auch unsere Annahme mit der Varianzhomogenität.</p>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Hier gehen wir nicht weiter auf die Funktionen ein, bitte schaue dann einmal in dem Abschnitt zu <a href="stat-tests-posthoc.html#sec-posthoc-emmeans">Gruppenvergleich mit dem <code>emmeans</code> Paket</a>. Wir entfernen aber noch die Leerzeichen bei den Buchstaben mit der Funktion <code>str_trim()</code>. Da wir hier etwas Probleme mit der Fallzahl haben, nutzen wir die Option <code>mode = "appx-satterthwaite"</code> um dennoch ein vollwertiges, angepasstes Modell zu erhalten. Du kannst die Option auch erstmal entfernen und schauen, ob es mit deinen Daten auch so klappt. Wir rechnen hier die Vergleiche getrennt für die beiden Jodformen. Wenn du alles mit allem Vergleichen willst, dann setze bitte <code>emmeans(~ time * type)</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>emmeans_hetrogen_tbl <span class="ot">&lt;-</span> <span class="fu">gls</span>(iodine <span class="sc">~</span> time <span class="sc">+</span> type <span class="sc">+</span> time<span class="sc">:</span>type, <span class="at">data =</span> barplot_tbl, </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> time<span class="sc">*</span>type)) <span class="sc">|&gt;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> time <span class="sc">|</span> type, <span class="at">mode =</span> <span class="st">"appx-satterthwaite"</span>) <span class="sc">|&gt;</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group),</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd =</span> SE <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">5</span>)) </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>emmeans_hetrogen_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 9
  time  type  emmean    SE    df lower.CL upper.CL .group    sd
  &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
1 07:00 KIO3    55.8  2.29  3.88     49.4     62.2 a       5.12
2 11:00 KIO3    75.2  1.50  3.84     71.0     79.4 b       3.35
3 15:00 KIO3    81.0  3.30  4.04     71.9     90.1 b       7.38
4 19:00 KIO3    84.2  7.88  4.02     62.4    106.  b      17.6 
5 07:00 KI      89.8  3.48  4.03     80.2     99.4 a       7.79
6 19:00 KI      90.0  4.31  4.02     78.1    102.  a       9.64
7 15:00 KI     124    7.48  4.02    103.     145.  b      16.7 
8 11:00 KI     152    9.03  4.02    127.     177.  c      20.2 </code></pre>
</div>
</div>
<p>In dem Objekt <code>emmeans_hetrogen_tbl</code> ist jetzt alles enthalten für unsere Barplots mit dem <em>compact letter display</em>. In diesem Fall hier sind die Standardfehler und damit auch die Standardabweichungen nicht alle gleich, wir haben ja für jede Gruppe eine eigene Standardabweichung angenommen. Die Varianzen sollten ja auch heterogen sein.</p>
</div>
</div>
</div>
<p>Dann bauen wir usn auch schon die Abbildung. Wir müssen am Anfang einmal <code>scale_x_discrete()</code> setzen, damit wir gleich den Zielbereich ganz hinten zeichnen können. Sonst ist der blaue Bereich im Vordergrund. Dann färben wir auch mal die Balken anders ein. Muss ja auch mal sein. Auch nutzen wir die Funktion <code>geom_text()</code> um das <em>compact letter display</em> gut zu setzten. Die <span class="math inline">\(y\)</span>-Position berechnet sich aus dem Mittelwert <code>emmean</code> plus Standardabweichung <code>sd</code> innerhalb des <code>geom_text()</code>. Da wir hier die Kontrollgruppe entfernen mussten, habe ich dann nochmal den Zielbereich verschoben und mit einem Pfeil ergänzt. Die beiden Tabs zeigen dir dann die Abbildungen für die beiden Annahmen der Varianzhomogenität oder Varianzheterogenität. Der Code ist der gleiche für beide Abbildungen, die Daten <code>emmeans_homogen_tbl</code> oder <code>emmeans_hetrogen_tbl</code> sind das Ausschlaggebende. Wie du sehen wirst, haben wir hier mal keinen Unterschied vorliegen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="zerforschen-emmeans-barplot-2fac">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Varianzhomogenität</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Varianzheterogenität</a></li></ul>
<div class="tab-content" data-group="zerforschen-emmeans-barplot-2fac">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> emmeans_homogen_tbl, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> emmean, <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>() <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="fl">0.25</span>, <span class="at">xmax =</span> <span class="fl">4.75</span>, <span class="at">ymin =</span> <span class="dv">50</span>, <span class="at">ymax =</span> <span class="dv">100</span>, </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span>                        </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">label =</span> <span class="st">"Target area"</span>, </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_curve</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.25</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">xend =</span> <span class="fl">1.7</span>, <span class="at">yend =</span> <span class="dv">105</span>),   </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">"#555555"</span>,   </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.5</span>,   </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">curvature =</span> <span class="sc">-</span><span class="fl">0.2</span>,  </span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.03</span>, <span class="st">"npc"</span>))) <span class="sc">+</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, </span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>sd, <span class="at">ymax =</span> emmean<span class="sc">+</span>sd),</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>,  </span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Type"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"darkblue"</span>)) <span class="sc">+</span> </span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>),</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.spacing.y =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"mm"</span>), </span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time of application [time of day]"</span>,</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span>  <span class="fu">expression</span>(Iodine<span class="sc">~</span>content<span class="sc">~</span><span class="st">"["</span><span class="sc">*</span>mu<span class="sc">*</span>g<span class="sc">~</span>I<span class="sc">~</span><span class="dv">100</span><span class="sc">*</span>g<span class="sc">^</span><span class="st">'-1'</span><span class="sc">~</span>f<span class="sc">*</span>.<span class="sc">*</span>m<span class="sc">*</span>.<span class="sc">*</span><span class="st">"]"</span>)) <span class="sc">+</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>),</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> emmean <span class="sc">+</span> sd <span class="sc">+</span> <span class="dv">2</span>),  </span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-2fac-target-emmeans-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-2fac-target-emmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-pretest_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-target-emmeans-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" data-glightbox="description: .lightbox-desc-7"><img src="stat-tests-pretest_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-target-emmeans-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-2fac-target-emmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;22.7— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut. Wir nutzen das <code>geom_text()</code> um noch besser unser <em>compact letter display</em> zu setzen. Die Kontrolle wurde entfernt, sonst hätten wir hier nicht <code>emmeans</code> in der einfachen Form nutzen können. Wir rechnen hier die Vergleiche getrennt für die beiden Jodformen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> emmeans_hetrogen_tbl, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> emmean, <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>() <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="fl">0.25</span>, <span class="at">xmax =</span> <span class="fl">4.75</span>, <span class="at">ymin =</span> <span class="dv">50</span>, <span class="at">ymax =</span> <span class="dv">100</span>, </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span>                        </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">label =</span> <span class="st">"Target area"</span>, </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_curve</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.25</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">xend =</span> <span class="fl">1.7</span>, <span class="at">yend =</span> <span class="dv">105</span>),   </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">"#555555"</span>,   </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.5</span>,   </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">curvature =</span> <span class="sc">-</span><span class="fl">0.2</span>,  </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.03</span>, <span class="st">"npc"</span>))) <span class="sc">+</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, </span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>sd, <span class="at">ymax =</span> emmean<span class="sc">+</span>sd),</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>,  </span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Type"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"darkblue"</span>)) <span class="sc">+</span> </span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>),</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.spacing.y =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"mm"</span>), </span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time of application [time of day]"</span>,</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span>  <span class="fu">expression</span>(Iodine<span class="sc">~</span>content<span class="sc">~</span><span class="st">"["</span><span class="sc">*</span>mu<span class="sc">*</span>g<span class="sc">~</span>I<span class="sc">~</span><span class="dv">100</span><span class="sc">*</span>g<span class="sc">^</span><span class="st">'-1'</span><span class="sc">~</span>f<span class="sc">*</span>.<span class="sc">*</span>m<span class="sc">*</span>.<span class="sc">*</span><span class="st">"]"</span>)) <span class="sc">+</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>),</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> emmean <span class="sc">+</span> sd <span class="sc">+</span> <span class="dv">2</span>),  </span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-2fac-target-emmeans-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-2fac-target-emmeans-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-pretest_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-target-emmeans-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" data-glightbox="description: .lightbox-desc-8"><img src="stat-tests-pretest_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-target-emmeans-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-2fac-target-emmeans-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;22.8— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut. Wir nutzen das <code>geom_text()</code> um noch besser unser <em>compact letter display</em> zu setzen. Die Kontrolle wurde entfernt, sonst hätten wir hier nicht <code>emmeans</code> in der einfachen Form nutzen können. Wir rechnen hier die Vergleiche getrennt für die beiden Jodformen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Am Ende kannst du dann folgenden Code noch hinter deinen <code>ggplot</code> Code ausführen um dann deine Abbildung als <code>*.png</code>-Datei zu speichern. Dann hast du die Abbildung super nachgebaut und sie sieht auch wirklich besser aus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"my_ggplot_barplot.png"</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Zerforschen: Zweifaktorieller Boxplot mit <code>rq()</code>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In diesem Zerforschenbeispiel wollen wir uns einen zweifaktoriellen Boxplot unter der Annahme nicht normalverteilter Daten anschauen. Dabei ist Iodanteil in den Pflanzen nicht normalverteilt, so dass wir hier eine <a href="stat-modeling-robust-quantile.html">Quantilesregression</a> rechnen wollen. Die Daten siehst du wieder in der unteren Abbildung. Ich nehme für jede der vier Zeitpunkte jeweils fünf Beobachtungen an. Für die Kontrolle haben wir dann nur drei Beobachtungen in der Gruppe <span class="math inline">\(KIO_3\)</span> vorliegen. Das ist wichtig, denn sonst können wir nicht mit <code>emmeans</code> rechnen. Wir haben einfach zu wenige Beobachtungen vorliegen.</p>
<div id="fig-ur-barplot-02" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ur-barplot-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/zerforschen_barplot_2fac.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" data-glightbox="description: .lightbox-desc-9"><img src="images/eda/zerforschen_barplot_2fac.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ur-barplot-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;22.9— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein Barplot mit den zwei Faktoren Zeit und die Iodine Form. Hier soll es dann ein Boxplot werden.
</figcaption>
</figure>
</div>
<p>Als erstes brauchen wir die Daten. Die Daten habe ich mir in dem Datensatz <code>zerforschen_barplot_2fac_target_emmeans.xlsx</code> selber ausgedacht. Ich nehme hier die gleichen Daten wie für den Barplot. Ich habe einfach die obige Abbildung genommen und den Mittelwert abgeschätzt. Dann habe ich die fünf Werte alle um den Mittelwert streuen lassen. Ich brauche hier eigentlich mehr als fünf Werte, sonst kriegen wir bei <code>emmeans()</code> und der Interaktion im <code>gls()</code>-Modell Probleme, aber da gibt es dann bei kleinen Fallzahlen noch ein Workaround. Bitte nicht mit weniger als fünf Beobachtungen versuchen, dann wird es schwierig mit der Konsistenz der Schätzer aus dem Modell.</p>
<p>Ach, und ganz wichtig. Wir entfernen die Kontrolle, da wir die Kontrolle nur mit einer Iodid-Stufe gemessen haben. Dann können wir weder die Interaktion rechnen, noch anständig eine Interpretation durchführen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>boxplot_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/zerforschen_barplot_2fac_target_emmeans.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">factor</span>(time, </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"ctrl"</span>, <span class="st">"7"</span>, <span class="st">"11"</span>, <span class="st">"15"</span>, <span class="st">"19"</span>),</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Contr."</span>, <span class="st">"07:00"</span>, <span class="st">"11:00"</span>, <span class="st">"15:00"</span>, <span class="st">"19:00"</span>)),</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">as_factor</span>(type)) <span class="sc">|&gt;</span> </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(time <span class="sc">!=</span> <span class="st">"Contr."</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>boxplot_tbl  </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 3
   time  type  iodine
   &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt;
 1 07:00 KIO3      50
 2 07:00 KIO3      55
 3 07:00 KIO3      60
 4 07:00 KIO3      52
 5 07:00 KIO3      62
 6 07:00 KI        97
 7 07:00 KI        90
 8 07:00 KI        83
 9 07:00 KI        81
10 07:00 KI        98
# ℹ 30 more rows</code></pre>
</div>
</div>
<p>Hier gehen wir nicht weiter auf die Funktionen ein, bitte schaue dann einmal in dem Abschnitt zu <a href="stat-tests-posthoc.html#sec-posthoc-emmeans">Gruppenvergleich mit dem <code>emmeans</code> Paket</a>. Wir entfernen aber noch die Leerzeichen bei den Buchstaben mit der Funktion <code>str_trim()</code>. Wichtig ist hier, dass wir zur Modellierung die Funktion <code>rq()</code> aus dem R Paket <code>quantreg</code> nutzen. Wenn du den Aufbau mit den anderen Zerforschenbeispielen vergleichst, siehst du, dass hier viel ähnlich ist. Achtung, ganz wichtig! Du musst am Ende wieder die Ausgabe aus der <code>cld()</code>-Funktion nach der Zeit <code>time</code> und der Form <code>type</code> sortieren, sonst passt es gleich nicht mit den Beschriftungen der Boxplots.</p>
<p>Du musst dich nur noch entscheiden, ob du das <em>compact letter display</em> getrennt für die beiden Jodformen <code>type</code> berechnen willst oder aber zusammen. Wenn du das <em>compact letter display</em> für die beiden Jodformen zusammen berechnest, dann berechnest du für jede Faktorkombination einen paarweisen Vergleich.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="zerforschen-emmeans-boxplot-2fac">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Getrennt nach <code>type</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Zusammen über <code>type</code></a></li></ul>
<div class="tab-content" data-group="zerforschen-emmeans-boxplot-2fac">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>Hier rechnen wir den Vergleich nur innerhalb der jeweiligen Jodform <code>type</code>. Daher vergleichen wir die Boxplots nicht untereinander sondern eben nur in den jeweiligen Leveln <span class="math inline">\(KIO_3\)</span> und <span class="math inline">\(KI\)</span>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>emmeans_quant_sep_tbl <span class="ot">&lt;-</span> <span class="fu">rq</span>(iodine <span class="sc">~</span> time <span class="sc">+</span> type <span class="sc">+</span> time<span class="sc">:</span>type, <span class="at">data =</span> boxplot_tbl, <span class="at">tau =</span> <span class="fl">0.5</span>) <span class="sc">|&gt;</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> time <span class="sc">|</span> type) <span class="sc">|&gt;</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group)) <span class="sc">|&gt;</span> </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(time, type)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>emmeans_quant_sep_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 8
  time  type  emmean    SE    df lower.CL upper.CL .group
  &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt; 
1 07:00 KIO3      55  3.15    32     48.6     61.4 a     
2 07:00 KI        90  5.51    32     78.8    101.  a     
3 11:00 KIO3      75  1.97    32     71.0     79.0 b     
4 11:00 KI       150 13.8     32    122.     178.  b     
5 15:00 KIO3      80  4.72    32     70.4     89.6 b     
6 15:00 KI       120  7.87    32    104.     136.  b     
7 19:00 KIO3      85  7.48    32     69.8    100.  b     
8 19:00 KI        90  2.36    32     85.2     94.8 a     </code></pre>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>Dann einmal die Berechnung über alle Boxplots und damit allen Faktorkombinationen aus Zeit und Jodform. Wir können dann damit jeden Boxplot mit jedem anderen Boxplot vergleichen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>emmeans_quant_comb_tbl <span class="ot">&lt;-</span> <span class="fu">rq</span>(iodine <span class="sc">~</span> time <span class="sc">+</span> type <span class="sc">+</span> time<span class="sc">:</span>type, <span class="at">data =</span> boxplot_tbl, <span class="at">tau =</span> <span class="fl">0.5</span>) <span class="sc">|&gt;</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> time<span class="sc">*</span>type) <span class="sc">|&gt;</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group)) <span class="sc">|&gt;</span> </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(time, type)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>emmeans_quant_comb_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 8
  time  type  emmean    SE    df lower.CL upper.CL .group
  &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt; 
1 07:00 KIO3      55  3.15    32     48.6     61.4 a     
2 07:00 KI        90  5.51    32     78.8    101.  c     
3 11:00 KIO3      75  1.97    32     71.0     79.0 b     
4 11:00 KI       150 13.8     32    122.     178.  d     
5 15:00 KIO3      80  4.72    32     70.4     89.6 bc    
6 15:00 KI       120  7.87    32    104.     136.  d     
7 19:00 KIO3      85  7.48    32     69.8    100.  bc    
8 19:00 KI        90  2.36    32     85.2     94.8 c     </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Für die Boxplots brauchen wir dann noch ein Objekt mehr. Um das nach den Faktorkombinationen sortierte <em>compacte letter dislay</em> an die richtige Position zu setzen brauchen wir noch eine <span class="math inline">\(y\)</span>-Position. Ich nehme hier dann das 95% Quantile. Das 95% Quantile sollte dann auf jeden Fall über die Schnurrhaare raus reichen. Wir nutzen dann den Datensatz <code>letter_pos_tbl</code> in dem <code>geom_text()</code> um die Buchstaben richtig zu setzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>letter_pos_tbl <span class="ot">&lt;-</span> boxplot_tbl <span class="sc">|&gt;</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(time, type) <span class="sc">|&gt;</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">quant_90 =</span> <span class="fu">quantile</span>(iodine, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.95</span>)))</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>letter_pos_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
# Groups:   time [4]
  time  type  quant_90
  &lt;fct&gt; &lt;fct&gt;    &lt;dbl&gt;
1 07:00 KIO3      61.6
2 07:00 KI        97.8
3 11:00 KIO3      78.8
4 11:00 KI       174  
5 15:00 KIO3      89.4
6 15:00 KI       146  
7 19:00 KIO3     106  
8 19:00 KI        99.8</code></pre>
</div>
</div>
<p>Das Problem sind natürlich die wenigen Beobachtungen, deshalb sehen die Boxplots teilweise etwas wild aus. Aber wir wollen hier eben die Mediane darstellen, die wir dann auch in der Quantilesregression berechnet haben. Wenn du mehr Beobachtungen erstellst, dann werden die Boxplots auch besser dargestellt.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="zerforschen-emmeans-boxplot-2fac">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Getrennt nach <code>type</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Zusammen über <code>type</code></a></li></ul>
<div class="tab-content" data-group="zerforschen-emmeans-boxplot-2fac">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>Hier nehmen wir das <em>compact letter display</em> aus dem Objekt <code>emmeans_quant_sep_tbl</code>. Wichtig ist, dass die Sortierung gleich der Beschriftung der <span class="math inline">\(x\)</span>-Achse ist. Deshalb nutzen wir weiter oben auch die Funktion <code>arrange()</code> zur Sortierung der Buchstaben. Beachte, dass wir hier jeweils die beiden Jodformen getrennt voneinander betrachten.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> boxplot_tbl, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> iodine,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>() <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="fl">0.25</span>, <span class="at">xmax =</span> <span class="fl">4.75</span>, <span class="at">ymin =</span> <span class="dv">50</span>, <span class="at">ymax =</span> <span class="dv">100</span>, </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span>                        </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">label =</span> <span class="st">"Target area"</span>) <span class="sc">+</span> </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_curve</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.1</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">xend =</span> <span class="fl">1.7</span>, <span class="at">yend =</span> <span class="dv">105</span>),   </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">"#555555"</span>,   </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.5</span>,   </span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">curvature =</span> <span class="sc">-</span><span class="fl">0.2</span>,  </span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.03</span>, <span class="st">"npc"</span>))) <span class="sc">+</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Type"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"darkblue"</span>)) <span class="sc">+</span> </span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>),</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.spacing.y =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"mm"</span>), </span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time of application [time of day]"</span>,</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span>  <span class="fu">expression</span>(Iodine<span class="sc">~</span>content<span class="sc">~</span><span class="st">"["</span><span class="sc">*</span>mu<span class="sc">*</span>g<span class="sc">~</span>I<span class="sc">~</span><span class="dv">100</span><span class="sc">*</span>g<span class="sc">^</span><span class="st">'-1'</span><span class="sc">~</span>f<span class="sc">*</span>.<span class="sc">*</span>m<span class="sc">*</span>.<span class="sc">*</span><span class="st">"]"</span>)) <span class="sc">+</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>),</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> letter_pos_tbl, </span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> emmeans_quant_sep_tbl<span class="sc">$</span>.group, </span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> quant_90 <span class="sc">+</span> <span class="dv">5</span>),  </span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerfor-barplot-2fac-box-emmeans-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerfor-barplot-2fac-box-emmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-pretest_files/figure-html/fig-ggplot-zerfor-barplot-2fac-box-emmeans-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" data-glightbox="description: .lightbox-desc-10"><img src="stat-tests-pretest_files/figure-html/fig-ggplot-zerfor-barplot-2fac-box-emmeans-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerfor-barplot-2fac-box-emmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;22.10— Die Abbildung des Säulendiagramms in <code>ggplot</code> als Boxplot nachgebaut. Wir nutzen das <code>geom_text()</code> um noch besser unser <em>compact letter display</em> zu setzen, dafür müssen wir uns aber nochmal ein Positionsdatensatz bauen. Hier ist das <em>compact letter display</em> getrennt für die beiden Jodformen berechnet.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p>Und hier nutzen wir das <em>compact letter display</em> aus dem Objekt <code>emmeans_quant_comb_tbl</code>. Wichtig ist, dass die Sortierung gleich der Beschriftung der <span class="math inline">\(x\)</span>-Achse ist. Deshalb nutzen wir weiter oben auch die Funktion <code>arrange()</code> zur Sortierung der Buchstaben. Hier betrachten wir jeden Boxplot einzelne und du kannst auch jeden Boxplot mit jedem Boxplot vergleichen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> boxplot_tbl, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> iodine,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>() <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="fl">0.25</span>, <span class="at">xmax =</span> <span class="fl">4.75</span>, <span class="at">ymin =</span> <span class="dv">50</span>, <span class="at">ymax =</span> <span class="dv">100</span>, </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span>                        </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">label =</span> <span class="st">"Target area"</span>) <span class="sc">+</span> </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_curve</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.1</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">xend =</span> <span class="fl">1.7</span>, <span class="at">yend =</span> <span class="dv">105</span>),   </span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">"#555555"</span>,   </span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.5</span>,   </span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">curvature =</span> <span class="sc">-</span><span class="fl">0.2</span>,  </span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.03</span>, <span class="st">"npc"</span>))) <span class="sc">+</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Type"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"darkblue"</span>)) <span class="sc">+</span> </span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>),</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.spacing.y =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"mm"</span>), </span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time of application [time of day]"</span>,</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span>  <span class="fu">expression</span>(Iodine<span class="sc">~</span>content<span class="sc">~</span><span class="st">"["</span><span class="sc">*</span>mu<span class="sc">*</span>g<span class="sc">~</span>I<span class="sc">~</span><span class="dv">100</span><span class="sc">*</span>g<span class="sc">^</span><span class="st">'-1'</span><span class="sc">~</span>f<span class="sc">*</span>.<span class="sc">*</span>m<span class="sc">*</span>.<span class="sc">*</span><span class="st">"]"</span>)) <span class="sc">+</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>),</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> letter_pos_tbl, </span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> emmeans_quant_comb_tbl<span class="sc">$</span>.group, </span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> quant_90 <span class="sc">+</span> <span class="dv">5</span>),  </span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerfor-barplot-2fac-box-emmeans-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerfor-barplot-2fac-box-emmeans-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-pretest_files/figure-html/fig-ggplot-zerfor-barplot-2fac-box-emmeans-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" data-glightbox="description: .lightbox-desc-11"><img src="stat-tests-pretest_files/figure-html/fig-ggplot-zerfor-barplot-2fac-box-emmeans-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerfor-barplot-2fac-box-emmeans-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;22.11— Die Abbildung des Säulendiagramms in <code>ggplot</code> als Boxplot nachgebaut. Wir nutzen das <code>geom_text()</code> um noch besser unser <em>compact letter display</em> zu setzen, dafür müssen wir uns aber nochmal ein Positionsdatensatz bauen. Hier ist das <em>compact letter display</em> für jede einzelne Faktorkombination berechnet.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Am Ende kannst du dann folgenden Code noch hinter deinen <code>ggplot</code> Code ausführen um dann deine Abbildung als <code>*.png</code>-Datei zu speichern. Dann hast du die Abbildung super nachgebaut und sie sieht auch wirklich besser aus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"my_ggplot_boxplot.png"</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<p>Bei einem nicht-normalverteilten Outcome mit Varianzheterogenität über die Gruppen müssen wir nochmal gemeinsam in die Daten schauen. Da meldest du dich bitte nochmal bei mir in der statistischen Beratung. Hier öffnet sich nämlich eine Tür in eine ganz eigene Modellwelt und je nach wissenschaftlicher Fragestellung können wir dann eine Lösung finden.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exkurs: Robuste Schätzung von Standardfehlern, Konfidenzintervallen und p-Werten
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Wenn du noch etwas weiter gehen möchtest, dann kannst du dir noch die Hilfeseite von dem R Paket <code>{performance}</code> <a href="https://easystats.github.io/parameters/articles/model_parameters_robust.html?q=Heteroskedasticity#robust-covariance-matrix-estimation-from-model-parameters">Robust Estimation of Standard Errors, Confidence Intervals, and p-values</a> anschauen. Die Idee ist hier, dass wir die Varianz/Kovarianz robuster daher mit der Berücksichtigung von Varianzheterogenität (eng. <em>heteroskedasticity</em>) schätzen.</p>
</div>
</div>
</div>
</section>
<section id="pre-test-auf-varianzhomogenität" class="level2" data-number="22.3">
<h2 data-number="22.3" class="anchored" data-anchor-id="pre-test-auf-varianzhomogenität"><span class="header-section-number">22.3</span> Pre-Test auf Varianzhomogenität</h2>
<p>Was will also der Pre-Test auf Varianzhomogenität? Eigentlich ist der Test vollkommen verquer. Zum einen testet der Test auf Varianzhomogenität gar nicht die <em>Anwesenheit</em> von Homogenität. Wir können dank dem Falisifikationsprinzip nur Ablehnen. Deshalb steht in der Nullhypothese die Gleichheit der Varianzen, also Varianzhomogenität und in der Alternativen dann die Varianzheterogenität, als der Unterschied.</p>
<p>Ab wann sollten wir denn die Varianzhomogenität ablehnen? Wenn wir standardmäßig auf 5% testen, dann werden wir zu selten die Varianzhomogenität ablehnen. Daher ist es ratsam in diesem Fall auf ein Signifikanzniveau von <span class="math inline">\(\alpha\)</span> gleich 20% zu testen. Aber auch in diesem Fall können wir natürlich eine Varianzhomogenität übersehen oder aber eine Varianzheterogenität fälschlicherweise annehmen.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/angel_01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="images/angel_01.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p>Einigermaßen zuverlässig meint, dass wir dann in 1 von 20 Fällen eine Varianzhomogenität ablehnen, obwohl eine Varianzhomogenität vorliegt. Ebenso können wir in 1 von 5 Fällen die Nullhypothese nicht ablehnen, obwohl die Varianzen heterogen sind (siehe auch <a href="stat-tests-theorie.html#sec-alpha-beta" class="quarto-xref"><span>Kapitel 20.1</span></a>).</p>
</blockquote>
</div>
</div>
</div>
<p>Es ergeben sich folgende Hypothesen für den Pre-Test auf Varianzhomogenität.</p>
<p><span class="math display">\[
\begin{aligned}
H_0: &amp;\; s^2_A = s^2_B\\
H_A: &amp;\; s^2_A \ne s^2_B\\
\end{aligned}
\]</span></p>
<p>Wir sehen, dass in der Nullhypothese die Gleichheit der Varianzen steht und in der Alternativehypothese der Unterschied, also die Varianzhterogenität.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Entscheidung zur Varianzhomogenität
</div>
</div>
<div class="callout-body-container callout-body">
<p>Bei der Entscheidung zur Varianzhomogenität gilt folgende Regel. Ist der <span class="math inline">\(p\)</span>-Wert des Pre-Tests auf Varianzhomogenität kleiner als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> von 20% lehnen wir die Nullhypothese ab. Wir nehmen Varianzheterogenität an.</p>
<ul>
<li>Ist <span class="math inline">\(p \leq \alpha = 20\%\)</span> so nehmen wir Varianzheterogenität an.</li>
<li>Ist <span class="math inline">\(p &gt; \alpha = 20\%\)</span> so nehmen wir Varianzhomogenität an.</li>
</ul>
<p>Auf jeden Fall sollten wir das Ergebnis unseres Pre-Tests auf Varianzhomogenität nochmal visuell bestätigen.</p>
</div>
</div>
<p>Wir nutzen zum statistischen Testen den Levene-Test über die Funktion <code>leveneTest()</code> oder den Bartlett-Test über die Funktion <code>bartlett.test()</code>. Beide Tests sind in R implementiert und können über das Paket <code>{car}</code> genutzte werden. Wir werden uns jetzt nicht die Formel anschauen, wir nutzen wenn die beiden Tests nur in R und rechnen nicht selber die Werte nach.</p>
<p>Einfach ausgedrückt, überprüft der Bartlett-Test die Homogenität der Varianzen auf der Grundlage des Mittelwerts. Dementsprechend ist der Bartlett-Test empfindlicher gegen eine Abweichung von der Normalverteilung der Daten, die er überprüfen soll. Der Levene-Test überprüft die Homogenität der Varianzen auch auf der Grundlage des Mittelwerts. Wir haben aber auch die Wahl, den Median zu nutzen dann ist der Levene-Test robuster gegenüber Ausreißern.</p>
<p>Im Folgenden wollen wir uns einmal in der Theorie den Levene-Test anschauen. Der Levene-Test ist eigentlich nichts anderes als eine etwas versteckte einfaktorielle ANOVA, aber dazu dann am Ende mehr. Dafür nutzen wir als erstes die folgende Formel um die Teststatistik zu berechnen. Dabei ist <span class="math inline">\(W\)</span> die Teststatistik, die wir zu einer <span class="math inline">\(F\)</span>-Verteilung, die wir schon aus der ANOVA kennen, vergleichen können.</p>
<p><span class="math display">\[
W = \frac{(N-k)}{(k-1)} \cdot \frac{\sum_{i=1}^k N_i (\bar{Z}_{i\cdot}-\bar{Z}_{\cdot\cdot})^2} {\sum_{i=1}^k \sum_{j=1}^{N_i} (Z_{ij}-\bar{Z}_{i\cdot})^2}
\]</span></p>
<p>Zur Veranschaulichung bauen wir uns einen simplen Datensatz mit <span class="math inline">\(N = 14\)</span> Beobachtungen für <span class="math inline">\(k = 2\)</span> Tierarten mit Hunden und Katzen. Damit hat jede Tierart <span class="math inline">\(7\)</span> Beobachtungen der Sprunglängen der jeweiligen Hunde- und Katzenflöhe.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>animal_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">dog =</span> <span class="fu">c</span>(<span class="fl">5.7</span>, <span class="fl">8.9</span>, <span class="fl">11.8</span>, <span class="fl">8.2</span>, <span class="fl">5.6</span>, <span class="fl">9.1</span>, <span class="fl">7.6</span>),</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">cat =</span> <span class="fu">c</span>(<span class="fl">3.2</span>, <span class="fl">2.2</span>, <span class="fl">5.4</span>, <span class="fl">4.1</span>, <span class="fl">1.1</span>, <span class="fl">7.9</span>, <span class="fl">8.6</span>))</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>animal_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
    dog   cat
  &lt;dbl&gt; &lt;dbl&gt;
1   5.7   3.2
2   8.9   2.2
3  11.8   5.4
4   8.2   4.1
5   5.6   1.1
6   9.1   7.9
7   7.6   8.6</code></pre>
</div>
</div>
<p>Dann berechnen wir uns auch gleich die absoluten Abstände <span class="math inline">\(Z_{ij}\)</span> von jeder Beobachtung zu den jeweiligen Mittelwerten der Gruppe. Wir könnten auch die Abstände zu den jeweiligen Medianen der Gruppe berechnen. Beides ist möglich. Hier sehen wir auch den Unterschied zu der ANOVA, wir berechnen hier nicht die <em>quadratischen</em> Abstände sondern die absoluten Abstände.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>z_tbl <span class="ot">&lt;-</span> animal_tbl <span class="sc">|&gt;</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dog_abs =</span> <span class="fu">abs</span>(dog <span class="sc">-</span> <span class="fu">mean</span>(dog)),</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">cat_abs =</span> <span class="fu">abs</span>(cat <span class="sc">-</span> <span class="fu">mean</span>(cat)))</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>z_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 4
    dog   cat dog_abs cat_abs
  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1   5.7   3.2  2.43     1.44 
2   8.9   2.2  0.771    2.44 
3  11.8   5.4  3.67     0.757
4   8.2   4.1  0.0714   0.543
5   5.6   1.1  2.53     3.54 
6   9.1   7.9  0.971    3.26 
7   7.6   8.6  0.529    3.96 </code></pre>
</div>
</div>
<p>Im Folgenden nochmal in formelschreibweise der Unterschied zwischen den beiden Abstandsberechnungen <span class="math inline">\(Z_{ij}\)</span> für jeden Wert. Wir haben die Wahl zwischen den Abständen von jeder Beobachtung zu dem Mittelwert oder dem Median.</p>
<p><span class="math display">\[
Z_{ij} =
\begin{cases}
|Y_{ij} - \bar{Y}_{i\cdot}|, &amp; \bar{Y}_{i\cdot} \text{ ist der Mittelwert der } i\text{-ten Gruppe}, \\
|Y_{ij} - \tilde{Y}_{i\cdot}|, &amp; \tilde{Y}_{i\cdot} \text{ ist der Median der } i\text{-ten Gruppe}.
\end{cases}
\]</span></p>
<p>Berechnen wir nun die Gruppenmittelwerte <span class="math inline">\(\bar{Z}_{i\cdot}\)</span> für die Hunde und die Katzen jeweils einmal separat.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(z_tbl<span class="sc">$</span>dog_abs)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.567347</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(z_tbl<span class="sc">$</span>cat_abs)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.277551</code></pre>
</div>
</div>
<p>Dann brauchen wir noch den Mittelwert über alle Beobachtungen hinweg <span class="math inline">\(\bar{Z}_{\cdot\cdot}\)</span>. Den können wir aus allen Beoachtungen berechnen oder aber einfach den Mittelwert der beiden Gruppenmittelwerte nehmen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>(<span class="fl">1.57</span> <span class="sc">+</span> <span class="fl">2.28</span>)<span class="sc">/</span><span class="dv">2</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.925</code></pre>
</div>
</div>
<p>Am Ende fehlt uns dann noch der Nenner mit der Summe der einzelnen quadratischen Abstände <span class="math inline">\(Z_{ij}\)</span> zu den Abstandsmitteln der einzelnen Gruppen <span class="math inline">\(\bar{Z}_{i\cdot}\)</span> mit <span class="math inline">\(\sum_{i=1}^k \sum_{j=1}^{N_i} (Z_{ij}-\bar{Z}_{i\cdot})^2\)</span>. Den Wert können wir dann in R direkt einmal berechnen. Wir nehmen also die Vektoren der Einzelwerte und ziehen dort immer den Mittelwert der Abstände der Gruppe ab. Abschließend summieren wir dann einmal auf.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((z_tbl<span class="sc">$</span>dog_abs <span class="sc">-</span> <span class="fl">1.57</span>)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.3983</code></pre>
</div>
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((z_tbl<span class="sc">$</span>cat_abs <span class="sc">-</span> <span class="fl">2.28</span>)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.42651</code></pre>
</div>
</div>
<p>Wir können dann alle Zahlen einmal zusammenbringen und in die Formel des Levene-Test einsetzen. Nun rechen wir dann wieder die quadratischen Abstände auf den absoluten Abständen. Ja, das ist etwas wirr, wenn man es zum ersten Mal liest.</p>
<p><span class="math display">\[
W =
\cfrac{14-2}{2-1}\cdot
\cfrac{7 \cdot (1.57 - 1.93)^2 + 7 \cdot (2.28 - 1.93)^2}
{10.39 + 11.43} =
\cfrac{12}{1} \cdot \cfrac{1.76}{21.82} =
\cfrac{21.12}{21.82} \approx 0.968
\]</span></p>
<p>Wir erhalten ein <span class="math inline">\(W = 0.968\)</span>, was wir direkt als eine F-Statistik interpretieren können. Schauen wir uns das Ergebnis einmal in der R Funktion <code>leveneTest()</code> aus dem R Paket <code>{car}</code> an. Wir brauchen dafür einmal die Werte für die Sprungweiten und müssen dann die Daten in das long-Format umbauen und dann rechnen wir den Levene-Test. Wir erhalten fast die numerisch gleichen Werte. Bei uns haben wir etwas gerundet und dann kommt die Abweichung zustande.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>z_tbl <span class="sc">|&gt;</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dog, cat) <span class="sc">|&gt;</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> animal, <span class="at">value =</span> jump_length) <span class="sc">%$%</span> </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">leveneTest</span>(jump_length <span class="sc">~</span> animal, <span class="at">center =</span> <span class="st">"mean"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = "mean")
      Df F value Pr(&gt;F)
group  1  0.9707  0.344
      12               </code></pre>
</div>
</div>
<p>Der Levene-Test ist eigentlich nichts anderes als eine einfaktorielle ANOVA auf den absoluten Abständen von den einzelnen Werten zu dem Mittelwert oder dem Median. Das können wir hier einmal nachvollziehen indem wir auf den absoluten Werten einmal eine einfaktorielle ANOVA in R rechnen. Wir erhalten den gleichen F-Wert in beiden Fällen. Eigentlich ist die ANOVA sogar etwas genauer, da wir hier auch die <em>Sum of squares</em> wie auch <em>Mean squares</em> erhalten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>z_tbl <span class="sc">|&gt;</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dog_abs, cat_abs) <span class="sc">|&gt;</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> animal, <span class="at">value =</span> jump_length) <span class="sc">%$%</span> </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: jump_length
          Df  Sum Sq Mean Sq F value Pr(&gt;F)
animal     1  1.7654  1.7654  0.9707  0.344
Residuals 12 21.8247  1.8187               </code></pre>
</div>
</div>
<p>Wir wollen uns nun im Folgenden nun zwei Fälle einmal näher anschauen. Zum einen den Fall, dass wir eine niedrige Fallzahl vorliegen haben und Varianzhomogenität sowie den Fall, dass wir eine niedrige Fallzahl und Varianzheterogenität vorliegen haben. Den Fall, dass wir hohe Fallzahl vorliegen haben, betrachten wir jetzt nicht weiter. In dem Fall funktionieren die Tests einigermaßen zuverlässig.</p>
<section id="varianzen-sind-homogen-fallzahl-niedrig" class="level3" data-number="22.3.1">
<h3 data-number="22.3.1" class="anchored" data-anchor-id="varianzen-sind-homogen-fallzahl-niedrig"><span class="header-section-number">22.3.1</span> Varianzen sind homogen, Fallzahl niedrig</h3>
<p>Wir bauen uns nun einen Datensatz mit zwei Gruppen <span class="math inline">\(A\)</span> und <span class="math inline">\(B\)</span> zu je zehn Beobachtungen. Beide Gruppen kommen aus einer Normalverteilung mit einem Mittelwert von <span class="math inline">\(\bar{y}_A = \bar{y}_A = 10\)</span>. Darüber hinaus haben wir Varianzhomogenität mit <span class="math inline">\(s_A = s_B = 5\)</span> vorliegen. Ja, wir spezifizieren hier in der Funktion <code>rnorm()</code> die Standardabweichung, aber eine homogene Standardabweichung bedingt eine homogene Varianz und umgekehrt. Abschließend verwandeln wir das Wide-Format noch in das Long-Format um.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">202209013</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>small_homogen_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">A =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">5</span>),</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">B =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">5</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(trt, rsp) <span class="sc">|&gt;</span> </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt =</span> <span class="fu">as_factor</span>(trt))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der <a href="#fig-vartest-1" class="quarto-xref">Abbildung&nbsp;<span>22.12</span></a> sehen wir die Daten aus dem <code>small_homogen_tbl</code> einmal als Boxplot visualisiert.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-vartest-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-vartest-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-pretest_files/figure-html/fig-vartest-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" data-glightbox="description: .lightbox-desc-13"><img src="stat-tests-pretest_files/figure-html/fig-vartest-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-vartest-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;22.12— Boxplot der beiden Treatment Level A und B. Beide Gruppen haben die gleichen Varianzen. Es liegt Varianzhomogenität vor.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir wollen nun die Varianz auf Homogenität testen. Wir nutzen dafür den <code>leveneTest()</code> sowie den <code>bartlett.test()</code>. Beide Tests bieten sich an. Die Daumenregel ist, dass der Bartlett-Test etwas bessere statistische Eigenschaften hat. Dennoch ist der Levene-Test bekannter und wird häufiger angefragt und genutzt. Wir nutzen die Funktion <code>tidy()</code> aus dem Paket <code>{broom}</code> um die Ausgabe aufzuräumen und selektieren nur den <span class="math inline">\(p\)</span>-Wert.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(rsp <span class="sc">~</span> trt, <span class="at">data =</span> small_homogen_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(p.value)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  p.value
    &lt;dbl&gt;
1   0.345</code></pre>
</div>
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(rsp <span class="sc">~</span> trt, <span class="at">data =</span> small_homogen_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(p.value)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  p.value
    &lt;dbl&gt;
1   0.325</code></pre>
</div>
</div>
<p>Wir sehen, dass der <span class="math inline">\(p\)</span>-Wert größer ist als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> von 20%. Damit können wir die Nullhypothese nicht ablehnen. Wir nehmen Varianzhomogenität an. Überdies sehen wir auch, dass sich die <span class="math inline">\(p\)</span>-Werte nicht groß voneinander unterscheiden.</p>
<p>Wir können auch die Funktion <code>check_homogeneity()</code> aus dem Paket <code>{performance}</code> nutzen. Wir erhalten hier auch gleich eine Entscheidung in englischer Sprache ausgegeben. Die Funktion <code>check_homogeneity()</code> nutzt den Bartlett-Test. Wir können in Funktion auch andere Methoden mit <code>method = c("bartlett", "fligner", "levene", "auto")</code> wählen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(rsp <span class="sc">~</span> trt, <span class="at">data =</span> small_homogen_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_homogeneity</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>OK: There is not clear evidence for different variances across groups (Bartlett Test, p = 0.325).</code></pre>
</div>
</div>
<p>Wir nutzen das Paket <code>{performance}</code> für die Modellgüte im <a href="stat-linear-reg-quality.html" class="quarto-xref"><span>Kapitel 42</span></a>.</p>
</section>
<section id="varianzen-sind-heterogen-fallzahl-niedrig" class="level3" data-number="22.3.2">
<h3 data-number="22.3.2" class="anchored" data-anchor-id="varianzen-sind-heterogen-fallzahl-niedrig"><span class="header-section-number">22.3.2</span> Varianzen sind heterogen, Fallzahl niedrig</h3>
<p>Nun stellt sich die Frage, wie sieht es aus, wenn wir ungleiche Varianzen vorliegen haben. Wir bauen uns nun einen Datensatz mit zwei Gruppen <span class="math inline">\(A\)</span> und <span class="math inline">\(B\)</span> zu je zehn Beobachtungen. Beide Gruppen kommen aus einer Normalverteilung mit einem Mittelwert von <span class="math inline">\(\bar{y}_A = \bar{y}_A = 12\)</span>. Darüber hinaus haben wir Varianzheterogenität mit <span class="math inline">\(s_A = 10 \ne s_B = 5\)</span> vorliegen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">202209013</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>small_heterogen_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">A =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">12</span>),</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">B =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">5</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(trt, rsp) <span class="sc">|&gt;</span> </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt =</span> <span class="fu">as_factor</span>(trt))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der <a href="#fig-vartest-2" class="quarto-xref">Abbildung&nbsp;<span>22.13</span></a> sehen wir die Daten aus dem <code>small_heterogen_tbl</code> einmal als Boxplot visualisiert.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-vartest-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-vartest-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-pretest_files/figure-html/fig-vartest-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" data-glightbox="description: .lightbox-desc-14"><img src="stat-tests-pretest_files/figure-html/fig-vartest-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-vartest-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;22.13— Boxplot der beiden Treatment Level A und B. Beide Gruppen haben ungleiche Varianzen. Es liegt Varianzheterogenität vor.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir wollen nun die Varianz auf Homogenität testen. Wir nutzen dafür den <code>levenTest()</code> sowie den <code>bartlett.test()</code>. Wir können nur die Varianzhomogenität testen, da jeder statistischer Test nur eine Aussage über die Nullhypothese erlaubt. Damit können wir hier nur die Varianzhomogenität testen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(rsp <span class="sc">~</span> trt, <span class="at">data =</span> small_heterogen_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(p.value)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  p.value
    &lt;dbl&gt;
1  0.0661</code></pre>
</div>
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(rsp <span class="sc">~</span> trt, <span class="at">data =</span> small_heterogen_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(p.value)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  p.value
    &lt;dbl&gt;
1   0.127</code></pre>
</div>
</div>
<p>Wir sehen, dass der <span class="math inline">\(p\)</span>-Wert kleiner ist als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> von 20%. Damit können wir die Nullhypothese ablehnen. Wir nehmen Varianzheterogenität an. Überdies sehen wir auch, dass sich die <span class="math inline">\(p\)</span>-Werte nicht groß voneinander unterscheiden. Was wir sehen ist, dass wir zu einem Signifikanzniveau von 5% die klare Varianzheterogenität nicht erkannt hätten und immer noch Varianzhomogenität angenommen hätten.</p>
<p>Wir können auch die Funktion <code>check_homogeneity()</code> aus dem Paket <code>{performance}</code> nutzen. Wir erhalten hier auch gleich eine Entscheidung in englischer Sprache ausgegeben. Die Funktion <code>check_homogeneity()</code> nutzt den Bartlett-Test. Wir können in Funktion auch andere Methoden mit <code>method = c("bartlett", "fligner", "levene", "auto")</code> wählen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(rsp <span class="sc">~</span> trt, <span class="at">data =</span> small_heterogen_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_homogeneity</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>OK: There is not clear evidence for different variances across groups (Bartlett Test, p = 0.127).</code></pre>
</div>
</div>
<p>Wir sehen, dass sich die Implementierung des Bartlett-Tests in <code>check_homogeneity()</code> nicht von der Funktion <code>bartlett.test()</code> unterscheidet, aber die Entscheidung gegen die Varianzhomogenität zu einem Signifikanzniveau von 5% gefällt wird. Nicht immer hilft einem der Entscheidungtext einer Funktion.</p>
</section>
</section>
<section id="pre-test-auf-normalverteilung" class="level2 page-columns page-full" data-number="22.4">
<h2 data-number="22.4" class="anchored" data-anchor-id="pre-test-auf-normalverteilung"><span class="header-section-number">22.4</span> Pre-Test auf Normalverteilung</h2>
<p>Wir treffen bei dem Test auf die Normalverteilung auch auf das gleiche Problem wie bei dem Pre-Test zur Varianzhomogenität. Wir haben wieder die Gleichheit, also das unser beobachtetes Outcome gleich einer Normalverteilung ist, in der Nullhypothese stehen. Den Unterschied, also das unser beobachtetes Outcome nicht aus einer Normalverteilung kommmt, in der Alternative.</p>
<p><span class="math display">\[
\begin{aligned}
H_0: &amp;\; \mbox{y ist gleich normalverteilt}\\
H_A: &amp;\; \mbox{y ist nicht gleich normalverteilt}\\
\end{aligned}
\]</span></p>
<p>Nun ist es aber so, dass es nicht nur <em>zwei</em> Verteilungen gibt. Es gibt mehr als die Normalverteilung und die <em>Nicht</em>-normalverteilung. Wir haben eine große Auswahl an möglichen Verteilungen und seit den 90zigern des letzten Jahrhunderts auch die Möglichkeiten andere Verteilungen des Outcomes <span class="math inline">\(y\)</span> zu modellieren. Leider fällt dieser Fortschritt häufig unter den Tisch und wir bleiben gefangen zwischen der Normalverteilung oder eben keiner Normalverteilung.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Der <a href="https://de.wikipedia.org/wiki/Zentraler_Grenzwertsatz">zentrale Grenzwertsatz</a> besagt, dass wenn ein <span class="math inline">\(y\)</span> von vielen Einflussfaktoren <span class="math inline">\(x\)</span> bestimmt wird, man von einem normalverteilten <span class="math inline">\(y\)</span> ausgehen.</p>
<p>Das Gewicht wird von vielen Einflussfaktoren wie Sport, Kalorienaufnahme oder aber Veranlagung sowie vielem mehr bestimmt. Wir können davon ausgehen, dass das Gewicht normalverteilt ist.</p>
</div></div><p>Abschließend sei noch gesagt, dass es fast unmöglich ist, eine Verteilung mit weniger als zwanzig Beobachtungen überhaupt abzuschätzen. Selbst dann können einzelne Beobachtunge an den Rändern der Verteilung zu einer Ablehnung der Normalverteilung führen, obwohl eine Normalverteilung vorliegt.</p>
<p>Das R Paket <code>{oslrr}</code> bietet hier noch eine Funktion <code>ols_test_normality()</code>, die es erlaubt mit allen bekannten statistischen Tests auf Normalverteilung zu testen. Wenn der <span class="math inline">\(p\)</span>-Wert kleiner ist als das Signifikanzniveau <span class="math inline">\(\alpha\)</span>, dann können wir die Nullhypothese, dass unsere Daten gleich einer Normalverteilung wären, ablehnen. Die Anwendung kannst du dir in <a href="stat-modeling-gaussian.html" class="quarto-xref"><span>Kapitel 49</span></a> anschauen. Um jetzt kurz einen statistischen Engel anzufahren, wir nutzen <em>wenn überhaupt</em> den Shapiro-Wilk-Test oder den Kolmogorov-Smirnov-Test. Für die anderen beiden steigen wir jetzt hier nicht in die Therorie ab.</p>
<p>Am Ende sei noch auf den <a href="stat-linear-reg-quality.html#sec-linreg-qq">QQ-plot</a> verwiesen, mit dem wir auch visuell überprüfen können, ob eine Normalverteilung vorliegt.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Entscheidung zur Normalverteilung
</div>
</div>
<div class="callout-body-container callout-body">
<p>Bei der Entscheidung zur Normalverteilung gilt folgende Regel. Ist der <span class="math inline">\(p\)</span>-Wert des Pre-Tests auf Normalverteilung kleiner als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> von 5% lehnen wir die Nullhypothese ab. Wir nehmen eine Nicht-Normalverteilung an.</p>
<ul>
<li>Ist <span class="math inline">\(p \leq \alpha = 5\%\)</span> so nehmen wir Nicht-Normalverteilung von <span class="math inline">\(y\)</span> an.</li>
<li>Ist <span class="math inline">\(p &gt; \alpha = 5\%\)</span> so nehmen wir Normalverteilung von <span class="math inline">\(y\)</span> an.</li>
</ul>
<p>Auf jeden Fall sollten wir das Ergebnis unseres Pre-Tests auf Normalverteilung nochmal visuell bestätigen.</p>
</div>
</div>
<section id="approximativ-normalverteilt-niedrige-fallzahl" class="level3" data-number="22.4.1">
<h3 data-number="22.4.1" class="anchored" data-anchor-id="approximativ-normalverteilt-niedrige-fallzahl"><span class="header-section-number">22.4.1</span> Approximativ normalverteilt, niedrige Fallzahl</h3>
<p>Auch hier schauen wir uns den Fall mit einer niedrigen Fallzahl an. Dafür bauen wir usn erstmal Daten mit der Funktion <code>rt()</code>. Wir ziehen uns zufällig Beobachtungen aus einer t-Verteilung, die approximativ normalverteilt ist. Je höher die Freiheitsgrade <code>df</code> desto näher kommt die t-Verteilung einer Normalverteilung. Mit einem Freiheitsgrad von <code>df = 30</code> sind wir sehr nah an einer Normalverteilung dran.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">202209013</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>low_normal_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">A =</span> <span class="fu">rt</span>(<span class="dv">10</span>, <span class="at">df =</span> <span class="dv">30</span>),</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">B =</span> <span class="fu">rt</span>(<span class="dv">10</span>, <span class="at">df =</span> <span class="dv">30</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(trt, rsp) <span class="sc">|&gt;</span> </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt =</span> <span class="fu">as_factor</span>(trt))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In <a href="#fig-normal-1" class="quarto-xref">Abbildung&nbsp;<span>22.14</span></a> sehen wir auf der linken Seite den Dotplot der zehn Beobachtungen aus den beiden Gruppen <span class="math inline">\(A\)</span> und <span class="math inline">\(B\)</span>. Wir sehen, dass die Verteilung für das Outcome <code>rsp</code> in etwa normalverteilt ist.</p>
<div class="cell" data-layout-nrow="1" data-layout-align="center">
<div id="fig-normal-1" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-normal-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-normal-1" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-normal-1-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-normal-1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-pretest_files/figure-html/fig-normal-1-1.png" class="lightbox" data-gallery="fig-normal-1" data-glightbox="description: .lightbox-desc-15"><img src="stat-tests-pretest_files/figure-html/fig-normal-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-normal-1" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-normal-1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Dotplot des Outcomes <code>rsp</code>.
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-normal-1" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-normal-1-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-normal-1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-pretest_files/figure-html/fig-normal-1-2.png" class="lightbox" data-gallery="fig-normal-1" data-glightbox="description: .lightbox-desc-16"><img src="stat-tests-pretest_files/figure-html/fig-normal-1-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-normal-1" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-normal-1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Densityplot des Outcomes <code>rsp</code>.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-normal-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;22.14— Verteilung des Outcomes <code>rsp</code> der zehn Beobachtungen aus den Gruppen <span class="math inline">\(A\)</span> und <span class="math inline">\(B\)</span>. Beiden Gruppen kommen aus einer t-Verteilung.
</figcaption>
</figure>
</div>
</div>
<p>Wir können den Shapiro-Wilk-Test nutzen um statistisch zu testen, ob eine Abweichung von der Normalverteilung vorliegt. Wir erfahren aber nicht, welche <em>andere</em> Verteilung vorliegt. Wir testen natürlich für die beiden Gruppen getrennt. Die Funktion <code>shapiro.test()</code>kann nur mit einem Vektor von Zahlen arbeiten, daher übergeben wir mit <code>pull</code> die entsprechend gefilterten Werte des Outcomes <code>rsp</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>low_normal_tbl <span class="sc">|&gt;</span> </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trt <span class="sc">==</span> <span class="st">"A"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(rsp) <span class="sc">|&gt;</span> </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro.test</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  pull(filter(low_normal_tbl, trt == "A"), rsp)
W = 0.9457, p-value = 0.618</code></pre>
</div>
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>low_normal_tbl <span class="sc">|&gt;</span> </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trt <span class="sc">==</span> <span class="st">"B"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(rsp) <span class="sc">|&gt;</span> </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro.test</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  pull(filter(low_normal_tbl, trt == "B"), rsp)
W = 0.89291, p-value = 0.1828</code></pre>
</div>
</div>
<p>Wir sehen, dass der <span class="math inline">\(p\)</span>-Wert größer ist als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> von 5% für beide Gruppen. Damit können wir die Nullhypothese nicht ablehnen. Wir nehmen eine Normalverteilung an.</p>
<p>In dem folgendem Beispiel sehen wir dann aber, was ich mit in die Ecke testen meine bzw. so lange statistisch zu Testen bis nichts mehr geht.</p>
</section>
<section id="nicht-normalverteilt-niedrige-fallzahl" class="level3 page-columns page-full" data-number="22.4.2">
<h3 data-number="22.4.2" class="anchored" data-anchor-id="nicht-normalverteilt-niedrige-fallzahl"><span class="header-section-number">22.4.2</span> Nicht normalverteilt, niedrige Fallzahl</h3>
<p>Schauen wir uns jetzt den anderen Fall an. Wir haben jetzt wieder eine niedrige Fallzahl mit je 10 Beobachtungen je Gruppe <span class="math inline">\(A\)</span> und <span class="math inline">\(B\)</span>. In diesem Fall kommen die Beobachtungen aber aus einer exponentiellen Verteilung. Wir haben also definitiv keine Normalverteilung vorliegen. Wir generieren uns die Daten mit der Funktion <code>rexp()</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">202209013</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>low_nonnormal_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">A =</span> <span class="fu">rexp</span>(<span class="dv">10</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">1500</span>),</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">B =</span> <span class="fu">rexp</span>(<span class="dv">10</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">1500</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(trt, rsp) <span class="sc">|&gt;</span> </span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt =</span> <span class="fu">as_factor</span>(trt))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In <a href="#fig-normal-2" class="quarto-xref">Abbildung&nbsp;<span>22.15</span></a> sehen wir auf der linken Seite den Dotplot der zehn Beobachtungen aus den beiden Gruppen <span class="math inline">\(A\)</span> und <span class="math inline">\(B\)</span>. Wir sehen, dass die Verteilung für das Outcome für die Behandlung <span class="math inline">\(B\)</span> in etwa normalverteilt ist sowie das das Outcome für die Behandlung <span class="math inline">\(A\)</span> keiner Normalverteilung folgt <em>oder</em> zwei Ausreißer hat. Die Entscheidung was jetzt stimmt ohne zu wissen wie die Daten generiert wurden, ist in der Anwendung meist nicht möglich.</p>
<div class="cell" data-layout-nrow="1" data-layout-align="center">
<div id="fig-normal-2" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-normal-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-normal-2" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-normal-2-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-normal-2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-pretest_files/figure-html/fig-normal-2-1.png" class="lightbox" data-gallery="fig-normal-2" data-glightbox="description: .lightbox-desc-17"><img src="stat-tests-pretest_files/figure-html/fig-normal-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-normal-2" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-normal-2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Dotplot des Outcomes <code>rsp</code>.
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-normal-2" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-normal-2-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-normal-2-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-pretest_files/figure-html/fig-normal-2-2.png" class="lightbox" data-gallery="fig-normal-2" data-glightbox="description: .lightbox-desc-18"><img src="stat-tests-pretest_files/figure-html/fig-normal-2-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-normal-2" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-normal-2-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Densityplot des Outcomes <code>rsp</code>.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-normal-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;22.15— Verteilung des Outcomes <code>rsp</code> der zehn Beobachtungen aus den Gruppen <span class="math inline">\(A\)</span> und <span class="math inline">\(B\)</span>. Beiden Gruppen kommen aus einer Exponentialverteilung.
</figcaption>
</figure>
</div>
</div>
<p>Wir können wieder den Shapiro-Wilk-Test nutzen um statistisch zu testen, ob eine Abweichung von der Normalverteilung vorliegt. Wir erfahren aber nicht, welche <em>andere</em> Verteilung vorliegt. Wir testen natürlich für die beiden Gruppen getrennt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>low_nonnormal_tbl <span class="sc">|&gt;</span> </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trt <span class="sc">==</span> <span class="st">"A"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(rsp) <span class="sc">|&gt;</span> </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro.test</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  pull(filter(low_nonnormal_tbl, trt == "A"), rsp)
W = 0.77114, p-value = 0.006457</code></pre>
</div>
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>low_nonnormal_tbl <span class="sc">|&gt;</span> </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trt <span class="sc">==</span> <span class="st">"B"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(rsp) <span class="sc">|&gt;</span> </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro.test</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  pull(filter(low_nonnormal_tbl, trt == "B"), rsp)
W = 0.93316, p-value = 0.4797</code></pre>
</div>
</div>
<p>Wir sehen, dass der <span class="math inline">\(p\)</span>-Wert für die Behandlung <span class="math inline">\(A\)</span> kleiner ist als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> von 5%. Damit können wir die Nullhypothese ablehnen. Wir nehmen keine Normalverteilung für Gruppe <span class="math inline">\(A\)</span> an. Auf der anderen Seite sehen wir, dass der <span class="math inline">\(p\)</span>-Wert für die Behandlung <span class="math inline">\(B\)</span> größer ist als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> von 5%. Damit können wir die Nullhypothese nicht ablehnen. Wir nehmen eine Normalverteilung für Gruppe <span class="math inline">\(A\)</span> an.</p>
<p>Super, jetzt haben wir für die eine Gruppe eine Normalverteilung und für die andere nicht. Wir haben uns in die Ecke getestet. Wir können jetzt verschiedene Szenarien vorliegen haben.</p>
<ol type="1">
<li>Wir könnten in der Gruppe <span class="math inline">\(A\)</span> zwei Ausreißer vorliegen haben.</li>
<li>Wir könnten in der Gruppe <span class="math inline">\(B\)</span> zufällig eine Normalverteilung beobachtet haben.</li>
</ol>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside">Und nochmal zum Schluß, einem statistischen Test mit 4 bis 5 Wiederholungen in einer Gruppe zu glauben, ob eine Normalverteilung vorliegt, kannst du auch würfeln…</span></div></div>
<p>Leider wissen wir im echten Leben nicht, aus welcher Verteilung unsere Daten stammen, wir können aber <em>annehmen</em>, dass die Daten einer Normalverteilung folgen oder aber die Daten so transformieren, dass die Daten einer approximativen Normalverteilung folgen. Siehe dazu auch das <a href="eda-transform.html" class="quarto-xref"><span>Kapitel 18</span></a> zur Transformation von Daten.</p>
<p>Wenn deine Daten <em>keiner</em> Normalverteilung folgen, dann kann es sein, dass du mit den Effektschätzern ein Problem bekommst. Du erfährst vielleicht, dass du die Nullhypothese ablehnen kannst, aber nicht wie stark der Effekt in der Einheit des gemessenen Outcomes ist.</p>
</section>
<section id="testen-der-normalverteilungsannahme-in-mehreren-gruppen" class="level3" data-number="22.4.3">
<h3 data-number="22.4.3" class="anchored" data-anchor-id="testen-der-normalverteilungsannahme-in-mehreren-gruppen"><span class="header-section-number">22.4.3</span> Testen der Normalverteilungsannahme in mehreren Gruppen</h3>
<p>Im folgenden Beispiel zu den Keimungsraten von verschiedenen Nelkensorten wollen wir einmal testen, ob jede Sorte einer Normalverteilung folgt. Da wir hier insgesamt 20 Sorten vorliegen haben, nutzen wir die Funktion <code>map()</code> aus dem R Paket <code>{purrr}</code> um hier schneller voranzukommen. Wie immer laden wir erst die Daten und mutieren die Spalten in dem Sinne wie wir die Spalten brauchen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>clove_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/clove_germ_rate.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">clove_strain =</span> <span class="fu">as_factor</span>(clove_strain),</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">germ_rate =</span> <span class="fu">as.numeric</span>(germ_rate))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt können wir die Daten nach der Sorte der Nelken in eine Liste mit der Funktion <code>split()</code> aufspalten und dann auf jedem Listeneintrag einen Shapiro-Wilk-Test rechnen. Dann machen wir uns noch die Ausgabe schöner und erschaffen uns eine <code>decision</code>-Spalte in der wir gleich das Ergebnis für oder gegen die Normalverteilung ablesen können.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>clove_tbl <span class="sc">|&gt;</span> </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(<span class="sc">~</span>clove_strain) <span class="sc">|&gt;</span> </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span><span class="fu">shapiro.test</span>(.x<span class="sc">$</span>germ_rate)) <span class="sc">|&gt;</span> </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(tidy) <span class="sc">|&gt;</span> </span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="at">.id =</span> <span class="st">"test"</span>) <span class="sc">|&gt;</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(test, p.value) <span class="sc">|&gt;</span> </span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">decision =</span> <span class="fu">ifelse</span>(p.value <span class="sc">&lt;=</span> <span class="fl">0.05</span>, <span class="st">"reject normal"</span>, <span class="st">"normal"</span>),</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value, <span class="at">accuracy =</span> <span class="fl">0.001</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 3
   test          p.value decision     
   &lt;chr&gt;         &lt;chr&gt;   &lt;chr&gt;        
 1 standard      0.272   normal       
 2 west_rck_1    0.272   normal       
 3 south_III_V   0.855   normal       
 4 west_rck_2_II 0.653   normal       
 5 comb_001      0.103   normal       
 6 western_4     0.849   normal       
 7 north_549     0.855   normal       
 8 subtype_09    0.983   normal       
 9 subtype_III_4 0.051   normal       
10 ctrl_pos      0.992   normal       
11 ctrl_7        0.683   normal       
12 trans_09_I    0.001   reject normal
13 new_xray_9    0.406   normal       
14 old_09        0.001   reject normal
15 recon_1       0.100   normal       
16 recon_3456    0.001   reject normal
17 east_new      0.907   normal       
18 east_old      0.161   normal       
19 south_II_U    0.048   reject normal
20 west_3_cvl    0.272   normal       </code></pre>
</div>
</div>
</section>
</section>
<section id="visuelle-überprüfung" class="level2" data-number="22.5">
<h2 data-number="22.5" class="anchored" data-anchor-id="visuelle-überprüfung"><span class="header-section-number">22.5</span> Visuelle Überprüfung</h2>
<p>Abschließend möchte ich hier nochmal das <a href="https://easystats.github.io/performance/">R Paket <code>{performance}</code></a> vorstellen. Wir können mit dem Paket auch die Normalverteilungsannahme der Residuen überprüfen sowie die Annahme der Homogenität der Varianzen. Das geht ganz einfach mit der Funktion <code>check_model()</code> in die wir einfach das Objekt mit dem Fit des Modells übergeben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(germ_rate <span class="sc">~</span> clove_strain, clove_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Tja und schon haben wir in der <a href="#fig-pretest-check-model" class="quarto-xref">Abbildung&nbsp;<span>22.16</span></a> mehr als wir eigentlich wollen. Aber du siehst hier ganz gut, dass wir in diesen Daten Probleme mit der Varianzhomogenität haben. Die Linie in dem Subplot “Homogeneity of Variance” ist nicht flach und horizontal. Deshalb könnten wir die Daten einmal Transformieren oder aber mit der Varianzheterogenität modellieren. Das Modellieren machen wir gleich mal im Anschluss.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>lm_fit <span class="sc">|&gt;</span> <span class="fu">check_model</span>(<span class="at">check =</span> <span class="fu">c</span>(<span class="st">"normality"</span>, <span class="st">"linearity"</span>, <span class="st">"homogeneity"</span>, <span class="st">"qq"</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-pretest-check-model" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pretest-check-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-pretest_files/figure-html/fig-pretest-check-model-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19" data-glightbox="description: .lightbox-desc-19"><img src="stat-tests-pretest_files/figure-html/fig-pretest-check-model-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pretest-check-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;22.16— Übersicht der Plots zu der Modellgüte aus der Funktion <code>check_model()</code> nach der Modellierung mit der Funktion <code>lm()</code> und der Annahme der Varianzhomogenität.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Jetzt modellieren wir einmal die Effekte der <code>clove_strain</code> unter der Annahme der Varianzheterogenität. Die Funktion <code>gls()</code> aus dem R Paket <code>{nlme}</code> passt ein lineares Modell unter Verwendung der verallgemeinerten kleinsten Quadrate an. Die Fehler dürfen dabei aber korreliert oder aber ungleiche Varianzen haben. Damit haben wir ein Modell, was wir nutzen können, wenn wir Varianzheterogenität vorliegen haben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>gls_fit <span class="ot">&lt;-</span> <span class="fu">gls</span>(germ_rate <span class="sc">~</span> clove_strain, </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> clove_strain), </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> clove_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir gehen hier nicht tiefer auf die Funktion ein. Wir müssen nur die <code>weights</code> so angeben, dass die <code>weights</code> die verschiedenen Gruppen in dem Faktor <code>clove_strain</code> berücksichtigen können. Dann haben wir schon das Modell für die Varianzheterogenität. Mehr musst du dann auch nicht machen, dass ist dann manchmal das schöne in R, dass wir dann auch immer wieder auf gewohnte Templates zurückgreifen können.</p>
<p>In der <a href="#fig-pretest-check-model-gls" class="quarto-xref">Abbildung&nbsp;<span>22.17</span></a> sehen wir das Ergebnis der Modellanpassung. Sieht gut aus, jedenfalls besser als mit dem <code>lm()</code>. Besonders schön sehen wir, dass wir dann auch wieder normalverteilte Residuen vorliegen haben. Damit ist eine wichtige Annahme an das Modell erfüllt. Das wäre jetzt ein gutes Modell um im Anschluss <code>emmeans()</code> zu nutzen. Da gehst du dann aber bitte in das <a href="stat-tests-posthoc.html">Kapitel zu den Posthoc Tests</a>.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>gls_fit <span class="sc">|&gt;</span> <span class="fu">check_model</span>(<span class="at">check =</span> <span class="fu">c</span>(<span class="st">"normality"</span>, <span class="st">"linearity"</span>, <span class="st">"qq"</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-pretest-check-model-gls" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pretest-check-model-gls-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-pretest_files/figure-html/fig-pretest-check-model-gls-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20" data-glightbox="description: .lightbox-desc-20"><img src="stat-tests-pretest_files/figure-html/fig-pretest-check-model-gls-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pretest-check-model-gls-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;22.17— Übersicht der Plots zu der Modellgüte aus der Funktion <code>check_model()</code> nach der Modellierung mit der Funktion <code>gls()</code> und der Annahme der Varianzheterogenität über die Gruppen von <code>clove_strain</code>.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="referenzen" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="referenzen">Referenzen</h2>


<!-- -->

<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-2">Abbildung&nbsp;22.2— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein simples Säulendiagramm mit sehr für Farbblinde ungünstigen Farben. Es sind die Mittelwerte sowie die Standardabweichung durch die Fehlerbalken dargestellt.</span>
<span class="glightbox-desc lightbox-desc-3">Abbildung&nbsp;22.3— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut mit den Informationen aus der Funktion <code>emmeans()</code>. Das <em>compact letter display</em> wird dann über das <em>geom_text()</em> gesetzt.</span>
<span class="glightbox-desc lightbox-desc-4">Abbildung&nbsp;22.4— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut mit den Informationen aus der Funktion <code>emmeans()</code>. Das <em>compact letter display</em> wird dann über das <em>geom_text()</em> gesetzt. Die Varianzheterogenität nach der Funktion <code>gls()</code> im obigen Modell berücksichtigt.</span>
<span class="glightbox-desc lightbox-desc-5">Abbildung&nbsp;22.5— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut mit den Informationen aus der Funktion <code>emmeans()</code>. Das <em>compact letter display</em> wird dann über das <em>geom_text()</em> gesetzt. Die Varianzheterogenität nach der Funktion <code>sandwich::vcovHAC</code> im obigen Modell berücksichtigt.</span>
<span class="glightbox-desc lightbox-desc-6">Abbildung&nbsp;22.6— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein Barplot mit den zwei Faktoren Zeit und die Iodine Form.</span>
<span class="glightbox-desc lightbox-desc-7">Abbildung&nbsp;22.7— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut. Wir nutzen das <code>geom_text()</code> um noch besser unser <em>compact letter display</em> zu setzen. Die Kontrolle wurde entfernt, sonst hätten wir hier nicht <code>emmeans</code> in der einfachen Form nutzen können. Wir rechnen hier die Vergleiche getrennt für die beiden Jodformen.</span>
<span class="glightbox-desc lightbox-desc-8">Abbildung&nbsp;22.8— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut. Wir nutzen das <code>geom_text()</code> um noch besser unser <em>compact letter display</em> zu setzen. Die Kontrolle wurde entfernt, sonst hätten wir hier nicht <code>emmeans</code> in der einfachen Form nutzen können. Wir rechnen hier die Vergleiche getrennt für die beiden Jodformen.</span>
<span class="glightbox-desc lightbox-desc-9">Abbildung&nbsp;22.9— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein Barplot mit den zwei Faktoren Zeit und die Iodine Form. Hier soll es dann ein Boxplot werden.</span>
<span class="glightbox-desc lightbox-desc-10">Abbildung&nbsp;22.10— Die Abbildung des Säulendiagramms in <code>ggplot</code> als Boxplot nachgebaut. Wir nutzen das <code>geom_text()</code> um noch besser unser <em>compact letter display</em> zu setzen, dafür müssen wir uns aber nochmal ein Positionsdatensatz bauen. Hier ist das <em>compact letter display</em> getrennt für die beiden Jodformen berechnet.</span>
<span class="glightbox-desc lightbox-desc-11">Abbildung&nbsp;22.11— Die Abbildung des Säulendiagramms in <code>ggplot</code> als Boxplot nachgebaut. Wir nutzen das <code>geom_text()</code> um noch besser unser <em>compact letter display</em> zu setzen, dafür müssen wir uns aber nochmal ein Positionsdatensatz bauen. Hier ist das <em>compact letter display</em> für jede einzelne Faktorkombination berechnet.</span>
<span class="glightbox-desc lightbox-desc-13">Abbildung&nbsp;22.12— Boxplot der beiden Treatment Level A und B. Beide Gruppen haben die gleichen Varianzen. Es liegt Varianzhomogenität vor.</span>
<span class="glightbox-desc lightbox-desc-14">Abbildung&nbsp;22.13— Boxplot der beiden Treatment Level A und B. Beide Gruppen haben ungleiche Varianzen. Es liegt Varianzheterogenität vor.</span>
<span class="glightbox-desc lightbox-desc-15">Abbildung&nbsp;22.14&nbsp;(a)— Dotplot des Outcomes <code>rsp</code>.</span>
<span class="glightbox-desc lightbox-desc-16">Abbildung&nbsp;22.14&nbsp;(b)— Densityplot des Outcomes <code>rsp</code>.</span>
<span class="glightbox-desc lightbox-desc-17">Abbildung&nbsp;22.15&nbsp;(a)— Dotplot des Outcomes <code>rsp</code>.</span>
<span class="glightbox-desc lightbox-desc-18">Abbildung&nbsp;22.15&nbsp;(b)— Densityplot des Outcomes <code>rsp</code>.</span>
<span class="glightbox-desc lightbox-desc-19">Abbildung&nbsp;22.16— Übersicht der Plots zu der Modellgüte aus der Funktion <code>check_model()</code> nach der Modellierung mit der Funktion <code>lm()</code> und der Annahme der Varianzhomogenität.</span>
<span class="glightbox-desc lightbox-desc-20">Abbildung&nbsp;22.17— Übersicht der Plots zu der Modellgüte aus der Funktion <code>check_model()</code> nach der Modellierung mit der Funktion <code>gls()</code> und der Annahme der Varianzheterogenität über die Gruppen von <code>clove_strain</code>.</span>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-kozak2018s" class="csl-entry" role="listitem">
Kozak M, Piepho H-P. 2018. What’s normal anyway? Residual plots are more telling than significance tests when checking ANOVA assumptions. Journal of agronomy and crop science 204: 86–98.
</div>
<div id="ref-zuur2010protocol" class="csl-entry" role="listitem">
Zuur AF, Ieno EN, Elphick CS. 2010. A protocol for data exploration to avoid common statistical problems. Methods in ecology and evolution 1: 3–14.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./stat-tests-effect.html" class="pagination-link" aria-label="Der Effektschätzer">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./experimental-design-preface.html" class="pagination-link" aria-label="Experimentelle Designs">
        <span class="nav-page-text">Experimentelle Designs</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Quellcode</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb83" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = FALSE}</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, readxl, knitr, kableExtra, Hmisc, quantreg,</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="in">               multcomp, emmeans, ggpubr, multcompView, nlme)</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="fu"># Der Pre-Test oder Vortest {#sec-pretest}</span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>*Letzte Änderung am `r format(fs::file_info("stat-tests-pretest.qmd")$modification_time, '%d. %B %Y um %H:%M:%S')`*</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"I struggle with some demons; They were middle class and tame." --- Leonard Cohen, You Want It Darker*</span></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>Der Pre-Test, ein Kapitel was ich nicht mag. Also eher weniger das Kapitel als den Pre-Test. Auf der einen Seite sind die Pre-Tests hoffnungslos veraltet. Pre-Tests stammen aus einer Zeit in der man sich nicht einfach die Daten angucken konnte. Mit angucken meine ich dann in <span class="in">`ggplot`</span> visualisieren. Die Idee hinter Pre-Test ist eigentlich die Angst selber die Entscheidung zu treffen, ob die Daten varianzhomogen oder normalverteilt sind. Eine bessere Lösung ist immer noch das Outcome $y$ zu transformieren (siehe @sec-eda-transform) und dann das untransformierte Modell mit transformierten Modell zu vergleichen (siehe @sec-model-basic-compare). Auf der anderen Seite ist der Pre-Test eine Art übermächtiger Entscheider. Dabei sind die Formel sehr trivial und das Konzept eher simpel. Wir können uns aber folgende Faustregel merken:</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>1)  Wir testen die Varianzhomogenität auf dem *ganzen* Datensatz.</span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>2)  Wir testen die Abweichung von der Normalverteilung für jede Behandlungsgruppe *getrennt*.</span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a>Neben dieser Angst eine Entscheidung zu treffen, hilft einem der Pre-Test zur Varianzhomogenität und der Pre-Test zur Normalverteilung bei kleiner Fallzahl auch nicht wirklich weiter, wie wir gleich sehen werden. Beide Pre-Tests funktionieren erst bei wirklich hohen Fallzahlen gut. Mit hohen Fallzahlen meine ich, Fallzahlen von über 20 Beobachtungen *je Gruppe* bzw. Level des Faktors. Bei kleiner Fallzahl, also der üblichen Anzahl von weniger als zehn Wiederholungen, können wir auch nur die Boxplots oder Dotplots anschauen. Darüber hinaus können wir uns auch schnell ins Abseits testen, so dass wir gar keinen Test mehr übrig haben um unsere Daten auszuwerten.</span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>" layout-valign="center"}</span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/angel_01.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Probleme mit dem Pre-Tests ist, dass die Fallzahl in unseren Daten $D$ oft **viel zu klein** ist um eine eindeutige Aussage zu treffen.</span></span>
<span id="cb83-25"><a href="#cb83-25" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb83-26"><a href="#cb83-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-27"><a href="#cb83-27" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb83-28"><a href="#cb83-28" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visuelle Überprüfung der Normalverteilung und Varianzheterogenität</span></span>
<span id="cb83-29"><a href="#cb83-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-30"><a href="#cb83-30" aria-hidden="true" tabindex="-1"></a>Das <span class="co">[</span><span class="ot">R Paket `{olsrr}`</span><span class="co">](https://olsrr.rsquaredacademy.com/articles/intro.html)</span> erlaubt eine weitreichende Diagnostik auf einem normalverteilten Outcome $y$. Es ist besser sich die Diagnostikplots anzuschauen, als die statistischen Pre-Tests zu rechnen. Besonders bei kleiner Fallzahl. Wenn du dazu dann noch Literatur für deine Abschlussarbeit brauchst, dann nutze doch die Arbeit von @zuur2010protocol mit dem Artikel <span class="co">[</span><span class="ot">A protocol for data exploration to avoid common statistical problems</span><span class="co">](https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/j.2041-210X.2009.00001.x)</span> oder aber die Arbeit von @kozak2018s mit dem Artikel <span class="co">[</span><span class="ot">What's normal anyway? Residual plots are more telling than significance tests when checking ANOVA assumptions</span><span class="co">](https://onlinelibrary.wiley.com/doi/pdf/10.1111/jac.12220?casa_token=22Jm83-kW-MAAAAA:yh0EVuGiGHWDsuPiVP8ZLj51OCasdpIiVWUcYv3Q8dGaIo0yMeNZNwkHIk1ibTCsLhkxbLKZrwZSByo)</span>.</span>
<span id="cb83-31"><a href="#cb83-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-32"><a href="#cb83-32" aria-hidden="true" tabindex="-1"></a>Es ist grundsätzlich besser verschiedene Modelle zu fitten und dann sich in @sec-lin-reg-quality die Güte oder Qualität der Modelle anzuschauen. Jedenfalls ist das meiner Meinung nach die bessere Lösung. Da aber immer wieder nach den Pre-Tests gefragt wird, habe ich auch dieses Kapitel erschaffen.</span>
<span id="cb83-33"><a href="#cb83-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-34"><a href="#cb83-34" aria-hidden="true" tabindex="-1"></a>Ich habe dir am Ende des Kapitels nochmal den einfachen Weg dein Modell zu überprüfen an einem etwas komplexeren Datensatz aufgezeigt. Schau dir dazu dann die @fig-pretest-check-model einmal an. Diese Abbildung kannst du dann auch nachbauen und in deinen Anhang packen sowie dich mit der Referenz drauf beziehen.</span>
<span id="cb83-35"><a href="#cb83-35" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb83-36"><a href="#cb83-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-37"><a href="#cb83-37" aria-hidden="true" tabindex="-1"></a><span class="fu">## Genutzte R Pakete</span></span>
<span id="cb83-38"><a href="#cb83-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-39"><a href="#cb83-39" aria-hidden="true" tabindex="-1"></a>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</span>
<span id="cb83-40"><a href="#cb83-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-41"><a href="#cb83-41" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = TRUE}</span></span>
<span id="cb83-42"><a href="#cb83-42" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb83-43"><a href="#cb83-43" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, magrittr, olsrr,</span></span>
<span id="cb83-44"><a href="#cb83-44" aria-hidden="true" tabindex="-1"></a><span class="in">               broom, car, performance, </span></span>
<span id="cb83-45"><a href="#cb83-45" aria-hidden="true" tabindex="-1"></a><span class="in">               see, scales, readxl, nlme,</span></span>
<span id="cb83-46"><a href="#cb83-46" aria-hidden="true" tabindex="-1"></a><span class="in">               conflicted)</span></span>
<span id="cb83-47"><a href="#cb83-47" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::filter)</span></span>
<span id="cb83-48"><a href="#cb83-48" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::select)</span></span>
<span id="cb83-49"><a href="#cb83-49" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-50"><a href="#cb83-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-51"><a href="#cb83-51" aria-hidden="true" tabindex="-1"></a>An der Seite des Kapitels findest du den Link *Quellcode anzeigen*, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</span>
<span id="cb83-52"><a href="#cb83-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-53"><a href="#cb83-53" aria-hidden="true" tabindex="-1"></a><span class="fu">## Die Flowchart, die jeder möchte...</span></span>
<span id="cb83-54"><a href="#cb83-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-55"><a href="#cb83-55" aria-hidden="true" tabindex="-1"></a>Dann hier mal gleich zu Beginn die Flowchart, die jeder gerne möchte. In der @fig-mermaid-pretest-01 sehen wir einmal dargestellt, welches statistische Modell wir rechnen können um dann eine ANOVA und ein Posthoc-Test anzuschließen. Wie du auf den ersten Blick siehst, ist es immer besser auf der linken Seite der Flowchart zu sein. Viele Merkmale in den Agrarwissenschaften folgen per se einer Normalverteilung, so dass sich nur die Frage nach der Varianzhomogenität stellt.</span>
<span id="cb83-56"><a href="#cb83-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-59"><a href="#cb83-59" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb83-60"><a href="#cb83-60" aria-hidden="true" tabindex="-1"></a><span class="in">%%| label: fig-mermaid-pretest-01</span></span>
<span id="cb83-61"><a href="#cb83-61" aria-hidden="true" tabindex="-1"></a><span class="in">%%| fig-width: 6</span></span>
<span id="cb83-62"><a href="#cb83-62" aria-hidden="true" tabindex="-1"></a><span class="in">%%| fig-cap: "Flowchart für die Entscheidung welches statistische Modell gerechnet werden kann: `lm()`, lineare Regression, `gls()`, generalized least squares Regression, `rq()`, Quantilesregression. Die Funktionen finden sich teilweise in eigenen R Paketen. Bei einem nicht-normalverteilten Outcome mit Varianzheterogenität über die Gruppen müssen wir nochmal gemeinsam in die Daten schauen."</span></span>
<span id="cb83-63"><a href="#cb83-63" aria-hidden="true" tabindex="-1"></a><span class="in">flowchart TD</span></span>
<span id="cb83-64"><a href="#cb83-64" aria-hidden="true" tabindex="-1"></a><span class="in">    A("Normalverteiltes Outcome</span></span>
<span id="cb83-65"><a href="#cb83-65" aria-hidden="true" tabindex="-1"></a><span class="in">       in jeder Versuchsgruppe"):::factor --- B(((ja))) --&gt; B1 </span></span>
<span id="cb83-66"><a href="#cb83-66" aria-hidden="true" tabindex="-1"></a><span class="in">    A("Normalverteiltes Outcome</span></span>
<span id="cb83-67"><a href="#cb83-67" aria-hidden="true" tabindex="-1"></a><span class="in">       in jeder Versuchsgruppe"):::factor --- F(((nein))) --&gt; B2</span></span>
<span id="cb83-68"><a href="#cb83-68" aria-hidden="true" tabindex="-1"></a><span class="in">    subgraph B1["Mittelwertsvergleiche"]</span></span>
<span id="cb83-69"><a href="#cb83-69" aria-hidden="true" tabindex="-1"></a><span class="in">    C("Varianzhomogenität</span></span>
<span id="cb83-70"><a href="#cb83-70" aria-hidden="true" tabindex="-1"></a><span class="in">       über alle Gruppen"):::factor --- D((("ja"))) --&gt; E("lm()"):::factor</span></span>
<span id="cb83-71"><a href="#cb83-71" aria-hidden="true" tabindex="-1"></a><span class="in">    C("Varianzhomogenität</span></span>
<span id="cb83-72"><a href="#cb83-72" aria-hidden="true" tabindex="-1"></a><span class="in">       über alle Gruppen"):::factor --- J(((nein))) --&gt; K("gls()"):::factor </span></span>
<span id="cb83-73"><a href="#cb83-73" aria-hidden="true" tabindex="-1"></a><span class="in">    end</span></span>
<span id="cb83-74"><a href="#cb83-74" aria-hidden="true" tabindex="-1"></a><span class="in">    subgraph B2["Medianvergleiche, OR oder RR"]</span></span>
<span id="cb83-75"><a href="#cb83-75" aria-hidden="true" tabindex="-1"></a><span class="in">    G("Varianzhomogenität</span></span>
<span id="cb83-76"><a href="#cb83-76" aria-hidden="true" tabindex="-1"></a><span class="in">       über alle Gruppen"):::factor --- H(((ja))) --&gt; I("rq()"):::factor  </span></span>
<span id="cb83-77"><a href="#cb83-77" aria-hidden="true" tabindex="-1"></a><span class="in">    G("Varianzhomogenität</span></span>
<span id="cb83-78"><a href="#cb83-78" aria-hidden="true" tabindex="-1"></a><span class="in">       über alle Gruppen"):::factor --- L(((nein))) </span></span>
<span id="cb83-79"><a href="#cb83-79" aria-hidden="true" tabindex="-1"></a><span class="in">    end</span></span>
<span id="cb83-80"><a href="#cb83-80" aria-hidden="true" tabindex="-1"></a><span class="in">    classDef factor fill:#56B4E9,stroke:#333,stroke-width:0.75px</span></span>
<span id="cb83-81"><a href="#cb83-81" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-82"><a href="#cb83-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-83"><a href="#cb83-83" aria-hidden="true" tabindex="-1"></a>Du findest die vorgeschlagenen Funktionen dann in den entsprechenden Kapiteln zur ANOVA und den Posthoc-Tests. Du kannst dir dann dort den Code zusammensuchen. Je nach deiner Datenlage musst du dann nochmal etwas an dem R Code programmieren. Beachte, dass die Funktionen sich teilweise in eigenen R Paketen finden lassen. So ist die Funktion <span class="in">`gls()`</span> im R Paket <span class="in">`{nlme}`</span> und die Funktion <span class="in">`rq()`</span> im R Paket <span class="in">`{quantreg}`</span> zu finden. Du kannst auch bei Varianzheterogenität das R Paket <span class="in">`{sandwich}`</span> nutzen und einen entsprechend angepassten Varianzschätzer. Mehr findest du dazu bei den Posthoc-Test in dem Abschnitt zu dem <span class="co">[</span><span class="ot">Gruppenvergleich unter Varianzheterogenität</span><span class="co">](#sec-posthoc-var-heterogen)</span> oder gleich im ersten Zerforschenbeispiel zum einfaktoriellen Barplot.</span>
<span id="cb83-84"><a href="#cb83-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-85"><a href="#cb83-85" aria-hidden="true" tabindex="-1"></a>Und dann auch gleich hier, weil es so schön passt, die Zerforschenbeispiele zu der obigen Flowchart. Im Prinzip kannst du einmal rein schauen und sehen, ob die Abbildung dem entspricht was du möchtest. Mehr zu dem Code findest du dann in den entsprechenden Kapiteln zu den multiplen Vergleichen oder aber der Regressionen.</span>
<span id="cb83-86"><a href="#cb83-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-87"><a href="#cb83-87" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb83-88"><a href="#cb83-88" aria-hidden="true" tabindex="-1"></a><span class="fu">## Zerforschen: Einfaktorieller Barplot mit `lm()`, `gls()` oder `sandwich`</span></span>
<span id="cb83-89"><a href="#cb83-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-90"><a href="#cb83-90" aria-hidden="true" tabindex="-1"></a>{{&lt; include zerforschen/zerforschen-simple-barplot-emmeans.qmd &gt;}}</span>
<span id="cb83-91"><a href="#cb83-91" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb83-92"><a href="#cb83-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-93"><a href="#cb83-93" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb83-94"><a href="#cb83-94" aria-hidden="true" tabindex="-1"></a><span class="fu">## Zerforschen: Zweifaktorieller Barplot mit `lm()` oder `gls()`</span></span>
<span id="cb83-95"><a href="#cb83-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-96"><a href="#cb83-96" aria-hidden="true" tabindex="-1"></a>{{&lt; include zerforschen/zerforschen-barplot-2fac-target-emmeans.qmd &gt;}}</span>
<span id="cb83-97"><a href="#cb83-97" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb83-98"><a href="#cb83-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-99"><a href="#cb83-99" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb83-100"><a href="#cb83-100" aria-hidden="true" tabindex="-1"></a><span class="fu">## Zerforschen: Zweifaktorieller Boxplot mit `rq()`</span></span>
<span id="cb83-101"><a href="#cb83-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-102"><a href="#cb83-102" aria-hidden="true" tabindex="-1"></a>{{&lt; include zerforschen/zerforschen-boxplot-2fac-target-emmeans.qmd &gt;}}</span>
<span id="cb83-103"><a href="#cb83-103" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb83-104"><a href="#cb83-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-105"><a href="#cb83-105" aria-hidden="true" tabindex="-1"></a>Bei einem nicht-normalverteilten Outcome mit Varianzheterogenität über die Gruppen müssen wir nochmal gemeinsam in die Daten schauen. Da meldest du dich bitte nochmal bei mir in der statistischen Beratung. Hier öffnet sich nämlich eine Tür in eine ganz eigene Modellwelt und je nach wissenschaftlicher Fragestellung können wir dann eine Lösung finden.</span>
<span id="cb83-106"><a href="#cb83-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-107"><a href="#cb83-107" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip collapse="true"}</span>
<span id="cb83-108"><a href="#cb83-108" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exkurs: Robuste Schätzung von Standardfehlern, Konfidenzintervallen und p-Werten</span></span>
<span id="cb83-109"><a href="#cb83-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-110"><a href="#cb83-110" aria-hidden="true" tabindex="-1"></a>Wenn du noch etwas weiter gehen möchtest, dann kannst du dir noch die Hilfeseite von dem R Paket <span class="in">`{performance}`</span> <span class="co">[</span><span class="ot">Robust Estimation of Standard Errors, Confidence Intervals, and p-values</span><span class="co">](https://easystats.github.io/parameters/articles/model_parameters_robust.html?q=Heteroskedasticity#robust-covariance-matrix-estimation-from-model-parameters)</span> anschauen. Die Idee ist hier, dass wir die Varianz/Kovarianz robuster daher mit der Berücksichtigung von Varianzheterogenität (eng. *heteroskedasticity*) schätzen.</span>
<span id="cb83-111"><a href="#cb83-111" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb83-112"><a href="#cb83-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-113"><a href="#cb83-113" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pre-Test auf Varianzhomogenität</span></span>
<span id="cb83-114"><a href="#cb83-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-115"><a href="#cb83-115" aria-hidden="true" tabindex="-1"></a>Was will also der Pre-Test auf Varianzhomogenität? Eigentlich ist der Test vollkommen verquer. Zum einen testet der Test auf Varianzhomogenität gar nicht die *Anwesenheit* von Homogenität. Wir können dank dem Falisifikationsprinzip nur Ablehnen. Deshalb steht in der Nullhypothese die Gleichheit der Varianzen, also Varianzhomogenität und in der Alternativen dann die Varianzheterogenität, als der Unterschied.</span>
<span id="cb83-116"><a href="#cb83-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-117"><a href="#cb83-117" aria-hidden="true" tabindex="-1"></a>Ab wann sollten wir denn die Varianzhomogenität ablehnen? Wenn wir standardmäßig auf 5% testen, dann werden wir zu selten die Varianzhomogenität ablehnen. Daher ist es ratsam in diesem Fall auf ein Signifikanzniveau von $\alpha$ gleich 20% zu testen. Aber auch in diesem Fall können wir natürlich eine Varianzhomogenität übersehen oder aber eine Varianzheterogenität fälschlicherweise annehmen.</span>
<span id="cb83-118"><a href="#cb83-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-119"><a href="#cb83-119" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>" layout-valign="center"}</span>
<span id="cb83-120"><a href="#cb83-120" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/angel_01.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb83-121"><a href="#cb83-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-122"><a href="#cb83-122" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Einigermaßen zuverlässig meint, dass wir dann in 1 von 20 Fällen eine Varianzhomogenität ablehnen, obwohl eine Varianzhomogenität vorliegt. Ebenso können wir in 1 von 5 Fällen die Nullhypothese nicht ablehnen, obwohl die Varianzen heterogen sind (siehe auch @sec-alpha-beta).</span></span>
<span id="cb83-123"><a href="#cb83-123" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb83-124"><a href="#cb83-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-125"><a href="#cb83-125" aria-hidden="true" tabindex="-1"></a>Es ergeben sich folgende Hypothesen für den Pre-Test auf Varianzhomogenität.</span>
<span id="cb83-126"><a href="#cb83-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-127"><a href="#cb83-127" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb83-128"><a href="#cb83-128" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb83-129"><a href="#cb83-129" aria-hidden="true" tabindex="-1"></a>H_0: &amp;\; s^2_A = s^2_B<span class="sc">\\</span></span>
<span id="cb83-130"><a href="#cb83-130" aria-hidden="true" tabindex="-1"></a>H_A: &amp;\; s^2_A \ne s^2_B<span class="sc">\\</span></span>
<span id="cb83-131"><a href="#cb83-131" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb83-132"><a href="#cb83-132" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb83-133"><a href="#cb83-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-134"><a href="#cb83-134" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass in der Nullhypothese die Gleichheit der Varianzen steht und in der Alternativehypothese der Unterschied, also die Varianzhterogenität.</span>
<span id="cb83-135"><a href="#cb83-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-136"><a href="#cb83-136" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb83-137"><a href="#cb83-137" aria-hidden="true" tabindex="-1"></a><span class="fu">## Entscheidung zur Varianzhomogenität</span></span>
<span id="cb83-138"><a href="#cb83-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-139"><a href="#cb83-139" aria-hidden="true" tabindex="-1"></a>Bei der Entscheidung zur Varianzhomogenität gilt folgende Regel. Ist der $p$-Wert des Pre-Tests auf Varianzhomogenität kleiner als das Signifikanzniveau $\alpha$ von 20% lehnen wir die Nullhypothese ab. Wir nehmen Varianzheterogenität an.</span>
<span id="cb83-140"><a href="#cb83-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-141"><a href="#cb83-141" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ist $p \leq \alpha = 20\%$ so nehmen wir Varianzheterogenität an.</span>
<span id="cb83-142"><a href="#cb83-142" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ist $p &gt; \alpha = 20\%$ so nehmen wir Varianzhomogenität an.</span>
<span id="cb83-143"><a href="#cb83-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-144"><a href="#cb83-144" aria-hidden="true" tabindex="-1"></a>Auf jeden Fall sollten wir das Ergebnis unseres Pre-Tests auf Varianzhomogenität nochmal visuell bestätigen.</span>
<span id="cb83-145"><a href="#cb83-145" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb83-146"><a href="#cb83-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-147"><a href="#cb83-147" aria-hidden="true" tabindex="-1"></a>Wir nutzen zum statistischen Testen den Levene-Test über die Funktion <span class="in">`leveneTest()`</span> oder den Bartlett-Test über die Funktion <span class="in">`bartlett.test()`</span>. Beide Tests sind in R implementiert und können über das Paket <span class="in">`{car}`</span> genutzte werden. Wir werden uns jetzt nicht die Formel anschauen, wir nutzen wenn die beiden Tests nur in R und rechnen nicht selber die Werte nach.</span>
<span id="cb83-148"><a href="#cb83-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-149"><a href="#cb83-149" aria-hidden="true" tabindex="-1"></a>Einfach ausgedrückt, überprüft der Bartlett-Test die Homogenität der Varianzen auf der Grundlage des Mittelwerts. Dementsprechend ist der Bartlett-Test empfindlicher gegen eine Abweichung von der Normalverteilung der Daten, die er überprüfen soll. Der Levene-Test überprüft die Homogenität der Varianzen auch auf der Grundlage des Mittelwerts. Wir haben aber auch die Wahl, den Median zu nutzen dann ist der Levene-Test robuster gegenüber Ausreißern.</span>
<span id="cb83-150"><a href="#cb83-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-151"><a href="#cb83-151" aria-hidden="true" tabindex="-1"></a>Im Folgenden wollen wir uns einmal in der Theorie den Levene-Test anschauen. Der Levene-Test ist eigentlich nichts anderes als eine etwas versteckte einfaktorielle ANOVA, aber dazu dann am Ende mehr. Dafür nutzen wir als erstes die folgende Formel um die Teststatistik zu berechnen. Dabei ist $W$ die Teststatistik, die wir zu einer $F$-Verteilung, die wir schon aus der ANOVA kennen, vergleichen können.</span>
<span id="cb83-152"><a href="#cb83-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-153"><a href="#cb83-153" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb83-154"><a href="#cb83-154" aria-hidden="true" tabindex="-1"></a>W = \frac{(N-k)}{(k-1)} \cdot \frac{\sum_{i=1}^k N_i (\bar{Z}_{i\cdot}-\bar{Z}_{\cdot\cdot})^2} {\sum_{i=1}^k \sum_{j=1}^{N_i} (Z_{ij}-\bar{Z}_{i\cdot})^2}</span>
<span id="cb83-155"><a href="#cb83-155" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb83-156"><a href="#cb83-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-157"><a href="#cb83-157" aria-hidden="true" tabindex="-1"></a>Zur Veranschaulichung bauen wir uns einen simplen Datensatz mit $N = 14$ Beobachtungen für $k = 2$ Tierarten mit Hunden und Katzen. Damit hat jede Tierart $7$ Beobachtungen der Sprunglängen der jeweiligen Hunde- und Katzenflöhe.</span>
<span id="cb83-158"><a href="#cb83-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-161"><a href="#cb83-161" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-162"><a href="#cb83-162" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-163"><a href="#cb83-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-164"><a href="#cb83-164" aria-hidden="true" tabindex="-1"></a>animal_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">dog =</span> <span class="fu">c</span>(<span class="fl">5.7</span>, <span class="fl">8.9</span>, <span class="fl">11.8</span>, <span class="fl">8.2</span>, <span class="fl">5.6</span>, <span class="fl">9.1</span>, <span class="fl">7.6</span>),</span>
<span id="cb83-165"><a href="#cb83-165" aria-hidden="true" tabindex="-1"></a>                     <span class="at">cat =</span> <span class="fu">c</span>(<span class="fl">3.2</span>, <span class="fl">2.2</span>, <span class="fl">5.4</span>, <span class="fl">4.1</span>, <span class="fl">1.1</span>, <span class="fl">7.9</span>, <span class="fl">8.6</span>))</span>
<span id="cb83-166"><a href="#cb83-166" aria-hidden="true" tabindex="-1"></a>animal_tbl</span>
<span id="cb83-167"><a href="#cb83-167" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-168"><a href="#cb83-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-169"><a href="#cb83-169" aria-hidden="true" tabindex="-1"></a>Dann berechnen wir uns auch gleich die absoluten Abstände $Z_{ij}$ von jeder Beobachtung zu den jeweiligen Mittelwerten der Gruppe. Wir könnten auch die Abstände zu den jeweiligen Medianen der Gruppe berechnen. Beides ist möglich. Hier sehen wir auch den Unterschied zu der ANOVA, wir berechnen hier nicht die *quadratischen* Abstände sondern die absoluten Abstände.</span>
<span id="cb83-170"><a href="#cb83-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-173"><a href="#cb83-173" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-174"><a href="#cb83-174" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-175"><a href="#cb83-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-176"><a href="#cb83-176" aria-hidden="true" tabindex="-1"></a>z_tbl <span class="ot">&lt;-</span> animal_tbl <span class="sc">|&gt;</span> </span>
<span id="cb83-177"><a href="#cb83-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dog_abs =</span> <span class="fu">abs</span>(dog <span class="sc">-</span> <span class="fu">mean</span>(dog)),</span>
<span id="cb83-178"><a href="#cb83-178" aria-hidden="true" tabindex="-1"></a>         <span class="at">cat_abs =</span> <span class="fu">abs</span>(cat <span class="sc">-</span> <span class="fu">mean</span>(cat)))</span>
<span id="cb83-179"><a href="#cb83-179" aria-hidden="true" tabindex="-1"></a>z_tbl</span>
<span id="cb83-180"><a href="#cb83-180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-181"><a href="#cb83-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-182"><a href="#cb83-182" aria-hidden="true" tabindex="-1"></a>Im Folgenden nochmal in formelschreibweise der Unterschied zwischen den beiden Abstandsberechnungen $Z_{ij}$ für jeden Wert. Wir haben die Wahl zwischen den Abständen von jeder Beobachtung zu dem Mittelwert oder dem Median.</span>
<span id="cb83-183"><a href="#cb83-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-184"><a href="#cb83-184" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb83-185"><a href="#cb83-185" aria-hidden="true" tabindex="-1"></a>Z_{ij} = </span>
<span id="cb83-186"><a href="#cb83-186" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb83-187"><a href="#cb83-187" aria-hidden="true" tabindex="-1"></a>|Y_{ij} - \bar{Y}_{i\cdot}|, &amp; \bar{Y}_{i\cdot} \text{ ist der Mittelwert der } i\text{-ten Gruppe}, <span class="sc">\\</span></span>
<span id="cb83-188"><a href="#cb83-188" aria-hidden="true" tabindex="-1"></a>|Y_{ij} - \tilde{Y}_{i\cdot}|, &amp; \tilde{Y}_{i\cdot} \text{ ist der Median der } i\text{-ten Gruppe}. </span>
<span id="cb83-189"><a href="#cb83-189" aria-hidden="true" tabindex="-1"></a>\end{cases} </span>
<span id="cb83-190"><a href="#cb83-190" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb83-191"><a href="#cb83-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-192"><a href="#cb83-192" aria-hidden="true" tabindex="-1"></a>Berechnen wir nun die Gruppenmittelwerte $\bar{Z}_{i\cdot}$ für die Hunde und die Katzen jeweils einmal separat.</span>
<span id="cb83-193"><a href="#cb83-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-196"><a href="#cb83-196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-197"><a href="#cb83-197" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(z_tbl<span class="sc">$</span>dog_abs)</span>
<span id="cb83-198"><a href="#cb83-198" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-199"><a href="#cb83-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-202"><a href="#cb83-202" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-203"><a href="#cb83-203" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(z_tbl<span class="sc">$</span>cat_abs)</span>
<span id="cb83-204"><a href="#cb83-204" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-205"><a href="#cb83-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-206"><a href="#cb83-206" aria-hidden="true" tabindex="-1"></a>Dann brauchen wir noch den Mittelwert über alle Beobachtungen hinweg $\bar{Z}_{\cdot\cdot}$. Den können wir aus allen Beoachtungen berechnen oder aber einfach den Mittelwert der beiden Gruppenmittelwerte nehmen.</span>
<span id="cb83-207"><a href="#cb83-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-210"><a href="#cb83-210" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-211"><a href="#cb83-211" aria-hidden="true" tabindex="-1"></a>(<span class="fl">1.57</span> <span class="sc">+</span> <span class="fl">2.28</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb83-212"><a href="#cb83-212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-213"><a href="#cb83-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-214"><a href="#cb83-214" aria-hidden="true" tabindex="-1"></a>Am Ende fehlt uns dann noch der Nenner mit der Summe der einzelnen quadratischen Abstände $Z_{ij}$ zu den Abstandsmitteln der einzelnen Gruppen $\bar{Z}_{i\cdot}$ mit $\sum_{i=1}^k \sum_{j=1}^{N_i} (Z_{ij}-\bar{Z}_{i\cdot})^2$. Den Wert können wir dann in R direkt einmal berechnen. Wir nehmen also die Vektoren der Einzelwerte und ziehen dort immer den Mittelwert der Abstände der Gruppe ab. Abschließend summieren wir dann einmal auf.</span>
<span id="cb83-215"><a href="#cb83-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-218"><a href="#cb83-218" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-219"><a href="#cb83-219" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((z_tbl<span class="sc">$</span>dog_abs <span class="sc">-</span> <span class="fl">1.57</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb83-220"><a href="#cb83-220" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((z_tbl<span class="sc">$</span>cat_abs <span class="sc">-</span> <span class="fl">2.28</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb83-221"><a href="#cb83-221" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-222"><a href="#cb83-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-223"><a href="#cb83-223" aria-hidden="true" tabindex="-1"></a>Wir können dann alle Zahlen einmal zusammenbringen und in die Formel des Levene-Test einsetzen. Nun rechen wir dann wieder die quadratischen Abstände auf den absoluten Abständen. Ja, das ist etwas wirr, wenn man es zum ersten Mal liest.</span>
<span id="cb83-224"><a href="#cb83-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-225"><a href="#cb83-225" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb83-226"><a href="#cb83-226" aria-hidden="true" tabindex="-1"></a>W = </span>
<span id="cb83-227"><a href="#cb83-227" aria-hidden="true" tabindex="-1"></a>\cfrac{14-2}{2-1}\cdot</span>
<span id="cb83-228"><a href="#cb83-228" aria-hidden="true" tabindex="-1"></a>\cfrac{7 \cdot (1.57 - 1.93)^2 + 7 \cdot (2.28 - 1.93)^2}</span>
<span id="cb83-229"><a href="#cb83-229" aria-hidden="true" tabindex="-1"></a>{10.39 + 11.43} =</span>
<span id="cb83-230"><a href="#cb83-230" aria-hidden="true" tabindex="-1"></a>\cfrac{12}{1} \cdot \cfrac{1.76}{21.82} =</span>
<span id="cb83-231"><a href="#cb83-231" aria-hidden="true" tabindex="-1"></a>\cfrac{21.12}{21.82} \approx 0.968</span>
<span id="cb83-232"><a href="#cb83-232" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb83-233"><a href="#cb83-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-234"><a href="#cb83-234" aria-hidden="true" tabindex="-1"></a>Wir erhalten ein $W = 0.968$, was wir direkt als eine F-Statistik interpretieren können. Schauen wir uns das Ergebnis einmal in der R Funktion <span class="in">`leveneTest()`</span> aus dem R Paket <span class="in">`{car}`</span> an. Wir brauchen dafür einmal die Werte für die Sprungweiten und müssen dann die Daten in das long-Format umbauen und dann rechnen wir den Levene-Test. Wir erhalten fast die numerisch gleichen Werte. Bei uns haben wir etwas gerundet und dann kommt die Abweichung zustande.</span>
<span id="cb83-235"><a href="#cb83-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-238"><a href="#cb83-238" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-239"><a href="#cb83-239" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-240"><a href="#cb83-240" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb83-241"><a href="#cb83-241" aria-hidden="true" tabindex="-1"></a>z_tbl <span class="sc">|&gt;</span> </span>
<span id="cb83-242"><a href="#cb83-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dog, cat) <span class="sc">|&gt;</span> </span>
<span id="cb83-243"><a href="#cb83-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> animal, <span class="at">value =</span> jump_length) <span class="sc">%$%</span> </span>
<span id="cb83-244"><a href="#cb83-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">leveneTest</span>(jump_length <span class="sc">~</span> animal, <span class="at">center =</span> <span class="st">"mean"</span>)</span>
<span id="cb83-245"><a href="#cb83-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-246"><a href="#cb83-246" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-247"><a href="#cb83-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-248"><a href="#cb83-248" aria-hidden="true" tabindex="-1"></a>Der Levene-Test ist eigentlich nichts anderes als eine einfaktorielle ANOVA auf den absoluten Abständen von den einzelnen Werten zu dem Mittelwert oder dem Median. Das können wir hier einmal nachvollziehen indem wir auf den absoluten Werten einmal eine einfaktorielle ANOVA in R rechnen. Wir erhalten den gleichen F-Wert in beiden Fällen. Eigentlich ist die ANOVA sogar etwas genauer, da wir hier auch die *Sum of squares* wie auch *Mean squares* erhalten.</span>
<span id="cb83-249"><a href="#cb83-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-252"><a href="#cb83-252" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-253"><a href="#cb83-253" aria-hidden="true" tabindex="-1"></a>z_tbl <span class="sc">|&gt;</span> </span>
<span id="cb83-254"><a href="#cb83-254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dog_abs, cat_abs) <span class="sc">|&gt;</span> </span>
<span id="cb83-255"><a href="#cb83-255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> animal, <span class="at">value =</span> jump_length) <span class="sc">%$%</span> </span>
<span id="cb83-256"><a href="#cb83-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb83-257"><a href="#cb83-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>()</span>
<span id="cb83-258"><a href="#cb83-258" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-259"><a href="#cb83-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-260"><a href="#cb83-260" aria-hidden="true" tabindex="-1"></a>Wir wollen uns nun im Folgenden nun zwei Fälle einmal näher anschauen. Zum einen den Fall, dass wir eine niedrige Fallzahl vorliegen haben und Varianzhomogenität sowie den Fall, dass wir eine niedrige Fallzahl und Varianzheterogenität vorliegen haben. Den Fall, dass wir hohe Fallzahl vorliegen haben, betrachten wir jetzt nicht weiter. In dem Fall funktionieren die Tests einigermaßen zuverlässig.</span>
<span id="cb83-261"><a href="#cb83-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-262"><a href="#cb83-262" aria-hidden="true" tabindex="-1"></a><span class="fu">### Varianzen sind homogen, Fallzahl niedrig</span></span>
<span id="cb83-263"><a href="#cb83-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-264"><a href="#cb83-264" aria-hidden="true" tabindex="-1"></a>Wir bauen uns nun einen Datensatz mit zwei Gruppen $A$ und $B$ zu je zehn Beobachtungen. Beide Gruppen kommen aus einer Normalverteilung mit einem Mittelwert von $\bar{y}_A = \bar{y}_A = 10$. Darüber hinaus haben wir Varianzhomogenität mit $s_A = s_B = 5$ vorliegen. Ja, wir spezifizieren hier in der Funktion <span class="in">`rnorm()`</span> die Standardabweichung, aber eine homogene Standardabweichung bedingt eine homogene Varianz und umgekehrt. Abschließend verwandeln wir das Wide-Format noch in das Long-Format um.</span>
<span id="cb83-265"><a href="#cb83-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-268"><a href="#cb83-268" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-269"><a href="#cb83-269" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">202209013</span>)</span>
<span id="cb83-270"><a href="#cb83-270" aria-hidden="true" tabindex="-1"></a>small_homogen_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">A =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">5</span>),</span>
<span id="cb83-271"><a href="#cb83-271" aria-hidden="true" tabindex="-1"></a>                            <span class="at">B =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">5</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb83-272"><a href="#cb83-272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(trt, rsp) <span class="sc">|&gt;</span> </span>
<span id="cb83-273"><a href="#cb83-273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt =</span> <span class="fu">as_factor</span>(trt))</span>
<span id="cb83-274"><a href="#cb83-274" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-275"><a href="#cb83-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-276"><a href="#cb83-276" aria-hidden="true" tabindex="-1"></a>In der @fig-vartest-1 sehen wir die Daten aus dem <span class="in">`small_homogen_tbl`</span> einmal als Boxplot visualisiert.</span>
<span id="cb83-277"><a href="#cb83-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-280"><a href="#cb83-280" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-281"><a href="#cb83-281" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-282"><a href="#cb83-282" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb83-283"><a href="#cb83-283" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-vartest-1</span></span>
<span id="cb83-284"><a href="#cb83-284" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb83-285"><a href="#cb83-285" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb83-286"><a href="#cb83-286" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb83-287"><a href="#cb83-287" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Boxplot der beiden Treatment Level A und B. Beide Gruppen haben die gleichen Varianzen. Es liegt Varianzhomogenität vor."</span></span>
<span id="cb83-288"><a href="#cb83-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-289"><a href="#cb83-289" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(small_homogen_tbl, <span class="fu">aes</span>(trt, rsp, <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb83-290"><a href="#cb83-290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb83-291"><a href="#cb83-291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb83-292"><a href="#cb83-292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb83-293"><a href="#cb83-293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb83-294"><a href="#cb83-294" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-295"><a href="#cb83-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-296"><a href="#cb83-296" aria-hidden="true" tabindex="-1"></a>Wir wollen nun die Varianz auf Homogenität testen. Wir nutzen dafür den <span class="in">`leveneTest()`</span> sowie den <span class="in">`bartlett.test()`</span>. Beide Tests bieten sich an. Die Daumenregel ist, dass der Bartlett-Test etwas bessere statistische Eigenschaften hat. Dennoch ist der Levene-Test bekannter und wird häufiger angefragt und genutzt. Wir nutzen die Funktion <span class="in">`tidy()`</span> aus dem Paket <span class="in">`{broom}`</span> um die Ausgabe aufzuräumen und selektieren nur den $p$-Wert.</span>
<span id="cb83-297"><a href="#cb83-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-300"><a href="#cb83-300" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-301"><a href="#cb83-301" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(rsp <span class="sc">~</span> trt, <span class="at">data =</span> small_homogen_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb83-302"><a href="#cb83-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb83-303"><a href="#cb83-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(p.value)</span>
<span id="cb83-304"><a href="#cb83-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-305"><a href="#cb83-305" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(rsp <span class="sc">~</span> trt, <span class="at">data =</span> small_homogen_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb83-306"><a href="#cb83-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb83-307"><a href="#cb83-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(p.value)</span>
<span id="cb83-308"><a href="#cb83-308" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-309"><a href="#cb83-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-310"><a href="#cb83-310" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass der $p$-Wert größer ist als das Signifikanzniveau $\alpha$ von 20%. Damit können wir die Nullhypothese nicht ablehnen. Wir nehmen Varianzhomogenität an. Überdies sehen wir auch, dass sich die $p$-Werte nicht groß voneinander unterscheiden.</span>
<span id="cb83-311"><a href="#cb83-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-312"><a href="#cb83-312" aria-hidden="true" tabindex="-1"></a>Wir können auch die Funktion <span class="in">`check_homogeneity()`</span> aus dem Paket <span class="in">`{performance}`</span> nutzen. Wir erhalten hier auch gleich eine Entscheidung in englischer Sprache ausgegeben. Die Funktion <span class="in">`check_homogeneity()`</span> nutzt den Bartlett-Test. Wir können in Funktion auch andere Methoden mit <span class="in">`method = c("bartlett", "fligner", "levene", "auto")`</span> wählen.</span>
<span id="cb83-313"><a href="#cb83-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-316"><a href="#cb83-316" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-317"><a href="#cb83-317" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(rsp <span class="sc">~</span> trt, <span class="at">data =</span> small_homogen_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb83-318"><a href="#cb83-318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_homogeneity</span>()</span>
<span id="cb83-319"><a href="#cb83-319" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-320"><a href="#cb83-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-321"><a href="#cb83-321" aria-hidden="true" tabindex="-1"></a>Wir nutzen das Paket <span class="in">`{performance}`</span> für die Modellgüte im @sec-lin-reg-quality.</span>
<span id="cb83-322"><a href="#cb83-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-323"><a href="#cb83-323" aria-hidden="true" tabindex="-1"></a><span class="fu">### Varianzen sind heterogen, Fallzahl niedrig</span></span>
<span id="cb83-324"><a href="#cb83-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-325"><a href="#cb83-325" aria-hidden="true" tabindex="-1"></a>Nun stellt sich die Frage, wie sieht es aus, wenn wir ungleiche Varianzen vorliegen haben. Wir bauen uns nun einen Datensatz mit zwei Gruppen $A$ und $B$ zu je zehn Beobachtungen. Beide Gruppen kommen aus einer Normalverteilung mit einem Mittelwert von $\bar{y}_A = \bar{y}_A = 12$. Darüber hinaus haben wir Varianzheterogenität mit $s_A = 10 \ne s_B = 5$ vorliegen.</span>
<span id="cb83-326"><a href="#cb83-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-329"><a href="#cb83-329" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-330"><a href="#cb83-330" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">202209013</span>)</span>
<span id="cb83-331"><a href="#cb83-331" aria-hidden="true" tabindex="-1"></a>small_heterogen_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">A =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">12</span>),</span>
<span id="cb83-332"><a href="#cb83-332" aria-hidden="true" tabindex="-1"></a>                              <span class="at">B =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">5</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb83-333"><a href="#cb83-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(trt, rsp) <span class="sc">|&gt;</span> </span>
<span id="cb83-334"><a href="#cb83-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt =</span> <span class="fu">as_factor</span>(trt))</span>
<span id="cb83-335"><a href="#cb83-335" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-336"><a href="#cb83-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-337"><a href="#cb83-337" aria-hidden="true" tabindex="-1"></a>In der @fig-vartest-2 sehen wir die Daten aus dem <span class="in">`small_heterogen_tbl`</span> einmal als Boxplot visualisiert.</span>
<span id="cb83-338"><a href="#cb83-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-341"><a href="#cb83-341" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-342"><a href="#cb83-342" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-343"><a href="#cb83-343" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb83-344"><a href="#cb83-344" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-vartest-2</span></span>
<span id="cb83-345"><a href="#cb83-345" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb83-346"><a href="#cb83-346" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb83-347"><a href="#cb83-347" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb83-348"><a href="#cb83-348" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Boxplot der beiden Treatment Level A und B. Beide Gruppen haben ungleiche Varianzen. Es liegt Varianzheterogenität vor."</span></span>
<span id="cb83-349"><a href="#cb83-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-350"><a href="#cb83-350" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(small_heterogen_tbl, <span class="fu">aes</span>(trt, rsp, <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb83-351"><a href="#cb83-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb83-352"><a href="#cb83-352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb83-353"><a href="#cb83-353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb83-354"><a href="#cb83-354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb83-355"><a href="#cb83-355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-356"><a href="#cb83-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-357"><a href="#cb83-357" aria-hidden="true" tabindex="-1"></a>Wir wollen nun die Varianz auf Homogenität testen. Wir nutzen dafür den <span class="in">`levenTest()`</span> sowie den <span class="in">`bartlett.test()`</span>. Wir können nur die Varianzhomogenität testen, da jeder statistischer Test nur eine Aussage über die Nullhypothese erlaubt. Damit können wir hier nur die Varianzhomogenität testen.</span>
<span id="cb83-358"><a href="#cb83-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-361"><a href="#cb83-361" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-362"><a href="#cb83-362" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(rsp <span class="sc">~</span> trt, <span class="at">data =</span> small_heterogen_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb83-363"><a href="#cb83-363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb83-364"><a href="#cb83-364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(p.value)</span>
<span id="cb83-365"><a href="#cb83-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-366"><a href="#cb83-366" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(rsp <span class="sc">~</span> trt, <span class="at">data =</span> small_heterogen_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb83-367"><a href="#cb83-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb83-368"><a href="#cb83-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(p.value)</span>
<span id="cb83-369"><a href="#cb83-369" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-370"><a href="#cb83-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-371"><a href="#cb83-371" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass der $p$-Wert kleiner ist als das Signifikanzniveau $\alpha$ von 20%. Damit können wir die Nullhypothese ablehnen. Wir nehmen Varianzheterogenität an. Überdies sehen wir auch, dass sich die $p$-Werte nicht groß voneinander unterscheiden. Was wir sehen ist, dass wir zu einem Signifikanzniveau von 5% die klare Varianzheterogenität nicht erkannt hätten und immer noch Varianzhomogenität angenommen hätten.</span>
<span id="cb83-372"><a href="#cb83-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-373"><a href="#cb83-373" aria-hidden="true" tabindex="-1"></a>Wir können auch die Funktion <span class="in">`check_homogeneity()`</span> aus dem Paket <span class="in">`{performance}`</span> nutzen. Wir erhalten hier auch gleich eine Entscheidung in englischer Sprache ausgegeben. Die Funktion <span class="in">`check_homogeneity()`</span> nutzt den Bartlett-Test. Wir können in Funktion auch andere Methoden mit <span class="in">`method = c("bartlett", "fligner", "levene", "auto")`</span> wählen.</span>
<span id="cb83-374"><a href="#cb83-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-377"><a href="#cb83-377" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-378"><a href="#cb83-378" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(rsp <span class="sc">~</span> trt, <span class="at">data =</span> small_heterogen_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb83-379"><a href="#cb83-379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_homogeneity</span>()</span>
<span id="cb83-380"><a href="#cb83-380" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-381"><a href="#cb83-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-382"><a href="#cb83-382" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass sich die Implementierung des Bartlett-Tests in <span class="in">`check_homogeneity()`</span> nicht von der Funktion <span class="in">`bartlett.test()`</span> unterscheidet, aber die Entscheidung gegen die Varianzhomogenität zu einem Signifikanzniveau von 5% gefällt wird. Nicht immer hilft einem der Entscheidungtext einer Funktion.</span>
<span id="cb83-383"><a href="#cb83-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-384"><a href="#cb83-384" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pre-Test auf Normalverteilung</span></span>
<span id="cb83-385"><a href="#cb83-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-386"><a href="#cb83-386" aria-hidden="true" tabindex="-1"></a>Wir treffen bei dem Test auf die Normalverteilung auch auf das gleiche Problem wie bei dem Pre-Test zur Varianzhomogenität. Wir haben wieder die Gleichheit, also das unser beobachtetes Outcome gleich einer Normalverteilung ist, in der Nullhypothese stehen. Den Unterschied, also das unser beobachtetes Outcome nicht aus einer Normalverteilung kommmt, in der Alternative.</span>
<span id="cb83-387"><a href="#cb83-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-388"><a href="#cb83-388" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb83-389"><a href="#cb83-389" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb83-390"><a href="#cb83-390" aria-hidden="true" tabindex="-1"></a>H_0: &amp;\; \mbox{y ist gleich normalverteilt}<span class="sc">\\</span></span>
<span id="cb83-391"><a href="#cb83-391" aria-hidden="true" tabindex="-1"></a>H_A: &amp;\; \mbox{y ist nicht gleich normalverteilt}<span class="sc">\\</span></span>
<span id="cb83-392"><a href="#cb83-392" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb83-393"><a href="#cb83-393" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb83-394"><a href="#cb83-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-395"><a href="#cb83-395" aria-hidden="true" tabindex="-1"></a>Nun ist es aber so, dass es nicht nur *zwei* Verteilungen gibt. Es gibt mehr als die Normalverteilung und die *Nicht*-normalverteilung. Wir haben eine große Auswahl an möglichen Verteilungen und seit den 90zigern des letzten Jahrhunderts auch die Möglichkeiten andere Verteilungen des Outcomes $y$ zu modellieren. Leider fällt dieser Fortschritt häufig unter den Tisch und wir bleiben gefangen zwischen der Normalverteilung oder eben keiner Normalverteilung.</span>
<span id="cb83-396"><a href="#cb83-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-397"><a href="#cb83-397" aria-hidden="true" tabindex="-1"></a>::: column-margin</span>
<span id="cb83-398"><a href="#cb83-398" aria-hidden="true" tabindex="-1"></a>Der <span class="co">[</span><span class="ot">zentrale Grenzwertsatz</span><span class="co">](https://de.wikipedia.org/wiki/Zentraler_Grenzwertsatz)</span> besagt, dass wenn ein $y$ von vielen Einflussfaktoren $x$ bestimmt wird, man von einem normalverteilten $y$ ausgehen.</span>
<span id="cb83-399"><a href="#cb83-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-400"><a href="#cb83-400" aria-hidden="true" tabindex="-1"></a>Das Gewicht wird von vielen Einflussfaktoren wie Sport, Kalorienaufnahme oder aber Veranlagung sowie vielem mehr bestimmt. Wir können davon ausgehen, dass das Gewicht normalverteilt ist.</span>
<span id="cb83-401"><a href="#cb83-401" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb83-402"><a href="#cb83-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-403"><a href="#cb83-403" aria-hidden="true" tabindex="-1"></a>Abschließend sei noch gesagt, dass es fast unmöglich ist, eine Verteilung mit weniger als zwanzig Beobachtungen überhaupt abzuschätzen. Selbst dann können einzelne Beobachtunge an den Rändern der Verteilung zu einer Ablehnung der Normalverteilung führen, obwohl eine Normalverteilung vorliegt.</span>
<span id="cb83-404"><a href="#cb83-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-405"><a href="#cb83-405" aria-hidden="true" tabindex="-1"></a>Das R Paket <span class="in">`{oslrr}`</span> bietet hier noch eine Funktion <span class="in">`ols_test_normality()`</span>, die es erlaubt mit allen bekannten statistischen Tests auf Normalverteilung zu testen. Wenn der $p$-Wert kleiner ist als das Signifikanzniveau $\alpha$, dann können wir die Nullhypothese, dass unsere Daten gleich einer Normalverteilung wären, ablehnen. Die Anwendung kannst du dir in @sec-gaussian anschauen. Um jetzt kurz einen statistischen Engel anzufahren, wir nutzen *wenn überhaupt* den Shapiro-Wilk-Test oder den Kolmogorov-Smirnov-Test. Für die anderen beiden steigen wir jetzt hier nicht in die Therorie ab.</span>
<span id="cb83-406"><a href="#cb83-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-407"><a href="#cb83-407" aria-hidden="true" tabindex="-1"></a>Am Ende sei noch auf den <span class="co">[</span><span class="ot">QQ-plot</span><span class="co">](#sec-linreg-qq)</span> verwiesen, mit dem wir auch visuell überprüfen können, ob eine Normalverteilung vorliegt.</span>
<span id="cb83-408"><a href="#cb83-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-409"><a href="#cb83-409" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb83-410"><a href="#cb83-410" aria-hidden="true" tabindex="-1"></a><span class="fu">## Entscheidung zur Normalverteilung</span></span>
<span id="cb83-411"><a href="#cb83-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-412"><a href="#cb83-412" aria-hidden="true" tabindex="-1"></a>Bei der Entscheidung zur Normalverteilung gilt folgende Regel. Ist der $p$-Wert des Pre-Tests auf Normalverteilung kleiner als das Signifikanzniveau $\alpha$ von 5% lehnen wir die Nullhypothese ab. Wir nehmen eine Nicht-Normalverteilung an.</span>
<span id="cb83-413"><a href="#cb83-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-414"><a href="#cb83-414" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ist $p \leq \alpha = 5\%$ so nehmen wir Nicht-Normalverteilung von $y$ an.</span>
<span id="cb83-415"><a href="#cb83-415" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ist $p &gt; \alpha = 5\%$ so nehmen wir Normalverteilung von $y$ an.</span>
<span id="cb83-416"><a href="#cb83-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-417"><a href="#cb83-417" aria-hidden="true" tabindex="-1"></a>Auf jeden Fall sollten wir das Ergebnis unseres Pre-Tests auf Normalverteilung nochmal visuell bestätigen.</span>
<span id="cb83-418"><a href="#cb83-418" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb83-419"><a href="#cb83-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-420"><a href="#cb83-420" aria-hidden="true" tabindex="-1"></a><span class="fu">### Approximativ normalverteilt, niedrige Fallzahl</span></span>
<span id="cb83-421"><a href="#cb83-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-422"><a href="#cb83-422" aria-hidden="true" tabindex="-1"></a>Auch hier schauen wir uns den Fall mit einer niedrigen Fallzahl an. Dafür bauen wir usn erstmal Daten mit der Funktion <span class="in">`rt()`</span>. Wir ziehen uns zufällig Beobachtungen aus einer t-Verteilung, die approximativ normalverteilt ist. Je höher die Freiheitsgrade <span class="in">`df`</span> desto näher kommt die t-Verteilung einer Normalverteilung. Mit einem Freiheitsgrad von <span class="in">`df = 30`</span> sind wir sehr nah an einer Normalverteilung dran.</span>
<span id="cb83-423"><a href="#cb83-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-426"><a href="#cb83-426" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-427"><a href="#cb83-427" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">202209013</span>)</span>
<span id="cb83-428"><a href="#cb83-428" aria-hidden="true" tabindex="-1"></a>low_normal_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">A =</span> <span class="fu">rt</span>(<span class="dv">10</span>, <span class="at">df =</span> <span class="dv">30</span>),</span>
<span id="cb83-429"><a href="#cb83-429" aria-hidden="true" tabindex="-1"></a>                         <span class="at">B =</span> <span class="fu">rt</span>(<span class="dv">10</span>, <span class="at">df =</span> <span class="dv">30</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb83-430"><a href="#cb83-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(trt, rsp) <span class="sc">|&gt;</span> </span>
<span id="cb83-431"><a href="#cb83-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt =</span> <span class="fu">as_factor</span>(trt))</span>
<span id="cb83-432"><a href="#cb83-432" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-433"><a href="#cb83-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-434"><a href="#cb83-434" aria-hidden="true" tabindex="-1"></a>In @fig-normal-1 sehen wir auf der linken Seite den Dotplot der zehn Beobachtungen aus den beiden Gruppen $A$ und $B$. Wir sehen, dass die Verteilung für das Outcome <span class="in">`rsp`</span> in etwa normalverteilt ist.</span>
<span id="cb83-435"><a href="#cb83-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-438"><a href="#cb83-438" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-439"><a href="#cb83-439" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-440"><a href="#cb83-440" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb83-441"><a href="#cb83-441" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-normal-1</span></span>
<span id="cb83-442"><a href="#cb83-442" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb83-443"><a href="#cb83-443" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb83-444"><a href="#cb83-444" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb83-445"><a href="#cb83-445" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Verteilung des Outcomes `rsp` der zehn Beobachtungen aus den Gruppen $A$ und $B$. Beiden Gruppen kommen aus einer t-Verteilung."</span></span>
<span id="cb83-446"><a href="#cb83-446" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-subcap: </span></span>
<span id="cb83-447"><a href="#cb83-447" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Dotplot des Outcomes `rsp`."</span></span>
<span id="cb83-448"><a href="#cb83-448" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Densityplot des Outcomes `rsp`."</span></span>
<span id="cb83-449"><a href="#cb83-449" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-nrow: 1</span></span>
<span id="cb83-450"><a href="#cb83-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-451"><a href="#cb83-451" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(low_normal_tbl, <span class="fu">aes</span>(trt, rsp, <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb83-452"><a href="#cb83-452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb83-453"><a href="#cb83-453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binaxis =</span> <span class="st">"y"</span>, <span class="at">stackdir =</span> <span class="st">"center"</span>) <span class="sc">+</span></span>
<span id="cb83-454"><a href="#cb83-454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb83-455"><a href="#cb83-455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb83-456"><a href="#cb83-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-457"><a href="#cb83-457" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(low_normal_tbl, <span class="fu">aes</span>(rsp, <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb83-458"><a href="#cb83-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb83-459"><a href="#cb83-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb83-460"><a href="#cb83-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb83-461"><a href="#cb83-461" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb83-462"><a href="#cb83-462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb83-463"><a href="#cb83-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-464"><a href="#cb83-464" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-465"><a href="#cb83-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-466"><a href="#cb83-466" aria-hidden="true" tabindex="-1"></a>Wir können den Shapiro-Wilk-Test nutzen um statistisch zu testen, ob eine Abweichung von der Normalverteilung vorliegt. Wir erfahren aber nicht, welche *andere* Verteilung vorliegt. Wir testen natürlich für die beiden Gruppen getrennt. Die Funktion <span class="in">`shapiro.test()`</span>kann nur mit einem Vektor von Zahlen arbeiten, daher übergeben wir mit <span class="in">`pull`</span> die entsprechend gefilterten Werte des Outcomes <span class="in">`rsp`</span>.</span>
<span id="cb83-467"><a href="#cb83-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-470"><a href="#cb83-470" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-471"><a href="#cb83-471" aria-hidden="true" tabindex="-1"></a>low_normal_tbl <span class="sc">|&gt;</span> </span>
<span id="cb83-472"><a href="#cb83-472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trt <span class="sc">==</span> <span class="st">"A"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb83-473"><a href="#cb83-473" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(rsp) <span class="sc">|&gt;</span> </span>
<span id="cb83-474"><a href="#cb83-474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro.test</span>()</span>
<span id="cb83-475"><a href="#cb83-475" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-476"><a href="#cb83-476" aria-hidden="true" tabindex="-1"></a>low_normal_tbl <span class="sc">|&gt;</span> </span>
<span id="cb83-477"><a href="#cb83-477" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trt <span class="sc">==</span> <span class="st">"B"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb83-478"><a href="#cb83-478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(rsp) <span class="sc">|&gt;</span> </span>
<span id="cb83-479"><a href="#cb83-479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro.test</span>()</span>
<span id="cb83-480"><a href="#cb83-480" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-481"><a href="#cb83-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-482"><a href="#cb83-482" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass der $p$-Wert größer ist als das Signifikanzniveau $\alpha$ von 5% für beide Gruppen. Damit können wir die Nullhypothese nicht ablehnen. Wir nehmen eine Normalverteilung an.</span>
<span id="cb83-483"><a href="#cb83-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-484"><a href="#cb83-484" aria-hidden="true" tabindex="-1"></a>In dem folgendem Beispiel sehen wir dann aber, was ich mit in die Ecke testen meine bzw. so lange statistisch zu Testen bis nichts mehr geht.</span>
<span id="cb83-485"><a href="#cb83-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-486"><a href="#cb83-486" aria-hidden="true" tabindex="-1"></a><span class="fu">### Nicht normalverteilt, niedrige Fallzahl</span></span>
<span id="cb83-487"><a href="#cb83-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-488"><a href="#cb83-488" aria-hidden="true" tabindex="-1"></a>Schauen wir uns jetzt den anderen Fall an. Wir haben jetzt wieder eine niedrige Fallzahl mit je 10 Beobachtungen je Gruppe $A$ und $B$. In diesem Fall kommen die Beobachtungen aber aus einer exponentiellen Verteilung. Wir haben also definitiv keine Normalverteilung vorliegen. Wir generieren uns die Daten mit der Funktion <span class="in">`rexp()`</span>.</span>
<span id="cb83-489"><a href="#cb83-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-492"><a href="#cb83-492" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-493"><a href="#cb83-493" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">202209013</span>)</span>
<span id="cb83-494"><a href="#cb83-494" aria-hidden="true" tabindex="-1"></a>low_nonnormal_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">A =</span> <span class="fu">rexp</span>(<span class="dv">10</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">1500</span>),</span>
<span id="cb83-495"><a href="#cb83-495" aria-hidden="true" tabindex="-1"></a>                            <span class="at">B =</span> <span class="fu">rexp</span>(<span class="dv">10</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">1500</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb83-496"><a href="#cb83-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(trt, rsp) <span class="sc">|&gt;</span> </span>
<span id="cb83-497"><a href="#cb83-497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt =</span> <span class="fu">as_factor</span>(trt))</span>
<span id="cb83-498"><a href="#cb83-498" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-499"><a href="#cb83-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-500"><a href="#cb83-500" aria-hidden="true" tabindex="-1"></a>In @fig-normal-2 sehen wir auf der linken Seite den Dotplot der zehn Beobachtungen aus den beiden Gruppen $A$ und $B$. Wir sehen, dass die Verteilung für das Outcome für die Behandlung $B$ in etwa normalverteilt ist sowie das das Outcome für die Behandlung $A$ keiner Normalverteilung folgt *oder* zwei Ausreißer hat. Die Entscheidung was jetzt stimmt ohne zu wissen wie die Daten generiert wurden, ist in der Anwendung meist nicht möglich.</span>
<span id="cb83-501"><a href="#cb83-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-504"><a href="#cb83-504" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-505"><a href="#cb83-505" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-506"><a href="#cb83-506" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb83-507"><a href="#cb83-507" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb83-508"><a href="#cb83-508" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-normal-2</span></span>
<span id="cb83-509"><a href="#cb83-509" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb83-510"><a href="#cb83-510" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb83-511"><a href="#cb83-511" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb83-512"><a href="#cb83-512" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Verteilung des Outcomes `rsp` der zehn Beobachtungen aus den Gruppen $A$ und $B$. Beiden Gruppen kommen aus einer Exponentialverteilung."</span></span>
<span id="cb83-513"><a href="#cb83-513" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-subcap: </span></span>
<span id="cb83-514"><a href="#cb83-514" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Dotplot des Outcomes `rsp`."</span></span>
<span id="cb83-515"><a href="#cb83-515" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Densityplot des Outcomes `rsp`."</span></span>
<span id="cb83-516"><a href="#cb83-516" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-nrow: 1</span></span>
<span id="cb83-517"><a href="#cb83-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-518"><a href="#cb83-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-519"><a href="#cb83-519" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(low_nonnormal_tbl, <span class="fu">aes</span>(trt, rsp, <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb83-520"><a href="#cb83-520" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb83-521"><a href="#cb83-521" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binaxis =</span> <span class="st">"y"</span>, <span class="at">stackdir =</span> <span class="st">"center"</span>) <span class="sc">+</span></span>
<span id="cb83-522"><a href="#cb83-522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb83-523"><a href="#cb83-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb83-524"><a href="#cb83-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-525"><a href="#cb83-525" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(low_nonnormal_tbl, <span class="fu">aes</span>(rsp, <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb83-526"><a href="#cb83-526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb83-527"><a href="#cb83-527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb83-528"><a href="#cb83-528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb83-529"><a href="#cb83-529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">1500</span>, <span class="dv">4400</span>) <span class="sc">+</span></span>
<span id="cb83-530"><a href="#cb83-530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb83-531"><a href="#cb83-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-532"><a href="#cb83-532" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-533"><a href="#cb83-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-534"><a href="#cb83-534" aria-hidden="true" tabindex="-1"></a>Wir können wieder den Shapiro-Wilk-Test nutzen um statistisch zu testen, ob eine Abweichung von der Normalverteilung vorliegt. Wir erfahren aber nicht, welche *andere* Verteilung vorliegt. Wir testen natürlich für die beiden Gruppen getrennt.</span>
<span id="cb83-535"><a href="#cb83-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-538"><a href="#cb83-538" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-539"><a href="#cb83-539" aria-hidden="true" tabindex="-1"></a>low_nonnormal_tbl <span class="sc">|&gt;</span> </span>
<span id="cb83-540"><a href="#cb83-540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trt <span class="sc">==</span> <span class="st">"A"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb83-541"><a href="#cb83-541" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(rsp) <span class="sc">|&gt;</span> </span>
<span id="cb83-542"><a href="#cb83-542" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro.test</span>()</span>
<span id="cb83-543"><a href="#cb83-543" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-544"><a href="#cb83-544" aria-hidden="true" tabindex="-1"></a>low_nonnormal_tbl <span class="sc">|&gt;</span> </span>
<span id="cb83-545"><a href="#cb83-545" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trt <span class="sc">==</span> <span class="st">"B"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb83-546"><a href="#cb83-546" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(rsp) <span class="sc">|&gt;</span> </span>
<span id="cb83-547"><a href="#cb83-547" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro.test</span>()</span>
<span id="cb83-548"><a href="#cb83-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-549"><a href="#cb83-549" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-550"><a href="#cb83-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-551"><a href="#cb83-551" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass der $p$-Wert für die Behandlung $A$ kleiner ist als das Signifikanzniveau $\alpha$ von 5%. Damit können wir die Nullhypothese ablehnen. Wir nehmen keine Normalverteilung für Gruppe $A$ an. Auf der anderen Seite sehen wir, dass der $p$-Wert für die Behandlung $B$ größer ist als das Signifikanzniveau $\alpha$ von 5%. Damit können wir die Nullhypothese nicht ablehnen. Wir nehmen eine Normalverteilung für Gruppe $A$ an.</span>
<span id="cb83-552"><a href="#cb83-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-553"><a href="#cb83-553" aria-hidden="true" tabindex="-1"></a>Super, jetzt haben wir für die eine Gruppe eine Normalverteilung und für die andere nicht. Wir haben uns in die Ecke getestet. Wir können jetzt verschiedene Szenarien vorliegen haben.</span>
<span id="cb83-554"><a href="#cb83-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-555"><a href="#cb83-555" aria-hidden="true" tabindex="-1"></a>1)  Wir könnten in der Gruppe $A$ zwei Ausreißer vorliegen haben.</span>
<span id="cb83-556"><a href="#cb83-556" aria-hidden="true" tabindex="-1"></a>2)  Wir könnten in der Gruppe $B$ zufällig eine Normalverteilung beobachtet haben.</span>
<span id="cb83-557"><a href="#cb83-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-558"><a href="#cb83-558" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Und nochmal zum Schluß, einem statistischen Test mit 4 bis 5 Wiederholungen in einer Gruppe zu glauben, ob eine Normalverteilung vorliegt, kannst du auch würfeln...</span><span class="co">]</span>{.aside}</span>
<span id="cb83-559"><a href="#cb83-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-560"><a href="#cb83-560" aria-hidden="true" tabindex="-1"></a>Leider wissen wir im echten Leben nicht, aus welcher Verteilung unsere Daten stammen, wir können aber *annehmen*, dass die Daten einer Normalverteilung folgen oder aber die Daten so transformieren, dass die Daten einer approximativen Normalverteilung folgen. Siehe dazu auch das @sec-eda-transform zur Transformation von Daten.</span>
<span id="cb83-561"><a href="#cb83-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-562"><a href="#cb83-562" aria-hidden="true" tabindex="-1"></a>Wenn deine Daten *keiner* Normalverteilung folgen, dann kann es sein, dass du mit den Effektschätzern ein Problem bekommst. Du erfährst vielleicht, dass du die Nullhypothese ablehnen kannst, aber nicht wie stark der Effekt in der Einheit des gemessenen Outcomes ist.</span>
<span id="cb83-563"><a href="#cb83-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-564"><a href="#cb83-564" aria-hidden="true" tabindex="-1"></a><span class="fu">### Testen der Normalverteilungsannahme in mehreren Gruppen</span></span>
<span id="cb83-565"><a href="#cb83-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-566"><a href="#cb83-566" aria-hidden="true" tabindex="-1"></a>Im folgenden Beispiel zu den Keimungsraten von verschiedenen Nelkensorten wollen wir einmal testen, ob jede Sorte einer Normalverteilung folgt. Da wir hier insgesamt 20 Sorten vorliegen haben, nutzen wir die Funktion <span class="in">`map()`</span> aus dem R Paket <span class="in">`{purrr}`</span> um hier schneller voranzukommen. Wie immer laden wir erst die Daten und mutieren die Spalten in dem Sinne wie wir die Spalten brauchen.</span>
<span id="cb83-567"><a href="#cb83-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-570"><a href="#cb83-570" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-571"><a href="#cb83-571" aria-hidden="true" tabindex="-1"></a>clove_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/clove_germ_rate.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb83-572"><a href="#cb83-572" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">clove_strain =</span> <span class="fu">as_factor</span>(clove_strain),</span>
<span id="cb83-573"><a href="#cb83-573" aria-hidden="true" tabindex="-1"></a>         <span class="at">germ_rate =</span> <span class="fu">as.numeric</span>(germ_rate))</span>
<span id="cb83-574"><a href="#cb83-574" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-575"><a href="#cb83-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-576"><a href="#cb83-576" aria-hidden="true" tabindex="-1"></a>Jetzt können wir die Daten nach der Sorte der Nelken in eine Liste mit der Funktion <span class="in">`split()`</span> aufspalten und dann auf jedem Listeneintrag einen Shapiro-Wilk-Test rechnen. Dann machen wir uns noch die Ausgabe schöner und erschaffen uns eine <span class="in">`decision`</span>-Spalte in der wir gleich das Ergebnis für oder gegen die Normalverteilung ablesen können.</span>
<span id="cb83-577"><a href="#cb83-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-580"><a href="#cb83-580" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-581"><a href="#cb83-581" aria-hidden="true" tabindex="-1"></a>clove_tbl <span class="sc">|&gt;</span> </span>
<span id="cb83-582"><a href="#cb83-582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(<span class="sc">~</span>clove_strain) <span class="sc">|&gt;</span> </span>
<span id="cb83-583"><a href="#cb83-583" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span><span class="fu">shapiro.test</span>(.x<span class="sc">$</span>germ_rate)) <span class="sc">|&gt;</span> </span>
<span id="cb83-584"><a href="#cb83-584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(tidy) <span class="sc">|&gt;</span> </span>
<span id="cb83-585"><a href="#cb83-585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="at">.id =</span> <span class="st">"test"</span>) <span class="sc">|&gt;</span></span>
<span id="cb83-586"><a href="#cb83-586" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(test, p.value) <span class="sc">|&gt;</span> </span>
<span id="cb83-587"><a href="#cb83-587" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">decision =</span> <span class="fu">ifelse</span>(p.value <span class="sc">&lt;=</span> <span class="fl">0.05</span>, <span class="st">"reject normal"</span>, <span class="st">"normal"</span>),</span>
<span id="cb83-588"><a href="#cb83-588" aria-hidden="true" tabindex="-1"></a>         <span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value, <span class="at">accuracy =</span> <span class="fl">0.001</span>))</span>
<span id="cb83-589"><a href="#cb83-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-590"><a href="#cb83-590" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-591"><a href="#cb83-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-592"><a href="#cb83-592" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visuelle Überprüfung</span></span>
<span id="cb83-593"><a href="#cb83-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-594"><a href="#cb83-594" aria-hidden="true" tabindex="-1"></a>Abschließend möchte ich hier nochmal das <span class="co">[</span><span class="ot">R Paket `{performance}`</span><span class="co">](https://easystats.github.io/performance/)</span> vorstellen. Wir können mit dem Paket auch die Normalverteilungsannahme der Residuen überprüfen sowie die Annahme der Homogenität der Varianzen. Das geht ganz einfach mit der Funktion <span class="in">`check_model()`</span> in die wir einfach das Objekt mit dem Fit des Modells übergeben.</span>
<span id="cb83-595"><a href="#cb83-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-598"><a href="#cb83-598" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-599"><a href="#cb83-599" aria-hidden="true" tabindex="-1"></a>lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(germ_rate <span class="sc">~</span> clove_strain, clove_tbl)</span>
<span id="cb83-600"><a href="#cb83-600" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-601"><a href="#cb83-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-602"><a href="#cb83-602" aria-hidden="true" tabindex="-1"></a>Tja und schon haben wir in der @fig-pretest-check-model mehr als wir eigentlich wollen. Aber du siehst hier ganz gut, dass wir in diesen Daten Probleme mit der Varianzhomogenität haben. Die Linie in dem Subplot "Homogeneity of Variance" ist nicht flach und horizontal. Deshalb könnten wir die Daten einmal Transformieren oder aber mit der Varianzheterogenität modellieren. Das Modellieren machen wir gleich mal im Anschluss.</span>
<span id="cb83-603"><a href="#cb83-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-606"><a href="#cb83-606" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-607"><a href="#cb83-607" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb83-608"><a href="#cb83-608" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-609"><a href="#cb83-609" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pretest-check-model</span></span>
<span id="cb83-610"><a href="#cb83-610" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb83-611"><a href="#cb83-611" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb83-612"><a href="#cb83-612" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb83-613"><a href="#cb83-613" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Übersicht der Plots zu der Modellgüte aus der Funktion `check_model()` nach der Modellierung mit der Funktion `lm()` und der Annahme der Varianzhomogenität."</span></span>
<span id="cb83-614"><a href="#cb83-614" aria-hidden="true" tabindex="-1"></a>lm_fit <span class="sc">|&gt;</span> <span class="fu">check_model</span>(<span class="at">check =</span> <span class="fu">c</span>(<span class="st">"normality"</span>, <span class="st">"linearity"</span>, <span class="st">"homogeneity"</span>, <span class="st">"qq"</span>))</span>
<span id="cb83-615"><a href="#cb83-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-616"><a href="#cb83-616" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-617"><a href="#cb83-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-618"><a href="#cb83-618" aria-hidden="true" tabindex="-1"></a>Jetzt modellieren wir einmal die Effekte der <span class="in">`clove_strain`</span> unter der Annahme der Varianzheterogenität. Die Funktion <span class="in">`gls()`</span> aus dem R Paket <span class="in">`{nlme}`</span> passt ein lineares Modell unter Verwendung der verallgemeinerten kleinsten Quadrate an. Die Fehler dürfen dabei aber korreliert oder aber ungleiche Varianzen haben. Damit haben wir ein Modell, was wir nutzen können, wenn wir Varianzheterogenität vorliegen haben.</span>
<span id="cb83-619"><a href="#cb83-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-622"><a href="#cb83-622" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-623"><a href="#cb83-623" aria-hidden="true" tabindex="-1"></a>gls_fit <span class="ot">&lt;-</span> <span class="fu">gls</span>(germ_rate <span class="sc">~</span> clove_strain, </span>
<span id="cb83-624"><a href="#cb83-624" aria-hidden="true" tabindex="-1"></a>               <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> clove_strain), </span>
<span id="cb83-625"><a href="#cb83-625" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> clove_tbl)</span>
<span id="cb83-626"><a href="#cb83-626" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-627"><a href="#cb83-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-628"><a href="#cb83-628" aria-hidden="true" tabindex="-1"></a>Wir gehen hier nicht tiefer auf die Funktion ein. Wir müssen nur die <span class="in">`weights`</span> so angeben, dass die <span class="in">`weights`</span> die verschiedenen Gruppen in dem Faktor <span class="in">`clove_strain`</span> berücksichtigen können. Dann haben wir schon das Modell für die Varianzheterogenität. Mehr musst du dann auch nicht machen, dass ist dann manchmal das schöne in R, dass wir dann auch immer wieder auf gewohnte Templates zurückgreifen können.</span>
<span id="cb83-629"><a href="#cb83-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-630"><a href="#cb83-630" aria-hidden="true" tabindex="-1"></a>In der @fig-pretest-check-model-gls sehen wir das Ergebnis der Modellanpassung. Sieht gut aus, jedenfalls besser als mit dem <span class="in">`lm()`</span>. Besonders schön sehen wir, dass wir dann auch wieder normalverteilte Residuen vorliegen haben. Damit ist eine wichtige Annahme an das Modell erfüllt. Das wäre jetzt ein gutes Modell um im Anschluss <span class="in">`emmeans()`</span> zu nutzen. Da gehst du dann aber bitte in das <span class="co">[</span><span class="ot">Kapitel zu den Posthoc Tests</span><span class="co">](#sec-posthoc)</span>.</span>
<span id="cb83-631"><a href="#cb83-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-634"><a href="#cb83-634" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-635"><a href="#cb83-635" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb83-636"><a href="#cb83-636" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-637"><a href="#cb83-637" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pretest-check-model-gls</span></span>
<span id="cb83-638"><a href="#cb83-638" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb83-639"><a href="#cb83-639" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb83-640"><a href="#cb83-640" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb83-641"><a href="#cb83-641" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Übersicht der Plots zu der Modellgüte aus der Funktion `check_model()` nach der Modellierung mit der Funktion `gls()` und der Annahme der Varianzheterogenität über die Gruppen von `clove_strain`."</span></span>
<span id="cb83-642"><a href="#cb83-642" aria-hidden="true" tabindex="-1"></a>gls_fit <span class="sc">|&gt;</span> <span class="fu">check_model</span>(<span class="at">check =</span> <span class="fu">c</span>(<span class="st">"normality"</span>, <span class="st">"linearity"</span>, <span class="st">"qq"</span>))</span>
<span id="cb83-643"><a href="#cb83-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-644"><a href="#cb83-644" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-645"><a href="#cb83-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-646"><a href="#cb83-646" aria-hidden="true" tabindex="-1"></a><span class="fu">## Referenzen {.unnumbered}</span></span>
</code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Bio Data Science wurde von <a href="https://www.hs-osnabrueck.de/prof-dr-jochen-kruppa/">Jochen Kruppa-Scheetz</a> geschrieben.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-tests-pretest.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-tests-pretest.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Dieses Openbook wurde mit <a href="https://quarto.org/">Quarto</a> erstellt.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"openEffect":"zoom","descPosition":"bottom","selector":".lightbox","closeEffect":"zoom","loop":false});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>




</body></html>
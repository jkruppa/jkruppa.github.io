<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Ein Kochbuch mit Rezepten aus der Bio Data Science, Biostatistik, Biometrie und Statistik zum selber nachkochen!">

<title>56&nbsp; Beta Regression – Bio Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./stat-modeling-multinom.html" rel="next">
<link href="./stat-modeling-poisson.html" rel="prev">
<link href="./cover2024_favi.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-05fe91a66cf75bbbb8c9664867fe5124.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-05a8b96638736df272eeeeef67138371.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="56&nbsp; Beta Regression – Bio Data Science">
<meta property="og:description" content="Ein Kochbuch mit Rezepten der Bio Data Science, Biostatistik, Biometrie und Statistik">
<meta property="og:image" content="https://github.com/jkruppa/jkruppa.github.io/raw/master/cover2024.png">
<meta property="og:site_name" content="Bio Data Science">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-modeling-preface.html">Statistisches Modellieren</a></li><li class="breadcrumb-item"><a href="./stat-modeling-beta.html"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Beta Regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bio Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jkruppa/jkruppa.github.io/" title="Quellcode" class="quarto-navigation-tool px-1" aria-label="Quellcode"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Willkommen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bibliothek</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./forschungsprozess.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forschungsprozess</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abschlussarbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Abschlussarbeit</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./example-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datenbeispiele</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-database.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Von Datenbanken</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programmieren in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Daten in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Daten einlesen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Reguläre Ausdrücke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-purrr-furrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Ein <code>{purrr}</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Ein <code>{ggplot}</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-quarto-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Quarto und Shiny App</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorative Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Testen von Hypothesen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelle Designs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Versuchsplanung in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Einfache Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Fortgeschrittene Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-app.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistische Gruppenvergleiche</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Testen in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Der t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Die repeated / mixed ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-manova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Die MANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Der U-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Der Friedman Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Der Chi-Quadrat-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anteil-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Der Anteilstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-trendtest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Der Trendtest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-permutationstest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Der Permutationstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Der Post-hoc Test</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grundlagen des Modellierens</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Modelgüte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Korrelation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Ausreißer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Variablenselektion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Fehlende Werte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistisches Modellieren</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Modellieren in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-marginal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Marginal effect models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-beta.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Beta Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-prob-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-robust-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Überlebenszeitanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-noninferiority.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Äquivalenz oder Nichtunterlegenheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Metaanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Fragebogenanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./time-space-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zeitliche und räumliche Analysen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-pseudo-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Pseudo Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Räumliche Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Klassifikation oder maschinelles Lernen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-pre-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Data preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title">Support vector machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">80</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./abspann.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abspann</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-spielecke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">Spielecke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./construction-zone.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">82</span>&nbsp; <span class="chapter-title">Baustelle</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#genutzte-r-pakete" id="toc-genutzte-r-pakete" class="nav-link active" data-scroll-target="#genutzte-r-pakete"><span class="header-section-number">56.1</span> Genutzte R Pakete</a></li>
  <li><a href="#daten" id="toc-daten" class="nav-link" data-scroll-target="#daten"><span class="header-section-number">56.2</span> Daten</a></li>
  <li><a href="#visualisierung" id="toc-visualisierung" class="nav-link" data-scroll-target="#visualisierung"><span class="header-section-number">56.3</span> Visualisierung</a></li>
  <li><a href="#fit-des-modells" id="toc-fit-des-modells" class="nav-link" data-scroll-target="#fit-des-modells"><span class="header-section-number">56.4</span> Fit des Modells</a>
  <ul class="collapse">
  <li><a href="#mit-der-gaussian-regression" id="toc-mit-der-gaussian-regression" class="nav-link" data-scroll-target="#mit-der-gaussian-regression"><span class="header-section-number">56.4.1</span> … mit der Gaussian Regression</a></li>
  <li><a href="#mit-einer-logistischen-regression" id="toc-mit-einer-logistischen-regression" class="nav-link" data-scroll-target="#mit-einer-logistischen-regression"><span class="header-section-number">56.4.2</span> … mit einer logistischen Regression</a></li>
  <li><a href="#mit-dem-r-paket-betareg" id="toc-mit-dem-r-paket-betareg" class="nav-link" data-scroll-target="#mit-dem-r-paket-betareg"><span class="header-section-number">56.4.3</span> … mit dem R Paket <code>{betareg}</code></a></li>
  </ul></li>
  <li><a href="#sec-mult-comp-beta-reg" id="toc-sec-mult-comp-beta-reg" class="nav-link" data-scroll-target="#sec-mult-comp-beta-reg"><span class="header-section-number">56.5</span> Gruppenvergleich</a>
  <ul class="collapse">
  <li><a href="#untergewichtige-brokkoli" id="toc-untergewichtige-brokkoli" class="nav-link" data-scroll-target="#untergewichtige-brokkoli"><span class="header-section-number">56.5.1</span> Untergewichtige Brokkoli</a></li>
  <li><a href="#pilze-auf-weizen" id="toc-pilze-auf-weizen" class="nav-link" data-scroll-target="#pilze-auf-weizen"><span class="header-section-number">56.5.2</span> Pilze auf Weizen</a></li>
  </ul></li>
  <li><a href="#referenzen" id="toc-referenzen" class="nav-link" data-scroll-target="#referenzen">Referenzen</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-modeling-beta.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-modeling-beta.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-modeling-preface.html">Statistisches Modellieren</a></li><li class="breadcrumb-item"><a href="./stat-modeling-beta.html"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Beta Regression</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-beta" class="quarto-section-identifier"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Beta Regression</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code zeigen</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code verbergen</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Quellcode anzeigen</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><em>Letzte Änderung am 25. March 2024 um 08:35:21</em></p>
<p>Die Beta Regression. Zuerst ein seltsamer Name, was heißt denn jetzt hier Beta? Und was macht die beta Regression eigentlich? Die Beta Regression beschäftigt sich mit einem prozentualen Outcome und damit mit einem Outcome <span class="math inline">\(y\)</span> welches zwischen 0 und 1 liegt. Dabei ist das <em>Zwischen</em> sehr wichtig. Weder dürfen einzelne Beobachtungen einen Wert von 1 haben noch einen Wert von 0. Dabei ist die Null weit schlimmer, so dass wir hier gerne einen kleinen Betrag auf alle 0 addieren um dann aus dem Schneider zu sein. Sonst ist unser Outcome dadurch gekennzeichnet, dass wir meistens die Wahrscheinlichkeit oder Anteil für ein Ereignis abgebildet haben. Wie oft tritt eine Klauensuche in einem Stall auf? Welchen Anteil machen faulige Erdbeeren aus? Und um auf die Frage vom Anfang zurückzukommen, ein prozentuales Outcome folgt einer Betaverteilung. Deshalb nutzen wir eine Beta Regression um prozentuale Outcomes auszuwerten.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Moment, ich möchte aber nur zwei Wahrscheinlichkeiten <span class="math inline">\(p_1\)</span> und <span class="math inline">\(p_2\)</span> vergleichen!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wenn du nur wissen willst, ob sich zwei Wahrscheinlichkeiten unterscheiden, dann musst du einmal in dem Kapitel <a href="stat-tests-anteil-test.html#sec-chisquare-prop-test">Vergleich zweier Anteile <span class="math inline">\(p_1\)</span> und <span class="math inline">\(p_2\)</span></a> nachschauen. Dort zeige ich dir wie du dann einen statistischen Test rechnen kannst um rauszufinden ob sich <span class="math inline">\(0.5\)</span> signifikant von <span class="math inline">\(0.7\)</span> unterscheidet. In diesem Kapitel schauen wir uns dann pro Faktor sehr viele Wahrscheinlichkeiten als Outcome an.</p>
</div>
</div>
<p>Teilweise sind diese Arten von Daten, die einer Betaverteilung folgen, eher selten in den Agrawissenschaften. Wir müssen nämlich sehr viele Daten generieren um Prozente zu berechnen. Prozente sind ja immer Anteile an irgendwas. Und so müssen wir dann eine Menge Tiere oder Pflanzen zählen, damit wir auch wirklich eine gute Auflösung kriegen. Wenn du zum Beispiel eine Auflösung von 1% erhalten willst, dann musst du auch einhundert Tiere untersuchen und dann bestimmen wie groß der Anteil an deinem untersuchten Outcome ist. So kann es dann passieren, dass sehr viele Untersuchungen in einer einzigen Zahl förmlich verschwinden. Deshalb werden dann häufig die Anzahlen direkt als Poisson Regression ausgewertet. Aber wie immer gilt, selten ist nicht nie. Deshalb einmal hier die Beta Regression für ein prozentuales Outcome.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Weitere Tutorien für die Beta Regression
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wie immer gibt es auch für die Frage nach dem Tutorium für die Beta Regression verschiedene Quellen. Ich kann noch folgende Informationen und Hilfen empfehlen.</p>
<ul>
<li><a href="https://www.andrewheiss.com/blog/2021/11/08/beta-regression-guide">A guide to modeling proportions with Bayesian beta and zero-inflated beta regression models</a> hilft besonders, wenn du tiefer in die Matrie einsteigen willst. Du erhälst bei dem Tutorium einen vollständigen Überblick über die Möglichkeiten. Weit mehr als ich hier mache.</li>
<li>Das Tutorium <a href="https://rcompanion.org/handbook/J_02.html">Beta Regression for Percent and Proportion Data</a> leidet etwas unter dem Mangel an erklärenden Text. Hier wurde anscheinend erst der R Code generiert und der Text sollte folgen. Das schneit hier aber (noch) nicht der Fall zu sein. Als Überblick lohnt sich das Tutorium aber dennoch.</li>
<li><a href="https://stats.stackexchange.com/questions/47771/what-is-the-intuition-behind-beta-distribution">What is the intuition behind beta distribution?</a> erklärt nochmal was die Idee der Beta Regression eigentlich ist und was eine Betaverteilung eigentlich beschreibt.</li>
<li>Das R Paket <code>{betareg}</code> und die entsprechende Vignette <a href="https://cran.r-project.org/web/packages/betareg/vignettes/betareg.pdf">Beta Regression in R</a> liefert wichtige Informationen über die Umsetzung der Beta Regression in R.</li>
<li><a href="https://solomonkurz.netlify.app/blog/2023-06-25-causal-inference-with-beta-regression/">Causal inference with beta regression</a> liefert eine sehr umfangreiche Überbick über die Beta Regression und das Testen mit der ANOVA. Dann aber auch nicht in dem klassischen Ansatz, den ich hier normalerweise rechne, sondern als bayesianische Variante.</li>
<li>Genauso betrachtet das Tutorium <a href="https://m-clark.github.io/models-by-example/bayesian-beta-regression.html">Model Estimation by Example - Bayesian Beta Regression</a> auch die bayesianische Variante der Beta Regression, so dass du hier vermutlich eher weniger fündig wirst. Ich fand den Überblick aber gut und schön zu lesen – vorallem war er auch nicht so lang.</li>
</ul>
</div>
</div>
<section id="genutzte-r-pakete" class="level2" data-number="56.1">
<h2 data-number="56.1" class="anchored" data-anchor-id="genutzte-r-pakete"><span class="header-section-number">56.1</span> Genutzte R Pakete</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, magrittr, broom, betareg, car,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               see, performance, parameters, agridat, mfp,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               emmeans, multcomp, rcompanion, ggbeeswarm,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               marginaleffects, nls.multstart, conflicted)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>summarise)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>select)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>filter)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>cb_pal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#000000"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>, </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>An der Seite des Kapitels findest du den Link <em>Quellcode anzeigen</em>, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</p>
</section>
<section id="daten" class="level2" data-number="56.2">
<h2 data-number="56.2" class="anchored" data-anchor-id="daten"><span class="header-section-number">56.2</span> Daten</h2>
<p>Wie immer schauen wir uns verschiedene Datensätze an, Visualisieren die Zusammenhänge und rechnen dann verschiedene Modelle, die passen könnten. Beginnen möchte ich mit einem Datensatz zu dem Jagederfolg in [%] von Schneefüchsen in verschiedenen Habitaten. Die Daten sind etwas gekürzt, wir haben nur den Jagederfolg und keine Informationen zu den Habitaten. Des Weiteren wollen wir schauen, ob der Jagderfolg der Eisfüche von der standardisierten Schneehöhe in [cm] abhängt. Wir haben hier mehr oder minder die Schneehöhe in dem Habit gemittelt. Der Eisfuchs jagt ja nicht immer an der perfekt gleichen Stelle, wo wir die Schneehöhe kennen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>hunting_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/hunting_fox.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proportion =</span> <span class="fu">round</span>(success<span class="sc">/</span>attempts, <span class="dv">2</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der <a href="#tbl-beta-fox" class="quarto-xref">Tabelle&nbsp;<span>56.1</span></a> siehst du einen Auszug aus den Daten. Wir haben die Schneehöhe gemessen und geschaut von wie vielen Anläufen <code>attempts</code> eine Maus unter dem Schnee zu fangen erfolgreich war <code>success</code> oder eben ein Fehlschlag <code>fail</code>. Daraud haben wir dann die Erfolgsrate <code>proportion</code> berechnet. Wir haben einfach den Anteil der Erfolge eine Maus zu fangen an den gesamten Versuchen berechnet.</p>
<div class="cell">
<div id="tbl-beta-fox" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-beta-fox-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;56.1— Auszug aus den Daten zu dem Jagderfolg in [%] von Eisfüchsen in abhängigkeit von der Schneehöhe in [cm].
</figcaption>
<div aria-describedby="tbl-beta-fox-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">snow_height</th>
<th style="text-align: center;">attempts</th>
<th style="text-align: center;">success</th>
<th style="text-align: center;">fail</th>
<th style="text-align: center;">proportion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">30</td>
<td style="text-align: center;">18</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">0.89</td>
</tr>
<tr class="even">
<td style="text-align: center;">33</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">0.75</td>
</tr>
<tr class="odd">
<td style="text-align: center;">39</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">18</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">0.9</td>
</tr>
<tr class="even">
<td style="text-align: center;">55</td>
<td style="text-align: center;">24</td>
<td style="text-align: center;">18</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">0.75</td>
</tr>
<tr class="odd">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="even">
<td style="text-align: center;">65</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">0.45</td>
</tr>
<tr class="odd">
<td style="text-align: center;">63</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">0.12</td>
</tr>
<tr class="even">
<td style="text-align: center;">70</td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">0.07</td>
</tr>
<tr class="odd">
<td style="text-align: center;">18</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0.95</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Im Weiteren schauen wir uns einen Datensatz zu Brokkoli an. Wir wollen hier einmal schauen, ob wir das Zielgewicht von <span class="math inline">\(500g\)</span> erreichen. Wir sind aber daran interessiert die Rate von untergewichtigen Brokkoli möglichst klein zu halten. Deshalb schauen wir uns in dieser Auswertung den Anteil von Brokkoli unter der Zielmarke von <span class="math inline">\(500g\)</span> für zwei Düngezeitpunkte sowie drei Düngestufen an. Wir müssen hier jetzt die Daten etwas mehr aufbereiten, da wir mehr Informationen in den Daten haben als wir wirklich brauchen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>broc_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/broccoli_weight.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fert_time <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"early"</span>, <span class="st">"late"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fert_time =</span> <span class="fu">factor</span>(fert_time, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"early"</span>, <span class="st">"late"</span>)),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">fert_amount =</span> <span class="fu">as_factor</span>(fert_amount),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">block =</span> <span class="fu">as_factor</span>(block)) <span class="sc">|&gt;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(fert_time, fert_amount, block, weight) <span class="sc">|&gt;</span> </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(weight <span class="sc">&lt;</span> <span class="dv">500</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proportion =</span> weight<span class="sc">/</span><span class="dv">500</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>weight)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der <a href="#tbl-beta-broc" class="quarto-xref">Tabelle&nbsp;<span>56.2</span></a> siehst du einmal den Auszug aus den Brokkolidaten. Wir wollen jetzt sehen, ob wir in den Behandlungsfaktoren einen Unterschied bezüglich der Anteile der untergewichtigen Brokkoliköpfe finden. Tendenziell wollen wir eine Kombination finden, die uns natürlich möglichst schwere Köpfe beschert.</p>
<div class="cell">
<div id="tbl-beta-broc" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-beta-broc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;56.2— Auszug aus dem Daten zu den Zielgewichten von Brokkoli zu zwei Düngezeitpunkten und drei Düngestufen.
</figcaption>
<div aria-describedby="tbl-beta-broc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">fert_time</th>
<th style="text-align: center;">fert_amount</th>
<th style="text-align: center;">block</th>
<th style="text-align: center;">proportion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">early</td>
<td style="text-align: center;">150</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0.82586</td>
</tr>
<tr class="even">
<td style="text-align: center;">early</td>
<td style="text-align: center;">150</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0.55294</td>
</tr>
<tr class="odd">
<td style="text-align: center;">early</td>
<td style="text-align: center;">150</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0.98314</td>
</tr>
<tr class="even">
<td style="text-align: center;">early</td>
<td style="text-align: center;">150</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0.68964</td>
</tr>
<tr class="odd">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="even">
<td style="text-align: center;">early</td>
<td style="text-align: center;">225</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">0.43816</td>
</tr>
<tr class="odd">
<td style="text-align: center;">early</td>
<td style="text-align: center;">225</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">0.86136</td>
</tr>
<tr class="even">
<td style="text-align: center;">early</td>
<td style="text-align: center;">225</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">0.547</td>
</tr>
<tr class="odd">
<td style="text-align: center;">early</td>
<td style="text-align: center;">225</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">0.80844</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Abschließend schauen wir nochmal in das R Paket <code>{agridat}</code> und nehmen von dort den Datensatz <code>salmon.bunt</code> welcher eine Pilzinfektion von Weizenlinien beschreibt. Mehr dazu dann auf der Hilfeseite <a href="https://kwstat.github.io/agridat/reference/salmon.bunt.html">Fungus infection in varieties of wheat</a> in der Vignette zum R Paket. Ich möchte später die Faktoren <code>gen</code> für die genetischen Linien und die Pilzarten <code>bunt</code> für die Anteile der Pilzinfektionen sortiert haben. Das mache ich dann einmal mit der Funktion <code>fct_reorder()</code> welche mir erlaubt einen Faktor nach einer anderen Variable zu sortieren. Wir haben zwei Wiederholungen <code>rep</code>, die auch so nicht helfen. Deshalb mittlere ich mit <code>summarise()</code> über die beiden Wiederholungen die Prozente der Pilzinfektionen des Weizen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(salmon.bunt)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>fungi_tbl <span class="ot">&lt;-</span> salmon.bunt <span class="sc">|&gt;</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gen, bunt, rep, <span class="at">percent =</span> pct) <span class="sc">|&gt;</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gen =</span> <span class="fu">fct_reorder</span>(gen, percent),</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">bunt =</span> <span class="fu">fct_reorder</span>(bunt, percent),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">percent =</span> percent<span class="sc">/</span><span class="dv">100</span> <span class="sc">+</span> <span class="fl">0.001</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der <a href="#tbl-beta-fungi" class="quarto-xref">Tabelle&nbsp;<span>56.3</span></a> siehst du dann einmal den Auszug aus unseren Weizendaten mit einer Pilzinfektion. Wir haben 10 genetische Linien sowie 20 Pilzarten vorliegen. Daher ist der Datensatz ziemlich groß, was die Möglichkeiten der Faktorkombinationen angeht.</p>
<div class="cell">
<div id="tbl-beta-fungi" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-beta-fungi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;56.3— Auszug aus dem Daten zu den zehn Weizenlinien und den zwanzig Pilzarten. Es wurde der Anteil an infizierten Weizen [%] gemessen.
</figcaption>
<div aria-describedby="tbl-beta-fungi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">gen</th>
<th style="text-align: center;">bunt</th>
<th style="text-align: center;">rep</th>
<th style="text-align: center;">percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Hybrid128</td>
<td style="text-align: center;">B1</td>
<td style="text-align: center;">R1</td>
<td style="text-align: center;">0.867</td>
</tr>
<tr class="even">
<td style="text-align: center;">Hybrid128</td>
<td style="text-align: center;">B2</td>
<td style="text-align: center;">R1</td>
<td style="text-align: center;">0.765</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Hybrid128</td>
<td style="text-align: center;">B3</td>
<td style="text-align: center;">R1</td>
<td style="text-align: center;">0.95</td>
</tr>
<tr class="even">
<td style="text-align: center;">Hybrid128</td>
<td style="text-align: center;">B4</td>
<td style="text-align: center;">R1</td>
<td style="text-align: center;">0.911</td>
</tr>
<tr class="odd">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="even">
<td style="text-align: center;">Hussar</td>
<td style="text-align: center;">B32</td>
<td style="text-align: center;">R2</td>
<td style="text-align: center;">0.034</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Hussar</td>
<td style="text-align: center;">B51</td>
<td style="text-align: center;">R2</td>
<td style="text-align: center;">0.001</td>
</tr>
<tr class="even">
<td style="text-align: center;">Hussar</td>
<td style="text-align: center;">B157</td>
<td style="text-align: center;">R2</td>
<td style="text-align: center;">0.377</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Hussar</td>
<td style="text-align: center;">B189</td>
<td style="text-align: center;">R2</td>
<td style="text-align: center;">0.703</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Damit habe wir dann einige spannende Datensätze vorliegen, die wir nutzen können um die verschiedenen Aspekte der Beta Regression anzuschauen. Nicht immer muss es ja eine Beta Regression sein, wir haben auch die Möglichkeit unsere Fragestellung mit anderen Modellen eventuell anders oder gar besser zu beantworten.</p>
</section>
<section id="visualisierung" class="level2" data-number="56.3">
<h2 data-number="56.3" class="anchored" data-anchor-id="visualisierung"><span class="header-section-number">56.3</span> Visualisierung</h2>
<p>Auch hier beginnen wir einmal mit der Visualisierung der Daten. Zuerst schauen wir uns einmal die Daten zu dem Jagderfolg der Eisfüchse in verschiedenen Habitaten in Abhängigkeit zu der Schneehöhe an. Wenn der Schnee zu hoch liegt, werden die Füchse weniger Jagderfolg haben. In der <a href="#fig-beta-fox-scatter" class="quarto-xref">Abbildung&nbsp;<span>56.1</span></a> sehen wir einmal den Jagerfolg von der Schneehöhe aufgetragen. Wir erkennen, dass wir zwar anfänglich eher einen linearen Zusammenhang haben könnten, aber bei höheren Schneedichten dann sehr schnell einen Abfall des Jagderfolges beobachten. Wir schauen uns dann gleich mal verschiedene Modelle an um eine Kurve durch die Punkte zu legen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>hunting_tbl <span class="sc">|&gt;</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(snow_height, proportion)) <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Jagderfolg [%]"</span>, <span class="at">x =</span> <span class="st">"Standardisierte Schneehöhe [cm]"</span>) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-beta-fox-scatter" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-beta-fox-scatter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-beta_files/figure-html/fig-beta-fox-scatter-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Abbildung&nbsp;56.1— Zusammenhang zwischen dem Jagederfolg von Eisfüchsen und der Schneehöhe in den jeweiligen beobachteten Habitaten."><img src="stat-modeling-beta_files/figure-html/fig-beta-fox-scatter-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-beta-fox-scatter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;56.1— Zusammenhang zwischen dem Jagederfolg von Eisfüchsen und der Schneehöhe in den jeweiligen beobachteten Habitaten.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In der <a href="#fig-beta-broc" class="quarto-xref">Abbildung&nbsp;<span>56.2</span></a> sehen wir einmal die Verteilung unser untergewichtigen Brokkoli für die beiden Düngezeitpunkte und Düngemengen. Wir könnten annehmen, dass wir tendenziell bei einer höheren Düngemenge einen größeren Anteil an erreichtem Zielgewicht erhalten. Global betrachtet scheint es aber nicht so große Effekte zu geben. Wir schauen uns diese Beispiel dann einmal für den Gruppenvergleich an.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>broc_tbl <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> fert_amount, <span class="at">y =</span> proportion, <span class="at">color =</span> fert_time)) <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"[%] erreichtes Zielgewicht"</span>, <span class="at">x =</span> <span class="st">"Düngemenge [mg/l]"</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Düngezeitpunkt"</span>) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>(<span class="at">dodge.width =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-beta-broc" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-beta-broc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-beta_files/figure-html/fig-beta-broc-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Abbildung&nbsp;56.2— Zusammenhang zwischen erreichten Zielgewicht von 500g bei Brokkoli [%] und der Düngermenge sowiw dem Düngezeitpunkt."><img src="stat-modeling-beta_files/figure-html/fig-beta-broc-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-beta-broc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;56.2— Zusammenhang zwischen erreichten Zielgewicht von <span class="math inline">\(500g\)</span> bei Brokkoli [%] und der Düngermenge sowiw dem Düngezeitpunkt.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Abschließend schauen wir uns in der <a href="#fig-beta-fungi" class="quarto-xref">Abbildung&nbsp;<span>56.3</span></a> die Heatmap der genetischen Linien und der Art des Pilzes an. Ich habe die Heatmap so erstellt, dass eine viel Infektion rot dargestellt wird und wenig Infektion blau. Durch die Sortierung der Faktoren nach dem Infektionsgrad können wir sehr schön die Linien voneinander unterscheiden. Teilweise werden einige Linien von dem Pilz förmlich aufgefressen während andere Weizenlinien kaum befallen werden. Auch scheinen einige Arten des Pilzen mehr Weizenlinien befallen zu können als andere Pilzarten. So ist die Pilzart B189 extrem erfolgreich bei einer großen Anzahl an Linien. Die Art B1 hingegen kann mehr oder minder nur zwei Weizensorten befallen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>fungi_tbl <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(bunt, gen) <span class="sc">|&gt;</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">percent =</span> <span class="fu">mean</span>(percent)) <span class="sc">|&gt;</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gen, <span class="at">y =</span> bunt, <span class="at">fill =</span> percent)) <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"#375997"</span>, <span class="st">"gray"</span>, <span class="st">"firebrick"</span>),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>), </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Art des Pilzes"</span>, <span class="at">x =</span> <span class="st">"Genetische Linie des Weizens"</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"[%] infiziert"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-beta-fungi" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-beta-fungi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-beta_files/figure-html/fig-beta-fungi-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Abbildung&nbsp;56.3— Sortierte Heatmap der genetischen Linien und der Art des Pilzes. Farbig dargestellt sind die Anteile an infizierten Weizen in [%]. Nach dem Grad der Infektion wurden die Faktoren sortiert um eine bessere Übersicht zu erhalten."><img src="stat-modeling-beta_files/figure-html/fig-beta-fungi-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-beta-fungi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;56.3— Sortierte Heatmap der genetischen Linien und der Art des Pilzes. Farbig dargestellt sind die Anteile an infizierten Weizen in [%]. Nach dem Grad der Infektion wurden die Faktoren sortiert um eine bessere Übersicht zu erhalten.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="fit-des-modells" class="level2" data-number="56.4">
<h2 data-number="56.4" class="anchored" data-anchor-id="fit-des-modells"><span class="header-section-number">56.4</span> Fit des Modells</h2>
<p>Dann haben wir jetzt unsere Daten und wissen auch grob was in den Daten stecken könnte. Jetzt wollen wir einmal die verschieden Datensätze auswerten. Je nach Fragestellung können wir da verschiedene Modelle nutzen. Wie immer stelle ich auch Alternativen zu der Beta Regression vor. Wir schauen uns zum einen eine einfache Gaussian Regression an, die passt zwar nicht so richtig zu dem Outcome, aber unter bestimmten Voraussetzungen kann die Gaussian Regression Sinn machen. Wenn wir Erfolg/Misserfolg in unseren Daten als Outcome haben, dann können wir auch eine logistische Regression rechnen. Dementsprechend zeige ich die Anwendung auch einmal auf den Eisfuchsdaten, wo wir ja wissen wie oft ein Erfolg und ein Fehlschlag vorgekommen ist.</p>
<section id="mit-der-gaussian-regression" class="level3" data-number="56.4.1">
<h3 data-number="56.4.1" class="anchored" data-anchor-id="mit-der-gaussian-regression"><span class="header-section-number">56.4.1</span> … mit der Gaussian Regression</h3>
<p>Fangen wir also einmal mit der etwas groben Variante an. Wir rechnen einfach eine lineare Regression unter der Annahme das unser Outcome normalverteilt ist. Das stimmt zwar nur begrenzt für eine Wahrscheinlichkeit, die zwischen 0 und 1 liegt, aber rechnen können wir ja erstmal viel. Besonders wenn du Wahrscheinlichkeiten berechnet hast, die nicht sehr viele Nullen und Einsen beinhalten sondern mehr um die 0.5 streuen, dann kann deine Auswertung auch mit einer Gaussian Regression funktionieren. Wie immer kommt es dann auf den Einzelfall an, aber die Gaussian Regression liefert dann eben auch einen sehr gut zu verstehenden und interpretierenden Effektschätzer.</p>
<p>Wir wenden jetzt also einfach mal die Gaussian Regression mit der Funktion <code>lm()</code> auf unsere Daten zu dem Jagderfolg der Eisfüchse an. Wenn du dir nochmal die <a href="#fig-beta-fox-scatter" class="quarto-xref">Abbildung&nbsp;<span>56.1</span></a> anschaust, dann siehst du, dass wir nicht so viele Beobachtungen nah der Eins und der Null haben. Darüber hinaus ist eine wage Linearität zu erkennen. Oder anderherum, die Daten sehen jetzt nicht so schlimm aus, dass wir nicht eine Gerade durch die Punkte legen könnten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>hunting_lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(proportion <span class="sc">~</span> snow_height, <span class="at">data =</span> hunting_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann schauen wir uns einmal die Koeffizienten des Modells einmal an. Wir haben einen <code>Intercept</code> von über Eins, was natürlich keinen Sinn ergibt. Wir können keinen Jagederfolg von über Eins bei einer Schneehöhe von Null haben. Hier sieht man schon, dass das Modell nicht so gut für die Randbereiche funktioniert. Dennoch haben wir einen Abfall durch die Steigung der Schneehöhe vorliegen. Wir erkennen, dass pro Zentimeter mehr Schnee der Jagderfolg um <span class="math inline">\(0.0156\)</span> oder eben <span class="math inline">\(1.56\%\)</span> signifikant zurückgeht. Das ist ein Ergebnis mit dem wir leben könnten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>hunting_lm_fit </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = proportion ~ snow_height, data = hunting_tbl)

Coefficients:
(Intercept)  snow_height  
    1.36883     -0.01564  </code></pre>
</div>
</div>
<p>Wir können uns auch den Effekt der Schneehöhe auf den Jagderfolg einmal mit der Funktion <code>avg_slopes()</code> aus dem R Paket <code>{marginaleffects}</code> wiedergeben lassen. Für eine so simple Gaussion Regression ist der marginale Effekt gleich der Steigung, aber wenn wir gleich ein anderes Modell nehmen, dann wird es schon komplizierter. Mehr dazu dann auf der Hilfeseite zu <a href="https://marginaleffects.com/vignettes/slopes.html">Marginal Effects Zoo - Slopes</a> wo du dann auch mehr über <em>marginal effects</em> lernen kannst. Wie du dann siehst, erhalten wir hier den gleichen Wert für die Steigung.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_slopes</span>(hunting_lm_fit)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
        Term    Contrast Estimate Std. Error     z Pr(&gt;|z|)    S   2.5 %
 snow_height mean(dY/dX)  -0.0156    0.00203 -7.72   &lt;0.001 46.3 -0.0196
  97.5 %
 -0.0117

Columns: term, contrast, estimate, std.error, statistic, p.value, s.value, conf.low, conf.high, predicted_lo, predicted_hi, predicted 
Type:  response </code></pre>
</div>
</div>
<p>Schauen wir einmal wie das Bestimmtheitsmaß <span class="math inline">\(R^2\)</span> aussieht. Hier haben wir einen Wert von <span class="math inline">\(0.758\)</span> und damit können wir durch die Gerade gut <span class="math inline">\(75\%\)</span> der Varianz erklären. Das ist jetzt nicht der beste Werte und wir schauen uns am Ende nochmal in der <a href="#fig-beta-fox-predict" class="quarto-xref">Abbildung&nbsp;<span>56.5</span></a> wie die Gerade durch die Punkte läuft.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>hunting_lm_fit <span class="sc">|&gt;</span> <span class="fu">r2</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Linear Regression
       R2: 0.758
  adj. R2: 0.746</code></pre>
</div>
</div>
<p>Das einmal als sehr schneller und kurzer Einwurf der Gaussian Regression auf einem Outcome mit Prozenten. Es ist nicht ideal und weit weg von der Empfehlung. Aber wenn du einen statistischen Engel anfahren willst und mit der Interpretation ganz gut leben kannst, dann ist eine lineare Modellierung nicht so dramatisch. Achtung eben an den Rändern. Du erhälst eben auch schnell mal vorhergesagte Werte außerhalb von den Grenzen einer Wahrscheinlichkeit.</p>
</section>
<section id="mit-einer-logistischen-regression" class="level3" data-number="56.4.2">
<h3 data-number="56.4.2" class="anchored" data-anchor-id="mit-einer-logistischen-regression"><span class="header-section-number">56.4.2</span> … mit einer logistischen Regression</h3>
<p>Ja, auch dieses Problem können wir mit einer logistischen Regression angehen. Wenn du auch mal in den anderen Kapiteln geschaut hast, dann wundert es dich vermutlich nicht mehr, dass die logistische Regression außerhalb der Agarwissenschaften zu einer der beliebtesten Analysewerkzeugen gehört. Hier müssen wir aber unser Outcome etwas anders der Funktion <code>glm()</code> für die logistische Regression übergeben. Wir nutzen nämlich dafür das <a href="https://edgarhassler.com/posts/wilkinson-rogers-notation/">Wilkinson-Rogers Format</a> welches dann den Anteil an Erfolgen an Fehlschlägen beschreibt. Wir schreiben aber in das Modell die konkrete Anzahl an Erfolgen und Fehlschlägen.</p>
<p><span class="math display">\[
(Success|Failure) \sim x_1 + x_2 + ... + x_p
\]</span></p>
<p>In R würden wir dann die <em>zwei</em> Spalten mit der Anzahl an Erfolgen und Fehlschlägen mit <code>cbind()</code> zusammenfassen und in <code>glm()</code> ergänzen. Dieses Format haben wir dann auch bei unseren Eisfüchsen vorliegen. In unseren Daten haben wir ja die Spalte <code>success</code>, welche die Anzahl Jagderfolge beschreibt sowie die Anzahl der Fehlschläge in der Spalte <code>fail</code>. Wichtig ist hier, dass wir wirklich die beiden Spalten mit den jeweiligen Anzahlen haben. Daher würden wir dann in R wie folgt schreiben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>hunting_log_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">cbind</span>(success, fail) <span class="sc">~</span> snow_height, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> hunting_tbl, <span class="at">family =</span> binomial)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>hunting_log_fit</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  glm(formula = cbind(success, fail) ~ snow_height, family = binomial, 
    data = hunting_tbl)

Coefficients:
(Intercept)  snow_height  
    4.80027     -0.08326  

Degrees of Freedom: 20 Total (i.e. Null);  19 Residual
Null Deviance:      146.7 
Residual Deviance: 31.9     AIC: 99.35</code></pre>
</div>
</div>
<p>Damit haben wir dann auch unseren Koeffizienten des Intercept und der Steigung. Da die logistische Regression auf dem Logit-Link rechnet, können wir die Steigung von <span class="math inline">\(-0.08326\)</span> nicht direkt interpretieren. Daher müssen wir die Steigung wieder von dem Logit-Link auf unsere ursprüngliche Skala (eng. <em>response</em>) zurückrechnen. Dafür gibt es einen einfachen Trick mit der “Teile durch Vier” Regel oder aber eine entsprechende Funktion im R Paket <code>{marginaleffects}</code>. Wichtig ist auch hier, uns interessieren nicht die Odds Ratios aus einer logistischen Regression, da wir an dem Effekt der Steigung interessiert sind. Wir wollen ja wissen, wie sich der Jagderfolg in [%] durch die steigende Schneeschöhe verändert.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
“Teile durch Vier” Regel
</div>
</div>
<div class="callout-body-container callout-body">
<p>Die “Teile durch Vier” Regel (eng. <em>Divide by 4 Rule</em>) erlaubt uns von dem Koeffizienten aus der logistischen Regression auf die wahre Steigung der Geraden zu schließen. Da die logistische Regression auf dem Logit-Link rechnet, ist unsere <span class="math inline">\(-0.08\)</span> <em>nicht</em> die Steigung der Geraden. Es gibt hier die Daumenregel, den Koeffizienten durch Vier zu teilen und so einen annähernd korrekten Wert zu erhalten. In unserem Fall also <span class="math inline">\(-0.08326/4 = -0.021\)</span>. Damit haben wir nicht den exakten Wert der Steigung, aber eine recht guten Wert.</p>
</div>
</div>
<p>Mit der Funktion <code>avg_slopes()</code> können wir uns aus dem Modell die Steigung der Gerade berechnen lassen. Wir haben dann nicht mehr die Logit-Skala vorliegen sondern sind wieder auf unserer ursprünglichen Skala der Prozente. Im Gegensatz zur “Teile durch Vier” Regel ist der Wert von <span class="math inline">\(-0.15\)</span> natürlich genauer. Wir sehen, dass wir fast einen ähnlichen Wert für die Reduzierung des Jagderfolges der Eisfüchse wie bei der Gaussian Regression erhalten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_slopes</span>(hunting_log_fit)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
        Term    Contrast Estimate Std. Error     z Pr(&gt;|z|)     S  2.5 % 97.5 %
 snow_height mean(dY/dX)   -0.015    0.00101 -14.9   &lt;0.001 163.8 -0.017 -0.013

Columns: term, contrast, estimate, std.error, statistic, p.value, s.value, conf.low, conf.high, predicted_lo, predicted_hi, predicted 
Type:  response </code></pre>
</div>
</div>
<p>Leider gibt es für eine logistische Regression mit einem <span class="math inline">\((Success/Failure)\)</span>-Outcome kein kein <em>echtes</em> Bestimmtheitsmaß <span class="math inline">\(R^2\)</span>. Hier greifen wir auf das R Paket <code>{rcompanion}</code> zurück. Wir rechnen auch dabei auch hier kein <em>echtes</em> Bestimmtheitsmaß <span class="math inline">\(R^2\)</span> aus, sondern den Vergleich zu einem Null-Modell in dem wir gar keine Variable als Einfluss mit ins Modell nehmen. Das folgende Bestimmtheitsmaß <span class="math inline">\(R^2\)</span> beantwortet also eher die Frage, ob wir besser mit unserem Modell mit der Schneehöhe sind, also mit einem Modell ohne die Schneehöhe.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>hunting_log_fit <span class="sc">|&gt;</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nagelkerke</span>() <span class="sc">|&gt;</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"Pseudo.R.squared.for.model.vs.null"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                             Pseudo.R.squared
McFadden                             0.546227
Cox and Snell (ML)                   0.995769
Nagelkerke (Cragg and Uhler)         0.995814</code></pre>
</div>
</div>
<p>Hm, am Ende würde ich es lassen. Keine der Bestimmtheitsmaße <span class="math inline">\(R^2\)</span> ist wirklich sinnig. Das erste Bestimmtheitsmaß ist viel zu niedrig, dafür das wir so nahe an den Koeffizienten der Gaussian Regression sind. Dafür sind die anderen beiden Bestimmtheitsmaße viel zu optimistisch, wie wir gleich in der <a href="#fig-beta-fox-predict" class="quarto-xref">Abbildung&nbsp;<span>56.5</span></a> sehen werden. Aber damit haben wir auch gesehen, dass wir die Analyse auch mit einer logistischen Regression rechnen können.</p>
</section>
<section id="mit-dem-r-paket-betareg" class="level3" data-number="56.4.3">
<h3 data-number="56.4.3" class="anchored" data-anchor-id="mit-dem-r-paket-betareg"><span class="header-section-number">56.4.3</span> … mit dem R Paket <code>{betareg}</code></h3>
<p>Jetzt haben wir uns durch andere Modellierungen durchgearbeitet und wollen uns jetzt einmal die Beta Regression anschauen. Die Beta Regression ist in dem R Paket <code>{betareg}</code> implementiert und kann über die Funktion <code>betareg()</code> angewendet werden. Wir haben hier noch den Sonderfall, dass wir das Modell mit einem <code>|</code> schreiben können. Wir können nämlich bei der Beta Regression auch die Varianz global schätzen oder aber für eine Variable adjustieren. Wir wählen hier einmal beide Schreibweisen in den folgenden Tabs und schauen was dann herauskommt. Sonst müssen wir bei der Beta Regression erstmal nichts beachten - wie immer schauen wir dann nochmal, ob unser Modell auch gut funktioniert hat.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Mit <code>~ snow_height</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Mit <code>~ snow_height | snow_height</code></a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Das simpleste Modell wäre hier, dass wir einfach den Jagderfolg in [%] durch die Schneehöhe modellieren. Wir nehmen dann mehr oder minder Varianzhomogenität an und erlauben keinen gesonderten Varianzterm. Das kann gut funktionieren, aber meistens variiert die Varianz der <span class="math inline">\(y\)</span>-Werte über die <span class="math inline">\(x\)</span>-Werte. Wir haben meist eine größere Varianz bei größeren <span class="math inline">\(x\)</span>-Werten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>hunting_beta_fit <span class="ot">&lt;-</span> <span class="fu">betareg</span>(proportion <span class="sc">~</span> snow_height, <span class="at">data =</span> hunting_tbl)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>hunting_beta_fit</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
betareg(formula = proportion ~ snow_height, data = hunting_tbl)

Coefficients (mean model with logit link):
(Intercept)  snow_height  
    4.51312     -0.08082  

Phi coefficients (precision model with identity link):
(phi)  
12.53  </code></pre>
</div>
</div>
<p>Wir sehen, dass wir unseren Koeffizienten erhalten, der fast unserer logistischen Regression entspricht. Jedenfalls numerisch. Aber auch hier dürfen wir uns nicht blenden lassen, wir rechnen auch in einer Beta Regression auf dem Logit-Link. Deshalb müssen wir die Steigung der Schneehöhe dann erst wieder zurückrechnen. Auch hier hilft die Funktion <code>avg_slopes()</code> aus dem R Paket <code>{marginaleffects}</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_slopes</span>(hunting_beta_fit)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
        Term    Contrast Estimate Std. Error     z Pr(&gt;|z|)     S  2.5 %
 snow_height mean(dY/dX)  -0.0149    0.00109 -13.6   &lt;0.001 137.4 -0.017
  97.5 %
 -0.0127

Columns: term, contrast, estimate, std.error, statistic, p.value, s.value, conf.low, conf.high, predicted_lo, predicted_hi, predicted 
Type:  response </code></pre>
</div>
</div>
<p>Wir sehen, dass mit jedem Zentimeter mehr Schnee der Jagderfolg um <span class="math inline">\(-0.0149\)</span> oder <span class="math inline">\(-1.49\%\)</span> zurückgeht. Das sind ähnliche Zahlen wie auch schon bei der logistischen Regression sowie der Gaussian Regression.</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Wenn wir erlauben, dass sich die Varianz der <span class="math inline">\(y\)</span>-Werte über den Verlauf der <span class="math inline">\(x\)</span>-Werte ändern darf, dann schreiben wir nochmal die Variable, die die Varianz verursacht hinter das Symbol <code>|</code>. Wir haben hier nur die Schneehöhe vorliegen, so dass unser Modell sich dann von alleine ergibt. Meistens macht es mehr Sinn die Varianz auch über eine Variable mit zu modellieren. Schauen wir mal, ob wir mit der separaten Modellierung der Varianz der Schneehöhe mehr erreichen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>hunting_beta_phi_fit <span class="ot">&lt;-</span> <span class="fu">betareg</span>(proportion <span class="sc">~</span> snow_height <span class="sc">|</span> snow_height, <span class="at">data =</span> hunting_tbl)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>hunting_beta_phi_fit</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
betareg(formula = proportion ~ snow_height | snow_height, data = hunting_tbl)

Coefficients (mean model with logit link):
(Intercept)  snow_height  
    3.99212     -0.06798  

Phi coefficients (precision model with log link):
(Intercept)  snow_height  
    6.42223     -0.07271  </code></pre>
</div>
</div>
<p>Aber auch hier dürfen wir uns nicht blenden lassen, wir rechnen auch in einer Beta Regression auf dem Logit-Link. Deshalb müssen wir die Steigung der Schneehöhe dann erst wieder zurückrechnen. Auch hier hilft die Funktion <code>avg_slopes()</code> aus dem R Paket <code>{marginaleffects}</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_slopes</span>(hunting_beta_phi_fit)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
        Term    Contrast Estimate Std. Error     z Pr(&gt;|z|)     S   2.5 %
 snow_height mean(dY/dX)  -0.0132    0.00108 -12.2   &lt;0.001 110.7 -0.0153
 97.5 %
 -0.011

Columns: term, contrast, estimate, std.error, statistic, p.value, s.value, conf.low, conf.high, predicted_lo, predicted_hi, predicted 
Type:  response </code></pre>
</div>
</div>
<p>Spannenderweise ist hier der Effekt der Schneehöhe noch einen Tick geringer mit <span class="math inline">\(-0.0132\)</span> pro Zentimeter mehr Schnee. Dann müssen wir uns gleich einmal anschauen welches Modell den niedrigeren AIC-Wert hat.</p>
</div>
</div>
</div>
<p>Dann berechnen wir einmal die AIC-Werte für die beiden Modelle. Ein niedriger AIC-Wert ist besser. Je kleiner oder negativer ein AIC-Wert eines Modells ist, desto besser ist das Modell im Vergleich zu einem anderen Modell. Das AIC ist ein Maß dafür, wie gut die Daten durch das Modell erklärt werden, korrigiert um die Komplexität des Modells. Wir berechnen mit der Funktion <code>AIC()</code> einmal die AIC-Werte der beiden Beta Regressionsmodellen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(hunting_beta_fit)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -27.58488</code></pre>
</div>
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(hunting_beta_phi_fit)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -33.9114</code></pre>
</div>
</div>
<p>Die absoluten Zahlen vom AIC sind nicht von Bedeutung. Erstmal sehen wir, dass unser Modell mit der Berücksichtigung der Varianz durch die Schneehöhe <code>hunting_beta_phi_fit</code> besser ist als das reine Modell ohne Berücksichtigung. Wir wollen aber immer die Differenzen von AIC betrachten. Du findest in der wissenschaftlichen Veröffentlichung <a href="https://faculty.washington.edu/skalski/classes/QERM597/papers_xtra/Burnham%20and%20Anderson.pdf">Multimodel Inference: Understanding AIC and BIC in Model Selection</a> mehr Informationen zu den Entscheidungen <span class="citation" data-cites="burnham2004multimodel">(<a href="#ref-burnham2004multimodel" role="doc-biblioref">Burnham &amp; Anderson, 2004</a>, pp.&nbsp;270-271)</span>. Wichtig ist hier, wenn die Differenz größer ist als 2, dann haben wir einen signifikanten Unterschied zwischen den Modellen und wir sollten das Modell mit dem niedrigeren AIC nehmen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(hunting_beta_fit) <span class="sc">-</span> <span class="fu">AIC</span>(hunting_beta_phi_fit)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.326516</code></pre>
</div>
</div>
<p>Wir nehmen dann mal auf jeden Fall das Modell mit der Berücksichtigung der Varianz durch die Schneehöhe <code>hunting_beta_phi_fit</code>. Damit würden wir einen Effekt der Schneehöhe von <span class="math inline">\(-0.0132\)</span> berichten. Berechnen wir jetzt nochmal als Vergleich das Bestimmtheitsmaß <span class="math inline">\(R^2\)</span> und sehen, dass der Wert schon besser ist. Damit können wir dann auf jeden Fall leben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>hunting_beta_phi_fit <span class="sc">|&gt;</span> <span class="fu">r2</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Beta Regression
  Pseudo R2: 0.796</code></pre>
</div>
</div>
<p>In der <a href="#fig-beta-fox-diagnostic" class="quarto-xref">Abbildung&nbsp;<span>56.4</span></a> sehen wir nochmal die Abbildungen der Modelldiagnostik. Wie du sehen kannst, sind die Ergebnisse zufriedenstellend. Der Residualplot sieht aus, wie wir ihn erwarten würden. Unsere Beobachtungen streuen um die Gerade. Auch haben wir keine Ausreißer vorliegen. Unsere Werte der <em>Cook’s distance</em> sind okay. Der Grenzwert wäre hier <span class="math inline">\(4/n = 4/21 = 0.19\)</span>. Unsere erste Beobachtung würde den Grenzwert reißen, aber das ist noch okay so. Das passt auch zu der Abbildung der Residuen. Auch die <em>Generalized leverage</em> deutet auf einen Ausreißer hin. Wir haben hier den Grenzwert von <span class="math inline">\(3(k+1)/n\)</span> mit <span class="math inline">\(k\)</span> gleich der Anzahl an Variablen im Modell. Somit liegt unser Grenzwert bei <span class="math inline">\(3(1+1)/21 = 0.29\)</span>. Auch der abschließende Residualplot sieht so aus, wie wir ihn erwarten würden. Als Fazit lässt sich ziehen, das wir zwar eine Beobachtung drin haben, die etwas am Rand liegt, was hier aber für mich noch nicht fürs Entfernen spricht.</p>
<div class="cell" data-layout-nrow="2" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hunting_beta_phi_fit)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-beta-fox-diagnostic" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-beta-fox-diagnostic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-beta-fox-diagnostic" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-beta-fox-diagnostic-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-beta-fox-diagnostic-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-beta_files/figure-html/fig-beta-fox-diagnostic-1.png" class="lightbox" data-gallery="fig-beta-fox-diagnostic" title="Abbildung&nbsp;56.4&nbsp;(a)— Residualplot I"><img src="stat-modeling-beta_files/figure-html/fig-beta-fox-diagnostic-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-beta-fox-diagnostic" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-beta-fox-diagnostic-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Residualplot I
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-beta-fox-diagnostic" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-beta-fox-diagnostic-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-beta-fox-diagnostic-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-beta_files/figure-html/fig-beta-fox-diagnostic-2.png" class="lightbox" data-gallery="fig-beta-fox-diagnostic" title="Abbildung&nbsp;56.4&nbsp;(b)— Cooks distance"><img src="stat-modeling-beta_files/figure-html/fig-beta-fox-diagnostic-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-beta-fox-diagnostic" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-beta-fox-diagnostic-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Cooks distance
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-beta-fox-diagnostic" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-beta-fox-diagnostic-3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-beta-fox-diagnostic-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-beta_files/figure-html/fig-beta-fox-diagnostic-3.png" class="lightbox" data-gallery="fig-beta-fox-diagnostic" title="Abbildung&nbsp;56.4&nbsp;(c)— Generalized leverage"><img src="stat-modeling-beta_files/figure-html/fig-beta-fox-diagnostic-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-beta-fox-diagnostic" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-beta-fox-diagnostic-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Generalized leverage
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-beta-fox-diagnostic" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-beta-fox-diagnostic-4" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-beta-fox-diagnostic-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-beta_files/figure-html/fig-beta-fox-diagnostic-4.png" class="lightbox" data-gallery="fig-beta-fox-diagnostic" title="Abbildung&nbsp;56.4&nbsp;(d)— Residualplot II"><img src="stat-modeling-beta_files/figure-html/fig-beta-fox-diagnostic-4.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-beta-fox-diagnostic" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-beta-fox-diagnostic-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d) Residualplot II
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-beta-fox-diagnostic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;56.4— Ausgabe ausgewählter Modelgüteplots der Funktion <code>plot()</code>. Im Gegensatz zu der Funktion <code>check_model()</code> musst du wissen, was du erwarten würdest.
</figcaption>
</figure>
</div>
</div>
<p>Damit hätten wir höchstens einen Ausreißer, aber das kann bei echten Daten schon mal vorkommen, dass nicht alle Datenpunkte perfekt zu einem Modell passen. In der <a href="#fig-beta-fox-predict" class="quarto-xref">Abbildung&nbsp;<span>56.5</span></a> siehst du nochmal die Daten der Jagderfolge der Eisfüche im Zusammenhang mit der Schneehöhe dargestellt. Ich sehe da keinen eindeutigen Ausreißer und deshalb lasse ich alle Beobachtungen im Modell. Im Weiteren siehst du einmal die Modelle, die ich gerechnet habe, jeweils als Kurve dargestellt. Das beste Modell ist das <code>betareg_phi</code> Modell, was auch ziemlich gut durch die Punkte läuft. Du siehst besonders gut, wie das lineare Modell <code>lm</code> leider die Punkte nur sehr unzureichend an den Rändern trifft. Kann ja das Modell auch nicht anders, es muss ja eine Linie sein. Beachte aber vor allem die Unterschiede in den Effekten. Das lineare Modell mit der Gaussian Regression hat einen viel größeren Effekt berechnet als das beste Modell mit der Beta Regression.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>hunting_tbl <span class="sc">|&gt;</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(snow_height, proportion)) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">predict</span>(hunting_log_fit, <span class="at">type =</span> <span class="st">"response"</span>), <span class="at">color =</span> <span class="st">"log"</span>)) <span class="sc">+</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">predict</span>(hunting_lm_fit, <span class="at">type =</span> <span class="st">"response"</span>), <span class="at">color =</span> <span class="st">"lm"</span>)) <span class="sc">+</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">predict</span>(hunting_beta_fit, <span class="at">type =</span> <span class="st">"response"</span>), <span class="at">color =</span> <span class="st">"betareg"</span>)) <span class="sc">+</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">predict</span>(hunting_beta_phi_fit, <span class="at">type =</span> <span class="st">"response"</span>), <span class="at">color =</span> <span class="st">"betareg_phi"</span>)) <span class="sc">+</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Modell"</span>, <span class="at">values =</span> cb_pal[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>])</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-beta-fox-predict" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-beta-fox-predict-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-beta_files/figure-html/fig-beta-fox-predict-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Abbildung&nbsp;56.5— Zusammenhang zwischen dem Jagederfolg von Eisfüchsen und der Schneehöhe in den jeweiligen beobachteten Habitaten zusammen mit den vier vorgestellten Modellen. Das Modell betareg_phi ist dabei das Modell, was die Daten am besten beschreibt."><img src="stat-modeling-beta_files/figure-html/fig-beta-fox-predict-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-beta-fox-predict-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;56.5— Zusammenhang zwischen dem Jagederfolg von Eisfüchsen und der Schneehöhe in den jeweiligen beobachteten Habitaten zusammen mit den vier vorgestellten Modellen. Das Modell <code>betareg_phi</code> ist dabei das Modell, was die Daten am besten beschreibt.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Wo ist die mathematische Formel?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Jetzt haben wir zwar schön das Modell mit der Beta Regression geschätzt aber leider keine mathematische Formel erhalten. Das ist jetzt ja eigentlich auch eine andere Fragestellung. Daher nutzen wir für die Erstellung der mathematischen Formel auch nicht die Beta Regression sondern die nicht linear Regression. Prinzipiell ginge natürlich auch die lineare Regression, aber da wissen wir ja schon, dass die nicht so super funktioniert. Hier jetzt also der Weg um die Koeffizienten einer nicht lineare Regression zu bestimmen, die durch die Punkte eine Kurve legt.</p>
<p>Auch hier haben wir die Wahl zwischen der Funktion <code>nls()</code> aus dem Standardpaket in R oder aber der Funktion <code>mfp()</code> aus dem gleichnamigen R Paket <code>{mfp}</code>. In den beiden Tabs zeige ich dir einmal die schnelle Anwendung. Wenn du mehr lesen willst dann kannst du nochmal in dem <a href="stat-modeling-non-linear.html">Kapitel zur nicht linearen Regression</a> reinschauen. Wie immer führe ich hier den Code mehr aus als ihn dann zu erklären.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Mit <code>nls()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Mit <code>mfp()</code></a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Die Funktion <code>nls()</code> hat die Herausforderung, dass wir Startwerte für die Koeffizienten unserer mathematischen Formel übergeben müssen. Darüber hinaus müssen wir auch in der Funktion <code>nls()</code> eine Formel vordefinieren, die dann eben mit den Werten der Koeffizienten gefüllt wird. Wenn es dir auch eher schwer fällt in einer Punktewolke eine mathematische Funktion zu sehen, dann ist die Funktion <code>nls()</code> eine Herausforderung. Es gibt zwar den einen oder anderen Trick, aber am Ende müssen wir schauen, ob es dann passt mit dem Ergebnis.</p>
<p>Wir brauchen erstmal Startwerte für unsere mathematische Formel <span class="math inline">\(y = a - x^b\)</span>. Ein Trick ist, erstmal eine lineare Regression mit <code>lm()</code> zu rechnen und die Koeffizienten dann als Startwerte in <code>nls()</code> zu nutzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="fu">log</span>(proportion) <span class="sc">~</span> snow_height, hunting_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(proportion) ~ snow_height, data = hunting_tbl)

Coefficients:
(Intercept)  snow_height  
     1.0324      -0.0354  </code></pre>
</div>
</div>
<p>Mit unseren Startwerten können wir dann einmal schauen, ob unser Modell konvergiert. Dann haben wir auch die Werte für die Koeffizienten <span class="math inline">\(a\)</span> und <span class="math inline">\(b\)</span> und können das Modell als mathematische Formel aufschreiben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nls</span>(proportion <span class="sc">~</span> a <span class="sc">-</span> <span class="fu">I</span>(snow_height<span class="sc">^</span>b), <span class="at">data =</span> hunting_tbl, </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">start =</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="fu">exp</span>(<span class="fl">1.0324</span>), <span class="at">b =</span> <span class="sc">-</span><span class="fl">0.0354</span>),</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">nls.control</span>(<span class="at">maxiter =</span> <span class="dv">1000</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Nonlinear regression model
  model: proportion ~ a - I(snow_height^b)
   data: hunting_tbl
    a     b 
3.196 0.248 
 residual sum-of-squares: 0.5484

Number of iterations to convergence: 6 
Achieved convergence tolerance: 1.807e-07</code></pre>
</div>
</div>
<p>Wir können auch nochmal eine <span class="math inline">\(e\)</span>-Funktion mit <span class="math inline">\(y = a - e^{b \cdot x}\)</span> nutzen und schauen, ob wir damit etwas besser an die Daten näherkommen. Hier müssen wir dann wirklich ausprobieren, was teilweise echt nervig ist. Dafür schauen wir uns gleich nochmal die Funktion <code>mfp()</code> an.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nls</span>(proportion <span class="sc">~</span> a <span class="sc">-</span> <span class="fu">exp</span>(b <span class="sc">*</span> snow_height), <span class="at">data =</span> hunting_tbl, </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">start =</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">0</span>),</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">nls.control</span>(<span class="at">maxiter =</span> <span class="dv">1000</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Nonlinear regression model
  model: proportion ~ a - exp(b * snow_height)
   data: hunting_tbl
      a       b 
2.26755 0.01014 
 residual sum-of-squares: 0.3478

Number of iterations to convergence: 6 
Achieved convergence tolerance: 2.307e-07</code></pre>
</div>
</div>
<p>Hat jeweils geklappt und dann können wir uns auch schon die Gleichung zusammenbauen. Die Frage ist natürlich, ob die Werte gut zu unseren Daten passen. Das werden wir dann gleich nochmal in der <a href="#fig-beta-fox-predict-non" class="quarto-xref">Abbildung&nbsp;<span>56.6</span></a> überprüfen. Hier dann einmal die erste Gleichung für das Polynom und dann die zweite Gleichung mit der <span class="math inline">\(e\)</span>-Funktion.</p>
<p><span class="math display">\[
proportion = 3.196 - snow\_height^{0.248}
\]</span></p>
<p><span class="math display">\[
proportion = 2.268 - e^{0.0101 \cdot snow\_height}
\]</span></p>
<p>Welche dann die beste mathematische Formel ist sehen wir dann gleich. Bitte schaue dir aber noch den anderen Tab mit der Funktion <code>mfp()</code> an, denn mit der Funktion <code>nls()</code> ist es dann doch manchmal etwas Glücksspiel, ob man die richtige mathematische Formel mit den richtigen Startwerten trifft. Auch hier hilft vielleicht das <a href="https://github.com/padpadpadpad/nls.multstart">R Paket <code>{nls.multstart}</code></a> welches versucht das Problem der Startwerte nochmal algorithmisch zu lösen. Sieht jetzt wilder aus als es ist, aber hier kriege ich dann noch ein <span class="math inline">\(c\)</span> mit in der Formel unter.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nls_multstart</span>(proportion <span class="sc">~</span> a <span class="sc">-</span> c <span class="sc">*</span> <span class="fu">I</span>(snow_height<span class="sc">^</span>b), <span class="at">data =</span> hunting_tbl, </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">lower =</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">c =</span> <span class="dv">0</span>),</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">upper =</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="cn">Inf</span>, <span class="at">b =</span> <span class="cn">Inf</span>, <span class="at">c =</span> <span class="cn">Inf</span>),</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">start_lower =</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">c =</span> <span class="dv">0</span>),</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">start_upper =</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">500</span>, <span class="at">b =</span> <span class="dv">5</span>, <span class="at">c =</span> <span class="dv">10</span>),</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">iter =</span> <span class="dv">500</span>, <span class="at">supp_errors =</span> <span class="st">"Y"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Nonlinear regression model
  model: proportion ~ a - c * I(snow_height^b)
   data: data
        a         c         b 
8.888e-01 7.189e-10 4.914e+00 
 residual sum-of-squares: 0.1778

Number of iterations to convergence: 16 
Achieved convergence tolerance: 1.49e-08</code></pre>
</div>
</div>
<p>Dann erhalten wir als Abschluss die folgende Formel. Du kannst hier wirklich sehr viel rumspielen und schauen, welche der expoentziellen Gleichungen am besten passt. Das ist dann wirklich immer ein rumprobieren.</p>
<p><span class="math display">\[
proportion = 4.914 - 7.189\cdot10^{-10} \cdot snow\_height^{0.888}
\]</span></p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Nachdem wir den langen Weg mit der Funktion <code>nls()</code> gegeangen sind, machen wir es jetzt etwas kürzer mit der Funktion <code>mfp()</code>. Wir müssen nur angeben welche Variable als Polynom modelliert werden soll. Den Rest macht dann die Funktion <code>mfp()</code> für uns. Wir erhalten dann auch die Formel für den Zusammenhang der folgenden Form. Wir erhalten dann die Werte für <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span> sowie dem Polynom <span class="math inline">\(p\)</span> und der möglichen Transformation von <span class="math inline">\(x\)</span>.</p>
<p><span class="math display">\[
proportion = \beta_0 - \beta_1 \cdot \left(snow\_height\right)^p
\]</span></p>
<p>Dann rechnen wir mal die Funktion und schauen welche Werte wir erhalten. Die Kunst ist hier die Werte für die Koeffizienten aus der Ausgabe abzulesen. Aber das mache ich dir hier ja einmal vor.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mfp</span>(proportion <span class="sc">~</span> <span class="fu">fp</span>(snow_height), <span class="at">data =</span> hunting_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
mfp(formula = proportion ~ fp(snow_height), data = hunting_tbl)


Deviance table:
         Resid. Dev
Null model   1.705267
Linear model     0.412282
Final model  0.2184446

Fractional polynomials:
            df.initial select alpha df.final power1 power2
snow_height          4      1  0.05        2      3      .


Transformations of covariates:
                           formula
snow_height I((snow_height/100)^3)

Coefficients:
    Intercept  snow_height.1  
       0.9741        -2.4216  

Degrees of Freedom: 20 Total (i.e. Null);  19 Residual
Null Deviance:      1.705 
Residual Deviance: 0.2184   AIC: -30.29 </code></pre>
</div>
</div>
<p>Dann können wir die Werte aus der Ausgabe auch schon in unsere Gleichung einsetzen. Der Vorteil ist wirklich, dass ich mir nicht überlegen muss, welche mathematische Formel ich nutzen will. Das schränkt mich zwar ein, macht mir das Leben aber auch einfacher. Wir erhalten dann eben eine Polynom, was auch einfach einzusetzen ist.</p>
<p><span class="math display">\[
proportion = 0.9741 -2.4216 \cdot \left(\cfrac{snow\_height}{100}\right)^3
\]</span></p>
<p>Dann schauen wir mal gleich, welche der drei mathematischen Formeln am besten zu unseren Daten in der <a href="#fig-beta-fox-predict-non" class="quarto-xref">Abbildung&nbsp;<span>56.6</span></a> passen.</p>
</div>
</div>
</div>
<p>Im ersten Schritt bauen wir uns einmal in R die drei mathematischen Formeln einmal nach. Wir nutzen dafür die Funktion <code>\(x){...}</code> und setzen die Zahlen der Koeffizienten ein. Hier musst du nur mit den Klammern aufpassen, sonst bauen sich die Formeln einfach.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>nls_poly_func <span class="ot">&lt;-</span> \(x){<span class="fl">3.196</span> <span class="sc">-</span> x<span class="sc">^</span>(<span class="fl">0.248</span>)}</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>nls_exp_func <span class="ot">&lt;-</span> \(x){<span class="fl">2.268</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="fl">0.0101</span> <span class="sc">*</span> x)}</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>nls_multstart <span class="ot">&lt;-</span> \(x){<span class="fl">4.914</span> <span class="sc">-</span> <span class="fl">7.189e-10</span> <span class="sc">*</span> x<span class="sc">^</span>(<span class="fl">0.888</span>)}</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>mfp_func <span class="ot">&lt;-</span> \(x){<span class="fl">0.9741</span> <span class="sc">-</span> <span class="fl">2.4216</span> <span class="sc">*</span> (x<span class="sc">/</span><span class="dv">100</span>)<span class="sc">^</span><span class="dv">3</span>}</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der <a href="#fig-beta-fox-predict-non" class="quarto-xref">Abbildung&nbsp;<span>56.6</span></a> siehst du einmal den Vergleich der drei nicht linearen Regressionen zu den Datenpunkten. Was will man sagen, dass Modell aus der Funktion <code>mfp()</code> bei weitem das beste Modell liefert um den Verlauf der Punkte durch eine Kurve zu beschreiben. Wenn es dir also nur darum ginge die Werte für die Jagderfolge nach der Schneehöhe vorherzusagen, dann sieht das <code>mfp()</code>-Modell sehr gut aus.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>hunting_tbl <span class="sc">|&gt;</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(snow_height, proportion)) <span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> nls_poly_func, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"nls_poly"</span>)) <span class="sc">+</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> nls_exp_func, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"nls_exp"</span>)) <span class="sc">+</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> nls_exp_func, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"nls_multstart"</span>)) <span class="sc">+</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> mfp_func, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"mfp"</span>)) <span class="sc">+</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Modell"</span>, <span class="at">values =</span> cb_pal[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>])</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-beta-fox-predict-non" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-beta-fox-predict-non-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-beta_files/figure-html/fig-beta-fox-predict-non-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Abbildung&nbsp;56.6— Zusammenhang zwischen dem Jagederfolg von Eisfüchsen und der Schneehöhe in den jeweiligen beobachteten Habitaten zusammen mit den drei nicht linearen Regressionen aus der Funktion nls() und mfp()."><img src="stat-modeling-beta_files/figure-html/fig-beta-fox-predict-non-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-beta-fox-predict-non-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;56.6— Zusammenhang zwischen dem Jagederfolg von Eisfüchsen und der Schneehöhe in den jeweiligen beobachteten Habitaten zusammen mit den drei nicht linearen Regressionen aus der Funktion <code>nls()</code> und <code>mfp()</code>.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="sec-mult-comp-beta-reg" class="level2" data-number="56.5">
<h2 data-number="56.5" class="anchored" data-anchor-id="sec-mult-comp-beta-reg"><span class="header-section-number">56.5</span> Gruppenvergleich</h2>
<p>Neben der klassischen Regression in der wir dann eine Kurve durch die Punkte legen können wir die Beta Regression auch verwenden um einen Gruppenvergleich zu rechnen. Häufig sind wir in den Agrawissenschaften eher an dieser Frage interessiert. Wir machen das jetzt eigentlich wie immer mit dem R Paket <code>{emmeans}</code> und der Funktion <code>Anova()</code> aus dem R Paket <code>{car}</code>. Wenn du noch mehr zu den multiplen Vergleichen lesen willst, dann kannst du nochmal in das <a href="stat-tests-posthoc2.html">Kapitel zu den multiplen Vergleichen und dem Posthoc Test</a> reinschauen. Wir konzentrieren uns hier auf die wichtigsten Aspekte und gehen einmal die Sachlage für die Daten zu den untergewichtigen Brokkoli sowie unsren Pilzen auf dem Weizen durch. Dabei habe ich dann die Daten für die Pilze etwas reduziert, weil es einfach zu viele Faktoren sind.</p>
<section id="untergewichtige-brokkoli" class="level3" data-number="56.5.1">
<h3 data-number="56.5.1" class="anchored" data-anchor-id="untergewichtige-brokkoli"><span class="header-section-number">56.5.1</span> Untergewichtige Brokkoli</h3>
<p>Beginnen wir also mit den Daten unseres untergewichtigen Brokkoli. Wir haben als Outcome <code>proprotion</code> den Anteil an 500g, also die prozentuale Untergewichtigkeit eines jedes Brokkolikopfes. Dabei habe ich dann alle Brokkoli mit einem Anteil von Eins oder größer entfernt. Wir wollen hier explizit auf die Köpfe schauen, die das Zielgewicht nicht erreicht haben. Damit steht das Modell aus schon fast. Wir haben drei Faktoren, einmal die Zeit der Düngung <code>fert_time</code> sowie dann die Menge der Düngung <code>fert_amount</code>. Dann nehme ich den Block noch mit rein, denn ich will einmal sehen wie stark der Blockeffekt in der ANOVA ist. Damit ich das so auch kann, muss einmal der Block mit ins Modell. Dann haben wir natürlich bei der beta Regression die Frage, ob wir dann die Varianz nochmal direkt mit modellieren sollen. Das würden wir ja mit einem <code>|</code> durchführen. Ich rechne hier jetzt mal drei Modelle, einmal ein Modell ohne explizite Varianz, dann einmal mit der Berücksichtigung der Varianz der Blöcke und zum Schluss nochmal ein Modell mit der Berücksichtigung aller drei Faktoren als Varianzquelle.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>broc_1_fit <span class="ot">&lt;-</span> <span class="fu">betareg</span>(proportion <span class="sc">~</span> fert_time <span class="sc">+</span> fert_amount <span class="sc">+</span> fert_time<span class="sc">:</span>fert_amount <span class="sc">+</span> block, </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> broc_tbl)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>broc_2_fit <span class="ot">&lt;-</span> <span class="fu">betareg</span>(proportion <span class="sc">~</span> fert_time <span class="sc">+</span> fert_amount <span class="sc">+</span> fert_time<span class="sc">:</span>fert_amount <span class="sc">+</span> block <span class="sc">|</span> block, </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> broc_tbl)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>broc_3_fit <span class="ot">&lt;-</span> <span class="fu">betareg</span>(proportion <span class="sc">~</span> fert_time <span class="sc">+</span> fert_amount <span class="sc">+</span> fert_time<span class="sc">:</span>fert_amount <span class="sc">+</span> block <span class="sc">|</span> </span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>                      fert_time <span class="sc">+</span> fert_amount <span class="sc">+</span> block, </span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> broc_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Ich nutze jetzt wieder das AIC um zu entscheiden welches Modell das beste Modell ist. Dabei gilt, dass ein niedrigeres AIC immer besser ist. Im zweiten Schritt sind die absoluten Zahlen irrelevant, mich interessiert nur die Differenz der AIC-Werte. Dabei ist ein Modell mit einem Unterschied von <span class="math inline">\(2\)</span> oder größer vorzuziehen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>AIC_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Modell 1"</span><span class="ot">=</span> <span class="fu">AIC</span>(broc_1_fit), </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Modell 2"</span> <span class="ot">=</span> <span class="fu">AIC</span>(broc_2_fit), </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Modell 3"</span> <span class="ot">=</span> <span class="fu">AIC</span>(broc_3_fit))</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">outer</span>(AIC_vec, AIC_vec, <span class="st">"-"</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         Modell 1 Modell 2 Modell 3
Modell 1     0.00     3.22    -0.17
Modell 2    -3.22     0.00    -3.40
Modell 3     0.17     3.40     0.00</code></pre>
</div>
</div>
<p>Wir sehen, dass das Modell 2 <code>broc_2_fit</code> besser ist als das Modell 1. Daher bevorzugen wir das Modell 2. Dann kriegen wir aber keine Verbesserung mehr hin und deshalb bleiben wir bei dem zweiten Modell. Jetzt können wir dann einmal die ANOVA rechnen und schauen, welche signifikante Effekte wir in den Daten haben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>broc_2_fit <span class="sc">|&gt;</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter             |  Chi2 | df |      p
-------------------------------------------
fert_time             |  0.31 |  1 | 0.576 
fert_amount           |  5.23 |  2 | 0.073 
block                 | 35.81 |  3 | &lt; .001
fert_time:fert_amount |  3.86 |  2 | 0.145 

Anova Table (Type 2 tests)</code></pre>
</div>
</div>
<p>Ärgerlicherweise sind unsere beiden Behandlungsfaktoren gar nicht signifikant sondern unsere Blöcke. Dann werden wir uns wohl die Blöcke einmal anschauen müssen. Ich entscheide mich mal über den Zeitpunkt der Düngegabe zu mitteln, den der Effekt des Zeitpunktes ist wirklich nicht signifikant.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="ot">&lt;-</span> broc_2_fit <span class="sc">|&gt;</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> fert_amount <span class="sc">*</span> block) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Mit dem <code>emm_obj</code> können wir dann uns das <em>compact letter display</em> berechnen lassen. Wir haben hier als Effekt die mittleren Prozente in der Spalte <code>emmean</code>. Also wie viel Prozent der Brokkoliköpfe untergewichtig sind. Ich adjustiere hier dann noch die <span class="math inline">\(p\)</span>-Werte nach Bonferroni.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>emm_cld <span class="ot">&lt;-</span> emm_obj <span class="sc">|&gt;</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der <a href="#fig-bar-beta-broc" class="quarto-xref">Abbildung&nbsp;<span>56.7</span></a> siehst du die Barplots der mittleren Prozente des errichten Zielgewichtes der Brokkoliköpfe für die Düngemenge und die vier Blöcke. Wie du sehen kannst unterscheiden sich die Blöcke stärker untereinander als die Level der Düngemenge. Wie viel Prozent an untergewichtigen Brokkoli du also anteilig erhälst liegt mehr an dem Standort des Blocks als an der Behandlung mit Dünger. Irgendwie dann auch ein spannendes Ergebnis. Ich nutze hier den Standardfehler als Fehlerbalken, da die Standardabweichung eventuell über die Grenze von Eins steigen würde, was bei Prozenten und Anteilen wenig Sinn ergibt.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>emm_cld <span class="sc">|&gt;</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> fert_amount, <span class="at">y =</span> emmean, <span class="at">fill =</span> block)) <span class="sc">+</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"[%] erreichtes Zielgewicht"</span>, <span class="at">x =</span> <span class="st">"Düngemenge [mg/l]"</span>,</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Block"</span>) <span class="sc">+</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.7</span>,</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">str_trim</span>(.group), <span class="at">y =</span> emmean <span class="sc">+</span> SE <span class="sc">+</span> <span class="fl">0.01</span>),  </span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>SE, <span class="at">ymax =</span> emmean<span class="sc">+</span>SE),</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>,  </span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-bar-beta-broc" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bar-beta-broc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-beta_files/figure-html/fig-bar-beta-broc-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Abbildung&nbsp;56.7— Säulendigramm der mittleren Prozente der untergewichtigen Brokkoli aus einer Beta Regression. Das betareg()-Modell berechnet das mittleren Prozente des Brokkoli in jeder Faktorkombination. Das compact letter display wird dann in {emmeans} generiert. Wir nutzen hier den Standardfehler, da die Standardabweichung mit der großen Fallzahl rießig wäre."><img src="stat-modeling-beta_files/figure-html/fig-bar-beta-broc-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bar-beta-broc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;56.7— Säulendigramm der mittleren Prozente der untergewichtigen Brokkoli aus einer Beta Regression. Das <code>betareg()</code>-Modell berechnet das mittleren Prozente des Brokkoli in jeder Faktorkombination. Das <em>compact letter display</em> wird dann in <code>{emmeans}</code> generiert. Wir nutzen hier den Standardfehler, da die Standardabweichung mit der großen Fallzahl rießig wäre.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="pilze-auf-weizen" class="level3" data-number="56.5.2">
<h3 data-number="56.5.2" class="anchored" data-anchor-id="pilze-auf-weizen"><span class="header-section-number">56.5.2</span> Pilze auf Weizen</h3>
<p>Unser zweites Beispiel ist wirklich schwierig auszuwerten, da wir so viele Faktoren vorliegen haben. Zum einen haben wir als Faktor der Weizenlinien zehn genetische Linien vorliegen. Dann schauen wir uns auch noch zwanzig Pilzarten an. Das funktioniert dann hier als Demonstration nicht mehr. In der Realität würdest du dir dann auch Linien oder Pilzarten raussuchen, die sich interessieren und nicht wild hier Abbildungen produzieren. Wenn du alle Faktoren mit in die Modelle nimmst, siehst du wirklich gar nichts mehr. Vertraue mir, ich habe das <em>compact letter display</em> bis zum Buchstaben <span class="math inline">\(z\)</span> mit diesem Beispiel ausgereizt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>fungi_tbl <span class="ot">&lt;-</span> fungi_tbl <span class="sc">|&gt;</span> </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bunt <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"B1"</span>, <span class="st">"B12"</span>, <span class="st">"B157"</span>, <span class="st">"B51"</span>, <span class="st">"B189"</span>, <span class="st">"B4"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gen <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Oro"</span>, <span class="st">"Albit"</span>, <span class="st">"Turkey"</span>, <span class="st">"Hybrid128"</span>)) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Mit unserem reduzierten Datensatz können wir dann einmal unsere Beta Regression rechnen. Ich nehme hier mal keinen gesonderten Varianzterm an, einfach um das Beispiel etwas kürzer zu halten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>fungi_fit <span class="ot">&lt;-</span> <span class="fu">betareg</span>(percent <span class="sc">~</span> gen <span class="sc">+</span> bunt <span class="sc">+</span> gen<span class="sc">:</span>bunt, <span class="at">data =</span> fungi_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir auch schon die ANOVA rechnen. Hier hilft die ANOVA wirklich mal einen schnellen Überblick über die Daten zu erhalten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>fungi_fit <span class="sc">|&gt;</span> </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter |   Chi2 | df |      p
--------------------------------
gen       | 416.57 |  3 | &lt; .001
bunt      | 155.99 |  5 | &lt; .001
gen:bunt  | 284.37 | 15 | &lt; .001

Anova Table (Type 2 tests)</code></pre>
</div>
</div>
<p>Wir sehen, dass wir auf jeden Fall einen Effekt der Weizenlinie wie auch der Pilzart haben. Leider haben wir auch eine signifikante Interaktion, so dass ich die Daten dann für die Faktoren getrennt auswerten werde. Wir nutzen dann das Objekt auch gleich um das <em>compact letter display</em> zu erstellen. Mehr geht dann natürlich immer, aber da schaue doch mal in das <a href="stat-tests-posthoc2.html">Kapitel zu den multiplen Vergleichen und dem Posthoc Test</a> rein.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="ot">&lt;-</span> fungi_fit <span class="sc">|&gt;</span> </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> gen <span class="sc">|</span> bunt) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Im Folgenden einmal der Code für das <em>compact letter display</em>. Ich zeige auch hier die Ausgabe nur einmal als <code>tibble</code> damit die Ausgabe nicht so lang wird. Wir sehen dann gleich mal den mittleren Pilzbefall pro Linie und Pilzart. Es sind wirklich viele Ergebnisse für die Vergleiche, da wir wirklich viele Level der Faktorkombination haben. Irgendwann ist dann auch das <em>compact letter display</em> am Ende.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>emm_cld <span class="ot">&lt;-</span> emm_obj <span class="sc">|&gt;</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters) <span class="sc">|&gt;</span> </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>emm_cld</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 24 × 8
   gen       bunt   emmean      SE    df asymp.LCL asymp.UCL .group
   &lt;fct&gt;     &lt;fct&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt; 
 1 Albit     B1    0.00731 0.00499   Inf -0.00247     0.0171 " a  "
 2 Oro       B1    0.0109  0.00708   Inf -0.00293     0.0248 " a  "
 3 Turkey    B1    0.0835  0.0272    Inf  0.0302      0.137  "  b "
 4 Hybrid128 B1    0.832   0.0378    Inf  0.758       0.907  "   c"
 5 Oro       B51   0.0186  0.0107    Inf -0.00246     0.0396 " a  "
 6 Albit     B51   0.0250  0.0133    Inf -0.000979    0.0511 " a  "
 7 Turkey    B51   0.254   0.0445    Inf  0.167       0.341  "  b "
 8 Hybrid128 B51   0.941   0.0226    Inf  0.896       0.985  "   c"
 9 Oro       B4    0.0418  0.0185    Inf  0.00565     0.0780 " a " 
10 Albit     B4    0.0906  0.0283    Inf  0.0350      0.146  " a " 
# ℹ 14 more rows</code></pre>
</div>
</div>
<p>In der <a href="#fig-bar-beta-fungi" class="quarto-xref">Abbildung&nbsp;<span>56.8</span></a> siehst du einmal das sehr heterogene Ergebnis. Wir haben teilweise Weizenarten mit einem sehr starken Pilzbefall und teilweise dann mit gar keinem Pilzbefall. Das Ganze ist dann auch immer abhängig von der Art des Pilzes und dann der befallenen Linie. Wir haben hier eben eine klassische Interaktion vorliegen. Hier habe ich mich dann auch für den Standardfehler für die Fehlerbalken entschieden, da die Standardabweichung eventuell über die Eins hinausgeht.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>emm_cld <span class="sc">|&gt;</span> </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> bunt, <span class="at">y =</span> emmean, <span class="at">fill =</span> gen)) <span class="sc">+</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"[%] infiziert"</span>, <span class="at">x =</span> <span class="st">"Art des Pilzes"</span>,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Genetische Linie"</span>) <span class="sc">+</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.7</span>,</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">str_trim</span>(.group), <span class="at">y =</span> emmean <span class="sc">+</span> SE <span class="sc">+</span> <span class="fl">0.01</span>),  </span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>SE, <span class="at">ymax =</span> emmean<span class="sc">+</span>SE),</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>,  </span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-bar-beta-fungi" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bar-beta-fungi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-beta_files/figure-html/fig-bar-beta-fungi-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Abbildung&nbsp;56.8— Säulendigramm des mittleren Pilzbefalls von Weizen durch verschiedene Pilzarten. Das betareg()-Modell berechnet den mittleren Pilzbefall in jeder Faktorkombination. Das compact letter display wird dann in {emmeans} generiert. Wir nutzen hier den Standardfehler, da die Standardabweichung mit der großen Fallzahl rießig wäre."><img src="stat-modeling-beta_files/figure-html/fig-bar-beta-fungi-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bar-beta-fungi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;56.8— Säulendigramm des mittleren Pilzbefalls von Weizen durch verschiedene Pilzarten. Das <code>betareg()</code>-Modell berechnet den mittleren Pilzbefall in jeder Faktorkombination. Das <em>compact letter display</em> wird dann in <code>{emmeans}</code> generiert. Wir nutzen hier den Standardfehler, da die Standardabweichung mit der großen Fallzahl rießig wäre.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="referenzen" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="referenzen">Referenzen</h2>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-burnham2004multimodel" class="csl-entry" role="listitem">
Burnham, K. P., &amp; Anderson, D. R. (2004). Multimodel inference: understanding AIC and BIC in model selection. <em>Sociological methods &amp; research</em>, <em>33</em>(2), 261–304.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./stat-modeling-poisson.html" class="pagination-link" aria-label="Poisson Regression">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./stat-modeling-multinom.html" class="pagination-link" aria-label="Multinomiale / Ordinale Regression">
        <span class="nav-page-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale Regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Quellcode</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb67" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = FALSE}</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, readxl, knitr, kableExtra, patchwork)</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="fu"># Beta Regression {#sec-beta}</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>*Letzte Änderung am `r format(fs::file_info("stat-modeling-beta.qmd")$modification_time, '%d. %B %Y um %H:%M:%S')`*</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>Die Beta Regression. Zuerst ein seltsamer Name, was heißt denn jetzt hier Beta? Und was macht die beta Regression eigentlich? Die Beta Regression beschäftigt sich mit einem prozentualen Outcome und damit mit einem Outcome $y$ welches zwischen 0 und 1 liegt. Dabei ist das *Zwischen* sehr wichtig. Weder dürfen einzelne Beobachtungen einen Wert von 1 haben noch einen Wert von 0. Dabei ist die Null weit schlimmer, so dass wir hier gerne einen kleinen Betrag auf alle 0 addieren um dann aus dem Schneider zu sein. Sonst ist unser Outcome dadurch gekennzeichnet, dass wir meistens die Wahrscheinlichkeit oder Anteil für ein Ereignis abgebildet haben. Wie oft tritt eine Klauensuche in einem Stall auf? Welchen Anteil machen faulige Erdbeeren aus? Und um auf die Frage vom Anfang zurückzukommen, ein prozentuales Outcome folgt einer Betaverteilung. Deshalb nutzen wir eine Beta Regression um prozentuale Outcomes auszuwerten.</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="fu">## Moment, ich möchte aber nur zwei Wahrscheinlichkeiten $p_1$ und $p_2$ vergleichen!</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>Wenn du nur wissen willst, ob sich zwei Wahrscheinlichkeiten unterscheiden, dann musst du einmal in dem Kapitel <span class="co">[</span><span class="ot">Vergleich zweier Anteile $p_1$ und $p_2$</span><span class="co">](#sec-chisquare-prop-test)</span> nachschauen. Dort zeige ich dir wie du dann einen statistischen Test rechnen kannst um rauszufinden ob sich $0.5$ signifikant von $0.7$ unterscheidet. In diesem Kapitel schauen wir uns dann pro Faktor sehr viele Wahrscheinlichkeiten als Outcome an.</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>Teilweise sind diese Arten von Daten, die einer Betaverteilung folgen, eher selten in den Agrawissenschaften. Wir müssen nämlich sehr viele Daten generieren um Prozente zu berechnen. Prozente sind ja immer Anteile an irgendwas. Und so müssen wir dann eine Menge Tiere oder Pflanzen zählen, damit wir auch wirklich eine gute Auflösung kriegen. Wenn du zum Beispiel eine Auflösung von 1% erhalten willst, dann musst du auch einhundert Tiere untersuchen und dann bestimmen wie groß der Anteil an deinem untersuchten Outcome ist. So kann es dann passieren, dass sehr viele Untersuchungen in einer einzigen Zahl förmlich verschwinden. Deshalb werden dann häufig die Anzahlen direkt als Poisson Regression ausgewertet. Aber wie immer gilt, selten ist nicht nie. Deshalb einmal hier die Beta Regression für ein prozentuales Outcome.</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a><span class="fu">## Weitere Tutorien für die Beta Regression</span></span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>Wie immer gibt es auch für die Frage nach dem Tutorium für die Beta Regression verschiedene Quellen. Ich kann noch folgende Informationen und Hilfen empfehlen.</span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">A guide to modeling proportions with Bayesian beta and zero-inflated beta regression models</span><span class="co">](https://www.andrewheiss.com/blog/2021/11/08/beta-regression-guide)</span> hilft besonders, wenn du tiefer in die Matrie einsteigen willst. Du erhälst bei dem Tutorium einen vollständigen Überblick über die Möglichkeiten. Weit mehr als ich hier mache.</span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Das Tutorium <span class="co">[</span><span class="ot">Beta Regression for Percent and Proportion Data</span><span class="co">](https://rcompanion.org/handbook/J_02.html)</span> leidet etwas unter dem Mangel an erklärenden Text. Hier wurde anscheinend erst der R Code generiert und der Text sollte folgen. Das schneit hier aber (noch) nicht der Fall zu sein. Als Überblick lohnt sich das Tutorium aber dennoch.</span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">What is the intuition behind beta distribution?</span><span class="co">](https://stats.stackexchange.com/questions/47771/what-is-the-intuition-behind-beta-distribution)</span> erklärt nochmal was die Idee der Beta Regression eigentlich ist und was eine Betaverteilung eigentlich beschreibt.</span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Das R Paket <span class="in">`{betareg}`</span> und die entsprechende Vignette <span class="co">[</span><span class="ot">Beta Regression in R</span><span class="co">](https://cran.r-project.org/web/packages/betareg/vignettes/betareg.pdf)</span> liefert wichtige Informationen über die Umsetzung der Beta Regression in R.</span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Causal inference with beta regression</span><span class="co">](https://solomonkurz.netlify.app/blog/2023-06-25-causal-inference-with-beta-regression/)</span> liefert eine sehr umfangreiche Überbick über die Beta Regression und das Testen mit der ANOVA. Dann aber auch nicht in dem klassischen Ansatz, den ich hier normalerweise rechne, sondern als bayesianische Variante.</span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Genauso betrachtet das Tutorium <span class="co">[</span><span class="ot">Model Estimation by Example - Bayesian Beta Regression</span><span class="co">](https://m-clark.github.io/models-by-example/bayesian-beta-regression.html)</span> auch die bayesianische Variante der Beta Regression, so dass du hier vermutlich eher weniger fündig wirst. Ich fand den Überblick aber gut und schön zu lesen -- vorallem war er auch nicht so lang.</span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a><span class="fu">## Genutzte R Pakete</span></span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = TRUE}</span></span>
<span id="cb67-37"><a href="#cb67-37" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb67-38"><a href="#cb67-38" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, magrittr, broom, betareg, car,</span></span>
<span id="cb67-39"><a href="#cb67-39" aria-hidden="true" tabindex="-1"></a><span class="in">               see, performance, parameters, agridat, mfp,</span></span>
<span id="cb67-40"><a href="#cb67-40" aria-hidden="true" tabindex="-1"></a><span class="in">               emmeans, multcomp, rcompanion, ggbeeswarm,</span></span>
<span id="cb67-41"><a href="#cb67-41" aria-hidden="true" tabindex="-1"></a><span class="in">               marginaleffects, nls.multstart, conflicted)</span></span>
<span id="cb67-42"><a href="#cb67-42" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::summarise)</span></span>
<span id="cb67-43"><a href="#cb67-43" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::select)</span></span>
<span id="cb67-44"><a href="#cb67-44" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::filter)</span></span>
<span id="cb67-45"><a href="#cb67-45" aria-hidden="true" tabindex="-1"></a><span class="in">cb_pal &lt;- c("#000000", "#E69F00", "#56B4E9", "#009E73", </span></span>
<span id="cb67-46"><a href="#cb67-46" aria-hidden="true" tabindex="-1"></a><span class="in">            "#F0E442", "#0072B2", "#D55E00", "#CC79A7")</span></span>
<span id="cb67-47"><a href="#cb67-47" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-48"><a href="#cb67-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-49"><a href="#cb67-49" aria-hidden="true" tabindex="-1"></a>An der Seite des Kapitels findest du den Link *Quellcode anzeigen*, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</span>
<span id="cb67-50"><a href="#cb67-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-51"><a href="#cb67-51" aria-hidden="true" tabindex="-1"></a><span class="fu">## Daten</span></span>
<span id="cb67-52"><a href="#cb67-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-53"><a href="#cb67-53" aria-hidden="true" tabindex="-1"></a>Wie immer schauen wir uns verschiedene Datensätze an, Visualisieren die Zusammenhänge und rechnen dann verschiedene Modelle, die passen könnten. Beginnen möchte ich mit einem Datensatz zu dem Jagederfolg in <span class="sc">\[</span>%<span class="sc">\]</span> von Schneefüchsen in verschiedenen Habitaten. Die Daten sind etwas gekürzt, wir haben nur den Jagederfolg und keine Informationen zu den Habitaten. Des Weiteren wollen wir schauen, ob der Jagderfolg der Eisfüche von der standardisierten Schneehöhe in <span class="sc">\[</span>cm<span class="sc">\]</span> abhängt. Wir haben hier mehr oder minder die Schneehöhe in dem Habit gemittelt. Der Eisfuchs jagt ja nicht immer an der perfekt gleichen Stelle, wo wir die Schneehöhe kennen.</span>
<span id="cb67-54"><a href="#cb67-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-57"><a href="#cb67-57" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-58"><a href="#cb67-58" aria-hidden="true" tabindex="-1"></a>hunting_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/hunting_fox.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb67-59"><a href="#cb67-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proportion =</span> <span class="fu">round</span>(success<span class="sc">/</span>attempts, <span class="dv">2</span>))</span>
<span id="cb67-60"><a href="#cb67-60" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-61"><a href="#cb67-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-62"><a href="#cb67-62" aria-hidden="true" tabindex="-1"></a>In der @tbl-beta-fox siehst du einen Auszug aus den Daten. Wir haben die Schneehöhe gemessen und geschaut von wie vielen Anläufen <span class="in">`attempts`</span> eine Maus unter dem Schnee zu fangen erfolgreich war <span class="in">`success`</span> oder eben ein Fehlschlag <span class="in">`fail`</span>. Daraud haben wir dann die Erfolgsrate <span class="in">`proportion`</span> berechnet. Wir haben einfach den Anteil der Erfolge eine Maus zu fangen an den gesamten Versuchen berechnet.</span>
<span id="cb67-63"><a href="#cb67-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-66"><a href="#cb67-66" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-67"><a href="#cb67-67" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb67-68"><a href="#cb67-68" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb67-69"><a href="#cb67-69" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb67-70"><a href="#cb67-70" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-beta-fox</span></span>
<span id="cb67-71"><a href="#cb67-71" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Auszug aus den Daten zu dem Jagderfolg in [%] von Eisfüchsen in abhängigkeit von der Schneehöhe in [cm]."</span></span>
<span id="cb67-72"><a href="#cb67-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-73"><a href="#cb67-73" aria-hidden="true" tabindex="-1"></a>hunting_raw_tbl <span class="ot">&lt;-</span> hunting_tbl <span class="sc">|&gt;</span> </span>
<span id="cb67-74"><a href="#cb67-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(as.character)</span>
<span id="cb67-75"><a href="#cb67-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-76"><a href="#cb67-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-77"><a href="#cb67-77" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(hunting_raw_tbl, <span class="dv">4</span>),</span>
<span id="cb67-78"><a href="#cb67-78" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(hunting_raw_tbl)),</span>
<span id="cb67-79"><a href="#cb67-79" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(hunting_raw_tbl, <span class="dv">4</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb67-80"><a href="#cb67-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb67-81"><a href="#cb67-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-82"><a href="#cb67-82" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-83"><a href="#cb67-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-84"><a href="#cb67-84" aria-hidden="true" tabindex="-1"></a>Im Weiteren schauen wir uns einen Datensatz zu Brokkoli an. Wir wollen hier einmal schauen, ob wir das Zielgewicht von $500g$ erreichen. Wir sind aber daran interessiert die Rate von untergewichtigen Brokkoli möglichst klein zu halten. Deshalb schauen wir uns in dieser Auswertung den Anteil von Brokkoli unter der Zielmarke von $500g$ für zwei Düngezeitpunkte sowie drei Düngestufen an. Wir müssen hier jetzt die Daten etwas mehr aufbereiten, da wir mehr Informationen in den Daten haben als wir wirklich brauchen.</span>
<span id="cb67-85"><a href="#cb67-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-88"><a href="#cb67-88" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-89"><a href="#cb67-89" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb67-90"><a href="#cb67-90" aria-hidden="true" tabindex="-1"></a>broc_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/broccoli_weight.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb67-91"><a href="#cb67-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fert_time <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"early"</span>, <span class="st">"late"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb67-92"><a href="#cb67-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fert_time =</span> <span class="fu">factor</span>(fert_time, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"early"</span>, <span class="st">"late"</span>)),</span>
<span id="cb67-93"><a href="#cb67-93" aria-hidden="true" tabindex="-1"></a>         <span class="at">fert_amount =</span> <span class="fu">as_factor</span>(fert_amount),</span>
<span id="cb67-94"><a href="#cb67-94" aria-hidden="true" tabindex="-1"></a>         <span class="at">block =</span> <span class="fu">as_factor</span>(block)) <span class="sc">|&gt;</span></span>
<span id="cb67-95"><a href="#cb67-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(fert_time, fert_amount, block, weight) <span class="sc">|&gt;</span> </span>
<span id="cb67-96"><a href="#cb67-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(weight <span class="sc">&lt;</span> <span class="dv">500</span>) <span class="sc">|&gt;</span> </span>
<span id="cb67-97"><a href="#cb67-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proportion =</span> weight<span class="sc">/</span><span class="dv">500</span>) <span class="sc">|&gt;</span> </span>
<span id="cb67-98"><a href="#cb67-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>weight)</span>
<span id="cb67-99"><a href="#cb67-99" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-100"><a href="#cb67-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-101"><a href="#cb67-101" aria-hidden="true" tabindex="-1"></a>In der @tbl-beta-broc siehst du einmal den Auszug aus den Brokkolidaten. Wir wollen jetzt sehen, ob wir in den Behandlungsfaktoren einen Unterschied bezüglich der Anteile der untergewichtigen Brokkoliköpfe finden. Tendenziell wollen wir eine Kombination finden, die uns natürlich möglichst schwere Köpfe beschert.</span>
<span id="cb67-102"><a href="#cb67-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-105"><a href="#cb67-105" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-106"><a href="#cb67-106" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb67-107"><a href="#cb67-107" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb67-108"><a href="#cb67-108" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb67-109"><a href="#cb67-109" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-beta-broc</span></span>
<span id="cb67-110"><a href="#cb67-110" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Auszug aus dem Daten zu den Zielgewichten von Brokkoli zu zwei Düngezeitpunkten und drei Düngestufen."</span></span>
<span id="cb67-111"><a href="#cb67-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-112"><a href="#cb67-112" aria-hidden="true" tabindex="-1"></a>broc_raw_tbl <span class="ot">&lt;-</span> broc_tbl <span class="sc">|&gt;</span> </span>
<span id="cb67-113"><a href="#cb67-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(as.character)</span>
<span id="cb67-114"><a href="#cb67-114" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-115"><a href="#cb67-115" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(broc_raw_tbl, <span class="dv">4</span>),</span>
<span id="cb67-116"><a href="#cb67-116" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(broc_raw_tbl)),</span>
<span id="cb67-117"><a href="#cb67-117" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(broc_raw_tbl, <span class="dv">4</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb67-118"><a href="#cb67-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb67-119"><a href="#cb67-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-120"><a href="#cb67-120" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-121"><a href="#cb67-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-122"><a href="#cb67-122" aria-hidden="true" tabindex="-1"></a>Abschließend schauen wir nochmal in das R Paket <span class="in">`{agridat}`</span> und nehmen von dort den Datensatz <span class="in">`salmon.bunt`</span> welcher eine Pilzinfektion von Weizenlinien beschreibt. Mehr dazu dann auf der Hilfeseite <span class="co">[</span><span class="ot">Fungus infection in varieties of wheat</span><span class="co">](https://kwstat.github.io/agridat/reference/salmon.bunt.html)</span> in der Vignette zum R Paket. Ich möchte später die Faktoren <span class="in">`gen`</span> für die genetischen Linien und die Pilzarten <span class="in">`bunt`</span> für die Anteile der Pilzinfektionen sortiert haben. Das mache ich dann einmal mit der Funktion <span class="in">`fct_reorder()`</span> welche mir erlaubt einen Faktor nach einer anderen Variable zu sortieren. Wir haben zwei Wiederholungen <span class="in">`rep`</span>, die auch so nicht helfen. Deshalb mittlere ich mit <span class="in">`summarise()`</span> über die beiden Wiederholungen die Prozente der Pilzinfektionen des Weizen.</span>
<span id="cb67-123"><a href="#cb67-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-126"><a href="#cb67-126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-127"><a href="#cb67-127" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb67-128"><a href="#cb67-128" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb67-129"><a href="#cb67-129" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(salmon.bunt)</span>
<span id="cb67-130"><a href="#cb67-130" aria-hidden="true" tabindex="-1"></a>fungi_tbl <span class="ot">&lt;-</span> salmon.bunt <span class="sc">|&gt;</span> </span>
<span id="cb67-131"><a href="#cb67-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb67-132"><a href="#cb67-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gen, bunt, rep, <span class="at">percent =</span> pct) <span class="sc">|&gt;</span> </span>
<span id="cb67-133"><a href="#cb67-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gen =</span> <span class="fu">fct_reorder</span>(gen, percent),</span>
<span id="cb67-134"><a href="#cb67-134" aria-hidden="true" tabindex="-1"></a>         <span class="at">bunt =</span> <span class="fu">fct_reorder</span>(bunt, percent),</span>
<span id="cb67-135"><a href="#cb67-135" aria-hidden="true" tabindex="-1"></a>         <span class="at">percent =</span> percent<span class="sc">/</span><span class="dv">100</span> <span class="sc">+</span> <span class="fl">0.001</span>) </span>
<span id="cb67-136"><a href="#cb67-136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-137"><a href="#cb67-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-138"><a href="#cb67-138" aria-hidden="true" tabindex="-1"></a>In der @tbl-beta-fungi siehst du dann einmal den Auszug aus unseren Weizendaten mit einer Pilzinfektion. Wir haben 10 genetische Linien sowie 20 Pilzarten vorliegen. Daher ist der Datensatz ziemlich groß, was die Möglichkeiten der Faktorkombinationen angeht.</span>
<span id="cb67-139"><a href="#cb67-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-142"><a href="#cb67-142" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-143"><a href="#cb67-143" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb67-144"><a href="#cb67-144" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb67-145"><a href="#cb67-145" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb67-146"><a href="#cb67-146" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-beta-fungi</span></span>
<span id="cb67-147"><a href="#cb67-147" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Auszug aus dem Daten zu den zehn Weizenlinien und den zwanzig Pilzarten. Es wurde der Anteil an infizierten Weizen [%] gemessen."</span></span>
<span id="cb67-148"><a href="#cb67-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-149"><a href="#cb67-149" aria-hidden="true" tabindex="-1"></a>fungi_raw_tbl <span class="ot">&lt;-</span> fungi_tbl <span class="sc">|&gt;</span> </span>
<span id="cb67-150"><a href="#cb67-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(as.character) </span>
<span id="cb67-151"><a href="#cb67-151" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-152"><a href="#cb67-152" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(fungi_raw_tbl, <span class="dv">4</span>),</span>
<span id="cb67-153"><a href="#cb67-153" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(fungi_raw_tbl)),</span>
<span id="cb67-154"><a href="#cb67-154" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(fungi_raw_tbl, <span class="dv">4</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb67-155"><a href="#cb67-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb67-156"><a href="#cb67-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-157"><a href="#cb67-157" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-158"><a href="#cb67-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-159"><a href="#cb67-159" aria-hidden="true" tabindex="-1"></a>Damit habe wir dann einige spannende Datensätze vorliegen, die wir nutzen können um die verschiedenen Aspekte der Beta Regression anzuschauen. Nicht immer muss es ja eine Beta Regression sein, wir haben auch die Möglichkeit unsere Fragestellung mit anderen Modellen eventuell anders oder gar besser zu beantworten.</span>
<span id="cb67-160"><a href="#cb67-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-161"><a href="#cb67-161" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualisierung</span></span>
<span id="cb67-162"><a href="#cb67-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-163"><a href="#cb67-163" aria-hidden="true" tabindex="-1"></a>Auch hier beginnen wir einmal mit der Visualisierung der Daten. Zuerst schauen wir uns einmal die Daten zu dem Jagderfolg der Eisfüchse in verschiedenen Habitaten in Abhängigkeit zu der Schneehöhe an. Wenn der Schnee zu hoch liegt, werden die Füchse weniger Jagderfolg haben. In der @fig-beta-fox-scatter sehen wir einmal den Jagerfolg von der Schneehöhe aufgetragen. Wir erkennen, dass wir zwar anfänglich eher einen linearen Zusammenhang haben könnten, aber bei höheren Schneedichten dann sehr schnell einen Abfall des Jagderfolges beobachten. Wir schauen uns dann gleich mal verschiedene Modelle an um eine Kurve durch die Punkte zu legen.</span>
<span id="cb67-164"><a href="#cb67-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-167"><a href="#cb67-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-168"><a href="#cb67-168" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb67-169"><a href="#cb67-169" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb67-170"><a href="#cb67-170" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-beta-fox-scatter</span></span>
<span id="cb67-171"><a href="#cb67-171" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb67-172"><a href="#cb67-172" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb67-173"><a href="#cb67-173" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb67-174"><a href="#cb67-174" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Zusammenhang zwischen dem Jagederfolg von Eisfüchsen und der Schneehöhe in den jeweiligen beobachteten Habitaten."</span></span>
<span id="cb67-175"><a href="#cb67-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-176"><a href="#cb67-176" aria-hidden="true" tabindex="-1"></a>hunting_tbl <span class="sc">|&gt;</span> </span>
<span id="cb67-177"><a href="#cb67-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(snow_height, proportion)) <span class="sc">+</span></span>
<span id="cb67-178"><a href="#cb67-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb67-179"><a href="#cb67-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb67-180"><a href="#cb67-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Jagderfolg [%]"</span>, <span class="at">x =</span> <span class="st">"Standardisierte Schneehöhe [cm]"</span>) <span class="sc">+</span></span>
<span id="cb67-181"><a href="#cb67-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb67-182"><a href="#cb67-182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-183"><a href="#cb67-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-184"><a href="#cb67-184" aria-hidden="true" tabindex="-1"></a>In der @fig-beta-broc sehen wir einmal die Verteilung unser untergewichtigen Brokkoli für die beiden Düngezeitpunkte und Düngemengen. Wir könnten annehmen, dass wir tendenziell bei einer höheren Düngemenge einen größeren Anteil an erreichtem Zielgewicht erhalten. Global betrachtet scheint es aber nicht so große Effekte zu geben. Wir schauen uns diese Beispiel dann einmal für den Gruppenvergleich an.</span>
<span id="cb67-185"><a href="#cb67-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-188"><a href="#cb67-188" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-189"><a href="#cb67-189" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb67-190"><a href="#cb67-190" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb67-191"><a href="#cb67-191" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-beta-broc</span></span>
<span id="cb67-192"><a href="#cb67-192" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb67-193"><a href="#cb67-193" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb67-194"><a href="#cb67-194" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb67-195"><a href="#cb67-195" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Zusammenhang zwischen erreichten Zielgewicht von $500g$ bei Brokkoli [%] und der Düngermenge sowiw dem Düngezeitpunkt."</span></span>
<span id="cb67-196"><a href="#cb67-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-197"><a href="#cb67-197" aria-hidden="true" tabindex="-1"></a>broc_tbl <span class="sc">|&gt;</span> </span>
<span id="cb67-198"><a href="#cb67-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> fert_amount, <span class="at">y =</span> proportion, <span class="at">color =</span> fert_time)) <span class="sc">+</span></span>
<span id="cb67-199"><a href="#cb67-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb67-200"><a href="#cb67-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"[%] erreichtes Zielgewicht"</span>, <span class="at">x =</span> <span class="st">"Düngemenge [mg/l]"</span>,</span>
<span id="cb67-201"><a href="#cb67-201" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Düngezeitpunkt"</span>) <span class="sc">+</span></span>
<span id="cb67-202"><a href="#cb67-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb67-203"><a href="#cb67-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>(<span class="at">dodge.width =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb67-204"><a href="#cb67-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb67-205"><a href="#cb67-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span>
<span id="cb67-206"><a href="#cb67-206" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-207"><a href="#cb67-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-208"><a href="#cb67-208" aria-hidden="true" tabindex="-1"></a>Abschließend schauen wir uns in der @fig-beta-fungi die Heatmap der genetischen Linien und der Art des Pilzes an. Ich habe die Heatmap so erstellt, dass eine viel Infektion rot dargestellt wird und wenig Infektion blau. Durch die Sortierung der Faktoren nach dem Infektionsgrad können wir sehr schön die Linien voneinander unterscheiden. Teilweise werden einige Linien von dem Pilz förmlich aufgefressen während andere Weizenlinien kaum befallen werden. Auch scheinen einige Arten des Pilzen mehr Weizenlinien befallen zu können als andere Pilzarten. So ist die Pilzart B189 extrem erfolgreich bei einer großen Anzahl an Linien. Die Art B1 hingegen kann mehr oder minder nur zwei Weizensorten befallen.</span>
<span id="cb67-209"><a href="#cb67-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-212"><a href="#cb67-212" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-213"><a href="#cb67-213" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb67-214"><a href="#cb67-214" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb67-215"><a href="#cb67-215" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-beta-fungi</span></span>
<span id="cb67-216"><a href="#cb67-216" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb67-217"><a href="#cb67-217" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb67-218"><a href="#cb67-218" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb67-219"><a href="#cb67-219" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Sortierte Heatmap der genetischen Linien und der Art des Pilzes. Farbig dargestellt sind die Anteile an infizierten Weizen in [%]. Nach dem Grad der Infektion wurden die Faktoren sortiert um eine bessere Übersicht zu erhalten."</span></span>
<span id="cb67-220"><a href="#cb67-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-221"><a href="#cb67-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-222"><a href="#cb67-222" aria-hidden="true" tabindex="-1"></a>fungi_tbl <span class="sc">|&gt;</span> </span>
<span id="cb67-223"><a href="#cb67-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(bunt, gen) <span class="sc">|&gt;</span> </span>
<span id="cb67-224"><a href="#cb67-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">percent =</span> <span class="fu">mean</span>(percent)) <span class="sc">|&gt;</span> </span>
<span id="cb67-225"><a href="#cb67-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gen, <span class="at">y =</span> bunt, <span class="at">fill =</span> percent)) <span class="sc">+</span></span>
<span id="cb67-226"><a href="#cb67-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb67-227"><a href="#cb67-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb67-228"><a href="#cb67-228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"#375997"</span>, <span class="st">"gray"</span>, <span class="st">"firebrick"</span>),</span>
<span id="cb67-229"><a href="#cb67-229" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>), </span>
<span id="cb67-230"><a href="#cb67-230" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb67-231"><a href="#cb67-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Art des Pilzes"</span>, <span class="at">x =</span> <span class="st">"Genetische Linie des Weizens"</span>,</span>
<span id="cb67-232"><a href="#cb67-232" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"[%] infiziert"</span>)</span>
<span id="cb67-233"><a href="#cb67-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-234"><a href="#cb67-234" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-235"><a href="#cb67-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-236"><a href="#cb67-236" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fit des Modells</span></span>
<span id="cb67-237"><a href="#cb67-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-238"><a href="#cb67-238" aria-hidden="true" tabindex="-1"></a>Dann haben wir jetzt unsere Daten und wissen auch grob was in den Daten stecken könnte. Jetzt wollen wir einmal die verschieden Datensätze auswerten. Je nach Fragestellung können wir da verschiedene Modelle nutzen. Wie immer stelle ich auch Alternativen zu der Beta Regression vor. Wir schauen uns zum einen eine einfache Gaussian Regression an, die passt zwar nicht so richtig zu dem Outcome, aber unter bestimmten Voraussetzungen kann die Gaussian Regression Sinn machen. Wenn wir Erfolg/Misserfolg in unseren Daten als Outcome haben, dann können wir auch eine logistische Regression rechnen. Dementsprechend zeige ich die Anwendung auch einmal auf den Eisfuchsdaten, wo wir ja wissen wie oft ein Erfolg und ein Fehlschlag vorgekommen ist.</span>
<span id="cb67-239"><a href="#cb67-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-240"><a href="#cb67-240" aria-hidden="true" tabindex="-1"></a><span class="fu">### ... mit der Gaussian Regression</span></span>
<span id="cb67-241"><a href="#cb67-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-242"><a href="#cb67-242" aria-hidden="true" tabindex="-1"></a>Fangen wir also einmal mit der etwas groben Variante an. Wir rechnen einfach eine lineare Regression unter der Annahme das unser Outcome normalverteilt ist. Das stimmt zwar nur begrenzt für eine Wahrscheinlichkeit, die zwischen 0 und 1 liegt, aber rechnen können wir ja erstmal viel. Besonders wenn du Wahrscheinlichkeiten berechnet hast, die nicht sehr viele Nullen und Einsen beinhalten sondern mehr um die 0.5 streuen, dann kann deine Auswertung auch mit einer Gaussian Regression funktionieren. Wie immer kommt es dann auf den Einzelfall an, aber die Gaussian Regression liefert dann eben auch einen sehr gut zu verstehenden und interpretierenden Effektschätzer.</span>
<span id="cb67-243"><a href="#cb67-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-244"><a href="#cb67-244" aria-hidden="true" tabindex="-1"></a>Wir wenden jetzt also einfach mal die Gaussian Regression mit der Funktion <span class="in">`lm()`</span> auf unsere Daten zu dem Jagderfolg der Eisfüchse an. Wenn du dir nochmal die @fig-beta-fox-scatter anschaust, dann siehst du, dass wir nicht so viele Beobachtungen nah der Eins und der Null haben. Darüber hinaus ist eine wage Linearität zu erkennen. Oder anderherum, die Daten sehen jetzt nicht so schlimm aus, dass wir nicht eine Gerade durch die Punkte legen könnten.</span>
<span id="cb67-245"><a href="#cb67-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-248"><a href="#cb67-248" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-249"><a href="#cb67-249" aria-hidden="true" tabindex="-1"></a>hunting_lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(proportion <span class="sc">~</span> snow_height, <span class="at">data =</span> hunting_tbl)</span>
<span id="cb67-250"><a href="#cb67-250" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-251"><a href="#cb67-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-252"><a href="#cb67-252" aria-hidden="true" tabindex="-1"></a>Dann schauen wir uns einmal die Koeffizienten des Modells einmal an. Wir haben einen <span class="in">`Intercept`</span> von über Eins, was natürlich keinen Sinn ergibt. Wir können keinen Jagederfolg von über Eins bei einer Schneehöhe von Null haben. Hier sieht man schon, dass das Modell nicht so gut für die Randbereiche funktioniert. Dennoch haben wir einen Abfall durch die Steigung der Schneehöhe vorliegen. Wir erkennen, dass pro Zentimeter mehr Schnee der Jagderfolg um $0.0156$ oder eben $1.56\%$ signifikant zurückgeht. Das ist ein Ergebnis mit dem wir leben könnten.</span>
<span id="cb67-253"><a href="#cb67-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-256"><a href="#cb67-256" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-257"><a href="#cb67-257" aria-hidden="true" tabindex="-1"></a>hunting_lm_fit </span>
<span id="cb67-258"><a href="#cb67-258" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-259"><a href="#cb67-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-260"><a href="#cb67-260" aria-hidden="true" tabindex="-1"></a>Wir können uns auch den Effekt der Schneehöhe auf den Jagderfolg einmal mit der Funktion <span class="in">`avg_slopes()`</span> aus dem R Paket <span class="in">`{marginaleffects}`</span> wiedergeben lassen. Für eine so simple Gaussion Regression ist der marginale Effekt gleich der Steigung, aber wenn wir gleich ein anderes Modell nehmen, dann wird es schon komplizierter. Mehr dazu dann auf der Hilfeseite zu <span class="co">[</span><span class="ot">Marginal Effects Zoo - Slopes</span><span class="co">](https://marginaleffects.com/vignettes/slopes.html)</span> wo du dann auch mehr über *marginal effects* lernen kannst. Wie du dann siehst, erhalten wir hier den gleichen Wert für die Steigung.</span>
<span id="cb67-261"><a href="#cb67-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-264"><a href="#cb67-264" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-265"><a href="#cb67-265" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb67-266"><a href="#cb67-266" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb67-267"><a href="#cb67-267" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_slopes</span>(hunting_lm_fit)</span>
<span id="cb67-268"><a href="#cb67-268" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-269"><a href="#cb67-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-270"><a href="#cb67-270" aria-hidden="true" tabindex="-1"></a>Schauen wir einmal wie das Bestimmtheitsmaß $R^2$ aussieht. Hier haben wir einen Wert von $0.758$ und damit können wir durch die Gerade gut $75\%$ der Varianz erklären. Das ist jetzt nicht der beste Werte und wir schauen uns am Ende nochmal in der @fig-beta-fox-predict wie die Gerade durch die Punkte läuft.</span>
<span id="cb67-271"><a href="#cb67-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-274"><a href="#cb67-274" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-275"><a href="#cb67-275" aria-hidden="true" tabindex="-1"></a>hunting_lm_fit <span class="sc">|&gt;</span> <span class="fu">r2</span>()</span>
<span id="cb67-276"><a href="#cb67-276" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-277"><a href="#cb67-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-278"><a href="#cb67-278" aria-hidden="true" tabindex="-1"></a>Das einmal als sehr schneller und kurzer Einwurf der Gaussian Regression auf einem Outcome mit Prozenten. Es ist nicht ideal und weit weg von der Empfehlung. Aber wenn du einen statistischen Engel anfahren willst und mit der Interpretation ganz gut leben kannst, dann ist eine lineare Modellierung nicht so dramatisch. Achtung eben an den Rändern. Du erhälst eben auch schnell mal vorhergesagte Werte außerhalb von den Grenzen einer Wahrscheinlichkeit.</span>
<span id="cb67-279"><a href="#cb67-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-280"><a href="#cb67-280" aria-hidden="true" tabindex="-1"></a><span class="fu">### ... mit einer logistischen Regression</span></span>
<span id="cb67-281"><a href="#cb67-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-282"><a href="#cb67-282" aria-hidden="true" tabindex="-1"></a>Ja, auch dieses Problem können wir mit einer logistischen Regression angehen. Wenn du auch mal in den anderen Kapiteln geschaut hast, dann wundert es dich vermutlich nicht mehr, dass die logistische Regression außerhalb der Agarwissenschaften zu einer der beliebtesten Analysewerkzeugen gehört. Hier müssen wir aber unser Outcome etwas anders der Funktion <span class="in">`glm()`</span> für die logistische Regression übergeben. Wir nutzen nämlich dafür das <span class="co">[</span><span class="ot">Wilkinson-Rogers Format</span><span class="co">](https://edgarhassler.com/posts/wilkinson-rogers-notation/)</span> welches dann den Anteil an Erfolgen an Fehlschlägen beschreibt. Wir schreiben aber in das Modell die konkrete Anzahl an Erfolgen und Fehlschlägen.</span>
<span id="cb67-283"><a href="#cb67-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-284"><a href="#cb67-284" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb67-285"><a href="#cb67-285" aria-hidden="true" tabindex="-1"></a>(Success|Failure) \sim x_1 + x_2 + ... + x_p </span>
<span id="cb67-286"><a href="#cb67-286" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb67-287"><a href="#cb67-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-288"><a href="#cb67-288" aria-hidden="true" tabindex="-1"></a>In R würden wir dann die *zwei* Spalten mit der Anzahl an Erfolgen und Fehlschlägen mit <span class="in">`cbind()`</span> zusammenfassen und in <span class="in">`glm()`</span> ergänzen. Dieses Format haben wir dann auch bei unseren Eisfüchsen vorliegen. In unseren Daten haben wir ja die Spalte <span class="in">`success`</span>, welche die Anzahl Jagderfolge beschreibt sowie die Anzahl der Fehlschläge in der Spalte <span class="in">`fail`</span>. Wichtig ist hier, dass wir wirklich die beiden Spalten mit den jeweiligen Anzahlen haben. Daher würden wir dann in R wie folgt schreiben.</span>
<span id="cb67-289"><a href="#cb67-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-292"><a href="#cb67-292" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-293"><a href="#cb67-293" aria-hidden="true" tabindex="-1"></a>hunting_log_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">cbind</span>(success, fail) <span class="sc">~</span> snow_height, </span>
<span id="cb67-294"><a href="#cb67-294" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> hunting_tbl, <span class="at">family =</span> binomial)</span>
<span id="cb67-295"><a href="#cb67-295" aria-hidden="true" tabindex="-1"></a>hunting_log_fit</span>
<span id="cb67-296"><a href="#cb67-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-297"><a href="#cb67-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-298"><a href="#cb67-298" aria-hidden="true" tabindex="-1"></a>Damit haben wir dann auch unseren Koeffizienten des Intercept und der Steigung. Da die logistische Regression auf dem Logit-Link rechnet, können wir die Steigung von $-0.08326$ nicht direkt interpretieren. Daher müssen wir die Steigung wieder von dem Logit-Link auf unsere ursprüngliche Skala (eng. *response*) zurückrechnen. Dafür gibt es einen einfachen Trick mit der "Teile durch Vier" Regel oder aber eine entsprechende Funktion im R Paket <span class="in">`{marginaleffects}`</span>. Wichtig ist auch hier, uns interessieren nicht die Odds Ratios aus einer logistischen Regression, da wir an dem Effekt der Steigung interessiert sind. Wir wollen ja wissen, wie sich der Jagderfolg in <span class="sc">\[</span>%<span class="sc">\]</span> durch die steigende Schneeschöhe verändert.</span>
<span id="cb67-299"><a href="#cb67-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-300"><a href="#cb67-300" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb67-301"><a href="#cb67-301" aria-hidden="true" tabindex="-1"></a><span class="fu">## "Teile durch Vier" Regel</span></span>
<span id="cb67-302"><a href="#cb67-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-303"><a href="#cb67-303" aria-hidden="true" tabindex="-1"></a>Die "Teile durch Vier" Regel (eng. *Divide by 4 Rule*) erlaubt uns von dem Koeffizienten aus der logistischen Regression auf die wahre Steigung der Geraden zu schließen. Da die logistische Regression auf dem Logit-Link rechnet, ist unsere $-0.08$ *nicht* die Steigung der Geraden. Es gibt hier die Daumenregel, den Koeffizienten durch Vier zu teilen und so einen annähernd korrekten Wert zu erhalten. In unserem Fall also $-0.08326/4 = -0.021$. Damit haben wir nicht den exakten Wert der Steigung, aber eine recht guten Wert.</span>
<span id="cb67-304"><a href="#cb67-304" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb67-305"><a href="#cb67-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-306"><a href="#cb67-306" aria-hidden="true" tabindex="-1"></a>Mit der Funktion <span class="in">`avg_slopes()`</span> können wir uns aus dem Modell die Steigung der Gerade berechnen lassen. Wir haben dann nicht mehr die Logit-Skala vorliegen sondern sind wieder auf unserer ursprünglichen Skala der Prozente. Im Gegensatz zur "Teile durch Vier" Regel ist der Wert von $-0.15$ natürlich genauer. Wir sehen, dass wir fast einen ähnlichen Wert für die Reduzierung des Jagderfolges der Eisfüchse wie bei der Gaussian Regression erhalten.</span>
<span id="cb67-307"><a href="#cb67-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-310"><a href="#cb67-310" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-311"><a href="#cb67-311" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb67-312"><a href="#cb67-312" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb67-313"><a href="#cb67-313" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_slopes</span>(hunting_log_fit)</span>
<span id="cb67-314"><a href="#cb67-314" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-315"><a href="#cb67-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-316"><a href="#cb67-316" aria-hidden="true" tabindex="-1"></a>Leider gibt es für eine logistische Regression mit einem $(Success/Failure)$-Outcome kein kein *echtes* Bestimmtheitsmaß $R^2$. Hier greifen wir auf das R Paket `{rcompanion}` zurück. Wir rechnen auch dabei auch hier kein *echtes* Bestimmtheitsmaß $R^2$ aus, sondern den Vergleich zu einem Null-Modell in dem wir gar keine Variable als Einfluss mit ins Modell nehmen. Das folgende Bestimmtheitsmaß $R^2$ beantwortet also eher die Frage, ob wir besser mit unserem Modell mit der Schneehöhe sind, also mit einem Modell ohne die Schneehöhe.</span>
<span id="cb67-317"><a href="#cb67-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-320"><a href="#cb67-320" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-321"><a href="#cb67-321" aria-hidden="true" tabindex="-1"></a>hunting_log_fit <span class="sc">|&gt;</span> </span>
<span id="cb67-322"><a href="#cb67-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nagelkerke</span>() <span class="sc">|&gt;</span> </span>
<span id="cb67-323"><a href="#cb67-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"Pseudo.R.squared.for.model.vs.null"</span>)</span>
<span id="cb67-324"><a href="#cb67-324" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-325"><a href="#cb67-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-326"><a href="#cb67-326" aria-hidden="true" tabindex="-1"></a>Hm, am Ende würde ich es lassen. Keine der Bestimmtheitsmaße $R^2$ ist wirklich sinnig. Das erste Bestimmtheitsmaß ist viel zu niedrig, dafür das wir so nahe an den Koeffizienten der Gaussian Regression sind. Dafür sind die anderen beiden Bestimmtheitsmaße viel zu optimistisch, wie wir gleich in der @fig-beta-fox-predict sehen werden. Aber damit haben wir auch gesehen, dass wir die Analyse auch mit einer logistischen Regression rechnen können.</span>
<span id="cb67-327"><a href="#cb67-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-328"><a href="#cb67-328" aria-hidden="true" tabindex="-1"></a><span class="fu">### ... mit dem R Paket `{betareg}`</span></span>
<span id="cb67-329"><a href="#cb67-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-330"><a href="#cb67-330" aria-hidden="true" tabindex="-1"></a>Jetzt haben wir uns durch andere Modellierungen durchgearbeitet und wollen uns jetzt einmal die Beta Regression anschauen. Die Beta Regression ist in dem R Paket <span class="in">`{betareg}`</span> implementiert und kann über die Funktion <span class="in">`betareg()`</span> angewendet werden. Wir haben hier noch den Sonderfall, dass wir das Modell mit einem <span class="in">`|`</span> schreiben können. Wir können nämlich bei der Beta Regression auch die Varianz global schätzen oder aber für eine Variable adjustieren. Wir wählen hier einmal beide Schreibweisen in den folgenden Tabs und schauen was dann herauskommt. Sonst müssen wir bei der Beta Regression erstmal nichts beachten - wie immer schauen wir dann nochmal, ob unser Modell auch gut funktioniert hat.</span>
<span id="cb67-331"><a href="#cb67-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-332"><a href="#cb67-332" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb67-333"><a href="#cb67-333" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mit `~ snow_height`</span></span>
<span id="cb67-334"><a href="#cb67-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-335"><a href="#cb67-335" aria-hidden="true" tabindex="-1"></a>Das simpleste Modell wäre hier, dass wir einfach den Jagderfolg in <span class="sc">\[</span>%<span class="sc">\]</span> durch die Schneehöhe modellieren. Wir nehmen dann mehr oder minder Varianzhomogenität an und erlauben keinen gesonderten Varianzterm. Das kann gut funktionieren, aber meistens variiert die Varianz der $y$-Werte über die $x$-Werte. Wir haben meist eine größere Varianz bei größeren $x$-Werten.</span>
<span id="cb67-336"><a href="#cb67-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-339"><a href="#cb67-339" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-340"><a href="#cb67-340" aria-hidden="true" tabindex="-1"></a>hunting_beta_fit <span class="ot">&lt;-</span> <span class="fu">betareg</span>(proportion <span class="sc">~</span> snow_height, <span class="at">data =</span> hunting_tbl)</span>
<span id="cb67-341"><a href="#cb67-341" aria-hidden="true" tabindex="-1"></a>hunting_beta_fit</span>
<span id="cb67-342"><a href="#cb67-342" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-343"><a href="#cb67-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-344"><a href="#cb67-344" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass wir unseren Koeffizienten erhalten, der fast unserer logistischen Regression entspricht. Jedenfalls numerisch. Aber auch hier dürfen wir uns nicht blenden lassen, wir rechnen auch in einer Beta Regression auf dem Logit-Link. Deshalb müssen wir die Steigung der Schneehöhe dann erst wieder zurückrechnen. Auch hier hilft die Funktion <span class="in">`avg_slopes()`</span> aus dem R Paket <span class="in">`{marginaleffects}`</span>.</span>
<span id="cb67-345"><a href="#cb67-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-348"><a href="#cb67-348" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-349"><a href="#cb67-349" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb67-350"><a href="#cb67-350" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb67-351"><a href="#cb67-351" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_slopes</span>(hunting_beta_fit)</span>
<span id="cb67-352"><a href="#cb67-352" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-353"><a href="#cb67-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-354"><a href="#cb67-354" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass mit jedem Zentimeter mehr Schnee der Jagderfolg um $-0.0149$ oder $-1.49\%$ zurückgeht. Das sind ähnliche Zahlen wie auch schon bei der logistischen Regression sowie der Gaussian Regression.</span>
<span id="cb67-355"><a href="#cb67-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-356"><a href="#cb67-356" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mit `~ snow_height | snow_height`</span></span>
<span id="cb67-357"><a href="#cb67-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-358"><a href="#cb67-358" aria-hidden="true" tabindex="-1"></a>Wenn wir erlauben, dass sich die Varianz der $y$-Werte über den Verlauf der $x$-Werte ändern darf, dann schreiben wir nochmal die Variable, die die Varianz verursacht hinter das Symbol <span class="in">`|`</span>. Wir haben hier nur die Schneehöhe vorliegen, so dass unser Modell sich dann von alleine ergibt. Meistens macht es mehr Sinn die Varianz auch über eine Variable mit zu modellieren. Schauen wir mal, ob wir mit der separaten Modellierung der Varianz der Schneehöhe mehr erreichen.</span>
<span id="cb67-359"><a href="#cb67-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-362"><a href="#cb67-362" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-363"><a href="#cb67-363" aria-hidden="true" tabindex="-1"></a>hunting_beta_phi_fit <span class="ot">&lt;-</span> <span class="fu">betareg</span>(proportion <span class="sc">~</span> snow_height <span class="sc">|</span> snow_height, <span class="at">data =</span> hunting_tbl)</span>
<span id="cb67-364"><a href="#cb67-364" aria-hidden="true" tabindex="-1"></a>hunting_beta_phi_fit</span>
<span id="cb67-365"><a href="#cb67-365" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-366"><a href="#cb67-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-367"><a href="#cb67-367" aria-hidden="true" tabindex="-1"></a>Aber auch hier dürfen wir uns nicht blenden lassen, wir rechnen auch in einer Beta Regression auf dem Logit-Link. Deshalb müssen wir die Steigung der Schneehöhe dann erst wieder zurückrechnen. Auch hier hilft die Funktion <span class="in">`avg_slopes()`</span> aus dem R Paket <span class="in">`{marginaleffects}`</span>.</span>
<span id="cb67-368"><a href="#cb67-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-371"><a href="#cb67-371" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-372"><a href="#cb67-372" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb67-373"><a href="#cb67-373" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb67-374"><a href="#cb67-374" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_slopes</span>(hunting_beta_phi_fit)</span>
<span id="cb67-375"><a href="#cb67-375" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-376"><a href="#cb67-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-377"><a href="#cb67-377" aria-hidden="true" tabindex="-1"></a>Spannenderweise ist hier der Effekt der Schneehöhe noch einen Tick geringer mit $-0.0132$ pro Zentimeter mehr Schnee. Dann müssen wir uns gleich einmal anschauen welches Modell den niedrigeren AIC-Wert hat.</span>
<span id="cb67-378"><a href="#cb67-378" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb67-379"><a href="#cb67-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-380"><a href="#cb67-380" aria-hidden="true" tabindex="-1"></a>Dann berechnen wir einmal die AIC-Werte für die beiden Modelle. Ein niedriger AIC-Wert ist besser. Je kleiner oder negativer ein AIC-Wert eines Modells ist, desto besser ist das Modell im Vergleich zu einem anderen Modell. Das AIC ist ein Maß dafür, wie gut die Daten durch das Modell erklärt werden, korrigiert um die Komplexität des Modells. Wir berechnen mit der Funktion <span class="in">`AIC()`</span> einmal die AIC-Werte der beiden Beta Regressionsmodellen.</span>
<span id="cb67-381"><a href="#cb67-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-384"><a href="#cb67-384" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-385"><a href="#cb67-385" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(hunting_beta_fit)</span>
<span id="cb67-386"><a href="#cb67-386" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(hunting_beta_phi_fit)</span>
<span id="cb67-387"><a href="#cb67-387" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-388"><a href="#cb67-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-389"><a href="#cb67-389" aria-hidden="true" tabindex="-1"></a>Die absoluten Zahlen vom AIC sind nicht von Bedeutung. Erstmal sehen wir, dass unser Modell mit der Berücksichtigung der Varianz durch die Schneehöhe <span class="in">`hunting_beta_phi_fit`</span> besser ist als das reine Modell ohne Berücksichtigung. Wir wollen aber immer die Differenzen von AIC betrachten. Du findest in der wissenschaftlichen Veröffentlichung <span class="co">[</span><span class="ot">Multimodel Inference: Understanding AIC and BIC in Model Selection</span><span class="co">](https://faculty.washington.edu/skalski/classes/QERM597/papers_xtra/Burnham%20and%20Anderson.pdf)</span> mehr Informationen zu den Entscheidungen <span class="co">[</span><span class="ot">@burnham2004multimodel, pp. 270-271</span><span class="co">]</span>. Wichtig ist hier, wenn die Differenz größer ist als 2, dann haben wir einen signifikanten Unterschied zwischen den Modellen und wir sollten das Modell mit dem niedrigeren AIC nehmen.</span>
<span id="cb67-390"><a href="#cb67-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-393"><a href="#cb67-393" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-394"><a href="#cb67-394" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(hunting_beta_fit) <span class="sc">-</span> <span class="fu">AIC</span>(hunting_beta_phi_fit)</span>
<span id="cb67-395"><a href="#cb67-395" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-396"><a href="#cb67-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-397"><a href="#cb67-397" aria-hidden="true" tabindex="-1"></a>Wir nehmen dann mal auf jeden Fall das Modell mit der Berücksichtigung der Varianz durch die Schneehöhe <span class="in">`hunting_beta_phi_fit`</span>. Damit würden wir einen Effekt der Schneehöhe von $-0.0132$ berichten. Berechnen wir jetzt nochmal als Vergleich das Bestimmtheitsmaß $R^2$ und sehen, dass der Wert schon besser ist. Damit können wir dann auf jeden Fall leben.</span>
<span id="cb67-398"><a href="#cb67-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-401"><a href="#cb67-401" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-402"><a href="#cb67-402" aria-hidden="true" tabindex="-1"></a>hunting_beta_phi_fit <span class="sc">|&gt;</span> <span class="fu">r2</span>()</span>
<span id="cb67-403"><a href="#cb67-403" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-404"><a href="#cb67-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-405"><a href="#cb67-405" aria-hidden="true" tabindex="-1"></a>In der @fig-beta-fox-diagnostic sehen wir nochmal die Abbildungen der Modelldiagnostik. Wie du sehen kannst, sind die Ergebnisse zufriedenstellend. Der Residualplot sieht aus, wie wir ihn erwarten würden. Unsere Beobachtungen streuen um die Gerade. Auch haben wir keine Ausreißer vorliegen. Unsere Werte der *Cook's distance* sind okay. Der Grenzwert wäre hier $4/n = 4/21 = 0.19$. Unsere erste Beobachtung würde den Grenzwert reißen, aber das ist noch okay so. Das passt auch zu der Abbildung der Residuen. Auch die *Generalized leverage* deutet auf einen Ausreißer hin. Wir haben hier den Grenzwert von $3(k+1)/n$ mit $k$ gleich der Anzahl an Variablen im Modell. Somit liegt unser Grenzwert bei $3(1+1)/21 = 0.29$. Auch der abschließende Residualplot sieht so aus, wie wir ihn erwarten würden. Als Fazit lässt sich ziehen, das wir zwar eine Beobachtung drin haben, die etwas am Rand liegt, was hier aber für mich noch nicht fürs Entfernen spricht.</span>
<span id="cb67-406"><a href="#cb67-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-409"><a href="#cb67-409" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-410"><a href="#cb67-410" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb67-411"><a href="#cb67-411" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb67-412"><a href="#cb67-412" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-beta-fox-diagnostic</span></span>
<span id="cb67-413"><a href="#cb67-413" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb67-414"><a href="#cb67-414" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb67-415"><a href="#cb67-415" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb67-416"><a href="#cb67-416" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Ausgabe ausgewählter Modelgüteplots der Funktion `plot()`. Im Gegensatz zu der Funktion `check_model()` musst du wissen, was du erwarten würdest."</span></span>
<span id="cb67-417"><a href="#cb67-417" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-subcap: </span></span>
<span id="cb67-418"><a href="#cb67-418" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Residualplot I"</span></span>
<span id="cb67-419"><a href="#cb67-419" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Cooks distance"</span></span>
<span id="cb67-420"><a href="#cb67-420" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Generalized leverage"</span></span>
<span id="cb67-421"><a href="#cb67-421" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Residualplot II"</span></span>
<span id="cb67-422"><a href="#cb67-422" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-nrow: 2</span></span>
<span id="cb67-423"><a href="#cb67-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-424"><a href="#cb67-424" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hunting_beta_phi_fit)</span>
<span id="cb67-425"><a href="#cb67-425" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-426"><a href="#cb67-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-427"><a href="#cb67-427" aria-hidden="true" tabindex="-1"></a>Damit hätten wir höchstens einen Ausreißer, aber das kann bei echten Daten schon mal vorkommen, dass nicht alle Datenpunkte perfekt zu einem Modell passen. In der @fig-beta-fox-predict siehst du nochmal die Daten der Jagderfolge der Eisfüche im Zusammenhang mit der Schneehöhe dargestellt. Ich sehe da keinen eindeutigen Ausreißer und deshalb lasse ich alle Beobachtungen im Modell. Im Weiteren siehst du einmal die Modelle, die ich gerechnet habe, jeweils als Kurve dargestellt. Das beste Modell ist das <span class="in">`betareg_phi`</span> Modell, was auch ziemlich gut durch die Punkte läuft. Du siehst besonders gut, wie das lineare Modell <span class="in">`lm`</span> leider die Punkte nur sehr unzureichend an den Rändern trifft. Kann ja das Modell auch nicht anders, es muss ja eine Linie sein. Beachte aber vor allem die Unterschiede in den Effekten. Das lineare Modell mit der Gaussian Regression hat einen viel größeren Effekt berechnet als das beste Modell mit der Beta Regression.</span>
<span id="cb67-428"><a href="#cb67-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-431"><a href="#cb67-431" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-432"><a href="#cb67-432" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb67-433"><a href="#cb67-433" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb67-434"><a href="#cb67-434" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-beta-fox-predict</span></span>
<span id="cb67-435"><a href="#cb67-435" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb67-436"><a href="#cb67-436" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb67-437"><a href="#cb67-437" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb67-438"><a href="#cb67-438" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Zusammenhang zwischen dem Jagederfolg von Eisfüchsen und der Schneehöhe in den jeweiligen beobachteten Habitaten zusammen mit den vier vorgestellten Modellen. Das Modell `betareg_phi` ist dabei das Modell, was die Daten am besten beschreibt."</span></span>
<span id="cb67-439"><a href="#cb67-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-440"><a href="#cb67-440" aria-hidden="true" tabindex="-1"></a>hunting_tbl <span class="sc">|&gt;</span> </span>
<span id="cb67-441"><a href="#cb67-441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(snow_height, proportion)) <span class="sc">+</span></span>
<span id="cb67-442"><a href="#cb67-442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb67-443"><a href="#cb67-443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb67-444"><a href="#cb67-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">predict</span>(hunting_log_fit, <span class="at">type =</span> <span class="st">"response"</span>), <span class="at">color =</span> <span class="st">"log"</span>)) <span class="sc">+</span></span>
<span id="cb67-445"><a href="#cb67-445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">predict</span>(hunting_lm_fit, <span class="at">type =</span> <span class="st">"response"</span>), <span class="at">color =</span> <span class="st">"lm"</span>)) <span class="sc">+</span></span>
<span id="cb67-446"><a href="#cb67-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">predict</span>(hunting_beta_fit, <span class="at">type =</span> <span class="st">"response"</span>), <span class="at">color =</span> <span class="st">"betareg"</span>)) <span class="sc">+</span></span>
<span id="cb67-447"><a href="#cb67-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">predict</span>(hunting_beta_phi_fit, <span class="at">type =</span> <span class="st">"response"</span>), <span class="at">color =</span> <span class="st">"betareg_phi"</span>)) <span class="sc">+</span></span>
<span id="cb67-448"><a href="#cb67-448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Modell"</span>, <span class="at">values =</span> cb_pal[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb67-449"><a href="#cb67-449" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-450"><a href="#cb67-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-451"><a href="#cb67-451" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb67-452"><a href="#cb67-452" aria-hidden="true" tabindex="-1"></a><span class="fu">## Wo ist die mathematische Formel?</span></span>
<span id="cb67-453"><a href="#cb67-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-454"><a href="#cb67-454" aria-hidden="true" tabindex="-1"></a>Jetzt haben wir zwar schön das Modell mit der Beta Regression geschätzt aber leider keine mathematische Formel erhalten. Das ist jetzt ja eigentlich auch eine andere Fragestellung. Daher nutzen wir für die Erstellung der mathematischen Formel auch nicht die Beta Regression sondern die nicht linear Regression. Prinzipiell ginge natürlich auch die lineare Regression, aber da wissen wir ja schon, dass die nicht so super funktioniert. Hier jetzt also der Weg um die Koeffizienten einer nicht lineare Regression zu bestimmen, die durch die Punkte eine Kurve legt.</span>
<span id="cb67-455"><a href="#cb67-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-456"><a href="#cb67-456" aria-hidden="true" tabindex="-1"></a>Auch hier haben wir die Wahl zwischen der Funktion <span class="in">`nls()`</span> aus dem Standardpaket in R oder aber der Funktion <span class="in">`mfp()`</span> aus dem gleichnamigen R Paket <span class="in">`{mfp}`</span>. In den beiden Tabs zeige ich dir einmal die schnelle Anwendung. Wenn du mehr lesen willst dann kannst du nochmal in dem <span class="co">[</span><span class="ot">Kapitel zur nicht linearen Regression</span><span class="co">](#sec-non-linear)</span> reinschauen. Wie immer führe ich hier den Code mehr aus als ihn dann zu erklären.</span>
<span id="cb67-457"><a href="#cb67-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-458"><a href="#cb67-458" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb67-459"><a href="#cb67-459" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mit `nls()`</span></span>
<span id="cb67-460"><a href="#cb67-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-461"><a href="#cb67-461" aria-hidden="true" tabindex="-1"></a>Die Funktion <span class="in">`nls()`</span> hat die Herausforderung, dass wir Startwerte für die Koeffizienten unserer mathematischen Formel übergeben müssen. Darüber hinaus müssen wir auch in der Funktion <span class="in">`nls()`</span> eine Formel vordefinieren, die dann eben mit den Werten der Koeffizienten gefüllt wird. Wenn es dir auch eher schwer fällt in einer Punktewolke eine mathematische Funktion zu sehen, dann ist die Funktion <span class="in">`nls()`</span> eine Herausforderung. Es gibt zwar den einen oder anderen Trick, aber am Ende müssen wir schauen, ob es dann passt mit dem Ergebnis.</span>
<span id="cb67-462"><a href="#cb67-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-463"><a href="#cb67-463" aria-hidden="true" tabindex="-1"></a>Wir brauchen erstmal Startwerte für unsere mathematische Formel $y = a - x^b$. Ein Trick ist, erstmal eine lineare Regression mit <span class="in">`lm()`</span> zu rechnen und die Koeffizienten dann als Startwerte in <span class="in">`nls()`</span> zu nutzen.</span>
<span id="cb67-464"><a href="#cb67-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-467"><a href="#cb67-467" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-468"><a href="#cb67-468" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="fu">log</span>(proportion) <span class="sc">~</span> snow_height, hunting_tbl)</span>
<span id="cb67-469"><a href="#cb67-469" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-470"><a href="#cb67-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-471"><a href="#cb67-471" aria-hidden="true" tabindex="-1"></a>Mit unseren Startwerten können wir dann einmal schauen, ob unser Modell konvergiert. Dann haben wir auch die Werte für die Koeffizienten $a$ und $b$ und können das Modell als mathematische Formel aufschreiben.</span>
<span id="cb67-472"><a href="#cb67-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-475"><a href="#cb67-475" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-476"><a href="#cb67-476" aria-hidden="true" tabindex="-1"></a><span class="fu">nls</span>(proportion <span class="sc">~</span> a <span class="sc">-</span> <span class="fu">I</span>(snow_height<span class="sc">^</span>b), <span class="at">data =</span> hunting_tbl, </span>
<span id="cb67-477"><a href="#cb67-477" aria-hidden="true" tabindex="-1"></a>    <span class="at">start =</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="fu">exp</span>(<span class="fl">1.0324</span>), <span class="at">b =</span> <span class="sc">-</span><span class="fl">0.0354</span>),</span>
<span id="cb67-478"><a href="#cb67-478" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">nls.control</span>(<span class="at">maxiter =</span> <span class="dv">1000</span>))</span>
<span id="cb67-479"><a href="#cb67-479" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-480"><a href="#cb67-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-481"><a href="#cb67-481" aria-hidden="true" tabindex="-1"></a>Wir können auch nochmal eine $e$-Funktion mit $y = a - e^{b \cdot x}$ nutzen und schauen, ob wir damit etwas besser an die Daten näherkommen. Hier müssen wir dann wirklich ausprobieren, was teilweise echt nervig ist. Dafür schauen wir uns gleich nochmal die Funktion <span class="in">`mfp()`</span> an.</span>
<span id="cb67-482"><a href="#cb67-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-485"><a href="#cb67-485" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-486"><a href="#cb67-486" aria-hidden="true" tabindex="-1"></a><span class="fu">nls</span>(proportion <span class="sc">~</span> a <span class="sc">-</span> <span class="fu">exp</span>(b <span class="sc">*</span> snow_height), <span class="at">data =</span> hunting_tbl, </span>
<span id="cb67-487"><a href="#cb67-487" aria-hidden="true" tabindex="-1"></a>    <span class="at">start =</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">0</span>),</span>
<span id="cb67-488"><a href="#cb67-488" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">nls.control</span>(<span class="at">maxiter =</span> <span class="dv">1000</span>))</span>
<span id="cb67-489"><a href="#cb67-489" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-490"><a href="#cb67-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-491"><a href="#cb67-491" aria-hidden="true" tabindex="-1"></a>Hat jeweils geklappt und dann können wir uns auch schon die Gleichung zusammenbauen. Die Frage ist natürlich, ob die Werte gut zu unseren Daten passen. Das werden wir dann gleich nochmal in der @fig-beta-fox-predict-non überprüfen. Hier dann einmal die erste Gleichung für das Polynom und dann die zweite Gleichung mit der $e$-Funktion.</span>
<span id="cb67-492"><a href="#cb67-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-493"><a href="#cb67-493" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb67-494"><a href="#cb67-494" aria-hidden="true" tabindex="-1"></a>proportion = 3.196 - snow<span class="sc">\_</span>height^{0.248}</span>
<span id="cb67-495"><a href="#cb67-495" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb67-496"><a href="#cb67-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-497"><a href="#cb67-497" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb67-498"><a href="#cb67-498" aria-hidden="true" tabindex="-1"></a>proportion = 2.268 - e^{0.0101 \cdot snow<span class="sc">\_</span>height}</span>
<span id="cb67-499"><a href="#cb67-499" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb67-500"><a href="#cb67-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-501"><a href="#cb67-501" aria-hidden="true" tabindex="-1"></a>Welche dann die beste mathematische Formel ist sehen wir dann gleich. Bitte schaue dir aber noch den anderen Tab mit der Funktion <span class="in">`mfp()`</span> an, denn mit der Funktion <span class="in">`nls()`</span> ist es dann doch manchmal etwas Glücksspiel, ob man die richtige mathematische Formel mit den richtigen Startwerten trifft. Auch hier hilft vielleicht das <span class="co">[</span><span class="ot">R Paket `{nls.multstart}`</span><span class="co">](https://github.com/padpadpadpad/nls.multstart)</span> welches versucht das Problem der Startwerte nochmal algorithmisch zu lösen. Sieht jetzt wilder aus als es ist, aber hier kriege ich dann noch ein $c$ mit in der Formel unter.</span>
<span id="cb67-502"><a href="#cb67-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-505"><a href="#cb67-505" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-506"><a href="#cb67-506" aria-hidden="true" tabindex="-1"></a><span class="fu">nls_multstart</span>(proportion <span class="sc">~</span> a <span class="sc">-</span> c <span class="sc">*</span> <span class="fu">I</span>(snow_height<span class="sc">^</span>b), <span class="at">data =</span> hunting_tbl, </span>
<span id="cb67-507"><a href="#cb67-507" aria-hidden="true" tabindex="-1"></a>              <span class="at">lower =</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">c =</span> <span class="dv">0</span>),</span>
<span id="cb67-508"><a href="#cb67-508" aria-hidden="true" tabindex="-1"></a>              <span class="at">upper =</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="cn">Inf</span>, <span class="at">b =</span> <span class="cn">Inf</span>, <span class="at">c =</span> <span class="cn">Inf</span>),</span>
<span id="cb67-509"><a href="#cb67-509" aria-hidden="true" tabindex="-1"></a>              <span class="at">start_lower =</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">c =</span> <span class="dv">0</span>),</span>
<span id="cb67-510"><a href="#cb67-510" aria-hidden="true" tabindex="-1"></a>              <span class="at">start_upper =</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">500</span>, <span class="at">b =</span> <span class="dv">5</span>, <span class="at">c =</span> <span class="dv">10</span>),</span>
<span id="cb67-511"><a href="#cb67-511" aria-hidden="true" tabindex="-1"></a>              <span class="at">iter =</span> <span class="dv">500</span>, <span class="at">supp_errors =</span> <span class="st">"Y"</span>)</span>
<span id="cb67-512"><a href="#cb67-512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-513"><a href="#cb67-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-514"><a href="#cb67-514" aria-hidden="true" tabindex="-1"></a>Dann erhalten wir als Abschluss die folgende Formel. Du kannst hier wirklich sehr viel rumspielen und schauen, welche der expoentziellen Gleichungen am besten passt. Das ist dann wirklich immer ein rumprobieren.</span>
<span id="cb67-515"><a href="#cb67-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-516"><a href="#cb67-516" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb67-517"><a href="#cb67-517" aria-hidden="true" tabindex="-1"></a>proportion = 4.914 - 7.189\cdot10^{-10} \cdot snow<span class="sc">\_</span>height^{0.888}</span>
<span id="cb67-518"><a href="#cb67-518" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb67-519"><a href="#cb67-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-520"><a href="#cb67-520" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mit `mfp()`</span></span>
<span id="cb67-521"><a href="#cb67-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-522"><a href="#cb67-522" aria-hidden="true" tabindex="-1"></a>Nachdem wir den langen Weg mit der Funktion <span class="in">`nls()`</span> gegeangen sind, machen wir es jetzt etwas kürzer mit der Funktion <span class="in">`mfp()`</span>. Wir müssen nur angeben welche Variable als Polynom modelliert werden soll. Den Rest macht dann die Funktion <span class="in">`mfp()`</span> für uns. Wir erhalten dann auch die Formel für den Zusammenhang der folgenden Form. Wir erhalten dann die Werte für $\beta_0$, $\beta_1$ sowie dem Polynom $p$ und der möglichen Transformation von $x$.</span>
<span id="cb67-523"><a href="#cb67-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-524"><a href="#cb67-524" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb67-525"><a href="#cb67-525" aria-hidden="true" tabindex="-1"></a>proportion = \beta_0 - \beta_1 \cdot \left(snow<span class="sc">\_</span>height\right)^p</span>
<span id="cb67-526"><a href="#cb67-526" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb67-527"><a href="#cb67-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-528"><a href="#cb67-528" aria-hidden="true" tabindex="-1"></a>Dann rechnen wir mal die Funktion und schauen welche Werte wir erhalten. Die Kunst ist hier die Werte für die Koeffizienten aus der Ausgabe abzulesen. Aber das mache ich dir hier ja einmal vor.</span>
<span id="cb67-529"><a href="#cb67-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-532"><a href="#cb67-532" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-533"><a href="#cb67-533" aria-hidden="true" tabindex="-1"></a><span class="fu">mfp</span>(proportion <span class="sc">~</span> <span class="fu">fp</span>(snow_height), <span class="at">data =</span> hunting_tbl)</span>
<span id="cb67-534"><a href="#cb67-534" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-535"><a href="#cb67-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-536"><a href="#cb67-536" aria-hidden="true" tabindex="-1"></a>Dann können wir die Werte aus der Ausgabe auch schon in unsere Gleichung einsetzen. Der Vorteil ist wirklich, dass ich mir nicht überlegen muss, welche mathematische Formel ich nutzen will. Das schränkt mich zwar ein, macht mir das Leben aber auch einfacher. Wir erhalten dann eben eine Polynom, was auch einfach einzusetzen ist.</span>
<span id="cb67-537"><a href="#cb67-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-538"><a href="#cb67-538" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb67-539"><a href="#cb67-539" aria-hidden="true" tabindex="-1"></a>proportion = 0.9741 -2.4216 \cdot \left(\cfrac{snow<span class="sc">\_</span>height}{100}\right)^3</span>
<span id="cb67-540"><a href="#cb67-540" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb67-541"><a href="#cb67-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-542"><a href="#cb67-542" aria-hidden="true" tabindex="-1"></a>Dann schauen wir mal gleich, welche der drei mathematischen Formeln am besten zu unseren Daten in der @fig-beta-fox-predict-non passen.</span>
<span id="cb67-543"><a href="#cb67-543" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb67-544"><a href="#cb67-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-545"><a href="#cb67-545" aria-hidden="true" tabindex="-1"></a>Im ersten Schritt bauen wir uns einmal in R die drei mathematischen Formeln einmal nach. Wir nutzen dafür die Funktion <span class="in">`\(x){...}`</span> und setzen die Zahlen der Koeffizienten ein. Hier musst du nur mit den Klammern aufpassen, sonst bauen sich die Formeln einfach.</span>
<span id="cb67-546"><a href="#cb67-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-549"><a href="#cb67-549" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-550"><a href="#cb67-550" aria-hidden="true" tabindex="-1"></a>nls_poly_func <span class="ot">&lt;-</span> \(x){<span class="fl">3.196</span> <span class="sc">-</span> x<span class="sc">^</span>(<span class="fl">0.248</span>)}</span>
<span id="cb67-551"><a href="#cb67-551" aria-hidden="true" tabindex="-1"></a>nls_exp_func <span class="ot">&lt;-</span> \(x){<span class="fl">2.268</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="fl">0.0101</span> <span class="sc">*</span> x)}</span>
<span id="cb67-552"><a href="#cb67-552" aria-hidden="true" tabindex="-1"></a>nls_multstart <span class="ot">&lt;-</span> \(x){<span class="fl">4.914</span> <span class="sc">-</span> <span class="fl">7.189e-10</span> <span class="sc">*</span> x<span class="sc">^</span>(<span class="fl">0.888</span>)}</span>
<span id="cb67-553"><a href="#cb67-553" aria-hidden="true" tabindex="-1"></a>mfp_func <span class="ot">&lt;-</span> \(x){<span class="fl">0.9741</span> <span class="sc">-</span> <span class="fl">2.4216</span> <span class="sc">*</span> (x<span class="sc">/</span><span class="dv">100</span>)<span class="sc">^</span><span class="dv">3</span>}</span>
<span id="cb67-554"><a href="#cb67-554" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-555"><a href="#cb67-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-556"><a href="#cb67-556" aria-hidden="true" tabindex="-1"></a>In der @fig-beta-fox-predict-non siehst du einmal den Vergleich der drei nicht linearen Regressionen zu den Datenpunkten. Was will man sagen, dass Modell aus der Funktion <span class="in">`mfp()`</span> bei weitem das beste Modell liefert um den Verlauf der Punkte durch eine Kurve zu beschreiben. Wenn es dir also nur darum ginge die Werte für die Jagderfolge nach der Schneehöhe vorherzusagen, dann sieht das <span class="in">`mfp()`</span>-Modell sehr gut aus.</span>
<span id="cb67-557"><a href="#cb67-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-560"><a href="#cb67-560" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-561"><a href="#cb67-561" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb67-562"><a href="#cb67-562" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb67-563"><a href="#cb67-563" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-beta-fox-predict-non</span></span>
<span id="cb67-564"><a href="#cb67-564" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb67-565"><a href="#cb67-565" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb67-566"><a href="#cb67-566" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb67-567"><a href="#cb67-567" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Zusammenhang zwischen dem Jagederfolg von Eisfüchsen und der Schneehöhe in den jeweiligen beobachteten Habitaten zusammen mit den drei nicht linearen Regressionen aus der Funktion `nls()` und `mfp()`."</span></span>
<span id="cb67-568"><a href="#cb67-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-569"><a href="#cb67-569" aria-hidden="true" tabindex="-1"></a>hunting_tbl <span class="sc">|&gt;</span> </span>
<span id="cb67-570"><a href="#cb67-570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(snow_height, proportion)) <span class="sc">+</span></span>
<span id="cb67-571"><a href="#cb67-571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb67-572"><a href="#cb67-572" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb67-573"><a href="#cb67-573" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> nls_poly_func, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"nls_poly"</span>)) <span class="sc">+</span></span>
<span id="cb67-574"><a href="#cb67-574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> nls_exp_func, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"nls_exp"</span>)) <span class="sc">+</span></span>
<span id="cb67-575"><a href="#cb67-575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> nls_exp_func, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"nls_multstart"</span>)) <span class="sc">+</span></span>
<span id="cb67-576"><a href="#cb67-576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> mfp_func, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"mfp"</span>)) <span class="sc">+</span></span>
<span id="cb67-577"><a href="#cb67-577" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Modell"</span>, <span class="at">values =</span> cb_pal[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb67-578"><a href="#cb67-578" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-579"><a href="#cb67-579" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb67-580"><a href="#cb67-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-581"><a href="#cb67-581" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gruppenvergleich {#sec-mult-comp-beta-reg}</span></span>
<span id="cb67-582"><a href="#cb67-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-583"><a href="#cb67-583" aria-hidden="true" tabindex="-1"></a>Neben der klassischen Regression in der wir dann eine Kurve durch die Punkte legen können wir die Beta Regression auch verwenden um einen Gruppenvergleich zu rechnen. Häufig sind wir in den Agrawissenschaften eher an dieser Frage interessiert. Wir machen das jetzt eigentlich wie immer mit dem R Paket <span class="in">`{emmeans}`</span> und der Funktion <span class="in">`Anova()`</span> aus dem R Paket <span class="in">`{car}`</span>. Wenn du noch mehr zu den multiplen Vergleichen lesen willst, dann kannst du nochmal in das <span class="co">[</span><span class="ot">Kapitel zu den multiplen Vergleichen und dem Posthoc Test</span><span class="co">](#sec-posthoc)</span> reinschauen. Wir konzentrieren uns hier auf die wichtigsten Aspekte und gehen einmal die Sachlage für die Daten zu den untergewichtigen Brokkoli sowie unsren Pilzen auf dem Weizen durch. Dabei habe ich dann die Daten für die Pilze etwas reduziert, weil es einfach zu viele Faktoren sind.</span>
<span id="cb67-584"><a href="#cb67-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-585"><a href="#cb67-585" aria-hidden="true" tabindex="-1"></a><span class="fu">### Untergewichtige Brokkoli</span></span>
<span id="cb67-586"><a href="#cb67-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-587"><a href="#cb67-587" aria-hidden="true" tabindex="-1"></a>Beginnen wir also mit den Daten unseres untergewichtigen Brokkoli. Wir haben als Outcome <span class="in">`proprotion`</span> den Anteil an 500g, also die prozentuale Untergewichtigkeit eines jedes Brokkolikopfes. Dabei habe ich dann alle Brokkoli mit einem Anteil von Eins oder größer entfernt. Wir wollen hier explizit auf die Köpfe schauen, die das Zielgewicht nicht erreicht haben. Damit steht das Modell aus schon fast. Wir haben drei Faktoren, einmal die Zeit der Düngung <span class="in">`fert_time`</span> sowie dann die Menge der Düngung <span class="in">`fert_amount`</span>. Dann nehme ich den Block noch mit rein, denn ich will einmal sehen wie stark der Blockeffekt in der ANOVA ist. Damit ich das so auch kann, muss einmal der Block mit ins Modell. Dann haben wir natürlich bei der beta Regression die Frage, ob wir dann die Varianz nochmal direkt mit modellieren sollen. Das würden wir ja mit einem <span class="in">`|`</span> durchführen. Ich rechne hier jetzt mal drei Modelle, einmal ein Modell ohne explizite Varianz, dann einmal mit der Berücksichtigung der Varianz der Blöcke und zum Schluss nochmal ein Modell mit der Berücksichtigung aller drei Faktoren als Varianzquelle.</span>
<span id="cb67-588"><a href="#cb67-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-591"><a href="#cb67-591" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-592"><a href="#cb67-592" aria-hidden="true" tabindex="-1"></a>broc_1_fit <span class="ot">&lt;-</span> <span class="fu">betareg</span>(proportion <span class="sc">~</span> fert_time <span class="sc">+</span> fert_amount <span class="sc">+</span> fert_time<span class="sc">:</span>fert_amount <span class="sc">+</span> block, </span>
<span id="cb67-593"><a href="#cb67-593" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> broc_tbl)</span>
<span id="cb67-594"><a href="#cb67-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-595"><a href="#cb67-595" aria-hidden="true" tabindex="-1"></a>broc_2_fit <span class="ot">&lt;-</span> <span class="fu">betareg</span>(proportion <span class="sc">~</span> fert_time <span class="sc">+</span> fert_amount <span class="sc">+</span> fert_time<span class="sc">:</span>fert_amount <span class="sc">+</span> block <span class="sc">|</span> block, </span>
<span id="cb67-596"><a href="#cb67-596" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> broc_tbl)</span>
<span id="cb67-597"><a href="#cb67-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-598"><a href="#cb67-598" aria-hidden="true" tabindex="-1"></a>broc_3_fit <span class="ot">&lt;-</span> <span class="fu">betareg</span>(proportion <span class="sc">~</span> fert_time <span class="sc">+</span> fert_amount <span class="sc">+</span> fert_time<span class="sc">:</span>fert_amount <span class="sc">+</span> block <span class="sc">|</span> </span>
<span id="cb67-599"><a href="#cb67-599" aria-hidden="true" tabindex="-1"></a>                      fert_time <span class="sc">+</span> fert_amount <span class="sc">+</span> block, </span>
<span id="cb67-600"><a href="#cb67-600" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> broc_tbl)</span>
<span id="cb67-601"><a href="#cb67-601" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-602"><a href="#cb67-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-603"><a href="#cb67-603" aria-hidden="true" tabindex="-1"></a>Ich nutze jetzt wieder das AIC um zu entscheiden welches Modell das beste Modell ist. Dabei gilt, dass ein niedrigeres AIC immer besser ist. Im zweiten Schritt sind die absoluten Zahlen irrelevant, mich interessiert nur die Differenz der AIC-Werte. Dabei ist ein Modell mit einem Unterschied von $2$ oder größer vorzuziehen.</span>
<span id="cb67-604"><a href="#cb67-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-607"><a href="#cb67-607" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-608"><a href="#cb67-608" aria-hidden="true" tabindex="-1"></a>AIC_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Modell 1"</span><span class="ot">=</span> <span class="fu">AIC</span>(broc_1_fit), </span>
<span id="cb67-609"><a href="#cb67-609" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Modell 2"</span> <span class="ot">=</span> <span class="fu">AIC</span>(broc_2_fit), </span>
<span id="cb67-610"><a href="#cb67-610" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Modell 3"</span> <span class="ot">=</span> <span class="fu">AIC</span>(broc_3_fit))</span>
<span id="cb67-611"><a href="#cb67-611" aria-hidden="true" tabindex="-1"></a><span class="fu">outer</span>(AIC_vec, AIC_vec, <span class="st">"-"</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb67-612"><a href="#cb67-612" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-613"><a href="#cb67-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-614"><a href="#cb67-614" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass das Modell 2 <span class="in">`broc_2_fit`</span> besser ist als das Modell 1. Daher bevorzugen wir das Modell 2. Dann kriegen wir aber keine Verbesserung mehr hin und deshalb bleiben wir bei dem zweiten Modell. Jetzt können wir dann einmal die ANOVA rechnen und schauen, welche signifikante Effekte wir in den Daten haben.</span>
<span id="cb67-615"><a href="#cb67-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-618"><a href="#cb67-618" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-619"><a href="#cb67-619" aria-hidden="true" tabindex="-1"></a>broc_2_fit <span class="sc">|&gt;</span> </span>
<span id="cb67-620"><a href="#cb67-620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb67-621"><a href="#cb67-621" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>()</span>
<span id="cb67-622"><a href="#cb67-622" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-623"><a href="#cb67-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-624"><a href="#cb67-624" aria-hidden="true" tabindex="-1"></a>Ärgerlicherweise sind unsere beiden Behandlungsfaktoren gar nicht signifikant sondern unsere Blöcke. Dann werden wir uns wohl die Blöcke einmal anschauen müssen. Ich entscheide mich mal über den Zeitpunkt der Düngegabe zu mitteln, den der Effekt des Zeitpunktes ist wirklich nicht signifikant.</span>
<span id="cb67-625"><a href="#cb67-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-628"><a href="#cb67-628" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-629"><a href="#cb67-629" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb67-630"><a href="#cb67-630" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb67-631"><a href="#cb67-631" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="ot">&lt;-</span> broc_2_fit <span class="sc">|&gt;</span> </span>
<span id="cb67-632"><a href="#cb67-632" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> fert_amount <span class="sc">*</span> block) </span>
<span id="cb67-633"><a href="#cb67-633" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-634"><a href="#cb67-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-635"><a href="#cb67-635" aria-hidden="true" tabindex="-1"></a>Mit dem <span class="in">`emm_obj`</span> können wir dann uns das *compact letter display* berechnen lassen. Wir haben hier als Effekt die mittleren Prozente in der Spalte <span class="in">`emmean`</span>. Also wie viel Prozent der Brokkoliköpfe untergewichtig sind. Ich adjustiere hier dann noch die $p$-Werte nach Bonferroni.</span>
<span id="cb67-636"><a href="#cb67-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-639"><a href="#cb67-639" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-640"><a href="#cb67-640" aria-hidden="true" tabindex="-1"></a>emm_cld <span class="ot">&lt;-</span> emm_obj <span class="sc">|&gt;</span> </span>
<span id="cb67-641"><a href="#cb67-641" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb67-642"><a href="#cb67-642" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-643"><a href="#cb67-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-644"><a href="#cb67-644" aria-hidden="true" tabindex="-1"></a>In der @fig-bar-beta-broc siehst du die Barplots der mittleren Prozente des errichten Zielgewichtes der Brokkoliköpfe für die Düngemenge und die vier Blöcke. Wie du sehen kannst unterscheiden sich die Blöcke stärker untereinander als die Level der Düngemenge. Wie viel Prozent an untergewichtigen Brokkoli du also anteilig erhälst liegt mehr an dem Standort des Blocks als an der Behandlung mit Dünger. Irgendwie dann auch ein spannendes Ergebnis. Ich nutze hier den Standardfehler als Fehlerbalken, da die Standardabweichung eventuell über die Grenze von Eins steigen würde, was bei Prozenten und Anteilen wenig Sinn ergibt.</span>
<span id="cb67-645"><a href="#cb67-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-648"><a href="#cb67-648" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-649"><a href="#cb67-649" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb67-650"><a href="#cb67-650" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb67-651"><a href="#cb67-651" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb67-652"><a href="#cb67-652" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-bar-beta-broc</span></span>
<span id="cb67-653"><a href="#cb67-653" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb67-654"><a href="#cb67-654" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb67-655"><a href="#cb67-655" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb67-656"><a href="#cb67-656" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Säulendigramm der mittleren Prozente der untergewichtigen Brokkoli aus einer Beta Regression. Das `betareg()`-Modell berechnet das mittleren Prozente des Brokkoli in jeder Faktorkombination. Das *compact letter display* wird dann in `{emmeans}` generiert. Wir nutzen hier den Standardfehler, da die Standardabweichung mit der großen Fallzahl rießig wäre."</span></span>
<span id="cb67-657"><a href="#cb67-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-658"><a href="#cb67-658" aria-hidden="true" tabindex="-1"></a>emm_cld <span class="sc">|&gt;</span> </span>
<span id="cb67-659"><a href="#cb67-659" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb67-660"><a href="#cb67-660" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> fert_amount, <span class="at">y =</span> emmean, <span class="at">fill =</span> block)) <span class="sc">+</span></span>
<span id="cb67-661"><a href="#cb67-661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb67-662"><a href="#cb67-662" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"[%] erreichtes Zielgewicht"</span>, <span class="at">x =</span> <span class="st">"Düngemenge [mg/l]"</span>,</span>
<span id="cb67-663"><a href="#cb67-663" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Block"</span>) <span class="sc">+</span></span>
<span id="cb67-664"><a href="#cb67-664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb67-665"><a href="#cb67-665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.7</span>,</span>
<span id="cb67-666"><a href="#cb67-666" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb67-667"><a href="#cb67-667" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">str_trim</span>(.group), <span class="at">y =</span> emmean <span class="sc">+</span> SE <span class="sc">+</span> <span class="fl">0.01</span>),  </span>
<span id="cb67-668"><a href="#cb67-668" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb67-669"><a href="#cb67-669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>SE, <span class="at">ymax =</span> emmean<span class="sc">+</span>SE),</span>
<span id="cb67-670"><a href="#cb67-670" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>,  </span>
<span id="cb67-671"><a href="#cb67-671" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb67-672"><a href="#cb67-672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb67-673"><a href="#cb67-673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>()</span>
<span id="cb67-674"><a href="#cb67-674" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-675"><a href="#cb67-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-676"><a href="#cb67-676" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pilze auf Weizen</span></span>
<span id="cb67-677"><a href="#cb67-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-678"><a href="#cb67-678" aria-hidden="true" tabindex="-1"></a>Unser zweites Beispiel ist wirklich schwierig auszuwerten, da wir so viele Faktoren vorliegen haben. Zum einen haben wir als Faktor der Weizenlinien zehn genetische Linien vorliegen. Dann schauen wir uns auch noch zwanzig Pilzarten an. Das funktioniert dann hier als Demonstration nicht mehr. In der Realität würdest du dir dann auch Linien oder Pilzarten raussuchen, die sich interessieren und nicht wild hier Abbildungen produzieren. Wenn du alle Faktoren mit in die Modelle nimmst, siehst du wirklich gar nichts mehr. Vertraue mir, ich habe das *compact letter display* bis zum Buchstaben $z$ mit diesem Beispiel ausgereizt.</span>
<span id="cb67-679"><a href="#cb67-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-682"><a href="#cb67-682" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-683"><a href="#cb67-683" aria-hidden="true" tabindex="-1"></a>fungi_tbl <span class="ot">&lt;-</span> fungi_tbl <span class="sc">|&gt;</span> </span>
<span id="cb67-684"><a href="#cb67-684" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bunt <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"B1"</span>, <span class="st">"B12"</span>, <span class="st">"B157"</span>, <span class="st">"B51"</span>, <span class="st">"B189"</span>, <span class="st">"B4"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb67-685"><a href="#cb67-685" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gen <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Oro"</span>, <span class="st">"Albit"</span>, <span class="st">"Turkey"</span>, <span class="st">"Hybrid128"</span>)) </span>
<span id="cb67-686"><a href="#cb67-686" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-687"><a href="#cb67-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-688"><a href="#cb67-688" aria-hidden="true" tabindex="-1"></a>Mit unserem reduzierten Datensatz können wir dann einmal unsere Beta Regression rechnen. Ich nehme hier mal keinen gesonderten Varianzterm an, einfach um das Beispiel etwas kürzer zu halten.</span>
<span id="cb67-689"><a href="#cb67-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-692"><a href="#cb67-692" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-693"><a href="#cb67-693" aria-hidden="true" tabindex="-1"></a>fungi_fit <span class="ot">&lt;-</span> <span class="fu">betareg</span>(percent <span class="sc">~</span> gen <span class="sc">+</span> bunt <span class="sc">+</span> gen<span class="sc">:</span>bunt, <span class="at">data =</span> fungi_tbl)</span>
<span id="cb67-694"><a href="#cb67-694" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-695"><a href="#cb67-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-696"><a href="#cb67-696" aria-hidden="true" tabindex="-1"></a>Dann können wir auch schon die ANOVA rechnen. Hier hilft die ANOVA wirklich mal einen schnellen Überblick über die Daten zu erhalten.</span>
<span id="cb67-697"><a href="#cb67-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-700"><a href="#cb67-700" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-701"><a href="#cb67-701" aria-hidden="true" tabindex="-1"></a>fungi_fit <span class="sc">|&gt;</span> </span>
<span id="cb67-702"><a href="#cb67-702" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb67-703"><a href="#cb67-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>()</span>
<span id="cb67-704"><a href="#cb67-704" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-705"><a href="#cb67-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-706"><a href="#cb67-706" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass wir auf jeden Fall einen Effekt der Weizenlinie wie auch der Pilzart haben. Leider haben wir auch eine signifikante Interaktion, so dass ich die Daten dann für die Faktoren getrennt auswerten werde. Wir nutzen dann das Objekt auch gleich um das *compact letter display* zu erstellen. Mehr geht dann natürlich immer, aber da schaue doch mal in das <span class="co">[</span><span class="ot">Kapitel zu den multiplen Vergleichen und dem Posthoc Test</span><span class="co">](#sec-posthoc)</span> rein.</span>
<span id="cb67-707"><a href="#cb67-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-710"><a href="#cb67-710" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-711"><a href="#cb67-711" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb67-712"><a href="#cb67-712" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb67-713"><a href="#cb67-713" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="ot">&lt;-</span> fungi_fit <span class="sc">|&gt;</span> </span>
<span id="cb67-714"><a href="#cb67-714" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> gen <span class="sc">|</span> bunt) </span>
<span id="cb67-715"><a href="#cb67-715" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-716"><a href="#cb67-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-717"><a href="#cb67-717" aria-hidden="true" tabindex="-1"></a>Im Folgenden einmal der Code für das *compact letter display*. Ich zeige auch hier die Ausgabe nur einmal als `tibble` damit die Ausgabe nicht so lang wird. Wir sehen dann gleich mal den mittleren Pilzbefall pro Linie und Pilzart. Es sind wirklich viele Ergebnisse für die Vergleiche, da wir wirklich viele Level der Faktorkombination haben. Irgendwann ist dann auch das *compact letter display* am Ende.</span>
<span id="cb67-718"><a href="#cb67-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-721"><a href="#cb67-721" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-722"><a href="#cb67-722" aria-hidden="true" tabindex="-1"></a>emm_cld <span class="ot">&lt;-</span> emm_obj <span class="sc">|&gt;</span> </span>
<span id="cb67-723"><a href="#cb67-723" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters) <span class="sc">|&gt;</span> </span>
<span id="cb67-724"><a href="#cb67-724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() </span>
<span id="cb67-725"><a href="#cb67-725" aria-hidden="true" tabindex="-1"></a>emm_cld</span>
<span id="cb67-726"><a href="#cb67-726" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-727"><a href="#cb67-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-728"><a href="#cb67-728" aria-hidden="true" tabindex="-1"></a>In der @fig-bar-beta-fungi siehst du einmal das sehr heterogene Ergebnis. Wir haben teilweise Weizenarten mit einem sehr starken Pilzbefall und teilweise dann mit gar keinem Pilzbefall. Das Ganze ist dann auch immer abhängig von der Art des Pilzes und dann der befallenen Linie. Wir haben hier eben eine klassische Interaktion vorliegen. Hier habe ich mich dann auch für den Standardfehler für die Fehlerbalken entschieden, da die Standardabweichung eventuell über die Eins hinausgeht.</span>
<span id="cb67-729"><a href="#cb67-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-732"><a href="#cb67-732" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-733"><a href="#cb67-733" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb67-734"><a href="#cb67-734" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb67-735"><a href="#cb67-735" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb67-736"><a href="#cb67-736" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-bar-beta-fungi</span></span>
<span id="cb67-737"><a href="#cb67-737" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb67-738"><a href="#cb67-738" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb67-739"><a href="#cb67-739" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb67-740"><a href="#cb67-740" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Säulendigramm des mittleren Pilzbefalls von Weizen durch verschiedene Pilzarten. Das `betareg()`-Modell berechnet den mittleren Pilzbefall in jeder Faktorkombination. Das *compact letter display* wird dann in `{emmeans}` generiert. Wir nutzen hier den Standardfehler, da die Standardabweichung mit der großen Fallzahl rießig wäre."</span></span>
<span id="cb67-741"><a href="#cb67-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-742"><a href="#cb67-742" aria-hidden="true" tabindex="-1"></a>emm_cld <span class="sc">|&gt;</span> </span>
<span id="cb67-743"><a href="#cb67-743" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb67-744"><a href="#cb67-744" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> bunt, <span class="at">y =</span> emmean, <span class="at">fill =</span> gen)) <span class="sc">+</span></span>
<span id="cb67-745"><a href="#cb67-745" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb67-746"><a href="#cb67-746" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"[%] infiziert"</span>, <span class="at">x =</span> <span class="st">"Art des Pilzes"</span>,</span>
<span id="cb67-747"><a href="#cb67-747" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Genetische Linie"</span>) <span class="sc">+</span></span>
<span id="cb67-748"><a href="#cb67-748" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb67-749"><a href="#cb67-749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.7</span>,</span>
<span id="cb67-750"><a href="#cb67-750" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb67-751"><a href="#cb67-751" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">str_trim</span>(.group), <span class="at">y =</span> emmean <span class="sc">+</span> SE <span class="sc">+</span> <span class="fl">0.01</span>),  </span>
<span id="cb67-752"><a href="#cb67-752" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb67-753"><a href="#cb67-753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>SE, <span class="at">ymax =</span> emmean<span class="sc">+</span>SE),</span>
<span id="cb67-754"><a href="#cb67-754" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>,  </span>
<span id="cb67-755"><a href="#cb67-755" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb67-756"><a href="#cb67-756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb67-757"><a href="#cb67-757" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>()</span>
<span id="cb67-758"><a href="#cb67-758" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-759"><a href="#cb67-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-760"><a href="#cb67-760" aria-hidden="true" tabindex="-1"></a><span class="fu">## Referenzen {.unnumbered}</span></span>
</code><button title="In die Zwischenablage kopieren" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Bio Data Science wurde von <a href="https://www.hs-osnabrueck.de/prof-dr-jochen-kruppa/">Jochen Kruppa-Scheetz</a> geschrieben.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-modeling-beta.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-modeling-beta.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Dieses Openbook wurde mit <a href="https://quarto.org/">Quarto</a> erstellt.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>
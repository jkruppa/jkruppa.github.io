```{r echo = FALSE}
pacman::p_load(tidyverse, readxl, knitr, kableExtra)
```

# Nicht lineare Regression {#sec-non-linear}

*Version vom `r format(Sys.time(), '%B %d, %Y um %H:%M:%S')`*

![](images/caution.png){fig-align="center" width="50%"}

## Genutzte R Pakete für das Kapitel

Wir wollen folgende R Pakete in diesem Kapitel nutzen.

```{r echo = TRUE}
#| message: false
pacman::p_load(tidyverse, magrittr, conflicted, broom, see,
               parameters, ggridges, scales, performance)
conflict_prefer("select", "dplyr")
conflict_prefer("filter", "dplyr")
```

Am Ende des Kapitels findest du nochmal den gesamten R Code in einem Rutsch zum selber durchführen oder aber kopieren.

## Daten

```{r}
#| message: false

chicken_tbl <- read_csv2("data/chicken_growth.csv")  
```

## Visualisierung

```{r}
ggplot(chicken_tbl, aes(age, weight)) +
  geom_point()
```

```{r, results='hide'}
fit <- nls(weight ~ b0 + I(age^power), data = chicken_tbl, 
           start = list(power = 1, b0= 0), trace = TRUE)
```

```{r}
ggplot(chicken_tbl, aes(age, weight)) +
  #stat_smooth() +
  geom_line(aes(y = predict(fit)), size = 1, color = "red") +
  geom_point() +
  theme_bw()
```

```{r}

pred_tbl <- tibble(age = 1:10,
                   weight = predict(fit, newdata = tibble(age)))


ggplot(chicken_tbl, aes(age, weight)) +
  #stat_smooth() +
  geom_line(data = pred_tbl, aes(age, weight), size = 1, color = "red") +
  geom_point() +
  theme_bw()
```

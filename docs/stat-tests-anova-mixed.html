<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Ein Kochbuch mit Rezepten aus der Bio Data Science, Biostatistik, Biometrie und Statistik zum selber nachkochen!">

<title>33&nbsp; Die repeated / mixed ANOVA – Bio Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./stat-tests-anova-manova.html" rel="next">
<link href="./stat-tests-ancova2.html" rel="prev">
<link href="./cover2026_favi.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-05fe91a66cf75bbbb8c9664867fe5124.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-05a8b96638736df272eeeeef67138371.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="33&nbsp; Die repeated / mixed ANOVA – Bio Data Science">
<meta property="og:description" content="Ein Kochbuch mit Rezepten der Bio Data Science, Biostatistik, Biometrie und Statistik">
<meta property="og:image" content="https://github.com/jkruppa/jkruppa.github.io/raw/master/cover2026.png">
<meta property="og:site_name" content="Bio Data Science">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-tests-preface-app.html">Statistische Gruppenvergleiche</a></li><li class="breadcrumb-item"><a href="./stat-tests-anova-mixed.html"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Die repeated / mixed ANOVA</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bio Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jkruppa/jkruppa.github.io/" title="Quellcode" class="quarto-navigation-tool px-1" aria-label="Quellcode"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Willkommen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bibliothek</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./forschungsprozess.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forschungsprozess</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abschlussarbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Abschlussarbeit</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./example-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datenbeispiele</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-database.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Von Datenbanken</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programmieren in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Daten in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Daten einlesen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Reguläre Ausdrücke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-purrr-furrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Ein <code>{purrr}</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Ein <code>{ggplot}</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-quarto-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Quarto und Shiny App</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorative Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Testen von Hypothesen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelle Designs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Versuchsplanung in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Einfache Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Fortgeschrittene Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-app.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistische Gruppenvergleiche</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Testen in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Der t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-mixed.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Die repeated / mixed ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-manova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Die MANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Der U-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Der Friedman Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Der Chi-Quadrat-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anteil-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Der Anteilstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-trendtest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Der Trendtest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-permutationstest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Der Permutationstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Der Post-hoc Test</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grundlagen des Modellierens</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Modelgüte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Korrelation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Ausreißer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Variablenselektion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Fehlende Werte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistisches Modellieren</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Modellieren in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-marginal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Marginal effect models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-beta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Beta Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-prob-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-robust-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Überlebenszeitanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-noninferiority.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Äquivalenz oder Nichtunterlegenheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Metaanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Fragebogenanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./time-space-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zeitliche und räumliche Analysen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-pseudo-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Pseudo Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Räumliche Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Klassifikation oder maschinelles Lernen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-pre-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Data preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title">Support vector machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">80</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./abspann.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abspann</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-spielecke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">Spielecke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./construction-zone.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">82</span>&nbsp; <span class="chapter-title">Baustelle</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#allgemeiner-hintergrund" id="toc-allgemeiner-hintergrund" class="nav-link active" data-scroll-target="#allgemeiner-hintergrund"><span class="header-section-number">33.1</span> Allgemeiner Hintergrund</a></li>
  <li><a href="#genutzte-r-pakete" id="toc-genutzte-r-pakete" class="nav-link" data-scroll-target="#genutzte-r-pakete"><span class="header-section-number">33.2</span> Genutzte R Pakete</a></li>
  <li><a href="#daten" id="toc-daten" class="nav-link" data-scroll-target="#daten"><span class="header-section-number">33.3</span> Daten</a>
  <ul class="collapse">
  <li><a href="#mixed-anova" id="toc-mixed-anova" class="nav-link" data-scroll-target="#mixed-anova"><span class="header-section-number">33.3.1</span> Mixed ANOVA</a></li>
  <li><a href="#repeated-anova" id="toc-repeated-anova" class="nav-link" data-scroll-target="#repeated-anova"><span class="header-section-number">33.3.2</span> Repeated ANOVA</a></li>
  </ul></li>
  <li><a href="#mixed-anova-1" id="toc-mixed-anova-1" class="nav-link" data-scroll-target="#mixed-anova-1"><span class="header-section-number">33.4</span> Mixed ANOVA</a>
  <ul class="collapse">
  <li><a href="#zweifaktoriell-2" id="toc-zweifaktoriell-2" class="nav-link" data-scroll-target="#zweifaktoriell-2"><span class="header-section-number">33.4.1</span> Zweifaktoriell</a></li>
  <li><a href="#dreifaktoriell-2" id="toc-dreifaktoriell-2" class="nav-link" data-scroll-target="#dreifaktoriell-2"><span class="header-section-number">33.4.2</span> Dreifaktoriell</a></li>
  </ul></li>
  <li><a href="#repeated-measurement-anova" id="toc-repeated-measurement-anova" class="nav-link" data-scroll-target="#repeated-measurement-anova"><span class="header-section-number">33.5</span> Repeated measurement ANOVA</a>
  <ul class="collapse">
  <li><a href="#einfaktoriell-1" id="toc-einfaktoriell-1" class="nav-link" data-scroll-target="#einfaktoriell-1"><span class="header-section-number">33.5.1</span> Einfaktoriell</a></li>
  <li><a href="#zweifaktoriell-3" id="toc-zweifaktoriell-3" class="nav-link" data-scroll-target="#zweifaktoriell-3"><span class="header-section-number">33.5.2</span> Zweifaktoriell</a></li>
  <li><a href="#dreifaktoriell-3" id="toc-dreifaktoriell-3" class="nav-link" data-scroll-target="#dreifaktoriell-3"><span class="header-section-number">33.5.3</span> Dreifaktoriell</a></li>
  </ul></li>
  <li><a href="#referenzen" id="toc-referenzen" class="nav-link" data-scroll-target="#referenzen">Referenzen</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-tests-anova-mixed.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-tests-anova-mixed.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-tests-preface-app.html">Statistische Gruppenvergleiche</a></li><li class="breadcrumb-item"><a href="./stat-tests-anova-mixed.html"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Die repeated / mixed ANOVA</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-anova-mixed" class="quarto-section-identifier"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Die repeated / mixed ANOVA</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code zeigen</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code verbergen</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Quellcode anzeigen</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><em>Letzte Änderung am 30. April 2025 um 13:50:16</em></p>
<blockquote class="blockquote">
<p><em>“I never once failed at making a light bulb. I just found out 99 ways not to make one.” — Thomas A. Edison</em></p>
</blockquote>
<p>In diesem Kapitel soll es dann um Messwiederholungen gehen. Wir haben also irgendwas wiederholt gemessen. Damit haben wir auch eine Zeitvariable mit in den Daten. Hier müssen wir dann etwas aufpassen, ob wir wirklich eine repeated oder mixed ANOVA rechnen wollen oder nicht doch irgendwie eine Zeitreihe vorliegen haben. Die Frage, die du dir stellen musst ist hierbei eigentlich recht einfach. Wenn du ein Interesse an einem wie auch immer gearteten Gruppenvergleich hast und du diese Gruppen über die Zeit gemessen hast, dann bist du hier in diesem Kapitel richtig. Wenn es um eine ANOVA geht, dann geht es auch immer um einen Gruppenvergleich. Ansonsten könntest du eine Prognose wollen und das wäre dann eher eine klassische Zeitreihe.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/angel_01_small.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="images/angel_01_small.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p>Hier eine kurze Warnung. Häufig wird die repeated und die mixed ANOVA in einen Topf geworfen. Die beiden Verfahren unterscheiden sich aber konzeptionell. Darüber hinaus hast du meistens in den Agrarwissenschaften eine mixed ANOVA vorliegen, wenn du mit Messwiederholungen gearbeitet hast und keine repeated ANOVA.</p>
</blockquote>
</div>
</div>
</div>
<section id="allgemeiner-hintergrund" class="level2" data-number="33.1">
<h2 data-number="33.1" class="anchored" data-anchor-id="allgemeiner-hintergrund"><span class="header-section-number">33.1</span> Allgemeiner Hintergrund</h2>
<p>Die gemischte ANOVA (eng. <em>mixed ANOVA</em>) und die ANOVA für Messwiederholungen (eng. <em>repeated ANOVA</em>) sind eng miteinander verwandt. Vermutlich ist dies auch der Grund, warum es bei beiden Verfahren so viele Verwirrungen gibt. Ebenso finden sich auch verschiedene Namen zu den beiden ANOVA Algorithmen, aber wir bleiben einmal hier bei den beiden Namen. Die beiden Verfahren basieren auf Messwiederholungen. Daher messen wir wiederholt an einer Beobachtung einen Messwert. Der Unterschied liegt in dem Versuchsdesign und welche Beobachtung welche Behandlung erhält. Wir haben haben meistens in den Agrarwissenschaften eine <em>mixed ANOVA</em> vorliegen.</p>
<dl>
<dt>Was haben die <em>mixed ANOVA</em> und die <em>repeated ANOVA</em> gemeinsam?</dt>
<dd>
<p>In beiden Fällen haben wir Messwiederholungen in unseren Daten. Das heißt, wir messen wiederholt an dem gleichen Subjekt einen Messwert. Wir messen also weiderholt die Größe einer Pflanze oder die Milchleistung einer Kuh.</p>
</dd>
</dl>
<p>Oder um den Sachstand nochmal mit einem Zitat zu untermauern, habe ich aus dem Handbuch der SPSS Statistik einmal folgende Einordnung gefunden. Hier ist nochmal wichtig, was eigentlich mit den einzelnen Beobachtungen (eng. <em>subject</em>) passiert.</p>
<blockquote class="blockquote">
<p><em>“However, the fundamental difference is that in a mixed ANOVA, the subjects that undergo each condition (e.g., a control and treatment) are different, whereas in a two-way repeated measures ANOVA, the subjects undergo both conditions (e.g., they undergo the control and the treatment).”</em> — <a href="https://statistics.laerd.com/spss-tutorials/two-way-repeated-measures-anova-using-spss-statistics.php#:~:text=A%20mixed%20ANOVA%20is%20very,factors%20on%20the%20dependent%20variable.">Two-way repeated measures ANOVA using SPSS Statistics</a></p>
</blockquote>
<p>Das klingt jetzt etwas kompliziert und deshalb habe ich dir den Zusammenhang einmal in der folgenden <a href="#fig-ggplot-theo-intro" class="quarto-xref">Abbildung&nbsp;<span class="quarto-unresolved-ref">fig-ggplot-theo-intro</span></a> visualisiert. Nehmen wir einmal an, du hast einen Behandlungsfaktor <span class="math inline">\(f_A\)</span> mit drei Leveln. Jedes Level steht für eine Art der Behandlung. Wenn wir uns jetzt eine mixed ANOVA anschauen, dann haben wir drei Individuen vorliegen, die wiederholt in der gleichen Art der Behandlung gemessen werden. Das Individium mit der <span class="math inline">\(ID_1\)</span> erhält nur die Behandlung <span class="math inline">\(A.3\)</span> wiederholt verabreicht oder steht unter dieser Behandlung. Dann messen wir wiederholt den Messwert.</p>
<p>Etwas anders sieht es dann bei der repeated ANOVA aus. Hier haben wir ein Individum was alle Behandlungen über alle Zeitpunkte erhält. Damit erhät das Individium <span class="math inline">\(ID_1\)</span> erst die Behandlung <span class="math inline">\(A.3\)</span> viermal und danach dann die beiden anderen Behandlungen auch jeweils viermal wiederholt gemessen. Das ist ein großer konzeptioneller Unterschied in dem Versuchsdesign zwischen der mixed und der repeated ANOVA. In beiden ANOVA Typen wird wiederholt gemessen. In der repeated ANOVA erhält jedes Individum aber auch alle Behandlungen über die Zeit.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-theo-intro" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-theo-intro-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova-mixed_files/figure-html/fig-ggplot-theo-intro-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Abbildung&nbsp;33.1— Konzeptionelle Darstellung der mixed und repeated ANOVA in einem Flussdiagramm mit unterschiedlichen Individuen für einen Behandlungsfaktor mit drei Leveln als Arten der Behandlung. (A) In der mixed ANOVA werden pro Art der Behandlung ein Individum wiederholt gemessen. (B) In der repeated ANOVA wird ein Individum wiederholt für jede Art der Behandlung gemessen. [Zum Vergrößern anklicken]"><img src="stat-tests-anova-mixed_files/figure-html/fig-ggplot-theo-intro-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-theo-intro-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;33.1— Konzeptionelle Darstellung der mixed und repeated ANOVA in einem Flussdiagramm mit unterschiedlichen Individuen für einen Behandlungsfaktor mit drei Leveln als Arten der Behandlung. <strong>(A)</strong> In der mixed ANOVA werden pro Art der Behandlung ein Individum wiederholt gemessen. <strong>(B)</strong> In der repeated ANOVA wird ein Individum wiederholt für jede Art der Behandlung gemessen. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Bevor wir jetzt weiter in das Modell und die einzelnen Besonderheiten der mixed ANOVA und repeated ANOVA einsteigen nochmal der Hinweis, dass wir hier natürlich auch wieder <em>nur</em> global einen Fakor testen. Das heißt, du weißt natürlich wieder nicht, welcher paarweise Vergleich innerhalb eines Faktors einen signifikanten Unterschied ausmacht, wenn du eine signifikante ANOVA vorliegen hast. Dann musst du wieder weiter machen mit einem Post-hoc Test. Auch hier hilft nochmal die Vingette von <code>{afex}</code> mit <a href="https://cran.r-project.org/web/packages/afex/vignettes/afex_anova_example.html">ANOVA and Post-Hoc Contrasts</a>. Oder wie es <span class="citation" data-cites="gueorguieva2004move">Gueorguieva &amp; Krystal (<a href="#ref-gueorguieva2004move" role="doc-biblioref">2004</a>)</span> mit der wissenschaftlichen Veröffentlichung <a href="https://jamanetwork.com/journals/psych/articlepdf/481967/ynv20002.pdf?casa_token=5gc0qQuqNFUAAAAA:SJWnX8rH6__-lxXqiF0FDGQISXgXE0JQlRgtY7EE76IFnuECNjsOvKzUIwu9hmZFrKdLJbIahfQ">Move Over ANOVA</a> und der Nutzung von linearen gemischten Modellen wie folgt beschreibt.</p>
<blockquote class="blockquote">
<p><em>“Mixed-effects models use all available data, can properly account for correlation between repeated measurements on the same subject, have greater flexibility to model time effects, and can handle missing data more appropriately. Their flexibility makes them the preferred choice for the analysis of repeated measures data”</em> — <span class="citation" data-cites="gueorguieva2004move">Gueorguieva &amp; Krystal (<a href="#ref-gueorguieva2004move" role="doc-biblioref">2004</a>)</span></p>
</blockquote>
<p>Warum machen wir das nicht immer? Also wir nutzen immer ein lineares gemischtes Modell? Das hat meistens mit der geringen Anzahl an Beobachtungen in den Gruppen und allgemein mit zu wenigen Gruppen zu tun. Häufig reicht eben das Design und die Wiederholungen nicht aus für ein sauberes gemischtes Modell. Deshab ist dann eine Lösung sich die Sachlage einmal in einer mixed oder repeated ANOVA anzuschauen. Es gilt wie immer, komplexe Fragestellungen kann man meistens nicht in einem einfachen Satz beantworten. Hier kommt es dann auch wieder auf die konkrete Fragestellung an.</p>
<section id="welche-pakete-gibt-es-eigentlich" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="welche-pakete-gibt-es-eigentlich">Welche Pakete gibt es eigentlich?</h4>
<p>Wenn um die Anwendung der mixed oder repeated ANOVA in R geht, dann haben wir eine Menge Pakete zur Auswahl. Wie immer macht die Fragestellung und das gewählte Modell den Großteil der Entscheidungsindung aus. Ich zeige dir später in der Anwendung dann auch alle Pakete einmal, gebe dir dann aber auch immer eine Empfehlung mit. Normalerweise brauchen wir einen normalverteilten Messwert <span class="math inline">\(y\)</span> und Varianzhomogenität in den Faktoren. In den letzten Jahren wurden aber noch weitere Implementierungen der ANOVA entwickelt, so dass hier auch Alternativen vorliegen.</p>
<p>Gehen wir jetzt mal die Pakete durch. Wir immer gibt es einiges an Möglichkeiten und ich zeige dir hier eben die Auswahl. Es gibt hier das ein oder andere noch zu beachten, aber da gehe ich dann bei den jeweiligen Methoden drauf ein. Es macht eben dann doch einen Unterschied ob ich eine einfaktorielle oder komplexere ANOVA rechnen will. Nicht alles geht in allen R Pakten oder gar Excel.</p>
<dl>
<dt>Der Standard mit der Funktion <code>aov()</code> aus <code>{base}</code></dt>
<dd>
<p>Die Standardfunktion <code>aov()</code> erlaubt es eine mixed oder repeated ANOVA direkt auf einem Datensatz zu rechnen. Hier brauchen wir nur ein Modell in der in R üblichen Formelschreibweise <code>y ~ f</code>. Du kannst diesen Ansatz als schnelle ANOVA begreifen. Dein Messwert <span class="math inline">\(y\)</span> muss hier normalverteilt sein.</p>
</dd>
<dt>Mit der Funktion <code>anova_test()</code> aus <code>{rstatix}</code></dt>
<dd>
<p>Das <a href="https://cran.r-project.org/web/packages/rstatix/index.html">R Paket <code>{rstatix}</code></a> bietet bietet die Funktion <code>anova_test()</code> die es erlaubt einfacher auf die Funktionalität der Funktion <code>aov()</code> und R Funktionen aus dem Paket <code>{car}</code> zuzugreifen. Es ist eben ein klassischer Wrapper um besser rechnen zu können. Aber auch hier musst du verstehen wie die Funktion funktioniert. Ich finde aber die Anwendung relativ einfach und deshalb zeige ich die Funktion hier einmal.</p>
</dd>
<dt>Mit den ANOVA Funktionen aus <code>{afex}</code></dt>
<dd>
<p>Wir können die mixed oder repeated ANOVA anwenden, wenn wir Messwiederholungen vorliegen haben. Daher bietet sich hier insbesondere das <a href="https://github.com/singmann/afex">R Paket <code>{afex}</code></a> an. Du musst bei den Funktionen von <code>{afex}</code> immer eine ID mitlaufen lassen, die angibt welche Individuen wiederholt gemessen wurden. Also hat jede Zeile eine Nummer, die beschreibt welche Beobachtung hier vorliegt. Besonders wichtig bei Messungen über die Zeit. Darüber hinaus kann das Paket sehr gut Interaktionen schätzen und Bedarf dort keiner zusätzlichen Optionen. Auch hier hilft nochmal die Vingette von <code>{afex}</code> mit <a href="https://cran.r-project.org/web/packages/afex/vignettes/afex_anova_example.html">ANOVA and Post-Hoc Contrasts</a> weiter, wenn es um den Post-hoc Test geht.</p>
</dd>
<dt>Mit den ANOVA Funktionen aus <code>{MANOVA.RM}</code></dt>
<dd>
<p><a href="https://cran.r-project.org/web/packages/MANOVA.RM/vignettes/Introduction_to_MANOVA.RM.html">Das R Paket <code>{MANOVA.RM}</code></a> von <span class="citation" data-cites="friedrich2019resampling">Friedrich et al. (<a href="#ref-friedrich2019resampling" role="doc-biblioref">2019</a>)</span> bietet eine weitere Möglichkeit die reapted und mixed ANOVA zu rechnen, wenn die Annahme an die Normalverteilung sowie der Varianzhomogenität nicht erfüllt ist. Wir haben es hier dann nochmal mit einer neueren Implementierung zu tun. Eine weitere robuste Alternative zu den Standardimplementierungen.</p>
</dd>
<dt>Mit den ANOVA Funktionen aus <code>{WRS2}</code></dt>
<dd>
<p>Eine Annahme an die mixed oder repeated ANOVA ist, dass wir es mit normalverteilten Messwerten <span class="math inline">\(y\)</span> sowie Varianzhomogenität in den Faktoren <span class="math inline">\(f\)</span> vorliegen haben. Das R Paket <code>{WRS2}</code> mit der hervorragenden Vingette <a href="https://cran.r-project.org/web/packages/WRS2/vignettes/WRS2.pdf">Robust Statistical Methods Using WRS2</a> erlaubt nun aber diese beiden Annahmen zu umgehen und bietet eine robuste ANOVA an. Robust meint hier, dass wir uns nicht um die Normalverteilung und Varianzhomogenität kümmern müssen.</p>
</dd>
</dl>
<p>Wir immer ist es hier ein Tutorium um gleich mit der ANOVA starten zu können. Wenn du tiefer in die Materie einsteigen möchtest und noch andere Dinge rechts und links anschauen willst, dann findest du in den folgenden Quellen nochmal mehr Anregungen. Es geht wie immer mehr, aber wir wollen hier dann ja auch fertig werden und haben beschlossen eine repeated oder mixed ANOVA zu rechnen.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Weitere Tutorien für die repeated &amp; mixed ANOVA
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wir oben schon erwähnt, kann dieses Kapitel nicht alle Themen der repeated und mixed ANOVA abarbeiten. Insbesondere der theoretische Hintergrund ist ja bei mir hier sehr gekürzt. Daher präsentiere ich hier eine Liste von Literatur und Links, die mich für dieses Kapitel hier inspiriert haben. Nicht alles habe ich genutzt, aber vielleicht ist für dich was dabei.</p>
<ul>
<li>Im Tutorium zur <a href="https://www.datanovia.com/en/lessons/repeated-measures-anova-in-r/">Repeated Measures ANOVA in R</a> und <a href="https://www.datanovia.com/en/lessons/mixed-anova-in-r/">Mixed ANOVA in R</a> auf der Seite Datanovia wird nochmal mehr auf die möglichen Vortest der Annahmen eingegangen. Auch wird nochmal der Posthoc-Test gezeigt, den ich ja ausgelagert habe.</li>
<li>Das Kapitel zu den <a href="https://bookdown.org/steve_midway/DAR/random-effects.html">Random Effects</a> aus dem Openbook Data Analysis in R gibt nochmal einen Einblick in die Idee der zufälligen Effekte, die wir hier bewusst etwas unter den Tisch fallen lassen.</li>
<li>Das Openbook ANOVA and Mixed Models A Short Introduction Using R gibt in dem Kapitel zu <a href="https://people.math.ethz.ch/~meier/teaching/anova/random-and-mixed-effects-models.html">Random and Mixed Effects Models</a> nochmal eine Übersicht über die verschiedenen Modelle. Insbesondere der Theorieteil ist gut, da ich ja hier in diesem Kapitel aktuell auf eine theoretische Betrachtung verzichtet habe.</li>
<li>Wenn dich die Formelschreibweise in R verwirrt, dann hilft dir nochmal der Blogeintrag zu <a href="https://conjugateprior.org/2013/01/formulae-in-r-anova/">ANOVA and other models, mixed and fixed</a>.</li>
</ul>
</div>
</div>
</section>
</section>
<section id="genutzte-r-pakete" class="level2" data-number="33.2">
<h2 data-number="33.2" class="anchored" data-anchor-id="genutzte-r-pakete"><span class="header-section-number">33.2</span> Genutzte R Pakete</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, magrittr, broom, WRS2, scales,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               readxl, see, car, patchwork, rstatix, emmeans,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               interactions, effectsize, afex, report, multcomp,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               janitor, MANOVA.RM, ggrepel, conflicted)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>mutate)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>summarize)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>filter)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>arrange)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>select)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(magrittr<span class="sc">::</span>set_names)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(magrittr<span class="sc">::</span>extract)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(effectsize<span class="sc">::</span>eta_squared)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>cbbPalette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#000000"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>, </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>An der Seite des Kapitels findest du den Link <em>Quellcode anzeigen</em>, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</p>
</section>
<section id="daten" class="level2" data-number="33.3">
<h2 data-number="33.3" class="anchored" data-anchor-id="daten"><span class="header-section-number">33.3</span> Daten</h2>
<p>Beginnen wir wie immer mit den Daten. Hier ist die Besonderheit, dass wir immer Messweiderholungen an einer Beobachtung vorliegen haben. Ich habe dann die jeweilige Beobachtung in der Spalte <code>.id</code> jeweils genau benannt. Daher kommt eben die Beobachtung mit der <code>id</code> gleich 1 mehrfach in den Daten vor. Genauer, wir haben eben nicht nur eine Zeile in den Daten für eine Beobachtung sondern mehrere Zeilen für eine Beobachtung vorliegen. Das ist am Anfang immer etwas verwirrend, aber man gewöhnt sich daran.</p>
<p>Eine weitere Besonderheit ist, dass wir häufig die Daten in einem Wide-Format erstellen. Das geißt wir haben pro Zeile eine ID und dann mehrere Spalten wo wir wiederholt messen. Wir nennen dann diese Spalten meistens <code>t0</code> bis <code>t5</code>, wenn wir sechs Zeitpunkte bemessen. In R brauchen wir dann doch wieder das Long-Format und dementsprechend nutzen wir die Funktion <code>pivot_longer()</code> um uns aus den Daten im Wide-Format die entsprechenden Daten im Long-Format zu bauen. Das Openbook <a href="https://r4ds.hadley.nz/data-tidy.html#sec-pivoting">R for Data Science</a> hat hier noch das passende Kapitel zum nachlesen. Du kannst auch das <a href="https://tidyr.tidyverse.org/#cheatsheet">Cheatsheet</a> nochmal anschauen, dort wird alles nochmal visuell erklärt.</p>
<section id="mixed-anova" class="level3" data-number="33.3.1">
<h3 data-number="33.3.1" class="anchored" data-anchor-id="mixed-anova"><span class="header-section-number">33.3.1</span> Mixed ANOVA</h3>
<p>Bei der mixed ANOVA haben wir mindestens ein zweifaktorielles Design vorliegen. Warum ist das so? Zum einen brauchen wir einen Behandlungsfaktor und dazu kommt dann noch der Faktor der Messwiederholung. Wir messen ja wiederholt und dieses wiederholte Messen kommt dann ebenfalls in einen Faktor rein. Somit haben wir einen Behandlungsfaktor und einen Zeitfaktor in den Daten. Manchmal erhöhen wir noch die Komplexität und ergänzen einen zweiten Behandlungsfaktor und haben dann einen dreifaktoriellen Datensatz vorliegen.</p>
<section id="zweifaktoriell" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="zweifaktoriell">Zweifaktoriell</h4>
<p>Im Folgenden siehst du einmal einen Datensatz für eine zweifaktorielle mixed ANOVA. In diesem Beispiel schauen wir uns nur Katzenflöhe an. Wir haben in dem Datensatz einmal den Faktor <code>feeding</code> als die Fütterungsarten mit einer Kontrolle als Zuckerwasser, Blut und einmal Ketchup sowie als zweiten Faktor die verschiedenen Zeitpunkte der Messung der Sprungweite in [cm]. Wir haben an insgesamt sechs Zeitpunkten wiederholt die Sprungweite gemessen. Wir wollen nun wissen, in wie weit sich die Sprungweite über die Zeit für die drei Floharten ändert.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mixed_fac2_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/fleas_complex_data.xlsx"</span>, </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">sheet =</span> <span class="st">"mixed-fac2"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.id, feeding, t0<span class="sc">:</span>t5) <span class="sc">|&gt;</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> t0<span class="sc">:</span>t5,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"jump_length"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"time_fct"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">feeding =</span> <span class="fu">as_factor</span>(feeding),</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">time_fct =</span> <span class="fu">as_factor</span>(time_fct),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">jump_length =</span> <span class="fu">round</span>(jump_length, <span class="dv">2</span>),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">.id =</span> <span class="fu">as_factor</span>(.id))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der folgenden Tabelle siehst du einmal die rohen Daten eingelesen. Wir haben den Faktor <code>feeding</code> sowie die sechs Zeitpunkte der Messung der Sprungweite in [cm]. Wir müssen uns dann in R die Daten über die Funktion <code>pivot_longer()</code> in ein Long-Format umwandeln.</p>
<div class="cell">
<div id="tbl-mixed-table-fac2" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mixed-table-fac2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;33.1— Rohdaten der Sprungweiten in [cm] gemessen an sechs Zeitpunkten von drei Fütterungsarten im Wide-Format für die bessere Übersicht.
</figcaption>
<div aria-describedby="tbl-mixed-table-fac2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_yu1lz2iyeu447iujitip(i, j, css_id) {
          var table = document.getElementById("tinytable_yu1lz2iyeu447iujitip");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_yu1lz2iyeu447iujitip');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_yu1lz2iyeu447iujitip(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_yu1lz2iyeu447iujitip");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 9, j: 5 }, { i: 9, j: 3 }, { i: 9, j: 1 }, { i: 9, j: 2 }, { i: 9, j: 0 }, { i: 9, j: 6 }, { i: 9, j: 4 }, { i: 9, j: 7 },  ], css_id: 'tinytable_css_l9hw1sdpqpx8u6n14dzm',}, 
          { positions: [ { i: 1, j: 0 }, { i: 5, j: 1 }, { i: 3, j: 0 }, { i: 1, j: 1 }, { i: 3, j: 1 }, { i: 1, j: 2 }, { i: 3, j: 2 }, { i: 5, j: 2 }, { i: 5, j: 0 }, { i: 7, j: 0 }, { i: 1, j: 5 }, { i: 1, j: 3 }, { i: 3, j: 3 }, { i: 5, j: 3 }, { i: 7, j: 3 }, { i: 7, j: 1 }, { i: 1, j: 6 }, { i: 1, j: 4 }, { i: 3, j: 4 }, { i: 5, j: 4 }, { i: 7, j: 4 }, { i: 7, j: 2 }, { i: 1, j: 7 }, { i: 3, j: 7 }, { i: 3, j: 5 }, { i: 5, j: 5 }, { i: 7, j: 5 }, { i: 5, j: 6 }, { i: 7, j: 6 }, { i: 5, j: 7 }, { i: 3, j: 6 }, { i: 7, j: 7 },  ], css_id: 'tinytable_css_dziyyaulolcr2qe0ohqh',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 3 }, { i: 0, j: 1 }, { i: 0, j: 7 }, { i: 0, j: 5 }, { i: 0, j: 6 }, { i: 0, j: 4 }, { i: 0, j: 2 },  ], css_id: 'tinytable_css_ht6vgnp196oz1ctmovih',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_yu1lz2iyeu447iujitip(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_l9hw1sdpqpx8u6n14dzm, .table th.tinytable_css_l9hw1sdpqpx8u6n14dzm { background-color: #ededed; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_dziyyaulolcr2qe0ohqh, .table th.tinytable_css_dziyyaulolcr2qe0ohqh { background-color: #ededed; }
      .table td.tinytable_css_ht6vgnp196oz1ctmovih, .table th.tinytable_css_ht6vgnp196oz1ctmovih { border-bottom: solid #d3d8dc 0.1em; }
    </style>
    <div class="container">
      <table class="table table-striped" id="tinytable_yu1lz2iyeu447iujitip" style="table-layout: fixed; width: 100% !important; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">.id</th>
                <th scope="col">feeding</th>
                <th scope="col">t0</th>
                <th scope="col">t1</th>
                <th scope="col">t2</th>
                <th scope="col">t3</th>
                <th scope="col">t4</th>
                <th scope="col">t5</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>1</td>
                  <td>ctrl</td>
                  <td>31.56</td>
                  <td>27.61</td>
                  <td>26.12</td>
                  <td>17.66</td>
                  <td>18.33</td>
                  <td>7.43</td>
                </tr>
                <tr>
                  <td>2</td>
                  <td>ctrl</td>
                  <td>32.87</td>
                  <td>26.12</td>
                  <td>28.23</td>
                  <td>19.25</td>
                  <td>12.01</td>
                  <td>8.75</td>
                </tr>
                <tr>
                  <td>3</td>
                  <td>ctrl</td>
                  <td>33.43</td>
                  <td>31.23</td>
                  <td>26.59</td>
                  <td>24.19</td>
                  <td>13.95</td>
                  <td>0.27</td>
                </tr>
                <tr>
                  <td>4</td>
                  <td>ctrl</td>
                  <td>24.88</td>
                  <td>30.47</td>
                  <td>26.82</td>
                  <td>23.77</td>
                  <td>20.71</td>
                  <td>1.34</td>
                </tr>
                <tr>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                </tr>
                <tr>
                  <td>21</td>
                  <td>ketchup</td>
                  <td>48.68</td>
                  <td>47.28</td>
                  <td>33.81</td>
                  <td>21.89</td>
                  <td>27.6</td>
                  <td>33.84</td>
                </tr>
                <tr>
                  <td>22</td>
                  <td>ketchup</td>
                  <td>51.56</td>
                  <td>49.85</td>
                  <td>37.17</td>
                  <td>30.66</td>
                  <td>27.67</td>
                  <td>35.03</td>
                </tr>
                <tr>
                  <td>23</td>
                  <td>ketchup</td>
                  <td>53.51</td>
                  <td>47.6</td>
                  <td>33.31</td>
                  <td>30.46</td>
                  <td>25.32</td>
                  <td>28.31</td>
                </tr>
                <tr>
                  <td>24</td>
                  <td>ketchup</td>
                  <td>49.38</td>
                  <td>42.85</td>
                  <td>31.99</td>
                  <td>34.09</td>
                  <td>27.1</td>
                  <td>34.81</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<p>Jetzt habe ich dir in der folgenden Abbildung auch nochmal das Versuchsdesign aufgezeigt. Wie du siehst, haben wir immer einen Floh, der eine Behandlung mit einer Fütterungsart erhält. Dieser Flog springt dann zum Beispiel unter der Fütterung mit Ketchup sechs Mal und wir notieren jedesmal die Sprungweite zu den Messzeitpunkten.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-theo-mixed-fac2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-theo-mixed-fac2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova-mixed_files/figure-html/fig-ggplot-theo-mixed-fac2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Abbildung&nbsp;33.2— Versuchsdesign der zweifaktoriellen mixed ANOVA. Der erste Faktor ist die Fütterungsart feeding. Jeder Floh erhält eine Fütterung und anschließend wird sechs mal die Sprungweite gemessen. Hier sind nur vier Zeitpunkte dargestellt. [Zum Vergrößern anklicken]"><img src="stat-tests-anova-mixed_files/figure-html/fig-ggplot-theo-mixed-fac2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-theo-mixed-fac2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;33.2— Versuchsdesign der zweifaktoriellen mixed ANOVA. Der erste Faktor ist die Fütterungsart <code>feeding</code>. Jeder Floh erhält eine Fütterung und anschließend wird sechs mal die Sprungweite gemessen. Hier sind nur vier Zeitpunkte dargestellt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>In der folgenden Abbildung siehst du dann nochmal den Zusammenhang zwischen der Sprungweite in [cm] der Katzenflöhe unter unterschiedlichen Fütterungsarten. Dabei wurden die Flöhe wiederholt an sechs Zeitpunkten gemessen. Wir du siehst, fällt mit der Zeit die Sprungleistung ab. Die Katzenflöhe springen unabhängig von der Fütterungsart weniger weit mit der Zeit. Am letzten Zeitpunkt scheinen die Flöhe unter Ketchupernährung dann wieder etwas weiter zu springen. Jetzt müssen wir aber einmal statistisch Nachweisen, ob wir hier wirklich einen signifikanten Zusammenhang und Unterschiede zwischen den Fütterungsarten vorliegen haben.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-anova-mixed-fac2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-anova-mixed-fac2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova-mixed_files/figure-html/fig-ggplot-anova-mixed-fac2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Abbildung&nbsp;33.3— Darstellung des Zusammenhangs zwischen der Fütterung von Katzenflöhen und der gemessenen Sprungweite in [cm] über sechs Messzeitpunkte. Die Linie stellt den jeweiligen Mittelwert zu dem Zeitpunkt und der Fütterungsart dar. [Zum Vergrößern anklicken]"><img src="stat-tests-anova-mixed_files/figure-html/fig-ggplot-anova-mixed-fac2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-anova-mixed-fac2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;33.3— Darstellung des Zusammenhangs zwischen der Fütterung von Katzenflöhen und der gemessenen Sprungweite in [cm] über sechs Messzeitpunkte. Die Linie stellt den jeweiligen Mittelwert zu dem Zeitpunkt und der Fütterungsart dar. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="dreifaktoriell" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="dreifaktoriell">Dreifaktoriell</h4>
<p>Für unser dreifaktorielles Beispiel erweiter wir einmal den Datensatz um ein Workout für die Katzenflöhe. Neben den drei Fütterungsarten Kontrolle mit Zuckerwasser, Blut sowie Ketchup mussten die Flöhe als zweiten Faktor noch ein Workout bestehen. Dabei haben nicht alle Katzenflöhe jeweils trainiert, sondern wir haben eine untrainierte Gruppe sowie eine trainierte Gruppe. Beide Gruppen des Workout wurden dann mit allen drei Fütterungsarten gefüttert. Dann wurden insgesamt zu sechs Zeitpunkten die Sprungweite in [cm] bestimmt. Wir haben es daher mit einem dreifaktoriellen Datensatz zu tun, da wir zwei Behandlungsfaktoren sowie den Faktor der Messwiederholungen in unseren Daten vorliegen haben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mixed_fac3_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/fleas_complex_data.xlsx"</span>, </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">sheet =</span> <span class="st">"mixed-fac3"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.id, feeding, workout, t0<span class="sc">:</span>t5) <span class="sc">|&gt;</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> t0<span class="sc">:</span>t5,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"jump_length"</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"time_fct"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">feeding =</span> <span class="fu">as_factor</span>(feeding),</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">workout =</span> <span class="fu">as_factor</span>(workout),</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">time_fct =</span> <span class="fu">as_factor</span>(time_fct),</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">jump_length =</span> <span class="fu">round</span>(jump_length, <span class="dv">2</span>),</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">.id =</span> <span class="fu">as_factor</span>(.id))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der folgenden Tabelle sind die Daten dann nochmal im Wide-Format dargestellt. Wir haben hier dann pro Floh jeweils eine Faktorkombination aus der Fütterungsart <code>feeding</code> sowie dem Traingsstatus <code>workout</code>. Im Anschluss haben wir dann die Sprungweite von jedem Floh sechsmal gemessen. Wir müssen dann in R die Daten nochmal in das Long-Format über die Funktion <code>pivot_longer()</code> umbauen.</p>
<div class="cell">
<div id="tbl-mixed-table-fac3" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mixed-table-fac3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;33.2— Rohdaten der Sprungweiten in [cm] gemessen an sechs Zeitpunkten von drei Fütterungsarten sowie dem Status des Workouts im Wide-Format für die bessere Übersicht.
</figcaption>
<div aria-describedby="tbl-mixed-table-fac3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_u7kijnf1gs7pinrfibjl(i, j, css_id) {
          var table = document.getElementById("tinytable_u7kijnf1gs7pinrfibjl");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_u7kijnf1gs7pinrfibjl');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_u7kijnf1gs7pinrfibjl(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_u7kijnf1gs7pinrfibjl");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 9, j: 6 }, { i: 9, j: 4 }, { i: 9, j: 2 }, { i: 9, j: 0 }, { i: 9, j: 3 }, { i: 9, j: 1 }, { i: 9, j: 7 }, { i: 9, j: 5 }, { i: 9, j: 8 },  ], css_id: 'tinytable_css_jvnx9nve690r8jo1q4p2',}, 
          { positions: [ { i: 1, j: 0 }, { i: 3, j: 0 }, { i: 1, j: 1 }, { i: 3, j: 1 }, { i: 1, j: 2 }, { i: 3, j: 2 }, { i: 5, j: 2 }, { i: 5, j: 0 }, { i: 7, j: 0 }, { i: 1, j: 5 }, { i: 1, j: 3 }, { i: 3, j: 3 }, { i: 5, j: 3 }, { i: 5, j: 1 }, { i: 7, j: 1 }, { i: 1, j: 6 }, { i: 1, j: 4 }, { i: 3, j: 4 }, { i: 5, j: 4 }, { i: 7, j: 4 }, { i: 7, j: 2 }, { i: 1, j: 7 }, { i: 3, j: 7 }, { i: 3, j: 5 }, { i: 5, j: 5 }, { i: 7, j: 5 }, { i: 7, j: 3 }, { i: 1, j: 8 }, { i: 3, j: 8 }, { i: 3, j: 6 }, { i: 5, j: 6 }, { i: 7, j: 6 }, { i: 5, j: 7 }, { i: 7, j: 7 }, { i: 5, j: 8 }, { i: 7, j: 8 },  ], css_id: 'tinytable_css_6galgqqv1szb4krvtgii',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 3 }, { i: 0, j: 1 }, { i: 0, j: 7 }, { i: 0, j: 5 }, { i: 0, j: 8 }, { i: 0, j: 6 }, { i: 0, j: 4 }, { i: 0, j: 2 },  ], css_id: 'tinytable_css_uvx5fkys847eiysgbhx5',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_u7kijnf1gs7pinrfibjl(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_jvnx9nve690r8jo1q4p2, .table th.tinytable_css_jvnx9nve690r8jo1q4p2 { background-color: #ededed; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_6galgqqv1szb4krvtgii, .table th.tinytable_css_6galgqqv1szb4krvtgii { background-color: #ededed; }
      .table td.tinytable_css_uvx5fkys847eiysgbhx5, .table th.tinytable_css_uvx5fkys847eiysgbhx5 { border-bottom: solid #d3d8dc 0.1em; }
    </style>
    <div class="container">
      <table class="table table-striped" id="tinytable_u7kijnf1gs7pinrfibjl" style="table-layout: fixed; width: 100% !important; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">.id</th>
                <th scope="col">feeding</th>
                <th scope="col">workout</th>
                <th scope="col">t0</th>
                <th scope="col">t1</th>
                <th scope="col">t2</th>
                <th scope="col">t3</th>
                <th scope="col">t4</th>
                <th scope="col">t5</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>1</td>
                  <td>ctrl</td>
                  <td>yes</td>
                  <td>44.5</td>
                  <td>32.4</td>
                  <td>33.02</td>
                  <td>18.14</td>
                  <td>20.88</td>
                  <td>10.78</td>
                </tr>
                <tr>
                  <td>2</td>
                  <td>ctrl</td>
                  <td>yes</td>
                  <td>36.33</td>
                  <td>37.05</td>
                  <td>31.79</td>
                  <td>25.72</td>
                  <td>28.01</td>
                  <td>8.79</td>
                </tr>
                <tr>
                  <td>3</td>
                  <td>ctrl</td>
                  <td>yes</td>
                  <td>31.76</td>
                  <td>31.75</td>
                  <td>29.82</td>
                  <td>26.39</td>
                  <td>27.4</td>
                  <td>15.52</td>
                </tr>
                <tr>
                  <td>4</td>
                  <td>ctrl</td>
                  <td>yes</td>
                  <td>38.28</td>
                  <td>37.08</td>
                  <td>30.53</td>
                  <td>27.8</td>
                  <td>28.37</td>
                  <td>5.21</td>
                </tr>
                <tr>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                </tr>
                <tr>
                  <td>21</td>
                  <td>ketchup</td>
                  <td>no</td>
                  <td>59.12</td>
                  <td>51.66</td>
                  <td>35.64</td>
                  <td>39.56</td>
                  <td>27.77</td>
                  <td>32.88</td>
                </tr>
                <tr>
                  <td>22</td>
                  <td>ketchup</td>
                  <td>no</td>
                  <td>53.51</td>
                  <td>58.28</td>
                  <td>36.65</td>
                  <td>34.62</td>
                  <td>28.09</td>
                  <td>38.01</td>
                </tr>
                <tr>
                  <td>23</td>
                  <td>ketchup</td>
                  <td>no</td>
                  <td>62.22</td>
                  <td>48.53</td>
                  <td>46.73</td>
                  <td>34.81</td>
                  <td>34.2</td>
                  <td>29.03</td>
                </tr>
                <tr>
                  <td>24</td>
                  <td>ketchup</td>
                  <td>no</td>
                  <td>53.4</td>
                  <td>52</td>
                  <td>37.78</td>
                  <td>47.77</td>
                  <td>35.5</td>
                  <td>27.63</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<p>Manchmal ist es schwer die Zusammenhänge dann in dem Datensatz zu sehen, deshalb hier nochmal das Versuchsdesign visualisert. Jeder Katznfloh springt wiederholt, aber das ganz dann nur unter einer Faktorkombination.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-theo-mixed-fac3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-theo-mixed-fac3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova-mixed_files/figure-html/fig-ggplot-theo-mixed-fac3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Abbildung&nbsp;33.4— Versuchsdesign der dreifaktoriellen mixed ANOVA. Der erste Faktor ist die Fütterungsart feeding. Der zweite Faktor der Status des Workouts für jeden Floh workout. Jeder Floh erhält eine Fütterung sowie ein Workout und anschließend wird sechs mal die Sprungweite gemessen. Hier sind nur vier Zeitpunkte dargestellt. [Zum Vergrößern anklicken]"><img src="stat-tests-anova-mixed_files/figure-html/fig-ggplot-theo-mixed-fac3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-theo-mixed-fac3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;33.4— Versuchsdesign der dreifaktoriellen mixed ANOVA. Der erste Faktor ist die Fütterungsart <code>feeding</code>. Der zweite Faktor der Status des Workouts für jeden Floh <code>workout</code>. Jeder Floh erhält eine Fütterung sowie ein Workout und anschließend wird sechs mal die Sprungweite gemessen. Hier sind nur vier Zeitpunkte dargestellt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Abschließend können wir uns dann nochmal die Daten in der folgenden Abbildung anschauen. Auf den ersten Blick sehen wir, dass die Leistung in der Sprungweite über die Zeit abfällt. Diesen Trend können wir über alle Fütterungsarten beobachten. Was erst auf den zweiten Blick auffällt ist, dass teilweise ja nach Fütterungsart ein Training positiv oder negativ ausfällt. So führt ein Training bei den Kontrollflöhen zu weiteren Sprüngen. Die Katzenflöhe unter einer Blutdiät springen jedoch unter Training nicht so weit wie ohne ein Training.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-anova-mixed-fac3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-anova-mixed-fac3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova-mixed_files/figure-html/fig-ggplot-anova-mixed-fac3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Abbildung&nbsp;33.5— Darstellung des Zusammenhangs zwischen der Fütterung von Katzenflöhen sowie der Trainingszustand und der gemessenen Sprungweite in [cm] über sechs Messzeitpunkte. Die Linie stellt den jeweiligen Mittelwert zu dem Zeitpunkt und der Fütterungsart sowie des Trainings dar. [Zum Vergrößern anklicken]"><img src="stat-tests-anova-mixed_files/figure-html/fig-ggplot-anova-mixed-fac3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-anova-mixed-fac3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;33.5— Darstellung des Zusammenhangs zwischen der Fütterung von Katzenflöhen sowie der Trainingszustand und der gemessenen Sprungweite in [cm] über sechs Messzeitpunkte. Die Linie stellt den jeweiligen Mittelwert zu dem Zeitpunkt und der Fütterungsart sowie des Trainings dar. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="repeated-anova" class="level3" data-number="33.3.2">
<h3 data-number="33.3.2" class="anchored" data-anchor-id="repeated-anova"><span class="header-section-number">33.3.2</span> Repeated ANOVA</h3>
<p>Die repeated ANOVA ist in den Agrarwissenschaften selten. In den Sozialwissenschaften oder aber allgemeiner den Humanwissenschaften kommt die repeated ANOVA häufiger vor. Das hat vor allem damit zu tun, dass wir jedes Individuum mit allen Faktorkombinationen behandeln und wiederholt messen. Das wir ein Subjekt wiederholt messen kommt auch häufiger in den Agrarwissenschaften vor, aber selten erhält jedes Tier oder Pflanze alle Behandlungen verabreicht. Deshalb hier einmal die Daten für die repated ANOVA als Veranschaulichung was du als Daten und Experiment vorliegen haben musst.</p>
<section id="einfaktoriell" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="einfaktoriell">Einfaktoriell</h4>
<p>Im Gegensatz zu mxied ANOVA können wir in der repeated ANOVA auch nur den einfaktoriellen Fall vorliegen haben. Da klingt jetzt erstmal etwas seltsam, aber wir haben in diesem Fall nur die Zeitpunkte als Faktor vorliegen. Wir messen also nur Katzenflöhe ohne eine Behandlung viermal. Wir schauen also, ob sich die Sprungweite von Katzenflöhen über die Zeitpunkte verändert. Wir vergleichen faktisch also nur die Zeitpunkte untereinander.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>repeated_fac1_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/fleas_complex_data.xlsx"</span>, </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">sheet =</span> <span class="st">"repeated-fac1"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.id, animal, t1<span class="sc">:</span>t4) <span class="sc">|&gt;</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> t1<span class="sc">:</span>t4,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"jump_length"</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"time_fct"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal),</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">time_fct =</span> <span class="fu">as_factor</span>(time_fct),</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">jump_length =</span> <span class="fu">round</span>(jump_length, <span class="dv">2</span>),</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">.id =</span> <span class="fu">as_factor</span>(.id))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Auch hier einmal die Daten im Wide-Format, damit die Daten etwas übersichtlicher sind. Wir haben nur die Katzenflöhe vorligen und schauen uns zwölf einzelne Katzenflöhe an. Jeder Floh springt dann vier Mal und wir messen dann die Sprungweite in [cm]. Wir müssen uns dann noch das Long-Format über die Funktion <code>pivot_longer()</code> in R bauen.</p>
<div class="cell">
<div id="tbl-repeated-table-fac1" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-repeated-table-fac1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;33.3— Rohdaten der Sprungweiten in [cm] gemessen an vier Zeitpunkten im Wide-Format für die bessere Übersicht.
</figcaption>
<div aria-describedby="tbl-repeated-table-fac1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_m5hsusylwstqnlf6216y(i, j, css_id) {
          var table = document.getElementById("tinytable_m5hsusylwstqnlf6216y");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_m5hsusylwstqnlf6216y');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_m5hsusylwstqnlf6216y(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_m5hsusylwstqnlf6216y");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 7, j: 0 }, { i: 7, j: 1 }, { i: 7, j: 2 }, { i: 7, j: 3 }, { i: 7, j: 4 }, { i: 7, j: 5 },  ], css_id: 'tinytable_css_2dyt3idk0tqqjuo0hf8f',}, 
          { positions: [ { i: 3, j: 0 }, { i: 5, j: 0 }, { i: 5, j: 1 }, { i: 1, j: 0 }, { i: 1, j: 1 }, { i: 3, j: 1 }, { i: 3, j: 2 }, { i: 5, j: 2 }, { i: 5, j: 3 }, { i: 1, j: 2 }, { i: 1, j: 3 }, { i: 3, j: 3 }, { i: 3, j: 4 }, { i: 5, j: 4 }, { i: 5, j: 5 }, { i: 1, j: 4 }, { i: 1, j: 5 }, { i: 3, j: 5 },  ], css_id: 'tinytable_css_i04r61qe4b3dnhvuijos',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 }, { i: 0, j: 4 }, { i: 0, j: 5 },  ], css_id: 'tinytable_css_zwzd9sa1u29e00j4dhvn',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_m5hsusylwstqnlf6216y(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_2dyt3idk0tqqjuo0hf8f, .table th.tinytable_css_2dyt3idk0tqqjuo0hf8f { background-color: #ededed; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_i04r61qe4b3dnhvuijos, .table th.tinytable_css_i04r61qe4b3dnhvuijos { background-color: #ededed; }
      .table td.tinytable_css_zwzd9sa1u29e00j4dhvn, .table th.tinytable_css_zwzd9sa1u29e00j4dhvn { border-bottom: solid #d3d8dc 0.1em; }
    </style>
    <div class="container">
      <table class="table table-striped" id="tinytable_m5hsusylwstqnlf6216y" style="table-layout: fixed; width: 100% !important; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">.id</th>
                <th scope="col">animal</th>
                <th scope="col">t1</th>
                <th scope="col">t2</th>
                <th scope="col">t3</th>
                <th scope="col">t4</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>1</td>
                  <td>cat</td>
                  <td>23.72</td>
                  <td>37.57</td>
                  <td>36.67</td>
                  <td>25.89</td>
                </tr>
                <tr>
                  <td>2</td>
                  <td>cat</td>
                  <td>17.84</td>
                  <td>29.36</td>
                  <td>22.63</td>
                  <td>15.44</td>
                </tr>
                <tr>
                  <td>3</td>
                  <td>cat</td>
                  <td>24.11</td>
                  <td>30.43</td>
                  <td>30</td>
                  <td>28.14</td>
                </tr>
                <tr>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                </tr>
                <tr>
                  <td>10</td>
                  <td>cat</td>
                  <td>28.52</td>
                  <td>32.39</td>
                  <td>33.35</td>
                  <td>23.91</td>
                </tr>
                <tr>
                  <td>11</td>
                  <td>cat</td>
                  <td>25.46</td>
                  <td>29.02</td>
                  <td>22.68</td>
                  <td>19.88</td>
                </tr>
                <tr>
                  <td>12</td>
                  <td>cat</td>
                  <td>20.92</td>
                  <td>34.39</td>
                  <td>26.81</td>
                  <td>24.76</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<p>So ergibt sich dann auch ein sehr simples Versuchsdesign. Wir lassen jeden Katzenfloh viermal springen und messen jeweils die Sprungweite für jeden Floh.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-theo-repeated-fac1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-theo-repeated-fac1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova-mixed_files/figure-html/fig-ggplot-theo-repeated-fac1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Abbildung&nbsp;33.6— Versuchsdesign der einfaktoriellen repeated ANOVA. Jeder Katzenfloh springt viermal und wird dabei gemessen. Keine weiteren Faktoren liegen vor. [Zum Vergrößern anklicken]"><img src="stat-tests-anova-mixed_files/figure-html/fig-ggplot-theo-repeated-fac1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-theo-repeated-fac1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;33.6— Versuchsdesign der einfaktoriellen repeated ANOVA. Jeder Katzenfloh springt viermal und wird dabei gemessen. Keine weiteren Faktoren liegen vor. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Damit ergibt sich am Ende auch eine sehr übersichtliche Abbildung. Wir sehen einmal die einzelnen Katzenflöhe. Jede Sprungweite über die vier Zeitpunkte habe ich für die individuellen Flöhe mit einer gestrichelten Linie verbunden. Den globalen Trend kannst du in der farbigen Linie nachvollziehen. Am Anfang springen die Flöhe nicht soweit, steigern sich dann zum zweiten Messzeitpunkt um dann wieder stetig abzunehmen. Einzelne Flöhe zeigen dabei eine größere Variabilität als der globale Trend.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-anova-repeated-fac1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-anova-repeated-fac1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova-mixed_files/figure-html/fig-ggplot-anova-repeated-fac1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Abbildung&nbsp;33.7— Darstellung des Zusammenhangs zwischen der gemessenen Sprungweite in [cm] und den vier Messzeitpunkten. Die gestrichelte Linie verbindet die einzelnen individuellen Katzenflöhe. Die durchgezogene Linie stellt den Mittelwert zu dem jeweiligen Zeitpunkt dar. [Zum Vergrößern anklicken]"><img src="stat-tests-anova-mixed_files/figure-html/fig-ggplot-anova-repeated-fac1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-anova-repeated-fac1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;33.7— Darstellung des Zusammenhangs zwischen der gemessenen Sprungweite in [cm] und den vier Messzeitpunkten. Die gestrichelte Linie verbindet die einzelnen individuellen Katzenflöhe. Die durchgezogene Linie stellt den Mittelwert zu dem jeweiligen Zeitpunkt dar. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="zweifaktoriell-1" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="zweifaktoriell-1">Zweifaktoriell</h4>
<p>Eigentlich wird die Besonderheit des repeated Design einer ANOVA erst bei der zweifaktoriellen repeated ANOVA so richtig ersichtlich. Hier haben wir es nämlich zum einen mit einem Behandlungsfaktor zu tun und einer Faktor mit den jeweiligen Messzeitpunkten. Wir haben hier wieder die Katzenflöhe mit unterschiedlichen Fütterungsarten ernährt und dann an vier Zeitpunkten gemessen, wie weit die Flöhe springen. Die Besonderheit ist jetzt, dass <em>jeder</em> Katzenfloh alle Behandlungen durchläuft. Das macht einen gewaltigen Unterschied im Design und in der Auswertung.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>repeated_fac2_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/fleas_complex_data.xlsx"</span>, </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">sheet =</span> <span class="st">"repeated-fac2"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.id, animal, feeding, t1<span class="sc">:</span>t4) <span class="sc">|&gt;</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> t1<span class="sc">:</span>t4,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"jump_length"</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"time_fct"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">feeding =</span> <span class="fu">as_factor</span>(feeding),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">time_fct =</span> <span class="fu">as_factor</span>(time_fct),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">jump_length =</span> <span class="fu">round</span>(jump_length, <span class="dv">2</span>),</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">.id =</span> <span class="fu">as_factor</span>(.id))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der folgenden Tabelle der Rohdaten der Sprungweiten in [cm] unserer Katzenflöhe siehst du nochmal die Besonderheit der Messwiederholung. Wir messen die Sprungweite von jedem Floh <span class="math inline">\(.id\)</span> viermal für jede Fütterungsart. Wir müssen natürlich zwischen den Fütterungsarten Zeit lassen, damit wir wieder die Fütterungseffekte raus haben, aber ansonsten wird jeder Floh mit allen Ernährungsformen gefüttert. Hier ist dann auch die <span class="math inline">\(.id\)</span> Spalte so wichtig, da wir ja wissen müssen welche Fütterungsart zu welchem Floh gehört. Abschließend nutzen wir die Funktion <code>pivot_longer()</code> um uns die Daten passend in R zusammenzubauen.</p>
<div class="cell">
<div id="tbl-repeated-table-fac2" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-repeated-table-fac2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;33.4— Rohdaten der Sprungweiten in [cm] nach unterschiedlichen Fütterungsarten gemessen an vier Zeitpunkten im Wide-Format für die bessere Übersicht. Hier erhält jeder Floh jede Behandlung als Fütterung einmal.
</figcaption>
<div aria-describedby="tbl-repeated-table-fac2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_qpcdrf6i1r67y1i4apfz(i, j, css_id) {
          var table = document.getElementById("tinytable_qpcdrf6i1r67y1i4apfz");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_qpcdrf6i1r67y1i4apfz');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_qpcdrf6i1r67y1i4apfz(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_qpcdrf6i1r67y1i4apfz");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 9, j: 4 }, { i: 9, j: 0 }, { i: 9, j: 1 }, { i: 9, j: 2 }, { i: 9, j: 5 }, { i: 9, j: 3 }, { i: 9, j: 6 },  ], css_id: 'tinytable_css_l23859d3am8wtmchb3qb',}, 
          { positions: [ { i: 1, j: 0 }, { i: 5, j: 0 }, { i: 5, j: 1 }, { i: 3, j: 0 }, { i: 1, j: 1 }, { i: 3, j: 1 }, { i: 1, j: 2 }, { i: 3, j: 2 }, { i: 5, j: 2 }, { i: 7, j: 2 }, { i: 7, j: 0 }, { i: 1, j: 5 }, { i: 1, j: 3 }, { i: 3, j: 3 }, { i: 5, j: 3 }, { i: 7, j: 3 }, { i: 7, j: 1 }, { i: 1, j: 6 }, { i: 1, j: 4 }, { i: 3, j: 4 }, { i: 5, j: 4 }, { i: 7, j: 4 }, { i: 5, j: 5 }, { i: 7, j: 5 }, { i: 5, j: 6 }, { i: 3, j: 5 }, { i: 3, j: 6 }, { i: 7, j: 6 },  ], css_id: 'tinytable_css_det9nzasxb4thvdchmbr',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 3 }, { i: 0, j: 1 }, { i: 0, j: 4 }, { i: 0, j: 5 }, { i: 0, j: 6 }, { i: 0, j: 2 },  ], css_id: 'tinytable_css_uvzqx0rdek8oiqczml6l',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_qpcdrf6i1r67y1i4apfz(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_l23859d3am8wtmchb3qb, .table th.tinytable_css_l23859d3am8wtmchb3qb { background-color: #ededed; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_det9nzasxb4thvdchmbr, .table th.tinytable_css_det9nzasxb4thvdchmbr { background-color: #ededed; }
      .table td.tinytable_css_uvzqx0rdek8oiqczml6l, .table th.tinytable_css_uvzqx0rdek8oiqczml6l { border-bottom: solid #d3d8dc 0.1em; }
    </style>
    <div class="container">
      <table class="table table-striped" id="tinytable_qpcdrf6i1r67y1i4apfz" style="table-layout: fixed; width: 100% !important; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">.id</th>
                <th scope="col">animal</th>
                <th scope="col">feeding</th>
                <th scope="col">t1</th>
                <th scope="col">t2</th>
                <th scope="col">t3</th>
                <th scope="col">t4</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>1</td>
                  <td>cat</td>
                  <td>ctrl</td>
                  <td>34.85</td>
                  <td>50.21</td>
                  <td>50.4</td>
                  <td>40.92</td>
                </tr>
                <tr>
                  <td>1</td>
                  <td>cat</td>
                  <td>blood</td>
                  <td>50.37</td>
                  <td>57.87</td>
                  <td>66.84</td>
                  <td>45.45</td>
                </tr>
                <tr>
                  <td>1</td>
                  <td>cat</td>
                  <td>ketchup</td>
                  <td>51.01</td>
                  <td>44.54</td>
                  <td>42.65</td>
                  <td>38.74</td>
                </tr>
                <tr>
                  <td>2</td>
                  <td>cat</td>
                  <td>ctrl</td>
                  <td>34.24</td>
                  <td>43.85</td>
                  <td>37.34</td>
                  <td>30.92</td>
                </tr>
                <tr>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                </tr>
                <tr>
                  <td>11</td>
                  <td>cat</td>
                  <td>ketchup</td>
                  <td>42.29</td>
                  <td>49.83</td>
                  <td>46.08</td>
                  <td>39.97</td>
                </tr>
                <tr>
                  <td>12</td>
                  <td>cat</td>
                  <td>ctrl</td>
                  <td>42.88</td>
                  <td>46.23</td>
                  <td>45.93</td>
                  <td>29.81</td>
                </tr>
                <tr>
                  <td>12</td>
                  <td>cat</td>
                  <td>blood</td>
                  <td>49.9</td>
                  <td>56.72</td>
                  <td>66.54</td>
                  <td>47.85</td>
                </tr>
                <tr>
                  <td>12</td>
                  <td>cat</td>
                  <td>ketchup</td>
                  <td>46.47</td>
                  <td>52.61</td>
                  <td>44.92</td>
                  <td>33.58</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<p>In der folgenden Abbildung siehst du dann das Versuchsdesign für einen Katzenfloh nochmal dargestellt. Der Floh beginnt mit der Ernährungsform <code>ketchup</code> und springt dann viermal. Jedes Mal messen wir dann die Sprungweite. Nach einer Pause erhält der gleiche Katzenfloh dann die Ernährungsform <code>blood</code> und springt wieder zeitversetzt viermal. Am Ende ernähren wir dann den Floh noch mit Zuckerwasser <code>ctrl</code> und lassen ihn abschließend viermal springen. Damit springt ein einzelner Katzenfloh über den Versuch hinweg zwölfmal unter verschiedenen Versuchsbedingungen. Wie du siehst, ist dieses Design vermutlich nicht so häufig in den Agrarwissenschaften anzutreffen.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-theo-repeated-fac2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-theo-repeated-fac2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova-mixed_files/figure-html/fig-ggplot-theo-repeated-fac2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Abbildung&nbsp;33.8— Versuchsdesign der zweifaktoriellen repeated ANOVA. Jeder Katzenfloh springt viermal unter jeder Fütterungsart und wird dabei gemessen. Damit messen wir einen Floh insgesamt zwölfmal. [Zum Vergrößern anklicken]"><img src="stat-tests-anova-mixed_files/figure-html/fig-ggplot-theo-repeated-fac2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-theo-repeated-fac2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;33.8— Versuchsdesign der zweifaktoriellen repeated ANOVA. Jeder Katzenfloh springt viermal unter jeder Fütterungsart und wird dabei gemessen. Damit messen wir einen Floh insgesamt zwölfmal. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Dann schauen wir uns nochmal den Zusammenhang zwischen der Ernährungsart und den einzelnen Zeitpunkten einmal in einer Abbildung an. Die einzelnen Flöhe sind als getrichelte Linien dargestellt. Die durchgezogenen Linien stellen die globalen Mittelwerte an den jeweiligen Zeitpunkten für die Fütterungsart dar. Wir sehen, dass wir Unterschiede in den Sprungweiten über die Zeitpunkte je nach Ernährungsform vorliegen haben. Dabei haben die Kontrolle und der Ketchup ähnliche Verläufe.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-anova-repeated-fac2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-anova-repeated-fac2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova-mixed_files/figure-html/fig-ggplot-anova-repeated-fac2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Abbildung&nbsp;33.9— Darstellung des Zusammenhangs zwischen der gemessenen Sprungweite in [cm] und den vier Messzeitpunkten sowie den Fütterungsarten. Die gestrichelte Linie verbindet die einzelnen individuellen Katzenflöhe. Die durchgezogene Linie stellt den Mittelwert zu dem jeweiligen Zeitpunkt dar. [Zum Vergrößern anklicken]"><img src="stat-tests-anova-mixed_files/figure-html/fig-ggplot-anova-repeated-fac2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-anova-repeated-fac2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;33.9— Darstellung des Zusammenhangs zwischen der gemessenen Sprungweite in [cm] und den vier Messzeitpunkten sowie den Fütterungsarten. Die gestrichelte Linie verbindet die einzelnen individuellen Katzenflöhe. Die durchgezogene Linie stellt den Mittelwert zu dem jeweiligen Zeitpunkt dar. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="dreifaktoriell-1" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="dreifaktoriell-1">Dreifaktoriell</h4>
<p>Jetzt wird es richtig wild. Wir schauen uns jetzt nämlich nicht nur einen Behandlungsfaktor an, sondern haben zwei Behandlungen sowie die Messwiederholungen als Faktor über die Zeit. Wir schauen hier einmal auf die Fütterungsart mit der Kontrolle als Zuckerwasser, der Gabe von Blut sowie der Fütterung mit Ketchup. Dazu kommt dann noch eine Workoutsession oder eben keine Workoutsession. Wir haben damit zwei Behandlungsfaktoren vorliegen. Da wir ja nun jeden Floh wiederholt messen unter jeder Faktorkombination, kommt hier einiges an Sprungweitenmessung auf jeden einzelnen Floh zu. Daher sind repeated ANOVAs selten. Wir müssen ja nicht nur jeden Floh wiederholt für die Fütterungen durchmessen sondern eben auch nochnmal alles wiederholt für die beiden Workoutgruppen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>repeated_fac3_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/fleas_complex_data.xlsx"</span>, </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">sheet =</span> <span class="st">"repeated-fac3"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.id, animal, feeding, workout, t1<span class="sc">:</span>t4) <span class="sc">|&gt;</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> t1<span class="sc">:</span>t4,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"jump_length"</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"time_fct"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">feeding =</span> <span class="fu">as_factor</span>(feeding),</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">workout =</span> <span class="fu">as_factor</span>(workout),</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">time_fct =</span> <span class="fu">as_factor</span>(time_fct),</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">jump_length =</span> <span class="fu">round</span>(jump_length, <span class="dv">2</span>),</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">.id =</span> <span class="fu">as_factor</span>(.id))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der folgenden Tabelle siehst du einmal die Daten im Wide-Format. In den ersten beiden Zeilen siehst du auch schon die Besonderheit. Wir Füttern eben einmal mit Bkut und messen dann viermal die Sprungweite für die beiden Gruppen des Workout. Daher messen wir dann jeden Floh insgesamt vierundzwanzigmal mit den jeweiligen Pausen zwischen den Behandlungskombinationen. Da kommen schon eine Menge Sprünge zusammen.</p>
<div class="cell">
<div id="tbl-repeated-table-fac3" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-repeated-table-fac3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;33.5— Rohdaten der Sprungweiten in [cm] nach unterschiedlichen Fütterungsarten und Workoutstatus gemessen an vier Zeitpunkten im Wide-Format für die bessere Übersicht. Hier erhält jeder Floh jede Behandlungskombination aus Fütterung und Workout einmal.
</figcaption>
<div aria-describedby="tbl-repeated-table-fac3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_49g9h0u7uudivijjerdt(i, j, css_id) {
          var table = document.getElementById("tinytable_49g9h0u7uudivijjerdt");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_49g9h0u7uudivijjerdt');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_49g9h0u7uudivijjerdt(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_49g9h0u7uudivijjerdt");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 9, j: 5 }, { i: 9, j: 3 }, { i: 9, j: 1 }, { i: 9, j: 2 }, { i: 9, j: 0 }, { i: 9, j: 6 }, { i: 9, j: 4 }, { i: 9, j: 7 },  ], css_id: 'tinytable_css_ecf871d2siu2ffhbxge3',}, 
          { positions: [ { i: 1, j: 0 }, { i: 5, j: 1 }, { i: 3, j: 0 }, { i: 1, j: 1 }, { i: 3, j: 1 }, { i: 1, j: 2 }, { i: 3, j: 2 }, { i: 5, j: 2 }, { i: 5, j: 0 }, { i: 7, j: 0 }, { i: 1, j: 5 }, { i: 1, j: 3 }, { i: 3, j: 3 }, { i: 5, j: 3 }, { i: 7, j: 3 }, { i: 7, j: 1 }, { i: 1, j: 6 }, { i: 1, j: 4 }, { i: 3, j: 4 }, { i: 5, j: 4 }, { i: 7, j: 4 }, { i: 7, j: 2 }, { i: 1, j: 7 }, { i: 3, j: 7 }, { i: 3, j: 5 }, { i: 5, j: 5 }, { i: 7, j: 5 }, { i: 5, j: 6 }, { i: 7, j: 6 }, { i: 5, j: 7 }, { i: 3, j: 6 }, { i: 7, j: 7 },  ], css_id: 'tinytable_css_p23zeyiyzc4ozr31vagm',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 3 }, { i: 0, j: 1 }, { i: 0, j: 7 }, { i: 0, j: 5 }, { i: 0, j: 6 }, { i: 0, j: 4 }, { i: 0, j: 2 },  ], css_id: 'tinytable_css_sbnq6qapfvd02s8pfzds',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_49g9h0u7uudivijjerdt(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_ecf871d2siu2ffhbxge3, .table th.tinytable_css_ecf871d2siu2ffhbxge3 { background-color: #ededed; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_p23zeyiyzc4ozr31vagm, .table th.tinytable_css_p23zeyiyzc4ozr31vagm { background-color: #ededed; }
      .table td.tinytable_css_sbnq6qapfvd02s8pfzds, .table th.tinytable_css_sbnq6qapfvd02s8pfzds { border-bottom: solid #d3d8dc 0.1em; }
    </style>
    <div class="container">
      <table class="table table-striped" id="tinytable_49g9h0u7uudivijjerdt" style="table-layout: fixed; width: 100% !important; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">.id</th>
                <th scope="col">animal</th>
                <th scope="col">feeding</th>
                <th scope="col">workout</th>
                <th scope="col">t1</th>
                <th scope="col">t2</th>
                <th scope="col">t3</th>
                <th scope="col">t4</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>1</td>
                  <td>cat</td>
                  <td>blood</td>
                  <td>yes</td>
                  <td>57.62</td>
                  <td>67.87</td>
                  <td>68.82</td>
                  <td>61.19</td>
                </tr>
                <tr>
                  <td>1</td>
                  <td>cat</td>
                  <td>blood</td>
                  <td>no</td>
                  <td>42.32</td>
                  <td>49.28</td>
                  <td>58.87</td>
                  <td>50.75</td>
                </tr>
                <tr>
                  <td>1</td>
                  <td>cat</td>
                  <td>ctrl</td>
                  <td>yes</td>
                  <td>49.53</td>
                  <td>54.91</td>
                  <td>46.01</td>
                  <td>34.32</td>
                </tr>
                <tr>
                  <td>1</td>
                  <td>cat</td>
                  <td>ctrl</td>
                  <td>no</td>
                  <td>31.02</td>
                  <td>42.39</td>
                  <td>26.64</td>
                  <td>11.59</td>
                </tr>
                <tr>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                </tr>
                <tr>
                  <td>12</td>
                  <td>cat</td>
                  <td>ctrl</td>
                  <td>yes</td>
                  <td>48.82</td>
                  <td>52.84</td>
                  <td>41.37</td>
                  <td>36.02</td>
                </tr>
                <tr>
                  <td>12</td>
                  <td>cat</td>
                  <td>ctrl</td>
                  <td>no</td>
                  <td>32.85</td>
                  <td>32.18</td>
                  <td>29.1</td>
                  <td>16.41</td>
                </tr>
                <tr>
                  <td>12</td>
                  <td>cat</td>
                  <td>ketchup</td>
                  <td>yes</td>
                  <td>59.16</td>
                  <td>55.02</td>
                  <td>39.41</td>
                  <td>41.03</td>
                </tr>
                <tr>
                  <td>12</td>
                  <td>cat</td>
                  <td>ketchup</td>
                  <td>no</td>
                  <td>35.11</td>
                  <td>36.99</td>
                  <td>27.43</td>
                  <td>30.36</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<p>Eigentlich sieht man das Versuchsdesign erst so richtig in der folgenden Abbildung. Hier siehst du einmal wie ein einzelner Floh alle 24 Sprünge nacheinander unter der jeweiligen Faktorkombination durchführt. In einem idealen Setting folgt natürlich jeder Floh eine zufällige Reihenfolge der Faktorkombinationen. Bitte beachte, dass zwischen den einzelnen Behandlungskombinationen nach dem vierten Sprung natürlich auch eine Zeit vergehen muss, damit sich die Behandlung wieder ausgeschlichen hat.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-theo-repeated-fac3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-theo-repeated-fac3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova-mixed_files/figure-html/fig-ggplot-theo-repeated-fac3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Abbildung&nbsp;33.10— Versuchsdesign der dreifaktoriellen repeated ANOVA. Jeder Katzenfloh springt viermal unter jeder Kombination von Fütterungsart sowie Workoutstatus und wird dabei gemessen. Damit messen wir einen Floh insgesamt vierundzwanzigmal. [Zum Vergrößern anklicken]"><img src="stat-tests-anova-mixed_files/figure-html/fig-ggplot-theo-repeated-fac3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-theo-repeated-fac3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;33.10— Versuchsdesign der dreifaktoriellen repeated ANOVA. Jeder Katzenfloh springt viermal unter jeder Kombination von Fütterungsart sowie Workoutstatus und wird dabei gemessen. Damit messen wir einen Floh insgesamt vierundzwanzigmal. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Am Ende schauen wir uns auch die Daten einmal in einer Abbildung an. Hier haben wir dann die beiden Workoutgruppen sowie die drei Fütterungsarten in einer Abbildung vereint. Wir sehen, dass die nicht trainierten Flöhe im allgemeinen nicht so weit springen wir die trainierten Flöhe. Ebenso wirkt, dass die Ernährung mit Blut auf jeden Fall die bessere Sprungleistung bewirkt. Teilweise sehen wir, dass sich die Linien der Mittelwerte überschneiden, so dass wir hier eventuell von einer Interaktion ausgehen müssen. Das schauen wir uns dann aber in den entsprechenden statistischen Tests einmal näher an.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-anova-repeated-fac3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-anova-repeated-fac3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova-mixed_files/figure-html/fig-ggplot-anova-repeated-fac3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Abbildung&nbsp;33.11— Darstellung des Zusammenhangs zwischen der gemessenen Sprungweite in [cm] und den vier Messzeitpunkten sowie den Fütterungsarten und Workoutstatus. Die Linienarten stellen den Workoutstatus dar. [Zum Vergrößern anklicken]"><img src="stat-tests-anova-mixed_files/figure-html/fig-ggplot-anova-repeated-fac3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-anova-repeated-fac3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;33.11— Darstellung des Zusammenhangs zwischen der gemessenen Sprungweite in [cm] und den vier Messzeitpunkten sowie den Fütterungsarten und Workoutstatus. Die Linienarten stellen den Workoutstatus dar. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="mixed-anova-1" class="level2" data-number="33.4">
<h2 data-number="33.4" class="anchored" data-anchor-id="mixed-anova-1"><span class="header-section-number">33.4</span> Mixed ANOVA</h2>
<p>Beginnen wir mit der Auswertung unserer beispieldaten mit der mixed ANOVA. Wir kriegen hier natürlich nur eine globale Aussage über den Faktor der Behandlung oder der Zeit. Wenn dich die paarweisen Vergleiche interessieren, dann müsst du noch einen Posthoc-Test anschließen. Mehr Informationen zu der Modellierung findest du auch in dem <a href="#sec-mixed">Kapitel zu gemischten Modellen</a>. Dort erfährst du dann auch, wie du dir den Posthoc-Test bauen kannst. Hier bleiben wir dann bei der ANOVA und den entsprechenden Ergebnissen.</p>
<section id="zweifaktoriell-2" class="level3" data-number="33.4.1">
<h3 data-number="33.4.1" class="anchored" data-anchor-id="zweifaktoriell-2"><span class="header-section-number">33.4.1</span> Zweifaktoriell</h3>
<p>Als erstes schauen wir uns die Auswertung der zweifaktoriellen mixed ANOVA an. Nochmal zur Erinnerung, wir haben einen Behandlungsfaktor mit den drei Arten der Fütterung, Kontrolle, Blut und Ketchup, vorliegen. Darüber hinaus messen wir die Sprungweite an sechs Zeitpunkten widerholt für jeden Katzenfloh. Wir wollen jetzt wissen, ob die Fütterung einen Einfluss auf die Sprungweiten der Katzenflöhe über die Zeit hat. Dabei sind wir eigentlich nicht so sehr an den Zeitpunkten wie an der Behandlung der Fütterung interessiert. In einem zweifaktoriellen Versuch können wir uns dann auch immer die Interaktion mit anschauen um zu sehen, die Behandlung unabhängig von den Zeitpunkten ist.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page"><code>{base}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false"><code>{rstatix}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false"><code>{afex}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false"><code>{MANOVA.RM}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false"><code>{WRS2}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Die Standardimplementierung ist eigentlich recht einfahc durchzuführen. Wir haben wie immer erst unseren Messwert <span class="math inline">\(y\)</span> und dann die Formelschreibweise für unser beiden Faktoren und deren Interaktion. Ich mache mir es hier etwas einfacher und schreibe dann noch die Faktoren mit dem <code>*</code> um etwas Platz zu sparen. Die Besonderheit hier ist jetzt, dass wir noch spezifizieren müssen welche Variable in unseren Daten die wiederholt gemessenen Individuen darstellt und über welchen Faktor diese Individuen dann wiederholt gemessen wurden. In unserem Fall stehen die Individuen in der Spalte <code>.id</code> und wir haben über die Spalte <code>time_fct</code> wiederholt die einzelnen Flöhe gemessen. Dann müssen wir das ganze noch in die Funktion <code>Error()</code> schreiben, damit die ANOVA auch erkennt, dass wir hier den Teil mit den Messwiederholungen darstellen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>time_fct), </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> mixed_fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, df, statistic, p.value) <span class="sc">|&gt;</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  term                df statistic p.value
  &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  
1 feeding              2    214.   &lt;0.001 
2 time_fct             5    116.   &lt;0.001 
3 feeding:time_fct    10      8.49 &lt;0.001 </code></pre>
</div>
</div>
<p>Ich filtere hier einiges weg, da wir hier viele Informationen erhalten, die wir meistens nicht brauchen. Wir sehen, dass einen signifikanten Einfluss der Fütterung auf die Sprungweite haben, da der p-Wert kleiner ist als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5%. Dies ist auch der Fall für die Zeitpunkte und die Interaktion. Da wir hier eine signifikante Interaktion vorliegen haben, können wir die Fütterungsarten nicht unabhängig über die Zeit interpretieren. Es gibt damit Zeitpunkte an denen die Fütterungen unterschiedliche Effekte zeigen.</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Das R Paket <code>{rstatix}</code> liefert mit der Funktion <code>anova_test()</code> auch eine Möglichkeit eine mixed ANOVA zu rechnen. Hier ist es dann mit den Optionen etwas anders. Ich mag ja die Formelschreibweise sehr gerne, da weiß ich dann wo was steht. Auf der anderen Seite mag es aber auch einfacher sein, wenn man einfach die Variablen in den Daten einer Option in der Funktion zuordnet. Hier haben wir den Fall, dass wir sagen müssen, was ist unser Messwert? Der Messwert kommt in die Option <code>dv</code>. Dann brauchen wir die individuellen IDs in der Option <code>wid</code>. Die Faktoren, die wir untereinander vergleichen wollen, kommen dann in die Option <code>between</code>. In unserem Fall sind das die Fütterungsarten. Wir wollen wissen ob es zwischen den Fütterungsarten einen Unterschied gibt. Die Zeit als Messwiederholung kommt dann in die Option <code>within</code>. Wir messen ja die Zeitpunkte innerhalb (eng. <em>within</em>) der Individuen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>rstatix_aov <span class="ot">&lt;-</span> <span class="fu">anova_test</span>(<span class="at">data =</span> mixed_fac2_tbl, </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">dv =</span> jump_length, <span class="at">wid =</span> .id, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">between =</span> feeding, <span class="at">within =</span> time_fct)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">get_anova_table</span>(rstatix_aov)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>ANOVA Table (type II tests)

            Effect DFn DFd       F        p p&lt;.05   ges
1          feeding   2  21 214.133 1.08e-14     * 0.750
2         time_fct   5 105 115.543 4.79e-41     * 0.824
3 feeding:time_fct  10 105   8.488 5.19e-10     * 0.408</code></pre>
</div>
</div>
<p>Numerisch sind die Werte die gleichen Werte, die wir auch in der <code>aov()</code> Funktion erhalten. Im Hintergrund wird auch eine <code>aov()</code> gerechnet, nur die Übergabe der Variablen ist hier anders. Neben der Signifikanz kriegen wir in der Spalte <code>ges</code> auch noch ein Eta<span class="math inline">\(^2\)</span> Wert wiedergegeben, den wir klassisch interpretieren können. Da wir es in einer mixed ANOVA mit einem etwas anderen Eta<span class="math inline">\(^2\)</span> Wert zu tun haben, können wir hier erstmal sagen, dass je gößer der Wert desto stärker der Effekt. Die p-Werte sind auch hier für alle Vergleiche hoch signifikant.</p>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>Das R Paket <code>{afex}</code> elraubt im besonderen die Modellierung von Messwiederholungen von Beobachtungen. Faktisch ist das Paket um diese Art der Analyse gebaut. Dementsprechend gibt es auch zwei Arten des Funktionsaufrufs. Wir konzentrieren uns hier aus Gründen der konsistents zu <code>aov()</code> auf die Funktion <code>aov_car()</code>. Am Ende kommen hier die gleichen Werte raus wie schon bei den anderen Tabs. Wir haben hier aber die Möglichkeit etwas mehr zu machen. Alles Weitere dann in der <a href="https://cran.r-project.org/web/packages/afex/vignettes/afex_anova_example.html">Vingette zu <code>{afex}</code> und dem Posthoc-Test</a>. Wenn du viel mit Messwiederholungen arbeitest, dann ist eine Einarbeitung in <code>{afex}</code> sicherlich sinnvoll. Leider bist du bei <code>{afex}</code> an die Normalverteilung und die Varianzhomogenität gebunden. MAn kann eben nicht alles haben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>time_fct), </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> mixed_fac2_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: jump_length
            Effect          df   MSE          F  ges p.value
1          feeding       2, 21 13.29 214.13 *** .750   &lt;.001
2         time_fct 4.11, 86.33 18.70 115.54 *** .824   &lt;.001
3 feeding:time_fct 8.22, 86.33 18.70   8.49 *** .408   &lt;.001
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1

Sphericity correction method: GG </code></pre>
</div>
</div>
<p>Auch hier erhalten wir die gleichen numwerischen Werte wie schon in den vorherigen Tabs zu <code>{base}</code> und <code>{rstatix}</code>. Die Signifikanz ist für alle Faktoren sowie der Interaktion gegeben. Wir erhalten auch hier in der Spalte <code>ges</code> dann das Eta<span class="math inline">\(^2\)</span> als Effektschätzer zurück. Am Ende finde ich die Ausgabe etwas sperrig.</p>
<p>Das R Paket <code>{afex}</code> erlaubt es auch die Modelle nach der Schreibweise der linearen gemischten Modelle zu definieren. Das ist für mich eigentlich etwas angenehmer, da man sich dann in einer Formelwelt aufhält mehr dazu dann im <a href="#sec-mixed">Kapitel zu gemischten Modellen</a>. Also die Ergebnisse sind die Gleichen. Ich brauche es nur als Referenz für mich zum nachschlagen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_4</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> time_fct <span class="sc">+</span> (time_fct<span class="sc">|</span>.id), </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> mixed_fac2_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<p>Mit dem R Paket <code>{MANOVA.RM}</code> haben wir auch die Möglichkeit eine mixed ANOVA zu rechnen in dem wir die Funktion <code>RM()</code> nutzen. Das ist natürlich etwas verwirrend vom Namen, aber wenn wir die Optionen richtig mit den Variablen belegen, dann rechnen wir auch eine mixed ANOVA. Hier müssen wir dann angeben in welche Spalte die Beobachtungen sind und was der <code>within</code> Faktor ist. Bei uns ist das dann einfach. Wir nutzen die Variable <code>.id</code> sowie als Faktor der Messwiederholungen <code>time_fct</code>. Der Rest ist eigentlich nicht so wichtig. Wenn du die Funktion in deiner Analyse rechnest, dann würde ich die Option <code>iter</code> auf 1000 setzen.</p>
<p>Am Ende muss sich aber dann doch fragen, ob es eine noch hässlichere Ausgabe einer Funktion gibt. Ich glaube eher nicht, aber das soll die Leistung des Algorithmus nicht schmälern. Wir kämpfen uns da doch mal durch. Manche Informationen sind dann einfach auch wieder über, da wir je eigentlich nur wissen wollen, ob wir einen signifikanten Einfluss der Behandlung <code>feeding</code> vorliegen haben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">RM</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> time_fct, <span class="at">data =</span> mixed_fac2_tbl, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">subject =</span> <span class="st">".id"</span>, <span class="at">within =</span> <span class="fu">c</span>(<span class="st">"time_fct"</span>), <span class="at">iter =</span> <span class="dv">100</span>, </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">resampling =</span> <span class="st">"Perm"</span>, <span class="at">seed =</span> <span class="dv">1234</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call: 
jump_length ~ feeding * time_fct
A repeated measures analysis with 1 within-subject factor(s) ( time_fct ) and 1 between-subject factor(s). 

Descriptive:
   feeding time_fct n  Means Lower 95 % CI Upper 95 % CI
1     ctrl       t0 8 32.510        27.041        37.979
4     ctrl       t1 8 28.544        22.315        34.773
7     ctrl       t2 8 24.625        19.272        29.978
10    ctrl       t3 8 21.853        17.032        26.673
13    ctrl       t4 8 18.774        12.618        24.929
16    ctrl       t5 8  5.239         0.156        10.321
2    blood       t0 8 40.072        34.510        45.635
5    blood       t1 8 28.651        24.154        33.148
8    blood       t2 8 25.236        17.146        33.327
11   blood       t3 8 18.062        11.397        24.728
14   blood       t4 8 20.250        14.413        26.087
17   blood       t5 8 17.351        11.442        23.260
3  ketchup       t0 8 50.941        46.864        55.018
6  ketchup       t1 8 45.538        41.039        50.036
9  ketchup       t2 8 34.306        30.118        38.494
12 ketchup       t3 8 29.146        23.946        34.346
15 ketchup       t4 8 27.706        24.583        30.830
18 ketchup       t5 8 31.434        25.615        37.252

Wald-Type Statistic (WTS):
                 Test statistic df   p-value 
feeding          "396.501"      "2"  "&lt;0.001"
time_fct         "1009.823"     "5"  "&lt;0.001"
feeding:time_fct "83.636"       "10" "&lt;0.001"

ANOVA-Type Statistic (ATS):
                 Test statistic df1     df2      p-value 
feeding          "214.133"      "1.982" "72.609" "&lt;0.001"
time_fct         "115.543"      "4.111" "Inf"    "&lt;0.001"
feeding:time_fct "8.488"        "6.975" "Inf"    "&lt;0.001"

p-values resampling:
                 Perm (WTS)
feeding          "&lt;0.001"  
time_fct         "&lt;0.001"  
feeding:time_fct "0.02"    </code></pre>
</div>
</div>
<p>Als erstes erhalten wir eine lange Tabelle mit der deskriptiven Statistik der Mittelwerte für jede Faktorkombination der Fütterungsart sowie dem Zeitpunkt. Dazu dann noch die passenden 95% Konfidenzintervalle. Dann kommen drei Tests nacheinander. Das ist auch immer das Problem, wenn du dann drei Ausgaben hast und nicht weißt, welche du nehmen sollst. Ich würde hier die Ergebnisse der <code>ANOVA-Type Statistic (ATS)</code> nehmen und den Rest liegen lassen. Die p-Werte aus dem Permutationstest <code>p-values resampling</code> haben zwar auch ihre Berechtigung bei nicht normalverteilten oder varianzheterogenen Daten aber ich würde dann hier auch eher das R Paket <code>{WRS2}</code> vorziehen.</p>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<p>Kommen wir nun zum letzten Paket, was ich hier noch für die zweifaktorielle mixed ANOVA zeigen möchte. Es handelt sich um <code>{WRS2}</code>, welches dann auch erlaubt die zweifaktorielle mixed ANOVA zu rechnen, wenn wir die Annahme der Normalverteilung an den Messwert oder keine Varianzhomogenität in den Gruppen vorliegen haben. Es geht dann auch beides. Das ist dann auch der große Vorteil von <code>{WRS2}</code>. Das Modell sieht genauso aus wie auch bei den anderen Anwendungen. Wir müssen hier nur einmal in der Option <code>id</code> angeben, welche Spalte unsere ID ist.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bwtrim</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> time_fct, <span class="at">id =</span> .id, <span class="at">data =</span> mixed_fac2_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
bwtrim(formula = jump_length ~ feeding * time_fct, id = .id, 
    data = mixed_fac2_tbl)

                    value df1    df2 p.value
feeding          186.6213   2 9.6997  0.0000
time_fct         142.2153   5 9.7570  0.0000
feeding:time_fct   4.6665  10 9.4221  0.0133</code></pre>
</div>
</div>
<p>Die Ergebnisse sind dann vom p-Wert inhaltlich gleich wie bei den anderen Anwendungen. Das habe ich hier auch erwartet, denn unsere Sprungweiten habe ich so gebaut, dass die Sprungweiten normalverteilt sind. Nicht immer können wir aber in unseren Daten davon ausgehen, dass wir normalverteilte Messwerte vorliegen haben. Da ist diese Alternative hier sehr gut.</p>
</div>
</div>
</div>
<p>Wir haben ja in den obigen Anwendungen der mixed ANOVA immer eine signifikante Interaktion gefunden. Daher wollen wir uns einmal in einem Liniendiagramm der Mittelwerte die Sachlage näher anschauen. Wenn wir eine Interaktion erwarten, dann sollten sich die Linien der Mittelwerte kreuzen. Wir haben ja auch in allen Analysen eine signifkante Interaktion voriegen. Wenn wir jetzt auf die Abbildung schauen, dann sehen wir auch, dass sich die Lienien für die Fütterung mit Blut und der Kontrolle kreuzen. Wir haben hier eine Interaktion vorliegen. Auch sind die Unterschiede zwischend den Fütterungen nicht immer parallel zueinander mit dem gleichen Effekt oder eben Abstand.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>mixed_fac2_tbl <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time_fct, <span class="at">y =</span> jump_length,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> feeding, <span class="at">group =</span> feeding)) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-interactionplot-mixed-2fac" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-interactionplot-mixed-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova-mixed_files/figure-html/fig-interactionplot-mixed-2fac-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Abbildung&nbsp;33.12— Liniendigramm mit den Mittelwerten aller Faktorkombinationen der beiden Faktoren feeding und time_fct. Die Linien kreuzen sich leicht, es liegt eine Interaktion vor. Eine allgemeine Aussage über die Sprungweite und der Fütterung lässt sich nicht unabhängig vom Zeitpunkt treffen. Die Interaktion ist aber nicht sehr stark."><img src="stat-tests-anova-mixed_files/figure-html/fig-interactionplot-mixed-2fac-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-interactionplot-mixed-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;33.12— Liniendigramm mit den Mittelwerten aller Faktorkombinationen der beiden Faktoren <code>feeding</code> und <code>time_fct</code>. Die Linien kreuzen sich leicht, es liegt eine Interaktion vor. Eine allgemeine Aussage über die Sprungweite und der Fütterung lässt sich nicht unabhängig vom Zeitpunkt treffen. Die Interaktion ist aber nicht sehr stark.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="dreifaktoriell-2" class="level3" data-number="33.4.2">
<h3 data-number="33.4.2" class="anchored" data-anchor-id="dreifaktoriell-2"><span class="header-section-number">33.4.2</span> Dreifaktoriell</h3>
<p>Jetzt betrachten wir noch die dreifaktorielle mixed ANOVA. Dieses Design kommt dann vor, wenn du zwei Behandlungsfaktoren sowie einen Zeitfaktor in deinen Daten vorliegen hast. In unserem Fall ist der erste Faktor die Fütterungsart mit den Gruppen Kontrolle, Blut und Ketchup sowie als zweiten Faktor der Status des Workouts des einzlenen Flohs. Wir schauen hier nur Katzenflöhe an. Dann messen wir die Sprungweite jedes einzelnen Flohs nochmal zu sechs Zeitpunkten. Hier ist es wieder wichtig darauf zu achten, was mit einem einzelnen Floh passiert und gemessen wird. Wir messen hier jede Faktorkombination und Wiederholung mit einem neuen Floh. Schaue dir dazu nochmal die Übersicht des Designs in dem Abschnitt zu den Daten in der <a href="#fig-ggplot-theo-mixed-fac3" class="quarto-xref">Abbildung&nbsp;<span class="quarto-unresolved-ref">fig-ggplot-theo-mixed-fac3</span></a> an. Auch hier ist es dann manchmal von Vorteil zu wissen, wechler Faktor einem eigentlich am meisten interessiert. Wir betrachten hier jetzt alle drei Faktoren und deren Interaktionen als gleichwertig. Wir können die dreifaktorielle mixed ANOVA nicht mehr in dem R Paket <code>{WRS2}</code> rechnen. Das Paket biette keine Funktion dafür an.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true"><code>{base}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false"><code>{rstatix}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false"><code>{afex}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false"><code>{MANOVA.RM}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Beginnen wir wieder mit der Standardfunktion in <code>{base}</code> mit <code>aov()</code> und deren Anwendung. Hier kommt dann die verkürzende Formelschreibweise mit dem Stern <code>*</code> zum Einsatz. Ich kann mir nicht merken was alle Faktorkombinationen zusammen mit allen Interaktionen sind. Daher nutze ich dann einmal die Schreibweise, die mir diese Überlegung abnimmt. Dann muss ich noch in dem Fehlerterm mitteilen wer <code>.id</code> in welchen Faktor <code>time_fct</code> wiederholt wird. Damit ist die dreifaktorielle mixed ANOVA der zweifaktoriellen mixed ANOVA sehr ähnlich. Wir erhalten dann folgende Ausagen, die ich nochmal aufgereinigt habe, da ich nicht alle Spalten und Informationen brauche. Auch mag ich den p-Wert gerne etwas übersichtlicher.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> workout <span class="sc">*</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>time_fct), </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> mixed_fac3_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, df, statistic, p.value) <span class="sc">|&gt;</span> </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 4
  term                        df statistic p.value
  &lt;chr&gt;                    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  
1 feeding                      2   318.    &lt;0.001 
2 workout                      1    14.0   0.002  
3 feeding:workout              2    79.0   &lt;0.001 
4 time_fct                     5   113.    &lt;0.001 
5 feeding:time_fct            10     4.03  &lt;0.001 
6 workout:time_fct             5     0.943 0.457  
7 feeding:workout:time_fct    10     1.45  0.171  </code></pre>
</div>
</div>
<p>Wir sehen sofort, dass die beiden Faktoren der Fütterungsart sowie des Workout signifikant sind. Auch haben wir eine signifikante Interaktion zwischen den beiden Faktoren vorliegen. Die Gruppen der Fütterung verhalten sich in den beiden Gruppen des Workouts nicht gleich. Auch ist die Zeit signifkant, es passiert also etwas mit der Sprungweite über die Zeit. Im Weiteren haben wir eine signifikante Interaktion zwischen der Fütterungsart und der Zeit, so dass sich hier auch über die Zeit die Gruppen der Fütterung anders verhalten. Die anderen Interaktionen sind nicht signifikant.</p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Jetzt kürze ich ein wenig ab, da die Ergebnisse ja gleich sind in <code>{rstatix}</code> zu der mixed ANOVA mit <code>aov()</code>. Die Funktionen sind ja identisch nur das sich die Eingabe unterscheidet. Hier sieht man dann eventuell besser, dass wir <em>zwischen</em> den Fütterungsarten und den Workouts vergleichen wollen und wir als Wiederholung die <code>.id</code> der einzelnen Flöhe vorliegen haben. Wir erhalten hier nochmal als Effektschätzer das Eta<span class="math inline">\(^2\)</span> wiedergegeben, was wirklich ein Vorteil ist. Ansonsten würde ich fast die <code>aov()</code> Funktion vorziehen. Am Ende filtere ich wieder um dann eine etwas ausgeräumte Ausgabe zu haben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>rstatix_aov <span class="ot">&lt;-</span> <span class="fu">anova_test</span>(<span class="at">data =</span> mixed_fac3_tbl, </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">dv =</span> jump_length, <span class="at">wid =</span> .id, </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">between =</span> <span class="fu">c</span>(feeding, workout), </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">within =</span> time_fct)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">get_anova_table</span>(rstatix_aov) <span class="sc">|&gt;</span> </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Effect, F, p, ges) <span class="sc">|&gt;</span> </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> <span class="fu">pvalue</span>(p))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 4
  Effect                         F p        ges
  &lt;chr&gt;                      &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
1 feeding                  318.    &lt;0.001 0.786
2 workout                   14.0   0.002  0.075
3 time_fct                 113.    &lt;0.001 0.849
4 feeding:workout           79.0   &lt;0.001 0.477
5 feeding:time_fct           4.03  &lt;0.001 0.286
6 workout:time_fct           0.943 0.457  0.045
7 feeding:workout:time_fct   1.45  0.171  0.126</code></pre>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>Bei dem R Paket <code>{afex}</code> ist es ähnlich wie schon bei dem R Paket <code>{rstatix}</code>. Hier ist dann die Formelschreibweise ähnlich wie schon bei <code>aov()</code>. Das macht die Nutzung angenehmer für mich. Als Besonderheit können wir dann auch <code>{afex}</code> nutzen wie ein lineares gemischtes Modell. Intern ruft dann aber auch <code>{afex}</code> das Paket <code>{car}</code> auf und nutzt dessen Algorithmus. Daher ist hier die Nutzung der Type II ANOVA und Type III ANOVA einfacher umzusetzen. Ich mag das Paket gerne, da es auch speziell für Messwiederholungen gebaut wurde.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> workout <span class="sc">*</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>time_fct), </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> mixed_fac3_tbl) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: jump_length
                    Effect          df   MSE          F  ges p.value
1                  feeding       2, 18 10.55 318.13 *** .786   &lt;.001
2                  workout       1, 18 10.55   13.98 ** .075    .002
3          feeding:workout       2, 18 10.55  79.04 *** .477   &lt;.001
4                 time_fct 3.88, 69.75 23.44 112.78 *** .849   &lt;.001
5         feeding:time_fct 7.75, 69.75 23.44   4.03 *** .286   &lt;.001
6         workout:time_fct 3.88, 69.75 23.44       0.94 .045    .442
7 feeding:workout:time_fct 7.75, 69.75 23.44       1.45 .126    .193
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1

Sphericity correction method: GG </code></pre>
</div>
</div>
<p>Das R Paket <code>{afex}</code> erlaubt es auch die Modelle nach der Schreibweise der linearen gemischten Modelle zu definieren. Das ist für mich eigentlich etwas angenehmer, da man sich dann in einer Formelwelt aufhält mehr dazu dann im <a href="#sec-mixed">Kapitel zu gemischten Modellen</a>. Also die Ergebnisse sind die Gleichen. Ich brauche es nur als Referenz für mich zum nachschlagen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_4</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> workout <span class="sc">*</span> time_fct <span class="sc">+</span> (time_fct<span class="sc">|</span>.id), </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> mixed_fac3_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<p>Am Ende stelle ich noch das R Paket <code>{MANOVA.RM}</code> vor. Auch hier haben wir dann wieder zu viel Ausgabe. Ich finde hier wird dann deutlich, dass die deskriptive Statistik über ist. Ich will doch nur eine mixed ANOVA rechnen. In der Funktion <code>RM()</code> spezifizieren wir ja nur den <code>within</code> Faktor, der sich hier ja auch bei einer dreifaktoriellen mixed ANOVA nicht ändert. Wir haben auch hier wieder drei Tests, wobei ich dann auch nur die Ergebnisse der <code>ANOVA-Type Statistic (ATS)</code> nehmen und den Rest liegen lassen würde.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">RM</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> workout <span class="sc">*</span> time_fct, <span class="at">data =</span> mixed_fac3_tbl, </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">subject =</span> <span class="st">".id"</span>, <span class="at">within =</span> <span class="fu">c</span>(<span class="st">"time_fct"</span>), <span class="at">iter =</span> <span class="dv">100</span>, </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">resampling =</span> <span class="st">"Perm"</span>, <span class="at">seed =</span> <span class="dv">1234</span>) <span class="sc">|&gt;</span> </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call: 
jump_length ~ feeding * workout * time_fct
A repeated measures analysis with 1 within-subject factor(s) ( time_fct ) and 2 between-subject factor(s). 

Descriptive:
   feeding workout time_fct n  Means Lower 95 % CI Upper 95 % CI
1     ctrl     yes       t0 4 37.718        19.752        55.683
7     ctrl     yes       t1 4 34.570        24.732        44.408
13    ctrl     yes       t2 4 31.290        26.489        36.091
19    ctrl     yes       t3 4 24.512         9.769        39.256
25    ctrl     yes       t4 4 26.165        14.107        38.223
31    ctrl     yes       t5 4 10.075        -4.546        24.696
4     ctrl      no       t0 4 33.405        21.056        45.754
10    ctrl      no       t1 4 29.212        14.480        43.945
16    ctrl      no       t2 4 21.595         8.099        35.091
22    ctrl      no       t3 4 19.015         1.083        36.947
28    ctrl      no       t4 4 16.195         8.369        24.021
34    ctrl      no       t5 4  7.775        -0.910        16.460
2    blood     yes       t0 4 46.035        35.756        56.314
8    blood     yes       t1 4 31.495        21.001        41.989
14   blood     yes       t2 4 25.635         7.979        43.291
20   blood     yes       t3 4 25.080        20.580        29.580
26   blood     yes       t4 4 21.587         2.378        40.797
32   blood     yes       t5 4 18.445        10.144        26.746
5    blood      no       t0 4 52.303        40.389        64.216
11   blood      no       t1 4 46.498        39.556        53.439
17   blood      no       t2 4 36.158        15.701        56.614
23   blood      no       t3 4 32.672        19.062        46.283
29   blood      no       t4 4 34.295        14.581        54.009
35   blood      no       t5 4 29.208        17.262        41.153
3  ketchup     yes       t0 4 56.428        41.856        70.999
9  ketchup     yes       t1 4 47.342        25.965        68.720
15 ketchup     yes       t2 4 36.908        26.465        47.350
21 ketchup     yes       t3 4 32.180        19.098        45.262
27 ketchup     yes       t4 4 32.422        26.616        38.229
33 ketchup     yes       t5 4 35.362        24.276        46.449
6  ketchup      no       t0 4 57.062        42.258        71.867
12 ketchup      no       t1 4 52.618        38.726        66.509
18 ketchup      no       t2 4 39.200        21.873        56.527
24 ketchup      no       t3 4 39.190        18.245        60.135
30 ketchup      no       t4 4 31.390        17.678        45.102
36 ketchup      no       t5 4 31.887        16.088        47.687

Wald-Type Statistic (WTS):
                         Test statistic df   p-value 
feeding                  "1042.469"     "2"  "&lt;0.001"
workout                  "13.98"        "1"  "&lt;0.001"
feeding:workout          "133.546"      "2"  "&lt;0.001"
time_fct                 "879.365"      "5"  "&lt;0.001"
feeding:time_fct         "47.128"       "10" "&lt;0.001"
workout:time_fct         "5.119"        "5"  "0.402" 
feeding:workout:time_fct "25.413"       "10" "0.005" 

ANOVA-Type Statistic (ATS):
                         Test statistic df1     df2      p-value 
feeding                  "318.133"      "1.725" "36.605" "&lt;0.001"
workout                  "13.98"        "1"     "36.605" "0.001" 
feeding:workout          "79.042"       "1.725" "36.605" "&lt;0.001"
time_fct                 "112.777"      "3.875" "Inf"    "&lt;0.001"
feeding:time_fct         "4.028"        "6.058" "Inf"    "&lt;0.001"
workout:time_fct         "0.943"        "3.875" "Inf"    "0.435" 
feeding:workout:time_fct "1.451"        "6.058" "Inf"    "0.19"  

p-values resampling:
                         Perm (WTS)
feeding                  "&lt;0.001"  
workout                  "&lt;0.001"  
feeding:workout          "&lt;0.001"  
time_fct                 "&lt;0.001"  
feeding:time_fct         "0.16"    
workout:time_fct         "0.64"    
feeding:workout:time_fct "0.39"    </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Nachdem wir ja unsere mixed ANOVA mit einem der vorgeschlagenen Algorithmen gerechnet haben, sehen wir dass wir eine signifikante Interaktion vorliegen haben. Zum einen ist der Interaktionsterm <code>feeding:workout</code> signifikant sowie der Interaktionsterm <code>feeding:time_fct</code> auch. Damit haben wir andere Mittelwerte der Sprungweite für die Fütterungsarten zu den beiden Workouts sowie unterschiedliche Mittelwerte der Sprungweiten über die Zeit und Fütterungsarten. Ja und das sehen wir dann auch in der folgenden Abbildung. Bei der Kontrollbehandlung und der Ketchupfütterung hat das Workout exakt einen anderen Effekt. Bei der Kontrolle springen die nicht trainierten Flöhe weniger weit. Bei der Ernährung mit Ketchup haben das Training einen negativen Effekt. Eine Drehung des Effekts des Workouts nach der Fütterung. Auch kreuzen die Mittelwerte der Sprungweiten über die Zeit nach der Fütterungsart.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>mixed_fac3_tbl <span class="sc">|&gt;</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time_fct, <span class="at">y =</span> jump_length,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> feeding, <span class="at">linetype =</span> workout, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> <span class="fu">interaction</span>(feeding, workout))) <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-interactionplot-mixed-3fac" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-interactionplot-mixed-3fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova-mixed_files/figure-html/fig-interactionplot-mixed-3fac-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Abbildung&nbsp;33.13— Liniendigramm mit den Mittelwerten aller Faktorkombinationen der beiden Faktoren feeding sowie workout und time_fct. Die Linien sind in der Reichenfolge verdreht, es liegt eine Interaktion vor. Auch kruezen sich die Fütterungsarten über die Zeit. Eine allgmeine Aussage über die Sprungweite und die Fütterung soweie dem Workout lässt sich nicht unabhängig vom Zeitpunkt treffen."><img src="stat-tests-anova-mixed_files/figure-html/fig-interactionplot-mixed-3fac-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-interactionplot-mixed-3fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;33.13— Liniendigramm mit den Mittelwerten aller Faktorkombinationen der beiden Faktoren <code>feeding</code> sowie <code>workout</code> und <code>time_fct</code>. Die Linien sind in der Reichenfolge verdreht, es liegt eine Interaktion vor. Auch kruezen sich die Fütterungsarten über die Zeit. Eine allgmeine Aussage über die Sprungweite und die Fütterung soweie dem Workout lässt sich nicht unabhängig vom Zeitpunkt treffen.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="repeated-measurement-anova" class="level2" data-number="33.5">
<h2 data-number="33.5" class="anchored" data-anchor-id="repeated-measurement-anova"><span class="header-section-number">33.5</span> Repeated measurement ANOVA</h2>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Achtung, bitte beachten!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Willst du wirklich eine <em>repeated</em> ANOVA rechnen oder doch eher eine mixed ANOVA? Der Unterschied ist subtil und hängt davon ab, welche Behandlungskombinationen deine einzelnen Beobachtungen erhalten haben. Schaue im Zweifel nochmal oben in der Einleitung um dich zu versichern. Häufig möchtest du nämlich eine mixed ANOVA rechnen.</p>
</div>
</div>
<p>Schauen wir also einmal was die repeated ANOVA einmal macht. Hier nochmal ganz wichtig zu Anfang. Wir werden jetzte <em>jede</em> Beobachtung mit <em>jeder</em> Faktorkombination zu <em>jedem</em> Zeitpunkt messen. Das heißt in unserem Konkreten Fall, dass wir bei jeden Katzenfloh die Sprungweite zu jedem Zeitpunkt messen. Das macht ja auch erstmal Sinn. Das wäre dann die einfaktorielle repated ANOVA. Wir haben sonst auch keinen weiteren Faktor im Experiment. Wenn wir jetzt noch die Fütterungsart als Faktor hinzunehmen, dann füttern wir jeden Floh mit allen drei Arten der Fütterung. Jeder Floh erhält Zuckerwasser, springt dann mehrfach und wir messen die Sprungweite. Das machen wir dann mit dem selben Floh nochmal für die Ernährungsart Blut und Ketchup. Wenn dann noch ein zweiter Behandlungsfaktor hinzukommt wie das Workout, dann müssen wir unter jeder Workoutbedinung einmal alle drei Fütterungsarten die Sprungweiten für einen Floh durchmessen. Das heißt wir messen dann einen einzelnen Floh ganz schön oft. Im Bereich der Agrarwissenschaften mag diese Art der wiederholten Behandlung eher selten vorkommen. Daher hier auch ausdrücklich die Warnung, sich nochmal klar zu machen, wie du die einzelnen Beobachtungen nun bemisst. Ich habe auch erst ein wenig gebraucht um die repeated ANOVA von Design her zu verstehen.</p>
<section id="einfaktoriell-1" class="level3" data-number="33.5.1">
<h3 data-number="33.5.1" class="anchored" data-anchor-id="einfaktoriell-1"><span class="header-section-number">33.5.1</span> Einfaktoriell</h3>
<p>Beginnen wir mit der einfaktoriellen repeated ANOVA. Hier haben wir die Fragestellung vorliegen, ob die Zeit einen Einfluss auf die Sprungweiten der Katzenflöhe hat. Wir haben sonst keinen weiteren Behandlungsfaktor. Wir messen einfach nur die Sprungweite der Katzenflöhe wiederholt und schauen, ob sich die Sprungweiten über die Zeit ändern. Das Experiment ist eher ungewöhnlich, da wir hier ja nur wiederholt messen und sonst nichts tun. Faktisch ist es ein <em>proof-of-principle</em>, ob wir überhaupt einen Effekt der Zeit auf die Sprungweite haben.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true"><code>{base}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false"><code>{rstatix}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false"><code>{afex}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false"><code>{MANOVA.RM}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Jetzt ist im Prinzip die Schreiweise das Besondere. Wir haben hier jetzt nur die Zeit als einen Einflussfaktor. Den packen wir jetzt einmal vorne in unser Modell und dann einmal hinten in den Fehlerterm. Dann müssen wir auch hier sagen, dass wir die Beobachtungen wiederholt im Faktor Zeit gemessen haben. Dann können wir auch schon die ANOVA rechnen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>time_fct), <span class="at">data =</span> repeated_fac1_tbl)<span class="sc">|&gt;</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, df, statistic, p.value) <span class="sc">|&gt;</span> </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  term        df statistic p.value
  &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  
1 time_fct     3      19.1 &lt;0.001 </code></pre>
</div>
</div>
<p>Wir sehen, dass der p-Wert kleiner ist als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5% und damit haben wir einen signifkanten Einfluss der Zeit auf die Sprungweite der Katzenflöhe. Mehr testen wir hier auch nicht. Wir haben ja auch nur die Zeit als Faktor in unserem Modell.</p>
<p>Wenn du dann noch einen Effektschätzer brauchst, dann kannst du das R Paket <code>{effectsize}</code> mit der Funktion <code>eta_squared()</code> nutzen. Wir wollen dann noch das <a href="https://easystats.github.io/effectsize/articles/anovaES.html#generalized-eta2">generalisierte Eta<span class="math inline">\(^2\)</span></a> nutzen, da wir die Zeitpunkte nur beobachten und nicht als experimentellen Faktor festgelegt haben. Dazu dann auch mehr in der Arbeit von <span class="citation" data-cites="olejnik2003generalized">Olejnik &amp; Algina (<a href="#ref-olejnik2003generalized" role="doc-biblioref">2003</a>)</span> mit dem Titel <a href="https://coshima.davidrjfikis.com/EPRS8540/uploadf07/olejnik_PsychMeth2003.pdf">Generalized eta and omega squared statistics: measures of effect size for some common research designs</a>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>time_fct), <span class="at">data =</span> repeated_fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">eta_squared</span>(<span class="at">generalized =</span> <span class="st">"time_fct"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA (Type I)

Group        | Parameter | Eta2 (generalized) |       95% CI
------------------------------------------------------------
.id:time_fct |  time_fct |               0.46 | [0.22, 1.00]

- Observed variables: time_fct
- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Wir können auch das R Paket <code>{rstatix}</code> nutzen. Hier rufen wir am Ende dann doch auch nur die <code>aov()</code> Funktion auf, schreiben aber die Variablen in unseren Daten etwas anders in die Funkion <code>anova_test()</code>. Du musst eben wissen, dass hier die abhängige Variable <code>dv</code> die Sprungweite ist, du dann die Beobachtungen in <code>wid</code> schreibst und die Zeit in die Option <code>within</code>. Am Ende ist es dann auch hier eine Geschmackssache, welche Funktion dir besser gefällt und passt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>rstatix_aov <span class="ot">&lt;-</span> <span class="fu">anova_test</span>(<span class="at">data =</span> repeated_fac1_tbl, </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">dv =</span> jump_length, <span class="at">wid =</span> .id, <span class="at">within =</span> time_fct)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">get_anova_table</span>(rstatix_aov)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>ANOVA Table (type III tests)

    Effect DFn DFd      F        p p&lt;.05   ges
1 time_fct   3  33 19.146 2.26e-07     * 0.465</code></pre>
</div>
</div>
<p>Es kommt das Gleiche numerisch raus, wie schon bei <code>aov()</code>. Wir erhalten hier aber zusätzlich noch einen Effektschätzer in der Spalte <code>ges</code>, was dem Eta<span class="math inline">\(^2\)</span> entspricht. Demensprechend ein Vorteil der Funktion.</p>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<p>Das R Paket <code>{afex}</code> kommt bei einer so simplen einfaktoriellen repeated ANOVA dann auf die gleichen Zahlen wie schon die beiden vorherigen Algorithmen. Auch erhälst du bei der Funktion <code>aov_car()</code> einen Wert für Eta<span class="math inline">\(^2\)</span> in der Spalte <code>ges</code> wiedergegeben. Ich bevorzuge dann ja die Schreibweise hier von <code>{afex}</code>, da ich diese hier etwas klarer finde als bei <code>{rstatix}</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(jump_length <span class="sc">~</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>time_fct), <span class="at">data =</span> repeated_fac1_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: jump_length
    Effect          df   MSE         F  ges p.value
1 time_fct 2.68, 29.52 11.85 19.15 *** .465   &lt;.001
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1

Sphericity correction method: GG </code></pre>
</div>
</div>
<p>Das R Paket <code>{afex}</code> erlaubt es auch die Modelle nach der Schreibweise der linearen gemischten Modelle zu definieren. Das ist für mich eigentlich etwas angenehmer, da man sich dann in einer Formelwelt aufhält mehr dazu dann im <a href="#sec-mixed">Kapitel zu gemischten Modellen</a>. Also die Ergebnisse sind die Gleichen. Ich brauche es nur als Referenz für mich zum nachschlagen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_4</span>(jump_length <span class="sc">~</span> time_fct <span class="sc">+</span> (time_fct<span class="sc">|</span>.id), <span class="at">data =</span> repeated_fac1_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<p>Am Ende dann noch die Funktion <code>RM()</code> aus dem R Paket. Erstmal erhalten wir auch hier weder drei statistische Tests, obwohl wir nur nach einem gefragt haben. Ich würde auch hier nur die Ausgabe von <code>ANOVA-Type Statistic (ATS)</code> betrachten. Auch hier sehen wir, dass wir in einem einfaktoriellen Fall die gleichen Werte wie in den anderen R Paketen erhalten. Hir haben wir dann aber noch mehr Informationen, die wir dann brauchen oder auch nicht.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">RM</span>(jump_length <span class="sc">~</span> time_fct, <span class="at">data =</span> repeated_fac1_tbl, </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">subject =</span> <span class="st">".id"</span>, <span class="at">within =</span> <span class="st">"time_fct"</span>, <span class="at">iter =</span> <span class="dv">100</span>, </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">resampling =</span> <span class="st">"Perm"</span>, <span class="at">seed =</span> <span class="dv">1234</span>) <span class="sc">|&gt;</span> </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call: 
jump_length ~ time_fct
A repeated measures analysis with 1 within-subject factor(s) ( time_fct ) and 0 between-subject factor(s). 

Descriptive:
           time_fct  n  Means Lower 95 % CI Upper 95 % CI
time_fct         t1 12 24.081        22.212        25.950
time_fct.1       t2 12 30.642        28.189        33.096
time_fct.2       t3 12 28.107        24.974        31.239
time_fct.3       t4 12 21.410        18.982        23.838

Wald-Type Statistic (WTS):
         Test statistic df  p-value 
time_fct "69.318"       "3" "&lt;0.001"

ANOVA-Type Statistic (ATS):
         Test statistic df1     df2   p-value 
time_fct "19.146"       "2.684" "Inf" "&lt;0.001"

p-values resampling:
         Perm (WTS)
time_fct "&lt;0.001"  </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="zweifaktoriell-3" class="level3" data-number="33.5.2">
<h3 data-number="33.5.2" class="anchored" data-anchor-id="zweifaktoriell-3"><span class="header-section-number">33.5.2</span> Zweifaktoriell</h3>
<p>Die zweifaktorielle repeated ANOVA wird jetzt schon interessanter. Wir haben jetzt nämlich neben der Zeit als Faktor noch eine Behandlung vorliegen. In unserem Beispiel erhält <em>jeder</em> Floh drei Arten der Fütterung wiederholt gefüttert. Zum einen erhält jeder Floh ein Zuckerwasser, dann Blut und zum Schluss Ketchup als Nahrung. Die Reihenfolge sollte sich dann von Floh Floh noch unterscheiden und die Zeiten zwischen den Behandlungen dann so lang gewählt werden, dass die Ernährung förmlich ausgewaschen ist. Die Idee ist, dass die vorherige Ernährungsform keinen Einfluss auf die neue Ernährung hat. Dann müssen wir das Ganze ja auch noch wiederholt über vier Zeitpunkte die Sprungweite messen. Daher misst du hier ganz schön viel. Häufig haben wir dieses Design nicht in den Agrarwissenschaften vorliegen. Wir können aber im Bereich der Nutztierwissenschaften schon das ein oder andere Mal so einen Fall vorliegen haben, wo wir Tiere wiederholt mit einer Behandlung verarzten.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true"><code>{base}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false"><code>{rstatix}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false"><code>{afex}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false"><code>{MANOVA.RM}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>Die Frage ist jetzt immer, wie schreibe ich jetzt das Modell richtig? Der komplizierte Teil ist eigentlich der Fehlerterm <code>Error()</code> aber auch der Teil davor. Ich nutze hier wieder die Kurzschreibweise mit dem Stern <code>*</code> um alle Faktorkombinationen plus Interaktion im Modell zu haben. Das wird eben dann ab zwei Faktoren etwas groß. So ist es dann weniger anfällig für Fehler. Dann musst du noch darauf achten, dass du in dem Fehlerterm die Klammern richtig setzt, sonst funktioniert es dort auch nicht. Erst kommt der Spaltenname für die einzelnen Flöhe <code>.id</code> und dahinter nach dem Slash <code>/</code> dann die Faktorkombinationen der Behandlungen und der Zeit. Dann räume ich die Ausgabe nochmal vollkommen auf, damit ich auch was sehe.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>(feeding <span class="sc">*</span> time_fct)), </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> repeated_fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span> </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, df, statistic, p.value) <span class="sc">|&gt;</span> </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  term                df statistic p.value
  &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  
1 feeding              2    151.   &lt;0.001 
2 time_fct             3     64.7  &lt;0.001 
3 feeding:time_fct     6      9.48 &lt;0.001 </code></pre>
</div>
</div>
<p>Wie wir sehen sind beide Faktoren der Zeit und der Fütterungsart signifikant. Der p-Wert ist kleiner als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5%. Auch haben wir eine signifikante Interaktion zwischen den Fütterungsarten und der Zeit. Daher zeigen die Fütterungsarten unterschiedliche Sprungweiten zu den verschiedenen Zeitpunkten.</p>
<p>Dann können wir uns auch den Effektschätzer Eta^<span class="math inline">\(^2\)</span> berechnen lassen. Hier müssen wir dann das ANOVA Modell einmal in die Funktion <code>eta_squared()</code> stecken und darauf achten, dass wir angeben, dass wir die Zeitpunkte nur beobachtet haben und nicht experimentell festgelegt. Deshalb kommt <code>time_fct</code> noch in die Option <code>generalized</code> mit rein. Die Effektschätzer unterscheiden sich hier immer ein wenig, dass kommt dann immer auf den verwendeten Algorithmus an.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>(feeding <span class="sc">*</span> time_fct)), </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> repeated_fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">eta_squared</span>(<span class="at">generalized =</span> <span class="fu">c</span>(<span class="st">"time_fct"</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA (Type I)

Group                |        Parameter | Eta2 (generalized) |       95% CI
---------------------------------------------------------------------------
.id:feeding          |          feeding |               0.48 | [0.20, 1.00]
.id:time_fct         |         time_fct |               0.40 | [0.15, 1.00]
.id:feeding:time_fct | feeding:time_fct |               0.13 | [0.00, 1.00]

- Observed variables: time_fct
- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>Das R Paket <code>{rstatix}</code> hat eine andere Schreibweise des Modells. Im Prinzip schreiben wir hier wieder nicht das Modell auf, sondern weisen die Spaltennamen dann den jeweiligen Optionen zu. Hier werden dann auch alle Interaktionen gerechnet, du kannst die Interaktionen aller Faktorkombinationen nicht abstellen. Wir setzten dann unseren Endpunkt <code>jump_length</code> in die Option <code>dv</code> und die einzelnen Beobachtungen in die Option <code>wid</code>. Dann müssen wir noch die beiden Faktoren der Zeit und der Behandlung in die Option <code>within</code> einfügen. Dann haben wir auch schon alles zusammen. Was hier etwas doof ist, ist das wir hier die Formelschreibweise in R verlassen, die wir dann aber überall sonst nutzen. Dafür erhalten wir dann aber das Eta<span class="math inline">\(^2\)</span> gleich als <code>ges</code> wieder aus der Funktion zurück.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>rstatix_aov <span class="ot">&lt;-</span> <span class="fu">anova_test</span>(<span class="at">data =</span> repeated_fac2_tbl, </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">dv =</span> jump_length, <span class="at">wid =</span> .id, </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">within =</span> <span class="fu">c</span>(feeding, time_fct))</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">get_anova_table</span>(rstatix_aov)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>ANOVA Table (type III tests)

            Effect DFn DFd       F        p p&lt;.05   ges
1          feeding   2  22 150.881 1.43e-13     * 0.667
2         time_fct   3  33  64.693 6.57e-14     * 0.459
3 feeding:time_fct   6  66   9.480 1.69e-07     * 0.216</code></pre>
</div>
</div>
<p>Wir erhalten die gleichen Ergebnisse wie schon bei der Funktion <code>aov()</code> wiedergegeben. Das überrascht auch nicht, den die Berechnung ist ja die gleiche Berechnung wie auch in <code>aov()</code> nur eben dann mit einem anderen Funktionsaufruf.</p>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<p>Das R Paket <code>{afex}</code> nutzt die Formelschreibweise und kann auch genau so bedient werden wie schon die Funktion <code>aov()</code>. Dafür können wir aber mit der Option <code>type</code> auch anderen Typen der ANOVA nutzen und nicht nur die Type I ANOVA in <code>aov()</code>. Das ist eigentlich die große Stärke von dem R Paket <code>{afex}</code>, dass wir hier flexibel bei der Auswahl der Typen sind. Bei der einfaktoriellen ANOVA war es noch egal, aber hier macht es mit zwei Faktoren dann schon einen Unterschied welche Art der ANOVA du rechnen möchtest. Ich nutze hier den Standard und damit die Type III ANOVA. Auch erhälst du bei der Funktion <code>aov_car()</code> einen Wert für Eta<span class="math inline">\(^2\)</span> in der Spalte <code>ges</code> wiedergegeben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>feeding <span class="sc">*</span> time_fct), </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> repeated_fac2_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: jump_length
            Effect          df   MSE          F  ges p.value
1          feeding 1.84, 20.24 18.95 150.88 *** .667   &lt;.001
2         time_fct 2.43, 26.71 14.23  64.69 *** .459   &lt;.001
3 feeding:time_fct 3.94, 43.39 19.43   9.48 *** .216   &lt;.001
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1

Sphericity correction method: GG </code></pre>
</div>
</div>
<p>Die Ergebnisse sind ähnlich wie schon bei den beiden anderen Algorithmen, aber hier macht es dann einen Unterschied welche ANOVA grechnet wird. Wir rechnen hier dann ja eine Type 3 ANOVA. Die p-Werte sind aber alle so gering, dass es dann am Ende keinen so großen Unterschied mehr macht.</p>
<p>Das R Paket <code>{afex}</code> erlaubt es auch die Modelle nach der Schreibweise der linearen gemischten Modelle zu definieren. Das ist für mich eigentlich etwas angenehmer, da man sich dann in einer Formelwelt aufhält mehr dazu dann im <a href="#sec-mixed">Kapitel zu gemischten Modellen</a>. Also die Ergebnisse sind die Gleichen. Ich brauche es nur als Referenz für mich zum nachschlagen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_4</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> time_fct <span class="sc">+</span> (feeding <span class="sc">*</span> time_fct<span class="sc">|</span>.id), </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> repeated_fac2_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<p>Am Ende dann noch die Funktion <code>RM()</code> aus dem R Paket. Erstmal erhalten wir auch hier weder drei statistische Tests, obwohl wir nur nach einem gefragt haben. Ich würde auch hier nur die Ausgabe von <code>ANOVA-Type Statistic (ATS)</code> betrachten. Auch hier sehen wir, dass wir in einem zweifaktoriellen Fall die ähnlichen Werte wie in den anderen R Paketen erhalten. Hier fängt es dann etwas an zu variieren. Hier haben wir dann aber noch mehr Informationen, die wir dann brauchen oder auch nicht. Ich habe dann einmal hier die Anzeige der Funktion ausgeschaltet, da hier der Output dann sehr lang wird. Du kannst dir beispielhaft die Ausgabe einmal bei der einfaktoriellen repeated ANOVA weiter oben einmal anschaue oder eben den Code selber einmal durchführen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">RM</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> time_fct, <span class="at">data =</span> repeated_fac2_tbl, </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">subject =</span> <span class="st">".id"</span>, <span class="at">within =</span> <span class="fu">c</span>(<span class="st">"feeding"</span>, <span class="st">"time_fct"</span>), <span class="at">iter =</span> <span class="dv">100</span>, </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">resampling =</span> <span class="st">"Perm"</span>, <span class="at">seed =</span> <span class="dv">1234</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="dreifaktoriell-3" class="level3" data-number="33.5.3">
<h3 data-number="33.5.3" class="anchored" data-anchor-id="dreifaktoriell-3"><span class="header-section-number">33.5.3</span> Dreifaktoriell</h3>
<p>Als letztes betrachten wir einen sehr exotischen Fall im Bereich der Agrarwissenschaften. Auch in anderen Forschungsbereichen ist die dreifaktorielle repeated ANOVA eher selten bis nicht vorhanden. Warum ist das so? Zum einen haben wir ja wieder unseren Faktor der Zeit. Wir messen hier viermal die Sprungweite eines Katzenflohs. Da wir aber dann noch zusätzlich zu dem Faktor der Zeit zwei weitere Behandlungen haben, kommen wir auf eine große Anzahl an Faktorkombinationen, die <em>jeder</em> Floh wiederholt durchlaufen muss. In unserem Fall haben wir ja die drei Fütterungsarten mit Zuckerwasser als Kontrolle, dem Blut sowie Ketchup als Ernährung. Dazu kommt dann noch ein Workout, dass jeder Floh gemacht hat oder nicht. Daher muss für jeden Floh jede Kombination der Fütterungsart und des Workouts wiederholt die Sprungweite gemessen werden. Das führt zu einem enormen Aufwand. Zum einen musst du ja immer Pausen zwischen den Behandlungen machen, damit sich die Effekte wieder auswaschen und es mit einem frischen Floh losgehen kann. Das ist eine zeitliche Belastung. Zum anderen ist es natürlich auch so, dass über die Zeit eventuell ein Floh nicht mehr kann oder gar verstirbt. Dann ist die ganze Messreihe für den Floh obsolet. Du siehst, diese Form des experimentellen Designs ist eher selten in Abschlussarbeiten und kommt eher in klinischen Studien oder längerfristigen agrarwissenschaftlichen Experimenten vor.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true"><code>{base}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false"><code>{rstatix}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false"><code>{afex}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false"><code>{MANOVA.RM}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>Die Frage ist jetzt immer, wie schreibe ich jetzt das Modell richtig? Der komplizierte Teil ist eigentlich der Fehlerterm <code>Error()</code> aber auch der Teil davor. Ich nutze hier wieder die Kurzschreibweise mit dem Stern <code>*</code> um alle Faktorkombinationen plus Interaktion im Modell zu haben. Das wird eben dann ab schon zwei Faktoren etwas groß und mit drei Faktoren sehr unübersichtlich. So ist es dann weniger anfällig für Fehler. Dann musst du noch darauf achten, dass du in dem Fehlerterm die Klammern richtig setzt, sonst funktioniert es dort auch nicht. Erst kommt der Spaltenname für die einzelnen Flöhe <code>.id</code> und dahinter nach dem Slash <code>/</code> dann die Faktorkombinationen der Behandlungen und der Zeit. Dann räume ich die Ausgabe nochmal vollkommen auf, damit ich auch was sehe.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> workout <span class="sc">*</span> time_fct <span class="sc">+</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Error</span>(.id<span class="sc">/</span>(feeding <span class="sc">*</span> workout <span class="sc">*</span> time_fct)), </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> repeated_fac3_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span> </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, df, statistic, p.value) <span class="sc">|&gt;</span> </span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 4
  term                        df statistic p.value
  &lt;chr&gt;                    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  
1 feeding                      2   781.    &lt;0.001 
2 workout                      1  1000.    &lt;0.001 
3 time_fct                     3    84.2   &lt;0.001 
4 feeding:workout              2     2.87  0.078  
5 feeding:time_fct             6    52.3   &lt;0.001 
6 workout:time_fct             3     0.472 0.704  
7 feeding:workout:time_fct     6     0.873 0.520  </code></pre>
</div>
</div>
<p>Wir erhalten jetzt eine Menge an Ausgabe wieder. Insbesondere die vielen Interaktionen führen natürlich zu mehr Ausgabe. Aber auch hier sind erstmal die Haupteffekte der Art der Fütterung und des Workout am interessantesten. Wir sehen hier, dass beide Faktoren signifikant sind, der p-Wert liegt unter dem Signifikanzniveau von <span class="math inline">\(\alpha\)</span> gleich 5%. Wir haben dann auch eine signifikante Zeitkomponente. Daher werden sich die Sprungweiten auch über die Zeit ändern. Am Ende ist dann nur die Interaktion zwischen der Fütterungsart und der Zeit signifikant. Anscheinend verhalten sich die Fütterungsarten nicht gleich über alle Zeitpunkte hinweg.</p>
<p>Dann können wir noch die Effektschätzer Eta<span class="math inline">\(^2\)</span> für alle Faktoren und deren Interaktionen berechnen. Ich habe dann auch hier aufgeräumt und die Eta<span class="math inline">\(^2\)</span>-Werte einmal gerundet, damit du besser sehen kannst, welche der Werte überhaupt größer sind. Auch hier sehen wir dann, dass die Hauptfaktoren den größten Effekt haben, gefolgt von den Zeitpunkten und der Interaktion zwischen den Fütterungsarten und der Zeit.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> workout <span class="sc">*</span> time_fct <span class="sc">+</span> </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Error</span>(.id<span class="sc">/</span>(feeding <span class="sc">*</span> workout <span class="sc">*</span> time_fct)), </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> repeated_fac3_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">eta_squared</span>(<span class="at">generalized =</span> <span class="fu">c</span>(<span class="st">"time_fct"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Parameter, Eta2_generalized) <span class="sc">|&gt;</span> </span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Eta2_generalized =</span> <span class="fu">round</span>(Eta2_generalized, <span class="dv">2</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA

Parameter                | Eta2 (generalized)
---------------------------------------------
feeding                  |               0.45
workout                  |               0.51
time_fct                 |               0.38
feeding:workout          |               0.01
feeding:time_fct         |               0.26
workout:time_fct         |               0.00
feeding:workout:time_fct |               0.00</code></pre>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>Das R Paket <code>{rstatix}</code> hat eine andere Schreibweise des Modells. Im Prinzip schreiben wir hier wieder nicht das Modell auf, sondern weisen die Spaltennamen dann den jeweiligen Optionen zu. Hier werden dann auch alle Interaktionen gerechnet, du kannst die Interaktionen aller Faktorkombinationen nicht abstellen. Wir setzten dann unseren Endpunkt <code>jump_length</code> in die Option <code>dv</code> und die einzelnen Beobachtungen in die Option <code>wid</code>. Dann müssen wir noch die beiden Faktoren der Zeit und der beiden Behandlungen in die Option <code>within</code> einfügen. Dann haben wir auch schon alles zusammen. Was hier etwas doof ist, ist das wir hier die Formelschreibweise in R verlassen, die wir dann aber überall sonst nutzen. Dafür erhalten wir dann aber das Eta<span class="math inline">\(^2\)</span> gleich als <code>ges</code> wieder aus der Funktion zurück.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>rstatix_aov <span class="ot">&lt;-</span> <span class="fu">anova_test</span>(<span class="at">data =</span> repeated_fac3_tbl, </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">dv =</span> jump_length, <span class="at">wid =</span> .id, </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">within =</span> <span class="fu">c</span>(feeding, workout, time_fct))</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">get_anova_table</span>(rstatix_aov)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>ANOVA Table (type III tests)

                    Effect DFn DFd       F        p p&lt;.05   ges
1                  feeding   2  22 781.468 3.69e-21     * 0.700
2                  workout   1  11 999.674 3.76e-12     * 0.749
3                 time_fct   3  33  84.199 1.52e-15     * 0.518
4          feeding:workout   2  22   2.874 7.80e-02       0.018
5         feeding:time_fct   6  66  52.306 3.41e-23     * 0.428
6         workout:time_fct   3  33   0.472 7.04e-01       0.003
7 feeding:workout:time_fct   6  66   0.873 5.20e-01       0.013</code></pre>
</div>
</div>
<p>Wir erhalten die gleichen Ergebnisse wie schon bei der Funktion <code>aov()</code> wiedergegeben. Das überrascht auch nicht, den die Berechnung ist ja die gleiche Berechnung wie auch in <code>aov()</code> nur eben dann mit einem anderen Funktionsaufruf.</p>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<p>Das R Paket <code>{afex}</code> nutzt die Formelschreibweise und kann auch genau so bedient werden wie schon die Funktion <code>aov()</code>. Dafür können wir aber mit der Option <code>type</code> auch anderen Typen der ANOVA nutzen und nicht nur die Type I ANOVA in <code>aov()</code>. Das ist eigentlich die große Stärke von dem R Paket <code>{afex}</code>, dass wir hier flexibel bei der Auswahl der Typen sind. Bei der einfaktoriellen ANOVA war es noch egal, aber hier macht es mit zwei Faktoren dann schon einen Unterschied welche Art der ANOVA du rechnen möchtest. Ich nutze hier den Standard und damit die Type III ANOVA. Auch erhälst du bei der Funktion <code>aov_car()</code> einen Wert für Eta<span class="math inline">\(^2\)</span> in der Spalte <code>ges</code> wiedergegeben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> workout <span class="sc">*</span> time_fct <span class="sc">+</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">Error</span>(.id<span class="sc">/</span>feeding <span class="sc">*</span> workout <span class="sc">*</span> time_fct), </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> repeated_fac3_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: jump_length
                    Effect          df   MSE          F  ges p.value
1                  feeding 1.65, 18.15 10.60 781.47 *** .700   &lt;.001
2                  workout       1, 11 17.54 999.67 *** .749   &lt;.001
3                 time_fct 2.68, 29.52 27.90  84.20 *** .518   &lt;.001
4          feeding:workout 1.71, 18.84 21.94     2.87 + .018    .088
5         feeding:time_fct 3.96, 43.61 21.16  52.31 *** .428   &lt;.001
6         workout:time_fct 2.54, 27.91 15.60       0.47 .003    .674
7 feeding:workout:time_fct 3.57, 39.22 24.44       0.87 .013    .479
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1

Sphericity correction method: GG </code></pre>
</div>
</div>
<p>Die Ergebnisse sind ähnlich wie schon bei den beiden anderen Algorithmen, aber hier macht es dann einen Unterschied welche ANOVA grechnet wird. Wir rechnen hier dann ja eine Type 3 ANOVA. Die p-Werte sind aber alle so gering, dass es dann am Ende keinen so großen Unterschied mehr macht.</p>
<p>Das R Paket <code>{afex}</code> erlaubt es auch die Modelle nach der Schreibweise der linearen gemischten Modelle zu definieren. Das ist für mich eigentlich etwas angenehmer, da man sich dann in einer Formelwelt aufhält mehr dazu dann im <a href="#sec-mixed">Kapitel zu gemischten Modellen</a>. Also die Ergebnisse sind die Gleichen. Ich brauche es nur als Referenz für mich zum nachschlagen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_4</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> workout <span class="sc">*</span> time_fct <span class="sc">+</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>        (feeding <span class="sc">*</span> workout <span class="sc">*</span> time_fct<span class="sc">|</span>.id), </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> repeated_fac3_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<p>Am Ende dann noch die Funktion <code>RM()</code> aus dem R Paket. Erstmal erhalten wir auch hier weder drei statistische Tests, obwohl wir nur nach einem gefragt haben. Ich würde auch hier nur die Ausgabe von <code>ANOVA-Type Statistic (ATS)</code> betrachten. Auch hier sehen wir, dass wir in einem dreifaktoriellen Fall die ähnlichen Werte wie in den anderen R Paketen erhalten. Je mehr Faktoren wir haben desto stärker werden dann auch die Unterschiede, da natürlich auch mehr Parameter geschätzt werden müssen. Hier haben wir dann aber noch mehr Informationen, die wir dann brauchen oder auch nicht. Ich habe dann einmal hier die Anzeige der Funktion ausgeschaltet, da hier der Output dann sehr lang wird. Du kannst dir beispielhaft die Ausgabe einmal bei der einfaktoriellen repeated ANOVA weiter oben einmal anschauen oder eben den Code selber einmal durchführen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">RM</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> workout <span class="sc">*</span> time_fct, <span class="at">data =</span> repeated_fac3_tbl, </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">subject =</span> <span class="st">".id"</span>, <span class="at">within =</span> <span class="fu">c</span>(<span class="st">"feeding"</span>, <span class="st">"workout"</span>, <span class="st">"time_fct"</span>), <span class="at">iter =</span> <span class="dv">100</span>, </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">resampling =</span> <span class="st">"Perm"</span>, <span class="at">seed =</span> <span class="dv">1234</span>) <span class="sc">|&gt;</span> </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<p>Damit haben wir es dann auch geschafft. Was ist noch kommt sind die Anwendungsbeispiele in der mixed ANOVA. Ich habe noch keine Daten für eine repeated ANOVA bei mir liegen, daher warte ich hier mal ab, was noch kommt. Die beiden Beispiele zeigen aber einmal schön wie du eine zweifaktorielle mixed ANOVA rechnen kannst sowie eine dreifaktorielle mixed ANOVA. In beiden Fällen habe ich dann noch den Posthoc-Test in <code>{emmeans}</code> ergänzt. Ich nutze hier einmal die Funktionen aus dem R Paket <code>{afex}</code> aber du kannst auch ein anderes Paket oder <code>aov()</code> nutzen.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Anwendungsbeispiel: Gurkenwachstum (2-faktorielle mixed ANOVA)
</div>
</div>
<div class="callout-body-container callout-body">
<p>In diesem beispiel wollen wir uns einmal das Gurkenwachstum anschauen. Wir haben dazu drei Gurkensorten Proloog, Quarto und Katrina vorliegen. Wir lassen jeweils sechs Gurken pro Sorte über vierzehn Wochen wachsen. Wir messen dabei jede Woche einmal die Länge von Gurken sowie deren Durchmesser. Hier kommt natürlich die Frage auf, welche Gurken messen wir eigentlich und so eine Pflanze hat ja auch mehrere Gurken. Das lassen wir hier mal im Raum stehen, wir haben einfach eine Gurken, die immer länger werden. Wir laden erstmal die Daten ein und nehmen aber nur die Sorten <code>group</code> und die Messzeitpunkte mit in die Analyse.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>gurke_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/wachstum_gurke.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">group =</span> versuchsgruppe, t1<span class="sc">:</span>t14) <span class="sc">|&gt;</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">as_factor</span>(group)) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der folgenden Tabelle siehst du dann nochmal einen Ausschnitt aus den Daten. Wir werden jetzt gleich nur nach der Länge <code>L</code> filtern und auch die Daten aus dem Wide-Format in das Long-Format überführen.</p>
<div class="cell">
<div id="tbl-anwendung-gurke" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-anwendung-gurke-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;33.6— Datensatz zu dem Längen- und Dickenwachstum von Gurken. Hier sind nur die Messzeitpunkte <code>t1</code> bis <code>t4</code> dargestellt.
</figcaption>
<div aria-describedby="tbl-anwendung-gurke-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_frn61k91f2rr4kc2az6a(i, j, css_id) {
          var table = document.getElementById("tinytable_frn61k91f2rr4kc2az6a");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_frn61k91f2rr4kc2az6a');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_frn61k91f2rr4kc2az6a(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_frn61k91f2rr4kc2az6a");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 7, j: 0 }, { i: 7, j: 1 }, { i: 7, j: 2 }, { i: 7, j: 3 }, { i: 7, j: 4 },  ], css_id: 'tinytable_css_8lx5ejumi07g18g7uygt',}, 
          { positions: [ { i: 1, j: 0 }, { i: 3, j: 0 }, { i: 5, j: 0 }, { i: 5, j: 1 }, { i: 5, j: 2 }, { i: 1, j: 1 }, { i: 3, j: 1 }, { i: 3, j: 2 }, { i: 3, j: 3 }, { i: 5, j: 3 }, { i: 1, j: 2 }, { i: 1, j: 3 }, { i: 1, j: 4 }, { i: 3, j: 4 }, { i: 5, j: 4 },  ], css_id: 'tinytable_css_000pm8d1licgbexfmn9c',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 }, { i: 0, j: 4 },  ], css_id: 'tinytable_css_073xjn42lc9np5nf80l0',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_frn61k91f2rr4kc2az6a(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_8lx5ejumi07g18g7uygt, .table th.tinytable_css_8lx5ejumi07g18g7uygt { background-color: #ededed; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_000pm8d1licgbexfmn9c, .table th.tinytable_css_000pm8d1licgbexfmn9c { background-color: #ededed; }
      .table td.tinytable_css_073xjn42lc9np5nf80l0, .table th.tinytable_css_073xjn42lc9np5nf80l0 { border-bottom: solid #d3d8dc 0.1em; }
    </style>
    <div class="container">
      <table class="table table-striped" id="tinytable_frn61k91f2rr4kc2az6a" style="table-layout: fixed; width: 100% !important; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">group</th>
                <th scope="col">t1</th>
                <th scope="col">t2</th>
                <th scope="col">t3</th>
                <th scope="col">t4</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>Proloog L</td>
                  <td>5.5</td>
                  <td>6.1</td>
                  <td>7.4</td>
                  <td>8.9</td>
                </tr>
                <tr>
                  <td>Proloog L</td>
                  <td>4.6</td>
                  <td>5.1</td>
                  <td>6.4</td>
                  <td>5.7</td>
                </tr>
                <tr>
                  <td>Proloog L</td>
                  <td>5.3</td>
                  <td>5.8</td>
                  <td>6.8</td>
                  <td>8.3</td>
                </tr>
                <tr>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                </tr>
                <tr>
                  <td>Katrina D</td>
                  <td>0.86</td>
                  <td>0.87</td>
                  <td>0.9</td>
                  <td>1.1</td>
                </tr>
                <tr>
                  <td>Katrina D</td>
                  <td>0.62</td>
                  <td>0.67</td>
                  <td>0.7</td>
                  <td>0.71</td>
                </tr>
                <tr>
                  <td>Tageslänge</td>
                  <td>13.98</td>
                  <td>14.05</td>
                  <td>14.12</td>
                  <td>14.18</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<p>Die Längen werden mit einem <code>L</code> hinter dem Sortennamen angezeigt und der Durchmesser mit einem <code>D</code> hinter der Sorte. Deshalb filtern wir hier gleich mal nur die Daten mit den Gurkenlängen raus. Dann bauen wir uns noch einen Faktor mit den entsprechenden Namen. Die Daten brauchen wir noch im Long-Format und dazu nutze ich dann die Funktion <code>pivot_longer()</code>. Am Ende möchte ich immer nochmal die Zeitpunkte als Faktor sowie numerisch. Manchmal ist das eine einfacher in <code>{ggplot}</code> abzubilden als das andere.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>gurke_time_len_tbl <span class="ot">&lt;-</span> gurke_tbl <span class="sc">|&gt;</span> </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(group, <span class="st">"L$"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">".id"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">factor</span>(group, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Proloog"</span>, <span class="st">"Quarto"</span>, <span class="st">"Katrina"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> t1<span class="sc">:</span>t14,</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"length"</span>,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"time"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time_fct =</span> <span class="fu">as_factor</span>(time),</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">time_num =</span> <span class="fu">as.numeric</span>(time_fct)) <span class="sc">|&gt;</span> </span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(length <span class="sc">!=</span> <span class="dv">0</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann kommen wir auch schon zur visuellen Darstellung der Daten. Hier habe ich dann einmal über alle vierzehn Zeitpunkte die mittlere Länge sowie die mediane Länge dargestellt. Die einzelnen Punkte stellen die einzelnen Beobachtungen dar. Hier fällt auf, dass eventuell einzelne Gurken eine etwas seltsames Längenwachstum haben. Wir würden ja davon ausgehen, dass eine Gurke wächst über die Zeit und nicht schrumpft. Am Ende sehen wir noch, dass die letzten Wochen nicht mehr vollständig bemessen wurden. Hier mag es dann Sinn machen, die letzten Wochen bis Woche <code>t12</code> zu entfernen. Dann haben wir einen besseren Datensatz.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gurke_time_len_tbl, </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(time_fct, length, <span class="at">color =</span> group, </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point2</span>() <span class="sc">+</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"median"</span>, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)<span class="sc">+</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Zeitpunkte der Messung"</span>, <span class="at">y =</span> <span class="st">"Gurkenlänge [cm]"</span>,</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Sorte"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-anwendung-gurke-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-anwendung-gurke-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova-mixed_files/figure-html/fig-anwendung-gurke-01-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Abbildung&nbsp;33.14— Scatterplot des Längenwachstums der drei Gurkensorten über vierzehn Wochen. Die gestrichtelten Linien stellen den Median und die durchgezogene Line den Mittelwert der Gruppen dar."><img src="stat-tests-anova-mixed_files/figure-html/fig-anwendung-gurke-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-anwendung-gurke-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;33.14— Scatterplot des Längenwachstums der drei Gurkensorten über vierzehn Wochen. Die gestrichtelten Linien stellen den Median und die durchgezogene Line den Mittelwert der Gruppen dar.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Um die einzelnen Gurkenpflanzen besser zu verstehen, habe ich einmal die Pflanzen einzeln als Verlauf über die Zeit dargestellt. Hier sehen wir dann wirklich einige seltsame Pflanzen. Ich habe hier nochmal über die Funktion <code>geom_label_repel()</code> die IDs der einzelnen Pflanzen zu den Verläufen ergänzt. Ich habe mir dann noch die Mühe gemacht, die Werte dann auch immer an den letzten Zeitpunkt zu schreiben. Wir sehen sehr schön, dass mit der Pflanze 2 irgendwas nicht stimmt. Die Gurkenpflanze 2 wächst nämlich nicht sondern schrumpft über die Zeit.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>max_time_tbl <span class="ot">&lt;-</span> gurke_time_len_tbl <span class="sc">|&gt;</span> </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">group_by</span>(group, .id) <span class="sc">|&gt;</span> </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(time_num <span class="sc">==</span> <span class="fu">max</span>(time_num))</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gurke_time_len_tbl, </span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(time_fct, <span class="fu">log</span>(length), <span class="at">color =</span> group, </span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> .id)) <span class="sc">+</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point2</span>() <span class="sc">+</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label_repel</span>(<span class="at">data =</span> max_time_tbl, <span class="fu">aes</span>(time_fct, <span class="fu">log</span>(length), <span class="at">label =</span> .id),              </span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">box.padding =</span> <span class="fu">unit</span>(<span class="fl">0.35</span>, <span class="st">"lines"</span>), <span class="at">point.padding =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"lines"</span>),</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">segment.color =</span> <span class="st">'grey50'</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)<span class="sc">+</span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Zeitpunkte der Messung"</span>, <span class="at">y =</span> <span class="st">"Gurkenlänge [cm] (log-scale)"</span>,</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Sorte"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-anwendung-gurke-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-anwendung-gurke-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova-mixed_files/figure-html/fig-anwendung-gurke-02-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Abbildung&nbsp;33.15— Scatterplot des Längenwachstums der drei Gurkensorten über vierzehn Wochen für das individuelle Wachstum der einzelnen Gurken. Die Label am Ende des Wachstums stellen die Pflanzen IDs dar."><img src="stat-tests-anova-mixed_files/figure-html/fig-anwendung-gurke-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-anwendung-gurke-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;33.15— Scatterplot des Längenwachstums der drei Gurkensorten über vierzehn Wochen für das individuelle Wachstum der einzelnen Gurken. Die Label am Ende des Wachstums stellen die Pflanzen IDs dar.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Dann können wir auch schon mit der Analyse der Daten mit einer mixed ANOVA beginnen. Je nachdem welche Schreibweise der Modelle in der ANOVA du bevorzugst, kannst du zwischen den beiden Funktionen <code>aov_car()</code> und <code>aov_4()</code> wählen. Ich habe hier für mich beide Formen einmal dargestellt. In beiden Fällen kommt das Gleiche raus, es geht eben nur um die Form der Darstellung der Modelle.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true"><code>aov_car()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false"><code>aov_4</code></a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>In dem Modell für R <code>{base}</code> nutzen wir die Schreibweise mit der Funktion <code>Error()</code> um den Fehlerterm und die Abhängigkeiten in dem Fehlerterm anzugeben. Hier haben wir die einzelnen Beobachtungen <code>.id</code> wiederholt in den Messzeitpunkten <code>time_fct</code> gemessen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(length <span class="sc">~</span> group <span class="sc">*</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>time_fct), </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> gurke_time_len_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: length
          Effect          df   MSE         F  ges p.value
1          group       2, 13 74.07 25.08 *** .704   &lt;.001
2       time_fct 1.39, 18.11 33.11 92.69 *** .732   &lt;.001
3 group:time_fct 2.79, 18.11 33.11 15.46 *** .477   &lt;.001
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1

Sphericity correction method: GG </code></pre>
</div>
</div>
<p>Was sehen wir? Alle Faktoren und die Interaktion sind signifikant, da der p-Wert kleiner ist als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5%. Im Weiteren sehen wir auch, dass die Effekte in der Spalte <code>ges</code> als Eta<span class="math inline">\(^2\)</span> für die Versuchsgruppen sowie für die Zeit stark sind. Auch die Interaktion hat einen bedeutenden Effekt. Das wundert uns nicht, da wir ja Gurken haben, die über die Zeit weniger wachsen als alle anderen Gurken. Die Interaktion siehst du dann ganz gut an der Gurke Nr. 2 sowie an anderen Gurken gegen Ende der Untersuchung.</p>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p>In dem Modell für R nach dem R Paket <code>{lme4}</code> und anderen Paketen nutzen wir die Schreibweise mit den Klammern <code>()</code> und dem Strich <code>|</code> um den Fehlerterm und die Abhängigkeiten in dem Fehlerterm anzugeben. Hier haben wir die einzelnen Beobachtungen <code>.id</code> wiederholt in den Messzeitpunkten <code>time_fct</code> gemessen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_4</span>(length <span class="sc">~</span> group <span class="sc">*</span> time_fct <span class="sc">+</span> (time_fct<span class="sc">|</span>.id), </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> gurke_time_len_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: length
          Effect          df   MSE         F  ges p.value
1          group       2, 13 74.07 25.08 *** .704   &lt;.001
2       time_fct 1.39, 18.11 33.11 92.69 *** .732   &lt;.001
3 group:time_fct 2.79, 18.11 33.11 15.46 *** .477   &lt;.001
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1

Sphericity correction method: GG </code></pre>
</div>
</div>
<p>Für die Interpretation bitte den Tab zu der Funktion <code>aov_car()</code> beachten. Die Ausgaben sind die gleichen numerischen Werte und da beschreibe ich das für dich dann nur einmal.</p>
</div>
</div>
</div>
<p>Am Ende wollen wir dann noch die paarweisen Vergleich in <code>{emmeans}</code> rechnen. Dazu können wir dann direkt das Modell aus <code>aov_car()</code> nutzen und uns alle paarweisen Vergleiche <em>getrennt</em> für die Zeitpunkte wiedergeben lassen. Ändere einfach den Stich <code>|</code> durch einen Stern <code>*</code>, wenn du über alle Zeitpunkte hinweg vergleichen willst.</p>
<p>Es kommt jetzt ein riesiger Wust an Ausgabe. Am Ende können wir dann aber an jedem Zeitpunkt schauen, ob sich die drei Linien voneinander unterscheiden. Wir hätten hier natürlich nochmal die Daten aufreinigen müssen. Die Aufreinigung würde dann aber hier das Beispiel im Umfang sprengen. Auch habe ich hier auf eine Adjustierung der p-Werte verzichtet. Deshalb hier nur einmal die schnelle Analyse.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(length <span class="sc">~</span> group <span class="sc">*</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>time_fct), </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> gurke_time_len_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> group <span class="sc">|</span> time_fct) <span class="sc">|&gt;</span> </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>time_fct = t1:
 group   emmean    SE df lower.CL upper.CL .group
 Quarto    2.25 0.142 13     1.94     2.56  a    
 Katrina   3.26 0.156 13     2.92     3.60   b   
 Proloog   5.08 0.156 13     4.74     5.42    c  

time_fct = t2:
 group   emmean    SE df lower.CL upper.CL .group
 Quarto    2.52 0.154 13     2.18     2.85  a    
 Katrina   3.50 0.168 13     3.14     3.86   b   
 Proloog   5.54 0.168 13     5.18     5.90    c  

time_fct = t3:
 group   emmean    SE df lower.CL upper.CL .group
 Quarto    2.77 0.195 13     2.34     3.19  a    
 Katrina   3.68 0.214 13     3.22     4.14   b   
 Proloog   6.56 0.214 13     6.10     7.02    c  

time_fct = t4:
 group   emmean    SE df lower.CL upper.CL .group
 Quarto    3.00 0.337 13     2.27     3.73  a    
 Katrina   3.98 0.369 13     3.18     4.78  a    
 Proloog   7.68 0.369 13     6.88     8.48   b   

time_fct = t5:
 group   emmean    SE df lower.CL upper.CL .group
 Quarto    3.23 0.452 13     2.26     4.21  a    
 Katrina   4.30 0.495 13     3.23     5.37  a    
 Proloog   8.20 0.495 13     7.13     9.27   b   

time_fct = t6:
 group   emmean    SE df lower.CL upper.CL .group
 Quarto    3.57 0.653 13     2.16     4.98  a    
 Katrina   5.14 0.716 13     3.59     6.69  a    
 Proloog   9.46 0.716 13     7.91    11.01   b   

time_fct = t7:
 group   emmean    SE df lower.CL upper.CL .group
 Quarto    3.95 0.864 13     2.08     5.82  a    
 Katrina   5.94 0.946 13     3.90     7.98  a    
 Proloog  11.42 0.946 13     9.38    13.46   b   

time_fct = t8:
 group   emmean    SE df lower.CL upper.CL .group
 Quarto    4.53 1.150 13     2.04     7.02  a    
 Katrina   6.90 1.260 13     4.17     9.63  a    
 Proloog  13.40 1.260 13    10.67    16.13   b   

time_fct = t9:
 group   emmean    SE df lower.CL upper.CL .group
 Quarto    4.78 1.320 13     1.93     7.63  a    
 Katrina   7.52 1.440 13     4.40    10.64  a    
 Proloog  15.62 1.440 13    12.50    18.74   b   

time_fct = t10:
 group   emmean    SE df lower.CL upper.CL .group
 Quarto    5.25 1.500 13     2.01     8.49  a    
 Katrina   8.40 1.640 13     4.85    11.95  a    
 Proloog  17.36 1.640 13    13.81    20.91   b   

time_fct = t11:
 group   emmean    SE df lower.CL upper.CL .group
 Quarto    5.72 1.690 13     2.08     9.36  a    
 Katrina   9.20 1.850 13     5.21    13.19  a    
 Proloog  19.52 1.850 13    15.53    23.51   b   

time_fct = t12:
 group   emmean    SE df lower.CL upper.CL .group
 Quarto    6.28 1.730 13     2.56    10.01  a    
 Katrina  10.02 1.890 13     5.94    14.10  a    
 Proloog  20.96 1.890 13    16.88    25.04   b   

time_fct = t13:
 group   emmean    SE df lower.CL upper.CL .group
 Quarto    8.23 1.930 13     4.06    12.41  a    
 Katrina  13.10 2.120 13     8.52    17.68  a    
 Proloog  28.52 2.120 13    23.94    33.10   b   

time_fct = t14:
 group   emmean    SE df lower.CL upper.CL .group
 Quarto    8.68 1.890 13     4.59    12.77  a    
 Katrina  13.58 2.070 13     9.10    18.06  a    
 Proloog  30.06 2.070 13    25.58    34.54   b   

Confidence level used: 0.95 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Anwendungsbeispiel: Grünkohlhöhe (3-faktorielle mixed ANOVA)
</div>
</div>
<div class="callout-body-container callout-body">
<p>Im nächsten Beispiel schauen wir uns einmal die Höhe von Grünkohl an. Wir haben hier zwei Arten von Lichtgabe sowie zwei Sorten vorliegen. Dann messen wir die Höhe des Grünkohls noch an sieben Terminen. Daher haben wir hier wirklich mal eine dreifaktorielle ANOVA vorliegen. Da unsere beiden Behandlungsfaktoren nur zwei Level haben, können wir hier fast auf einen Post-hoc Test verzichten. Wir brauchen den Post-hoc Test aber dann für die Vergleiche in den jeweiligen Zeitpunkten. Wir laden also unseren Datensatz und nehmen nur die Wachstumsdaten mit den sieben Zeitpunkten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>kale_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/kale_time_height.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(light, variety, t1<span class="sc">:</span>t7) <span class="sc">|&gt;</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">light =</span> <span class="fu">as_factor</span>(light),</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">variety =</span> <span class="fu">as_factor</span>(variety)) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann hier einmal der Auszug aus den Daten zu dem Wachstum des Grünkohls. Ich habe hier nur die ersten vier Zeitpunkte ausgewählt. Wir müssen dann gleich einmal die Daten von dem Wide-Format in das Long-Format überführen. Für die Betrachtung ist es natütlich so schöner.</p>
<div class="cell">
<div id="tbl-anwendung-kale" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-anwendung-kale-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;33.7— Datensatz zu dem Höhenwachstum von Grünkohl. Hier sind nur die Messzeitpunkte <code>t1</code> bis <code>t4</code> dargestellt.
</figcaption>
<div aria-describedby="tbl-anwendung-kale-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_i34qwiuae3zxxmdf5d2i(i, j, css_id) {
          var table = document.getElementById("tinytable_i34qwiuae3zxxmdf5d2i");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_i34qwiuae3zxxmdf5d2i');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_i34qwiuae3zxxmdf5d2i(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_i34qwiuae3zxxmdf5d2i");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 7, j: 0 }, { i: 7, j: 1 }, { i: 7, j: 2 }, { i: 7, j: 3 }, { i: 7, j: 4 }, { i: 7, j: 5 },  ], css_id: 'tinytable_css_g6n16yc343d5oyn7e6qh',}, 
          { positions: [ { i: 3, j: 0 }, { i: 5, j: 0 }, { i: 5, j: 1 }, { i: 1, j: 0 }, { i: 1, j: 1 }, { i: 3, j: 1 }, { i: 3, j: 2 }, { i: 5, j: 2 }, { i: 5, j: 3 }, { i: 1, j: 2 }, { i: 1, j: 3 }, { i: 3, j: 3 }, { i: 3, j: 4 }, { i: 5, j: 4 }, { i: 5, j: 5 }, { i: 1, j: 4 }, { i: 1, j: 5 }, { i: 3, j: 5 },  ], css_id: 'tinytable_css_0ne5kufmxpyop0kllwit',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 }, { i: 0, j: 4 }, { i: 0, j: 5 },  ], css_id: 'tinytable_css_3l1ze6yaon0pp5w43cft',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_i34qwiuae3zxxmdf5d2i(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_g6n16yc343d5oyn7e6qh, .table th.tinytable_css_g6n16yc343d5oyn7e6qh { background-color: #ededed; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_0ne5kufmxpyop0kllwit, .table th.tinytable_css_0ne5kufmxpyop0kllwit { background-color: #ededed; }
      .table td.tinytable_css_3l1ze6yaon0pp5w43cft, .table th.tinytable_css_3l1ze6yaon0pp5w43cft { border-bottom: solid #d3d8dc 0.1em; }
    </style>
    <div class="container">
      <table class="table table-striped" id="tinytable_i34qwiuae3zxxmdf5d2i" style="table-layout: fixed; width: 100% !important; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">light</th>
                <th scope="col">variety</th>
                <th scope="col">t1</th>
                <th scope="col">t2</th>
                <th scope="col">t3</th>
                <th scope="col">t4</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>dark light</td>
                  <td>Nero di Toscana</td>
                  <td>2.5</td>
                  <td>3.5</td>
                  <td>7</td>
                  <td>8.6</td>
                </tr>
                <tr>
                  <td>dark light</td>
                  <td>Nero di Toscana</td>
                  <td>3.3</td>
                  <td>3.6</td>
                  <td>5.5</td>
                  <td>10</td>
                </tr>
                <tr>
                  <td>dark light</td>
                  <td>Nero di Toscana</td>
                  <td>4.5</td>
                  <td>5.6</td>
                  <td>5.75</td>
                  <td>6</td>
                </tr>
                <tr>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                </tr>
                <tr>
                  <td>bright light</td>
                  <td>Oldenbor</td>
                  <td>2.4</td>
                  <td>4</td>
                  <td>6.25</td>
                  <td>8.7</td>
                </tr>
                <tr>
                  <td>bright light</td>
                  <td>Oldenbor</td>
                  <td>2</td>
                  <td>3.8</td>
                  <td>6</td>
                  <td>8.3</td>
                </tr>
                <tr>
                  <td>bright light</td>
                  <td>Oldenbor</td>
                  <td>3.8</td>
                  <td>4.2</td>
                  <td>7</td>
                  <td>8.5</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<p>Es fehlen in den Daten noch die IDs für die einzelnen Grünkohlpflanzen. Das holen wir dann durch die Funktion <code>rownames_to_column()</code> einmal nach. Dann müssen wir noch die Daten in das Long-Format mit der Funktion <code>pivot_longer()</code> überführen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>kale_time_height_tbl <span class="ot">&lt;-</span> kale_tbl <span class="sc">|&gt;</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">".id"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> t1<span class="sc">:</span>t7,</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"height"</span>,</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"time"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time_fct =</span> <span class="fu">as_factor</span>(time),</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">time_num =</span> <span class="fu">as.numeric</span>(time_fct)) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann schauen wir uns in der folgenden Abbildung einmal die individuellen Verläufe des Höhenwachstums der Grünkohlpflanzen an. Wir sehen, dass die Pflanzen sehr schön und gleichmäßig wachsen. Hier gibt es keine Pflanze, die besonders auffällt und daher selektiert werden müsste.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(kale_time_height_tbl, </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(time_fct, height, <span class="at">color =</span> light, <span class="at">linetype =</span> variety,</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> .id)) <span class="sc">+</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)<span class="sc">+</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Zeitpunkte der Messung"</span>, <span class="at">y =</span> <span class="st">"Höhe Grünkohl [cm]"</span>,</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Licht"</span>, <span class="at">linetype =</span> <span class="st">"Sorte"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-anwendung-kale-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-anwendung-kale-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova-mixed_files/figure-html/fig-anwendung-kale-02-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Abbildung&nbsp;33.16— Scatterplot der Grünkohlhöhe für die beiden Lichtarten und Sorten über sieben Wochen für die individuellen Grünkohlpflanzen."><img src="stat-tests-anova-mixed_files/figure-html/fig-anwendung-kale-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-anwendung-kale-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;33.16— Scatterplot der Grünkohlhöhe für die beiden Lichtarten und Sorten über sieben Wochen für die individuellen Grünkohlpflanzen.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Nachdem wir die einzelnen Pflanzen angeschaut haben, können wir auch einmal für die vier Faktorkombinationen aus den zwei Lichtarten und den zwei Sorten einmal die Verläufe anschauen. Ich betrachte dann hier einmal die Mittelwerte. Wir sehen auch hier eine leichte Interaktion. Die Gerade laufen über die Zeit immer weiter auseinander. Auch sehen wir leichte Überschneidungen bei den ersten Zeitpunkten. Das mag dann auch zu einer signifikanten Interaktion führen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(kale_time_height_tbl, </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(time_fct, height, <span class="at">color =</span> light, <span class="at">linetype =</span> variety,</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> variety,</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> <span class="fu">interaction</span>(light, variety))) <span class="sc">+</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)<span class="sc">+</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Zeitpunkte der Messung"</span>, <span class="at">y =</span> <span class="st">"Höhe Grünkohl [cm]"</span>,</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Licht"</span>, <span class="at">shape =</span> <span class="st">"Sorte"</span>, <span class="at">linetype =</span> <span class="st">"Sorte"</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-anwendung-kale-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-anwendung-kale-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova-mixed_files/figure-html/fig-anwendung-kale-01-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Abbildung&nbsp;33.17— Scatterplot der Grünkohlhöhe für die beiden Lichtarten und Sorten über sieben Wochen. Die Linien stellen den Mittelwert der Faktorkombinationen dar."><img src="stat-tests-anova-mixed_files/figure-html/fig-anwendung-kale-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-anwendung-kale-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;33.17— Scatterplot der Grünkohlhöhe für die beiden Lichtarten und Sorten über sieben Wochen. Die Linien stellen den Mittelwert der Faktorkombinationen dar.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Dann können wir auch schon mit der Analyse der Daten mit einer mixed ANOVA beginnen. Je nachdem welche Schreibweise der Modelle in der ANOVA du bevorzugst, kannst du zwischen den beiden Funktionen <code>aov_car()</code> und <code>aov_4()</code> wählen. Ich habe hier für mich beide Formen einmal dargestellt. In beiden Fällen kommt das Gleiche raus, es geht eben nur um die Form der Darstellung der Modelle.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true"><code>aov_car()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false"><code>aov_4</code></a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p>In dem Modell für R <code>{base}</code> nutzen wir die Schreibweise mit der Funktion <code>Error()</code> um den Fehlerterm und die Abhängigkeiten in dem Fehlerterm anzugeben. Hier haben wir die einzelnen Beobachtungen <code>.id</code> wiederholt in den Messzeitpunkten <code>time_fct</code> gemessen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(height <span class="sc">~</span> light <span class="sc">*</span> variety <span class="sc">*</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>time_fct), </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> kale_time_height_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: height
                  Effect          df   MSE          F  ges p.value
1                  light       1, 12 26.75  20.69 *** .430   &lt;.001
2                variety       1, 12 26.75     5.55 * .168    .036
3          light:variety       1, 12 26.75       0.04 .001    .855
4               time_fct 1.58, 18.96 21.84 217.64 *** .911   &lt;.001
5         light:time_fct 1.58, 18.96 21.84   11.12 ** .343    .001
6       variety:time_fct 1.58, 18.96 21.84       1.21 .054    .310
7 light:variety:time_fct 1.58, 18.96 21.84       0.20 .009    .768
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1

Sphericity correction method: GG </code></pre>
</div>
</div>
<p>Wenn wir die p-Werte betrachten, dann haben wir einen signifikanten Effekt der beiden Lichtarten. Die Sorten sind nur gerade noch so signifikant. Hier müsste man nochmal schauen, da der p-Wert doch recht nahe am Signifikanzniveau <span class="math inline">\(\alpha\)</span> von 5% liegt. Die Zeit ist signifikant, aber das überrascht nicht, denn die Pflanzen wachsen ja über die Zeit. Es gibt keine Interaktion zwischen den beiden Hauptfaktoren. Dafür dann aber bei der Lichtart und der Zeit. Hier werden wir nochmal in extra nachschauen.</p>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p>In dem Modell für R nach dem R Paket <code>{lme4}</code> und anderen Paketen nutzen wir die Schreibweise mit den Klammern <code>()</code> und dem Strich <code>|</code> um den Fehlerterm und die Abhängigkeiten in dem Fehlerterm anzugeben. Hier haben wir die einzelnen Beobachtungen <code>.id</code> wiederholt in den Messzeitpunkten <code>time_fct</code> gemessen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_4</span>(height <span class="sc">~</span> light <span class="sc">*</span> variety <span class="sc">*</span> time_fct <span class="sc">+</span> (time_fct<span class="sc">|</span>.id), </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> kale_time_height_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: height
                  Effect          df   MSE          F  ges p.value
1                  light       1, 12 26.75  20.69 *** .430   &lt;.001
2                variety       1, 12 26.75     5.55 * .168    .036
3          light:variety       1, 12 26.75       0.04 .001    .855
4               time_fct 1.58, 18.96 21.84 217.64 *** .911   &lt;.001
5         light:time_fct 1.58, 18.96 21.84   11.12 ** .343    .001
6       variety:time_fct 1.58, 18.96 21.84       1.21 .054    .310
7 light:variety:time_fct 1.58, 18.96 21.84       0.20 .009    .768
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1

Sphericity correction method: GG </code></pre>
</div>
</div>
<p>Für die Interpretation bitte den Tab zu der Funktion <code>aov_car()</code> beachten. Die Ausgaben sind die gleichen numerischen Werte und da beschreibe ich das für dich dann nur einmal.</p>
</div>
</div>
</div>
<p>Wir haben ja in der obigen Analyse eine signifikante Interaktion zwischen den Lichtarten und der Zeit gefunden. In der folgenden Abbildung will ich einmal anhand der Effektstärke schauen, wo die Interaktion herkommt. Ich entferne dafür immer einen weiteren Zeitpunkt aus der Analyse und schaue mir dann die Effektstärke Eta<span class="math inline">\(^2\)</span> an. Du siehst sehr schön, dass die Interaktion unbedeutender wird, je weiter ich in der Zeit voranschreite. Die Interaktion liegt also eher in den frühen Zeitpunkten als in den späten Zeitpunkten vor. Das ist jetzt nicht so schlecht, da mich ja auch eher die späten Zeitpunkte interessieren. Das frühe Wachstum ist eher biologisch nicht so interessant.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-anwendung-kale-03" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-anwendung-kale-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova-mixed_files/figure-html/fig-anwendung-kale-03-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19" title="Abbildung&nbsp;33.18— Der Effektschätzer Eta^2 der Interaktion zeischen den Zeitpunkten und der Lichtstärke in Abhängigkeit der betrachteten Zeitpunkte. Insbesondere die frühen Zeitpunkte führen zu einem hohen Eta^2-Wert der Interaktion. Ohne die frühen Zeitpunkte fällt der Eta^2-Wert ab."><img src="stat-tests-anova-mixed_files/figure-html/fig-anwendung-kale-03-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-anwendung-kale-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;33.18— Der Effektschätzer Eta<span class="math inline">\(^2\)</span> der Interaktion zeischen den Zeitpunkten und der Lichtstärke in Abhängigkeit der betrachteten Zeitpunkte. Insbesondere die frühen Zeitpunkte führen zu einem hohen Eta<span class="math inline">\(^2\)</span>-Wert der Interaktion. Ohne die frühen Zeitpunkte fällt der Eta<span class="math inline">\(^2\)</span>-Wert ab.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In unserem Fall ist der Posthoc-Test ja eigentlich mit nur zwei Lichtstärken und zwei Sorten nicht unbedingt nötig. Wenn du aber natürlich die Unterschiede für die einzelnen Zeitpunkte brauchst, dann kann dir hier <code>{emmeans}</code> helfen. Wir gehen hier von Varianzhomogenität in den Zeitpunkten aus. Dafür modellieren wir dann über alle Zeitpunkte hinweg die Varianz. Irgendwas ist ja immer. Hier kann man sicherlich noch weiter optimieren und mal bei den <a href="#sec-mixed">gemischten Modellen</a> vorbeischauen, aber für die Anwendung reicht diese Auswertung auf jeden Fall aus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(height <span class="sc">~</span> light <span class="sc">*</span> variety <span class="sc">*</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>time_fct), </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> kale_time_height_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> light <span class="sc">*</span> variety <span class="sc">|</span> time_fct, <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>time_fct = t1:
 light        variety         emmean    SE df lower.CL upper.CL .group
 dark light   Oldenbor          1.93 0.441 12    0.963     2.89  a    
 bright light Oldenbor          2.67 0.441 12    1.713     3.64  a    
 dark light   Nero di Toscana   3.45 0.441 12    2.488     4.41  a    
 bright light Nero di Toscana   3.77 0.441 12    2.813     4.74  a    

time_fct = t2:
 light        variety         emmean    SE df lower.CL upper.CL .group
 dark light   Oldenbor          3.02 0.347 12    2.268     3.78  a    
 dark light   Nero di Toscana   3.92 0.347 12    3.168     4.68  ab   
 bright light Oldenbor          4.03 0.347 12    3.268     4.78  ab   
 bright light Nero di Toscana   4.85 0.347 12    4.093     5.61   b   

time_fct = t3:
 light        variety         emmean    SE df lower.CL upper.CL .group
 dark light   Oldenbor          4.67 0.425 12    3.750     5.60  a    
 dark light   Nero di Toscana   5.75 0.425 12    4.825     6.68  ab   
 bright light Oldenbor          6.39 0.425 12    5.462     7.31  ab   
 bright light Nero di Toscana   6.83 0.425 12    5.900     7.75   b   

time_fct = t4:
 light        variety         emmean    SE df lower.CL upper.CL .group
 dark light   Oldenbor          6.03 0.728 12    4.440     7.61  a    
 dark light   Nero di Toscana   7.83 0.728 12    6.240     9.41  a    
 bright light Oldenbor          8.25 0.728 12    6.665     9.84  a    
 bright light Nero di Toscana  11.65 0.728 12   10.065    13.24   b   

time_fct = t5:
 light        variety         emmean    SE df lower.CL upper.CL .group
 dark light   Oldenbor          9.50 1.930 12    5.291    13.71  a    
 dark light   Nero di Toscana  11.94 1.930 12    7.729    16.15  ab   
 bright light Oldenbor         14.50 1.930 12   10.291    18.71  ab   
 bright light Nero di Toscana  18.69 1.930 12   14.479    22.90   b   

time_fct = t6:
 light        variety         emmean    SE df lower.CL upper.CL .group
 dark light   Oldenbor         13.88 2.160 12    9.168    18.58  a    
 dark light   Nero di Toscana  17.38 2.160 12   12.668    22.08  a    
 bright light Oldenbor         22.40 2.160 12   17.693    27.11  ab   
 bright light Nero di Toscana  26.98 2.160 12   22.268    31.68   b   

time_fct = t7:
 light        variety         emmean    SE df lower.CL upper.CL .group
 dark light   Oldenbor         19.38 2.430 12   14.088    24.66  a    
 dark light   Nero di Toscana  22.98 2.430 12   17.688    28.26  ab   
 bright light Oldenbor         30.00 2.430 12   24.713    35.29   b   
 bright light Nero di Toscana  32.88 2.430 12   27.588    38.16   b   

Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 4 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="referenzen" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="referenzen">Referenzen</h2>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-friedrich2019resampling" class="csl-entry" role="listitem">
Friedrich, S., Konietschke, F., &amp; Pauly, M. (2019). <em>Resampling-based analysis of multivariate data and repeated measures designs with the R package MANOVA. RM</em>.
</div>
<div id="ref-gueorguieva2004move" class="csl-entry" role="listitem">
Gueorguieva, R., &amp; Krystal, J. H. (2004). Move over anova: progress in analyzing repeated-measures data andits reflection in papers published in the archives of general psychiatry. <em>Archives of general psychiatry</em>, <em>61</em>(3), 310–317.
</div>
<div id="ref-olejnik2003generalized" class="csl-entry" role="listitem">
Olejnik, S., &amp; Algina, J. (2003). Generalized eta and omega squared statistics: measures of effect size for some common research designs. <em>Psychological methods</em>, <em>8</em>(4), 434.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./stat-tests-ancova2.html" class="pagination-link" aria-label="Die ANCOVA">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./stat-tests-anova-manova.html" class="pagination-link" aria-label="Die MANOVA">
        <span class="nav-page-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Die MANOVA</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Quellcode</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb80" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = FALSE}</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, readxl, knitr, kableExtra, Hmisc, plyr, broom,</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="in">               patchwork, ggforce, see, sjPlot, tinytable, conflicted)</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(202434)</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::summarise)</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::summarize)</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::mutate)</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::select)</span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(magrittr::set_names)</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::filter)</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::desc)</span></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a><span class="in">source("stat-tests-anova_plot/repeated_plots.R")</span></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a><span class="fu"># Die repeated / mixed ANOVA {#sec-anova-mixed}</span></span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>*Letzte Änderung am `r format(fs::file_info("stat-tests-anova-mixed.qmd")$modification_time, '%d. %B %Y um %H:%M:%S')`*</span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"I never once failed at making a light bulb. I just found out 99 ways not to make one." --- Thomas A. Edison*</span></span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>In diesem Kapitel soll es dann um Messwiederholungen gehen. Wir haben also irgendwas wiederholt gemessen. Damit haben wir auch eine Zeitvariable mit in den Daten. Hier müssen wir dann etwas aufpassen, ob wir wirklich eine repeated oder mixed ANOVA rechnen wollen oder nicht doch irgendwie eine Zeitreihe vorliegen haben. Die Frage, die du dir stellen musst ist hierbei eigentlich recht einfach. Wenn du ein Interesse an einem wie auch immer gearteten Gruppenvergleich hast und du diese Gruppen über die Zeit gemessen hast, dann bist du hier in diesem Kapitel richtig. Wenn es um eine ANOVA geht, dann geht es auch immer um einen Gruppenvergleich. Ansonsten könntest du eine Prognose wollen und das wäre dann eher eine klassische Zeitreihe.</span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>" layout-valign="top"}</span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/angel_01_small.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-29"><a href="#cb80-29" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Hier eine kurze Warnung. Häufig wird die repeated und die mixed ANOVA in einen Topf geworfen. Die beiden Verfahren unterscheiden sich aber konzeptionell. Darüber hinaus hast du meistens in den Agrarwissenschaften eine mixed ANOVA vorliegen, wenn du mit Messwiederholungen gearbeitet hast und keine repeated ANOVA.</span></span>
<span id="cb80-30"><a href="#cb80-30" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb80-31"><a href="#cb80-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-32"><a href="#cb80-32" aria-hidden="true" tabindex="-1"></a><span class="fu">## Allgemeiner Hintergrund</span></span>
<span id="cb80-33"><a href="#cb80-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-34"><a href="#cb80-34" aria-hidden="true" tabindex="-1"></a>Die gemischte ANOVA (eng. *mixed ANOVA*) und die ANOVA für Messwiederholungen (eng. *repeated ANOVA*) sind eng miteinander verwandt. Vermutlich ist dies auch der Grund, warum es bei beiden Verfahren so viele Verwirrungen gibt. Ebenso finden sich auch verschiedene Namen zu den beiden ANOVA Algorithmen, aber wir bleiben einmal hier bei den beiden Namen. Die beiden Verfahren basieren auf Messwiederholungen. Daher messen wir wiederholt an einer Beobachtung einen Messwert. Der Unterschied liegt in dem Versuchsdesign und welche Beobachtung welche Behandlung erhält. Wir haben haben meistens in den Agrarwissenschaften eine *mixed ANOVA* vorliegen.</span>
<span id="cb80-35"><a href="#cb80-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-36"><a href="#cb80-36" aria-hidden="true" tabindex="-1"></a>Was haben die *mixed ANOVA* und die *repeated ANOVA* gemeinsam?</span>
<span id="cb80-37"><a href="#cb80-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-38"><a href="#cb80-38" aria-hidden="true" tabindex="-1"></a>:   In beiden Fällen haben wir Messwiederholungen in unseren Daten. Das heißt, wir messen wiederholt an dem gleichen Subjekt einen Messwert. Wir messen also weiderholt die Größe einer Pflanze oder die Milchleistung einer Kuh.</span>
<span id="cb80-39"><a href="#cb80-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-40"><a href="#cb80-40" aria-hidden="true" tabindex="-1"></a>Oder um den Sachstand nochmal mit einem Zitat zu untermauern, habe ich aus dem Handbuch der SPSS Statistik einmal folgende Einordnung gefunden. Hier ist nochmal wichtig, was eigentlich mit den einzelnen Beobachtungen (eng. *subject*) passiert.</span>
<span id="cb80-41"><a href="#cb80-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-42"><a href="#cb80-42" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"However, the fundamental difference is that in a mixed ANOVA, the subjects that undergo each condition (e.g., a control and treatment) are different, whereas in a two-way repeated measures ANOVA, the subjects undergo both conditions (e.g., they undergo the control and the treatment)."* --- </span><span class="co">[</span><span class="ot">Two-way repeated measures ANOVA using SPSS Statistics</span><span class="co">](https://statistics.laerd.com/spss-tutorials/two-way-repeated-measures-anova-using-spss-statistics.php#:~:text=A%20mixed%20ANOVA%20is%20very,factors%20on%20the%20dependent%20variable.)</span></span>
<span id="cb80-43"><a href="#cb80-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-44"><a href="#cb80-44" aria-hidden="true" tabindex="-1"></a>Das klingt jetzt etwas kompliziert und deshalb habe ich dir den Zusammenhang einmal in der folgenden @fig-ggplot-theo-intro visualisiert. Nehmen wir einmal an, du hast einen Behandlungsfaktor $f_A$ mit drei Leveln. Jedes Level steht für eine Art der Behandlung. Wenn wir uns jetzt eine mixed ANOVA anschauen, dann haben wir drei Individuen vorliegen, die wiederholt in der gleichen Art der Behandlung gemessen werden. Das Individium mit der $ID_1$ erhält nur die Behandlung $A.3$ wiederholt verabreicht oder steht unter dieser Behandlung. Dann messen wir wiederholt den Messwert.</span>
<span id="cb80-45"><a href="#cb80-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-46"><a href="#cb80-46" aria-hidden="true" tabindex="-1"></a>Etwas anders sieht es dann bei der repeated ANOVA aus. Hier haben wir ein Individum was alle Behandlungen über alle Zeitpunkte erhält. Damit erhät das Individium $ID_1$ erst die Behandlung $A.3$ viermal und danach dann die beiden anderen Behandlungen auch jeweils viermal wiederholt gemessen. Das ist ein großer konzeptioneller Unterschied in dem Versuchsdesign zwischen der mixed und der repeated ANOVA. In beiden ANOVA Typen wird wiederholt gemessen. In der repeated ANOVA erhält jedes Individum aber auch alle Behandlungen über die Zeit.</span>
<span id="cb80-47"><a href="#cb80-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-50"><a href="#cb80-50" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-51"><a href="#cb80-51" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb80-52"><a href="#cb80-52" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb80-53"><a href="#cb80-53" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-54"><a href="#cb80-54" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-55"><a href="#cb80-55" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-theo-intro</span></span>
<span id="cb80-56"><a href="#cb80-56" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb80-57"><a href="#cb80-57" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb80-58"><a href="#cb80-58" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb80-59"><a href="#cb80-59" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Konzeptionelle Darstellung der mixed und repeated ANOVA in einem Flussdiagramm mit unterschiedlichen Individuen für einen Behandlungsfaktor mit drei Leveln als Arten der Behandlung. **(A)** In der mixed ANOVA werden pro Art der Behandlung ein Individum wiederholt gemessen. **(B)** In der repeated ANOVA wird ein Individum wiederholt für jede Art der Behandlung gemessen. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb80-60"><a href="#cb80-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-61"><a href="#cb80-61" aria-hidden="true" tabindex="-1"></a>mixed_theo_fac2_p <span class="sc">+</span> repeated_theo_fac2_p <span class="sc">+</span></span>
<span id="cb80-62"><a href="#cb80-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-63"><a href="#cb80-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>) <span class="sc">+</span></span>
<span id="cb80-64"><a href="#cb80-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb80-65"><a href="#cb80-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb80-66"><a href="#cb80-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-67"><a href="#cb80-67" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-68"><a href="#cb80-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-69"><a href="#cb80-69" aria-hidden="true" tabindex="-1"></a>Bevor wir jetzt weiter in das Modell und die einzelnen Besonderheiten der mixed ANOVA und repeated ANOVA einsteigen nochmal der Hinweis, dass wir hier natürlich auch wieder *nur* global einen Fakor testen. Das heißt, du weißt natürlich wieder nicht, welcher paarweise Vergleich innerhalb eines Faktors einen signifikanten Unterschied ausmacht, wenn du eine signifikante ANOVA vorliegen hast. Dann musst du wieder weiter machen mit einem Post-hoc Test. Auch hier hilft nochmal die Vingette von <span class="in">`{afex}`</span> mit <span class="co">[</span><span class="ot">ANOVA and Post-Hoc Contrasts</span><span class="co">](https://cran.r-project.org/web/packages/afex/vignettes/afex_anova_example.html)</span>. Oder wie es @gueorguieva2004move mit der wissenschaftlichen Veröffentlichung <span class="co">[</span><span class="ot">Move Over ANOVA</span><span class="co">](https://jamanetwork.com/journals/psych/articlepdf/481967/ynv20002.pdf?casa_token=5gc0qQuqNFUAAAAA:SJWnX8rH6__-lxXqiF0FDGQISXgXE0JQlRgtY7EE76IFnuECNjsOvKzUIwu9hmZFrKdLJbIahfQ)</span> und der Nutzung von linearen gemischten Modellen wie folgt beschreibt.</span>
<span id="cb80-70"><a href="#cb80-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-71"><a href="#cb80-71" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Mixed-effects models use all available data, can properly account for correlation between repeated measurements on the same subject, have greater flexibility to model time effects, and can handle missing data more appropriately. Their flexibility makes them the preferred choice for the analysis of repeated measures data"* --- @gueorguieva2004move</span></span>
<span id="cb80-72"><a href="#cb80-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-73"><a href="#cb80-73" aria-hidden="true" tabindex="-1"></a>Warum machen wir das nicht immer? Also wir nutzen immer ein lineares gemischtes Modell? Das hat meistens mit der geringen Anzahl an Beobachtungen in den Gruppen und allgemein mit zu wenigen Gruppen zu tun. Häufig reicht eben das Design und die Wiederholungen nicht aus für ein sauberes gemischtes Modell. Deshab ist dann eine Lösung sich die Sachlage einmal in einer mixed oder repeated ANOVA anzuschauen. Es gilt wie immer, komplexe Fragestellungen kann man meistens nicht in einem einfachen Satz beantworten. Hier kommt es dann auch wieder auf die konkrete Fragestellung an.</span>
<span id="cb80-74"><a href="#cb80-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-75"><a href="#cb80-75" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Welche Pakete gibt es eigentlich? {.unnumbered .unlisted}</span></span>
<span id="cb80-76"><a href="#cb80-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-77"><a href="#cb80-77" aria-hidden="true" tabindex="-1"></a>Wenn um die Anwendung der mixed oder repeated ANOVA in R geht, dann haben wir eine Menge Pakete zur Auswahl. Wie immer macht die Fragestellung und das gewählte Modell den Großteil der Entscheidungsindung aus. Ich zeige dir später in der Anwendung dann auch alle Pakete einmal, gebe dir dann aber auch immer eine Empfehlung mit. Normalerweise brauchen wir einen normalverteilten Messwert $y$ und Varianzhomogenität in den Faktoren. In den letzten Jahren wurden aber noch weitere Implementierungen der ANOVA entwickelt, so dass hier auch Alternativen vorliegen.</span>
<span id="cb80-78"><a href="#cb80-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-79"><a href="#cb80-79" aria-hidden="true" tabindex="-1"></a>Gehen wir jetzt mal die Pakete durch. Wir immer gibt es einiges an Möglichkeiten und ich zeige dir hier eben die Auswahl. Es gibt hier das ein oder andere noch zu beachten, aber da gehe ich dann bei den jeweiligen Methoden drauf ein. Es macht eben dann doch einen Unterschied ob ich eine einfaktorielle oder komplexere ANOVA rechnen will. Nicht alles geht in allen R Pakten oder gar Excel.</span>
<span id="cb80-80"><a href="#cb80-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-81"><a href="#cb80-81" aria-hidden="true" tabindex="-1"></a>Der Standard mit der Funktion <span class="in">`aov()`</span> aus <span class="in">`{base}`</span></span>
<span id="cb80-82"><a href="#cb80-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-83"><a href="#cb80-83" aria-hidden="true" tabindex="-1"></a>:   Die Standardfunktion <span class="in">`aov()`</span> erlaubt es eine mixed oder repeated ANOVA direkt auf einem Datensatz zu rechnen. Hier brauchen wir nur ein Modell in der in R üblichen Formelschreibweise <span class="in">`y ~ f`</span>. Du kannst diesen Ansatz als schnelle ANOVA begreifen. Dein Messwert $y$ muss hier normalverteilt sein.</span>
<span id="cb80-84"><a href="#cb80-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-85"><a href="#cb80-85" aria-hidden="true" tabindex="-1"></a>Mit der Funktion <span class="in">`anova_test()`</span> aus <span class="in">`{rstatix}`</span></span>
<span id="cb80-86"><a href="#cb80-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-87"><a href="#cb80-87" aria-hidden="true" tabindex="-1"></a>:   Das <span class="co">[</span><span class="ot">R Paket `{rstatix}`</span><span class="co">](https://cran.r-project.org/web/packages/rstatix/index.html)</span> bietet bietet die Funktion <span class="in">`anova_test()`</span> die es erlaubt einfacher auf die Funktionalität der Funktion <span class="in">`aov()`</span> und R Funktionen aus dem Paket <span class="in">`{car}`</span> zuzugreifen. Es ist eben ein klassischer Wrapper um besser rechnen zu können. Aber auch hier musst du verstehen wie die Funktion funktioniert. Ich finde aber die Anwendung relativ einfach und deshalb zeige ich die Funktion hier einmal.</span>
<span id="cb80-88"><a href="#cb80-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-89"><a href="#cb80-89" aria-hidden="true" tabindex="-1"></a>Mit den ANOVA Funktionen aus <span class="in">`{afex}`</span></span>
<span id="cb80-90"><a href="#cb80-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-91"><a href="#cb80-91" aria-hidden="true" tabindex="-1"></a>:   Wir können die mixed oder repeated ANOVA anwenden, wenn wir Messwiederholungen vorliegen haben. Daher bietet sich hier insbesondere das <span class="co">[</span><span class="ot">R Paket `{afex}`</span><span class="co">](https://github.com/singmann/afex)</span> an. Du musst bei den Funktionen von <span class="in">`{afex}`</span> immer eine ID mitlaufen lassen, die angibt welche Individuen wiederholt gemessen wurden. Also hat jede Zeile eine Nummer, die beschreibt welche Beobachtung hier vorliegt. Besonders wichtig bei Messungen über die Zeit. Darüber hinaus kann das Paket sehr gut Interaktionen schätzen und Bedarf dort keiner zusätzlichen Optionen. Auch hier hilft nochmal die Vingette von <span class="in">`{afex}`</span> mit <span class="co">[</span><span class="ot">ANOVA and Post-Hoc Contrasts</span><span class="co">](https://cran.r-project.org/web/packages/afex/vignettes/afex_anova_example.html)</span> weiter, wenn es um den Post-hoc Test geht.</span>
<span id="cb80-92"><a href="#cb80-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-93"><a href="#cb80-93" aria-hidden="true" tabindex="-1"></a>Mit den ANOVA Funktionen aus <span class="in">`{MANOVA.RM}`</span></span>
<span id="cb80-94"><a href="#cb80-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-95"><a href="#cb80-95" aria-hidden="true" tabindex="-1"></a>:   <span class="co">[</span><span class="ot">Das R Paket `{MANOVA.RM}`</span><span class="co">](https://cran.r-project.org/web/packages/MANOVA.RM/vignettes/Introduction_to_MANOVA.RM.html)</span> von @friedrich2019resampling bietet eine weitere Möglichkeit die reapted und mixed ANOVA zu rechnen, wenn die Annahme an die Normalverteilung sowie der Varianzhomogenität nicht erfüllt ist. Wir haben es hier dann nochmal mit einer neueren Implementierung zu tun. Eine weitere robuste Alternative zu den Standardimplementierungen.</span>
<span id="cb80-96"><a href="#cb80-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-97"><a href="#cb80-97" aria-hidden="true" tabindex="-1"></a>Mit den ANOVA Funktionen aus <span class="in">`{WRS2}`</span></span>
<span id="cb80-98"><a href="#cb80-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-99"><a href="#cb80-99" aria-hidden="true" tabindex="-1"></a>:   Eine Annahme an die mixed oder repeated ANOVA ist, dass wir es mit normalverteilten Messwerten $y$ sowie Varianzhomogenität in den Faktoren $f$ vorliegen haben. Das R Paket <span class="in">`{WRS2}`</span> mit der hervorragenden Vingette <span class="co">[</span><span class="ot">Robust Statistical Methods Using WRS2</span><span class="co">](https://cran.r-project.org/web/packages/WRS2/vignettes/WRS2.pdf)</span> erlaubt nun aber diese beiden Annahmen zu umgehen und bietet eine robuste ANOVA an. Robust meint hier, dass wir uns nicht um die Normalverteilung und Varianzhomogenität kümmern müssen.</span>
<span id="cb80-100"><a href="#cb80-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-101"><a href="#cb80-101" aria-hidden="true" tabindex="-1"></a>Wir immer ist es hier ein Tutorium um gleich mit der ANOVA starten zu können. Wenn du tiefer in die Materie einsteigen möchtest und noch andere Dinge rechts und links anschauen willst, dann findest du in den folgenden Quellen nochmal mehr Anregungen. Es geht wie immer mehr, aber wir wollen hier dann ja auch fertig werden und haben beschlossen eine repeated oder mixed ANOVA zu rechnen.</span>
<span id="cb80-102"><a href="#cb80-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-103"><a href="#cb80-103" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb80-104"><a href="#cb80-104" aria-hidden="true" tabindex="-1"></a><span class="fu">## Weitere Tutorien für die repeated &amp; mixed ANOVA</span></span>
<span id="cb80-105"><a href="#cb80-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-106"><a href="#cb80-106" aria-hidden="true" tabindex="-1"></a>Wir oben schon erwähnt, kann dieses Kapitel nicht alle Themen der repeated und mixed ANOVA abarbeiten. Insbesondere der theoretische Hintergrund ist ja bei mir hier sehr gekürzt. Daher präsentiere ich hier eine Liste von Literatur und Links, die mich für dieses Kapitel hier inspiriert haben. Nicht alles habe ich genutzt, aber vielleicht ist für dich was dabei.</span>
<span id="cb80-107"><a href="#cb80-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-108"><a href="#cb80-108" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Im Tutorium zur <span class="co">[</span><span class="ot">Repeated Measures ANOVA in R</span><span class="co">](https://www.datanovia.com/en/lessons/repeated-measures-anova-in-r/)</span> und <span class="co">[</span><span class="ot">Mixed ANOVA in R</span><span class="co">](https://www.datanovia.com/en/lessons/mixed-anova-in-r/)</span> auf der Seite Datanovia wird nochmal mehr auf die möglichen Vortest der Annahmen eingegangen. Auch wird nochmal der Posthoc-Test gezeigt, den ich ja ausgelagert habe.</span>
<span id="cb80-109"><a href="#cb80-109" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Das Kapitel zu den <span class="co">[</span><span class="ot">Random Effects</span><span class="co">](https://bookdown.org/steve_midway/DAR/random-effects.html)</span> aus dem Openbook Data Analysis in R gibt nochmal einen Einblick in die Idee der zufälligen Effekte, die wir hier bewusst etwas unter den Tisch fallen lassen.</span>
<span id="cb80-110"><a href="#cb80-110" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Das Openbook ANOVA and Mixed Models A Short Introduction Using R gibt in dem Kapitel zu <span class="co">[</span><span class="ot">Random and Mixed Effects Models</span><span class="co">](https://people.math.ethz.ch/~meier/teaching/anova/random-and-mixed-effects-models.html)</span> nochmal eine Übersicht über die verschiedenen Modelle. Insbesondere der Theorieteil ist gut, da ich ja hier in diesem Kapitel aktuell auf eine theoretische Betrachtung verzichtet habe.</span>
<span id="cb80-111"><a href="#cb80-111" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Wenn dich die Formelschreibweise in R verwirrt, dann hilft dir nochmal der Blogeintrag zu <span class="co">[</span><span class="ot">ANOVA and other models, mixed and fixed</span><span class="co">](https://conjugateprior.org/2013/01/formulae-in-r-anova/)</span>.</span>
<span id="cb80-112"><a href="#cb80-112" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb80-113"><a href="#cb80-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-114"><a href="#cb80-114" aria-hidden="true" tabindex="-1"></a><span class="fu">## Genutzte R Pakete</span></span>
<span id="cb80-115"><a href="#cb80-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-116"><a href="#cb80-116" aria-hidden="true" tabindex="-1"></a>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</span>
<span id="cb80-117"><a href="#cb80-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-118"><a href="#cb80-118" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = TRUE}</span></span>
<span id="cb80-119"><a href="#cb80-119" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb80-120"><a href="#cb80-120" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb80-121"><a href="#cb80-121" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, magrittr, broom, WRS2, scales,</span></span>
<span id="cb80-122"><a href="#cb80-122" aria-hidden="true" tabindex="-1"></a><span class="in">               readxl, see, car, patchwork, rstatix, emmeans,</span></span>
<span id="cb80-123"><a href="#cb80-123" aria-hidden="true" tabindex="-1"></a><span class="in">               interactions, effectsize, afex, report, multcomp,</span></span>
<span id="cb80-124"><a href="#cb80-124" aria-hidden="true" tabindex="-1"></a><span class="in">               janitor, MANOVA.RM, ggrepel, conflicted)</span></span>
<span id="cb80-125"><a href="#cb80-125" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::mutate)</span></span>
<span id="cb80-126"><a href="#cb80-126" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::summarize)</span></span>
<span id="cb80-127"><a href="#cb80-127" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::filter)</span></span>
<span id="cb80-128"><a href="#cb80-128" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::arrange)</span></span>
<span id="cb80-129"><a href="#cb80-129" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::select)</span></span>
<span id="cb80-130"><a href="#cb80-130" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(magrittr::set_names)</span></span>
<span id="cb80-131"><a href="#cb80-131" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(magrittr::extract)</span></span>
<span id="cb80-132"><a href="#cb80-132" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(effectsize::eta_squared)</span></span>
<span id="cb80-133"><a href="#cb80-133" aria-hidden="true" tabindex="-1"></a><span class="in">cbbPalette &lt;- c("#000000", "#E69F00", "#56B4E9", "#009E73", </span></span>
<span id="cb80-134"><a href="#cb80-134" aria-hidden="true" tabindex="-1"></a><span class="in">                "#F0E442", "#0072B2", "#D55E00", "#CC79A7")</span></span>
<span id="cb80-135"><a href="#cb80-135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-136"><a href="#cb80-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-137"><a href="#cb80-137" aria-hidden="true" tabindex="-1"></a>An der Seite des Kapitels findest du den Link *Quellcode anzeigen*, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</span>
<span id="cb80-138"><a href="#cb80-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-139"><a href="#cb80-139" aria-hidden="true" tabindex="-1"></a><span class="fu">## Daten</span></span>
<span id="cb80-140"><a href="#cb80-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-141"><a href="#cb80-141" aria-hidden="true" tabindex="-1"></a>Beginnen wir wie immer mit den Daten. Hier ist die Besonderheit, dass wir immer Messweiderholungen an einer Beobachtung vorliegen haben. Ich habe dann die jeweilige Beobachtung in der Spalte <span class="in">`.id`</span> jeweils genau benannt. Daher kommt eben die Beobachtung mit der <span class="in">`id`</span> gleich 1 mehrfach in den Daten vor. Genauer, wir haben eben nicht nur eine Zeile in den Daten für eine Beobachtung sondern mehrere Zeilen für eine Beobachtung vorliegen. Das ist am Anfang immer etwas verwirrend, aber man gewöhnt sich daran.</span>
<span id="cb80-142"><a href="#cb80-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-143"><a href="#cb80-143" aria-hidden="true" tabindex="-1"></a>Eine weitere Besonderheit ist, dass wir häufig die Daten in einem Wide-Format erstellen. Das geißt wir haben pro Zeile eine ID und dann mehrere Spalten wo wir wiederholt messen. Wir nennen dann diese Spalten meistens <span class="in">`t0`</span> bis <span class="in">`t5`</span>, wenn wir sechs Zeitpunkte bemessen. In R brauchen wir dann doch wieder das Long-Format und dementsprechend nutzen wir die Funktion <span class="in">`pivot_longer()`</span> um uns aus den Daten im Wide-Format die entsprechenden Daten im Long-Format zu bauen. Das Openbook <span class="co">[</span><span class="ot">R for Data Science</span><span class="co">](https://r4ds.hadley.nz/data-tidy.html#sec-pivoting)</span> hat hier noch das passende Kapitel zum nachlesen. Du kannst auch das <span class="co">[</span><span class="ot">Cheatsheet</span><span class="co">](https://tidyr.tidyverse.org/#cheatsheet)</span> nochmal anschauen, dort wird alles nochmal visuell erklärt.</span>
<span id="cb80-144"><a href="#cb80-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-145"><a href="#cb80-145" aria-hidden="true" tabindex="-1"></a><span class="fu">### Mixed ANOVA</span></span>
<span id="cb80-146"><a href="#cb80-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-147"><a href="#cb80-147" aria-hidden="true" tabindex="-1"></a>Bei der mixed ANOVA haben wir mindestens ein zweifaktorielles Design vorliegen. Warum ist das so? Zum einen brauchen wir einen Behandlungsfaktor und dazu kommt dann noch der Faktor der Messwiederholung. Wir messen ja wiederholt und dieses wiederholte Messen kommt dann ebenfalls in einen Faktor rein. Somit haben wir einen Behandlungsfaktor und einen Zeitfaktor in den Daten. Manchmal erhöhen wir noch die Komplexität und ergänzen einen zweiten Behandlungsfaktor und haben dann einen dreifaktoriellen Datensatz vorliegen.</span>
<span id="cb80-148"><a href="#cb80-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-149"><a href="#cb80-149" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zweifaktoriell {.unnumbered .unlisted}</span></span>
<span id="cb80-150"><a href="#cb80-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-151"><a href="#cb80-151" aria-hidden="true" tabindex="-1"></a>Im Folgenden siehst du einmal einen Datensatz für eine zweifaktorielle mixed ANOVA. In diesem Beispiel schauen wir uns nur Katzenflöhe an. Wir haben in dem Datensatz einmal den Faktor <span class="in">`feeding`</span> als die Fütterungsarten mit einer Kontrolle als Zuckerwasser, Blut und einmal Ketchup sowie als zweiten Faktor die verschiedenen Zeitpunkte der Messung der Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span>. Wir haben an insgesamt sechs Zeitpunkten wiederholt die Sprungweite gemessen. Wir wollen nun wissen, in wie weit sich die Sprungweite über die Zeit für die drei Floharten ändert.</span>
<span id="cb80-152"><a href="#cb80-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-155"><a href="#cb80-155" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-156"><a href="#cb80-156" aria-hidden="true" tabindex="-1"></a>mixed_fac2_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/fleas_complex_data.xlsx"</span>, </span>
<span id="cb80-157"><a href="#cb80-157" aria-hidden="true" tabindex="-1"></a>                             <span class="at">sheet =</span> <span class="st">"mixed-fac2"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-158"><a href="#cb80-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.id, feeding, t0<span class="sc">:</span>t5) <span class="sc">|&gt;</span> </span>
<span id="cb80-159"><a href="#cb80-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> t0<span class="sc">:</span>t5,</span>
<span id="cb80-160"><a href="#cb80-160" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"jump_length"</span>,</span>
<span id="cb80-161"><a href="#cb80-161" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"time_fct"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-162"><a href="#cb80-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">feeding =</span> <span class="fu">as_factor</span>(feeding),</span>
<span id="cb80-163"><a href="#cb80-163" aria-hidden="true" tabindex="-1"></a>         <span class="at">time_fct =</span> <span class="fu">as_factor</span>(time_fct),</span>
<span id="cb80-164"><a href="#cb80-164" aria-hidden="true" tabindex="-1"></a>         <span class="at">jump_length =</span> <span class="fu">round</span>(jump_length, <span class="dv">2</span>),</span>
<span id="cb80-165"><a href="#cb80-165" aria-hidden="true" tabindex="-1"></a>         <span class="at">.id =</span> <span class="fu">as_factor</span>(.id))</span>
<span id="cb80-166"><a href="#cb80-166" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-167"><a href="#cb80-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-168"><a href="#cb80-168" aria-hidden="true" tabindex="-1"></a>In der folgenden Tabelle siehst du einmal die rohen Daten eingelesen. Wir haben den Faktor <span class="in">`feeding`</span> sowie die sechs Zeitpunkte der Messung der Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span>. Wir müssen uns dann in R die Daten über die Funktion <span class="in">`pivot_longer()`</span> in ein Long-Format umwandeln.</span>
<span id="cb80-169"><a href="#cb80-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-172"><a href="#cb80-172" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-173"><a href="#cb80-173" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb80-174"><a href="#cb80-174" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-175"><a href="#cb80-175" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-176"><a href="#cb80-176" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-mixed-table-fac2</span></span>
<span id="cb80-177"><a href="#cb80-177" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Rohdaten der Sprungweiten in [cm] gemessen an sechs Zeitpunkten von drei Fütterungsarten im Wide-Format für die bessere Übersicht."</span></span>
<span id="cb80-178"><a href="#cb80-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-179"><a href="#cb80-179" aria-hidden="true" tabindex="-1"></a>repeated_raw_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/fleas_complex_data.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"mixed-fac2"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-180"><a href="#cb80-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.id, feeding, t0<span class="sc">:</span>t5) <span class="sc">|&gt;</span> </span>
<span id="cb80-181"><a href="#cb80-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">2</span>)</span>
<span id="cb80-182"><a href="#cb80-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-183"><a href="#cb80-183" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(repeated_raw_tbl, <span class="at">n =</span> <span class="dv">4</span>),</span>
<span id="cb80-184"><a href="#cb80-184" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(repeated_raw_tbl)),</span>
<span id="cb80-185"><a href="#cb80-185" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(repeated_raw_tbl, <span class="at">n =</span> <span class="dv">4</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb80-186"><a href="#cb80-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tt</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">align =</span> <span class="st">"c"</span>, <span class="at">theme =</span> <span class="st">"striped"</span>)</span>
<span id="cb80-187"><a href="#cb80-187" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-188"><a href="#cb80-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-189"><a href="#cb80-189" aria-hidden="true" tabindex="-1"></a>Jetzt habe ich dir in der folgenden Abbildung auch nochmal das Versuchsdesign aufgezeigt. Wie du siehst, haben wir immer einen Floh, der eine Behandlung mit einer Fütterungsart erhält. Dieser Flog springt dann zum Beispiel unter der Fütterung mit Ketchup sechs Mal und wir notieren jedesmal die Sprungweite zu den Messzeitpunkten.</span>
<span id="cb80-190"><a href="#cb80-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-193"><a href="#cb80-193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-194"><a href="#cb80-194" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb80-195"><a href="#cb80-195" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb80-196"><a href="#cb80-196" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-197"><a href="#cb80-197" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-198"><a href="#cb80-198" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-theo-mixed-fac2</span></span>
<span id="cb80-199"><a href="#cb80-199" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb80-200"><a href="#cb80-200" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb80-201"><a href="#cb80-201" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb80-202"><a href="#cb80-202" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Versuchsdesign der zweifaktoriellen mixed ANOVA. Der erste Faktor ist die Fütterungsart `feeding`. Jeder Floh erhält eine Fütterung und anschließend wird sechs mal die Sprungweite gemessen. Hier sind nur vier Zeitpunkte dargestellt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb80-203"><a href="#cb80-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-204"><a href="#cb80-204" aria-hidden="true" tabindex="-1"></a>mixed_fac2_p</span>
<span id="cb80-205"><a href="#cb80-205" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-206"><a href="#cb80-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-207"><a href="#cb80-207" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbildung siehst du dann nochmal den Zusammenhang zwischen der Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span> der Katzenflöhe unter unterschiedlichen Fütterungsarten. Dabei wurden die Flöhe wiederholt an sechs Zeitpunkten gemessen. Wir du siehst, fällt mit der Zeit die Sprungleistung ab. Die Katzenflöhe springen unabhängig von der Fütterungsart weniger weit mit der Zeit. Am letzten Zeitpunkt scheinen die Flöhe unter Ketchupernährung dann wieder etwas weiter zu springen. Jetzt müssen wir aber einmal statistisch Nachweisen, ob wir hier wirklich einen signifikanten Zusammenhang und Unterschiede zwischen den Fütterungsarten vorliegen haben.</span>
<span id="cb80-208"><a href="#cb80-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-211"><a href="#cb80-211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-212"><a href="#cb80-212" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb80-213"><a href="#cb80-213" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb80-214"><a href="#cb80-214" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-215"><a href="#cb80-215" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-216"><a href="#cb80-216" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-anova-mixed-fac2</span></span>
<span id="cb80-217"><a href="#cb80-217" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb80-218"><a href="#cb80-218" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb80-219"><a href="#cb80-219" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb80-220"><a href="#cb80-220" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Darstellung des Zusammenhangs zwischen der Fütterung von Katzenflöhen und der gemessenen Sprungweite in [cm] über sechs Messzeitpunkte. Die Linie stellt den jeweiligen Mittelwert zu dem Zeitpunkt und der Fütterungsart dar. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb80-221"><a href="#cb80-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-222"><a href="#cb80-222" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mixed_fac2_tbl, <span class="fu">aes</span>(<span class="at">x =</span> time_fct, <span class="at">y =</span> jump_length, </span>
<span id="cb80-223"><a href="#cb80-223" aria-hidden="true" tabindex="-1"></a>                           <span class="at">color =</span> feeding, <span class="at">group =</span> feeding)) <span class="sc">+</span></span>
<span id="cb80-224"><a href="#cb80-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb80-225"><a href="#cb80-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point2</span>() <span class="sc">+</span></span>
<span id="cb80-226"><a href="#cb80-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-227"><a href="#cb80-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb80-228"><a href="#cb80-228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb80-229"><a href="#cb80-229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Zeitpunkte der Messung"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>,</span>
<span id="cb80-230"><a href="#cb80-230" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Fütterungsart"</span>)</span>
<span id="cb80-231"><a href="#cb80-231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-232"><a href="#cb80-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-233"><a href="#cb80-233" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Dreifaktoriell {.unnumbered .unlisted}</span></span>
<span id="cb80-234"><a href="#cb80-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-235"><a href="#cb80-235" aria-hidden="true" tabindex="-1"></a>Für unser dreifaktorielles Beispiel erweiter wir einmal den Datensatz um ein Workout für die Katzenflöhe. Neben den drei Fütterungsarten Kontrolle mit Zuckerwasser, Blut sowie Ketchup mussten die Flöhe als zweiten Faktor noch ein Workout bestehen. Dabei haben nicht alle Katzenflöhe jeweils trainiert, sondern wir haben eine untrainierte Gruppe sowie eine trainierte Gruppe. Beide Gruppen des Workout wurden dann mit allen drei Fütterungsarten gefüttert. Dann wurden insgesamt zu sechs Zeitpunkten die Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span> bestimmt. Wir haben es daher mit einem dreifaktoriellen Datensatz zu tun, da wir zwei Behandlungsfaktoren sowie den Faktor der Messwiederholungen in unseren Daten vorliegen haben.</span>
<span id="cb80-236"><a href="#cb80-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-239"><a href="#cb80-239" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-240"><a href="#cb80-240" aria-hidden="true" tabindex="-1"></a>mixed_fac3_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/fleas_complex_data.xlsx"</span>, </span>
<span id="cb80-241"><a href="#cb80-241" aria-hidden="true" tabindex="-1"></a>                             <span class="at">sheet =</span> <span class="st">"mixed-fac3"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-242"><a href="#cb80-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.id, feeding, workout, t0<span class="sc">:</span>t5) <span class="sc">|&gt;</span> </span>
<span id="cb80-243"><a href="#cb80-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> t0<span class="sc">:</span>t5,</span>
<span id="cb80-244"><a href="#cb80-244" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"jump_length"</span>,</span>
<span id="cb80-245"><a href="#cb80-245" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"time_fct"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-246"><a href="#cb80-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">feeding =</span> <span class="fu">as_factor</span>(feeding),</span>
<span id="cb80-247"><a href="#cb80-247" aria-hidden="true" tabindex="-1"></a>         <span class="at">workout =</span> <span class="fu">as_factor</span>(workout),</span>
<span id="cb80-248"><a href="#cb80-248" aria-hidden="true" tabindex="-1"></a>         <span class="at">time_fct =</span> <span class="fu">as_factor</span>(time_fct),</span>
<span id="cb80-249"><a href="#cb80-249" aria-hidden="true" tabindex="-1"></a>         <span class="at">jump_length =</span> <span class="fu">round</span>(jump_length, <span class="dv">2</span>),</span>
<span id="cb80-250"><a href="#cb80-250" aria-hidden="true" tabindex="-1"></a>         <span class="at">.id =</span> <span class="fu">as_factor</span>(.id))</span>
<span id="cb80-251"><a href="#cb80-251" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-252"><a href="#cb80-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-253"><a href="#cb80-253" aria-hidden="true" tabindex="-1"></a>In der folgenden Tabelle sind die Daten dann nochmal im Wide-Format dargestellt. Wir haben hier dann pro Floh jeweils eine Faktorkombination aus der Fütterungsart <span class="in">`feeding`</span> sowie dem Traingsstatus <span class="in">`workout`</span>. Im Anschluss haben wir dann die Sprungweite von jedem Floh sechsmal gemessen. Wir müssen dann in R die Daten nochmal in das Long-Format über die Funktion <span class="in">`pivot_longer()`</span> umbauen.</span>
<span id="cb80-254"><a href="#cb80-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-257"><a href="#cb80-257" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-258"><a href="#cb80-258" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb80-259"><a href="#cb80-259" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-260"><a href="#cb80-260" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-261"><a href="#cb80-261" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-mixed-table-fac3</span></span>
<span id="cb80-262"><a href="#cb80-262" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Rohdaten der Sprungweiten in [cm] gemessen an sechs Zeitpunkten von drei Fütterungsarten sowie dem Status des Workouts im Wide-Format für die bessere Übersicht."</span></span>
<span id="cb80-263"><a href="#cb80-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-264"><a href="#cb80-264" aria-hidden="true" tabindex="-1"></a>repeated_raw_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/fleas_complex_data.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"mixed-fac3"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-265"><a href="#cb80-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.id, feeding, workout, t0<span class="sc">:</span>t5) <span class="sc">|&gt;</span> </span>
<span id="cb80-266"><a href="#cb80-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">2</span>)</span>
<span id="cb80-267"><a href="#cb80-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-268"><a href="#cb80-268" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(repeated_raw_tbl, <span class="at">n =</span> <span class="dv">4</span>),</span>
<span id="cb80-269"><a href="#cb80-269" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(repeated_raw_tbl)),</span>
<span id="cb80-270"><a href="#cb80-270" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(repeated_raw_tbl, <span class="at">n =</span> <span class="dv">4</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb80-271"><a href="#cb80-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tt</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">align =</span> <span class="st">"c"</span>, <span class="at">theme =</span> <span class="st">"striped"</span>)</span>
<span id="cb80-272"><a href="#cb80-272" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-273"><a href="#cb80-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-274"><a href="#cb80-274" aria-hidden="true" tabindex="-1"></a>Manchmal ist es schwer die Zusammenhänge dann in dem Datensatz zu sehen, deshalb hier nochmal das Versuchsdesign visualisert. Jeder Katznfloh springt wiederholt, aber das ganz dann nur unter einer Faktorkombination.</span>
<span id="cb80-275"><a href="#cb80-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-278"><a href="#cb80-278" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-279"><a href="#cb80-279" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb80-280"><a href="#cb80-280" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb80-281"><a href="#cb80-281" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-282"><a href="#cb80-282" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-283"><a href="#cb80-283" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-theo-mixed-fac3</span></span>
<span id="cb80-284"><a href="#cb80-284" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb80-285"><a href="#cb80-285" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5.5</span></span>
<span id="cb80-286"><a href="#cb80-286" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb80-287"><a href="#cb80-287" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Versuchsdesign der dreifaktoriellen mixed ANOVA. Der erste Faktor ist die Fütterungsart `feeding`. Der zweite Faktor der Status des Workouts für jeden Floh `workout`. Jeder Floh erhält eine Fütterung sowie ein Workout und anschließend wird sechs mal die Sprungweite gemessen. Hier sind nur vier Zeitpunkte dargestellt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb80-288"><a href="#cb80-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-289"><a href="#cb80-289" aria-hidden="true" tabindex="-1"></a>mixed_fac3_p</span>
<span id="cb80-290"><a href="#cb80-290" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-291"><a href="#cb80-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-292"><a href="#cb80-292" aria-hidden="true" tabindex="-1"></a>Abschließend können wir uns dann nochmal die Daten in der folgenden Abbildung anschauen. Auf den ersten Blick sehen wir, dass die Leistung in der Sprungweite über die Zeit abfällt. Diesen Trend können wir über alle Fütterungsarten beobachten. Was erst auf den zweiten Blick auffällt ist, dass teilweise ja nach Fütterungsart ein Training positiv oder negativ ausfällt. So führt ein Training bei den Kontrollflöhen zu weiteren Sprüngen. Die Katzenflöhe unter einer Blutdiät springen jedoch unter Training nicht so weit wie ohne ein Training.</span>
<span id="cb80-293"><a href="#cb80-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-296"><a href="#cb80-296" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-297"><a href="#cb80-297" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb80-298"><a href="#cb80-298" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb80-299"><a href="#cb80-299" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-300"><a href="#cb80-300" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-301"><a href="#cb80-301" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-anova-mixed-fac3</span></span>
<span id="cb80-302"><a href="#cb80-302" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb80-303"><a href="#cb80-303" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb80-304"><a href="#cb80-304" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb80-305"><a href="#cb80-305" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Darstellung des Zusammenhangs zwischen der Fütterung von Katzenflöhen sowie der Trainingszustand und der gemessenen Sprungweite in [cm] über sechs Messzeitpunkte. Die Linie stellt den jeweiligen Mittelwert zu dem Zeitpunkt und der Fütterungsart sowie des Trainings dar. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb80-306"><a href="#cb80-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-307"><a href="#cb80-307" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mixed_fac3_tbl, <span class="fu">aes</span>(<span class="at">x =</span> time_fct, <span class="at">y =</span> jump_length, <span class="at">shape =</span> workout,</span>
<span id="cb80-308"><a href="#cb80-308" aria-hidden="true" tabindex="-1"></a>                           <span class="at">color =</span> feeding, <span class="at">linetype =</span> workout,</span>
<span id="cb80-309"><a href="#cb80-309" aria-hidden="true" tabindex="-1"></a>                           <span class="at">group =</span> <span class="fu">interaction</span>(feeding, workout))) <span class="sc">+</span></span>
<span id="cb80-310"><a href="#cb80-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb80-311"><a href="#cb80-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb80-312"><a href="#cb80-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"line"</span>,</span>
<span id="cb80-313"><a href="#cb80-313" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb80-314"><a href="#cb80-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb80-315"><a href="#cb80-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb80-316"><a href="#cb80-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Zeitpunkte der Messung"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>,</span>
<span id="cb80-317"><a href="#cb80-317" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Entwicklungsstand"</span>, <span class="at">shape =</span> <span class="st">"Workout"</span>, </span>
<span id="cb80-318"><a href="#cb80-318" aria-hidden="true" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">"Workout"</span>)</span>
<span id="cb80-319"><a href="#cb80-319" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-320"><a href="#cb80-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-321"><a href="#cb80-321" aria-hidden="true" tabindex="-1"></a><span class="fu">### Repeated ANOVA</span></span>
<span id="cb80-322"><a href="#cb80-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-323"><a href="#cb80-323" aria-hidden="true" tabindex="-1"></a>Die repeated ANOVA ist in den Agrarwissenschaften selten. In den Sozialwissenschaften oder aber allgemeiner den Humanwissenschaften kommt die repeated ANOVA häufiger vor. Das hat vor allem damit zu tun, dass wir jedes Individuum mit allen Faktorkombinationen behandeln und wiederholt messen. Das wir ein Subjekt wiederholt messen kommt auch häufiger in den Agrarwissenschaften vor, aber selten erhält jedes Tier oder Pflanze alle Behandlungen verabreicht. Deshalb hier einmal die Daten für die repated ANOVA als Veranschaulichung was du als Daten und Experiment vorliegen haben musst.</span>
<span id="cb80-324"><a href="#cb80-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-325"><a href="#cb80-325" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Einfaktoriell {.unnumbered .unlisted}</span></span>
<span id="cb80-326"><a href="#cb80-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-327"><a href="#cb80-327" aria-hidden="true" tabindex="-1"></a>Im Gegensatz zu mxied ANOVA können wir in der repeated ANOVA auch nur den einfaktoriellen Fall vorliegen haben. Da klingt jetzt erstmal etwas seltsam, aber wir haben in diesem Fall nur die Zeitpunkte als Faktor vorliegen. Wir messen also nur Katzenflöhe ohne eine Behandlung viermal. Wir schauen also, ob sich die Sprungweite von Katzenflöhen über die Zeitpunkte verändert. Wir vergleichen faktisch also nur die Zeitpunkte untereinander.</span>
<span id="cb80-328"><a href="#cb80-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-331"><a href="#cb80-331" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-332"><a href="#cb80-332" aria-hidden="true" tabindex="-1"></a>repeated_fac1_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/fleas_complex_data.xlsx"</span>, </span>
<span id="cb80-333"><a href="#cb80-333" aria-hidden="true" tabindex="-1"></a>                                <span class="at">sheet =</span> <span class="st">"repeated-fac1"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-334"><a href="#cb80-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.id, animal, t1<span class="sc">:</span>t4) <span class="sc">|&gt;</span> </span>
<span id="cb80-335"><a href="#cb80-335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> t1<span class="sc">:</span>t4,</span>
<span id="cb80-336"><a href="#cb80-336" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"jump_length"</span>,</span>
<span id="cb80-337"><a href="#cb80-337" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"time_fct"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-338"><a href="#cb80-338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal),</span>
<span id="cb80-339"><a href="#cb80-339" aria-hidden="true" tabindex="-1"></a>         <span class="at">time_fct =</span> <span class="fu">as_factor</span>(time_fct),</span>
<span id="cb80-340"><a href="#cb80-340" aria-hidden="true" tabindex="-1"></a>         <span class="at">jump_length =</span> <span class="fu">round</span>(jump_length, <span class="dv">2</span>),</span>
<span id="cb80-341"><a href="#cb80-341" aria-hidden="true" tabindex="-1"></a>         <span class="at">.id =</span> <span class="fu">as_factor</span>(.id))</span>
<span id="cb80-342"><a href="#cb80-342" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-343"><a href="#cb80-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-344"><a href="#cb80-344" aria-hidden="true" tabindex="-1"></a>Auch hier einmal die Daten im Wide-Format, damit die Daten etwas übersichtlicher sind. Wir haben nur die Katzenflöhe vorligen und schauen uns zwölf einzelne Katzenflöhe an. Jeder Floh springt dann vier Mal und wir messen dann die Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span>. Wir müssen uns dann noch das Long-Format über die Funktion <span class="in">`pivot_longer()`</span> in R bauen.</span>
<span id="cb80-345"><a href="#cb80-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-348"><a href="#cb80-348" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-349"><a href="#cb80-349" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb80-350"><a href="#cb80-350" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-351"><a href="#cb80-351" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-352"><a href="#cb80-352" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-repeated-table-fac1</span></span>
<span id="cb80-353"><a href="#cb80-353" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Rohdaten der Sprungweiten in [cm] gemessen an vier Zeitpunkten im Wide-Format für die bessere Übersicht."</span></span>
<span id="cb80-354"><a href="#cb80-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-355"><a href="#cb80-355" aria-hidden="true" tabindex="-1"></a>repeated_raw_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/fleas_complex_data.xlsx"</span>, </span>
<span id="cb80-356"><a href="#cb80-356" aria-hidden="true" tabindex="-1"></a>                               <span class="at">sheet =</span> <span class="st">"repeated-fac1"</span>) <span class="sc">|&gt;</span></span>
<span id="cb80-357"><a href="#cb80-357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.id, animal, t1<span class="sc">:</span>t4) <span class="sc">|&gt;</span> </span>
<span id="cb80-358"><a href="#cb80-358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">2</span>)</span>
<span id="cb80-359"><a href="#cb80-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-360"><a href="#cb80-360" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(repeated_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>),</span>
<span id="cb80-361"><a href="#cb80-361" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(repeated_raw_tbl)),</span>
<span id="cb80-362"><a href="#cb80-362" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(repeated_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb80-363"><a href="#cb80-363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tt</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">align =</span> <span class="st">"c"</span>, <span class="at">theme =</span> <span class="st">"striped"</span>)</span>
<span id="cb80-364"><a href="#cb80-364" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-365"><a href="#cb80-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-366"><a href="#cb80-366" aria-hidden="true" tabindex="-1"></a>So ergibt sich dann auch ein sehr simples Versuchsdesign. Wir lassen jeden Katzenfloh viermal springen und messen jeweils die Sprungweite für jeden Floh.</span>
<span id="cb80-367"><a href="#cb80-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-370"><a href="#cb80-370" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-371"><a href="#cb80-371" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb80-372"><a href="#cb80-372" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb80-373"><a href="#cb80-373" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-374"><a href="#cb80-374" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-375"><a href="#cb80-375" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-theo-repeated-fac1</span></span>
<span id="cb80-376"><a href="#cb80-376" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb80-377"><a href="#cb80-377" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 2</span></span>
<span id="cb80-378"><a href="#cb80-378" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb80-379"><a href="#cb80-379" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Versuchsdesign der einfaktoriellen repeated ANOVA. Jeder Katzenfloh springt viermal und wird dabei gemessen. Keine weiteren Faktoren liegen vor. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb80-380"><a href="#cb80-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-381"><a href="#cb80-381" aria-hidden="true" tabindex="-1"></a>repeated_fac1_p</span>
<span id="cb80-382"><a href="#cb80-382" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-383"><a href="#cb80-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-384"><a href="#cb80-384" aria-hidden="true" tabindex="-1"></a>Damit ergibt sich am Ende auch eine sehr übersichtliche Abbildung. Wir sehen einmal die einzelnen Katzenflöhe. Jede Sprungweite über die vier Zeitpunkte habe ich für die individuellen Flöhe mit einer gestrichelten Linie verbunden. Den globalen Trend kannst du in der farbigen Linie nachvollziehen. Am Anfang springen die Flöhe nicht soweit, steigern sich dann zum zweiten Messzeitpunkt um dann wieder stetig abzunehmen. Einzelne Flöhe zeigen dabei eine größere Variabilität als der globale Trend.</span>
<span id="cb80-385"><a href="#cb80-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-388"><a href="#cb80-388" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-389"><a href="#cb80-389" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb80-390"><a href="#cb80-390" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb80-391"><a href="#cb80-391" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-392"><a href="#cb80-392" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-393"><a href="#cb80-393" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-anova-repeated-fac1</span></span>
<span id="cb80-394"><a href="#cb80-394" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb80-395"><a href="#cb80-395" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb80-396"><a href="#cb80-396" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb80-397"><a href="#cb80-397" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Darstellung des Zusammenhangs zwischen der gemessenen Sprungweite in [cm] und den vier Messzeitpunkten. Die gestrichelte Linie verbindet die einzelnen individuellen Katzenflöhe. Die durchgezogene Linie stellt den Mittelwert zu dem jeweiligen Zeitpunkt dar.  *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb80-398"><a href="#cb80-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-399"><a href="#cb80-399" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(repeated_fac1_tbl, <span class="fu">aes</span>(<span class="at">x =</span> time_fct, <span class="at">y =</span> jump_length, </span>
<span id="cb80-400"><a href="#cb80-400" aria-hidden="true" tabindex="-1"></a>                             <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb80-401"><a href="#cb80-401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb80-402"><a href="#cb80-402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> .id), <span class="at">linetype =</span> <span class="dv">11</span>, <span class="at">color =</span> <span class="st">"gray70"</span>) <span class="sc">+</span></span>
<span id="cb80-403"><a href="#cb80-403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point2</span>() <span class="sc">+</span></span>
<span id="cb80-404"><a href="#cb80-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">color =</span> <span class="st">"#CC79A7"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-405"><a href="#cb80-405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Zeitpunkte der Messung"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>)</span>
<span id="cb80-406"><a href="#cb80-406" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-407"><a href="#cb80-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-408"><a href="#cb80-408" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zweifaktoriell {.unnumbered .unlisted}</span></span>
<span id="cb80-409"><a href="#cb80-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-410"><a href="#cb80-410" aria-hidden="true" tabindex="-1"></a>Eigentlich wird die Besonderheit des repeated Design einer ANOVA erst bei der zweifaktoriellen repeated ANOVA so richtig ersichtlich. Hier haben wir es nämlich zum einen mit einem Behandlungsfaktor zu tun und einer Faktor mit den jeweiligen Messzeitpunkten. Wir haben hier wieder die Katzenflöhe mit unterschiedlichen Fütterungsarten ernährt und dann an vier Zeitpunkten gemessen, wie weit die Flöhe springen. Die Besonderheit ist jetzt, dass *jeder* Katzenfloh alle Behandlungen durchläuft. Das macht einen gewaltigen Unterschied im Design und in der Auswertung.</span>
<span id="cb80-411"><a href="#cb80-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-414"><a href="#cb80-414" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-415"><a href="#cb80-415" aria-hidden="true" tabindex="-1"></a>repeated_fac2_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/fleas_complex_data.xlsx"</span>, </span>
<span id="cb80-416"><a href="#cb80-416" aria-hidden="true" tabindex="-1"></a>                                <span class="at">sheet =</span> <span class="st">"repeated-fac2"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-417"><a href="#cb80-417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.id, animal, feeding, t1<span class="sc">:</span>t4) <span class="sc">|&gt;</span> </span>
<span id="cb80-418"><a href="#cb80-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> t1<span class="sc">:</span>t4,</span>
<span id="cb80-419"><a href="#cb80-419" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"jump_length"</span>,</span>
<span id="cb80-420"><a href="#cb80-420" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"time_fct"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-421"><a href="#cb80-421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal),</span>
<span id="cb80-422"><a href="#cb80-422" aria-hidden="true" tabindex="-1"></a>         <span class="at">feeding =</span> <span class="fu">as_factor</span>(feeding),</span>
<span id="cb80-423"><a href="#cb80-423" aria-hidden="true" tabindex="-1"></a>         <span class="at">time_fct =</span> <span class="fu">as_factor</span>(time_fct),</span>
<span id="cb80-424"><a href="#cb80-424" aria-hidden="true" tabindex="-1"></a>         <span class="at">jump_length =</span> <span class="fu">round</span>(jump_length, <span class="dv">2</span>),</span>
<span id="cb80-425"><a href="#cb80-425" aria-hidden="true" tabindex="-1"></a>         <span class="at">.id =</span> <span class="fu">as_factor</span>(.id))</span>
<span id="cb80-426"><a href="#cb80-426" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-427"><a href="#cb80-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-428"><a href="#cb80-428" aria-hidden="true" tabindex="-1"></a>In der folgenden Tabelle der Rohdaten der Sprungweiten in <span class="sc">\[</span>cm<span class="sc">\]</span> unserer Katzenflöhe siehst du nochmal die Besonderheit der Messwiederholung. Wir messen die Sprungweite von jedem Floh $.id$ viermal für jede Fütterungsart. Wir müssen natürlich zwischen den Fütterungsarten Zeit lassen, damit wir wieder die Fütterungseffekte raus haben, aber ansonsten wird jeder Floh mit allen Ernährungsformen gefüttert. Hier ist dann auch die $.id$ Spalte so wichtig, da wir ja wissen müssen welche Fütterungsart zu welchem Floh gehört. Abschließend nutzen wir die Funktion <span class="in">`pivot_longer()`</span> um uns die Daten passend in R zusammenzubauen.</span>
<span id="cb80-429"><a href="#cb80-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-432"><a href="#cb80-432" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-433"><a href="#cb80-433" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb80-434"><a href="#cb80-434" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-435"><a href="#cb80-435" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-436"><a href="#cb80-436" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-repeated-table-fac2</span></span>
<span id="cb80-437"><a href="#cb80-437" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Rohdaten der Sprungweiten in [cm] nach unterschiedlichen Fütterungsarten gemessen an vier Zeitpunkten im Wide-Format für die bessere Übersicht. Hier erhält jeder Floh jede Behandlung als Fütterung einmal."</span></span>
<span id="cb80-438"><a href="#cb80-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-439"><a href="#cb80-439" aria-hidden="true" tabindex="-1"></a>repeated_raw_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/fleas_complex_data.xlsx"</span>, </span>
<span id="cb80-440"><a href="#cb80-440" aria-hidden="true" tabindex="-1"></a>                               <span class="at">sheet =</span> <span class="st">"repeated-fac2"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-441"><a href="#cb80-441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.id, animal, feeding, t1<span class="sc">:</span>t4) <span class="sc">|&gt;</span> </span>
<span id="cb80-442"><a href="#cb80-442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">2</span>)</span>
<span id="cb80-443"><a href="#cb80-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-444"><a href="#cb80-444" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(repeated_raw_tbl, <span class="at">n =</span> <span class="dv">4</span>),</span>
<span id="cb80-445"><a href="#cb80-445" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(repeated_raw_tbl)),</span>
<span id="cb80-446"><a href="#cb80-446" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(repeated_raw_tbl, <span class="at">n =</span> <span class="dv">4</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb80-447"><a href="#cb80-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tt</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">align =</span> <span class="st">"c"</span>, <span class="at">theme =</span> <span class="st">"striped"</span>)</span>
<span id="cb80-448"><a href="#cb80-448" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-449"><a href="#cb80-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-450"><a href="#cb80-450" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbildung siehst du dann das Versuchsdesign für einen Katzenfloh nochmal dargestellt. Der Floh beginnt mit der Ernährungsform <span class="in">`ketchup`</span> und springt dann viermal. Jedes Mal messen wir dann die Sprungweite. Nach einer Pause erhält der gleiche Katzenfloh dann die Ernährungsform <span class="in">`blood`</span> und springt wieder zeitversetzt viermal. Am Ende ernähren wir dann den Floh noch mit Zuckerwasser <span class="in">`ctrl`</span> und lassen ihn abschließend viermal springen. Damit springt ein einzelner Katzenfloh über den Versuch hinweg zwölfmal unter verschiedenen Versuchsbedingungen. Wie du siehst, ist dieses Design vermutlich nicht so häufig in den Agrarwissenschaften anzutreffen.</span>
<span id="cb80-451"><a href="#cb80-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-454"><a href="#cb80-454" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-455"><a href="#cb80-455" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb80-456"><a href="#cb80-456" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb80-457"><a href="#cb80-457" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-458"><a href="#cb80-458" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-459"><a href="#cb80-459" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-theo-repeated-fac2</span></span>
<span id="cb80-460"><a href="#cb80-460" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb80-461"><a href="#cb80-461" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb80-462"><a href="#cb80-462" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb80-463"><a href="#cb80-463" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Versuchsdesign der zweifaktoriellen repeated ANOVA. Jeder Katzenfloh springt viermal unter jeder Fütterungsart und wird dabei gemessen. Damit messen wir einen Floh insgesamt zwölfmal. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb80-464"><a href="#cb80-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-465"><a href="#cb80-465" aria-hidden="true" tabindex="-1"></a>repeated_fac2_p</span>
<span id="cb80-466"><a href="#cb80-466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-467"><a href="#cb80-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-468"><a href="#cb80-468" aria-hidden="true" tabindex="-1"></a>Dann schauen wir uns nochmal den Zusammenhang zwischen der Ernährungsart und den einzelnen Zeitpunkten einmal in einer Abbildung an. Die einzelnen Flöhe sind als getrichelte Linien dargestellt. Die durchgezogenen Linien stellen die globalen Mittelwerte an den jeweiligen Zeitpunkten für die Fütterungsart dar. Wir sehen, dass wir Unterschiede in den Sprungweiten über die Zeitpunkte je nach Ernährungsform vorliegen haben. Dabei haben die Kontrolle und der Ketchup ähnliche Verläufe.</span>
<span id="cb80-469"><a href="#cb80-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-472"><a href="#cb80-472" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-473"><a href="#cb80-473" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb80-474"><a href="#cb80-474" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb80-475"><a href="#cb80-475" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-476"><a href="#cb80-476" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-477"><a href="#cb80-477" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-anova-repeated-fac2</span></span>
<span id="cb80-478"><a href="#cb80-478" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb80-479"><a href="#cb80-479" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb80-480"><a href="#cb80-480" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb80-481"><a href="#cb80-481" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Darstellung des Zusammenhangs zwischen der gemessenen Sprungweite in [cm] und den vier Messzeitpunkten sowie den Fütterungsarten. Die gestrichelte Linie verbindet die einzelnen individuellen Katzenflöhe. Die durchgezogene Linie stellt den Mittelwert zu dem jeweiligen Zeitpunkt dar. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb80-482"><a href="#cb80-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-483"><a href="#cb80-483" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(repeated_fac2_tbl, <span class="fu">aes</span>(<span class="at">x =</span> time_fct, <span class="at">y =</span> jump_length, </span>
<span id="cb80-484"><a href="#cb80-484" aria-hidden="true" tabindex="-1"></a>                             <span class="at">color =</span> feeding, <span class="at">group =</span> feeding)) <span class="sc">+</span></span>
<span id="cb80-485"><a href="#cb80-485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb80-486"><a href="#cb80-486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="fu">interaction</span>(.id, feeding)), <span class="at">linetype =</span> <span class="dv">11</span>,</span>
<span id="cb80-487"><a href="#cb80-487" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb80-488"><a href="#cb80-488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point2</span>() <span class="sc">+</span></span>
<span id="cb80-489"><a href="#cb80-489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-490"><a href="#cb80-490" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb80-491"><a href="#cb80-491" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="fl">0.1</span>)) <span class="sc">+</span> </span>
<span id="cb80-492"><a href="#cb80-492" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb80-493"><a href="#cb80-493" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Zeitpunkte der Messung"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>,</span>
<span id="cb80-494"><a href="#cb80-494" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Fütterungsart"</span>)</span>
<span id="cb80-495"><a href="#cb80-495" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-496"><a href="#cb80-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-497"><a href="#cb80-497" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Dreifaktoriell {.unnumbered .unlisted}</span></span>
<span id="cb80-498"><a href="#cb80-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-499"><a href="#cb80-499" aria-hidden="true" tabindex="-1"></a>Jetzt wird es richtig wild. Wir schauen uns jetzt nämlich nicht nur einen Behandlungsfaktor an, sondern haben zwei Behandlungen sowie die Messwiederholungen als Faktor über die Zeit. Wir schauen hier einmal auf die Fütterungsart mit der Kontrolle als Zuckerwasser, der Gabe von Blut sowie der Fütterung mit Ketchup. Dazu kommt dann noch eine Workoutsession oder eben keine Workoutsession. Wir haben damit zwei Behandlungsfaktoren vorliegen. Da wir ja nun jeden Floh wiederholt messen unter jeder Faktorkombination, kommt hier einiges an Sprungweitenmessung auf jeden einzelnen Floh zu. Daher sind repeated ANOVAs selten. Wir müssen ja nicht nur jeden Floh wiederholt für die Fütterungen durchmessen sondern eben auch nochnmal alles wiederholt für die beiden Workoutgruppen.</span>
<span id="cb80-500"><a href="#cb80-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-503"><a href="#cb80-503" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-504"><a href="#cb80-504" aria-hidden="true" tabindex="-1"></a>repeated_fac3_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/fleas_complex_data.xlsx"</span>, </span>
<span id="cb80-505"><a href="#cb80-505" aria-hidden="true" tabindex="-1"></a>                                <span class="at">sheet =</span> <span class="st">"repeated-fac3"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-506"><a href="#cb80-506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.id, animal, feeding, workout, t1<span class="sc">:</span>t4) <span class="sc">|&gt;</span> </span>
<span id="cb80-507"><a href="#cb80-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> t1<span class="sc">:</span>t4,</span>
<span id="cb80-508"><a href="#cb80-508" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"jump_length"</span>,</span>
<span id="cb80-509"><a href="#cb80-509" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"time_fct"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-510"><a href="#cb80-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal),</span>
<span id="cb80-511"><a href="#cb80-511" aria-hidden="true" tabindex="-1"></a>         <span class="at">feeding =</span> <span class="fu">as_factor</span>(feeding),</span>
<span id="cb80-512"><a href="#cb80-512" aria-hidden="true" tabindex="-1"></a>         <span class="at">workout =</span> <span class="fu">as_factor</span>(workout),</span>
<span id="cb80-513"><a href="#cb80-513" aria-hidden="true" tabindex="-1"></a>         <span class="at">time_fct =</span> <span class="fu">as_factor</span>(time_fct),</span>
<span id="cb80-514"><a href="#cb80-514" aria-hidden="true" tabindex="-1"></a>         <span class="at">jump_length =</span> <span class="fu">round</span>(jump_length, <span class="dv">2</span>),</span>
<span id="cb80-515"><a href="#cb80-515" aria-hidden="true" tabindex="-1"></a>         <span class="at">.id =</span> <span class="fu">as_factor</span>(.id))</span>
<span id="cb80-516"><a href="#cb80-516" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-517"><a href="#cb80-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-518"><a href="#cb80-518" aria-hidden="true" tabindex="-1"></a>In der folgenden Tabelle siehst du einmal die Daten im Wide-Format. In den ersten beiden Zeilen siehst du auch schon die Besonderheit. Wir Füttern eben einmal mit Bkut und messen dann viermal die Sprungweite für die beiden Gruppen des Workout. Daher messen wir dann jeden Floh insgesamt vierundzwanzigmal mit den jeweiligen Pausen zwischen den Behandlungskombinationen. Da kommen schon eine Menge Sprünge zusammen.</span>
<span id="cb80-519"><a href="#cb80-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-522"><a href="#cb80-522" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-523"><a href="#cb80-523" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb80-524"><a href="#cb80-524" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-525"><a href="#cb80-525" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-526"><a href="#cb80-526" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-repeated-table-fac3</span></span>
<span id="cb80-527"><a href="#cb80-527" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Rohdaten der Sprungweiten in [cm] nach unterschiedlichen Fütterungsarten und Workoutstatus gemessen an vier Zeitpunkten im Wide-Format für die bessere Übersicht. Hier erhält jeder Floh jede Behandlungskombination aus Fütterung und Workout einmal."</span></span>
<span id="cb80-528"><a href="#cb80-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-529"><a href="#cb80-529" aria-hidden="true" tabindex="-1"></a>repeated_raw_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/fleas_complex_data.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"repeated-fac3"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-530"><a href="#cb80-530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.id, animal, feeding, workout, t1<span class="sc">:</span>t4) <span class="sc">|&gt;</span> </span>
<span id="cb80-531"><a href="#cb80-531" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">2</span>)</span>
<span id="cb80-532"><a href="#cb80-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-533"><a href="#cb80-533" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(repeated_raw_tbl, <span class="at">n =</span> <span class="dv">4</span>),</span>
<span id="cb80-534"><a href="#cb80-534" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(repeated_raw_tbl)),</span>
<span id="cb80-535"><a href="#cb80-535" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(repeated_raw_tbl, <span class="at">n =</span> <span class="dv">4</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb80-536"><a href="#cb80-536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tt</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">align =</span> <span class="st">"c"</span>, <span class="at">theme =</span> <span class="st">"striped"</span>)</span>
<span id="cb80-537"><a href="#cb80-537" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-538"><a href="#cb80-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-539"><a href="#cb80-539" aria-hidden="true" tabindex="-1"></a>Eigentlich sieht man das Versuchsdesign erst so richtig in der folgenden Abbildung. Hier siehst du einmal wie ein einzelner Floh alle 24 Sprünge nacheinander unter der jeweiligen Faktorkombination durchführt. In einem idealen Setting folgt natürlich jeder Floh eine zufällige Reihenfolge der Faktorkombinationen. Bitte beachte, dass zwischen den einzelnen Behandlungskombinationen nach dem vierten Sprung natürlich auch eine Zeit vergehen muss, damit sich die Behandlung wieder ausgeschlichen hat.</span>
<span id="cb80-540"><a href="#cb80-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-543"><a href="#cb80-543" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-544"><a href="#cb80-544" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb80-545"><a href="#cb80-545" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb80-546"><a href="#cb80-546" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-547"><a href="#cb80-547" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-548"><a href="#cb80-548" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-theo-repeated-fac3</span></span>
<span id="cb80-549"><a href="#cb80-549" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb80-550"><a href="#cb80-550" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5.5</span></span>
<span id="cb80-551"><a href="#cb80-551" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb80-552"><a href="#cb80-552" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Versuchsdesign der dreifaktoriellen repeated ANOVA. Jeder Katzenfloh springt viermal unter jeder Kombination von Fütterungsart sowie Workoutstatus und wird dabei gemessen. Damit messen wir einen Floh insgesamt vierundzwanzigmal. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb80-553"><a href="#cb80-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-554"><a href="#cb80-554" aria-hidden="true" tabindex="-1"></a>repeated_fac3_p</span>
<span id="cb80-555"><a href="#cb80-555" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-556"><a href="#cb80-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-557"><a href="#cb80-557" aria-hidden="true" tabindex="-1"></a>Am Ende schauen wir uns auch die Daten einmal in einer Abbildung an. Hier haben wir dann die beiden Workoutgruppen sowie die drei Fütterungsarten in einer Abbildung vereint. Wir sehen, dass die nicht trainierten Flöhe im allgemeinen nicht so weit springen wir die trainierten Flöhe. Ebenso wirkt, dass die Ernährung mit Blut auf jeden Fall die bessere Sprungleistung bewirkt. Teilweise sehen wir, dass sich die Linien der Mittelwerte überschneiden, so dass wir hier eventuell von einer Interaktion ausgehen müssen. Das schauen wir uns dann aber in den entsprechenden statistischen Tests einmal näher an.</span>
<span id="cb80-558"><a href="#cb80-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-561"><a href="#cb80-561" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-562"><a href="#cb80-562" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb80-563"><a href="#cb80-563" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb80-564"><a href="#cb80-564" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-565"><a href="#cb80-565" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-566"><a href="#cb80-566" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-anova-repeated-fac3</span></span>
<span id="cb80-567"><a href="#cb80-567" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb80-568"><a href="#cb80-568" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb80-569"><a href="#cb80-569" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb80-570"><a href="#cb80-570" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Darstellung des Zusammenhangs zwischen der gemessenen Sprungweite in [cm] und den vier Messzeitpunkten sowie den Fütterungsarten und Workoutstatus. Die Linienarten stellen den Workoutstatus dar. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb80-571"><a href="#cb80-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-572"><a href="#cb80-572" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(repeated_fac3_tbl, <span class="fu">aes</span>(<span class="at">x =</span> time_fct, <span class="at">y =</span> jump_length, <span class="at">shape =</span> workout,</span>
<span id="cb80-573"><a href="#cb80-573" aria-hidden="true" tabindex="-1"></a>                             <span class="at">color =</span> feeding, <span class="at">linetype =</span> workout,</span>
<span id="cb80-574"><a href="#cb80-574" aria-hidden="true" tabindex="-1"></a>                             <span class="at">group =</span> <span class="fu">interaction</span>(feeding, workout))) <span class="sc">+</span></span>
<span id="cb80-575"><a href="#cb80-575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb80-576"><a href="#cb80-576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb80-577"><a href="#cb80-577" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"line"</span>,</span>
<span id="cb80-578"><a href="#cb80-578" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb80-579"><a href="#cb80-579" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb80-580"><a href="#cb80-580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb80-581"><a href="#cb80-581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Zeitpunkte der Messung"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>,</span>
<span id="cb80-582"><a href="#cb80-582" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Fütterungsart"</span>, <span class="at">shape =</span> <span class="st">"Workout"</span>, <span class="at">linetype =</span> <span class="st">"Workout"</span>)</span>
<span id="cb80-583"><a href="#cb80-583" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-584"><a href="#cb80-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-585"><a href="#cb80-585" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mixed ANOVA</span></span>
<span id="cb80-586"><a href="#cb80-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-587"><a href="#cb80-587" aria-hidden="true" tabindex="-1"></a>Beginnen wir mit der Auswertung unserer beispieldaten mit der mixed ANOVA. Wir kriegen hier natürlich nur eine globale Aussage über den Faktor der Behandlung oder der Zeit. Wenn dich die paarweisen Vergleiche interessieren, dann müsst du noch einen Posthoc-Test anschließen. Mehr Informationen zu der Modellierung findest du auch in dem <span class="co">[</span><span class="ot">Kapitel zu gemischten Modellen</span><span class="co">](#sec-mixed)</span>. Dort erfährst du dann auch, wie du dir den Posthoc-Test bauen kannst. Hier bleiben wir dann bei der ANOVA und den entsprechenden Ergebnissen.</span>
<span id="cb80-588"><a href="#cb80-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-589"><a href="#cb80-589" aria-hidden="true" tabindex="-1"></a><span class="fu">### Zweifaktoriell</span></span>
<span id="cb80-590"><a href="#cb80-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-591"><a href="#cb80-591" aria-hidden="true" tabindex="-1"></a>Als erstes schauen wir uns die Auswertung der zweifaktoriellen mixed ANOVA an. Nochmal zur Erinnerung, wir haben einen Behandlungsfaktor mit den drei Arten der Fütterung, Kontrolle, Blut und Ketchup, vorliegen. Darüber hinaus messen wir die Sprungweite an sechs Zeitpunkten widerholt für jeden Katzenfloh. Wir wollen jetzt wissen, ob die Fütterung einen Einfluss auf die Sprungweiten der Katzenflöhe über die Zeit hat. Dabei sind wir eigentlich nicht so sehr an den Zeitpunkten wie an der Behandlung der Fütterung interessiert. In einem zweifaktoriellen Versuch können wir uns dann auch immer die Interaktion mit anschauen um zu sehen, die Behandlung unabhängig von den Zeitpunkten ist.</span>
<span id="cb80-592"><a href="#cb80-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-593"><a href="#cb80-593" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb80-594"><a href="#cb80-594" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{base}`</span></span>
<span id="cb80-595"><a href="#cb80-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-596"><a href="#cb80-596" aria-hidden="true" tabindex="-1"></a>Die Standardimplementierung ist eigentlich recht einfahc durchzuführen. Wir haben wie immer erst unseren Messwert $y$ und dann die Formelschreibweise für unser beiden Faktoren und deren Interaktion. Ich mache mir es hier etwas einfacher und schreibe dann noch die Faktoren mit dem <span class="in">`*`</span> um etwas Platz zu sparen. Die Besonderheit hier ist jetzt, dass wir noch spezifizieren müssen welche Variable in unseren Daten die wiederholt gemessenen Individuen darstellt und über welchen Faktor diese Individuen dann wiederholt gemessen wurden. In unserem Fall stehen die Individuen in der Spalte <span class="in">`.id`</span> und wir haben über die Spalte <span class="in">`time_fct`</span> wiederholt die einzelnen Flöhe gemessen. Dann müssen wir das ganze noch in die Funktion <span class="in">`Error()`</span> schreiben, damit die ANOVA auch erkennt, dass wir hier den Teil mit den Messwiederholungen darstellen.</span>
<span id="cb80-597"><a href="#cb80-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-600"><a href="#cb80-600" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-601"><a href="#cb80-601" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>time_fct), </span>
<span id="cb80-602"><a href="#cb80-602" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> mixed_fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb80-603"><a href="#cb80-603" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb80-604"><a href="#cb80-604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span> </span>
<span id="cb80-605"><a href="#cb80-605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, df, statistic, p.value) <span class="sc">|&gt;</span> </span>
<span id="cb80-606"><a href="#cb80-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value))</span>
<span id="cb80-607"><a href="#cb80-607" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-608"><a href="#cb80-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-609"><a href="#cb80-609" aria-hidden="true" tabindex="-1"></a>Ich filtere hier einiges weg, da wir hier viele Informationen erhalten, die wir meistens nicht brauchen. Wir sehen, dass einen signifikanten Einfluss der Fütterung auf die Sprungweite haben, da der p-Wert kleiner ist als das Signifikanzniveau $\alpha$ gleich 5%. Dies ist auch der Fall für die Zeitpunkte und die Interaktion. Da wir hier eine signifikante Interaktion vorliegen haben, können wir die Fütterungsarten nicht unabhängig über die Zeit interpretieren. Es gibt damit Zeitpunkte an denen die Fütterungen unterschiedliche Effekte zeigen.</span>
<span id="cb80-610"><a href="#cb80-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-611"><a href="#cb80-611" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{rstatix}`</span></span>
<span id="cb80-612"><a href="#cb80-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-613"><a href="#cb80-613" aria-hidden="true" tabindex="-1"></a>Das R Paket <span class="in">`{rstatix}`</span> liefert mit der Funktion <span class="in">`anova_test()`</span> auch eine Möglichkeit eine mixed ANOVA zu rechnen. Hier ist es dann mit den Optionen etwas anders. Ich mag ja die Formelschreibweise sehr gerne, da weiß ich dann wo was steht. Auf der anderen Seite mag es aber auch einfacher sein, wenn man einfach die Variablen in den Daten einer Option in der Funktion zuordnet. Hier haben wir den Fall, dass wir sagen müssen, was ist unser Messwert? Der Messwert kommt in die Option <span class="in">`dv`</span>. Dann brauchen wir die individuellen IDs in der Option <span class="in">`wid`</span>. Die Faktoren, die wir untereinander vergleichen wollen, kommen dann in die Option <span class="in">`between`</span>. In unserem Fall sind das die Fütterungsarten. Wir wollen wissen ob es zwischen den Fütterungsarten einen Unterschied gibt. Die Zeit als Messwiederholung kommt dann in die Option <span class="in">`within`</span>. Wir messen ja die Zeitpunkte innerhalb (eng. *within*) der Individuen.</span>
<span id="cb80-614"><a href="#cb80-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-617"><a href="#cb80-617" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-618"><a href="#cb80-618" aria-hidden="true" tabindex="-1"></a>rstatix_aov <span class="ot">&lt;-</span> <span class="fu">anova_test</span>(<span class="at">data =</span> mixed_fac2_tbl, </span>
<span id="cb80-619"><a href="#cb80-619" aria-hidden="true" tabindex="-1"></a>                          <span class="at">dv =</span> jump_length, <span class="at">wid =</span> .id, </span>
<span id="cb80-620"><a href="#cb80-620" aria-hidden="true" tabindex="-1"></a>                          <span class="at">between =</span> feeding, <span class="at">within =</span> time_fct)</span>
<span id="cb80-621"><a href="#cb80-621" aria-hidden="true" tabindex="-1"></a><span class="fu">get_anova_table</span>(rstatix_aov)</span>
<span id="cb80-622"><a href="#cb80-622" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-623"><a href="#cb80-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-624"><a href="#cb80-624" aria-hidden="true" tabindex="-1"></a>Numerisch sind die Werte die gleichen Werte, die wir auch in der <span class="in">`aov()`</span> Funktion erhalten. Im Hintergrund wird auch eine <span class="in">`aov()`</span> gerechnet, nur die Übergabe der Variablen ist hier anders. Neben der Signifikanz kriegen wir in der Spalte <span class="in">`ges`</span> auch noch ein Eta$^2$ Wert wiedergegeben, den wir klassisch interpretieren können. Da wir es in einer mixed ANOVA mit einem etwas anderen Eta$^2$ Wert zu tun haben, können wir hier erstmal sagen, dass je gößer der Wert desto stärker der Effekt. Die p-Werte sind auch hier für alle Vergleiche hoch signifikant.</span>
<span id="cb80-625"><a href="#cb80-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-626"><a href="#cb80-626" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{afex}`</span></span>
<span id="cb80-627"><a href="#cb80-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-628"><a href="#cb80-628" aria-hidden="true" tabindex="-1"></a>Das R Paket <span class="in">`{afex}`</span> elraubt im besonderen die Modellierung von Messwiederholungen von Beobachtungen. Faktisch ist das Paket um diese Art der Analyse gebaut. Dementsprechend gibt es auch zwei Arten des Funktionsaufrufs. Wir konzentrieren uns hier aus Gründen der konsistents zu <span class="in">`aov()`</span> auf die Funktion <span class="in">`aov_car()`</span>. Am Ende kommen hier die gleichen Werte raus wie schon bei den anderen Tabs. Wir haben hier aber die Möglichkeit etwas mehr zu machen. Alles Weitere dann in der <span class="co">[</span><span class="ot">Vingette zu `{afex}` und dem Posthoc-Test</span><span class="co">](https://cran.r-project.org/web/packages/afex/vignettes/afex_anova_example.html)</span>. Wenn du viel mit Messwiederholungen arbeitest, dann ist eine Einarbeitung in <span class="in">`{afex}`</span> sicherlich sinnvoll. Leider bist du bei <span class="in">`{afex}`</span> an die Normalverteilung und die Varianzhomogenität gebunden. MAn kann eben nicht alles haben.</span>
<span id="cb80-629"><a href="#cb80-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-632"><a href="#cb80-632" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-633"><a href="#cb80-633" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-634"><a href="#cb80-634" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-635"><a href="#cb80-635" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>time_fct), </span>
<span id="cb80-636"><a href="#cb80-636" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> mixed_fac2_tbl)</span>
<span id="cb80-637"><a href="#cb80-637" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-638"><a href="#cb80-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-639"><a href="#cb80-639" aria-hidden="true" tabindex="-1"></a>Auch hier erhalten wir die gleichen numwerischen Werte wie schon in den vorherigen Tabs zu <span class="in">`{base}`</span> und <span class="in">`{rstatix}`</span>. Die Signifikanz ist für alle Faktoren sowie der Interaktion gegeben. Wir erhalten auch hier in der Spalte <span class="in">`ges`</span> dann das Eta$^2$ als Effektschätzer zurück. Am Ende finde ich die Ausgabe etwas sperrig.</span>
<span id="cb80-640"><a href="#cb80-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-641"><a href="#cb80-641" aria-hidden="true" tabindex="-1"></a>Das R Paket <span class="in">`{afex}`</span> erlaubt es auch die Modelle nach der Schreibweise der linearen gemischten Modelle zu definieren. Das ist für mich eigentlich etwas angenehmer, da man sich dann in einer Formelwelt aufhält mehr dazu dann im <span class="co">[</span><span class="ot">Kapitel zu gemischten Modellen</span><span class="co">](#sec-mixed)</span>. Also die Ergebnisse sind die Gleichen. Ich brauche es nur als Referenz für mich zum nachschlagen.</span>
<span id="cb80-642"><a href="#cb80-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-645"><a href="#cb80-645" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-646"><a href="#cb80-646" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-647"><a href="#cb80-647" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-648"><a href="#cb80-648" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb80-649"><a href="#cb80-649" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_4</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> time_fct <span class="sc">+</span> (time_fct<span class="sc">|</span>.id), </span>
<span id="cb80-650"><a href="#cb80-650" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> mixed_fac2_tbl)</span>
<span id="cb80-651"><a href="#cb80-651" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-652"><a href="#cb80-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-653"><a href="#cb80-653" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{MANOVA.RM}`</span></span>
<span id="cb80-654"><a href="#cb80-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-655"><a href="#cb80-655" aria-hidden="true" tabindex="-1"></a>Mit dem R Paket <span class="in">`{MANOVA.RM}`</span> haben wir auch die Möglichkeit eine mixed ANOVA zu rechnen in dem wir die Funktion <span class="in">`RM()`</span> nutzen. Das ist natürlich etwas verwirrend vom Namen, aber wenn wir die Optionen richtig mit den Variablen belegen, dann rechnen wir auch eine mixed ANOVA. Hier müssen wir dann angeben in welche Spalte die Beobachtungen sind und was der <span class="in">`within`</span> Faktor ist. Bei uns ist das dann einfach. Wir nutzen die Variable <span class="in">`.id`</span> sowie als Faktor der Messwiederholungen <span class="in">`time_fct`</span>. Der Rest ist eigentlich nicht so wichtig. Wenn du die Funktion in deiner Analyse rechnest, dann würde ich die Option <span class="in">`iter`</span> auf 1000 setzen.</span>
<span id="cb80-656"><a href="#cb80-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-657"><a href="#cb80-657" aria-hidden="true" tabindex="-1"></a>Am Ende muss sich aber dann doch fragen, ob es eine noch hässlichere Ausgabe einer Funktion gibt. Ich glaube eher nicht, aber das soll die Leistung des Algorithmus nicht schmälern. Wir kämpfen uns da doch mal durch. Manche Informationen sind dann einfach auch wieder über, da wir je eigentlich nur wissen wollen, ob wir einen signifikanten Einfluss der Behandlung <span class="in">`feeding`</span> vorliegen haben.</span>
<span id="cb80-658"><a href="#cb80-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-661"><a href="#cb80-661" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-662"><a href="#cb80-662" aria-hidden="true" tabindex="-1"></a><span class="fu">RM</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> time_fct, <span class="at">data =</span> mixed_fac2_tbl, </span>
<span id="cb80-663"><a href="#cb80-663" aria-hidden="true" tabindex="-1"></a>   <span class="at">subject =</span> <span class="st">".id"</span>, <span class="at">within =</span> <span class="fu">c</span>(<span class="st">"time_fct"</span>), <span class="at">iter =</span> <span class="dv">100</span>, </span>
<span id="cb80-664"><a href="#cb80-664" aria-hidden="true" tabindex="-1"></a>   <span class="at">resampling =</span> <span class="st">"Perm"</span>, <span class="at">seed =</span> <span class="dv">1234</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-665"><a href="#cb80-665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb80-666"><a href="#cb80-666" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-667"><a href="#cb80-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-668"><a href="#cb80-668" aria-hidden="true" tabindex="-1"></a>Als erstes erhalten wir eine lange Tabelle mit der deskriptiven Statistik der Mittelwerte für jede Faktorkombination der Fütterungsart sowie dem Zeitpunkt. Dazu dann noch die passenden 95% Konfidenzintervalle. Dann kommen drei Tests nacheinander. Das ist auch immer das Problem, wenn du dann drei Ausgaben hast und nicht weißt, welche du nehmen sollst. Ich würde hier die Ergebnisse der <span class="in">`ANOVA-Type Statistic (ATS)`</span> nehmen und den Rest liegen lassen. Die p-Werte aus dem Permutationstest <span class="in">`p-values resampling`</span> haben zwar auch ihre Berechtigung bei nicht normalverteilten oder varianzheterogenen Daten aber ich würde dann hier auch eher das R Paket <span class="in">`{WRS2}`</span> vorziehen.</span>
<span id="cb80-669"><a href="#cb80-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-670"><a href="#cb80-670" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{WRS2}`</span></span>
<span id="cb80-671"><a href="#cb80-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-672"><a href="#cb80-672" aria-hidden="true" tabindex="-1"></a>Kommen wir nun zum letzten Paket, was ich hier noch für die zweifaktorielle mixed ANOVA zeigen möchte. Es handelt sich um <span class="in">`{WRS2}`</span>, welches dann auch erlaubt die zweifaktorielle mixed ANOVA zu rechnen, wenn wir die Annahme der Normalverteilung an den Messwert oder keine Varianzhomogenität in den Gruppen vorliegen haben. Es geht dann auch beides. Das ist dann auch der große Vorteil von <span class="in">`{WRS2}`</span>. Das Modell sieht genauso aus wie auch bei den anderen Anwendungen. Wir müssen hier nur einmal in der Option <span class="in">`id`</span> angeben, welche Spalte unsere ID ist.</span>
<span id="cb80-673"><a href="#cb80-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-676"><a href="#cb80-676" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-677"><a href="#cb80-677" aria-hidden="true" tabindex="-1"></a><span class="fu">bwtrim</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> time_fct, <span class="at">id =</span> .id, <span class="at">data =</span> mixed_fac2_tbl)</span>
<span id="cb80-678"><a href="#cb80-678" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-679"><a href="#cb80-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-680"><a href="#cb80-680" aria-hidden="true" tabindex="-1"></a>Die Ergebnisse sind dann vom p-Wert inhaltlich gleich wie bei den anderen Anwendungen. Das habe ich hier auch erwartet, denn unsere Sprungweiten habe ich so gebaut, dass die Sprungweiten normalverteilt sind. Nicht immer können wir aber in unseren Daten davon ausgehen, dass wir normalverteilte Messwerte vorliegen haben. Da ist diese Alternative hier sehr gut.</span>
<span id="cb80-681"><a href="#cb80-681" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb80-682"><a href="#cb80-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-683"><a href="#cb80-683" aria-hidden="true" tabindex="-1"></a>Wir haben ja in den obigen Anwendungen der mixed ANOVA immer eine signifikante Interaktion gefunden. Daher wollen wir uns einmal in einem Liniendiagramm der Mittelwerte die Sachlage näher anschauen. Wenn wir eine Interaktion erwarten, dann sollten sich die Linien der Mittelwerte kreuzen. Wir haben ja auch in allen Analysen eine signifkante Interaktion voriegen. Wenn wir jetzt auf die Abbildung schauen, dann sehen wir auch, dass sich die Lienien für die Fütterung mit Blut und der Kontrolle kreuzen. Wir haben hier eine Interaktion vorliegen. Auch sind die Unterschiede zwischend den Fütterungen nicht immer parallel zueinander mit dem gleichen Effekt oder eben Abstand.</span>
<span id="cb80-684"><a href="#cb80-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-687"><a href="#cb80-687" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-688"><a href="#cb80-688" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-689"><a href="#cb80-689" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb80-690"><a href="#cb80-690" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-691"><a href="#cb80-691" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-interactionplot-mixed-2fac</span></span>
<span id="cb80-692"><a href="#cb80-692" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb80-693"><a href="#cb80-693" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb80-694"><a href="#cb80-694" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb80-695"><a href="#cb80-695" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Liniendigramm mit den Mittelwerten aller Faktorkombinationen der beiden Faktoren `feeding` und `time_fct`. Die Linien kreuzen sich leicht, es liegt eine Interaktion vor. Eine allgemeine Aussage über die Sprungweite und der Fütterung lässt sich nicht unabhängig vom Zeitpunkt treffen. Die Interaktion ist aber nicht sehr stark."</span></span>
<span id="cb80-696"><a href="#cb80-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-697"><a href="#cb80-697" aria-hidden="true" tabindex="-1"></a>mixed_fac2_tbl <span class="sc">|&gt;</span> </span>
<span id="cb80-698"><a href="#cb80-698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time_fct, <span class="at">y =</span> jump_length,</span>
<span id="cb80-699"><a href="#cb80-699" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> feeding, <span class="at">group =</span> feeding)) <span class="sc">+</span></span>
<span id="cb80-700"><a href="#cb80-700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb80-701"><a href="#cb80-701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb80-702"><a href="#cb80-702" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb80-703"><a href="#cb80-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb80-704"><a href="#cb80-704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span>
<span id="cb80-705"><a href="#cb80-705" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-706"><a href="#cb80-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-707"><a href="#cb80-707" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dreifaktoriell</span></span>
<span id="cb80-708"><a href="#cb80-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-709"><a href="#cb80-709" aria-hidden="true" tabindex="-1"></a>Jetzt betrachten wir noch die dreifaktorielle mixed ANOVA. Dieses Design kommt dann vor, wenn du zwei Behandlungsfaktoren sowie einen Zeitfaktor in deinen Daten vorliegen hast. In unserem Fall ist der erste Faktor die Fütterungsart mit den Gruppen Kontrolle, Blut und Ketchup sowie als zweiten Faktor der Status des Workouts des einzlenen Flohs. Wir schauen hier nur Katzenflöhe an. Dann messen wir die Sprungweite jedes einzelnen Flohs nochmal zu sechs Zeitpunkten. Hier ist es wieder wichtig darauf zu achten, was mit einem einzelnen Floh passiert und gemessen wird. Wir messen hier jede Faktorkombination und Wiederholung mit einem neuen Floh. Schaue dir dazu nochmal die Übersicht des Designs in dem Abschnitt zu den Daten in der @fig-ggplot-theo-mixed-fac3 an. Auch hier ist es dann manchmal von Vorteil zu wissen, wechler Faktor einem eigentlich am meisten interessiert. Wir betrachten hier jetzt alle drei Faktoren und deren Interaktionen als gleichwertig. Wir können die dreifaktorielle mixed ANOVA nicht mehr in dem R Paket <span class="in">`{WRS2}`</span> rechnen. Das Paket biette keine Funktion dafür an.</span>
<span id="cb80-710"><a href="#cb80-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-711"><a href="#cb80-711" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb80-712"><a href="#cb80-712" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{base}`</span></span>
<span id="cb80-713"><a href="#cb80-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-714"><a href="#cb80-714" aria-hidden="true" tabindex="-1"></a>Beginnen wir wieder mit der Standardfunktion in <span class="in">`{base}`</span> mit <span class="in">`aov()`</span> und deren Anwendung. Hier kommt dann die verkürzende Formelschreibweise mit dem Stern <span class="in">`*`</span> zum Einsatz. Ich kann mir nicht merken was alle Faktorkombinationen zusammen mit allen Interaktionen sind. Daher nutze ich dann einmal die Schreibweise, die mir diese Überlegung abnimmt. Dann muss ich noch in dem Fehlerterm mitteilen wer <span class="in">`.id`</span> in welchen Faktor <span class="in">`time_fct`</span> wiederholt wird. Damit ist die dreifaktorielle mixed ANOVA der zweifaktoriellen mixed ANOVA sehr ähnlich. Wir erhalten dann folgende Ausagen, die ich nochmal aufgereinigt habe, da ich nicht alle Spalten und Informationen brauche. Auch mag ich den p-Wert gerne etwas übersichtlicher.</span>
<span id="cb80-715"><a href="#cb80-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-718"><a href="#cb80-718" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-719"><a href="#cb80-719" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> workout <span class="sc">*</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>time_fct), </span>
<span id="cb80-720"><a href="#cb80-720" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> mixed_fac3_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb80-721"><a href="#cb80-721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb80-722"><a href="#cb80-722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span> </span>
<span id="cb80-723"><a href="#cb80-723" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, df, statistic, p.value) <span class="sc">|&gt;</span> </span>
<span id="cb80-724"><a href="#cb80-724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value))</span>
<span id="cb80-725"><a href="#cb80-725" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-726"><a href="#cb80-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-727"><a href="#cb80-727" aria-hidden="true" tabindex="-1"></a>Wir sehen sofort, dass die beiden Faktoren der Fütterungsart sowie des Workout signifikant sind. Auch haben wir eine signifikante Interaktion zwischen den beiden Faktoren vorliegen. Die Gruppen der Fütterung verhalten sich in den beiden Gruppen des Workouts nicht gleich. Auch ist die Zeit signifkant, es passiert also etwas mit der Sprungweite über die Zeit. Im Weiteren haben wir eine signifikante Interaktion zwischen der Fütterungsart und der Zeit, so dass sich hier auch über die Zeit die Gruppen der Fütterung anders verhalten. Die anderen Interaktionen sind nicht signifikant.</span>
<span id="cb80-728"><a href="#cb80-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-729"><a href="#cb80-729" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{rstatix}`</span></span>
<span id="cb80-730"><a href="#cb80-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-731"><a href="#cb80-731" aria-hidden="true" tabindex="-1"></a>Jetzt kürze ich ein wenig ab, da die Ergebnisse ja gleich sind in <span class="in">`{rstatix}`</span> zu der mixed ANOVA mit <span class="in">`aov()`</span>. Die Funktionen sind ja identisch nur das sich die Eingabe unterscheidet. Hier sieht man dann eventuell besser, dass wir *zwischen* den Fütterungsarten und den Workouts vergleichen wollen und wir als Wiederholung die <span class="in">`.id`</span> der einzelnen Flöhe vorliegen haben. Wir erhalten hier nochmal als Effektschätzer das Eta$^2$ wiedergegeben, was wirklich ein Vorteil ist. Ansonsten würde ich fast die <span class="in">`aov()`</span> Funktion vorziehen. Am Ende filtere ich wieder um dann eine etwas ausgeräumte Ausgabe zu haben.</span>
<span id="cb80-732"><a href="#cb80-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-735"><a href="#cb80-735" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-736"><a href="#cb80-736" aria-hidden="true" tabindex="-1"></a>rstatix_aov <span class="ot">&lt;-</span> <span class="fu">anova_test</span>(<span class="at">data =</span> mixed_fac3_tbl, </span>
<span id="cb80-737"><a href="#cb80-737" aria-hidden="true" tabindex="-1"></a>                          <span class="at">dv =</span> jump_length, <span class="at">wid =</span> .id, </span>
<span id="cb80-738"><a href="#cb80-738" aria-hidden="true" tabindex="-1"></a>                          <span class="at">between =</span> <span class="fu">c</span>(feeding, workout), </span>
<span id="cb80-739"><a href="#cb80-739" aria-hidden="true" tabindex="-1"></a>                          <span class="at">within =</span> time_fct)</span>
<span id="cb80-740"><a href="#cb80-740" aria-hidden="true" tabindex="-1"></a><span class="fu">get_anova_table</span>(rstatix_aov) <span class="sc">|&gt;</span> </span>
<span id="cb80-741"><a href="#cb80-741" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb80-742"><a href="#cb80-742" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Effect, F, p, ges) <span class="sc">|&gt;</span> </span>
<span id="cb80-743"><a href="#cb80-743" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> <span class="fu">pvalue</span>(p))</span>
<span id="cb80-744"><a href="#cb80-744" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-745"><a href="#cb80-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-746"><a href="#cb80-746" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{afex}`</span></span>
<span id="cb80-747"><a href="#cb80-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-748"><a href="#cb80-748" aria-hidden="true" tabindex="-1"></a>Bei dem R Paket <span class="in">`{afex}`</span> ist es ähnlich wie schon bei dem R Paket <span class="in">`{rstatix}`</span>. Hier ist dann die Formelschreibweise ähnlich wie schon bei <span class="in">`aov()`</span>. Das macht die Nutzung angenehmer für mich. Als Besonderheit können wir dann auch <span class="in">`{afex}`</span> nutzen wie ein lineares gemischtes Modell. Intern ruft dann aber auch <span class="in">`{afex}`</span> das Paket <span class="in">`{car}`</span> auf und nutzt dessen Algorithmus. Daher ist hier die Nutzung der Type II ANOVA und Type III ANOVA einfacher umzusetzen. Ich mag das Paket gerne, da es auch speziell für Messwiederholungen gebaut wurde.</span>
<span id="cb80-749"><a href="#cb80-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-752"><a href="#cb80-752" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-753"><a href="#cb80-753" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-754"><a href="#cb80-754" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-755"><a href="#cb80-755" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> workout <span class="sc">*</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>time_fct), </span>
<span id="cb80-756"><a href="#cb80-756" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> mixed_fac3_tbl) </span>
<span id="cb80-757"><a href="#cb80-757" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-758"><a href="#cb80-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-759"><a href="#cb80-759" aria-hidden="true" tabindex="-1"></a>Das R Paket <span class="in">`{afex}`</span> erlaubt es auch die Modelle nach der Schreibweise der linearen gemischten Modelle zu definieren. Das ist für mich eigentlich etwas angenehmer, da man sich dann in einer Formelwelt aufhält mehr dazu dann im <span class="co">[</span><span class="ot">Kapitel zu gemischten Modellen</span><span class="co">](#sec-mixed)</span>. Also die Ergebnisse sind die Gleichen. Ich brauche es nur als Referenz für mich zum nachschlagen.</span>
<span id="cb80-760"><a href="#cb80-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-763"><a href="#cb80-763" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-764"><a href="#cb80-764" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-765"><a href="#cb80-765" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-766"><a href="#cb80-766" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb80-767"><a href="#cb80-767" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_4</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> workout <span class="sc">*</span> time_fct <span class="sc">+</span> (time_fct<span class="sc">|</span>.id), </span>
<span id="cb80-768"><a href="#cb80-768" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> mixed_fac3_tbl)</span>
<span id="cb80-769"><a href="#cb80-769" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-770"><a href="#cb80-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-771"><a href="#cb80-771" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{MANOVA.RM}`</span></span>
<span id="cb80-772"><a href="#cb80-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-773"><a href="#cb80-773" aria-hidden="true" tabindex="-1"></a>Am Ende stelle ich noch das R Paket <span class="in">`{MANOVA.RM}`</span> vor. Auch hier haben wir dann wieder zu viel Ausgabe. Ich finde hier wird dann deutlich, dass die deskriptive Statistik über ist. Ich will doch nur eine mixed ANOVA rechnen. In der Funktion <span class="in">`RM()`</span> spezifizieren wir ja nur den <span class="in">`within`</span> Faktor, der sich hier ja auch bei einer dreifaktoriellen mixed ANOVA nicht ändert. Wir haben auch hier wieder drei Tests, wobei ich dann auch nur die Ergebnisse der <span class="in">`ANOVA-Type Statistic (ATS)`</span> nehmen und den Rest liegen lassen würde.</span>
<span id="cb80-774"><a href="#cb80-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-777"><a href="#cb80-777" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-778"><a href="#cb80-778" aria-hidden="true" tabindex="-1"></a><span class="fu">RM</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> workout <span class="sc">*</span> time_fct, <span class="at">data =</span> mixed_fac3_tbl, </span>
<span id="cb80-779"><a href="#cb80-779" aria-hidden="true" tabindex="-1"></a>   <span class="at">subject =</span> <span class="st">".id"</span>, <span class="at">within =</span> <span class="fu">c</span>(<span class="st">"time_fct"</span>), <span class="at">iter =</span> <span class="dv">100</span>, </span>
<span id="cb80-780"><a href="#cb80-780" aria-hidden="true" tabindex="-1"></a>   <span class="at">resampling =</span> <span class="st">"Perm"</span>, <span class="at">seed =</span> <span class="dv">1234</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-781"><a href="#cb80-781" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb80-782"><a href="#cb80-782" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-783"><a href="#cb80-783" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb80-784"><a href="#cb80-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-785"><a href="#cb80-785" aria-hidden="true" tabindex="-1"></a>Nachdem wir ja unsere mixed ANOVA mit einem der vorgeschlagenen Algorithmen gerechnet haben, sehen wir dass wir eine signifikante Interaktion vorliegen haben. Zum einen ist der Interaktionsterm <span class="in">`feeding:workout`</span> signifikant sowie der Interaktionsterm <span class="in">`feeding:time_fct`</span> auch. Damit haben wir andere Mittelwerte der Sprungweite für die Fütterungsarten zu den beiden Workouts sowie unterschiedliche Mittelwerte der Sprungweiten über die Zeit und Fütterungsarten. Ja und das sehen wir dann auch in der folgenden Abbildung. Bei der Kontrollbehandlung und der Ketchupfütterung hat das Workout exakt einen anderen Effekt. Bei der Kontrolle springen die nicht trainierten Flöhe weniger weit. Bei der Ernährung mit Ketchup haben das Training einen negativen Effekt. Eine Drehung des Effekts des Workouts nach der Fütterung. Auch kreuzen die Mittelwerte der Sprungweiten über die Zeit nach der Fütterungsart.</span>
<span id="cb80-786"><a href="#cb80-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-789"><a href="#cb80-789" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-790"><a href="#cb80-790" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-791"><a href="#cb80-791" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb80-792"><a href="#cb80-792" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-793"><a href="#cb80-793" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-interactionplot-mixed-3fac</span></span>
<span id="cb80-794"><a href="#cb80-794" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb80-795"><a href="#cb80-795" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb80-796"><a href="#cb80-796" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb80-797"><a href="#cb80-797" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Liniendigramm mit den Mittelwerten aller Faktorkombinationen der beiden Faktoren `feeding` sowie `workout` und `time_fct`. Die Linien sind in der Reichenfolge verdreht, es liegt eine Interaktion vor. Auch kruezen sich die Fütterungsarten über die Zeit. Eine allgmeine Aussage über die Sprungweite und die Fütterung soweie dem Workout lässt sich nicht unabhängig vom Zeitpunkt treffen."</span></span>
<span id="cb80-798"><a href="#cb80-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-799"><a href="#cb80-799" aria-hidden="true" tabindex="-1"></a>mixed_fac3_tbl <span class="sc">|&gt;</span> </span>
<span id="cb80-800"><a href="#cb80-800" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time_fct, <span class="at">y =</span> jump_length,</span>
<span id="cb80-801"><a href="#cb80-801" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> feeding, <span class="at">linetype =</span> workout, </span>
<span id="cb80-802"><a href="#cb80-802" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> <span class="fu">interaction</span>(feeding, workout))) <span class="sc">+</span></span>
<span id="cb80-803"><a href="#cb80-803" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb80-804"><a href="#cb80-804" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb80-805"><a href="#cb80-805" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb80-806"><a href="#cb80-806" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb80-807"><a href="#cb80-807" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span>
<span id="cb80-808"><a href="#cb80-808" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-809"><a href="#cb80-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-810"><a href="#cb80-810" aria-hidden="true" tabindex="-1"></a><span class="fu">## Repeated measurement ANOVA</span></span>
<span id="cb80-811"><a href="#cb80-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-812"><a href="#cb80-812" aria-hidden="true" tabindex="-1"></a>::: callout-caution</span>
<span id="cb80-813"><a href="#cb80-813" aria-hidden="true" tabindex="-1"></a><span class="fu">## Achtung, bitte beachten!</span></span>
<span id="cb80-814"><a href="#cb80-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-815"><a href="#cb80-815" aria-hidden="true" tabindex="-1"></a>Willst du wirklich eine *repeated* ANOVA rechnen oder doch eher eine mixed ANOVA? Der Unterschied ist subtil und hängt davon ab, welche Behandlungskombinationen deine einzelnen Beobachtungen erhalten haben. Schaue im Zweifel nochmal oben in der Einleitung um dich zu versichern. Häufig möchtest du nämlich eine mixed ANOVA rechnen.</span>
<span id="cb80-816"><a href="#cb80-816" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb80-817"><a href="#cb80-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-818"><a href="#cb80-818" aria-hidden="true" tabindex="-1"></a>Schauen wir also einmal was die repeated ANOVA einmal macht. Hier nochmal ganz wichtig zu Anfang. Wir werden jetzte *jede* Beobachtung mit *jeder* Faktorkombination zu *jedem* Zeitpunkt messen. Das heißt in unserem Konkreten Fall, dass wir bei jeden Katzenfloh die Sprungweite zu jedem Zeitpunkt messen. Das macht ja auch erstmal Sinn. Das wäre dann die einfaktorielle repated ANOVA. Wir haben sonst auch keinen weiteren Faktor im Experiment. Wenn wir jetzt noch die Fütterungsart als Faktor hinzunehmen, dann füttern wir jeden Floh mit allen drei Arten der Fütterung. Jeder Floh erhält Zuckerwasser, springt dann mehrfach und wir messen die Sprungweite. Das machen wir dann mit dem selben Floh nochmal für die Ernährungsart Blut und Ketchup. Wenn dann noch ein zweiter Behandlungsfaktor hinzukommt wie das Workout, dann müssen wir unter jeder Workoutbedinung einmal alle drei Fütterungsarten die Sprungweiten für einen Floh durchmessen. Das heißt wir messen dann einen einzelnen Floh ganz schön oft. Im Bereich der Agrarwissenschaften mag diese Art der wiederholten Behandlung eher selten vorkommen. Daher hier auch ausdrücklich die Warnung, sich nochmal klar zu machen, wie du die einzelnen Beobachtungen nun bemisst. Ich habe auch erst ein wenig gebraucht um die repeated ANOVA von Design her zu verstehen.</span>
<span id="cb80-819"><a href="#cb80-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-820"><a href="#cb80-820" aria-hidden="true" tabindex="-1"></a><span class="fu">### Einfaktoriell</span></span>
<span id="cb80-821"><a href="#cb80-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-822"><a href="#cb80-822" aria-hidden="true" tabindex="-1"></a>Beginnen wir mit der einfaktoriellen repeated ANOVA. Hier haben wir die Fragestellung vorliegen, ob die Zeit einen Einfluss auf die Sprungweiten der Katzenflöhe hat. Wir haben sonst keinen weiteren Behandlungsfaktor. Wir messen einfach nur die Sprungweite der Katzenflöhe wiederholt und schauen, ob sich die Sprungweiten über die Zeit ändern. Das Experiment ist eher ungewöhnlich, da wir hier ja nur wiederholt messen und sonst nichts tun. Faktisch ist es ein *proof-of-principle*, ob wir überhaupt einen Effekt der Zeit auf die Sprungweite haben.</span>
<span id="cb80-823"><a href="#cb80-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-824"><a href="#cb80-824" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb80-825"><a href="#cb80-825" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{base}`</span></span>
<span id="cb80-826"><a href="#cb80-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-827"><a href="#cb80-827" aria-hidden="true" tabindex="-1"></a>Jetzt ist im Prinzip die Schreiweise das Besondere. Wir haben hier jetzt nur die Zeit als einen Einflussfaktor. Den packen wir jetzt einmal vorne in unser Modell und dann einmal hinten in den Fehlerterm. Dann müssen wir auch hier sagen, dass wir die Beobachtungen wiederholt im Faktor Zeit gemessen haben. Dann können wir auch schon die ANOVA rechnen.</span>
<span id="cb80-828"><a href="#cb80-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-831"><a href="#cb80-831" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-832"><a href="#cb80-832" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>time_fct), <span class="at">data =</span> repeated_fac1_tbl)<span class="sc">|&gt;</span> </span>
<span id="cb80-833"><a href="#cb80-833" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb80-834"><a href="#cb80-834" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span> </span>
<span id="cb80-835"><a href="#cb80-835" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, df, statistic, p.value) <span class="sc">|&gt;</span> </span>
<span id="cb80-836"><a href="#cb80-836" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value))</span>
<span id="cb80-837"><a href="#cb80-837" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-838"><a href="#cb80-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-839"><a href="#cb80-839" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass der p-Wert kleiner ist als das Signifikanzniveau $\alpha$ gleich 5% und damit haben wir einen signifkanten Einfluss der Zeit auf die Sprungweite der Katzenflöhe. Mehr testen wir hier auch nicht. Wir haben ja auch nur die Zeit als Faktor in unserem Modell.</span>
<span id="cb80-840"><a href="#cb80-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-841"><a href="#cb80-841" aria-hidden="true" tabindex="-1"></a>Wenn du dann noch einen Effektschätzer brauchst, dann kannst du das R Paket <span class="in">`{effectsize}`</span> mit der Funktion <span class="in">`eta_squared()`</span> nutzen. Wir wollen dann noch das <span class="co">[</span><span class="ot">generalisierte Eta$^2$</span><span class="co">](https://easystats.github.io/effectsize/articles/anovaES.html#generalized-eta2)</span> nutzen, da wir die Zeitpunkte nur beobachten und nicht als experimentellen Faktor festgelegt haben. Dazu dann auch mehr in der Arbeit von @olejnik2003generalized mit dem Titel <span class="co">[</span><span class="ot">Generalized eta and omega squared statistics: measures of effect size for some common research designs</span><span class="co">](https://coshima.davidrjfikis.com/EPRS8540/uploadf07/olejnik_PsychMeth2003.pdf)</span>.</span>
<span id="cb80-842"><a href="#cb80-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-845"><a href="#cb80-845" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-846"><a href="#cb80-846" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>time_fct), <span class="at">data =</span> repeated_fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb80-847"><a href="#cb80-847" aria-hidden="true" tabindex="-1"></a>  <span class="fu">eta_squared</span>(<span class="at">generalized =</span> <span class="st">"time_fct"</span>)</span>
<span id="cb80-848"><a href="#cb80-848" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-849"><a href="#cb80-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-850"><a href="#cb80-850" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{rstatix}`</span></span>
<span id="cb80-851"><a href="#cb80-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-852"><a href="#cb80-852" aria-hidden="true" tabindex="-1"></a>Wir können auch das R Paket <span class="in">`{rstatix}`</span> nutzen. Hier rufen wir am Ende dann doch auch nur die <span class="in">`aov()`</span> Funktion auf, schreiben aber die Variablen in unseren Daten etwas anders in die Funkion <span class="in">`anova_test()`</span>. Du musst eben wissen, dass hier die abhängige Variable <span class="in">`dv`</span> die Sprungweite ist, du dann die Beobachtungen in <span class="in">`wid`</span> schreibst und die Zeit in die Option <span class="in">`within`</span>. Am Ende ist es dann auch hier eine Geschmackssache, welche Funktion dir besser gefällt und passt.</span>
<span id="cb80-853"><a href="#cb80-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-856"><a href="#cb80-856" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-857"><a href="#cb80-857" aria-hidden="true" tabindex="-1"></a>rstatix_aov <span class="ot">&lt;-</span> <span class="fu">anova_test</span>(<span class="at">data =</span> repeated_fac1_tbl, </span>
<span id="cb80-858"><a href="#cb80-858" aria-hidden="true" tabindex="-1"></a>                          <span class="at">dv =</span> jump_length, <span class="at">wid =</span> .id, <span class="at">within =</span> time_fct)</span>
<span id="cb80-859"><a href="#cb80-859" aria-hidden="true" tabindex="-1"></a><span class="fu">get_anova_table</span>(rstatix_aov)</span>
<span id="cb80-860"><a href="#cb80-860" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-861"><a href="#cb80-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-862"><a href="#cb80-862" aria-hidden="true" tabindex="-1"></a>Es kommt das Gleiche numerisch raus, wie schon bei <span class="in">`aov()`</span>. Wir erhalten hier aber zusätzlich noch einen Effektschätzer in der Spalte <span class="in">`ges`</span>, was dem Eta$^2$ entspricht. Demensprechend ein Vorteil der Funktion.</span>
<span id="cb80-863"><a href="#cb80-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-864"><a href="#cb80-864" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{afex}`</span></span>
<span id="cb80-865"><a href="#cb80-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-866"><a href="#cb80-866" aria-hidden="true" tabindex="-1"></a>Das R Paket <span class="in">`{afex}`</span> kommt bei einer so simplen einfaktoriellen repeated ANOVA dann auf die gleichen Zahlen wie schon die beiden vorherigen Algorithmen. Auch erhälst du bei der Funktion <span class="in">`aov_car()`</span> einen Wert für Eta$^2$ in der Spalte <span class="in">`ges`</span> wiedergegeben. Ich bevorzuge dann ja die Schreibweise hier von <span class="in">`{afex}`</span>, da ich diese hier etwas klarer finde als bei <span class="in">`{rstatix}`</span>.</span>
<span id="cb80-867"><a href="#cb80-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-870"><a href="#cb80-870" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-871"><a href="#cb80-871" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-872"><a href="#cb80-872" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-873"><a href="#cb80-873" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(jump_length <span class="sc">~</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>time_fct), <span class="at">data =</span> repeated_fac1_tbl)</span>
<span id="cb80-874"><a href="#cb80-874" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-875"><a href="#cb80-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-876"><a href="#cb80-876" aria-hidden="true" tabindex="-1"></a>Das R Paket <span class="in">`{afex}`</span> erlaubt es auch die Modelle nach der Schreibweise der linearen gemischten Modelle zu definieren. Das ist für mich eigentlich etwas angenehmer, da man sich dann in einer Formelwelt aufhält mehr dazu dann im <span class="co">[</span><span class="ot">Kapitel zu gemischten Modellen</span><span class="co">](#sec-mixed)</span>. Also die Ergebnisse sind die Gleichen. Ich brauche es nur als Referenz für mich zum nachschlagen.</span>
<span id="cb80-877"><a href="#cb80-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-880"><a href="#cb80-880" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-881"><a href="#cb80-881" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-882"><a href="#cb80-882" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-883"><a href="#cb80-883" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb80-884"><a href="#cb80-884" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_4</span>(jump_length <span class="sc">~</span> time_fct <span class="sc">+</span> (time_fct<span class="sc">|</span>.id), <span class="at">data =</span> repeated_fac1_tbl)</span>
<span id="cb80-885"><a href="#cb80-885" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-886"><a href="#cb80-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-887"><a href="#cb80-887" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{MANOVA.RM}`</span></span>
<span id="cb80-888"><a href="#cb80-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-889"><a href="#cb80-889" aria-hidden="true" tabindex="-1"></a>Am Ende dann noch die Funktion <span class="in">`RM()`</span> aus dem R Paket. Erstmal erhalten wir auch hier weder drei statistische Tests, obwohl wir nur nach einem gefragt haben. Ich würde auch hier nur die Ausgabe von <span class="in">`ANOVA-Type Statistic (ATS)`</span> betrachten. Auch hier sehen wir, dass wir in einem einfaktoriellen Fall die gleichen Werte wie in den anderen R Paketen erhalten. Hir haben wir dann aber noch mehr Informationen, die wir dann brauchen oder auch nicht.</span>
<span id="cb80-890"><a href="#cb80-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-893"><a href="#cb80-893" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-894"><a href="#cb80-894" aria-hidden="true" tabindex="-1"></a><span class="fu">RM</span>(jump_length <span class="sc">~</span> time_fct, <span class="at">data =</span> repeated_fac1_tbl, </span>
<span id="cb80-895"><a href="#cb80-895" aria-hidden="true" tabindex="-1"></a>   <span class="at">subject =</span> <span class="st">".id"</span>, <span class="at">within =</span> <span class="st">"time_fct"</span>, <span class="at">iter =</span> <span class="dv">100</span>, </span>
<span id="cb80-896"><a href="#cb80-896" aria-hidden="true" tabindex="-1"></a>   <span class="at">resampling =</span> <span class="st">"Perm"</span>, <span class="at">seed =</span> <span class="dv">1234</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-897"><a href="#cb80-897" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb80-898"><a href="#cb80-898" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-899"><a href="#cb80-899" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb80-900"><a href="#cb80-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-901"><a href="#cb80-901" aria-hidden="true" tabindex="-1"></a><span class="fu">### Zweifaktoriell</span></span>
<span id="cb80-902"><a href="#cb80-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-903"><a href="#cb80-903" aria-hidden="true" tabindex="-1"></a>Die zweifaktorielle repeated ANOVA wird jetzt schon interessanter. Wir haben jetzt nämlich neben der Zeit als Faktor noch eine Behandlung vorliegen. In unserem Beispiel erhält *jeder* Floh drei Arten der Fütterung wiederholt gefüttert. Zum einen erhält jeder Floh ein Zuckerwasser, dann Blut und zum Schluss Ketchup als Nahrung. Die Reihenfolge sollte sich dann von Floh Floh noch unterscheiden und die Zeiten zwischen den Behandlungen dann so lang gewählt werden, dass die Ernährung förmlich ausgewaschen ist. Die Idee ist, dass die vorherige Ernährungsform keinen Einfluss auf die neue Ernährung hat. Dann müssen wir das Ganze ja auch noch wiederholt über vier Zeitpunkte die Sprungweite messen. Daher misst du hier ganz schön viel. Häufig haben wir dieses Design nicht in den Agrarwissenschaften vorliegen. Wir können aber im Bereich der Nutztierwissenschaften schon das ein oder andere Mal so einen Fall vorliegen haben, wo wir Tiere wiederholt mit einer Behandlung verarzten.</span>
<span id="cb80-904"><a href="#cb80-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-905"><a href="#cb80-905" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb80-906"><a href="#cb80-906" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{base}`</span></span>
<span id="cb80-907"><a href="#cb80-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-908"><a href="#cb80-908" aria-hidden="true" tabindex="-1"></a>Die Frage ist jetzt immer, wie schreibe ich jetzt das Modell richtig? Der komplizierte Teil ist eigentlich der Fehlerterm <span class="in">`Error()`</span> aber auch der Teil davor. Ich nutze hier wieder die Kurzschreibweise mit dem Stern <span class="in">`*`</span> um alle Faktorkombinationen plus Interaktion im Modell zu haben. Das wird eben dann ab zwei Faktoren etwas groß. So ist es dann weniger anfällig für Fehler. Dann musst du noch darauf achten, dass du in dem Fehlerterm die Klammern richtig setzt, sonst funktioniert es dort auch nicht. Erst kommt der Spaltenname für die einzelnen Flöhe <span class="in">`.id`</span> und dahinter nach dem Slash <span class="in">`/`</span> dann die Faktorkombinationen der Behandlungen und der Zeit. Dann räume ich die Ausgabe nochmal vollkommen auf, damit ich auch was sehe.</span>
<span id="cb80-909"><a href="#cb80-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-912"><a href="#cb80-912" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-913"><a href="#cb80-913" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>(feeding <span class="sc">*</span> time_fct)), </span>
<span id="cb80-914"><a href="#cb80-914" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> repeated_fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb80-915"><a href="#cb80-915" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb80-916"><a href="#cb80-916" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span> </span>
<span id="cb80-917"><a href="#cb80-917" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, df, statistic, p.value) <span class="sc">|&gt;</span> </span>
<span id="cb80-918"><a href="#cb80-918" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value))</span>
<span id="cb80-919"><a href="#cb80-919" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-920"><a href="#cb80-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-921"><a href="#cb80-921" aria-hidden="true" tabindex="-1"></a>Wie wir sehen sind beide Faktoren der Zeit und der Fütterungsart signifikant. Der p-Wert ist kleiner als das Signifikanzniveau $\alpha$ gleich 5%. Auch haben wir eine signifikante Interaktion zwischen den Fütterungsarten und der Zeit. Daher zeigen die Fütterungsarten unterschiedliche Sprungweiten zu den verschiedenen Zeitpunkten.</span>
<span id="cb80-922"><a href="#cb80-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-923"><a href="#cb80-923" aria-hidden="true" tabindex="-1"></a>Dann können wir uns auch den Effektschätzer Eta\^$^2$ berechnen lassen. Hier müssen wir dann das ANOVA Modell einmal in die Funktion <span class="in">`eta_squared()`</span> stecken und darauf achten, dass wir angeben, dass wir die Zeitpunkte nur beobachtet haben und nicht experimentell festgelegt. Deshalb kommt <span class="in">`time_fct`</span> noch in die Option <span class="in">`generalized`</span> mit rein. Die Effektschätzer unterscheiden sich hier immer ein wenig, dass kommt dann immer auf den verwendeten Algorithmus an.</span>
<span id="cb80-924"><a href="#cb80-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-927"><a href="#cb80-927" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-928"><a href="#cb80-928" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>(feeding <span class="sc">*</span> time_fct)), </span>
<span id="cb80-929"><a href="#cb80-929" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> repeated_fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb80-930"><a href="#cb80-930" aria-hidden="true" tabindex="-1"></a>  <span class="fu">eta_squared</span>(<span class="at">generalized =</span> <span class="fu">c</span>(<span class="st">"time_fct"</span>))</span>
<span id="cb80-931"><a href="#cb80-931" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-932"><a href="#cb80-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-933"><a href="#cb80-933" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{rstatix}`</span></span>
<span id="cb80-934"><a href="#cb80-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-935"><a href="#cb80-935" aria-hidden="true" tabindex="-1"></a>Das R Paket <span class="in">`{rstatix}`</span> hat eine andere Schreibweise des Modells. Im Prinzip schreiben wir hier wieder nicht das Modell auf, sondern weisen die Spaltennamen dann den jeweiligen Optionen zu. Hier werden dann auch alle Interaktionen gerechnet, du kannst die Interaktionen aller Faktorkombinationen nicht abstellen. Wir setzten dann unseren Endpunkt <span class="in">`jump_length`</span> in die Option <span class="in">`dv`</span> und die einzelnen Beobachtungen in die Option <span class="in">`wid`</span>. Dann müssen wir noch die beiden Faktoren der Zeit und der Behandlung in die Option <span class="in">`within`</span> einfügen. Dann haben wir auch schon alles zusammen. Was hier etwas doof ist, ist das wir hier die Formelschreibweise in R verlassen, die wir dann aber überall sonst nutzen. Dafür erhalten wir dann aber das Eta$^2$ gleich als <span class="in">`ges`</span> wieder aus der Funktion zurück.</span>
<span id="cb80-936"><a href="#cb80-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-939"><a href="#cb80-939" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-940"><a href="#cb80-940" aria-hidden="true" tabindex="-1"></a>rstatix_aov <span class="ot">&lt;-</span> <span class="fu">anova_test</span>(<span class="at">data =</span> repeated_fac2_tbl, </span>
<span id="cb80-941"><a href="#cb80-941" aria-hidden="true" tabindex="-1"></a>                          <span class="at">dv =</span> jump_length, <span class="at">wid =</span> .id, </span>
<span id="cb80-942"><a href="#cb80-942" aria-hidden="true" tabindex="-1"></a>                          <span class="at">within =</span> <span class="fu">c</span>(feeding, time_fct))</span>
<span id="cb80-943"><a href="#cb80-943" aria-hidden="true" tabindex="-1"></a><span class="fu">get_anova_table</span>(rstatix_aov)</span>
<span id="cb80-944"><a href="#cb80-944" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-945"><a href="#cb80-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-946"><a href="#cb80-946" aria-hidden="true" tabindex="-1"></a>Wir erhalten die gleichen Ergebnisse wie schon bei der Funktion <span class="in">`aov()`</span> wiedergegeben. Das überrascht auch nicht, den die Berechnung ist ja die gleiche Berechnung wie auch in <span class="in">`aov()`</span> nur eben dann mit einem anderen Funktionsaufruf.</span>
<span id="cb80-947"><a href="#cb80-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-948"><a href="#cb80-948" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{afex}`</span></span>
<span id="cb80-949"><a href="#cb80-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-950"><a href="#cb80-950" aria-hidden="true" tabindex="-1"></a>Das R Paket <span class="in">`{afex}`</span> nutzt die Formelschreibweise und kann auch genau so bedient werden wie schon die Funktion <span class="in">`aov()`</span>. Dafür können wir aber mit der Option <span class="in">`type`</span> auch anderen Typen der ANOVA nutzen und nicht nur die Type I ANOVA in <span class="in">`aov()`</span>. Das ist eigentlich die große Stärke von dem R Paket <span class="in">`{afex}`</span>, dass wir hier flexibel bei der Auswahl der Typen sind. Bei der einfaktoriellen ANOVA war es noch egal, aber hier macht es mit zwei Faktoren dann schon einen Unterschied welche Art der ANOVA du rechnen möchtest. Ich nutze hier den Standard und damit die Type III ANOVA. Auch erhälst du bei der Funktion <span class="in">`aov_car()`</span> einen Wert für Eta$^2$ in der Spalte <span class="in">`ges`</span> wiedergegeben.</span>
<span id="cb80-951"><a href="#cb80-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-954"><a href="#cb80-954" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-955"><a href="#cb80-955" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-956"><a href="#cb80-956" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-957"><a href="#cb80-957" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>feeding <span class="sc">*</span> time_fct), </span>
<span id="cb80-958"><a href="#cb80-958" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> repeated_fac2_tbl)</span>
<span id="cb80-959"><a href="#cb80-959" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-960"><a href="#cb80-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-961"><a href="#cb80-961" aria-hidden="true" tabindex="-1"></a>Die Ergebnisse sind ähnlich wie schon bei den beiden anderen Algorithmen, aber hier macht es dann einen Unterschied welche ANOVA grechnet wird. Wir rechnen hier dann ja eine Type 3 ANOVA. Die p-Werte sind aber alle so gering, dass es dann am Ende keinen so großen Unterschied mehr macht.</span>
<span id="cb80-962"><a href="#cb80-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-963"><a href="#cb80-963" aria-hidden="true" tabindex="-1"></a>Das R Paket <span class="in">`{afex}`</span> erlaubt es auch die Modelle nach der Schreibweise der linearen gemischten Modelle zu definieren. Das ist für mich eigentlich etwas angenehmer, da man sich dann in einer Formelwelt aufhält mehr dazu dann im <span class="co">[</span><span class="ot">Kapitel zu gemischten Modellen</span><span class="co">](#sec-mixed)</span>. Also die Ergebnisse sind die Gleichen. Ich brauche es nur als Referenz für mich zum nachschlagen.</span>
<span id="cb80-964"><a href="#cb80-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-967"><a href="#cb80-967" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-968"><a href="#cb80-968" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-969"><a href="#cb80-969" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-970"><a href="#cb80-970" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb80-971"><a href="#cb80-971" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_4</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> time_fct <span class="sc">+</span> (feeding <span class="sc">*</span> time_fct<span class="sc">|</span>.id), </span>
<span id="cb80-972"><a href="#cb80-972" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> repeated_fac2_tbl)</span>
<span id="cb80-973"><a href="#cb80-973" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-974"><a href="#cb80-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-975"><a href="#cb80-975" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{MANOVA.RM}`</span></span>
<span id="cb80-976"><a href="#cb80-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-977"><a href="#cb80-977" aria-hidden="true" tabindex="-1"></a>Am Ende dann noch die Funktion <span class="in">`RM()`</span> aus dem R Paket. Erstmal erhalten wir auch hier weder drei statistische Tests, obwohl wir nur nach einem gefragt haben. Ich würde auch hier nur die Ausgabe von <span class="in">`ANOVA-Type Statistic (ATS)`</span> betrachten. Auch hier sehen wir, dass wir in einem zweifaktoriellen Fall die ähnlichen Werte wie in den anderen R Paketen erhalten. Hier fängt es dann etwas an zu variieren. Hier haben wir dann aber noch mehr Informationen, die wir dann brauchen oder auch nicht. Ich habe dann einmal hier die Anzeige der Funktion ausgeschaltet, da hier der Output dann sehr lang wird. Du kannst dir beispielhaft die Ausgabe einmal bei der einfaktoriellen repeated ANOVA weiter oben einmal anschaue oder eben den Code selber einmal durchführen.</span>
<span id="cb80-978"><a href="#cb80-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-981"><a href="#cb80-981" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-982"><a href="#cb80-982" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-983"><a href="#cb80-983" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-984"><a href="#cb80-984" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb80-985"><a href="#cb80-985" aria-hidden="true" tabindex="-1"></a><span class="fu">RM</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> time_fct, <span class="at">data =</span> repeated_fac2_tbl, </span>
<span id="cb80-986"><a href="#cb80-986" aria-hidden="true" tabindex="-1"></a>   <span class="at">subject =</span> <span class="st">".id"</span>, <span class="at">within =</span> <span class="fu">c</span>(<span class="st">"feeding"</span>, <span class="st">"time_fct"</span>), <span class="at">iter =</span> <span class="dv">100</span>, </span>
<span id="cb80-987"><a href="#cb80-987" aria-hidden="true" tabindex="-1"></a>   <span class="at">resampling =</span> <span class="st">"Perm"</span>, <span class="at">seed =</span> <span class="dv">1234</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-988"><a href="#cb80-988" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb80-989"><a href="#cb80-989" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-990"><a href="#cb80-990" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb80-991"><a href="#cb80-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-992"><a href="#cb80-992" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dreifaktoriell</span></span>
<span id="cb80-993"><a href="#cb80-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-994"><a href="#cb80-994" aria-hidden="true" tabindex="-1"></a>Als letztes betrachten wir einen sehr exotischen Fall im Bereich der Agrarwissenschaften. Auch in anderen Forschungsbereichen ist die dreifaktorielle repeated ANOVA eher selten bis nicht vorhanden. Warum ist das so? Zum einen haben wir ja wieder unseren Faktor der Zeit. Wir messen hier viermal die Sprungweite eines Katzenflohs. Da wir aber dann noch zusätzlich zu dem Faktor der Zeit zwei weitere Behandlungen haben, kommen wir auf eine große Anzahl an Faktorkombinationen, die *jeder* Floh wiederholt durchlaufen muss. In unserem Fall haben wir ja die drei Fütterungsarten mit Zuckerwasser als Kontrolle, dem Blut sowie Ketchup als Ernährung. Dazu kommt dann noch ein Workout, dass jeder Floh gemacht hat oder nicht. Daher muss für jeden Floh jede Kombination der Fütterungsart und des Workouts wiederholt die Sprungweite gemessen werden. Das führt zu einem enormen Aufwand. Zum einen musst du ja immer Pausen zwischen den Behandlungen machen, damit sich die Effekte wieder auswaschen und es mit einem frischen Floh losgehen kann. Das ist eine zeitliche Belastung. Zum anderen ist es natürlich auch so, dass über die Zeit eventuell ein Floh nicht mehr kann oder gar verstirbt. Dann ist die ganze Messreihe für den Floh obsolet. Du siehst, diese Form des experimentellen Designs ist eher selten in Abschlussarbeiten und kommt eher in klinischen Studien oder längerfristigen agrarwissenschaftlichen Experimenten vor.</span>
<span id="cb80-995"><a href="#cb80-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-996"><a href="#cb80-996" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb80-997"><a href="#cb80-997" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{base}`</span></span>
<span id="cb80-998"><a href="#cb80-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-999"><a href="#cb80-999" aria-hidden="true" tabindex="-1"></a>Die Frage ist jetzt immer, wie schreibe ich jetzt das Modell richtig? Der komplizierte Teil ist eigentlich der Fehlerterm <span class="in">`Error()`</span> aber auch der Teil davor. Ich nutze hier wieder die Kurzschreibweise mit dem Stern <span class="in">`*`</span> um alle Faktorkombinationen plus Interaktion im Modell zu haben. Das wird eben dann ab schon zwei Faktoren etwas groß und mit drei Faktoren sehr unübersichtlich. So ist es dann weniger anfällig für Fehler. Dann musst du noch darauf achten, dass du in dem Fehlerterm die Klammern richtig setzt, sonst funktioniert es dort auch nicht. Erst kommt der Spaltenname für die einzelnen Flöhe <span class="in">`.id`</span> und dahinter nach dem Slash <span class="in">`/`</span> dann die Faktorkombinationen der Behandlungen und der Zeit. Dann räume ich die Ausgabe nochmal vollkommen auf, damit ich auch was sehe.</span>
<span id="cb80-1000"><a href="#cb80-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1003"><a href="#cb80-1003" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-1004"><a href="#cb80-1004" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> workout <span class="sc">*</span> time_fct <span class="sc">+</span> </span>
<span id="cb80-1005"><a href="#cb80-1005" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Error</span>(.id<span class="sc">/</span>(feeding <span class="sc">*</span> workout <span class="sc">*</span> time_fct)), </span>
<span id="cb80-1006"><a href="#cb80-1006" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> repeated_fac3_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb80-1007"><a href="#cb80-1007" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb80-1008"><a href="#cb80-1008" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span> </span>
<span id="cb80-1009"><a href="#cb80-1009" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, df, statistic, p.value) <span class="sc">|&gt;</span> </span>
<span id="cb80-1010"><a href="#cb80-1010" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value))</span>
<span id="cb80-1011"><a href="#cb80-1011" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-1012"><a href="#cb80-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1013"><a href="#cb80-1013" aria-hidden="true" tabindex="-1"></a>Wir erhalten jetzt eine Menge an Ausgabe wieder. Insbesondere die vielen Interaktionen führen natürlich zu mehr Ausgabe. Aber auch hier sind erstmal die Haupteffekte der Art der Fütterung und des Workout am interessantesten. Wir sehen hier, dass beide Faktoren signifikant sind, der p-Wert liegt unter dem Signifikanzniveau von $\alpha$ gleich 5%. Wir haben dann auch eine signifikante Zeitkomponente. Daher werden sich die Sprungweiten auch über die Zeit ändern. Am Ende ist dann nur die Interaktion zwischen der Fütterungsart und der Zeit signifikant. Anscheinend verhalten sich die Fütterungsarten nicht gleich über alle Zeitpunkte hinweg.</span>
<span id="cb80-1014"><a href="#cb80-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1015"><a href="#cb80-1015" aria-hidden="true" tabindex="-1"></a>Dann können wir noch die Effektschätzer Eta$^2$ für alle Faktoren und deren Interaktionen berechnen. Ich habe dann auch hier aufgeräumt und die Eta$^2$-Werte einmal gerundet, damit du besser sehen kannst, welche der Werte überhaupt größer sind. Auch hier sehen wir dann, dass die Hauptfaktoren den größten Effekt haben, gefolgt von den Zeitpunkten und der Interaktion zwischen den Fütterungsarten und der Zeit.</span>
<span id="cb80-1016"><a href="#cb80-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1019"><a href="#cb80-1019" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-1020"><a href="#cb80-1020" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> workout <span class="sc">*</span> time_fct <span class="sc">+</span> </span>
<span id="cb80-1021"><a href="#cb80-1021" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Error</span>(.id<span class="sc">/</span>(feeding <span class="sc">*</span> workout <span class="sc">*</span> time_fct)), </span>
<span id="cb80-1022"><a href="#cb80-1022" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> repeated_fac3_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb80-1023"><a href="#cb80-1023" aria-hidden="true" tabindex="-1"></a>  <span class="fu">eta_squared</span>(<span class="at">generalized =</span> <span class="fu">c</span>(<span class="st">"time_fct"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb80-1024"><a href="#cb80-1024" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Parameter, Eta2_generalized) <span class="sc">|&gt;</span> </span>
<span id="cb80-1025"><a href="#cb80-1025" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Eta2_generalized =</span> <span class="fu">round</span>(Eta2_generalized, <span class="dv">2</span>))</span>
<span id="cb80-1026"><a href="#cb80-1026" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-1027"><a href="#cb80-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1028"><a href="#cb80-1028" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{rstatix}`</span></span>
<span id="cb80-1029"><a href="#cb80-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1030"><a href="#cb80-1030" aria-hidden="true" tabindex="-1"></a>Das R Paket <span class="in">`{rstatix}`</span> hat eine andere Schreibweise des Modells. Im Prinzip schreiben wir hier wieder nicht das Modell auf, sondern weisen die Spaltennamen dann den jeweiligen Optionen zu. Hier werden dann auch alle Interaktionen gerechnet, du kannst die Interaktionen aller Faktorkombinationen nicht abstellen. Wir setzten dann unseren Endpunkt <span class="in">`jump_length`</span> in die Option <span class="in">`dv`</span> und die einzelnen Beobachtungen in die Option <span class="in">`wid`</span>. Dann müssen wir noch die beiden Faktoren der Zeit und der beiden Behandlungen in die Option <span class="in">`within`</span> einfügen. Dann haben wir auch schon alles zusammen. Was hier etwas doof ist, ist das wir hier die Formelschreibweise in R verlassen, die wir dann aber überall sonst nutzen. Dafür erhalten wir dann aber das Eta$^2$ gleich als <span class="in">`ges`</span> wieder aus der Funktion zurück.</span>
<span id="cb80-1031"><a href="#cb80-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1034"><a href="#cb80-1034" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-1035"><a href="#cb80-1035" aria-hidden="true" tabindex="-1"></a>rstatix_aov <span class="ot">&lt;-</span> <span class="fu">anova_test</span>(<span class="at">data =</span> repeated_fac3_tbl, </span>
<span id="cb80-1036"><a href="#cb80-1036" aria-hidden="true" tabindex="-1"></a>                          <span class="at">dv =</span> jump_length, <span class="at">wid =</span> .id, </span>
<span id="cb80-1037"><a href="#cb80-1037" aria-hidden="true" tabindex="-1"></a>                          <span class="at">within =</span> <span class="fu">c</span>(feeding, workout, time_fct))</span>
<span id="cb80-1038"><a href="#cb80-1038" aria-hidden="true" tabindex="-1"></a><span class="fu">get_anova_table</span>(rstatix_aov)</span>
<span id="cb80-1039"><a href="#cb80-1039" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-1040"><a href="#cb80-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1041"><a href="#cb80-1041" aria-hidden="true" tabindex="-1"></a>Wir erhalten die gleichen Ergebnisse wie schon bei der Funktion <span class="in">`aov()`</span> wiedergegeben. Das überrascht auch nicht, den die Berechnung ist ja die gleiche Berechnung wie auch in <span class="in">`aov()`</span> nur eben dann mit einem anderen Funktionsaufruf.</span>
<span id="cb80-1042"><a href="#cb80-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1043"><a href="#cb80-1043" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{afex}`</span></span>
<span id="cb80-1044"><a href="#cb80-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1045"><a href="#cb80-1045" aria-hidden="true" tabindex="-1"></a>Das R Paket <span class="in">`{afex}`</span> nutzt die Formelschreibweise und kann auch genau so bedient werden wie schon die Funktion <span class="in">`aov()`</span>. Dafür können wir aber mit der Option <span class="in">`type`</span> auch anderen Typen der ANOVA nutzen und nicht nur die Type I ANOVA in <span class="in">`aov()`</span>. Das ist eigentlich die große Stärke von dem R Paket <span class="in">`{afex}`</span>, dass wir hier flexibel bei der Auswahl der Typen sind. Bei der einfaktoriellen ANOVA war es noch egal, aber hier macht es mit zwei Faktoren dann schon einen Unterschied welche Art der ANOVA du rechnen möchtest. Ich nutze hier den Standard und damit die Type III ANOVA. Auch erhälst du bei der Funktion <span class="in">`aov_car()`</span> einen Wert für Eta$^2$ in der Spalte <span class="in">`ges`</span> wiedergegeben.</span>
<span id="cb80-1046"><a href="#cb80-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1049"><a href="#cb80-1049" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-1050"><a href="#cb80-1050" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-1051"><a href="#cb80-1051" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-1052"><a href="#cb80-1052" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> workout <span class="sc">*</span> time_fct <span class="sc">+</span> </span>
<span id="cb80-1053"><a href="#cb80-1053" aria-hidden="true" tabindex="-1"></a>          <span class="fu">Error</span>(.id<span class="sc">/</span>feeding <span class="sc">*</span> workout <span class="sc">*</span> time_fct), </span>
<span id="cb80-1054"><a href="#cb80-1054" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> repeated_fac3_tbl)</span>
<span id="cb80-1055"><a href="#cb80-1055" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-1056"><a href="#cb80-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1057"><a href="#cb80-1057" aria-hidden="true" tabindex="-1"></a>Die Ergebnisse sind ähnlich wie schon bei den beiden anderen Algorithmen, aber hier macht es dann einen Unterschied welche ANOVA grechnet wird. Wir rechnen hier dann ja eine Type 3 ANOVA. Die p-Werte sind aber alle so gering, dass es dann am Ende keinen so großen Unterschied mehr macht.</span>
<span id="cb80-1058"><a href="#cb80-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1059"><a href="#cb80-1059" aria-hidden="true" tabindex="-1"></a>Das R Paket <span class="in">`{afex}`</span> erlaubt es auch die Modelle nach der Schreibweise der linearen gemischten Modelle zu definieren. Das ist für mich eigentlich etwas angenehmer, da man sich dann in einer Formelwelt aufhält mehr dazu dann im <span class="co">[</span><span class="ot">Kapitel zu gemischten Modellen</span><span class="co">](#sec-mixed)</span>. Also die Ergebnisse sind die Gleichen. Ich brauche es nur als Referenz für mich zum nachschlagen.</span>
<span id="cb80-1060"><a href="#cb80-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1063"><a href="#cb80-1063" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-1064"><a href="#cb80-1064" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-1065"><a href="#cb80-1065" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-1066"><a href="#cb80-1066" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb80-1067"><a href="#cb80-1067" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_4</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> workout <span class="sc">*</span> time_fct <span class="sc">+</span> </span>
<span id="cb80-1068"><a href="#cb80-1068" aria-hidden="true" tabindex="-1"></a>        (feeding <span class="sc">*</span> workout <span class="sc">*</span> time_fct<span class="sc">|</span>.id), </span>
<span id="cb80-1069"><a href="#cb80-1069" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> repeated_fac3_tbl)</span>
<span id="cb80-1070"><a href="#cb80-1070" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-1071"><a href="#cb80-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1072"><a href="#cb80-1072" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{MANOVA.RM}`</span></span>
<span id="cb80-1073"><a href="#cb80-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1074"><a href="#cb80-1074" aria-hidden="true" tabindex="-1"></a>Am Ende dann noch die Funktion <span class="in">`RM()`</span> aus dem R Paket. Erstmal erhalten wir auch hier weder drei statistische Tests, obwohl wir nur nach einem gefragt haben. Ich würde auch hier nur die Ausgabe von <span class="in">`ANOVA-Type Statistic (ATS)`</span> betrachten. Auch hier sehen wir, dass wir in einem dreifaktoriellen Fall die ähnlichen Werte wie in den anderen R Paketen erhalten. Je mehr Faktoren wir haben desto stärker werden dann auch die Unterschiede, da natürlich auch mehr Parameter geschätzt werden müssen. Hier haben wir dann aber noch mehr Informationen, die wir dann brauchen oder auch nicht. Ich habe dann einmal hier die Anzeige der Funktion ausgeschaltet, da hier der Output dann sehr lang wird. Du kannst dir beispielhaft die Ausgabe einmal bei der einfaktoriellen repeated ANOVA weiter oben einmal anschauen oder eben den Code selber einmal durchführen.</span>
<span id="cb80-1075"><a href="#cb80-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1078"><a href="#cb80-1078" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-1079"><a href="#cb80-1079" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-1080"><a href="#cb80-1080" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-1081"><a href="#cb80-1081" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb80-1082"><a href="#cb80-1082" aria-hidden="true" tabindex="-1"></a><span class="fu">RM</span>(jump_length <span class="sc">~</span> feeding <span class="sc">*</span> workout <span class="sc">*</span> time_fct, <span class="at">data =</span> repeated_fac3_tbl, </span>
<span id="cb80-1083"><a href="#cb80-1083" aria-hidden="true" tabindex="-1"></a>   <span class="at">subject =</span> <span class="st">".id"</span>, <span class="at">within =</span> <span class="fu">c</span>(<span class="st">"feeding"</span>, <span class="st">"workout"</span>, <span class="st">"time_fct"</span>), <span class="at">iter =</span> <span class="dv">100</span>, </span>
<span id="cb80-1084"><a href="#cb80-1084" aria-hidden="true" tabindex="-1"></a>   <span class="at">resampling =</span> <span class="st">"Perm"</span>, <span class="at">seed =</span> <span class="dv">1234</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-1085"><a href="#cb80-1085" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb80-1086"><a href="#cb80-1086" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-1087"><a href="#cb80-1087" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb80-1088"><a href="#cb80-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1089"><a href="#cb80-1089" aria-hidden="true" tabindex="-1"></a>Damit haben wir es dann auch geschafft. Was ist noch kommt sind die Anwendungsbeispiele in der mixed ANOVA. Ich habe noch keine Daten für eine repeated ANOVA bei mir liegen, daher warte ich hier mal ab, was noch kommt. Die beiden Beispiele zeigen aber einmal schön wie du eine zweifaktorielle mixed ANOVA rechnen kannst sowie eine dreifaktorielle mixed ANOVA. In beiden Fällen habe ich dann noch den Posthoc-Test in <span class="in">`{emmeans}`</span> ergänzt. Ich nutze hier einmal die Funktionen aus dem R Paket <span class="in">`{afex}`</span> aber du kannst auch ein anderes Paket oder <span class="in">`aov()`</span> nutzen.</span>
<span id="cb80-1090"><a href="#cb80-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1091"><a href="#cb80-1091" aria-hidden="true" tabindex="-1"></a>:::: callout-tip</span>
<span id="cb80-1092"><a href="#cb80-1092" aria-hidden="true" tabindex="-1"></a><span class="fu">## Anwendungsbeispiel: Gurkenwachstum (2-faktorielle mixed ANOVA)</span></span>
<span id="cb80-1093"><a href="#cb80-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1094"><a href="#cb80-1094" aria-hidden="true" tabindex="-1"></a>In diesem beispiel wollen wir uns einmal das Gurkenwachstum anschauen. Wir haben dazu drei Gurkensorten Proloog, Quarto und Katrina vorliegen. Wir lassen jeweils sechs Gurken pro Sorte über vierzehn Wochen wachsen. Wir messen dabei jede Woche einmal die Länge von Gurken sowie deren Durchmesser. Hier kommt natürlich die Frage auf, welche Gurken messen wir eigentlich und so eine Pflanze hat ja auch mehrere Gurken. Das lassen wir hier mal im Raum stehen, wir haben einfach eine Gurken, die immer länger werden. Wir laden erstmal die Daten ein und nehmen aber nur die Sorten <span class="in">`group`</span> und die Messzeitpunkte mit in die Analyse.</span>
<span id="cb80-1095"><a href="#cb80-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1098"><a href="#cb80-1098" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-1099"><a href="#cb80-1099" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-1100"><a href="#cb80-1100" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-1101"><a href="#cb80-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1102"><a href="#cb80-1102" aria-hidden="true" tabindex="-1"></a>gurke_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/wachstum_gurke.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-1103"><a href="#cb80-1103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb80-1104"><a href="#cb80-1104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">group =</span> versuchsgruppe, t1<span class="sc">:</span>t14) <span class="sc">|&gt;</span></span>
<span id="cb80-1105"><a href="#cb80-1105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">as_factor</span>(group)) </span>
<span id="cb80-1106"><a href="#cb80-1106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-1107"><a href="#cb80-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1108"><a href="#cb80-1108" aria-hidden="true" tabindex="-1"></a>In der folgenden Tabelle siehst du dann nochmal einen Ausschnitt aus den Daten. Wir werden jetzt gleich nur nach der Länge <span class="in">`L`</span> filtern und auch die Daten aus dem Wide-Format in das Long-Format überführen.</span>
<span id="cb80-1109"><a href="#cb80-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1112"><a href="#cb80-1112" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-1113"><a href="#cb80-1113" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-1114"><a href="#cb80-1114" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb80-1115"><a href="#cb80-1115" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Datensatz zu dem Längen- und Dickenwachstum von Gurken. Hier sind nur die Messzeitpunkte `t1` bis `t4` dargestellt."</span></span>
<span id="cb80-1116"><a href="#cb80-1116" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-anwendung-gurke</span></span>
<span id="cb80-1117"><a href="#cb80-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1118"><a href="#cb80-1118" aria-hidden="true" tabindex="-1"></a>gurke_raw_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/wachstum_gurke.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-1119"><a href="#cb80-1119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb80-1120"><a href="#cb80-1120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">group =</span> versuchsgruppe, t1<span class="sc">:</span>t4) <span class="sc">|&gt;</span></span>
<span id="cb80-1121"><a href="#cb80-1121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">2</span>)</span>
<span id="cb80-1122"><a href="#cb80-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1123"><a href="#cb80-1123" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(gurke_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>),</span>
<span id="cb80-1124"><a href="#cb80-1124" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(gurke_raw_tbl)),</span>
<span id="cb80-1125"><a href="#cb80-1125" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(gurke_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb80-1126"><a href="#cb80-1126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tt</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">align =</span> <span class="st">"c"</span>, <span class="at">theme =</span> <span class="st">"striped"</span>)</span>
<span id="cb80-1127"><a href="#cb80-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1128"><a href="#cb80-1128" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-1129"><a href="#cb80-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1130"><a href="#cb80-1130" aria-hidden="true" tabindex="-1"></a>Die Längen werden mit einem <span class="in">`L`</span> hinter dem Sortennamen angezeigt und der Durchmesser mit einem <span class="in">`D`</span> hinter der Sorte. Deshalb filtern wir hier gleich mal nur die Daten mit den Gurkenlängen raus. Dann bauen wir uns noch einen Faktor mit den entsprechenden Namen. Die Daten brauchen wir noch im Long-Format und dazu nutze ich dann die Funktion <span class="in">`pivot_longer()`</span>. Am Ende möchte ich immer nochmal die Zeitpunkte als Faktor sowie numerisch. Manchmal ist das eine einfacher in <span class="in">`{ggplot}`</span> abzubilden als das andere.</span>
<span id="cb80-1131"><a href="#cb80-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1134"><a href="#cb80-1134" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-1135"><a href="#cb80-1135" aria-hidden="true" tabindex="-1"></a>gurke_time_len_tbl <span class="ot">&lt;-</span> gurke_tbl <span class="sc">|&gt;</span> </span>
<span id="cb80-1136"><a href="#cb80-1136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(group, <span class="st">"L$"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb80-1137"><a href="#cb80-1137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">".id"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-1138"><a href="#cb80-1138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">factor</span>(group, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Proloog"</span>, <span class="st">"Quarto"</span>, <span class="st">"Katrina"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb80-1139"><a href="#cb80-1139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> t1<span class="sc">:</span>t14,</span>
<span id="cb80-1140"><a href="#cb80-1140" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"length"</span>,</span>
<span id="cb80-1141"><a href="#cb80-1141" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"time"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-1142"><a href="#cb80-1142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time_fct =</span> <span class="fu">as_factor</span>(time),</span>
<span id="cb80-1143"><a href="#cb80-1143" aria-hidden="true" tabindex="-1"></a>         <span class="at">time_num =</span> <span class="fu">as.numeric</span>(time_fct)) <span class="sc">|&gt;</span> </span>
<span id="cb80-1144"><a href="#cb80-1144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(length <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb80-1145"><a href="#cb80-1145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-1146"><a href="#cb80-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1147"><a href="#cb80-1147" aria-hidden="true" tabindex="-1"></a>Dann kommen wir auch schon zur visuellen Darstellung der Daten. Hier habe ich dann einmal über alle vierzehn Zeitpunkte die mittlere Länge sowie die mediane Länge dargestellt. Die einzelnen Punkte stellen die einzelnen Beobachtungen dar. Hier fällt auf, dass eventuell einzelne Gurken eine etwas seltsames Längenwachstum haben. Wir würden ja davon ausgehen, dass eine Gurke wächst über die Zeit und nicht schrumpft. Am Ende sehen wir noch, dass die letzten Wochen nicht mehr vollständig bemessen wurden. Hier mag es dann Sinn machen, die letzten Wochen bis Woche <span class="in">`t12`</span> zu entfernen. Dann haben wir einen besseren Datensatz.</span>
<span id="cb80-1148"><a href="#cb80-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1151"><a href="#cb80-1151" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-1152"><a href="#cb80-1152" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb80-1153"><a href="#cb80-1153" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-1154"><a href="#cb80-1154" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-1155"><a href="#cb80-1155" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-anwendung-gurke-01</span></span>
<span id="cb80-1156"><a href="#cb80-1156" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb80-1157"><a href="#cb80-1157" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb80-1158"><a href="#cb80-1158" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb80-1159"><a href="#cb80-1159" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Scatterplot des Längenwachstums der drei Gurkensorten über vierzehn Wochen. Die gestrichtelten Linien stellen den Median und die durchgezogene Line den Mittelwert der Gruppen dar."</span></span>
<span id="cb80-1160"><a href="#cb80-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1161"><a href="#cb80-1161" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gurke_time_len_tbl, </span>
<span id="cb80-1162"><a href="#cb80-1162" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(time_fct, length, <span class="at">color =</span> group, </span>
<span id="cb80-1163"><a href="#cb80-1163" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb80-1164"><a href="#cb80-1164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb80-1165"><a href="#cb80-1165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point2</span>() <span class="sc">+</span></span>
<span id="cb80-1166"><a href="#cb80-1166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb80-1167"><a href="#cb80-1167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"median"</span>, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb80-1168"><a href="#cb80-1168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb80-1169"><a href="#cb80-1169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)<span class="sc">+</span></span>
<span id="cb80-1170"><a href="#cb80-1170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Zeitpunkte der Messung"</span>, <span class="at">y =</span> <span class="st">"Gurkenlänge [cm]"</span>,</span>
<span id="cb80-1171"><a href="#cb80-1171" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Sorte"</span>)</span>
<span id="cb80-1172"><a href="#cb80-1172" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-1173"><a href="#cb80-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1174"><a href="#cb80-1174" aria-hidden="true" tabindex="-1"></a>Um die einzelnen Gurkenpflanzen besser zu verstehen, habe ich einmal die Pflanzen einzeln als Verlauf über die Zeit dargestellt. Hier sehen wir dann wirklich einige seltsame Pflanzen. Ich habe hier nochmal über die Funktion <span class="in">`geom_label_repel()`</span> die IDs der einzelnen Pflanzen zu den Verläufen ergänzt. Ich habe mir dann noch die Mühe gemacht, die Werte dann auch immer an den letzten Zeitpunkt zu schreiben. Wir sehen sehr schön, dass mit der Pflanze 2 irgendwas nicht stimmt. Die Gurkenpflanze 2 wächst nämlich nicht sondern schrumpft über die Zeit.</span>
<span id="cb80-1175"><a href="#cb80-1175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1178"><a href="#cb80-1178" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-1179"><a href="#cb80-1179" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb80-1180"><a href="#cb80-1180" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-1181"><a href="#cb80-1181" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-1182"><a href="#cb80-1182" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-anwendung-gurke-02</span></span>
<span id="cb80-1183"><a href="#cb80-1183" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb80-1184"><a href="#cb80-1184" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb80-1185"><a href="#cb80-1185" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb80-1186"><a href="#cb80-1186" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Scatterplot des Längenwachstums der drei Gurkensorten über vierzehn Wochen für das individuelle Wachstum der einzelnen Gurken. Die Label am Ende des Wachstums stellen die Pflanzen IDs dar."</span></span>
<span id="cb80-1187"><a href="#cb80-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1188"><a href="#cb80-1188" aria-hidden="true" tabindex="-1"></a>max_time_tbl <span class="ot">&lt;-</span> gurke_time_len_tbl <span class="sc">|&gt;</span> </span>
<span id="cb80-1189"><a href="#cb80-1189" aria-hidden="true" tabindex="-1"></a> <span class="fu">group_by</span>(group, .id) <span class="sc">|&gt;</span> </span>
<span id="cb80-1190"><a href="#cb80-1190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(time_num <span class="sc">==</span> <span class="fu">max</span>(time_num))</span>
<span id="cb80-1191"><a href="#cb80-1191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1192"><a href="#cb80-1192" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gurke_time_len_tbl, </span>
<span id="cb80-1193"><a href="#cb80-1193" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(time_fct, <span class="fu">log</span>(length), <span class="at">color =</span> group, </span>
<span id="cb80-1194"><a href="#cb80-1194" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> .id)) <span class="sc">+</span></span>
<span id="cb80-1195"><a href="#cb80-1195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb80-1196"><a href="#cb80-1196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point2</span>() <span class="sc">+</span></span>
<span id="cb80-1197"><a href="#cb80-1197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb80-1198"><a href="#cb80-1198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label_repel</span>(<span class="at">data =</span> max_time_tbl, <span class="fu">aes</span>(time_fct, <span class="fu">log</span>(length), <span class="at">label =</span> .id),              </span>
<span id="cb80-1199"><a href="#cb80-1199" aria-hidden="true" tabindex="-1"></a>    <span class="at">box.padding =</span> <span class="fu">unit</span>(<span class="fl">0.35</span>, <span class="st">"lines"</span>), <span class="at">point.padding =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"lines"</span>),</span>
<span id="cb80-1200"><a href="#cb80-1200" aria-hidden="true" tabindex="-1"></a>    <span class="at">segment.color =</span> <span class="st">'grey50'</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb80-1201"><a href="#cb80-1201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb80-1202"><a href="#cb80-1202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb80-1203"><a href="#cb80-1203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)<span class="sc">+</span></span>
<span id="cb80-1204"><a href="#cb80-1204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Zeitpunkte der Messung"</span>, <span class="at">y =</span> <span class="st">"Gurkenlänge [cm] (log-scale)"</span>,</span>
<span id="cb80-1205"><a href="#cb80-1205" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Sorte"</span>)</span>
<span id="cb80-1206"><a href="#cb80-1206" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-1207"><a href="#cb80-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1208"><a href="#cb80-1208" aria-hidden="true" tabindex="-1"></a>Dann können wir auch schon mit der Analyse der Daten mit einer mixed ANOVA beginnen. Je nachdem welche Schreibweise der Modelle in der ANOVA du bevorzugst, kannst du zwischen den beiden Funktionen <span class="in">`aov_car()`</span> und <span class="in">`aov_4()`</span> wählen. Ich habe hier für mich beide Formen einmal dargestellt. In beiden Fällen kommt das Gleiche raus, es geht eben nur um die Form der Darstellung der Modelle.</span>
<span id="cb80-1209"><a href="#cb80-1209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1210"><a href="#cb80-1210" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb80-1211"><a href="#cb80-1211" aria-hidden="true" tabindex="-1"></a><span class="fu">## `aov_car()`</span></span>
<span id="cb80-1212"><a href="#cb80-1212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1213"><a href="#cb80-1213" aria-hidden="true" tabindex="-1"></a>In dem Modell für R <span class="in">`{base}`</span> nutzen wir die Schreibweise mit der Funktion <span class="in">`Error()`</span> um den Fehlerterm und die Abhängigkeiten in dem Fehlerterm anzugeben. Hier haben wir die einzelnen Beobachtungen <span class="in">`.id`</span> wiederholt in den Messzeitpunkten <span class="in">`time_fct`</span> gemessen.</span>
<span id="cb80-1214"><a href="#cb80-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1217"><a href="#cb80-1217" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-1218"><a href="#cb80-1218" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-1219"><a href="#cb80-1219" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-1220"><a href="#cb80-1220" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(length <span class="sc">~</span> group <span class="sc">*</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>time_fct), </span>
<span id="cb80-1221"><a href="#cb80-1221" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> gurke_time_len_tbl)</span>
<span id="cb80-1222"><a href="#cb80-1222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-1223"><a href="#cb80-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1224"><a href="#cb80-1224" aria-hidden="true" tabindex="-1"></a>Was sehen wir? Alle Faktoren und die Interaktion sind signifikant, da der p-Wert kleiner ist als das Signifikanzniveau $\alpha$ gleich 5%. Im Weiteren sehen wir auch, dass die Effekte in der Spalte <span class="in">`ges`</span> als Eta$^2$ für die Versuchsgruppen sowie für die Zeit stark sind. Auch die Interaktion hat einen bedeutenden Effekt. Das wundert uns nicht, da wir ja Gurken haben, die über die Zeit weniger wachsen als alle anderen Gurken. Die Interaktion siehst du dann ganz gut an der Gurke Nr. 2 sowie an anderen Gurken gegen Ende der Untersuchung.</span>
<span id="cb80-1225"><a href="#cb80-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1226"><a href="#cb80-1226" aria-hidden="true" tabindex="-1"></a><span class="fu">## `aov_4`</span></span>
<span id="cb80-1227"><a href="#cb80-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1228"><a href="#cb80-1228" aria-hidden="true" tabindex="-1"></a>In dem Modell für R nach dem R Paket <span class="in">`{lme4}`</span> und anderen Paketen nutzen wir die Schreibweise mit den Klammern <span class="in">`()`</span> und dem Strich <span class="in">`|`</span> um den Fehlerterm und die Abhängigkeiten in dem Fehlerterm anzugeben. Hier haben wir die einzelnen Beobachtungen <span class="in">`.id`</span> wiederholt in den Messzeitpunkten <span class="in">`time_fct`</span> gemessen.</span>
<span id="cb80-1229"><a href="#cb80-1229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1232"><a href="#cb80-1232" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-1233"><a href="#cb80-1233" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-1234"><a href="#cb80-1234" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-1235"><a href="#cb80-1235" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_4</span>(length <span class="sc">~</span> group <span class="sc">*</span> time_fct <span class="sc">+</span> (time_fct<span class="sc">|</span>.id), </span>
<span id="cb80-1236"><a href="#cb80-1236" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> gurke_time_len_tbl)</span>
<span id="cb80-1237"><a href="#cb80-1237" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-1238"><a href="#cb80-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1239"><a href="#cb80-1239" aria-hidden="true" tabindex="-1"></a>Für die Interpretation bitte den Tab zu der Funktion <span class="in">`aov_car()`</span> beachten. Die Ausgaben sind die gleichen numerischen Werte und da beschreibe ich das für dich dann nur einmal.</span>
<span id="cb80-1240"><a href="#cb80-1240" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb80-1241"><a href="#cb80-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1242"><a href="#cb80-1242" aria-hidden="true" tabindex="-1"></a>Am Ende wollen wir dann noch die paarweisen Vergleich in <span class="in">`{emmeans}`</span> rechnen. Dazu können wir dann direkt das Modell aus <span class="in">`aov_car()`</span> nutzen und uns alle paarweisen Vergleiche *getrennt* für die Zeitpunkte wiedergeben lassen. Ändere einfach den Stich `|` durch einen Stern `*`, wenn du über alle Zeitpunkte hinweg vergleichen willst.</span>
<span id="cb80-1243"><a href="#cb80-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1244"><a href="#cb80-1244" aria-hidden="true" tabindex="-1"></a>Es kommt jetzt ein riesiger Wust an Ausgabe. Am Ende können wir dann aber an jedem Zeitpunkt schauen, ob sich die drei Linien voneinander unterscheiden. Wir hätten hier natürlich nochmal die Daten aufreinigen müssen. Die Aufreinigung würde dann aber hier das Beispiel im Umfang sprengen. Auch habe ich hier auf eine Adjustierung der p-Werte verzichtet. Deshalb hier nur einmal die schnelle Analyse.</span>
<span id="cb80-1245"><a href="#cb80-1245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1248"><a href="#cb80-1248" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-1249"><a href="#cb80-1249" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-1250"><a href="#cb80-1250" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-1251"><a href="#cb80-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1252"><a href="#cb80-1252" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(length <span class="sc">~</span> group <span class="sc">*</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>time_fct), </span>
<span id="cb80-1253"><a href="#cb80-1253" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> gurke_time_len_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb80-1254"><a href="#cb80-1254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> group <span class="sc">|</span> time_fct) <span class="sc">|&gt;</span> </span>
<span id="cb80-1255"><a href="#cb80-1255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>)</span>
<span id="cb80-1256"><a href="#cb80-1256" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-1257"><a href="#cb80-1257" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb80-1258"><a href="#cb80-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1259"><a href="#cb80-1259" aria-hidden="true" tabindex="-1"></a>:::: callout-tip</span>
<span id="cb80-1260"><a href="#cb80-1260" aria-hidden="true" tabindex="-1"></a><span class="fu">## Anwendungsbeispiel: Grünkohlhöhe (3-faktorielle mixed ANOVA)</span></span>
<span id="cb80-1261"><a href="#cb80-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1262"><a href="#cb80-1262" aria-hidden="true" tabindex="-1"></a>Im nächsten Beispiel schauen wir uns einmal die Höhe von Grünkohl an. Wir haben hier zwei Arten von Lichtgabe sowie zwei Sorten vorliegen. Dann messen wir die Höhe des Grünkohls noch an sieben Terminen. Daher haben wir hier wirklich mal eine dreifaktorielle ANOVA vorliegen. Da unsere beiden Behandlungsfaktoren nur zwei Level haben, können wir hier fast auf einen Post-hoc Test verzichten. Wir brauchen den Post-hoc Test aber dann für die Vergleiche in den jeweiligen Zeitpunkten. Wir laden also unseren Datensatz und nehmen nur die Wachstumsdaten mit den sieben Zeitpunkten.</span>
<span id="cb80-1263"><a href="#cb80-1263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1266"><a href="#cb80-1266" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-1267"><a href="#cb80-1267" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-1268"><a href="#cb80-1268" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-1269"><a href="#cb80-1269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1270"><a href="#cb80-1270" aria-hidden="true" tabindex="-1"></a>kale_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/kale_time_height.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-1271"><a href="#cb80-1271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb80-1272"><a href="#cb80-1272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(light, variety, t1<span class="sc">:</span>t7) <span class="sc">|&gt;</span></span>
<span id="cb80-1273"><a href="#cb80-1273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">light =</span> <span class="fu">as_factor</span>(light),</span>
<span id="cb80-1274"><a href="#cb80-1274" aria-hidden="true" tabindex="-1"></a>         <span class="at">variety =</span> <span class="fu">as_factor</span>(variety)) </span>
<span id="cb80-1275"><a href="#cb80-1275" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-1276"><a href="#cb80-1276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1277"><a href="#cb80-1277" aria-hidden="true" tabindex="-1"></a>Dann hier einmal der Auszug aus den Daten zu dem Wachstum des Grünkohls. Ich habe hier nur die ersten vier Zeitpunkte ausgewählt. Wir müssen dann gleich einmal die Daten von dem Wide-Format in das Long-Format überführen. Für die Betrachtung ist es natütlich so schöner.</span>
<span id="cb80-1278"><a href="#cb80-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1281"><a href="#cb80-1281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-1282"><a href="#cb80-1282" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-1283"><a href="#cb80-1283" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb80-1284"><a href="#cb80-1284" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Datensatz zu dem Höhenwachstum von Grünkohl. Hier sind nur die Messzeitpunkte `t1` bis `t4` dargestellt."</span></span>
<span id="cb80-1285"><a href="#cb80-1285" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-anwendung-kale</span></span>
<span id="cb80-1286"><a href="#cb80-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1287"><a href="#cb80-1287" aria-hidden="true" tabindex="-1"></a>kale_raw_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/kale_time_height.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-1288"><a href="#cb80-1288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb80-1289"><a href="#cb80-1289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(light, variety, t1<span class="sc">:</span>t4) <span class="sc">|&gt;</span></span>
<span id="cb80-1290"><a href="#cb80-1290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">2</span>)</span>
<span id="cb80-1291"><a href="#cb80-1291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1292"><a href="#cb80-1292" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(kale_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>),</span>
<span id="cb80-1293"><a href="#cb80-1293" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(kale_raw_tbl)),</span>
<span id="cb80-1294"><a href="#cb80-1294" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(kale_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb80-1295"><a href="#cb80-1295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tt</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">align =</span> <span class="st">"c"</span>, <span class="at">theme =</span> <span class="st">"striped"</span>)</span>
<span id="cb80-1296"><a href="#cb80-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1297"><a href="#cb80-1297" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-1298"><a href="#cb80-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1299"><a href="#cb80-1299" aria-hidden="true" tabindex="-1"></a>Es fehlen in den Daten noch die IDs für die einzelnen Grünkohlpflanzen. Das holen wir dann durch die Funktion <span class="in">`rownames_to_column()`</span> einmal nach. Dann müssen wir noch die Daten in das Long-Format mit der Funktion <span class="in">`pivot_longer()`</span> überführen.</span>
<span id="cb80-1300"><a href="#cb80-1300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1303"><a href="#cb80-1303" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-1304"><a href="#cb80-1304" aria-hidden="true" tabindex="-1"></a>kale_time_height_tbl <span class="ot">&lt;-</span> kale_tbl <span class="sc">|&gt;</span> </span>
<span id="cb80-1305"><a href="#cb80-1305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">".id"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-1306"><a href="#cb80-1306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> t1<span class="sc">:</span>t7,</span>
<span id="cb80-1307"><a href="#cb80-1307" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"height"</span>,</span>
<span id="cb80-1308"><a href="#cb80-1308" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"time"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-1309"><a href="#cb80-1309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time_fct =</span> <span class="fu">as_factor</span>(time),</span>
<span id="cb80-1310"><a href="#cb80-1310" aria-hidden="true" tabindex="-1"></a>         <span class="at">time_num =</span> <span class="fu">as.numeric</span>(time_fct)) </span>
<span id="cb80-1311"><a href="#cb80-1311" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-1312"><a href="#cb80-1312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1313"><a href="#cb80-1313" aria-hidden="true" tabindex="-1"></a>Dann schauen wir uns in der folgenden Abbildung einmal die individuellen Verläufe des Höhenwachstums der Grünkohlpflanzen an. Wir sehen, dass die Pflanzen sehr schön und gleichmäßig wachsen. Hier gibt es keine Pflanze, die besonders auffällt und daher selektiert werden müsste.</span>
<span id="cb80-1314"><a href="#cb80-1314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1317"><a href="#cb80-1317" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-1318"><a href="#cb80-1318" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb80-1319"><a href="#cb80-1319" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-1320"><a href="#cb80-1320" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-1321"><a href="#cb80-1321" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-anwendung-kale-02</span></span>
<span id="cb80-1322"><a href="#cb80-1322" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb80-1323"><a href="#cb80-1323" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb80-1324"><a href="#cb80-1324" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb80-1325"><a href="#cb80-1325" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Scatterplot der Grünkohlhöhe für die beiden Lichtarten und Sorten über sieben Wochen für die individuellen Grünkohlpflanzen."</span></span>
<span id="cb80-1326"><a href="#cb80-1326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1327"><a href="#cb80-1327" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(kale_time_height_tbl, </span>
<span id="cb80-1328"><a href="#cb80-1328" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(time_fct, height, <span class="at">color =</span> light, <span class="at">linetype =</span> variety,</span>
<span id="cb80-1329"><a href="#cb80-1329" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> .id)) <span class="sc">+</span></span>
<span id="cb80-1330"><a href="#cb80-1330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb80-1331"><a href="#cb80-1331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb80-1332"><a href="#cb80-1332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb80-1333"><a href="#cb80-1333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)<span class="sc">+</span></span>
<span id="cb80-1334"><a href="#cb80-1334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Zeitpunkte der Messung"</span>, <span class="at">y =</span> <span class="st">"Höhe Grünkohl [cm]"</span>,</span>
<span id="cb80-1335"><a href="#cb80-1335" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Licht"</span>, <span class="at">linetype =</span> <span class="st">"Sorte"</span>)</span>
<span id="cb80-1336"><a href="#cb80-1336" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-1337"><a href="#cb80-1337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1338"><a href="#cb80-1338" aria-hidden="true" tabindex="-1"></a>Nachdem wir die einzelnen Pflanzen angeschaut haben, können wir auch einmal für die vier Faktorkombinationen aus den zwei Lichtarten und den zwei Sorten einmal die Verläufe anschauen. Ich betrachte dann hier einmal die Mittelwerte. Wir sehen auch hier eine leichte Interaktion. Die Gerade laufen über die Zeit immer weiter auseinander. Auch sehen wir leichte Überschneidungen bei den ersten Zeitpunkten. Das mag dann auch zu einer signifikanten Interaktion führen.</span>
<span id="cb80-1339"><a href="#cb80-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1342"><a href="#cb80-1342" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-1343"><a href="#cb80-1343" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb80-1344"><a href="#cb80-1344" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-1345"><a href="#cb80-1345" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-1346"><a href="#cb80-1346" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-anwendung-kale-01</span></span>
<span id="cb80-1347"><a href="#cb80-1347" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb80-1348"><a href="#cb80-1348" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb80-1349"><a href="#cb80-1349" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb80-1350"><a href="#cb80-1350" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Scatterplot der Grünkohlhöhe für die beiden Lichtarten und Sorten über sieben Wochen. Die Linien stellen den Mittelwert der Faktorkombinationen dar."</span></span>
<span id="cb80-1351"><a href="#cb80-1351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1352"><a href="#cb80-1352" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(kale_time_height_tbl, </span>
<span id="cb80-1353"><a href="#cb80-1353" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(time_fct, height, <span class="at">color =</span> light, <span class="at">linetype =</span> variety,</span>
<span id="cb80-1354"><a href="#cb80-1354" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> variety,</span>
<span id="cb80-1355"><a href="#cb80-1355" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> <span class="fu">interaction</span>(light, variety))) <span class="sc">+</span></span>
<span id="cb80-1356"><a href="#cb80-1356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb80-1357"><a href="#cb80-1357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb80-1358"><a href="#cb80-1358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb80-1359"><a href="#cb80-1359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb80-1360"><a href="#cb80-1360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)<span class="sc">+</span></span>
<span id="cb80-1361"><a href="#cb80-1361" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Zeitpunkte der Messung"</span>, <span class="at">y =</span> <span class="st">"Höhe Grünkohl [cm]"</span>,</span>
<span id="cb80-1362"><a href="#cb80-1362" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Licht"</span>, <span class="at">shape =</span> <span class="st">"Sorte"</span>, <span class="at">linetype =</span> <span class="st">"Sorte"</span>) </span>
<span id="cb80-1363"><a href="#cb80-1363" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-1364"><a href="#cb80-1364" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-1365"><a href="#cb80-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1366"><a href="#cb80-1366" aria-hidden="true" tabindex="-1"></a>Dann können wir auch schon mit der Analyse der Daten mit einer mixed ANOVA beginnen. Je nachdem welche Schreibweise der Modelle in der ANOVA du bevorzugst, kannst du zwischen den beiden Funktionen <span class="in">`aov_car()`</span> und <span class="in">`aov_4()`</span> wählen. Ich habe hier für mich beide Formen einmal dargestellt. In beiden Fällen kommt das Gleiche raus, es geht eben nur um die Form der Darstellung der Modelle.</span>
<span id="cb80-1367"><a href="#cb80-1367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1368"><a href="#cb80-1368" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb80-1369"><a href="#cb80-1369" aria-hidden="true" tabindex="-1"></a><span class="fu">## `aov_car()`</span></span>
<span id="cb80-1370"><a href="#cb80-1370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1371"><a href="#cb80-1371" aria-hidden="true" tabindex="-1"></a>In dem Modell für R <span class="in">`{base}`</span> nutzen wir die Schreibweise mit der Funktion <span class="in">`Error()`</span> um den Fehlerterm und die Abhängigkeiten in dem Fehlerterm anzugeben. Hier haben wir die einzelnen Beobachtungen <span class="in">`.id`</span> wiederholt in den Messzeitpunkten <span class="in">`time_fct`</span> gemessen.</span>
<span id="cb80-1372"><a href="#cb80-1372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1375"><a href="#cb80-1375" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-1376"><a href="#cb80-1376" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-1377"><a href="#cb80-1377" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-1378"><a href="#cb80-1378" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(height <span class="sc">~</span> light <span class="sc">*</span> variety <span class="sc">*</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>time_fct), </span>
<span id="cb80-1379"><a href="#cb80-1379" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> kale_time_height_tbl)</span>
<span id="cb80-1380"><a href="#cb80-1380" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-1381"><a href="#cb80-1381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1382"><a href="#cb80-1382" aria-hidden="true" tabindex="-1"></a>Wenn wir die p-Werte betrachten, dann haben wir einen signifikanten Effekt der beiden Lichtarten. Die Sorten sind nur gerade noch so signifikant. Hier müsste man nochmal schauen, da der p-Wert doch recht nahe am Signifikanzniveau $\alpha$ von 5% liegt. Die Zeit ist signifikant, aber das überrascht nicht, denn die Pflanzen wachsen ja über die Zeit. Es gibt keine Interaktion zwischen den beiden Hauptfaktoren. Dafür dann aber bei der Lichtart und der Zeit. Hier werden wir nochmal in extra nachschauen.</span>
<span id="cb80-1383"><a href="#cb80-1383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1384"><a href="#cb80-1384" aria-hidden="true" tabindex="-1"></a><span class="fu">## `aov_4`</span></span>
<span id="cb80-1385"><a href="#cb80-1385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1386"><a href="#cb80-1386" aria-hidden="true" tabindex="-1"></a>In dem Modell für R nach dem R Paket <span class="in">`{lme4}`</span> und anderen Paketen nutzen wir die Schreibweise mit den Klammern <span class="in">`()`</span> und dem Strich <span class="in">`|`</span> um den Fehlerterm und die Abhängigkeiten in dem Fehlerterm anzugeben. Hier haben wir die einzelnen Beobachtungen <span class="in">`.id`</span> wiederholt in den Messzeitpunkten <span class="in">`time_fct`</span> gemessen.</span>
<span id="cb80-1387"><a href="#cb80-1387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1390"><a href="#cb80-1390" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-1391"><a href="#cb80-1391" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-1392"><a href="#cb80-1392" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-1393"><a href="#cb80-1393" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_4</span>(height <span class="sc">~</span> light <span class="sc">*</span> variety <span class="sc">*</span> time_fct <span class="sc">+</span> (time_fct<span class="sc">|</span>.id), </span>
<span id="cb80-1394"><a href="#cb80-1394" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> kale_time_height_tbl)</span>
<span id="cb80-1395"><a href="#cb80-1395" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-1396"><a href="#cb80-1396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1397"><a href="#cb80-1397" aria-hidden="true" tabindex="-1"></a>Für die Interpretation bitte den Tab zu der Funktion <span class="in">`aov_car()`</span> beachten. Die Ausgaben sind die gleichen numerischen Werte und da beschreibe ich das für dich dann nur einmal.</span>
<span id="cb80-1398"><a href="#cb80-1398" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb80-1399"><a href="#cb80-1399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1400"><a href="#cb80-1400" aria-hidden="true" tabindex="-1"></a>Wir haben ja in der obigen Analyse eine signifikante Interaktion zwischen den Lichtarten und der Zeit gefunden. In der folgenden Abbildung will ich einmal anhand der Effektstärke schauen, wo die Interaktion herkommt. Ich entferne dafür immer einen weiteren Zeitpunkt aus der Analyse und schaue mir dann die Effektstärke Eta$^2$ an. Du siehst sehr schön, dass die Interaktion unbedeutender wird, je weiter ich in der Zeit voranschreite. Die Interaktion liegt also eher in den frühen Zeitpunkten als in den späten Zeitpunkten vor. Das ist jetzt nicht so schlecht, da mich ja auch eher die späten Zeitpunkte interessieren. Das frühe Wachstum ist eher biologisch nicht so interessant.</span>
<span id="cb80-1401"><a href="#cb80-1401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1404"><a href="#cb80-1404" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-1405"><a href="#cb80-1405" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb80-1406"><a href="#cb80-1406" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-1407"><a href="#cb80-1407" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-1408"><a href="#cb80-1408" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-anwendung-kale-03</span></span>
<span id="cb80-1409"><a href="#cb80-1409" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb80-1410"><a href="#cb80-1410" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb80-1411"><a href="#cb80-1411" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb80-1412"><a href="#cb80-1412" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Der Effektschätzer Eta$^2$ der Interaktion zeischen den Zeitpunkten und der Lichtstärke in Abhängigkeit der betrachteten Zeitpunkte. Insbesondere die frühen Zeitpunkte führen zu einem hohen Eta$^2$-Wert der Interaktion. Ohne die frühen Zeitpunkte fällt der Eta$^2$-Wert ab."</span></span>
<span id="cb80-1413"><a href="#cb80-1413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1414"><a href="#cb80-1414" aria-hidden="true" tabindex="-1"></a>eta_2_vec <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>, \(i) {</span>
<span id="cb80-1415"><a href="#cb80-1415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aov_car</span>(height <span class="sc">~</span> light <span class="sc">*</span> variety <span class="sc">*</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>time_fct), </span>
<span id="cb80-1416"><a href="#cb80-1416" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> <span class="fu">filter</span>(kale_time_height_tbl, time_num <span class="sc">&gt;</span> i)) <span class="sc">|&gt;</span> </span>
<span id="cb80-1417"><a href="#cb80-1417" aria-hidden="true" tabindex="-1"></a>    <span class="fu">eta_squared</span>(<span class="at">generalized =</span> <span class="st">"time_fct"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-1418"><a href="#cb80-1418" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Eta2_generalized) <span class="sc">|&gt;</span> </span>
<span id="cb80-1419"><a href="#cb80-1419" aria-hidden="true" tabindex="-1"></a>    <span class="fu">extract</span>(<span class="dv">5</span>)</span>
<span id="cb80-1420"><a href="#cb80-1420" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb80-1421"><a href="#cb80-1421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1422"><a href="#cb80-1422" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">time =</span> <span class="fu">as_factor</span>(<span class="fu">c</span>(<span class="st">"alle"</span>, <span class="st">"&gt;t1"</span>, <span class="st">"&gt;t2"</span>, <span class="st">"&gt;t3"</span>, <span class="st">"&gt;t4"</span>, <span class="st">"&gt;t5"</span>)),</span>
<span id="cb80-1423"><a href="#cb80-1423" aria-hidden="true" tabindex="-1"></a>       <span class="at">eta2 =</span> eta_2_vec) <span class="sc">|&gt;</span> </span>
<span id="cb80-1424"><a href="#cb80-1424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, eta2, <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb80-1425"><a href="#cb80-1425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb80-1426"><a href="#cb80-1426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb80-1427"><a href="#cb80-1427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb80-1428"><a href="#cb80-1428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Betrachtete Zeitpunkt"</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="st">"Eta"</span><span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb80-1429"><a href="#cb80-1429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1430"><a href="#cb80-1430" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-1431"><a href="#cb80-1431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1432"><a href="#cb80-1432" aria-hidden="true" tabindex="-1"></a>In unserem Fall ist der Posthoc-Test ja eigentlich mit nur zwei Lichtstärken und zwei Sorten nicht unbedingt nötig. Wenn du aber natürlich die Unterschiede für die einzelnen Zeitpunkte brauchst, dann kann dir hier <span class="in">`{emmeans}`</span> helfen. Wir gehen hier von Varianzhomogenität in den Zeitpunkten aus. Dafür modellieren wir dann über alle Zeitpunkte hinweg die Varianz. Irgendwas ist ja immer. Hier kann man sicherlich noch weiter optimieren und mal bei den <span class="co">[</span><span class="ot">gemischten Modellen</span><span class="co">](#sec-mixed)</span> vorbeischauen, aber für die Anwendung reicht diese Auswertung auf jeden Fall aus.</span>
<span id="cb80-1433"><a href="#cb80-1433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1436"><a href="#cb80-1436" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb80-1437"><a href="#cb80-1437" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb80-1438"><a href="#cb80-1438" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb80-1439"><a href="#cb80-1439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1440"><a href="#cb80-1440" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(height <span class="sc">~</span> light <span class="sc">*</span> variety <span class="sc">*</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(.id<span class="sc">/</span>time_fct), </span>
<span id="cb80-1441"><a href="#cb80-1441" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> kale_time_height_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb80-1442"><a href="#cb80-1442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> light <span class="sc">*</span> variety <span class="sc">|</span> time_fct, <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb80-1443"><a href="#cb80-1443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters)</span>
<span id="cb80-1444"><a href="#cb80-1444" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb80-1445"><a href="#cb80-1445" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb80-1446"><a href="#cb80-1446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1447"><a href="#cb80-1447" aria-hidden="true" tabindex="-1"></a><span class="fu">## Referenzen {.unnumbered}</span></span>
</code><button title="In die Zwischenablage kopieren" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Bio Data Science wurde von <a href="https://www.hs-osnabrueck.de/prof-dr-jochen-kruppa/">Jochen Kruppa-Scheetz</a> geschrieben.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-tests-anova-mixed.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-tests-anova-mixed.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Dieses Openbook wurde mit <a href="https://quarto.org/">Quarto</a> erstellt.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>
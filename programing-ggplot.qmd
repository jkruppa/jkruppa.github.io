# Ein `{ggplot}` Cookbook {#sec-ggplot-cookbook}

*Letzte Änderung am `r format(fs::file_info("programing-ggplot.qmd")$modification_time, '%d. %B %Y um %H:%M:%S')`*

```{r}
#| warning: false
#| echo: false
pacman::p_load(tidyverse, readxl, knitr, kableExtra, conflicted)
cb_pal <- c("#000000", "#E69F00", "#56B4E9", "#009E73", 
            "#F0E442", "#F5C710", "#0072B2", "#D55E00", "#CC79A7")
```

> *"Frei ist, wer missfallen kann." --- Annette Oschmann in [Mädchen stärken](https://www.annette-oschmann.de/maedchen-staerken/)*

![](images/caution.png){fig-align="center" width="100%"}

::: {.callout-caution appearance="simple"}
## Stand des Kapitels: Konzeption (seit 05.2025)

Dieses Kapitel wird in den nächsten Wochen geschrieben. Ich plane zu Ende des WiSe 2025/26 eine arbeitsfähige Version des Kapitels erstellt zu haben. Das Kapitel wird etappenweise geschrieben, daher bleibt hier alles soweit erstmal mehr oder minder funktional.
:::

Willkommen in einer weiteren wilden Linksammlung und R Code sowie einiges an interessanten R Paketen im Kontext der Visualisierung von Daten. Hier dreht sich dann fast alles um das R Paket `{ggplot}` und wie wir dieses R Paket sinnvoll nutzen können. Daher ist alles hier sehr stückhaft und manchmal einfach nur da. Das hat den Grund, dass ich das Kapitel hier eher als Steinbruch nutze als ein echtes Kapitel zum von oben nach unten Lesen. Sehe das Kapitel also eher als Referenzsammlung als ein Lernkapitel. Es lädt dann zum Stöbern ein. Es sind also eher kleine Rezepte in einem Kochbuch. Am Ende kommst du vermutlich aber nicht um @wickham2016r und [R for Data Science (2e)](https://r4ds.hadley.nz/) herum.

::: {.callout-caution collapse="true"}
## Was soll das hier? Was für ein Kochbuch?

![Quelle: <https://www.gocomics.com/garfield/1991/02/24>](images/programing/programming-garfield.png){#fig-math-cartoon fig-align="center" width="100%"}

Dieses Kapitel dient dazu Programmierung in `{ggplot}` zu präsentieren. Es ist eine Sammlung von Code und Rezepten, die ich immer mal wieder nutze und immer wieder vergesse. Deshalb hat dieses Kapitel auch den Titel *Cookbook*. Wenn dich also Rumfummeln in `{ggplot}` interessiert, dann kannst du dir hier noch was anschauen. Das Kapitel ist eigentlich nie fertig, da ich sicherlich immer mal wieder was ergänzen werde.
:::

## Allgemeiner Hintergrund

In diesem Kapitel geht es hauptsächlich um das R Paket `{ggplot}`. Korrekterweise müsste ich natürlich eigentlich noch die korrekte Version ergänzen, aber wir schreiben selten `{ggplot2}` da eigentlich niemand mehr die uralte Version nutzt. Warum dieses Kapitel? Weil es eben dann doch so viel zu entdecken gibt, dass ich mir nicht alles merken kann. Daher habe ich einmal hier die Sammlung an nützlichen R Paketen um `{ggplot}` erstellt. Darüber hinaus war dann auch das [Kapitel zur Visualisierung](#sec-eda-ggplot) einfach zu voll. Viele wollen dann einfach einen `{ggplot}` erstellen und nicht noch durch zig Pakete scrollen. Daher ist das hier eher für mich oder für Leute, die mal rechts und links gucken wollen was da noch am Straßenrand liegt. Vielleicht findest du was, was dich inspiriert. Daher auch die Einteilung in Abschnitte, wo ich ein Problem löse und dann nochmal Abschnitte mit teilweise den gleichen R Paketen als Vorstellung.

::: callout-tip
## Woher habe ich alle Pakete her?

Wenn es einen Link zu einer Seite gibt, den ich immer mal wieder Besuche, ist es der folgende Link: [ggplot2 extensions](https://exts.ggplot2.tidyverse.org/gallery/). Du erfährst hier eine Menge neues an Paketen und es gibt immer wieder spannendes zu entdecken. Ein Besuch lohnt sich auf jeden Fall.
:::

## Genutzte R Pakete

Wir wollen folgende R Pakete in diesem Kapitel nutzen.

```{r echo = TRUE}
#| message: false
pacman::p_load(tidyverse, readxl, latex2exp, see, duke, 
               wesanderson, ggbreak, patchwork, ggrepel,
               tidyplots, conflicted)
```

An der Seite des Kapitels findest du den Link *Quellcode anzeigen*, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.

## Die Daten

Beginnen wir hier nochmal mit einem Datenbeispiel für unsere Flöhe. Wir schauen uns hier einmal an, ob es einen Unterschied in den Ernährungsformen sowie dem Entwicklungsstand gibt. Dabei messen wir dann wieder die Sprungweite. Darüber hinaus nehme ich noch das Gewicht der Flöhe mit in unseren Datensatz. Damit haben wir auch schon genug um mal etwas hier mit `{ggplot}` spielen zu können. Ob hier irgendwas interessantes in den Daten vorliegt interessiert uns eigentlich ja nicht. Hier geht es ums visualisieren.

```{r}
#| message: false

ggplot_tbl <- read_xlsx("data/fleas_model_data.xlsx") |> 
  mutate(feeding = as_factor(feeding),
         stage = as_factor(stage)) |> 
  select(feeding, stage, weight, jump_length)
```

Betrachten wir als erstes einen Auszug aus der Datentabelle. Wir werden hier immer den Messwert auf die y-Achse legen und uns dann je nach Anwendung sowie Algorithmus für eine Einflussvariable entscheiden.

```{r}
#| echo: false
#| message: false
#| warning: false
#| label: tbl-model-table
#| tbl-cap: "Tabelle der vier Variablen für die Darstellung mit `{ggplot}`. Der Messwert ist hier die Sprungweite. Die anderen Variablen dienen als Einflussvariablen."

ggplot_raw_tbl <- read_xlsx("data/fleas_model_data.xlsx")  |> 
  select(feeding, stage, weight, jump_length)

rbind(head(ggplot_raw_tbl, n = 3),
      rep("...", times = ncol(ggplot_raw_tbl)),
      tail(ggplot_raw_tbl, n = 3)) |> 
  kable(align = "c", "pipe")
```

Bitte den Datensatz hier nicht allzu überinterpretieren. Ich brauche einfach nur ein paar Daten um die Funktionen aufrufen zu können. Da ich aber nicht die generischen Daten nutzen will, mache ich hier alles mit meinen Flöhen. Das sind ja meine Tiere hier in der Bio Data Science und deshalb nehmen wir das hier mal auch als Beispiel.

## Probleme von Interesse

Im Folgenden dann noch eine Sammlung an nützlichen Optionen und Möglichkeiten, die einem das Leben einfacher machen und die Abbildungen dann noch schöner. Nicht alles musst du in `{ggplot}` machen, manchmal geht es dann in PowerPoint dann doch schneller mal eben einen Text zu ergänzen. Sehe das hier deshalb als Ergänzung und meinen privaten Raum, den ich nutze um mir den Code zu merken. Viele der Probleme sind dann auch eher so Sachen, die du mit der Zeit als erstrebenswert empfinden magst.

### Striche, Punkte und Text

Der folgende Code und die entsprechenden Abbildungen sind einfach nur Copy& Paste von der Vignette [Aesthetic specifications in `{ggplot}`](https://ggplot2.tidyverse.org/articles/ggplot2-specs.html) und dienen nur meinem schnellen Zugriff. Dann habe ich hier alles was ich brauche einmal zusammen. Häufig sucht man dann doch nochmal die Form eines Punktes oder die Art der Linie.

```{r}
#| warning: false
#| echo: false
#| message: false
#| label: fig-ggplot-shape
#| fig-align: center
#| fig-height: 2.5
#| fig-width: 7
#| fig-cap: "Verschiedene Formen der Punkte die durch die `shape`-Option geändert werden können. Teilweise lassen sich die Punkte auch mit der Option `fill` entsprechebd einfärben. *[Zum Vergrößern anklicken]*"

shapes <- data.frame(
  shape = c(0:19, 22, 21, 24, 23, 20),
  x = 0:24 %/% 5,
  y = -(0:24 %% 5)
)
ggplot(shapes, aes(x, y)) +
  geom_point(aes(shape = shape), size = 5, fill = "red") +
  geom_text(aes(label = shape), hjust = 0, nudge_x = 0.15) +
  scale_shape_identity() +
  expand_limits(x = 4.1) +
  theme_void()
```

Dann gibt es noch die Möglichkeit sich verschiedene Arten von Linien zeichnen zu lassen. Im Folgenden dann erstmal der Standard, der dann manchmal nicht so richtig passt. Dafür gibt es dann aber gleich nochmal eine Option die Abstände zwischen den Teillinien zu ändern.

```{r}
#| warning: false
#| echo: false
#| message: false
#| label: fig-ggplot-linetype
#| fig-align: center
#| fig-height: 2.5
#| fig-width: 7
#| fig-cap: "Verschiedene Arten der Linien die durch die `linetype`-Option geändert werden können. *[Zum Vergrößern anklicken]*"

lty <- c("solid", "dashed", "dotted", "dotdash", "longdash", "twodash")
linetypes <- data.frame(
  y = seq_along(lty),
  lty = lty
)
ggplot(linetypes, aes(0, y)) +
  theme_void() +
  geom_segment(aes(xend = 5, yend = y, linetype = lty)) +
  scale_linetype_identity() +
  geom_text(aes(label = lty), hjust = 0, nudge_y = 0.2) +
  scale_x_continuous(NULL, breaks = NULL) +
  scale_y_reverse(NULL, breaks = NULL)
```

Manchmal will ich dann aber nicht so große Abstände haben. Hier können wir dann mit der Option und verschiedenen Buchstaben spielen. Mehr gibt es in der Vignette [Aesthetic specifications in `{ggplot}`](https://ggplot2.tidyverse.org/articles/ggplot2-specs.html) dazu. Hier reichen mir die folgenden Beispiele um mal schnell die passende Linie zu finden.

```{r}
#| warning: false
#| echo: false
#| message: false
#| label: fig-ggplot-linetype-2
#| fig-align: center
#| fig-height: 2.5
#| fig-width: 7
#| fig-cap: "Verschiedene Arten der Linien die durch die `linetype`-Option geändert werden können. Hier können dann individuell die Abstände zwischen den Linien angepasst werden. *[Zum Vergrößern anklicken]*"

lty <- c("11", "18", "1f", "81", "88", "8f", "f1", "f8", "ff")
linetypes <- data.frame(
  y = seq_along(lty),
  lty = lty
)
ggplot(linetypes, aes(0, y)) +
  theme_void() +
  geom_segment(aes(xend = 5, yend = y, linetype = lty)) +
  scale_linetype_identity() +
  geom_text(aes(label = lty), hjust = 0, nudge_y = 0.2) +
  scale_x_continuous(NULL, breaks = NULL) +
  scale_y_reverse(NULL, breaks = NULL)
```

Manchmal wollen wir dann noch den Text positionieren. Das können wir dann entweder durch die Option `hjust` mit den Worten `"left"`, `"center"` oder `"right"` machen oder eben dann mit Zahlen. Das ganz geht dann neben der horizontalen Ebene auch mit `vjust` auf der vertikalen Ebene. Für mich ist es immer etwas Voodoo und ich schaue hier dann immer regelmäßig rein.

```{r}
#| warning: false
#| echo: false
#| message: false
#| label: fig-ggplot-just
#| fig-align: center
#| fig-height: 2
#| fig-width: 7
#| fig-cap: "Positionen von Text durch die Optionen `vjust` und `hjust`. *[Zum Vergrößern anklicken]*"

just <- expand.grid(hjust = c(0, 0.5, 1), vjust = c(0, 0.5, 1))
just$label <- paste0(just$hjust, ", ", just$vjust)

ggplot(just, aes(hjust, vjust)) +
  theme_void() +
  geom_point(colour = "grey70", size = 3) +
  geom_text(aes(label = label, hjust = hjust, vjust = vjust))
```

Natürlich geht wie immer auch mehr. Dazu dann aber mehr in der passenden Vignette oder eben auf den entsprechenden Hilfeseiten von `{ggplot}`. Aus meiner Erfahrung habe ich dann meistens nicht mehr gebraucht oder es mir dann situativ zusammengesucht.

### Überschriften, Achsen und Legenden

Die Abbildungen einfach nur so machen ist eigentlich nur in einer reinen explorativen Datenanalyse sinnvoll. Sobald du die Abbildungen dann irgendwie veröffentlichen willst, dann sind die normalen Beschriftungen der Achsen in `{ggplot}` mit den Variablennamen nicht mehr schön. Wenn du dann mehr machen willst, also die Überschriften anpassen oder aber die Achsenbeschriftung ändern, dann gibt es hier global Hilfe im [`{ggplot}` Manual](https://ggplot2.tidyverse.org/reference/index.html). In den folgenden Abbildungen siehst du einmal einen veränderten Titel und Beschriftungen sowie die Legenden. Die Möglichkeiten sind nahezu unbegrenzt und sprengen auch hier den Rahmen. Die Webseite [R Cookbook](https://ggplot2.tidyverse.org/reference/index.html) hat auch spezielle Hilfe für `{ggplot}`.

#### Überschriften und Achsenbeschriftung {.unnumbered .unlisted}

Die [Überschriften von Abbildungen](http://www.cookbook-r.com/Graphs/Titles_(ggplot2)/) können wir beliebig anpassen. Hier können wir die Funktion `ggtitle()` oder aber die Funktion `labs()` nutzen. Die [Achsenbeschriftung](http://www.cookbook-r.com/Graphs/Axes_(ggplot2)/) können wir in der Funktion `labs()` einfach ändern. Das ist dann am Ende immer eine Geschmacksfrage was dir besser gefällt. Ich nutze hier gerne die Funktion `labs()`, dann habe ich alles zusammen.

```{r }
#| warning: false
#| echo: true
#| message: false
#| label: fig-labels-scale-title-labs
#| fig-align: center
#| fig-height: 4
#| fig-width: 7
#| fig-cap: "Beispielhafte Abbildung mit Titel und geänderter Achsenbeschrittung. *[Zum Vergrößern anklicken]*"

ggplot(data = ggplot_tbl, aes(x = feeding, y = jump_length,
                              fill = feeding)) +
  theme_minimal() +
  geom_boxplot() +
  labs(title = "Ernährungsbedinungen",
       subtitle = "Unterschiedliche Bedingungen für die Sprungweite",
       caption = "Erhoben im Sommer 2022",
       x = "Ernährungsarten", y = "Sprungweite in [cm]",
       fill = "Ernährung")
```

#### Legende anpassen {.unnumbered .unlisted}

Die [Legende](http://www.cookbook-r.com/Graphs/Legends_(ggplot2)/) können wir ebenfalls in `labs()` und dann in den entsprechenden `scales`-Funktionen anpassen. Hier musst du im Zweifel etwas probieren. Faktoren würde ich in den Daten über die Funktion `factor()` anpassen. Du hast dann hier eben auch die Wahl wie du vorgehst. Manchmal macht es dann auch Sinn dir ein eigenes `tibble` für die Erstellung der Abbildungen zu bauen. In den beiden folgenden Tabs zeige ich dir mal beide Wege.

::: panel-tabset
## `factor()`

Wir bauen hier erstmal den Faktor mit der Funktion `factor()` in der wir dann die Sortierung und dann die Labels der Level ändern können. Ich empfehle dir erst die Sortierung zu bestimmen und dann umzubenennen. Sonst kann da schnell was durcheinanderkommen. Hier mag dann auch das [R Paket `{forcats}`](https://forcats.tidyverse.org/) helfen.

```{r}
ggplot_factor_tbl <- ggplot_tbl |> 
  mutate(feeding = factor(feeding,
                          levels = c("sugar_water", "blood", "ketchup"),
                          labels = c("Zuckerwasser", "Blut", "Ketchup")))
```

Dann können wir uns auch schon einmal die folgende Abbildung bauen in dem wir die Level des Faktors geändert haben.

```{r }
#| warning: false
#| echo: true
#| message: false
#| label: fig-labels-scale-factor
#| fig-align: center
#| fig-height: 3
#| fig-width: 7
#| fig-cap: "Beispielhafte Abbildung mit Titel und geänderter Achsenbeschrittung. *[Zum Vergrößern anklicken]*"

ggplot(data = ggplot_factor_tbl, aes(x = feeding, y = jump_length,
                                     fill = feeding)) +
  theme_minimal() +
  geom_boxplot() 
```

## `scale_*_discrete()`

Es ist auch möglich direkt in `{ggplot}` die Level des Faktors umzubenennen. Das ist genau so gut, wenn wir hier nicht so viel mit der Sortierung ändern wollen. Wie immer würde ich hier empfehlen nur Kosmetik zu machen und den Rest sauber über das [R Paket `{forcats}`](https://forcats.tidyverse.org/) oder eben die Funktion `factor()`

```{r }
#| warning: false
#| echo: true
#| message: false
#| label: fig-labels-scale-discrete
#| fig-align: center
#| fig-height: 3
#| fig-width: 7
#| fig-cap: "Beispielhafte Abbildung mit Titel und geänderter Achsenbeschrittung. *[Zum Vergrößern anklicken]*"

ggplot(data = ggplot_tbl, aes(x = feeding, y = jump_length,
                              fill = feeding)) +
  theme_minimal() +
  geom_boxplot() +
  scale_x_discrete(labels = c("Blut", "Ketchup", "Zuckerwasser")) +
  scale_fill_discrete(name = "Behandlung", 
                      labels = c("Blut", "Ketchup", "Zuckerwasser"))
```
:::

### Schriftarten

Das Thema Schriftarten ist so eine Sache. Am Ende des Abschnitts gebe ich dir nochmal eine Linksammlung für die Hilfe. Es ist nämlich wichtig in welchem Betriebssystem (eng. *operating system*, abk. *OS*) du arbeitest. Je nach Betriebssystem hast du unterschiedliche Schriften installiert und die lassen sich dann nicht so einfach exportieren oder aber in anderen Betriebssystemen darstellen. Fangen wir also erstmal mit einer Abbildung an, an der wir dann mal was ändern wollen. Wir speichern die Abbildung einmal als Objekt `p1` ab und ändern nachträglich die Schriftarten.

```{r}
#| warning: false
#| echo: true
#| message: false
#| label: fig-ggplot-schrift-base
#| fig-align: center
#| fig-height: 3
#| fig-width: 7
#| fig-cap: "Beispielhafte Abbildung mit Titel und geänderter Achsenbeschrittung in der die Schriftarten geändert werden sollen. *[Zum Vergrößern anklicken]*"

p1 <- ggplot(data = ggplot_tbl, aes(x = feeding, y = jump_length,
                              fill = feeding)) +
  theme_minimal() +
  geom_boxplot() +
  scale_x_discrete(labels = c("Blut", "Ketchup", "Zuckerwasser")) +
  labs(title = "Ernährungsbedinungen",
       subtitle = "Unterschiedliche Bedingungen für die Sprungweite",
       caption = "Erhoben im Sommer 2022",
       x = "Ernährungsarten", y = "Sprungweite in [cm]",
       fill = "Ernährung")
p1
```

Wenn wir allgemein die Schriftart in der ganzen Abbildung ändern wollen, dann können wir einfach folgende Option in `theme()` setzen. Hier ändern wir alles an Text einmal auf `"Times New Roman"` um. Welche Möglichkeiten du hast, hängt von deinem Betriebssystem und deinen installierten Schriften ab. Dazu mehr weiter unten.

```{r}
#| fig-align: center
#| fig-height: 3
#| fig-width: 7
p1 +
  theme(text = element_text(family = "Times New Roman"))
```

Wir können auch vollkommen frei drehen und dann alles mögliche ändern.

```{r}
#| fig-align: center
#| fig-height: 3
#| fig-width: 7
p1 +
  theme(plot.title = element_text(family = "mono"),
        plot.subtitle = element_text(family = "sans"),
        axis.title.x = element_text(family = "Comic Sans MS"),
        axis.title.y = element_text(family = "AppleGothic"),
        axis.text.x = element_text(family = "Optima"),
        axis.text.y = element_text(family = "Luminari"))
```

What are “mono”, “sans” and “serif”?

::: panel-tabset
## `mono`

```{r}
#| fig-align: center
#| fig-height: 3
#| fig-width: 7
p1 +
  theme(text = element_text(family = "mono"))
```

## `sans`

```{r}
#| fig-align: center
#| fig-height: 3
#| fig-width: 7
p1 +
  theme(text = element_text(family = "sans"))
```

## `serif`

```{r}
#| fig-align: center
#| fig-height: 3
#| fig-width: 7
p1 +
  theme(text = element_text(family = "serif"))
```
:::

[Adding Custom Fonts to ggplot in R](https://gradientdescending.com/adding-custom-fonts-to-ggplot-in-r/)

[Aesthetic specifications](https://ggplot2.tidyverse.org/articles/ggplot2-specs.html)

Die Sache mit der Schriftart in `{ggplot}`.

[Changing fonts in ggplot2](https://stackoverflow.com/questions/34522732/changing-fonts-in-ggplot2)

[Using different fonts with ggplot2](https://statisticaloddsandends.wordpress.com/2021/07/08/using-different-fonts-with-ggplot2/)

[Using systemfonts to handle fonts in R](https://systemfonts.r-lib.org/articles/systemfonts.html)

```{r}
ggplot(mpg, aes(x = hwy, y = cty)) +
  geom_point() +
  theme_gray(base_family = "serif")
```

```{r}
ggplot(mpg, aes(x = hwy, y = cty)) +
  geom_point() +
  theme(
    plot.title = element_text(family = "mono", size = 16),
    axis.text = element_text(family = "serif", size = 12)
  )
```

```{r}
ggplot(mpg, aes(x = hwy, y = cty, label = cty)) +
  geom_text(family = "mono", fontface = "bold.italic", size = 6)
```

### Theme anpassen

#### Position der Legende {.unnumbered .unlisted}

```{r}
#| eval: false
theme(legend.position = "top")
```

```{r}
#| eval: false
theme(legend.position = "none")
```

#### Eigenes Theme {.unnumbered .unlisted}

[Modify components of a theme](https://ggplot2.tidyverse.org/reference/theme.html)

```{r}
theme_modeling <- function() {
  theme_minimal() +
    theme(panel.grid.minor = element_blank(),
          plot.title = element_text(size = 16, face = "bold"),
          plot.subtitle = element_text(size = 12, face = "italic"),
          plot.caption = element_text(face = "italic"),
          axis.title = element_text(size = 12, face = "bold"),
          axis.text = element_text(size = 12),
          strip.text = element_text(face = "bold"))
}
```

```{r}
#| warning: false
#| echo: true
#| message: false
#| label: fig-labels-own-theme
#| fig-align: center
#| fig-height: 4
#| fig-width: 7
#| fig-cap: "Beispielhafte Abbildung mit Titel und geänderter Achsenbeschrittung. *[Zum Vergrößern anklicken]*"

ggplot(data = ggplot_tbl, aes(x = feeding, y = jump_length,
                              fill = feeding)) +
  theme_modeling() +
  geom_boxplot() +
  scale_x_discrete(labels = c("Blut", "Ketchup", "Zuckerwasser")) +
  labs(title = "Ernährungsbedinungen",
       subtitle = "Unterschiedliche Bedingungen für die Sprungweite",
       caption = "Erhoben im Sommer 2022",
       x = "Ernährungsarten", y = "Sprungweite in [cm]",
       fill = "Ernährung")
```

### Abbildungen beschriften

`fontface`-Option

```{r}
#| warning: false
#| echo: false
#| message: false
#| label: fig-labels-beschriften-0
#| fig-align: center
#| fig-height: 0.75
#| fig-width: 7
#| fig-cap: "fooo. *[Zum Vergrößern anklicken]*"
df <- data.frame(x = 1:4, fontface = c("plain", "bold", "italic", "bold.italic"))
ggplot(df, aes(x, 1)) +
  geom_text(aes(label = fontface, fontface = fontface),
            size = 5) +
  xlim(0.5, 4.5) +
  theme_minimal() +
  theme(panel.grid = element_blank(),
        axis.text.y = element_blank(),
        axis.title =  element_blank(),
        axis.text.x = element_text(size = 14))
```

```{r}
#| warning: false
#| echo: true
#| message: false
#| label: fig-labels-beschriften
#| fig-align: center
#| fig-height: 3
#| fig-width: 7
#| fig-cap: "Beispielhafte Abbildung mit Titel und geänderter Achsenbeschrittung. *[Zum Vergrößern anklicken]*"

ggplot(data = ggplot_tbl, aes(x = weight, y = jump_length,
                              color = feeding)) +
  theme_minimal() +  
  geom_point(alpha = 0.5) +
  annotate("text", x = 10, y = 100, label = "text", size = 5,
           fontface = 3) +
  annotate("label", x = 10, y = 200, label = "text", size = 5,
           fontface = 2) 
```

```{r}
#| warning: false
#| echo: true
#| message: false
#| label: fig-labels-beschriften-mitpfeil
#| fig-align: center
#| fig-height: 3
#| fig-width: 7
#| fig-cap: "Beispielhafte Abbildung mit Titel und geänderter Achsenbeschrittung. *[Zum Vergrößern anklicken]*"

ggplot(data = ggplot_tbl, aes(x = weight, y = jump_length,
                              color = feeding)) +
  theme_minimal() +  
  geom_point(alpha = 0.5) +
  geom_curve(aes(x = 12, y = 100, xend = 15, yend = 150),
             arrow = arrow(length = unit(0.3, "cm"), type = "closed"),
             color = "blue",
             size = 0.75,
             curvature = 0.3)
```

::: {layout="[15,85]" layout-valign="top"}
![](images/personal_opinion.png){fig-align="center" width="100%"}

> *"Macht es überhaupt Sinn? Wenn du nur ein paar Abbildungen mit einem Pfeil versehen willst, dann würde ich dir immer den Weg über PowerPoint empfehlen. Dann kannst du dort deine Abbildung exportieren und im Zweifel zuschneiden. Das geht viel schneller als sich hier mit der Annotation in `{ggplot}` zu quälen. Aber ja, es ist sehr befriedigend, wenn es dann geklappt hat..." --- Jochen Kruppa-Scheetz, meiner bescheidener Meinung nach.*
:::

### Keine Lücke auf der y-Achse

```{r}
stats_tbl <- ggplot_tbl |> 
  group_by(feeding) |> 
  summarise(mean = mean(jump_length))
```

```{r}
#| warning: false
#| echo: true
#| message: false
#| label: fig-labels-zero
#| fig-align: center
#| fig-height: 3
#| fig-width: 7
#| fig-cap: "Beispielhafte Abbildung mit Titel und geänderter Achsenbeschrittung. *[Zum Vergrößern anklicken]*"

ggplot(stats_tbl, aes(x = feeding, y = mean)) +
  theme_minimal() +
  geom_bar(stat = "identity") + 
  scale_y_continuous(expand = expansion(mult = c(0, .1)))
```

### Abbildungen nebeneinander

Das [R Paket `{patchwork}`](https://patchwork.data-imaginist.com/articles/patchwork.html) erlaubt es mehrere `ggplot` Abbildungen nebeneinander oder in einem beliebigen Layout miteinander zu verbinden. Das tolle ist, dass die Idee sehr intuitiv ist. Wir nutzen wieder das `+` um verschiedene Plots miteinander zu verbinden. Im Folgenden erschaffen wir uns zwei `ggplots` und speichern die Plots in den Objekten `p1` und `p2`. Das ist wie wir es bisher kennen, nur das jetzt keine Abbildung erscheint sondern beide Plots in zwei Objekten gespeichert sind.

```{r}
#| warning: false
#| echo: true
#| message: false

p1 <- ggplot(data = ggplot_tbl, 
             aes(x = weight, y = jump_length,
                 color = feeding)) +
  geom_point() +
  scale_color_okabeito() +
  theme_minimal()

p2 <- ggplot(data = ggplot_tbl, 
                aes(x = feeding, y = jump_length,
                    color = feeding)) +
  geom_point() +
  scale_color_okabeito() +
  theme_minimal()
```

Wie können wir nun die beiden Abbildungen nebeneinander zeichnen? Wir nutzen einfach das `+` Symbol.

```{r}
#| warning: false
#| echo: true
#| message: false
#| eval: true
#| label: fig-labels-patchwork-1
#| fig-align: center
#| fig-height: 3
#| fig-width: 9
#| fig-cap: "Beispielhafte Abbildung der zweier Plots nebeneinander für die Sprungweite und zwei Einflussvariablen. **(A)** Zusammenhang zwischen dem Gewicht und der Sprungweite. **(B)** Zusammenhang der Ernährungsart und der Sprungweite. *[Zum Vergrößern anklicken]*"

p1 + p2 +
  plot_layout(ncol = 2) +
  plot_annotation(tag_levels = 'A', tag_prefix = '(', tag_suffix = ')') &
  theme(plot.tag = element_text(size = 16, face = "bold"))
```

Auf der Seite des [R Paket `{patchwork}`](https://patchwork.data-imaginist.com/articles/patchwork.html) findest du viel mehr Möglichkeiten das Layout anzupassen und auch die einzelnen [Subplots zu beschriften](https://patchwork.data-imaginist.com/articles/guides/annotation.html).

### Abbildungen abspeichern

Wenn du eine Abbildung abspeichern willst, dann musst du nur nach dem `ggplot`-Code die Funktion `ggsave()` setzen. Wie du im hier im Folgenden siehst, speichere ich die Abbildung der Boxplots der Hunde- und Katzenflöhe einmal in der Datei `flea_dog_boxplot.png` ab. Dabei wähle ich eine Breite `width` und eine Höhe `height` von jeweils 5. Du musst dann immer etwas spielen, je größer die Zahlen, desto größer die Abbildung und die Auflösung.

```{r}
#| warning: false
#| echo: true
#| eval: false
#| message: false
#| label: fig-save
#| fig-align: center
#| fig-height: 3
#| fig-width: 7
#| fig-cap: "Beispielhafte Abspeicherung einer Abbdilung mit `ggsave()`. *[Zum Vergrößern anklicken]*"

ggplot(data = ggplot_tbl, 
       aes(x = feeding, y = jump_length)) +
  geom_boxplot() 

## Abspeichern des obigen ggplots  
ggsave("feeding_boxplot.png", width = 5, height = 5)
```

Wie immer hilft auch die [Hilfeseite von `ggsave()`](https://ggplot2.tidyverse.org/reference/ggsave.html) weiter, wenn es um mehr Optionen und Qualität der Abbildungen geht.

### Mathematische Ausdrücke {#sec-eda-tex}

Häufig wollen wir nicht nur einfache Achsenbeschriftungen haben, sondern auch irgendwie komplexere Einheiten wie Eisendüngergehalt im Boden in $[kg\, ha]^{-1}$ darstellen. Jetzt soll die Einheit auch in dieser Form mit in die Achsenbeschriftung. Wir können dafür zwei Wege wählen. Einmal über das R Paket `{latex2exp}` und die Funktion `TeX()` oder aber die Funktion `expression()`, wofür wir dann kein eigenes R Paket brauchen. Beide Wege haben Vor- und Nachteile. Wir gehen aber beide mal durch. Mehr Informationen durch das Tutorium [Using latex2exp](https://cran.r-project.org/web/packages/latex2exp/vignettes/using-latex2exp.html) oder aber eben der Klassiker mit [Plot math expression](https://stat.ethz.ch/R-manual/R-patched/library/grDevices/html/plotmath.html).

Wir können die Funktion `expression()` nutzen um uns mathematische Formeln zu bauen. Leider ist das Ganze etwas frickelig und auch ich brauche immer drei Anläufe, bis die Formel dann passt. Im Folgenden aber einmal zwei Beispiel für mathematische Formeln und Ausdrücke. Beachte, dass du jedes Leerzeichen durch eine Tilde `~` abbilden musst. Ich nutze die Funktion `expression()` sehr selten und nur wenn die Formel wirklich sehr einfach ist. Da wir aber schon mit eckigen Klammern Probleme kriegen und diese so nervig mit `"` einklammern müssen, nutze ich dann das Paket `{latex2exp}` was ich im Folgenden vorstellen werde.

Hier aber erstmal zwei Beispiele für eine Formel mit der Funktion `expression()`. Wenn du mehr über die Möglichkeiten wissen willst, dann schauen auch einmal auf die Hilfeseite von [Plot math](https://stat.ethz.ch/R-manual/R-patched/library/grDevices/html/plotmath.html) oder du googelst dir die Lösung wie ich früher zusammen.

```{r}
#| warning: false
#| echo: true
#| message: false
#| fig-align: center
#| fig-height: 2
#| fig-width: 5

plot(expression(Eisendüngeform~und~-höhe~"[kg ha]"^-1), cex = 1.5, main = "")
plot(expression(Fe-Gehalt~"["~mg%.%(kg~TM)^-1~"]"), cex = 1.5, main = "")
```

Für mich ausdrücklich einfacher geht es mit dem R Paket `{latex2exp}` und der Funktion `TeX()` sowie die Helferfunktion `r"()"`. Ja, hier muss man dann noch eine andere Programmiersprache kennen, aber wie immer, du wirst nur schlauer. Die Informationen zur Matheumgebung in $\LaTeX$ kommen dann nochmal extra zwischen zwei Dollarzeichen `$`. Ja, das ist etwas wirr für einen Anfänger, aber wir nutzen hier auch zwei Programmiersprachen zusammen. Zum einen $\LaTeX$ um die Mathesymbole sauber darzustellen und dann R um die Abbildungen in `ggplot()` zu bauen. Mehr Informationen zu der Matheumgebung in $\LaTeX$ findest du einmal in der [LaTeX Mathehilfe I](https://de.wikipedia.org/wiki/Hilfe:TeX) sowie der [LaTeX Mathehilfe II](https://en.wikibooks.org/wiki/LaTeX/Mathematics).

Wie bauen wir uns also unseren mathematischen Ausdruck? Als erstes brauchen wir die Funktion `Tex()`, die sagt einfach nur aus, dass jetzt $\LaTeX$-Code kommt. Dann wollen wir noch einen String brauen in dem der $\LaTeX$-Code für unseren mathematischen Ausdruck drin steht. Diesen String bauen wir mit `r"()"`. Achtung, hier ist das Gänsefüßchen oben und unten vor und nach der runden Klammer sehr wichtig. In den Ausdruck können wir dann Text schreiben `Eisengehalt` oder aber einen mathematischen Ausdruck abgrenzt von zwei Dollarzeichen `$` wie `$[kg\, ha]^{-1}$`. $\LaTeX$ kann nämlich nicht nur mathematische Ausdrücke sondern ist eigentlich ein Textverarbeitungsprogramm. Deshalb musst du hier *nochmal* zwischen Text und mathematischen Ausdruck unterscheiden.

Hier nochmal aufgeschlüsselt wie der Code aussieht. Wir schreiben den Code nachher in einer Zeile, aber zum Verständnis ist es besser, wenn wir den Code einmal aufgeklappt sehen.

```{r}
#| eval: false
TeX(
    r"(
      Eisengehalt $[kg\, ha]^{-1}$
    )"
   )
```

Wir wollen uns das Ergebnis einmal in einem simplen `plot()` anschauen. Wir nutzen die Funktionalität natürlich später in `ggplot`, aber hier ist es so einmal einfacher zu sehen.

```{r}
#| warning: false
#| echo: true
#| message: false
#| fig-align: center
#| fig-height: 2.5
#| fig-width: 5

plot(cex = 2, main = "",
  TeX(r"(
         Eisengehalt $[kg\, ha]^{-1}$
      )")
    )
```

Auch können wir sehr viel komplexere Formeln erstellen. Beachte auch hier, dass wir zwei Matheumgebungen in $\LaTeX$ vorliegen haben.

```{r}
#| warning: false
#| echo: true
#| message: false
#| fig-align: center
#| fig-height: 2.5
#| fig-width: 5

plot(cex = 2, main = "",
  TeX(r"(
         A $\LaTeX$ formula: $\frac{2hc^2}{\lambda^5}\frac{1}{e^{\frac{hc}{\lambda k_B T}} - 1}$
      )")
  )
```

In der @fig-scatter-flea-1 dann nochmal die Anwendung in einem `ggplot` in dem wir die Achsen entsprechend beschriften und dann auch noch eine ausgedachte Regressionsgeleichung zu der Abbildung ergänzen.

```{r}
#| echo: true
#| warning: false
#| message: false
#| label: fig-scatter-flea-1
#| fig-align: center
#| fig-height: 3
#| fig-width: 7
#| fig-cap: "Zusammenhang zwischen dem Eisengehalt und -höhe im Boden und dem Eisengehalt in Salat. Zusätzlich ergänzt eine Regressiongleichung und ein ausgedachtes Bestimmtheitsmaß. *[Zum Vergrößern anklicken]*"

ggplot(data = ggplot_tbl, aes(x = weight, y = jump_length)) +
  geom_point() +
  stat_smooth(method = "lm", se = FALSE) +
  theme_minimal() +
  labs(x = TeX(r"(Eisengehalt und -höhe $[kg\, ha]^{-1}$)"), 
       y = TeX(r"(Fe-Gehalt $[mg \cdot (kg TM)^{-1}]$)")) +
  annotate("text", x = 10, y = 10,
           label = TeX(r"($y = \beta_0 + \beta_1 \cdot x;\; R^2 = 0.24$)"))

```

Wenn du dann mal die Funktion `Tex()` in `geom_text()` verwenden willst, dann musst du einmal etwas anpassen. Dann klappt es aber auch hier. Das hat mich mal echt Nerven und Zeit gekostet, deshalb lagere ich die Information mal hier für mich.

```{r}
#| warning: false
#| echo: true
#| message: false
#| eval: false
#| fig-align: center
#| fig-height: 1
#| fig-width: 2

ggplot() +
  theme_void() +
  geom_text(aes(0, 0, 
                label = TeX(r'($\alpha  x^\alpha$, where $\alpha \in 1\ldots 5$)',
                                  output = "character")), parse = TRUE) 
```

### Farbpaletten

Die [Farben](http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/) können weitreichend angepasst werden. Weiter unten findest du dann noch verschiedene Farbpaletten. Wenn du deine Farben selber wählst, dann kann es manchmal etwas kunterbund aussehen. Neben den klassischen Farben im R Paket `{ggplot2}` gibt es noch weit, weit mehr Farbpaletten. Wir nutzen in der Folge immer wieder die Okabe-Ito Farbpalette aus dem R Paket `{see}`. Die Okabe-Ito Farbpalette ist speziell so gebaut, dass die Farben sich gut für farbenblinde Personen unterscheiden. Mehr zum R Paket `{see}` auf der [Hilfeseite des Paketes](https://easystats.github.io/see/index.html). Der Kontrast zwischen den Farben ist sehr gut. Wenn du eine andere Farbpalette nutzen willst, findest du hier noch andere [Color Scales](https://easystats.github.io/see/articles/seecolorscales.html).

```{r}
#| warning: false
#| echo: true
#| message: false
#| label: fig-labels-see-0
#| fig-align: center
#| fig-height: 3
#| fig-width: 7
#| fig-cap: "Beispielhafte Abbildung der Okabe-Ito Farbpalette für Boxplots. *[Zum Vergrößern anklicken]*"

ggplot(data = ggplot_tbl, 
       aes(x = feeding, y = jump_length,
           fill = feeding)) +
  geom_boxplot() +
  scale_fill_okabeito() +
  theme_minimal()
```

```{r}
#| warning: false
#| echo: true
#| message: false
#| label: fig-labels-see-1
#| fig-align: center
#| fig-height: 3
#| fig-width: 7
#| fig-cap: "Beispielhafte Abbildung der Okabe-Ito Farbpalette für Punkte. *[Zum Vergrößern anklicken]*"

ggplot(data = ggplot_tbl, 
       aes(x = feeding, y = jump_length,
           fill = feeding)) +
  geom_point() +
  scale_color_okabeito() +
  theme_minimal()
```

Das Ganze geht dann auch händisch mit dem folgenden Code für die [jeweiligen Farben](http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/#a-colorblind-friendly-palette). Anbei einmal die Farbpalette dargestellt.

```{r}
#| warning: false
#| echo: false
#| message: false
#| label: fig-ggplot-okabeito
#| fig-align: center
#| fig-height: 0.75
#| fig-width: 6
#| fig-cap: "Farbpalette nach dem Okabe-Ito-Schema ebenfalls für farbblinde Personen erstellt. *[Zum Vergrößern anklicken]*"

df <- data.frame(
  x = 1:9,
  y = 0.5,
  z = factor(1:9)
)

ggplot(df, aes(x, y)) +
  geom_tile(aes(fill = z), colour = "grey50") +
  scale_fill_okabeito() +
  theme_void() +
  theme(legend.position = "none") 

```

Die Farben sind dann in der Reihenfolge wie folgt kodiert.

```{r}
#| warning: false
#| echo: true
#| message: false
#| eval: false
cbbPalette <- c("#E69F00", "#56B4E9", "#009E73", 
                "#F0E442", "#0072B2", "#D55E00", 
                "#CC79A7", "#999999", "#000000")
```

Wenn wir Boxplots einfärben wollen dann nehmen wir den folgenden Code.

```{r}
#| warning: false
#| echo: true
#| message: false
#| eval: false
scale_fill_manual(values = cbPalette)
```

Und das hier ist die Ergänzung für Punkte und Linien.

```{r}
#| warning: false
#| echo: true
#| message: false
#| eval: false
scale_colour_manual(values = cbPalette)
```

Neben der Okabe-Ito Farbpalette liefert das [R Paket `{duke}`](https://cran.r-project.org/web/packages/duke/vignettes/duke.html) noch eine andere Möglichkeit eine Farbpalette für Farbblinde zu generieren.

```{r}
#| warning: false
#| echo: false
#| message: false
#| label: fig-ggplot-duke
#| fig-align: center
#| fig-height: 0.75
#| fig-width: 6
#| fig-cap: "Farbpalette nach dem Duke-Schema ebenfalls für farbblinde Personen erstellt. *[Zum Vergrößern anklicken]*"

df <- data.frame(
  x = 1:9,
  y = 0.5,
  z = factor(1:9)
)
ggplot(df, aes(x, y)) +
  geom_tile(aes(fill = z), colour = "grey50") +
  scale_duke_fill_discrete() +
  theme_void() +
  theme(legend.position = "none") 

```

Die Farben sind dann in der Reihenfolge wie folgt kodiert.

```{r}
#| warning: false
#| echo: true
#| message: false
#| eval: false
dukePalette <- c("#012169", "#C84E00", "#00539B", "#339898", 
                 "#A1B70D", "#E89923", "#FFD960", "#262626")
```

Die Funktionen hier sind `scale_duke_color_discrete()` sowie `scale_duke_continuous()` und `scale_duke_fill_discrete()`.

Manchmal benötigen wir auch Farbverläufe. In R heißen diese Farbverläufe dann Farbpaletten. Eine Einführung liefert das Tutorium [Using RColorBrewer palettes](http://www.sthda.com/english/wiki/colors-in-r#using-rcolorbrewer-palettes). Ich selber nutze gerne das R Paket `{wesanderson}` welches sehr schöne Farbverläufe hat. Mehr kannst du auf der GitHub Seite [Wes Anderson Palettes](https://github.com/karthik/wesanderson) erfahren. Wir können die Paletten ganz einfach mit der Funktion `wes_palette()` laden.

```{r}
#| fig-height: 0.75
#| fig-width: 6
wes_palette("Zissou1")
```

Das schöne ist hier, dass wir einfach wie folgt Farbverläufe erstellen können. Wir wollen hier 21 Farbwerte haben und das Ganze dann als kontinuierlichen Verlauf.

```{r}
#| fig-height: 0.75
#| fig-width: 6
wes_palette("Zissou1", 21, type = "continuous")
```

### Lange Namen auf der x-Achse

[Quick and easy ways to deal with long labels in ggplot2](https://www.andrewheiss.com/blog/2022/06/23/long-labels-ggplot/)

```{r }
#| warning: false
#| echo: true
#| message: false
#| label: fig-labels-scale-discrete-longnames
#| fig-align: center
#| fig-height: 3
#| fig-width: 7
#| fig-cap: "Beispielhafte Abbildung mit Titel und geänderter Achsenbeschrittung. *[Zum Vergrößern anklicken]*"

ggplot(data = ggplot_tbl, aes(x = feeding, y = jump_length,
                              fill = feeding)) +
  theme_minimal() +
  geom_boxplot() +
  scale_x_discrete(labels = c("Blutkonserven aus Rinderblut", 
                              "Ketchup aus einer Flasche", 
                              "Zuckerwasser mit Fruktose"),
                   guide = guide_axis(n.dodge = 2)) 
```

### Gebrochene $y$-Achse

Das [R Paket `{ggbreak}`](https://cran.r-project.org/web/packages/ggbreak/vignettes/ggbreak.html) erlaubt es dir in die $x$-Achse oder aber $y$-Achse Lücken einzusetzen oder aber die Achsen eben gebrochen darzustellen. Zur Demonstration bauen wir uns nochmal den `stat_tbl` für die Hunde- und Katzenflöhe. Wir berechnen hier dann die Mittelwerte und nicht mehr die Standardabweichung, da es sonst nicht so gut mit der Darstellung mit der gebrochenen $y$-Achse für dieses Beispiel klappt.

```{r}
stat_tbl <- ggplot_tbl |> 
  group_by(feeding) |> 
  summarise(mean = mean(jump_length))
```

In der @fig-labels-ggbreak-1 siehst du einmal die Abbildung der Mittelwerte der Sprungweiten der Hunde- und Katzenflöhe als Barplots dargestellt. Ich habe hier einen Bruch auf der $y$-Achse mit der Funktion `scale_y_break()` bei 1 bis 4 eingefügt und den Abstand über die Option `space` etwas visuell vergrößert. Mit der Option `scales` könntest du dann noch die Skalierung der gebrochenen $y$-Achse anpassen.

```{r}
#| warning: false
#| echo: true
#| message: false
#| eval: true
#| label: fig-labels-ggbreak-1
#| fig-align: center
#| fig-height: 4
#| fig-width: 7
#| fig-cap: "Beispielhafte Abbildung der Barplots mit gebrochener $y$-Achse. Die Fehlerbalken wurden aus Gründen der besseren Darstellung der zerbrochenen $y$-Achse entfernt. *[Zum Vergrößern anklicken]*"

ggplot(stat_tbl, aes(x = feeding, y = mean, fill = feeding)) + 
  theme_minimal() +
  geom_bar(stat = "identity") +
  scale_y_break(c(10, 60), space = 0.5)
```

## R Pakete von Interesse

::: callout-tip
## Woher habe ich alle Pakete her?

Wenn es einen Link zu einer Seite gibt, den ich immer mal wieder Besuche, ist es der folgende Link: [ggplot2 extensions](https://exts.ggplot2.tidyverse.org/gallery/). Du erfährst hier eine Menge neues an Paketen und es gibt immer wieder spannendes zu entdecken. Ein Besuch lohnt sich auf jeden Fall.
:::

### `{forcats}`

[R Paket `{forcats}`](https://forcats.tidyverse.org/)

### `{ggrepel}`

[Getting started with `{ggrepel}`](https://cran.r-project.org/web/packages/ggrepel/vignettes/ggrepel.html) [{`ggtext`}: Improved text rendering support for ggplot2](https://wilkelab.org/ggtext/)

```{r}
update_geom_defaults("label", 
                     list(family = "IBM Plex Sans Condensed"))
update_geom_defaults(ggtext::GeomRichText, 
                     list(family = "IBM Plex Sans Condensed"))
update_geom_defaults("label_repel", 
                     list(family = "IBM Plex Sans Condensed"))
```

```{r}
ggplot(tibble(x = 1:3, y = 1:3), aes(x,y)) +
  theme_minimal(base_family = "IBM Plex Sans Condensed") +
  geom_point() +
  labs(x = "Hallo", y = "Mehr zesz")
```

https://statisticaloddsandends.wordpress.com/2021/07/08/using-different-fonts-with-ggplot2/ https://www.r-bloggers.com/2019/03/adding-custom-fonts-to-ggplot-in-r/ https://stackoverflow.com/questions/34522732/changing-fonts-in-ggplot2 https://ggplot2.tidyverse.org/articles/ggplot2-specs.html

### `{gganimate}`

[Datanovia](https://www.datanovia.com/en/blog/gganimate-how-to-create-plots-with-beautiful-animation-in-r/)

[Cheat sheet `{gganimate}`](https://rstudio.github.io/cheatsheets/gganimate.pdf)

### `{ggpp}`

[`{ggpp}`](https://docs.r4photobiology.info/ggpp/index.html)

### `{ggh4x}`

[`{ggh4x}`](https://teunbrand.github.io/ggh4x/articles/ggh4x.html)

### `{ggsignif}`

[`{ggsignif}`](https://github.com/const-ae/ggsignif)

### `{ggpmisc}`

[`{ggpmisc}`](https://cran.r-project.org/web/packages/ggpmisc/vignettes/user-guide.html)

### `{patchwork}`

[`{patchwork}`](https://patchwork.data-imaginist.com/)

```{r}
#| eval: false

p1 + p2 +
  plot_layout(ncol = 2) +
  plot_annotation(tag_levels = 'A', tag_prefix = '(', tag_suffix = ')') &
  theme(plot.tag = element_text(size = 16, face = "bold"))
```

### `{tidyplots}`

```{r}
#| message: false
#| echo: true
#| warning: false
#| label: fig-ggplot-tidyplots-fac1
#| fig-align: center
#| fig-height: 3
#| fig-width: 3.5
#| fig-cap: "Beispielhafter zweifaktorieller Barplot für die Sprungweiten in [cm] gruppiert nach den Floharten und den beiden Geschlechtern."

ggplot_tbl |> 
  tidyplot(x = feeding, y = jump_length, color = feeding) |> 
  theme_minimal_y() |> 
  add_data_points() |> 
  add_mean_bar(alpha = 0.4) |> 
  add_sd_errorbar() |> 
  remove_legend() |> 
  adjust_size(height = NA, width = NA)
```

[`{tidyplots}`](https://jbengler.github.io/tidyplots/)

[Get started](https://jbengler.github.io/tidyplots/articles/tidyplots.html)

[Use cases](https://tidyplots.org/use-cases/)

[tidyplots cheatsheet](https://tidyplots.org/tidyplots-cheatsheet-v1.pdf)

@engler2025tidyplots

::: callout-tip
## Mehr Pakete von Interesse

Manchmal finde ich irgendwo ein R Paket und denke, dass könnte von Interesse sein und irgendwie dann doch mit in Visualisierung passen. Daher schreibe ich mir das Paket erstmal hier auf und schaue später mal vorbei. Es sind eben dann auch Daten dabei, die man mal visualisieren könnte.

| Nr. | Link | Beschreibung |
|----|----|----|
| 1\. | [R Paket `{collapse}`](https://sebkrantz.github.io/collapse/index.html) |  |
| 2\. | [R Paket `{ggdist}`](https://mjskay.github.io/ggdist/index.html) |  |
| 3\. | Das R Paket `{visibly}` auf [An Introduction to Visibly](https://m-clark.github.io/visibly/articles/intro.html) |  |
| 4\. | [R Paket `{innsight}`](https://github.com/bips-hb/innsight) |  |
| 5\. | [R Paket `{snakecase}`](https://tazinho.github.io/snakecase/) |  |
| 6\. | [R Paket `{visdat}`](https://docs.ropensci.org/visdat/) |  |
| 7\. | [R Paket `{vroom}`](https://vroom.r-lib.org/) |  |
| 8\. | [R Paket `{gt}`](https://github.com/rstudio/gt) |  |
| 9\. | [R Paket `{gapminder}`](https://github.com/jennybc/gapminder) von [Gapminder](https://www.gapminder.org/data/) |  |

Diese Liste kann natürlich beliebig erweitert werden. Für mich ist es dann ein ewiger Arbeitsauftrag mich mal mit dieser Liste zu beschäftigen.
:::

## Links von Interesse

Kennst du das auch? Spannende Links, die man sich mal anschauen möchte? Aber noch nicht richtig weiß, wie und wo die Links mit reinpassen. Zwar haben alle was mit der Visualisierung zu tun, aber eventuell dann doch zu spezielle Themen.

| Nr. | Link | Beschreibung |
|----|----|----|
| 1\. | [ggplot2: Elegant Graphics for Data Analysis (3e)](https://ggplot2-book.org/) |  |
| 2\. | [Legend Attributes](https://github.com/tidyverse/ggplot2/wiki/Legend-Attributes) |  |
| 3\. | [Legenden in ggplot](https://www.tidyverse.org/blog/2024/02/ggplot2-3-5-0-legends/) | Hier erfahren wir dann nochmal mehr über die Legenden in einem `{ggplot}` und wie wir die Abbildung sauber beschriften. |
| 4\. | [override-aes](https://aosmith.rbind.io/2020/07/09/ggplot2-override-aes/) |  |
| 5\. | [Math in R](https://cran.r-project.org/view=NumericalMathematics) |  |
| 6\. | [Exploratory Data Analysis Checklist](https://bookdown.org/rdpeng/exdata/exploratory-data-analysis-checklist.html) |  |
| 7\. | [Principles of Effective Data Visualization](https://www.cell.com/patterns/fulltext/S2666-3899(20)30189-6) |  |
| 8\. | [Principles of Effective Data Visualization (PDF-Datei)](https://www.cell.com/action/showPdf?pii=S2666-3899%2820%2930189-6) |  |
| 9\. | [An Introduction to emojifont package](https://cran.r-project.org/web/packages/emojifont/vignettes/emojifont.html) |  |
| 10\. | [Emoji Unicode Tables](https://apps.timwhitlock.info/emoji/tables/unicode) |  |
| 11\. | [emo(ji)](https://github.com/hadley/emo) |  |
| 12\. | [Quick and easy ways to deal with long labels in ggplot2](https://www.andrewheiss.com/blog/2022/06/23/long-labels-ggplot/) |  |
| 13\. | [Generate expansion vector for scales](https://ggplot2.tidyverse.org/reference/expansion.html) |  |

## Referenzen {.unnumbered}

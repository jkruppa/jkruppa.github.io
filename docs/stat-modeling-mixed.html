<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.629">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Skript Bio Data Science - 44&nbsp; Lineare gemischte Modelle</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./stat-modeling-non-linear.html" rel="next">
<link href="./stat-modeling-poisson.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken"
  }
}</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Skript Bio Data Science</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Willkommen</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Literatur</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Einführung</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="./example-preface.html" class="sidebar-item-text sidebar-link">Datenbeispiele</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Von Flöhen und Hunden</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen, Hunden und Katzen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats-foxes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats-foxes-site.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren in Habitaten</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats-length-weight.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Von vielen Flöhen auf Hunden und Katzen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">Programmieren in R</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Von Buchstaben und Zahlen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Daten einlesen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">Explorative Datenanalyse</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="./stat-tests-preface.html" class="sidebar-item-text sidebar-link">Frequentistische Hypothesentests</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Der t-Test</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Die ANOVA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Der Wilcoxon-Mann-Whitney-Test</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Friedman Test</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Der <span class="math inline">\(\mathcal{X}^2\)</span>-Test</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Pre-Tests oder Vortest</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Multiple Vergleiche oder Post-hoc Tests</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">Grundlagen der linearen Regression</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Maßzahlen der Modelgüte</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Korrelation</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">Statistisches Modellieren</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Variablenselektion</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Ausreißer</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Imputation fehlender Werte</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Logistische Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale logistische Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Poisson Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">Experimentelles Design</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Grundlagen der Versuchsplanung</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">Klassifikation oder maschinelles Lernen</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Random Forest</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">Anhang</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-example-analysis.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Beispielhafte Auswertungen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-r-tutorial.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Tutorium in R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-how-to-write.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Writing principles</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-lectures-semester.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Logbuch</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-bewertungsbogen.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Bewertungsbogen</span></a>
  </div>
</li>
    </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc"><h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
<li><a href="#annahmen-an-die-daten" id="toc-annahmen-an-die-daten" class="nav-link active" data-scroll-target="#annahmen-an-die-daten"> <span class="header-section-number">44.1</span> Annahmen an die Daten</a></li>
  <li><a href="#genutzte-r-pakete-f%C3%BCr-das-kapitel" id="toc-genutzte-r-pakete-für-das-kapitel" class="nav-link" data-scroll-target="#genutzte-r-pakete-f%C3%BCr-das-kapitel"> <span class="header-section-number">44.2</span> Genutzte R Pakete für das Kapitel</a></li>
  <li><a href="#daten" id="toc-daten" class="nav-link" data-scroll-target="#daten"> <span class="header-section-number">44.3</span> Daten</a></li>
  <li><a href="#modellierung" id="toc-modellierung" class="nav-link" data-scroll-target="#modellierung"> <span class="header-section-number">44.4</span> Modellierung</a></li>
  <li><a href="#nested" id="toc-nested" class="nav-link" data-scroll-target="#nested"> <span class="header-section-number">44.5</span> Nested</a></li>
  <li><a href="#gee" id="toc-gee" class="nav-link" data-scroll-target="#gee"> <span class="header-section-number">44.6</span> GEE</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-mixed" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header><div class="cell">

</div>
<p><em>Version vom November 07, 2022 um 11:11:08</em></p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Einführung in die linearen gemischten Modelle per Video
</div>
</div>
<div class="callout-body-container callout-body">
<p>Du findest auf YouTube <a href="https://youtu.be/54ba9cn3MeY">Lineare gemischte Modelle</a> als Video Reihe. Ich werde zwar alles nochmal hier als Text aufschreiben, aber manchmal ist das Sehen und Hören dann einfacher.</p>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>Dieses Kapitel basiert auf dem tollen <a href="https://ourcodingclub.github.io/tutorials/mixed-models/">Tutorium von Gabriela K Hajduk</a>. Die Daten und Inhalte wurden von mir teilweise gekürzt sowie inhaltlich angepasst.</p>
</div></div><section id="annahmen-an-die-daten" class="level2" data-number="44.1"><h2 data-number="44.1" class="anchored" data-anchor-id="annahmen-an-die-daten">
<span class="header-section-number">44.1</span> Annahmen an die Daten</h2>
<p>Im folgenden Kapitel zu den linearen gemischten Modellen gehen wir davon aus, dass die Daten in der vorliegenden Form <em>ideal</em> sind. Das heißt wir haben weder fehlende Werte vorliegen, noch haben wir mögliche Ausreißer in den Daten. Auch wollen wir keine Variablen selektieren. Wir nehmen alles was wir haben mit ins Modell. Sollte eine oder mehre Bedingungen nicht zutreffen, dann schaue dir einfach die folgenden Kapitel an.</p>
<ul>
<li>Wenn du fehlende Werte in deinen Daten vorliegen hast, dann schaue bitte nochmal in das <a href="stat-modeling-missing.html"><span>Kapitel&nbsp;38</span></a> zu Imputation von fehlenden Werten.</li>
<li>Wenn du denkst, dass du Ausreißer oder auffälige Werte in deinen Daten hast, dann schaue doch bitte nochmal in das <a href="stat-modeling-outlier.html"><span>Kapitel&nbsp;36</span></a> zu Ausreißer in den Daten.</li>
<li>Wenn du denkst, dass du zu viele Variablen in deinem Modell hast, dann hilft dir das <a href="stat-modeling-variable-selection.html"><span>Kapitel&nbsp;36</span></a> bei der Variablenselektion.</li>
</ul>
<p>Das Thema Modellvergleich und Variablenselektion ist im Falle des linearen gemischten Modells nochmal etwas spezieller. Wir gehen hier auch nochmal in einem Abschnitt drauf ein, wie wir das hier in dem Fall von linearen gemischten Modellen machen.</p>
</section><section id="genutzte-r-pakete-für-das-kapitel" class="level2" data-number="44.2"><h2 data-number="44.2" class="anchored" data-anchor-id="genutzte-r-pakete-für-das-kapitel">
<span class="header-section-number">44.2</span> Genutzte R Pakete für das Kapitel</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">tidyverse</span>, <span class="va">magrittr</span>, <span class="va">conflicted</span>, <span class="va">broom</span>, <span class="va">see</span>,</span>
<span>               <span class="va">multcomp</span>, <span class="va">emmeans</span>, <span class="va">lme4</span>, <span class="va">broom.mixed</span>,</span>
<span>               <span class="va">parameters</span>, <span class="va">ggridges</span>, <span class="va">scales</span>, <span class="va">performance</span><span class="op">)</span></span>
<span><span class="fu">conflict_prefer</span><span class="op">(</span><span class="st">"select"</span>, <span class="st">"dplyr"</span><span class="op">)</span></span>
<span><span class="fu">conflict_prefer</span><span class="op">(</span><span class="st">"filter"</span>, <span class="st">"dplyr"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Am Ende des Kapitels findest du nochmal den gesamten R Code in einem Rutsch zum selber durchführen oder aber kopieren.</p>
</section><section id="daten" class="level2 page-columns page-full" data-number="44.3"><h2 data-number="44.3" class="anchored" data-anchor-id="daten">
<span class="header-section-number">44.3</span> Daten</h2>
<p>In diesem fiktiven Datenbeispiel wollen wir uns die Testscores eines Intelligentest bei <span class="math inline">\(N = 480\)</span> Drachen anschauen. Wir sind dafür an acht Berge gefahren und haben die dortigen Drachen an den drei Flanken des Berges getestet. Daher hat der Faktor <code>mountain_range</code> acht Level mit Bavarian, Ligurian, Emmental, Central, Maritime, Southern, Julian, und Sarntal. Die drei Flanken des Berges bilden wir im Faktor <code>site</code> mit den Leveln north, east und south ab. In <a href="#fig-mountain-site">Abbildung&nbsp;<span>44.1</span></a> sehen wir eine Skizze für drei Berge mit den jeweiligen Flanken, wo gemessen wurde.</p>
<div id="fig-mountain-site" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/mountain.png" class="img-fluid figure-img" style="width:90.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Abbildung 44.1— Beispiel für drei der acht Berge mit <em>Bavarian</em>, <em>Central</em> und <em>Julian</em>. Auf jeden der acht Berge wurden an drei Seiten <em>north</em>, <em>east</em> und <em>south</em> die Testscores der dort lebenden Drachen erhoben.</figcaption><p></p>
</figure>
</div>
<p>Die Daten liegen in dem Datensatz <code>dragons.csv</code> ab. Wir müssen aber noch einen Faktor <code>body_length_cat</code> bilden in dem wir die <code>body_length</code> der einzelnen Drachen in Kategorien umwandeln. Wir wollen später noch Gruppenvergleiche rechnen und brauchen daher einen Faktor mit Leveln. Daher nutzen wir die Funktion <code>case_when()</code> um einen Faktor mit fünf Größenkategorien zu bilden. Danach müssen wir wie immer noch die <code>character</code> Spalten in die entsprechenden Faktoren umwandeln.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dragons_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv2</a></span><span class="op">(</span><span class="st">"data/dragons.csv"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>body_length_cat <span class="op">=</span> </span>
<span>           <span class="fu">case_when</span><span class="op">(</span><span class="va">body_length</span> <span class="op">&lt;</span> <span class="fl">170</span> <span class="op">~</span> <span class="st">"tiny"</span>,</span>
<span>                     <span class="va">body_length</span> <span class="op">&gt;=</span> <span class="fl">170</span> <span class="op">&amp;</span> <span class="va">body_length</span> <span class="op">&lt;</span> <span class="fl">180</span> <span class="op">~</span> <span class="st">"small"</span>,</span>
<span>                     <span class="va">body_length</span> <span class="op">&gt;=</span> <span class="fl">180</span> <span class="op">&amp;</span> <span class="va">body_length</span> <span class="op">&lt;</span> <span class="fl">200</span> <span class="op">~</span> <span class="st">"medium"</span>,</span>
<span>                     <span class="va">body_length</span> <span class="op">&gt;=</span> <span class="fl">200</span> <span class="op">&amp;</span> <span class="va">body_length</span> <span class="op">&lt;</span> <span class="fl">220</span> <span class="op">~</span> <span class="st">"large"</span>,</span>
<span>                     <span class="va">body_length</span> <span class="op">&gt;=</span> <span class="fl">220</span> <span class="op">~</span> <span class="st">"gigantic"</span><span class="op">)</span>,</span>
<span>         body_length_cat <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">body_length_cat</span><span class="op">)</span>,</span>
<span>         mountain_range <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">mountain_range</span><span class="op">)</span>,</span>
<span>         site <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">site</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"north"</span>, <span class="st">"east"</span>, <span class="st">"south"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">test_score</span>, <span class="va">body_length</span>, <span class="va">body_length_cat</span>, <span class="fu">everything</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Es ergibt sich dann der Datensatz wie in <a href="#tbl-dragon">Tabelle&nbsp;<span>44.1</span></a> gezeigt. Wir belassen die Körperlänge der Drachen in der kontinuierlichen Form nochmal mit in den Daten.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<div id="tbl-dragon" class="anchored">
<table class="table table-sm table-striped">
<caption>Tabelle 44.1— Datensatz der Testscores für die Drachen auf verschiedenen Bergen und dort an verschiedenen Flanken der Berge.</caption>
<colgroup>
<col style="width: 5%">
<col style="width: 17%">
<col style="width: 18%">
<col style="width: 24%">
<col style="width: 23%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">test_score</th>
<th style="text-align: center;">body_length</th>
<th style="text-align: center;">body_length_cat</th>
<th style="text-align: center;">mountain_range</th>
<th style="text-align: center;">site</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: center;">16.15</td>
<td style="text-align: center;">165.55</td>
<td style="text-align: center;">tiny</td>
<td style="text-align: center;">Bavarian</td>
<td style="text-align: center;">north</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: center;">33.89</td>
<td style="text-align: center;">167.56</td>
<td style="text-align: center;">tiny</td>
<td style="text-align: center;">Bavarian</td>
<td style="text-align: center;">north</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: center;">6.04</td>
<td style="text-align: center;">165.88</td>
<td style="text-align: center;">tiny</td>
<td style="text-align: center;">Bavarian</td>
<td style="text-align: center;">north</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: center;">18.84</td>
<td style="text-align: center;">167.69</td>
<td style="text-align: center;">tiny</td>
<td style="text-align: center;">Bavarian</td>
<td style="text-align: center;">north</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="even">
<td style="text-align: left;">477</td>
<td style="text-align: center;">59.37</td>
<td style="text-align: center;">213.58</td>
<td style="text-align: center;">large</td>
<td style="text-align: center;">Sarntal</td>
<td style="text-align: center;">south</td>
</tr>
<tr class="odd">
<td style="text-align: left;">478</td>
<td style="text-align: center;">68.75</td>
<td style="text-align: center;">207.63</td>
<td style="text-align: center;">large</td>
<td style="text-align: center;">Sarntal</td>
<td style="text-align: center;">south</td>
</tr>
<tr class="even">
<td style="text-align: left;">479</td>
<td style="text-align: center;">74.89</td>
<td style="text-align: center;">198.25</td>
<td style="text-align: center;">medium</td>
<td style="text-align: center;">Sarntal</td>
<td style="text-align: center;">south</td>
</tr>
<tr class="odd">
<td style="text-align: left;">480</td>
<td style="text-align: center;">65.95</td>
<td style="text-align: center;">208.06</td>
<td style="text-align: center;">large</td>
<td style="text-align: center;">Sarntal</td>
<td style="text-align: center;">south</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Bevor wir mit dem Modellieren beginnen, wollen wir erstmal visuell überprüfen, ob unser Outcome <span class="math inline">\(y\)</span> mit dem Testscore auch normalverteilt ist. Wir benötigen für das <em>klaissche</em> lineare gemischte Modell ein normalverteiltes Outcome <span class="math inline">\(y\)</span>. In <a href="#fig-mixed-1">Abbildung&nbsp;<span>44.2</span></a> sehen wir das Histogramm der Verteilung des Testscores für alle <span class="math inline">\(N = 480\)</span> Drachen.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dragons_tbl</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">test_score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-mixed-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-mixed_files/figure-html/fig-mixed-1-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Abbildung 44.2— Histogramm des Testscores über alle Datenpunkte zur Überprüfung der Annahme der Normalverteilung. Wir sehen eine approximative Normalverteilung des Testscores.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Wir können in der <a href="#fig-mixed-2">Abbildung&nbsp;<span>44.3</span></a> auch nochmal schauen, ob die Annahme der annährenden Normalverteilung für unseren Testscore auch für jedes Level unseres Faktors der Körperlängen gegeben ist. Wir sehen auch hier, dass der Testscore einer Normalverteilung über alle Kategorien der Körperlänge folgt.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dragons_tbl</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">body_length_cat</span>, x <span class="op">=</span> <span class="va">test_score</span>, fill <span class="op">=</span> <span class="va">body_length_cat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_density_ridges</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_okabeito</span><span class="op">(</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-mixed-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-mixed_files/figure-html/fig-mixed-2-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Abbildung 44.3— Histogramm des Testscores aufgeteilt nach Kategorie der Körpergröße zur Überprüfung der Annahme der Normalverteilung. Wir sehen eine approximative Normalverteilung des Testscores für alle Kategorien der Körpergröße.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Natürlich können wir uns hier noch weitere Abbildungen erstellen, aber hier soll es erstmal reichen. Wir sehen, dass der Testscore einer Normalverteilung folgt und dass die Varianzen vermutlich homogen sind, da die Histogramme ungefähr gleich breit sind. Ja, ein wenig unterscheiden sich die Verteilungen, aber so gravierend ist es erstmal nicht.</p>
</section><section id="modellierung" class="level2 page-columns page-full" data-number="44.4"><h2 data-number="44.4" class="anchored" data-anchor-id="modellierung">
<span class="header-section-number">44.4</span> Modellierung</h2>
<p>Im Folgenden wollen wir uns verschiedene statistische Modelle anschauen um uns dem linearen gemischten Modell einmal anzunähern. Dabei beginnen wir mit einem simplen Gaussian lineare Modell mit einem Faktor <span class="math inline">\(f_1\)</span>:</p>
<p><span class="math display">\[
y \sim f_1
\]</span></p>
<p>Wir haben also nur einen Faktor in unserem Modell vorliegen und ignorieren die restlichen in den Daten vorhandenen Variablen.</p>
<p>Als zweites Modell betrachten wir eine multiples Gaussian lineares Modell mit einem Faktor <span class="math inline">\(f_1\)</span> und einem Blockfaktor <span class="math inline">\(b_1\)</span>:</p>
<p><span class="math display">\[
y \sim f_1 + b_1
\]</span></p>
<p>Jetzt erweitern wir das Modell nochmal um einen Block oder auch Clustereffekt. Das heißt, wir haben alle Beobachtungen nicht auf einem Feld oder in einem Stall durchgeführt, sondern an mehreren Orten.</p>
<p>Der eigentliche Bruch kommt jetzt. Wie wollen wir den Effekt des Blocks betrachten? Hier entscheidet sich, ob wir den Block als festen Effekt (eng. <em>fixed effect</em>) oder als zufälligen Effekt (eng. <em>random effect</em>) ausweisen wollen. Zuerst ist dies eine Modellierungsentscheidung. Wir müssen uns also zwischen zwei Modellen entscheiden. Daher können wir auch beide Arten bauen und dann Modelle vergleichen. Machen wir dann auch am Ende des Kapitels.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Die Idee hinter dem Modell mit <strong>festen Effekten</strong> ist, dass die beobachteten Effektgrößen von Block zu Block variieren können, was aber nur auf den Stichprobenfehler <span class="math inline">\(\epsilon\)</span> zurückzuführen ist. In Wirklichkeit sind die wahren Effektgrößen alle gleich: Sie sind fix. (siehe auch <a href="https://bookdown.org/MathiasHarrer/Doing_Meta_Analysis_in_R/pooling-es.html#fem">The Fixed-Effect Model</a>)</p>
</div><div class="">
<p>Das Modell der <strong>zufälligen Effekte</strong> geht davon aus, dass es nicht nur eine wahre Effektgröße gibt, sondern eine Verteilung der wahren Effektgrößen. Das Ziel des Modells mit zufälligen Effekten ist es daher nicht, die eine wahre Effektgröße aller Studien zu schätzen, sondern den Mittelwert der Verteilung der wahren Effekte. (siehe auch <a href="https://bookdown.org/MathiasHarrer/Doing_Meta_Analysis_in_R/pooling-es.html#rem">The Random-Effect Model</a>)</p>
</div></div>
<p>Daher kommt jetzt als drittes Model ein multiples Gaussian lineares gemischtes Modell mit einem festen Faktor <span class="math inline">\(f_1\)</span> und einem zufälligen Blockfaktor <span class="math inline">\(z_1\)</span>:</p>
<p><span class="math display">\[
y \sim f_1 + 1|z_1
\]</span></p>
<p>Wir schreiben in R den Term für da zufällige Modell in der Form <span class="math inline">\(z_0|z_1\)</span>. Meist setzen wir den Intercept <span class="math inline">\(z_0\)</span> für den zufälligen Effekt auf <code>1</code>.</p>
<p>Abschießend schauen wir uns noch ein multiples Gaussian lineares gemischtes Modell mit einem festen Faktor <span class="math inline">\(f_1\)</span> und einem zufälligen Blockfaktor <span class="math inline">\(z_2\)</span> genested in einem einem zufälligen Blockfaktor <span class="math inline">\(z_1\)</span>:</p>
<p><span class="math display">\[
y \sim f_1 + 1|z_1/z_2
\]</span></p>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="aside">Wir sagen <em>nested</em>, wenn wir meinen, dass ein Faktor in einen anderen Faktor verschränkt ist. Die Klassen einer Schule sind in der Schule genested.</span></div></div>
<p>Das heißt, dass der zufällige Blockfaktor <span class="math inline">\(z_2\)</span> in den zufälligen Blockfaktor <span class="math inline">\(z_1\)</span> genested ist. Das heist, die Faktorlevel des Blockfaktors <span class="math inline">\(z_2\)</span> finden sich jeweils nur in jeweils einem der Faktorlevel des Blocks <span class="math inline">\(z_1\)</span>. Das klingt jetzt etwas schräg, also einmal ein Beispiel. Wir haben eine Schule, dann sind die Schulklassen dieser Schule in der Schule genested. Es gibt diese spezifischen Klassen mit den Schülern schlichtweg nicht in anderen Schulen.</p>
<p>Bevor wir jetzt mit dem Modellieren beginnen, müssen wir noch kurz in einem QQ-Plot schauen, ob unser Ourcome <code>testscore</code> auch ungefähr normalverteilt ist. <a href="#fig-mixed-6">Abbildung&nbsp;<span>44.4</span></a> zeigt den QQ-Plot des Testscores. Wir sehen, dass der Hauptteil der Beobachtungen auf der Geraden liegt und wir nehmen daher an, dass der Testscore zumindest approximativ normalverteilt ist. Wir können also mit einem gaussian linearen gemischten Modell weitermachen.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dragons_tbl</span>, <span class="fu">aes</span><span class="op">(</span>sample <span class="op">=</span> <span class="va">test_score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_qq</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">stat_qq_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_okabeito</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-mixed-6" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-mixed_files/figure-html/fig-mixed-6-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Abbildung 44.4— QQ-Plot zu Überprüfung, ob der Testscore einer Normalverteilung folgt. Die Punkte liegen ungefähr auf der Geraden als Winkelhalbierende, so dass wi eine Normalverteilung des Testscores annehmen können.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Schauen wir uns nun als erstes das Modell <code>lm_simple_fit</code> einmal an. Wir bauen das Modell nur mit der Faktorvariable <code>body_length_cat</code>. Wir erhalten dann gleich die Ausgabe des Modells über die Funktion <code>model_parameters()</code> in einer aufgearbeiteten Form.</p>
<div class="cell column-page">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lm_simple_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">body_length_cat</span>, data <span class="op">=</span> <span class="va">dragons_tbl</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lm_simple_fit</span> <span class="op">%&gt;%</span> <span class="fu">model_parameters</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter                  | Coefficient |   SE |         95% CI | t(475) |      p
----------------------------------------------------------------------------------
(Intercept)                |       24.61 | 4.33 | [16.10, 33.12] |   5.68 | &lt; .001
body length cat [small]    |        2.63 | 5.39 | [-7.96, 13.21] |   0.49 | 0.626 
body length cat [medium]   |       24.89 | 4.68 | [15.70, 34.07] |   5.32 | &lt; .001
body length cat [large]    |       32.50 | 4.55 | [23.56, 41.43] |   7.15 | &lt; .001
body length cat [gigantic] |       29.32 | 5.20 | [19.10, 39.54] |   5.64 | &lt; .001</code></pre>
</div>
</div>
<p>Der Intercept beinhaltet den Mittelwert für die Drachen des Levels <code>[tiny]</code>. Die jeweiligen Koeffizienten dann die Abweichung von den Drachen des Levels <code>[tiny]</code>. Daher sind Drachen des Levels <code>[small]</code> ungefähr um <span class="math inline">\(2.63\)</span> Einheiten intelligenter. Wir sehen dann an dem <span class="math inline">\(p\)</span>-Wert, ob sich die Koeffizienten signifikant von 0 unterscheiden. In <a href="#fig-mixed-3">Abbildung&nbsp;<span>44.5</span></a> sehen wir nochmal die Boxplots der einzelnen Testscores aufgeteilt nach der Körpergröße. Wir erkennen, dass die kleineren Drachen tendenziell dümmer sind als die großen Drachen. Wir sehen zwei Plateaus.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dragons_tbl</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">body_length_cat</span>, y <span class="op">=</span> <span class="va">test_score</span>, fill <span class="op">=</span> <span class="va">body_length_cat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_okabeito</span><span class="op">(</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-mixed-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-mixed_files/figure-html/fig-mixed-3-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Abbildung 44.5— Boxplots der einzelnen Testscores aufgeteilt nach der Körpergröße.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Nun haben wir aber nicht nur die Körpergrößen gemessen sondern auch auf welchem Berg wir die jeweiligen Drachen gefunden haben. Nun könnte es sein, dass der Berg einen viel größeren Einfluss auf die Inteliegenz hat als die Drachenkörpergröße. Wir könnten einen Confoundereffekt durch die Berge vorliegen haben. Ergänzen wir also das Modell um den Faktor <code>mountain_range</code> und erhalten das Modell <code>lm_mountain_fit</code>.</p>
<div class="cell column-page">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lm_mountain_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">body_length_cat</span> <span class="op">+</span> <span class="va">mountain_range</span>, data <span class="op">=</span> <span class="va">dragons_tbl</span><span class="op">)</span></span>
<span><span class="va">lm_mountain_fit</span> <span class="op">%&gt;%</span> <span class="fu">model_parameters</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter                  | Coefficient |   SE |         95% CI | t(468) |      p
----------------------------------------------------------------------------------
(Intercept)                |       20.93 | 3.34 | [14.36, 27.49] |   6.27 | &lt; .001
body length cat [small]    |        1.67 | 3.89 | [-5.98,  9.32] |   0.43 | 0.668 
body length cat [medium]   |        3.55 | 3.72 | [-3.76, 10.85] |   0.95 | 0.341 
body length cat [large]    |        3.59 | 4.30 | [-4.86, 12.03] |   0.83 | 0.405 
body length cat [gigantic] |        0.08 | 4.85 | [-9.45,  9.60] |   0.02 | 0.988 
mountain range [Ligurian]  |       17.33 | 3.58 | [10.28, 24.37] |   4.83 | &lt; .001
mountain range [Emmental]  |       15.91 | 3.63 | [ 8.79, 23.04] |   4.39 | &lt; .001
mountain range [Central]   |       35.62 | 3.69 | [28.36, 42.88] |   9.64 | &lt; .001
mountain range [Maritime]  |       48.75 | 3.24 | [42.39, 55.11] |  15.06 | &lt; .001
mountain range [Southern]  |        8.47 | 2.74 | [ 3.08, 13.85] |   3.09 | 0.002 
mountain range [Julian]    |       45.74 | 3.86 | [38.15, 53.33] |  11.85 | &lt; .001
mountain range [Sarntal]   |       41.03 | 3.30 | [34.54, 47.53] |  12.42 | &lt; .001</code></pre>
</div>
</div>
<p>Wie wir sehen, werden nun die Körpergrößen der Drachen nicht mehr als signifikant ausgegeben. Die Effekte der Körpergröße auf den Testscore sind auch viel kleiner geworden, wenn wir die <code>mountain_range</code> mit in das Modell nehmen. Anscheinend hat der Berg auf dem wir den Drachen getroffen haben einen viel größeren Einfluss auf die Intelligenz als die Körpergröße. Wir können uns den Zusammenhang zwischen dem Testscore und dem Berg auch in der <a href="#fig-mixed-4">Abbildung&nbsp;<span>44.6</span></a> einmal anschauen.</p>
<p>Eigentlich würden wir erwarten, dass es keinen Effekt der Berge auf den Testscore der Drachen gibt. Es müsste eigentlich egal sein, wo wir einen Drachen befragen, wenn wir nur an der Körpergröße und dem Testscore interessiert sind. Wir sehen jedoch in der <a href="#fig-mixed-4">Abbildung&nbsp;<span>44.6</span></a> einen klaren Unterschied zwischen den Bergen im Bezug auf den Testscore.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dragons_tbl</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">mountain_range</span>, <span class="va">test_score</span>, fill <span class="op">=</span> <span class="va">mountain_range</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_okabeito</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-mixed-4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-mixed_files/figure-html/fig-mixed-4-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Abbildung 44.6— Boxplots der einzelnen Testscores aufgeteilt nach dem Berg der Befragung.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>In der <a href="#fig-mixed-5">Abbildung&nbsp;<span>44.7</span></a> sehen wir den Zusammenhang von Testscore und der Körpergröße sowie den Bergen auf denen das Interview stattgefunden hat. so langsam dämmert uns warum wir hier einen Effekt der Körperlänge zu dem Testscore sehen. Die kleineren Drache sind alle nur auf bestimmten Bergen zu finden! Betrachten wir die Berge mit in dem Modell, dann hat die Körpergröße keinen Einfluß mehr.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dragons_tbl</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">body_length_cat</span>, y <span class="op">=</span> <span class="va">test_score</span>, fill <span class="op">=</span> <span class="va">mountain_range</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span>preserve <span class="op">=</span> <span class="st">"single"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_okabeito</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Mountain"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-mixed-5" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-mixed_files/figure-html/fig-mixed-5-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Abbildung 44.7— Boxplots der einzelnen Testscores aufgeteilt nach dem Berg der Befragung und der Körpergröße.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Der Zusammenhang wird vielleicht in <a href="#fig-mixed-7">Abbildung&nbsp;<span>44.8</span></a> nochmal klarer. Hier schauen wir uns den Zusamenhang wieder für die Körperlänge getrennt für die Berge an. Nur zeichnen wir jetzt jeden einzelnen Berg in ein Subplot. Wir sehen, dass es hier fast keinen Unterschied macht, wie lang die Drachen sind. Der Testscore ist immer gleich. Was einen Unterschied macht, sind die Berge.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dragons_tbl</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">body_length_cat</span>, y <span class="op">=</span> <span class="va">test_score</span>, fill <span class="op">=</span> <span class="va">mountain_range</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span>preserve <span class="op">=</span> <span class="st">"single"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_okabeito</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Mountain"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">mountain_range</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-mixed-7" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-mixed_files/figure-html/fig-mixed-7-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Abbildung 44.8— Boxplots der einzelnen Testscores aufgeteilt nach dem Berg der Befragung und der Körpergröße in getrennten Subplots.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Schauen wir uns nun einmal ein lineares gemischtes Modell an. Wir nutzen daszu das R Paket <code>lme4</code>. Wir haben auch noch andere Pakete zur Aswahl, aber wir nutzen hier erstmal das gängiste Paket. Um ein lineares gemischtes Modell in R zu schätzen nutzen wir die Funktion <code>lmer()</code>. Die Funktion <code>lmer()</code> nimmt an, dass das Outcome <code>test_score</code> normalverteilt ist. Wir haben diese Annahme ja weiter oben in dem QQ-Plot überprüft.</p>
<p>In einem lineare gemischten Modell müssen wir die <em>festen</em> Effekte sowie die <em>zufälligen</em> Effekte definieren. Die festen Effekte werden ganz normal wie wir es gewohnt sind in das Modell eingegeben. Die zufälligen Effkete schreiben wir in eine Klammer in der Form <code>(1|)</code>.</p>
<p>Wir schreiben <code>(1|moutain_range)</code> und definieren damit die Variable <code>mountain_range</code> als zufälligen Effekt im Modell. Wir schreiben <code>1|</code> vor <code>mountain_range</code>, da wir für jeden Berg die gleiche Steigung von Körperlänge und Testscore annehmen. Wir können dann später noch das Model komplizierter aufbauen und jedem Berg eine eigene Steigung erlauben. Bauen wir uns jetzt erstmal ein lineares gemischtes Modell mit einem festen Effekt <code>body_length_cat</code> und einem zufälligen Effekt <code>(1|mountain_range)</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lmer_1_fit</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">body_length_cat</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">mountain_range</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">dragons_tbl</span><span class="op">)</span></span>
<span><span class="va">lmer_1_fit</span> <span class="op">%&gt;%</span> <span class="fu">model_parameters</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter                  | Coefficient |   SE |         95% CI | t(473) |      p
----------------------------------------------------------------------------------
(Intercept)                |       46.85 | 7.43 | [32.25, 61.45] |   6.30 | &lt; .001
body length cat [small]    |        1.68 | 3.89 | [-5.97,  9.33] |   0.43 | 0.666 
body length cat [medium]   |        4.08 | 3.71 | [-3.20, 11.37] |   1.10 | 0.271 
body length cat [large]    |        4.49 | 4.27 | [-3.90, 12.88] |   1.05 | 0.293 
body length cat [gigantic] |        1.03 | 4.81 | [-8.43, 10.49] |   0.21 | 0.831 

# Random Effects

Parameter                      | Coefficient |   SE |         95% CI
--------------------------------------------------------------------
SD (Intercept: mountain_range) |       18.21 | 4.94 | [10.70, 30.98]
SD (Residual)                  |       14.96 | 0.49 | [14.03, 15.95]</code></pre>
</div>
</div>
<p>Unser Model sieht etwas aufgeräumter aus. Als feste Effekte haben wir nur noch die Körperlänge <code>body_length_cat</code> und die dazugehörigen Koeffizienten des Modells. Unsere Variable <code>mountain_range</code> verschwindet dann in den zufälligen Effekten. Die Funktion <code>summary</code> liefert uns den gesamten Ausdruck, der etwas überwältigend ist. Vieles brauchen wir auch nicht davon.</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lmer_1_fit</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/lmer_summary.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
<p>Was wir extrahieren wollen ist die Information von den zufälligen Effekten. Wir wollen wissen, wieviel Varianz durch die zufälligen Effekte erklärt wird. Wir nutzen dazu die Funktion <code>VarCorr()</code>, die uns erlaubt die Information zu en zufälligen Effekten zu extrahieren und auszugeben.</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">VarCorr</span><span class="op">(</span><span class="va">lmer_1_fit</span><span class="op">)</span>, comp <span class="op">=</span> <span class="st">"Variance"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Groups         Name        Variance
 mountain_range (Intercept) 331.422 
 Residual                   223.828 </code></pre>
</div>
</div>
<p>Wieviel Varianz erklären nun die Berge? Wir können die erklärte Varianz der zufälligen Effekte einfach berechnen. Wir vergleichen die erklärte Varianz von <code>mountain_range</code> mit der gesamten Varianz. Die gesamte Varianz ist die Varianz aller zufälligen Effekte plus der residualen Vamrianz. Wir erhalten dann <span class="math inline">\(R^2_{random} = 339.7/(339.7 + 223.8) \approx 0.60\)</span>. Wir sehen, dass ca. 60% der Varianz in unseren Daten von der Variable <code>mountain_range</code> verursacht wird.</p>
<p>Wir können die Funktion <code>model_performance()</code> nutzen um mehr über den Fit des Modells zu erfahren. Das <code>R2 (cond.)</code> ist faktisch das gleiche wie wir gerade oben berechnet haben. Wir benötigen also nicht immer den Ausdruck der zufälligen Effekte. Wir können auch die Informationen aus der Funktion <code>model_performance()</code> nehmen.</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lmer_1_fit</span> <span class="op">%&gt;%</span> <span class="fu">model_performance</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC      |     AICc |      BIC | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
----------------------------------------------------------------------------------
3983.403 | 3983.640 | 4012.620 |      0.598 |      0.004 | 0.597 | 14.774 | 14.961</code></pre>
</div>
</div>
<p>In der Abbildung <a href="#fig-mixed-8">Abbildung&nbsp;<span>44.9</span></a> schauen wir uns nochmal an, ob wir das Modell auch gut gefittet haben. Der Residualplot sieht gut aus, wir erkennen kein Muster. Ebenso sieht der QQ-Plot gut aus, die Beobachtungen liegen alle auf der Geraden. Wir sind mit dem Modell soweit erstmal ganz zufrieden.</p>
<div id="fig-mixed-8" class="cell column-page quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-mixed-8-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-mixed_files/figure-html/fig-mixed-8-1.png" class="img-fluid figure-img" data-ref-parent="fig-mixed-8" width="480"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">(a) Residualplot</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-mixed-8-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-mixed_files/figure-html/fig-mixed-8-2.png" class="img-fluid figure-img" data-ref-parent="fig-mixed-8" width="480"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">(b) QQ-Plot</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption aria-hidden="true" class="figure-caption">Abbildung 44.9— Visuelle Überprüfung des Modells mit dem Residual und QQ-Plot.</figcaption><p></p>
</figure>
</div>
<p>Wir haben noch eine Variable in unseren Daten ignoriert. Wir haben uns bis jetzt nicht die Variabl <code>site</code> angeschaut. Auf jedem Berg haben wir die Drachen noch auf verschiedenen Flanken des Berges <code>site</code> befragt. Das heißt, wir haben die Variable <code>site</code>, die in der Variable <code>mountain_site</code> genestet ist. Wir schreiben daher ein neues Modell und nutzen die Schreibweise <code>(1|mountain_range/site)</code> um zu beschreiben, dass <code>site</code> immer zusamen in einem Berg vorkommt. Schaue dir dazu nochmal die Abbidlung ganz zu Beginn dieses Kapitels an um die Zusammenhänge nochmal visualisiert zu bekommen.</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lmer_2_fit</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">test_score</span> <span class="op">~</span> <span class="va">body_length_cat</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">mountain_range</span><span class="op">/</span><span class="va">site</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">dragons_tbl</span><span class="op">)</span> </span>
<span><span class="va">lmer_2_fit</span> <span class="op">%&gt;%</span> <span class="fu">model_parameters</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter                  | Coefficient |   SE |          95% CI | t(472) |      p
-----------------------------------------------------------------------------------
(Intercept)                |       46.89 | 7.80 | [ 31.56, 62.22] |   6.01 | &lt; .001
body length cat [small]    |        1.32 | 3.99 | [ -6.51,  9.16] |   0.33 | 0.740 
body length cat [medium]   |        3.34 | 4.61 | [ -5.73, 12.41] |   0.72 | 0.470 
body length cat [large]    |        4.85 | 5.15 | [ -5.26, 14.97] |   0.94 | 0.346 
body length cat [gigantic] |        1.37 | 5.83 | [-10.08, 12.83] |   0.24 | 0.814 

# Random Effects

Parameter                           | Coefficient |   SE |         95% CI
-------------------------------------------------------------------------
SD (Intercept: site:mountain_range) |        4.79 | 1.29 | [ 2.83,  8.12]
SD (Intercept: mountain_range)      |       17.88 | 4.97 | [10.36, 30.84]
SD (Residual)                       |       14.46 | 0.48 | [13.55, 15.43]</code></pre>
</div>
</div>
<p>Das Modell hat nun einen weiteren zufälligen Effekt. Es werden jetzt auch nochmal für jeden Berg die Flankeneffekte mit berücksichtigt. Hat das überhaupt einen Einfluss auf das Modell? Schauen wir uns einmal die Modellgüte mit der Funktion <code>model_performance()</code> an.</p>
<div class="cell column-page">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lmer_2_fit</span> <span class="op">%&gt;%</span> <span class="fu">model_performance</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC      |     AICc |      BIC | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
----------------------------------------------------------------------------------
3970.693 | 3970.999 | 4004.084 |      0.623 |      0.004 | 0.621 | 14.120 | 14.460</code></pre>
</div>
</div>
<p>Wir sehen, dass sich die erklärte varianz leicht erhöht hat. Die <span class="math inline">\(R^2_{random}\)</span> liegt jetzt bei <span class="math inline">\(0.623\)</span> also fast 62%. Etwas besser als vorher, aber auch nicht unbedingt sehr viel mehr.</p>
<p>Wie können wir nun unsere vier Modelle miteinander vergleichen? Wir haben ja folgende Modelle vorliegen:</p>
<ul>
<li>Das simple lineare Modell <code>lm_simple_fit</code> mit <code>test_score ~ body_length_cat</code>.</li>
<li>Das multiple lineare Modell <code>lm_mountain_fit</code> mit <code>test_score ~ body_length_cat + mountain_range</code>.</li>
<li>Das gemischte lineare Modell <code>lmer_1_fit</code> mit <code>test_score ~ body_length_cat + (1|mountin_range)</code>.</li>
<li>Das genestete gemischte lineare Modell <code>lmer_2_fit</code> mit <code>test_score ~ body_length_cat + (1|mountain_range/site)</code>.</li>
</ul>
<p>Um die Modelle miteinander zu vergleichen können wir die Funktion <code>compare_performance()</code> nutzen. Wir erhalten mit der Option <code>rank = TRUE</code> auch eine Sortierung der Modelle wieder. Das beste Modell steht dann ganz oben.</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">compare_performance</span><span class="op">(</span><span class="va">lm_simple_fit</span>, <span class="va">lm_mountain_fit</span>, <span class="va">lmer_1_fit</span>, <span class="va">lmer_2_fit</span>, rank <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name            |   Model |   RMSE |  Sigma | AIC weights | BIC weights | Performance-Score
-------------------------------------------------------------------------------------------
lm_mountain_fit |      lm | 14.772 | 14.960 |       1.000 |       0.330 |            83.11%
lmer_2_fit      | lmerMod | 14.120 | 14.460 |    5.84e-05 |       0.655 |            75.00%
lmer_1_fit      | lmerMod | 14.774 | 14.961 |    1.72e-07 |       0.016 |            46.11%
lm_simple_fit   |      lm | 20.661 | 20.770 |    1.24e-67 |    9.06e-62 |             0.00%</code></pre>
</div>
</div>
<p>In diesem Beispiel wäre sogar eine multiple lineare Regression das beste Modell. Wir würden also auch mit zwei festen Effekten die Variabilität der Berge richtig mdellieren. Der Effekt der Flanken auf den Testscore scheint ziemlich klein zu sein, so dass wir auch auf die Variable <code>site</code> verzichten können.</p>
<p>Was machen wir jetzt noch zum Schluß? Wir machen noch einen paarweisen Vergleich über alle Level der Vaeiable <code>body_length_cat</code>. Ich will hier nochmal zeigen, wie du einen multiplen Vergleich mit einem gemischten Modell in R rechnen kannst. Wir nutzen hier dann das R Paket <code>emmeans</code> um das <em>compact letter display</em> nutzen zu können.</p>
<p>Als erstes nutzen wir die Funktion <code>emmeans</code> um die multiplen Vergleich über alle Level des Faktors <code>body_length_cat</code> zurechnen.</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">res_lmer</span> <span class="op">&lt;-</span> <span class="va">lmer_2_fit</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">emmeans</span><span class="op">(</span><span class="op">~</span> <span class="va">body_length_cat</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Im Weiteren nutzen wir jetzt das Objekt <code>res_lmer</code> um die Vergleiche zu rechnen und zu asjustieren. Wir nutzen die Bonferroni Methode für die Adjustierung der <span class="math inline">\(p\)</span>-Werte.</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">res_lmer</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">contrast</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"pairwise"</span>, adjust <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast          estimate   SE  df t.ratio p.value
 tiny - small       -1.3218 4.02 453  -0.329  1.0000
 tiny - medium      -3.3379 4.76 118  -0.701  1.0000
 tiny - large       -4.8531 5.31 148  -0.914  1.0000
 tiny - gigantic    -1.3744 6.02 152  -0.228  1.0000
 small - medium     -2.0161 3.83 134  -0.526  1.0000
 small - large      -3.5313 4.50 179  -0.784  1.0000
 small - gigantic   -0.0526 5.32 175  -0.010  1.0000
 medium - large     -1.5152 2.39 362  -0.634  1.0000
 medium - gigantic   1.9635 3.71 229   0.529  1.0000
 large - gigantic    3.4787 2.95 241   1.178  1.0000

Degrees-of-freedom method: kenward-roger 
P value adjustment: bonferroni method for 10 tests </code></pre>
</div>
</div>
<p>Wenn wir an dem <em>compact letter display</em> interessiert sind, dann müsen wir die Funktion <code>cld()</code> nutzen. Was wir brauchen, hängt dann immer davon ab, was wir zeigen wollen und was die Fragestellung ist.</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">res_lmer_cld</span> <span class="op">&lt;-</span> <span class="va">res_lmer</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">cld</span><span class="op">(</span>adjust <span class="op">=</span> <span class="st">"bonferroni"</span>, Letters <span class="op">=</span> <span class="va">letters</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tidy</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">body_length_cat</span>, <span class="va">estimate</span>, <span class="va">conf.low</span>, <span class="va">conf.high</span>, <span class="va">.group</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="va">round</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res_lmer_cld</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  body_length_cat estimate conf.low conf.high .group
  &lt;chr&gt;              &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt; 
1 tiny                46.9     23.6      70.2 " a"  
2 small               48.2     25.5      71.0 " a"  
3 gigantic            48.3     25.8      70.7 " a"  
4 medium              50.2     27.8      72.7 " a"  
5 large               51.7     29.2      74.2 " a"  </code></pre>
</div>
</div>
<p>An dem <em>compact letter display</em> sehen wir schon, dass es keinen Unterschied zwischen den Gruppen bzw. Leveln des Faktors <code>body_length_cat</code> gibt. Wir sehen bei allen Leveln ein <code>a</code>. Wir haben keine signifikante Unterschiede.</p>
<p>In <a href="#fig-cld-lmer">Abbildung&nbsp;<span>44.10</span></a> siehst du nochmal die Daten zusammen mit dem <em>compact letter display</em> dargestellt.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dragons_tbl</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">body_length_cat</span>, y <span class="op">=</span> <span class="va">test_score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span>data <span class="op">=</span> <span class="va">res_lmer_cld</span>, </span>
<span>            <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">body_length_cat</span> , y <span class="op">=</span> <span class="va">estimate</span>, label <span class="op">=</span> <span class="va">.group</span><span class="op">)</span>,</span>
<span>            position <span class="op">=</span> <span class="fu">position_nudge</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_errorbar</span><span class="op">(</span>data <span class="op">=</span> <span class="va">res_lmer_cld</span>,</span>
<span>                <span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">conf.low</span>, ymax <span class="op">=</span> <span class="va">conf.high</span>, x <span class="op">=</span> <span class="va">body_length_cat</span><span class="op">)</span>,</span>
<span>                color <span class="op">=</span> <span class="st">"red"</span>, width <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                position <span class="op">=</span> <span class="fu">position_nudge</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="va">res_lmer_cld</span>, </span>
<span>             <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">body_length_cat</span> , y <span class="op">=</span> <span class="va">estimate</span><span class="op">)</span>,</span>
<span>             position <span class="op">=</span> <span class="fu">position_nudge</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_okabeito</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Körperlänge in Kategorien"</span>, y <span class="op">=</span> <span class="st">"Testscore"</span>, </span>
<span>       caption <span class="op">=</span> <span class="st">"Schwarze Punkte stellen Rohdaten dar.</span></span>
<span><span class="st">       Rote Punkte und Fehlerbalken stellen bereinigte Mittelwerte mit 95% Konfidenzgrenzen pro Behandlung dar.</span></span>
<span><span class="st">       Mittelwerte, mit einem gemeinsamen Buchstaben, sind nicht signifikant unterschiedlich."</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-cld-lmer" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-mixed_files/figure-html/fig-cld-lmer-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Abbildung 44.10— Scatterplot der Körperlängen zusammen mit den 95% Konfidenzintervall und dem <em>compact letter display</em>.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Manchmal wollen wir auch die 95% Konfidenzintervalle anzeigen, dann müssen wir wiederum die Funktion <code>contrast()</code> nutzen. Wir lassen uns auch hier die adjustoerten <span class="math inline">\(p\)</span>-Werte wiedergeben. Wir nutzen dann das Objekt <code>res_lmer_tbl</code> um die 95% Konfidenzintervalle zu plotten.</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">res_lmer_tbl</span> <span class="op">&lt;-</span> <span class="va">res_lmer</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">contrast</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"pairwise"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tidy</span><span class="op">(</span>conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>p.value <span class="op">=</span> <span class="fu">pvalue</span><span class="op">(</span><span class="va">adj.p.value</span><span class="op">)</span>,</span>
<span>         <span class="fu">across</span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="va">round</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">contrast</span>, <span class="va">estimate</span>, <span class="va">p.value</span>,</span>
<span>         <span class="va">conf.low</span>, <span class="va">conf.high</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">res_lmer_tbl</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 5
   contrast          estimate p.value conf.low conf.high
   &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;
 1 tiny - small         -1.32 0.997     -12.3       9.68
 2 tiny - medium        -3.34 0.956     -16.5       9.85
 3 tiny - large         -4.85 0.891     -19.5       9.81
 4 tiny - gigantic      -1.37 &gt;0.999    -18.0      15.2 
 5 small - medium       -2.02 0.985     -12.6       8.58
 6 small - large        -3.53 0.935     -15.9       8.87
 7 small - gigantic     -0.05 &gt;0.999    -14.7      14.6 
 8 medium - large       -1.52 0.969      -8.06      5.03
 9 medium - gigantic     1.96 0.984      -8.23     12.2 
10 large - gigantic      3.48 0.764      -4.64     11.6 </code></pre>
</div>
</div>
<p>In <a href="#fig-emmeans-lmer-ci">Abbildung&nbsp;<span>44.11</span></a> sehen wir die 95% Konfidenzintervalle für alle paarweisen Vergleiche der Körperlängen.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">res_lmer_tbl</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">contrast</span>, y<span class="op">=</span><span class="va">estimate</span>, ymin<span class="op">=</span><span class="va">conf.low</span>, ymax<span class="op">=</span><span class="va">conf.high</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">0</span>, linetype<span class="op">=</span><span class="st">"11"</span>, colour<span class="op">=</span><span class="st">"grey60"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_errorbar</span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Vergleich"</span>, y <span class="op">=</span> <span class="st">"Mittelwertsunterschied des Gewichtes [kg/ha]"</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"Schwarze Punkte stellen die bereinigten Mittelwertsunterschiede mit 95% Konfidenzgrenzen dar.</span></span>
<span><span class="st">       Enthält ein 95% Konfidenzintervalle die 0 ist es nicht signifikant unterschiedlich."</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-emmeans-lmer-ci" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-mixed_files/figure-html/fig-emmeans-lmer-ci-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Abbildung 44.11— Abbildung der 95% Konfidenzintervallefür alle paarweisen Vergleiche der Körperlängen.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="nested" class="level2" data-number="44.5"><h2 data-number="44.5" class="anchored" data-anchor-id="nested">
<span class="header-section-number">44.5</span> Nested</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/caution.png" class="img-fluid figure-img" style="width:50.0%"></p>
</figure>
</div>
<p>https://stats.stackexchange.com/questions/228800/crossed-vs-nested-random-effects-how-do-they-differ-and-how-are-they-specified</p>
<p>https://www.statology.org/nested-anova-in-r/</p>
</section><section id="gee" class="level2" data-number="44.6"><h2 data-number="44.6" class="anchored" data-anchor-id="gee">
<span class="header-section-number">44.6</span> GEE</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/caution.png" class="img-fluid figure-img" style="width:50.0%"></p>
</figure>
</div>
<p>https://data.library.virginia.edu/getting-started-with-generalized-estimating-equations/</p>
<p>https://rlbarter.github.io/Practical-Statistics/2017/05/10/generalized-estimating-equations-gee/</p>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./stat-modeling-poisson.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./stat-modeling-non-linear.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>
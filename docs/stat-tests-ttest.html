<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Ein Kochbuch mit Rezepten aus der Bio Data Science, Biostatistik, Biometrie und Statistik zum selber nachkochen!">

<title>30&nbsp; Der t-Test – Bio Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./stat-tests-anova2.html" rel="next">
<link href="./stat-tests-R.html" rel="prev">
<link href="./cover2024_favi.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-05fe91a66cf75bbbb8c9664867fe5124.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-05a8b96638736df272eeeeef67138371.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="30&nbsp; Der t-Test – Bio Data Science">
<meta property="og:description" content="Ein Kochbuch mit Rezepten der Bio Data Science, Biostatistik, Biometrie und Statistik">
<meta property="og:image" content="https://github.com/jkruppa/jkruppa.github.io/raw/master/cover2024.png">
<meta property="og:site_name" content="Bio Data Science">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-tests-preface-app.html">Statistische Gruppenvergleiche</a></li><li class="breadcrumb-item"><a href="./stat-tests-ttest.html"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Der t-Test</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bio Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jkruppa/jkruppa.github.io/" title="Quellcode" class="quarto-navigation-tool px-1" aria-label="Quellcode"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Willkommen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bibliothek</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./forschungsprozess.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forschungsprozess</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abschlussarbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Abschlussarbeit</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./example-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datenbeispiele</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-database.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Von Datenbanken</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programmieren in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Daten in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Daten einlesen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Reguläre Ausdrücke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-purrr-furrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Ein <code>{purrr}</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Ein <code>{ggplot}</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-quarto-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Quarto und Shiny App</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorative Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Testen von Hypothesen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelle Designs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Versuchsplanung in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Einfache Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Fortgeschrittene Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-app.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistische Gruppenvergleiche</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Testen in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Der t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Die repeated / mixed ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-manova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Die MANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Der U-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Der Friedman Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Der <span class="math inline">\(\mathcal{X}^2\)</span>-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anteil-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Der Anteilstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-trendtest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Der Trendtest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-permutationstest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Der Permutationstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Der Post-hoc Test</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grundlagen des Modellierens</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Modelgüte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Korrelation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Ausreißer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Variablenselektion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Fehlende Werte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistisches Modellieren</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Modellieren in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-beta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Beta Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-prob-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-robust-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Überlebenszeitanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-noninferiority.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Äquivalenz oder Nichtunterlegenheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Metaanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Fragebogenanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./time-space-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zeitliche und räumliche Analysen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-pseudo-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Pseudo Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Räumliche Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Klassifikation oder maschinelles Lernen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-pre-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Data preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Support vector machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./abspann.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abspann</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-spielecke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">80</span>&nbsp; <span class="chapter-title">Spielecke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./construction-zone.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">Baustelle</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#allgemeiner-hintergrund" id="toc-allgemeiner-hintergrund" class="nav-link active" data-scroll-target="#allgemeiner-hintergrund"><span class="header-section-number">30.1</span> Allgemeiner Hintergrund</a></li>
  <li><a href="#theoretischer-hintergrund" id="toc-theoretischer-hintergrund" class="nav-link" data-scroll-target="#theoretischer-hintergrund"><span class="header-section-number">30.2</span> Theoretischer Hintergrund</a></li>
  <li><a href="#genutzte-r-pakete" id="toc-genutzte-r-pakete" class="nav-link" data-scroll-target="#genutzte-r-pakete"><span class="header-section-number">30.3</span> Genutzte R Pakete</a></li>
  <li><a href="#daten" id="toc-daten" class="nav-link" data-scroll-target="#daten"><span class="header-section-number">30.4</span> Daten</a></li>
  <li><a href="#hypothesen" id="toc-hypothesen" class="nav-link" data-scroll-target="#hypothesen"><span class="header-section-number">30.5</span> Hypothesen</a></li>
  <li><a href="#der-t-test" id="toc-der-t-test" class="nav-link" data-scroll-target="#der-t-test"><span class="header-section-number">30.6</span> Der t-Test</a>
  <ul class="collapse">
  <li><a href="#student-t-test-für-varianzhomogenität" id="toc-student-t-test-für-varianzhomogenität" class="nav-link" data-scroll-target="#student-t-test-für-varianzhomogenität"><span class="header-section-number">30.6.1</span> Student t-Test für Varianzhomogenität</a></li>
  <li><a href="#welch-t-test-mit-varianzheterogenität" id="toc-welch-t-test-mit-varianzheterogenität" class="nav-link" data-scroll-target="#welch-t-test-mit-varianzheterogenität"><span class="header-section-number">30.6.2</span> Welch t-Test mit Varianzheterogenität</a></li>
  <li><a href="#verbundener-t-test-mit-abhängigen-beobachtungen" id="toc-verbundener-t-test-mit-abhängigen-beobachtungen" class="nav-link" data-scroll-target="#verbundener-t-test-mit-abhängigen-beobachtungen"><span class="header-section-number">30.6.3</span> Verbundener t-Test mit abhängigen Beobachtungen</a></li>
  </ul></li>
  <li><a href="#modellierung" id="toc-modellierung" class="nav-link" data-scroll-target="#modellierung"><span class="header-section-number">30.7</span> Modellierung</a></li>
  <li><a href="#ergebnisse-mit-tidyplots" id="toc-ergebnisse-mit-tidyplots" class="nav-link" data-scroll-target="#ergebnisse-mit-tidyplots"><span class="header-section-number">30.8</span> Ergebnisse mit <code>{tidyplots}</code></a></li>
  <li><a href="#freiheitsgrade" id="toc-freiheitsgrade" class="nav-link" data-scroll-target="#freiheitsgrade"><span class="header-section-number">30.9</span> Freiheitsgrade</a></li>
  <li><a href="#referenzen" id="toc-referenzen" class="nav-link" data-scroll-target="#referenzen">Referenzen</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-tests-ttest.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-tests-ttest.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-tests-preface-app.html">Statistische Gruppenvergleiche</a></li><li class="breadcrumb-item"><a href="./stat-tests-ttest.html"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Der t-Test</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-ttest" class="quarto-section-identifier"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Der t-Test</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code zeigen</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code verbergen</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Quellcode anzeigen</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><em>Letzte Änderung am 23. June 2025 um 19:35:40</em></p>
<blockquote class="blockquote">
<p><em>“You cannot be a powerful and life-changing presence to some people without being a joke or an embarrassment to others.” — Mark Manson</em></p>
</blockquote>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/iECcenEDzOM" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>Beginnen wir unsere Reise durch die statistischen Tests mit dem t-Test. Damit beginnen wir auch historisch korrekt, da der t-Test auch der erste statistische Test war, der entwickelt wurde. Wir sehen die Nutzung des t-Tests in vielen wissenschaftlichen Publikationen, wie zum Beispiel der Veröffentlichung von <span class="citation" data-cites="erb2012anthropogenic">Erb et al. (<a href="#ref-erb2012anthropogenic" role="doc-biblioref">2012</a>)</span> zu dem Auftreten von Säugetieren entlang des <a href="https://de.wikipedia.org/wiki/Appalachian_Trail">Appalachian Trail</a> in den USA. Gibt es einen Unterschied im Auftreten von Schwarzbären und Rotfüchsen in Abhängigkeit von der Trailnutzung? Wie du erkennst, handelt es sich hier um Säulendiagramme als Mittelwerte und Standardfehler. Der t-Test versteckt sich hinter den Sternen, die du als eine mögliche Darstellung der p-Werte aus dem statistischen Testen kennst.</p>
<div id="fig-utest-intro" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-utest-intro-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/preface_t_test.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Abbildung&nbsp;30.1— Vorrausichtliches Auftreten von Schwarzbären und Rotfüchsen im Appalachian Trail Korridor nach der Häufigkeit der Nutzung. Die Sterne stellen das Signifikanzniveau auf der Grundlage eines t-Tests mit zwei Stichproben unter der Annahme ungleicher Varianz dar (*** p < 0.001). Quelle: @erb2012anthropogenic"><img src="images/preface_t_test.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-utest-intro-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;30.1— <em>Vorrausichtliches Auftreten von Schwarzbären und Rotfüchsen im Appalachian Trail Korridor nach der Häufigkeit der Nutzung. Die Sterne stellen das Signifikanzniveau auf der Grundlage eines t-Tests mit zwei Stichproben unter der Annahme ungleicher Varianz dar (*** p &lt; 0.001).</em> Quelle: <span class="citation" data-cites="erb2012anthropogenic">Erb et al. (<a href="#ref-erb2012anthropogenic" role="doc-biblioref">2012</a>)</span>
</figcaption>
</figure>
</div>
<p>Woher kommen nun die Sterne über die Säulen und was soll ungleiche Varianzen bedeuten? Hier wollen wir dann mal einsteigen und verstehen was der t-Test macht und warum der t-Test für den zwei Gruppenvergleich immer noch der Goldstandard ist.</p>
<section id="allgemeiner-hintergrund" class="level2" data-number="30.1">
<h2 data-number="30.1" class="anchored" data-anchor-id="allgemeiner-hintergrund"><span class="header-section-number">30.1</span> Allgemeiner Hintergrund</h2>
<p>Der t-Test ist <em>der</em> bedeutende Test, wenn es um das Verständnis der Algorithmen und Konzepte in der Statistik geht. Wir haben den t-Test schon genutzt um die Idee des statistischen Testens zu verstehen und wir werdend den t-Test auch im statistischen Modellieren wiedertreffen. Dort finden wir aber die Teststatistik des t-Tests. Wir werden dort nicht direkt den t-Test rechnen sondern das Konzept des t-Tests wieder nutzen. Natürlich hat der t-Test auch wieder verschiedene Namen, je nachdem welche Software du nutzen möchtest. Deshalb nochmal eine kurze Übersicht in der nachfolgenden Tabelle für R und Excel.</p>
<div id="tbl-t-test-name" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-t-test-name-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;30.1— Verschiedene Bezeichnungen für den t-Test je nach verwendeter Software. Es gibt natürlich noch weitere statistsiche Software mit noch anderen Namen.
</figcaption>
<div aria-describedby="tbl-t-test-name-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Name</th>
<th style="text-align: center;">R</th>
<th style="text-align: center;">Excel</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Student t-Test</td>
<td style="text-align: center;">Two Sample t-test</td>
<td style="text-align: center;">t-Test: Two-Sample Assuming Equal Variances</td>
</tr>
<tr class="even">
<td style="text-align: center;">Welch t-Test</td>
<td style="text-align: center;">Welch Two Sample t-test</td>
<td style="text-align: center;">t-Test: Two-Sample Assuming Unequal Variances</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Was macht also der t-Test? Der t-Test vergleicht die Mittelwerte zweier Gruppen miteinander. Das heißt wir haben zwei Gruppen, wie Hunde und Katzen, und wollen nun wissen wie sich die Sprungweiten der Hundeflöhe im Mittel von den Katzenflöhen unterscheiden. In R hätten wir damit einen Faktor mit zwei Leveln vorliegen. Darüber hinaus nimmt der t-Test implizit an, das unser Outcome <span class="math inline">\(y\)</span> normalverteilt ist. Die Varianzen können in beiden Gruppen gleich sein, dann sprechen wir von homogenen Varianzen oder Varianzhomogenität. Wir können den t-Test aber auch mit ungleichen Varianzen in beiden Gruppen rechnen, dann sprechen wir von heterogenen Varianzen oder eben Varianzheterogenität. Wir nutzen dann den Welch t-Test.</p>
<dl>
<dt>Nutze den Welch t-Test, wenn du unsicher über die Varianzen bist</dt>
<dd>
<p>Ich kann als Empfehlung nur aussprechen eigentlich immer den Welch t-Test zu nutzen. Sollten die Varianzen dennoch homogen sein, macht der Welch t-Test faktisch nichts schlechter als der Student t-Test. Dafür hat der Student t-Test wirklich Probleme mit ungleichen Varianzen.</p>
</dd>
</dl>
<p>Nun ist es so, das wir häufig einen t-Test verwenden müssen, wenn unsere Fallzahl <span class="math inline">\(n\)</span> sehr klein wird, da nicht-parametrische Methoden dann algorithmisch nicht mehr funktionieren. Hier hilft dann als wissenschaftliche Quelle die Arbeit von <span class="citation" data-cites="rasch2007robust">Rasch et al. (<a href="#ref-rasch2007robust" role="doc-biblioref">2007</a>)</span>, die auch unter dem Titel <a href="https://www.researchgate.net/profile/Dieter-Rasch/publication/279377987_The_Influence_of_Different_Shapes_of_Distributions_with_the_Same_First_four_Moments_on_Robustness/links/586b823108aebf17d3a58cbb/The-Influence-of-Different-Shapes-of-Distributions-with-the-Same-First-four-Moments-on-Robustness.pdf">The Robustness of Parametric Statistical Methods</a> frei verfügbar ist. Wichtig ist eigentlich nur das folgende Zitat aus dem Abstrakt der wissenschaftlichen Arbeit.</p>
<blockquote class="blockquote">
<p><em>“All the results are that in most practical cases the two-sample t-test is so robust that it can be recommended in nearly all applications.” — <span class="citation" data-cites="rasch2007robust">Rasch et al. (<a href="#ref-rasch2007robust" role="doc-biblioref">2007</a>)</span></em></p>
</blockquote>
<p>Unter den meisten Bedingungen ist der t-Test robust gegen die Verletzung der Normalverteilungsannahme. Wenn wir Varianzheterogenität vorliegen haben, dann können wir ja den Welch t-Test rechnen. Aber auch hier ist es dann wichtig auf den konkreten Datenfall zu schauen. Mehr zu der Thematik gibt es auch von <span class="citation" data-cites="rasch2011two">Rasch et al. (<a href="#ref-rasch2011two" role="doc-biblioref">2011</a>)</span> in der Veröffentlichugn <a href="https://link.springer.com/article/10.1007/s00362-009-0224-x">The two-sample t test: pre-testing its assumptions does not pay off</a> mit dem zentralen Zitat.</p>
<blockquote class="blockquote">
<p><em>“As a result, we propose that it is preferable to apply no pre-tests for the t test and no t test at all, but instead to use the Welch-test as a standard test: its power comes close to that of the t test when the variances are homogeneous […].”</em> — <span class="citation" data-cites="rasch2011two">Rasch et al. (<a href="#ref-rasch2011two" role="doc-biblioref">2011</a>)</span></p>
</blockquote>
<p>Auch findet <span class="citation" data-cites="de2010five">De Winter &amp; Dodou (<a href="#ref-de2010five" role="doc-biblioref">2010</a>)</span> in der Veröffentlichung <a href="https://research.tudelft.nl/en/publications/five-point-likert-items-t-test-versus-mann-whitney-wilcoxon">Five-point Likert items: t test versus Mann-Whitney-Wilcoxon</a>, dass wir uns nicht so richtig um die Normalverteilung sorgen müssen. Auch für Boniturnoten auf der Likertskala kann gut ein t-Test gerechnet werden.</p>
<blockquote class="blockquote">
<p>“<em>In conclusion, for five-point Likert items, the t test and wilcoxon mann whitney test generally have similar power, and researchers do not have to worry about finding a difference whilst there is none in the population.”</em> — <span class="citation" data-cites="de2010five">De Winter &amp; Dodou (<a href="#ref-de2010five" role="doc-biblioref">2010</a>)</span></p>
</blockquote>
</section>
<section id="theoretischer-hintergrund" class="level2" data-number="30.2">
<h2 data-number="30.2" class="anchored" data-anchor-id="theoretischer-hintergrund"><span class="header-section-number">30.2</span> Theoretischer Hintergrund</h2>
<p>Wenn du direkt aus dem statistischen Testen hierher kommst, dann ist die Berechnung des Student t-Tests für dich kein Problem. Das machen wir im statistischen Testen ja schon als Beispiel für die Teststatistik und den p-Wert. Hier kommen dann gleich fertige Funktionen in R, die dir alles in einem berechnen. Da ist es dann immer etwas schwerer nachzuvollziehen, was die einzelnen Schritte im statistischen Testen eigentlich sind.</p>
<p>Hier hilft dann das R Paket <code>{infer}</code> mit einer Schritt für Schritt Prozedur bei Durchführung des statistischen Testen. Dann machen wir es also einmal genau so, wie wir es schon kennen. Erst die Teststatistik <span class="math inline">\(T_D\)</span> der Daten berechenen. Dann die Verteilung der Nullhypothese der Grundgesamtheit bestimmen und dann beides zusammenbringen. Ein weiterer Vorteil von <code>{infer}</code> ist, dass wir die Funktionen sehr gut mit dem <code>|&gt;</code> Operator nutzen können.</p>
<p>Als erstes berechnen wir die Teststatistik für den t-Test <span class="math inline">\(T_D\)</span> aus den beobachteten Daten. Dafür nutzen wir unsere Sprungweiten der Hunde- und Katzenflöhe. Mehr zu den Daten auch gleich weiter unten im Abschnitt zu den genutzen Daten im Kapitel.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>t_d <span class="ot">&lt;-</span> fac1_tbl <span class="sc">|&gt;</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(jump_length <span class="sc">~</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"t"</span>, <span class="at">order =</span> <span class="fu">c</span>(<span class="st">"dog"</span>, <span class="st">"cat"</span>))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>t_d</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Response: jump_length (numeric)
Explanatory: animal (factor)
# A tibble: 1 × 1
   stat
  &lt;dbl&gt;
1  3.13</code></pre>
</div>
</div>
<p>Mit der Teststatistik der Daten <span class="math inline">\(T_D\)</span> können wir so erstmal nichts anfangen. Wir brauchen noch einen vergleich zu der Verteilung der Nullhypothese. Daher bestimmen wir im Folgednen die Verteilung der Nullhypothese zu der wir unsere berechnete Teststatistik <span class="math inline">\(T_D\)</span> aus den Daten vergleichen wollen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">202506</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>null_dist_data <span class="ot">&lt;-</span> fac1_tbl <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(jump_length <span class="sc">~</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">"independence"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">"permute"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"t"</span>, <span class="at">order =</span> <span class="fu">c</span>(<span class="st">"dog"</span>, <span class="st">"cat"</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann schauen wir uns einmal die Verteilung der Nullhypothese an. Wie wir sehen können, liegen die meisten Teststatistiken bei der Null. Macht ja auch Sinn, in der Nullhypothese haben wir ja auch Gleichheit zwischend Hunde- und Katzenflöhen angenommen.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-theo-infer-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-theo-infer-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-ttest_files/figure-html/fig-theo-infer-01-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Abbildung&nbsp;30.2— Verteilung der Nullhypothese in unseren Daten der Sprungweiten von Hunde- und Katzenflöhen. [Zum Vergrößern anklicken]"><img src="stat-tests-ttest_files/figure-html/fig-theo-infer-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-theo-infer-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;30.2— Verteilung der Nullhypothese in unseren Daten der Sprungweiten von Hunde- und Katzenflöhen. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Dann wollen wir noch die Fläche neben unsere berechnete Teststatistik <span class="math inline">\(T_D\)</span> um damit den <span class="math inline">\(p\)</span>-Wert zu bestimmen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>null_dist_data <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_p_value</span>(<span class="at">obs_stat =</span> t_d, <span class="at">direction =</span> <span class="st">"two-sided"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  p_value
    &lt;dbl&gt;
1   0.016</code></pre>
</div>
</div>
<p>Wie du dich noch erinnerst, ist der p-Wert die Fläche neben der berechneten Teststatistik <span class="math inline">\(T_D\)</span> zu den Verteilungsenden hin. Das wollen wir uns dann in der folgenden Abbildung nochmal anschauen, damit wir den Zusammenhang nochmal besser verstehen.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-theo-infer-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-theo-infer-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-ttest_files/figure-html/fig-theo-infer-02-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Abbildung&nbsp;30.3— Verteilung der Nullhypothese in unseren Daten der Sprungweiten von Hunde- und Katzenflöhen. Die rote Linie stellt die berechnete Teststatistik T_D der Daten dar. Die Eingefärbte Fläche ist der p-Wert. [Zum Vergrößern anklicken]"><img src="stat-tests-ttest_files/figure-html/fig-theo-infer-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-theo-infer-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;30.3— Verteilung der Nullhypothese in unseren Daten der Sprungweiten von Hunde- und Katzenflöhen. Die rote Linie stellt die berechnete Teststatistik <span class="math inline">\(T_D\)</span> der Daten dar. Die Eingefärbte Fläche ist der p-Wert. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Die Abfolge der Schritte erfolgt so nicht in der generischen Funktion <code>t.test()</code>, die wir dann in der Anwendung viel nutzen. Daher ist das R Paket <code>{infer}</code> nochmal gut um die Schritte der Berechnung sich klar werden zu lassen. Später nutzen wir dann nur eine Funktion, aber der Prozess ist im Hintergrund immer sehr ähnlich.</p>
<p>Eine detailliertere Einführung mit mehr Beispielen für die Nutzung vom <a href="https://infer.netlify.app/">R Paket <code>{infer}</code></a> findest du im Kapitel <a href="stat-tests-R.html">Testen in R</a>. Hier soll es dann bei der kurzen Gegenüberstellung bleiben.</p>
</section>
<section id="genutzte-r-pakete" class="level2" data-number="30.3">
<h2 data-number="30.3" class="anchored" data-anchor-id="genutzte-r-pakete"><span class="header-section-number">30.3</span> Genutzte R Pakete</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, magrittr, broom, readxl,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>               infer, see, tidyplots, rstatix, ggpubr,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>               ggrepel, nlme, conflicted)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>filter)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(rstatix<span class="sc">::</span>t_test)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20221206</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>An der Seite des Kapitels findest du den Link <em>Quellcode anzeigen</em>, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</p>
</section>
<section id="daten" class="level2" data-number="30.4">
<h2 data-number="30.4" class="anchored" data-anchor-id="daten"><span class="header-section-number">30.4</span> Daten</h2>
<p>In den folgendne Abschnitten brauchen wir dann zwei Datensätze. Der erste Datensatz beschreibt Hunde- und Katzenflöhe, die springen und deren Sprungweite dann gemessen wurde. Wir haben hier verschiedene Flöhe vorliegen, die nur einmal springen. Wir können aber auch den Fall haben, dass wir uns wiederholt einen Floh anschauen. Der zweite Datensatz betrachtet Hundeflöhe, die vor der Fütterung und nach der Fütterung gesprungen sind.</p>
<section id="unabhängige-messungen" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="unabhängige-messungen">Unabhängige Messungen</h4>
<p>Beginnen wir mit einem Datenbeispiel zu den Hunde- und Katzenflöhen. Was brauchen wir damit wir den t-Test rechnen können? Wir brauchen für den t-Test eine Spalte <span class="math inline">\(y\)</span> mit kontinuierlichen Zahlen und einer Spalte <span class="math inline">\(x\)</span> in dem wir einen Faktor mit zwei Leveln finden oder eben zwei Gruppen. Jedes Level steht dann für eine der beiden Gruppen. Das war es schon. Schauen wir uns nochmal den Datensatz <code>flea_dog_cat.xlsx</code> in <a href="#tbl-data-ttest" class="quarto-xref">Tabelle&nbsp;<span>30.2</span></a> an und überlegen, was wir dort auswählen können.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/flea_dog_cat.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal)) <span class="sc">|&gt;</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, jump_length)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir benötigen für den t-Test ein normalverteiltes <span class="math inline">\(y\)</span> womit wir uns hier erstmal für die kontinuierliche Sprungweite entscheiden. Dann brauchen wir einen Faktor mit zwei Leveln als <span class="math inline">\(x\)</span> und da bietet sich natürlich die beiden Gruppen Hunde- und Katzenflöhe an. Wir wählen daher mit <code>select()</code> die Spalte <code>jump_length</code> und <code>animal</code> aus dem Datensatz <code>flea_dog_cat.xlsx</code> aus. Wichtig ist, dass wir die Spalte <code>animal</code> mit der Funktion <code>as_factor()</code> in einen Faktor umwandeln. Anschließend speichern wir die Auswahl in dem Objekt <code>fac1_tbl</code>. Hier dann nochmal die Datentabelle.</p>
<div class="cell">
<div id="tbl-data-ttest" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-data-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;30.2— Tabelle von sieben Hunde- und Katzenflöhen mit der Sprunglänge [cm].
</figcaption>
<div aria-describedby="tbl-data-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_bepzqkpsf0v561eiv8om</title>
    <style>
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-striped" id="tinytable_bepzqkpsf0v561eiv8om" style="table-layout: fixed; width: 67% !important; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">animal</th>
                <th scope="col">jump_length</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>dog</td>
                  <td>5.7 </td>
                </tr>
                <tr>
                  <td>dog</td>
                  <td>8.9 </td>
                </tr>
                <tr>
                  <td>dog</td>
                  <td>11.8</td>
                </tr>
                <tr>
                  <td>...</td>
                  <td>... </td>
                </tr>
                <tr>
                  <td>cat</td>
                  <td>4.3 </td>
                </tr>
                <tr>
                  <td>cat</td>
                  <td>7.9 </td>
                </tr>
                <tr>
                  <td>cat</td>
                  <td>6.1 </td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_rfdjps9ikdc46w8qdo5h(i, j, css_id) {
        var table = document.getElementById("tinytable_bepzqkpsf0v561eiv8om");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_bepzqkpsf0v561eiv8om');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_rfdjps9ikdc46w8qdo5h(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_bepzqkpsf0v561eiv8om");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

    </script>

  


</div>
</div>
</figure>
</div>
</div>
<p>Wir haben jetzt die Daten richtig vorbereiten und können uns nun mit dem t-Test beschäftigen. Bevor wir den t-Test jedoch rechnen können, müssen wir uns nochmal überlegen, was der t-Test eigentlich testet und uns die Daten einmal visualisieren. Klassischerweise wollen wir einen t-Test rechnen, da wir zwei Säulen in einem Barplot miteinander vergleichen wollen. Dafür schauen wir uns in <a href="#fig-barplot-ttest" class="quarto-xref">Abbildung&nbsp;<span>30.4</span></a> einmal den Barplot und den Boxplot für die Sprungweiten getrennt nach Hund und Katze an.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-barplot-ttest" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-barplot-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-ttest_files/figure-html/fig-barplot-ttest-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Abbildung&nbsp;30.4— Visualisierung der Sprungweiten der Hunde- und Katzenflöhe. (A) Säulendiagramm oder Barplot mit den Mittelwerten und der Standardabweichung. (B) Boxplot mit den Median und dem IQR. [Zum Vergrößern anklicken]"><img src="stat-tests-ttest_files/figure-html/fig-barplot-ttest-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-barplot-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;30.4— Visualisierung der Sprungweiten der Hunde- und Katzenflöhe. <strong>(A)</strong> Säulendiagramm oder Barplot mit den Mittelwerten und der Standardabweichung. <strong>(B)</strong> Boxplot mit den Median und dem IQR. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Zum einen sind die Mittelwerte der Barplots nicht auf einer Höhe. Dies spricht schon mal dafür, dass wir hier einen Unterschied in den Sprungweiten vorliegen haben könnten. Schauen wir auch einmal auf die Boxplots. Wir sehen, dass sich die Boxen nicht überschneiden, ein Indiz für einen signifikanten Unterschied zwischen den beiden Gruppen. Im Weiteren liegt der Median in etwa in der Mitte der beiden Boxen. Die Whisker sind ungefähr gleich bei Hunden und Katzen. Ebenso sehen wir bei beiden Gruppen keine Ausreißer. Wir schließen daher nach der Betrachtung der beiden Abbildungen auf Folgendes:</p>
<ol type="1">
<li>Die Sprungweite ist für beide Gruppen ist annähernd bzw. approximativ normalverteilt.</li>
<li>Die Standardabweichungen und damit die Varianzen <span class="math inline">\(s^2_{dog} = s^2_{cat}\)</span> der beiden Gruppen sind gleich. Es liegt somit Varianzhomogenität vor.</li>
</ol>
<p>Manchmal ist es etwas verwirrend, dass wir uns in einem Boxplot mit Median und IQR die Daten für einen t-Test anschauen. Immerhin rechnet ja ein t-Test mit den Mittelwerten und der Standardabweichung. Hier vergleichen wir etwas Äpfel mit Birnen. Deshalb in der <a href="#fig-dotplot-ttest" class="quarto-xref">Abbildung&nbsp;<span>30.5</span></a> der Dotplot mit dem Mittelwert und den entsprechender Standardabweichung als Fehlerbalken.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-dotplot-ttest" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dotplot-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-ttest_files/figure-html/fig-dotplot-ttest-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Abbildung&nbsp;30.5— Dotplot der Sprungweiten [cm] von Hunden und Katzen zusammen mit dem Mittelwert und der Standardabweichung als Fehlerbalken."><img src="stat-tests-ttest_files/figure-html/fig-dotplot-ttest-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dotplot-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;30.5— Dotplot der Sprungweiten [cm] von Hunden und Katzen zusammen mit dem Mittelwert und der Standardabweichung als Fehlerbalken.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir nutzen aber später häufig den Boxplot zur Visualisierung der einzelnen Gruppen. Über den Boxplot können wir auch gut abschätzen, ob wir eine annähernde bzw. approximative Normalverteilung vorliegen haben. Häufig werden aber auch Barplots verlangt, so dass du hier relativ frei bist, was du verwendest. Am Ende ist es aber nicht so wichtig, ob wir eine Normalverteilung vorliegen haben oder nicht. Der t-Test ist recht robust gegen eine Abweichung. Viel wichtiger ist, das du eben Mittelwerte vergleichst. Also dann zum Beispiel mittlere Boniturnoten oder mittlere Anzahlen.</p>
</section>
<section id="abhängige-messungen" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="abhängige-messungen">Abhängige Messungen</h4>
<p>Der t-Test erlaubt auch abhängige Daten zu analysieren. Das heißt wir haben die gleichen sieben Hundeflöhe wiederholt gemessen. Einmal haben wir einen Hundefloh gemessen bevor er was gegessen hat, also hungrig ist, und einmal nachdem der gleiche Floh sich satt gegessen hat. Daher haben wir hier abhängige oder verbundene Bebachtungen. Im folgenden einmal der Datensatz eingelesen im Wide-Format.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>paired_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/flea_dog_cat_repeated.xlsx"</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wie du sehen kannst haben wir die sieben Flöhe wiederholt gemessen. Die Daten sind nicht im <code>tidy</code>-Format, da nicht jede Zeile nur eine Messunfg für eine Beobachtung beinhaltet. Das ändern wir dann einmal gleich in Long-Format.</p>
<div class="cell">
<div id="tbl-data-ttest-paired-01" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-data-ttest-paired-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;30.3— Tabelle der Sprunglängen [cm] von fünf Hundeflöhen zu zwei Zeitpunkten. Einmal wurde die Sprungweite mit den hungrigen Flöhen und einmal mit den gleichen satten Flöhen bestimmt.
</figcaption>
<div aria-describedby="tbl-data-ttest-paired-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_9v2r1muk5ziuxnbcfymc</title>
    <style>
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-striped" id="tinytable_9v2r1muk5ziuxnbcfymc" style="table-layout: fixed; width: 67% !important; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">id</th>
                <th scope="col">hungrig</th>
                <th scope="col">satt</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>1</td>
                  <td>5.2</td>
                  <td>6.1</td>
                </tr>
                <tr>
                  <td>2</td>
                  <td>4.1</td>
                  <td>5.2</td>
                </tr>
                <tr>
                  <td>3</td>
                  <td>3.5</td>
                  <td>3.9</td>
                </tr>
                <tr>
                  <td>4</td>
                  <td>3.2</td>
                  <td>4.1</td>
                </tr>
                <tr>
                  <td>5</td>
                  <td>4.6</td>
                  <td>5.3</td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_uu2firk28dkoa5hq6v8j(i, j, css_id) {
        var table = document.getElementById("tinytable_9v2r1muk5ziuxnbcfymc");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_9v2r1muk5ziuxnbcfymc');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_uu2firk28dkoa5hq6v8j(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_9v2r1muk5ziuxnbcfymc");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

    </script>

  


</div>
</div>
</figure>
</div>
</div>
<p>Dann hier nochmal die Long-Formatvariante mit der Funktion <code>pivot_longer()</code>. Wir brauchen das Long-Format für die Auswertung in den unteren Abschnitten für das R Paket <code>{rstatix}</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>paired_long_tbl <span class="ot">&lt;-</span> paired_tbl <span class="sc">|&gt;</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> hungrig<span class="sc">:</span>satt,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"jump_length"</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"trt"</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Manchmal ist es schwer zu verstehen, was jetzt wiederholt oder gepaart heißen soll. Deshalb hier nochmal die Visualiserung der Daten für die beiden Sprünge vor und nach der Fütterung. Ich habe die Messungen, die zusammengehören mit einer Linie verbunden. Dazu dann auch noch die jeweiligen IDs der Flöhe ergänzt.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-example-paired" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example-paired-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-ttest_files/figure-html/fig-example-paired-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Abbildung&nbsp;30.6— Dotplot der Sprungweiten [cm] für Hundeflöhe in zwei verschiedenen Ernährungszuständen gemessen an zwei Zeitpunkten. Die Linien verbinden die Messung an dem gleichen Floh."><img src="stat-tests-ttest_files/figure-html/fig-example-paired-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example-paired-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;30.6— Dotplot der Sprungweiten [cm] für Hundeflöhe in zwei verschiedenen Ernährungszuständen gemessen an zwei Zeitpunkten. Die Linien verbinden die Messung an dem gleichen Floh.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="hypothesen" class="level2" data-number="30.5">
<h2 data-number="30.5" class="anchored" data-anchor-id="hypothesen"><span class="header-section-number">30.5</span> Hypothesen</h2>
<p>Ohne eine Hypothese ist das Ergebnis eines statistischen Tests wie auch der t-Test nicht zu interpretieren. Wir berechnen eine Teststatistik und einen p-Wert. Beide statistischen Maßzahlen machen eine Aussage über die beobachteten Daten <span class="math inline">\(D\)</span> unter der Annahme, das die Nullhypothese <span class="math inline">\(H_0\)</span> gilt.</p>
<p>Wie lautet nun das Hypothesenpaar des t-Tests? Der t-Test vergleicht die Mittelwerte von zwei Gruppen. Die Nullhypothese ist auch die Gleichheitshypothese. Die Alternativehypothese haben wir auch als Unterschiedshypothese bezeichnet.</p>
<p>Daher ergibt sich für unser Beispiel mit den Sprungweiten für Hunde- und Katzenflöhen folgende Hypothesen. Die Nullhypothese sagt, dass die mittleren Sprungweite für die Hundeflöhe gleich der mittleren Sprungweite der Katzenflöhe ist. Die Alternativehypothese sagt aus, dass sich die mittlere Sprungweite von Hunde- und Katzenflöhen unterscheidet.</p>
<p><span class="math display">\[
\begin{aligned}
H_0: \bar{y}_{dog} &amp;= \bar{y}_{cat} \\  
H_A: \bar{y}_{dog} &amp;\neq \bar{y}_{cat} \\   
\end{aligned}
\]</span></p>
<p>Wir testen grundsätzlich auf ein zweiseitiges <span class="math inline">\(\alpha\)</span>-Niveau von 5%.</p>
</section>
<section id="der-t-test" class="level2" data-number="30.6">
<h2 data-number="30.6" class="anchored" data-anchor-id="der-t-test"><span class="header-section-number">30.6</span> Der t-Test</h2>
<p>Dann wollen wir mal den t-Test berechnen. Den t-Test gibt es in drei Varianten, je nachdem, was wir für Fallzahlen oder aber Varianzen vorliegen haben. Wir können den t-Test wie immer mit der Hand berechnen oder aber in R sowie in Excel. Wir konzentrieren uns hier einmal auf die händsiche Berechnung für die Klausur und die Anwendung in R. Ich habe aber nochmal ein Video aufgenommen für die Anwendung des t-Tests in Excel. Manchmal gibt es ja den Notfall, dass nur Excel geht. Du müsstest die Formel des t-Test in der einfachen Form des Student t-Test gleich wiedererkennen, denn an dem t-Test erkläre ich die statistische Testtheorie und die Testentscheidung.</p>
<section id="student-t-test-für-varianzhomogenität" class="level3" data-number="30.6.1">
<h3 data-number="30.6.1" class="anchored" data-anchor-id="student-t-test-für-varianzhomogenität"><span class="header-section-number">30.6.1</span> Student t-Test für Varianzhomogenität</h3>
<p>Fangen wir mit den einfacheren der beiden t-Tests an, dem Student t-Test. Der Student t-Test heißt so komisch, weil der Erfinder <a href="https://de.wikipedia.org/wiki/William_Sealy_Gosset">William Sealy Gosset</a> zum Zeitpunkt der Entwicklung der Formel bei Guinness-Brauerei gearbeitet hat. Die Firma wollte aber nicht, dass seine Entdeckungen veröffentlicht werden. Also entschied sich Gosset unter einem Pseudonym seine Ideen zu präsentieren. Warum Gosset nun unbedingt Student als Pseudonym wählen musste, wird wohl sein Geheimnis bleiben. Deshalb der etwas wirre Name des t-Tests für Varianzhomogenität.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Theoretisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Händisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false"><code>{stats}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false"><code>{rstatix}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">Excel</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Die Formel des Student t-Test für Varianzhomogenität müsste dir noch aus dem Kapitel zur Testentscheidung bekannt vorkommen. Die Formel ist recht einfach, deshalb nutze ich den Student t-Test in dem Kapitel für die Einführung zur Teststatistik und dem p-Wert. Was brauchen wir nun für einen Student t-Test? Liegt ein normalverteiltes <span class="math inline">\(y\)</span> vor und sind die Varianzen für die beiden zu vergleichenden Gruppen homogen <span class="math inline">\(s^2_{1} = s^2_{2}\)</span>, können wir einen Student t-Test rechnen. Wir nutzen dazu die folgende Formel des Student t-Tests.</p>
<p><span class="math display">\[
T_{D} = \cfrac{\bar{y}_{1}-\bar{y}_{2}}{s_{p} \cdot \sqrt{\cfrac{2}{n_{g}}}}
\]</span></p>
<p>mit</p>
<ul>
<li><span class="math inline">\(T_D\)</span>, der berechneten Teststatistik der Daten <span class="math inline">\(D\)</span>.</li>
<li><span class="math inline">\(\bar{y}_{1}\)</span>, dem Mittelwert der ersten Gruppe. Gerne nehme ich hier den numerisch <em>größeren</em> Mittelwert.</li>
<li><span class="math inline">\(\bar{y}_{2}\)</span>, dem Mittelwert der zweiten Gruppe. Gerne nehme ich hier den numerisch <em>kleineren</em> Mittelwert.</li>
<li><span class="math inline">\(s_{p}\)</span>, die gepoolte Standardabweichung aus den Standardabweichungen der <span class="math inline">\(s_1\)</span> und <span class="math inline">\(s_2\)</span> der beiden Gruppen.</li>
<li><span class="math inline">\(n_{g}\)</span>, die Gruppengröße der beiden Gruppen, die hier gleich sein muss. Daher ist <span class="math inline">\(n_1 = n_2 = n_g\)</span>.</li>
</ul>
<p>Dann nutzen wir die vereinfachte Formel für die gepoolte Standardabweichung <span class="math inline">\(s_p\)</span>. Das hat den einfachen Grund, dass wir eben den t-Test nur in der Klausur händisch rechnen. Und hier machen wir uns es dann etwas einfacher.</p>
<p><span class="math display">\[
s_{p} = \cfrac{s_{1} + s_{2}}{2}
\]</span></p>
<p>mit</p>
<ul>
<li><span class="math inline">\(s_1\)</span>, der Standardabweichung der ersten Gruppe.</li>
<li><span class="math inline">\(s_2\)</span>, der Standardabweichung der zweiten Gruppe.</li>
</ul>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/angel_01_small.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="images/angel_01_small.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p>Eigentlich wäre hier folgende Formel mit <span class="math inline">\(s_{p} = \sqrt{\frac{1}{2} (s^2_{dog} + s^2_{cat})}\)</span> richtig, da wir eigentlich die Varianzen mitteln müssten und dann die Wurzel ziehen. Aber auch hier erwischen wir einen Statistikengel um es etwas einfacher zu machen.</p>
</blockquote>
</div>
</div>
</div>
<p>Dann kannst du in den folgenden Tab auch dir einmal anschauen, wie die Berechnung des Student t-Tests für das Beispiel mit den Sprungweiten der Hunde- und Katzenflöhe ablaufen würde.</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Wenn wir einen Student t-Test per Hand berechnen wollen, dann brauchen wir ja einiges an statistischen Maßzahlen. Hier erstmal nochmal die Formel, damit wir dann für Wissen, welche der statistischen Maßzahlen wir benötigen.</p>
<p><span class="math display">\[
T_{D} = \cfrac{\bar{y}_{dog}-\bar{y}_{cat}}{s_{p} \cdot \sqrt{\cfrac{2}{n_{g}}}}
\]</span></p>
<p>Wir wollen nun die Werte für <span class="math inline">\(\bar{y}_{dog}\)</span>, <span class="math inline">\(\bar{y}_{cat}\)</span> und <span class="math inline">\(s_{p}\)</span> berechnen. Der Wert von <span class="math inline">\(n_g\)</span> ist ja mit sieben schon bekannt. Wir nutzen hierfür die folgenden Formeln aus dem Kapitel zur deskriptiven Statistik. Wichtig ist nochmal, dass wir annehmen, dass die Varianz der Hundeflöhe ungefähr gleich ist zu der Varianz der Katzenflöhe mit <span class="math inline">\(s^2_{cat} = s^2_{dog}\)</span>.</p>
<p>Fangen wir einmal an mit den Mittelwerten der Sprungweiten der Hunde- und Katzenflöhe.</p>
<p><span class="math display">\[
\bar{y}_{dog} = \cfrac{5.7 + 8.9 + 11.8 + 5.6 + 9.1 + 8.2 + 7.6}{7} = 8.13
\]</span></p>
<p><span class="math display">\[
\bar{y}_{cat} = \cfrac{3.2 + 2.2 + 5.4 + 4.1 + 4.3 + 7.9 + 6.1}{7} = 4.74
\]</span></p>
<p>Dann berechnen wir jeweils die Varianz der Sprungweite der Hunde- und Katzenflöhe. Dafür brauchen wir jetzt den Mittelwert der Sprungweiten.</p>
<p><span class="math display">\[
s^2_{dog} = \cfrac{(5.7 - 8.13)^2 + (8.9 - 8.13)^2 + \cdots + (7.6 - 8.13)^2}{7-1} = 4.60
\]</span></p>
<p><span class="math display">\[
s^2_{cat} = \cfrac{(3.2 - 4.74)^2 + (2.2 - 4.74)^2 + \cdots + (6.1 - 4.74)^2}{7-1} = 3.62
\]</span></p>
<p>Wenn wir die Varianz haben, können wir auch gleich die Standardabweichungen der Sprungweite der Hunde- und Katzenflöhe berechnen. Wir brauchen die einzelnen Standardabweichungen, um diese dann im Anschluss zusammenzufassen (eng. <em>pool</em>).</p>
<p><span class="math display">\[
s_{dog} = \sqrt{4.60} = 2.14
\]</span></p>
<p><span class="math display">\[
s_{car} = \sqrt{3.62} = 1.90
\]</span></p>
<p>Jetzt können wir die gepoolte Standardabweichung aus den einzelnen Standardabweichungen der Sprungweiten der Hunde- und Katzenflöhe berechnen.</p>
<p><span class="math display">\[
s_{p} = \cfrac{2.14 + 1.90}{2} = 2.02
\]</span></p>
<p>Abschließend setzen wir alle berechneten Werte in den Formel des Student t-Test ein. Wir können jetzt <span class="math inline">\(s_p\)</span> und die Mittelwerte sowie die Gruppengröße <span class="math inline">\(n_g = 7\)</span> in die Formel für den Student t-Test einfach einsetzen und die Teststatistik <span class="math inline">\(T_{D}\)</span> berechnen.</p>
<p><span class="math display">\[
T_{D} = \cfrac{8.13 - 4.74}{2.02 \cdot \sqrt{\cfrac{2}{7}}} = 3.14
\]</span></p>
<p>Wir erhalten eine Teststatistik <span class="math inline">\(T_{D} = 3.14\)</span> die wir mit dem kritischen Wert <span class="math inline">\(T_{\alpha = 5\%} = 2.17\)</span> vergleichen können. Da <span class="math inline">\(T_{D} &gt; T_{\alpha = 5\%}\)</span> ist, können wir die Nullhypothese ablehnen. Wir haben ein signifikanten Unterschied zwischen den mittleren Sprungweiten von Hunde- und Katzenflöhen nachgewiesen.</p>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>Soweit für den Weg zu Fuß. Wir rechnen in der Anwendung keinen Student t-Test per Hand. Wir nutzen die Formel <code>t.test()</code>. Da wir den Student t-Test unter der Annahme der Varianzhomogenität nutzen wollen, müssen wir noch die Option <code>var.equal = TRUE</code> wählen. Die Funktion <code>t.test()</code> benötigt erst die das <span class="math inline">\(y\)</span> und <span class="math inline">\(x\)</span> in der Modellschreibweise mit den Namen, wie die beiden Variablen auch im Datensatz <code>fac1_tbl</code> stehen. In unserem Fall ist die Modellschreibweise dann <code>jump_length ~ animal</code>. Im Weiteren müssen wir noch den Datensatz angeben den wir verwenden wollen durch die Option <code>data = fac1_tbl</code>. Dann können wir die Funktion <code>t.test()</code> ausführen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(jump_length <span class="sc">~</span> animal, </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> fac1_tbl, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  jump_length by animal
t = 3.1253, df = 12, p-value = 0.008768
alternative hypothesis: true difference in means between group dog and group cat is not equal to 0
95 percent confidence interval:
 1.025339 5.746089
sample estimates:
mean in group dog mean in group cat 
         8.128571          4.742857 </code></pre>
</div>
</div>
<p>Wir erhalten eine sehr lange Ausgabe, die auch etwas verwirrend aussieht. Gehen wir die Ausgabe einmal durch. Ich gehe nicht auf alle Punkte ein, sondern konzentriere mich hier auf die wichtigsten Aspekte.</p>
<ul>
<li><code>t = 3.12528</code> ist die berechnete Teststatistik <span class="math inline">\(T_{D}\)</span>. Der Wert unterscheidet sich leicht von unserem berechneten Wert. Der Unterschied war zu erwarten, wir haben ja auch die t-Test Formel vereinfacht.</li>
<li><code>p-value = 0.0087684</code> ist der berechnete p-Wert <span class="math inline">\(Pr(T_{D}|H_0)\)</span> aus der obigen Teststatistik. Daher die Fläche rechts von der Teststatistik.</li>
<li><code>95 percent confidence interval: 1.0253394 5.7460892</code> ist das 95% Konfidenzintervall. Die erste Zahl ist die untere Grenze, die zweite Zahl ist die obere Grenze.</li>
</ul>
<p>Wir erhalten hier dreimal die Möglichkeit eine Aussage über die <span class="math inline">\(H_0\)</span> zu treffen. In dem obigen Output von R fehlt der kritische Wert <span class="math inline">\(T_{\alpha = 5\%}\)</span>. Daher ist die berechnete Teststatistik für die Testentscheidung nicht verwendbar. Wir nutzen daher den p-Wert und vergleichen den p-Wert mit dem <span class="math inline">\(\alpha\)</span>-Niveau von 5%. Da der p-Wert kleiner ist als das <span class="math inline">\(\alpha\)</span>-Niveau können wir wie Nullhypothese ablehnen. Wir haben einen signifikanten Unterschied. Die Entscheidung mit dem Konfidenzintervall benötigt die Signifikanzschwelle. Da wir hier einen Mittelwertsvergleich vorliegen haben ist die Signifikanzschwelle gleich 0. Wenn die 0 im Konfidenzintervall liegt können wir die Nullhypothese nicht ablehnen. In unserem Fall ist das nicht der Fall. Das Konfidenzintervall läuft von 1.025 bis 5.75. Damit ist die 0 nicht im Konfidenzintervall enthalten und wir können die Nullhypothese ablehnen. Wir haben ein signifikantes Konfidenzintervall vorliegen.</p>
<p>Wie wir sehen fehlt der Mittelwertsunterschied als Effekt <span class="math inline">\(\Delta\)</span> in der Standardausgabe des t-Tests in R. Wir können den Mittelwertsunterschied selber berechnen oder aber die Funktion <code>tidy()</code> aus dem R Paket <code>{broom}</code> nutzen. Da der Funktion <code>tidy()</code> kriegen wir die Informationen besser sortiert und einheitlich wiedergegeben. Da <code>tidy</code> eine Funktion ist, die mit vielen statistischen Tests funktioniert müssen wir wissen was die einzelnen <code>estimate</code> sind. Es hilft in diesem Fall sich die Visualisierung der Daten anzuschauen und die Abbildung mit den berechneten Werten abzugleichen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(jump_length <span class="sc">~</span> animal, </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> fac1_tbl, <span class="at">var.equal =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 10
  estimate estimate1 estimate2 statistic p.value parameter conf.low conf.high
     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1     3.39      8.13      4.74      3.13 0.00877        12     1.03      5.75
# ℹ 2 more variables: method &lt;chr&gt;, alternative &lt;chr&gt;</code></pre>
</div>
</div>
<p>Wir erkennen als erstes den Mittelwertsunterschied zwischen den beiden Gruppen von <span class="math inline">\(3.39cm\)</span>. Danach folgen die einzelnen Mittelwerte der Sprungweiten der Hunde und Katzenflöhe mit jeweils <span class="math inline">\(8.13cm\)</span> und <span class="math inline">\(4.74cm\)</span>. Darauf folgt noch der p-Wert als <code>p.value</code> mit 0.00891 und die beiden Grenzen des Konfidenzintervalls [1.03; 5.75].</p>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<p>Ich würde eher die Implementierung in <code>{rstatix}</code> der Standardimplementierung in <code>{stats}</code> vorziehen, da wir hier die Daten über die Pipe in die Funktion weiterleiten können. Das macht es dann doch etwas einfacher. Am Ende kommt aber das gleiche raus, so dass ich die Funktion hier als Alternative stehen lasse. Das wir noch eine Datentabelle als Ausgabe kriegen, ist natürlich auch super schön.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t_test</span>(jump_length <span class="sc">~</span> animal, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> fac1_tbl, <span class="at">var.equal =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(group1, group2, p)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  group1 group2       p
  &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;
1 dog    cat    0.00877</code></pre>
</div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<p>Ich habe einmal ein Video eingesprochen indem ich nochmal zeige, wie du in Excel einen t-Test rechnen kannst. Ich empfehle grundsätzlich, wenn es schon Excel sein muss, immer den Welch t-Test zu rechnen. In Excel heißt dann der Welch t-Test <code>t-Test: Two-Sample Assuming Unequal Variances</code>. Ich kann es nicht so richtig empfehlen, alles in Excel zu rechnen. Die Möglichkeiten sind doch arg begrenz. Aber ich kann verstehen, dass es manchmal sein muss.</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/fA_7X_Rz83M" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
</div>
</div>
</div>
</section>
<section id="welch-t-test-mit-varianzheterogenität" class="level3" data-number="30.6.2">
<h3 data-number="30.6.2" class="anchored" data-anchor-id="welch-t-test-mit-varianzheterogenität"><span class="header-section-number">30.6.2</span> Welch t-Test mit Varianzheterogenität</h3>
<p>Jetzt stellt sich natürlich sofort die Frage, was ist, wenn ich nicht die gleichen Varianzen in den beiden Gruppen vorliegen habe oder aber eben mir nicht sicher bin, ob die Varianzen <em>wirklich</em> gleich sind? Dann kannst du auch den Welch t-Test nutzen. Der Welch t-Test verlangt keine Varianzhomogenität zwischen den beiden Gruppen. Es kann also die Varianz jeweils unterschiedliche sein. Auch kann die Fallzahl in den beiden Gruppen variieren, was manchmal auch sehr praktisch sein kann. Im Allgemeinen empfehle ich eigentlich immer als Standard, wie es auch in R ist, den Welch t-Test zu nutzen. Wenn die Varianzen homogen sind, dann verlierst du nicht viel. Auf der anderen Seite gewinnst du aber mehr, wenn die Varianzen heterogen sind.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Theoretisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Händisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false"><code>{stats}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false"><code>{rstatix}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false">Excel</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Der Welch t-Test ist auch in der Lage mit Varianzheterogenität umzugehen. Das heißt, wenn die Varianzen der beiden Gruppen nicht gleich sind. Eigentlich haben wir damit die generalisierte Formel für den t-Test vorliegen. Neben der unterschiedlichen Varianz erlaubt der Welch t-Test nämlich auch unterschiedliche Gruppengrößen zu verwenden. Wir haben dann folgende Formel vorliegen. Wir können nun wirklich jeden der drei statistischen Parameter, Mittelwert, Varianz und Fallzahl der Gruppe, entsprechend anpassen.</p>
<p><span class="math display">\[
T_{D} = \cfrac{\bar{y}_1 - \bar{y}_2}{\sqrt{\cfrac{s^2_1}{n_1} + \cfrac{s^2_2}{n_2}}}
\]</span></p>
<p>mit</p>
<ul>
<li><span class="math inline">\(T_D\)</span>, der berechneten Teststatistik der Daten <span class="math inline">\(D\)</span>.</li>
<li><span class="math inline">\(\bar{y}_{1}\)</span>, dem Mittelwert der ersten Gruppe. Gerne nehme ich hier den numerisch <em>größeren</em> Mittelwert.</li>
<li><span class="math inline">\(\bar{y}_{2}\)</span>, dem Mittelwert der zweiten Gruppe. Gerne nehme ich hier den numerisch <em>kleineren</em> Mittelwert.</li>
<li><span class="math inline">\(s^2_1\)</span>, der Varianz der ersten Gruppe.</li>
<li><span class="math inline">\(s^2_2\)</span>, der Varianz der zweiten Gruppe.</li>
<li><span class="math inline">\(n_{1}\)</span>, der Fallzahl der ersten Gruppe.</li>
<li><span class="math inline">\(n_{2}\)</span>, der Fallzahl der zweiten Gruppe.</li>
</ul>
<p>Wir sehen, dass sich die Formel dadurch etwas ändert. Da wir nicht mehr annehmen, dass die Varianzen homogen und daher gleich sind, können wir auch keinen gepoolten Varianzschätzer <span class="math inline">\(s_p\)</span> berechnen. Die Varianzen gehen einzeln in die Formel des Welch t-Tests ein. Ebenso müssen die beiden Gruppen nicht mehr gleich groß sein. Statt einen Wert <span class="math inline">\(n_g\)</span> für die Gruppengröße können wir auch die beiden Gruppengrößen mit <span class="math inline">\(n_1\)</span> und <span class="math inline">\(n_2\)</span> separat angeben.</p>
<p>Wir könne auch kurz die Formel des Student t-Test aus der Formel des Welch t-Test herleiten. Wir müssen dazu annehmen, dass wir gleiche Fallzahlen <span class="math inline">\(n_1 = n_2\)</span> sowie die gleiche Varianz <span class="math inline">\(s^2_1 = s^2_2\)</span> in den beiden Gruppen vorliegen haben. Dann sehen wir, dass die Formel des Welch t-Test im Nenner in sich zusammenfällt und wir die einfache Formel des Student t-Test erhalten.</p>
<p><span class="math display">\[
\begin{align}
T_{D} &amp;= \cfrac{\bar{y}_1 - \bar{y}_2}{\sqrt{\cfrac{s^2_1}{n_1} + \cfrac{s^2_1}{n_1}}}\\
&amp;= \cfrac{\bar{y}_1 - \bar{y}_2}{\sqrt{\cfrac{s^2_1 + s^2_1}{n_1}}}\\
&amp;= \cfrac{\bar{y}_1 - \bar{y}_2}{\sqrt{\cfrac{2 \cdot s^2_1}{n_1}}}\\
&amp;= \cfrac{\bar{y}_1 - \bar{y}_2}{s_1 \cdot \sqrt{\cfrac{2}{n_1}}}
\end{align}
\]</span></p>
<p>Eine Sache muss ich noch erwähnen, wenn du den Welch t-Test nutzt, dann ändern sich auch die Freiheitsgrade für die t-Verteilung, wenn die Nullhypothese gilt, nach einer etwas schrägen Formel. Daher muss man noch bedenken, dass die Freiheitsgrade anders berechnet werden. Die Freiheitsgrade werden wie folgt mit einer etwas komplexeren Formel berechnet.</p>
<p><span class="math display">\[
df = \cfrac{\left(\cfrac{s^2_1}{n_1} + \cfrac{s^2_2}{n_2}\right)^2}{\cfrac{\left(\cfrac{s^2_1}{n_1}\right)^2}{n_1-1} + \cfrac{\left(\cfrac{s^2_2}{n_2}\right)^2}{n_2-1}}
\]</span></p>
<p>Was aber in der eigentlichen Anwendung nichts zur Sache tut. Deshalb gehen wir hier auch nicht tiefer darauf ein. In der Anwendung wird intern schon mit den angepassten Freiheitsgraden gerechnet und händisch nutzten wir diese Formel nicht, wenn wir den Welch t-Test ausrechnen.</p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Wenn wir einen Welch t-Test per Hand berechnen wollen, dann brauchen wir ja einiges an statistischen Maßzahlen. Hier erstmal nochmal die Formel, damit wir dann für Wissen, welche der statistischen Maßzahlen wir benötigen.</p>
<p><span class="math display">\[
T_{D} = \cfrac{\bar{y}_{dog} - \bar{y}_{cat}}{\sqrt{\cfrac{s^2_{dog}}{n_{dog}} + \cfrac{s^2_{cat}}{n_{cat}}}}
\]</span></p>
<p>Wir wollen nun die Werte für <span class="math inline">\(\bar{y}_{dog}\)</span>, <span class="math inline">\(\bar{y}_{cat}\)</span> und die beiden Varianzen <span class="math inline">\(s^2_{dog}\)</span> sowie <span class="math inline">\(s^2_{cat}\)</span> berechnen. Die Fallzahlen für die beiden Gruppen sind ja mit jeweils sieben Flöhen schon bekannt. Wir nutzen hierfür die folgenden Formeln aus dem Kapitel zur deskriptiven Statistik. Wichtig ist nochmal, dass wir annehmen, dass die Varianz der Hundeflöhe <strong>nicht</strong> gleich der Varianz der Katzenflöhe mit <span class="math inline">\(s^2_{cat} \neq s^2_{dog}\)</span> ist.</p>
<p>Fangen wir einmal an mit den Mittelwerten der Sprungweiten der Hunde- und Katzenflöhe.</p>
<p><span class="math display">\[
\bar{y}_{dog} = \cfrac{5.7 + 8.9 + 11.8 + 5.6 + 9.1 + 8.2 + 7.6}{7} = 8.13
\]</span></p>
<p><span class="math display">\[
\bar{y}_{cat} = \cfrac{3.2 + 2.2 + 5.4 + 4.1 + 4.3 + 7.9 + 6.1}{7} = 4.74
\]</span></p>
<p>Dann berechnen wir jeweils die Varianz der Sprungweite der Hunde- und Katzenflöhe. Dafür brauchen wir jetzt den Mittelwert der Sprungweiten.</p>
<p><span class="math display">\[
s^2_{dog} = \cfrac{(5.7 - 8.13)^2 + (8.9 - 8.13)^2 + \cdots + (7.6 - 8.13)^2}{7-1} = 4.60
\]</span></p>
<p><span class="math display">\[
s^2_{cat} = \cfrac{(3.2 - 4.74)^2 + (2.2 - 4.74)^2 + \cdots + (6.1 - 4.74)^2}{7-1} = 3.62
\]</span></p>
<p>Abschließend setzen wir alle berechneten Werte in den Formel des Welch t-Test ein. Wir können jetzt die Varianzen der beiden Gruppen, die Mittelwerte sowie die Gruppengröße <span class="math inline">\(n_{dog} = n_{cat} = 7\)</span> in die Formel für den Student t-Test einfach einsetzen und die Teststatistik <span class="math inline">\(T_{D}\)</span> berechnen.</p>
<p><span class="math display">\[
T_{D} = \cfrac{8.13 - 4.74}{\sqrt{\cfrac{4.60}{7} + \cfrac{3.62}{7}}} = 3.13
\]</span></p>
<p>Wir erhalten eine Teststatistik <span class="math inline">\(T_{D} = 3.13\)</span> die wir mit dem kritischen Wert <span class="math inline">\(T_{\alpha = 5\%} = 2.17\)</span> vergleichen können. Da <span class="math inline">\(T_{D} &gt; T_{\alpha = 5\%}\)</span> ist, können wir die Nullhypothese ablehnen. Wir haben ein signifikanten Unterschied zwischen den mittleren Sprungweiten von Hunde- und Katzenflöhen nachgewiesen.</p>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>Wir schauen uns gleich die Umsetzung in R an. Wir nutzen erneut die Funktion <code>t.test()</code> und zwar diesmal mit der Option <code>var.equal = FALSE</code>. Damit geben wir an, dass die Varianzen heterogen zwischen den beiden Gruppen sind. Wir nutzen in unserem Beispiel die gleichen Zahlen und Daten wie schon im obigen Student t-Test Beispiel.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(jump_length <span class="sc">~</span> animal, </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> fac1_tbl, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  jump_length by animal
t = 3.1253, df = 11.831, p-value = 0.008906
alternative hypothesis: true difference in means between group dog and group cat is not equal to 0
95 percent confidence interval:
 1.021587 5.749842
sample estimates:
mean in group dog mean in group cat 
         8.128571          4.742857 </code></pre>
</div>
</div>
<p>Wir erhalten eine sehr lange Ausgabe, die auch etwas verwirrend aussieht. Gehen wir die Ausgabe einmal durch. Ich gehe nicht auf alle Punkte ein, sondern konzentriere mich hier auf die wichtigsten Aspekte.</p>
<ul>
<li><code>t = 3.1253</code> ist die berechnete Teststatistik <span class="math inline">\(T_{D}\)</span>. Der Wert unterscheidet sich leicht von unserem berechneten Wert. Der Unterschied war zu erwarten, wir haben ja auch die t-Test Formel vereinfacht.</li>
<li><code>p-value = 0.008906</code> ist der berechnete p-Wert <span class="math inline">\(Pr(T_{D}|H_0)\)</span> aus der obigen Teststatistik. Daher die Fläche rechts von der Teststatistik.</li>
<li><code>95 percent confidence interval: 1.021587 5.749842</code> ist das 95% Konfidenzintervall. Die erste Zahl ist die untere Grenze, die zweite Zahl ist die obere Grenze.</li>
</ul>
<p>Wir nutzen auch hier den p-Wert für unsere Testentscheidung. Daher vergleichen wir den p-Wert mit dem <span class="math inline">\(\alpha\)</span>-Niveau von 5%. Da der p-Wert kleiner ist als das <span class="math inline">\(\alpha\)</span>-Niveau können wir wie Nullhypothese ablehnen. Wir haben einen signifikanten Unterschied. Die Entscheidung mit dem Konfidenzintervall benötigt die Signifikanzschwelle. Wenn die 0 im Konfidenzintervall liegt können wir die Nullhypothese nicht ablehnen. Das Konfidenzintervall läuft von 1.022 bis 5.75. Damit ist die 0 nicht im Konfidenzintervall enthalten und wir können die Nullhypothese ablehnen. Wir haben ein signifikantes Konfidenzintervall vorliegen.</p>
<p>Wir sehen das viele Zahlen nahezu gleich zum Student t-Test sind. Das liegt auch daran, dass wir in unserem Daten keine große Abweichung von der Varianzhomogenität haben. Wir erhalten die gleichen Aussagen wie auch schon im Student t-Test. Schauen wir uns nochmal die Ausgabe der Funktion <code>tidy()</code> zum Abschluss an.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(jump_length <span class="sc">~</span> animal, </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> fac1_tbl, <span class="at">var.equal =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 10
  estimate estimate1 estimate2 statistic p.value parameter conf.low conf.high
     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1     3.39      8.13      4.74      3.13 0.00891      11.8     1.02      5.75
# ℹ 2 more variables: method &lt;chr&gt;, alternative &lt;chr&gt;</code></pre>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<p>Ich würde eher die Implementierung in <code>{rstatix}</code> der Standardimplementierung in <code>{stats}</code> vorziehen, da wir hier die Daten über die Pipe in die Funktion weiterleiten können. Das macht es dann doch etwas einfacher. Am Ende kommt aber das gleiche raus, so dass ich die Funktion hier als Alternative stehen lasse. Das wir noch eine Datentabelle als Ausgabe kriegen, ist natürlich auch super schön.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t_test</span>(jump_length <span class="sc">~</span> animal, </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> fac1_tbl, <span class="at">var.equal =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(group1, group2, p)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  group1 group2       p
  &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;
1 dog    cat    0.00891</code></pre>
</div>
</div>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<p>Ich habe einmal ein Video eingesprochen indem ich nochmal zeige, wie du in Excel einen t-Test rechnen kannst. Ich empfehle grundsätzlich, wenn es schon Excel sein muss, immer den Welch t-Test zu rechnen. In Excel heißt dann der Welch t-Test <code>t-Test: Two-Sample Assuming Unequal Variances</code>. Ich kann es nicht so richtig empfehlen, alles in Excel zu rechnen. Die Möglichkeiten sind doch arg begrenz. Aber ich kann verstehen, dass es manchmal sein muss.</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/fA_7X_Rz83M" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
</div>
</div>
</div>
<p>Wir sehen hier etwas besser, dass es kaum Abweichungen gibt. Alles egal? Nicht unbedingt. Das Problem ist eher <em>das Erkennen</em> von Varianzheterogenität in sehr kleinen Datensätzen. Kleine Datensätze meint Datensätze unter 30 Beobachtungen je Gruppe. Erst aber dieser Anzahl lassen sich unverzerrte Histogramme zeichnen und so aussagekräftige Abschätzungen der Varianzhomogenität oder Varianzheterogenität treffen.</p>
<p>Für das Erkennen von Normalverteilung und Varianzheterogenität werden häufig so genannte Vortest empfohlen. Aber auch hier gilt, bei kleiner Fallzahl liefern die Vortests keine verlässlichen Ergebnisse. In diesem Fall ist weiterhin die Beurteilung über einen Boxplot sinnvoller. Du findest hier mehr Informationen im Kapitel zum <a href="stat-tests-pretest2.html">Pre-Test oder Vortest</a>.</p>
</section>
<section id="verbundener-t-test-mit-abhängigen-beobachtungen" class="level3" data-number="30.6.3">
<h3 data-number="30.6.3" class="anchored" data-anchor-id="verbundener-t-test-mit-abhängigen-beobachtungen"><span class="header-section-number">30.6.3</span> Verbundener t-Test mit abhängigen Beobachtungen</h3>
<p>Es kommt häufiger mal vor, dass wir an dem <em>gleichen</em> Tier oder der <em>gleichen</em> Pflanze Messungen durchführen. Dann haben wir es mit abhängigen oder verbundenen Beobachtungen zu tun. Hier müssen wir dann zu einem anderen t-Test greifen, nämlich den t-Test für abhängige Beobachtungen. Wir nennen den t-Test auch gerne gepaarten t-Test (eng. <em>paired t test</em>).</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Theoretisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Händisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false"><code>{stats}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false"><code>{rstatix}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Was ist nun der theoretische Hintergrund des gepaarten t-Test? Wir brauchen dafür zwei Spalten, die jeweils zwei Messungen am gleichen Tier oder an der gleichen Pflanze darstellen. Dann bilden wir die Differenz der Messwerte für die erste Messung sowie der zweiten Messung und nennen diesen Wert dann <span class="math inline">\(\Delta\)</span> (deu. <em>Delta</em>). Wir rechnen den Test also auf der deskriptiven Statistik der Differenzen. Es ergeben sich dann die folgenden Hypothesenpaare für den gepaarten t-Test.</p>
<dl>
<dt>Nullhypothese</dt>
<dd>
<p>Wir testen, ob der Mittelwert der Differenzen gleich Null ist. <span class="math display">\[\bar{\Delta} = 0\]</span></p>
</dd>
<dt>Alternativhypothese</dt>
<dd>
<p>Als Alternative ist der Mittelwert der Differenzen ungleich Null. <span class="math display">\[\bar{\Delta} \neq 0\]</span></p>
</dd>
</dl>
<p>Dann brauchen wir natürlich auch eine Datentabelle mit der ID der Beobachtung, damit auch klar wird, dass wir eine Beobachtung zweimal messen. Dann kommen die beiden Messungen und anschließend die berechnete Differenz der beiden Messungen. Zwischen den Messungen kann natürlich beliebig viel Zeit vergehen. Je länger der Zeitraum, desto eher könntest du von unabhängigen Beobachtungen ausgehen.</p>
<div id="tbl-t-test-verbunden" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-t-test-verbunden-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;30.4— Beispielhafter Datensatz für einen gepaarten t-Test mit bis zu <span class="math inline">\(n\)</span> Beobachtungen. Jede Beobachtung wird zweimal gemessen und anschließend wird die Differenz als deskriptive Statistik für den Test berechnet.
</figcaption>
<div aria-describedby="tbl-t-test-verbunden-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 22%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 46%">
</colgroup>
<thead>
<tr class="header">
<th>ID Beobachtung</th>
<th style="text-align: center;">Messung 1</th>
<th style="text-align: center;">Messung 2</th>
<th style="text-align: center;">Differenz <span class="math inline">\(\boldsymbol{\Delta}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td style="text-align: center;"><span class="math inline">\(y_{11}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{21}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\Delta_1 = y_{11} - y_{21}\)</span></td>
</tr>
<tr class="even">
<td>2</td>
<td style="text-align: center;"><span class="math inline">\(y_{12}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{22}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\Delta_2 = y_{12} - y_{22}\)</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td style="text-align: center;"><span class="math inline">\(y_{13}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{23}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\Delta_3 = y_{13} - y_{23}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\vdots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
</tr>
<tr class="odd">
<td>n</td>
<td style="text-align: center;"><span class="math inline">\(y_{1n}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(y_{2n}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\Delta_n = y_{1n} - y_{2n}\)</span></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(\bar{\Delta}\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Wir nutzen folgende Formel für den gepaarten t-Test für verbundene Stichproben. Wir teilen als deen Mittelwert der Differenzen durch die Standardabweichung der Differenzen. Dann multiplizieren wir mit der Anzahl der Beobachtungen.</p>
<p><span class="math display">\[
T_{D} = \sqrt{n}\cdot\cfrac{\bar{\Delta}}{s_{\Delta}}
\]</span></p>
<p>mit</p>
<ul>
<li><span class="math inline">\(T_D\)</span>, der berechneten Teststatistik der Daten <span class="math inline">\(D\)</span>.</li>
<li><span class="math inline">\(\bar{\Delta}\)</span>, dem Mittelwert der Differenzen <span class="math inline">\(\Delta\)</span>.</li>
<li><span class="math inline">\(s_{\Delta}\)</span>, der Standardabweichung der Differenzen <span class="math inline">\(\Delta\)</span>.</li>
</ul>
<p>Den Wert der Teststatistik aus den Daten <span class="math inline">\(T_{D}\)</span> können wir dann wie immer mit einem kritischen Wert mit <span class="math inline">\(T_{\alpha = 5\%}\)</span> vergleichen. Diesen Wert <span class="math inline">\(T_{\alpha = 5\%}\)</span> erhälst du dann in der Klausur oder aber ist den Anwendungsprogrammen bekannt. Da musst du dir in der Anwendung keine Gedanken zu machen.</p>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Im folgenden Datenbeispiel in <a href="#tbl-data-ttest-paired" class="quarto-xref">Tabelle&nbsp;<span>30.5</span></a> haben wir eine verbundene Stichprobe. Das heißt wir haben nicht zehn Flöhe gemessen sondern fünf Flöhe jewiels zweimal. Einmal haben wir die Sprungweite der Flöhe im ungefütterten Zustand <code>hungrig</code> und einmal im gefütterten Zustand <code>satt</code> gemessen. Wir wollen nun wissen, ob der Fütterungszustand Auswirkungen auf die Sprungweite in [cm] hat. Hier dann nochmal die Tabelle als Erinnerung.</p>
<div class="cell">
<div id="tbl-data-ttest-paired" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-data-ttest-paired-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;30.5— Tabelle der Sprunglängen [cm] von fünf Flöhen zu zwei Zeitpunkten. Einmal wurde die Sprungweite ungefüttert und einmal gefüttert bestimmt.
</figcaption>
<div aria-describedby="tbl-data-ttest-paired-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">hungrig</th>
<th style="text-align: center;">satt</th>
<th style="text-align: center;">diff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">5.2</td>
<td style="text-align: center;">6.1</td>
<td style="text-align: center;">0.9</td>
</tr>
<tr class="even">
<td style="text-align: center;">4.1</td>
<td style="text-align: center;">5.2</td>
<td style="text-align: center;">1.1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3.5</td>
<td style="text-align: center;">3.9</td>
<td style="text-align: center;">0.4</td>
</tr>
<tr class="even">
<td style="text-align: center;">3.2</td>
<td style="text-align: center;">4.1</td>
<td style="text-align: center;">0.9</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4.6</td>
<td style="text-align: center;">5.3</td>
<td style="text-align: center;">0.7</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Als erstes brauchen wir den Mittelwert der Differenzen. Daher berechnen wir einmal den Mittelwert der Differenzen <span class="math inline">\(\Delta\)</span> wie folgt aus.</p>
<p><span class="math display">\[
\bar{\Delta} = \cfrac{0.9 + 1.1 + 0.4 + 0.9 + 0.7}{5} = 0.8
\]</span></p>
<p>Und dann brauchen wir auch einmal die Standardabweichung der einzelnen Differenzen zu dem Mittelwert der Differenzen <span class="math inline">\(\bar{\Delta}\)</span>. Wir rechnen natürlich die Standardabweichung als Wurzel der Varianz aus. Deshalb die Wurzel hier in der Formel.</p>
<p><span class="math display">\[
s_{\Delta} = \sqrt{\cfrac{(0.9 - 0.8)^2 + (1.1 - 0.8)^2 + \cdots + (0.7 - 0.8)^2}{n-1}}
\]</span></p>
<p>Wir können jetzt <span class="math inline">\(\bar{\Delta}\)</span> als Mittelwert der Differenzen die Standardabweichung der Differenzen <span class="math inline">\(s_{\Delta}\)</span> in die Formel für den t-Test für verbundene Beobachtungen einsetzen.</p>
<p><span class="math display">\[
T_{D} = \sqrt{5}\cfrac{0.8}{0.26} = 6.88
\]</span></p>
<p>Jetzt brauchen wir natürlich noch einen kritischen Wert <span class="math inline">\(T_{\alpha = 5\%}\)</span> und der wäre in diesem Fall gleich <span class="math inline">\(1.86\)</span>. Damit können wir dann die Nullhypothese ablehnen, dass wir keinen Effekt der Behandlung vorliegen haben. Es macht einen Unterschied, wie wir die Flöhe gefüttert haben. Da das <span class="math inline">\(\Delta\)</span> positiv ist, können wir auch sagen, dass gefütterte Flöhe weiter springen als nicht gefütterte Flöhe.</p>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<p>Dann haben wir hier einmal unseren kleinen Datensatz, den wir für unseren gepaarten t-Test nutzen wollen. Wir brauchen die <code>id</code> um später nochmal die Daten besser darstellen zu können. Ich möchte nämlich in den Ergebnisabbildungen weiter unten die Beobachtungen miteinander verbinden.</p>
<p>Um den die Funktion <code>t.test()</code>in R mit der Option <code>paired = TRUE</code> für den paired t-Test zu nutzen, müssen wir die Daten jeweils als Vektor in die Funktion übergeben. Daher als erstes die Spalte mit den Informationen zu den ungefütterten Flöhen und dann die Spalte mit der Information zu den gefütterten Flöhen. Wir wollen nun wissen, ob der Fütterungszustand nun eine Auswirkungen auf die Sprungweite in [cm] hat.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(paired_tbl<span class="sc">$</span>satt, paired_tbl<span class="sc">$</span>hungrig, </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  paired_tbl$satt and paired_tbl$hungrig
t = 6.7612, df = 4, p-value = 0.002496
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 0.4714866 1.1285134
sample estimates:
mean difference 
            0.8 </code></pre>
</div>
</div>
<p>Die Ausgabe des paired t-Test ähnelt stark der Aussage des Student t-Test. Wir erhalten ebenfalls den wichtigen p-Wert mit 0.0025 sowie das 95% Konfidenzintervall mit [0.47; 1.13]. Zum einen ist <span class="math inline">\(0.0025 &lt; \alpha\)</span> und somit können wir die Nullhypothese ablehnen, zum anderen ist auch die 0 nicht mit in dem Konfidenzintervall, womit wir auch hier die Nullhypothese ablehnen können.</p>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<p>Ich würde eher die Implementierung in <code>{rstatix}</code> der Standardimplementierung in <code>{stats}</code> vorziehen, da wir hier die Daten über die Pipe in die Funktion weiterleiten können. Das macht es dann doch etwas einfacher. Am Ende kommt aber das gleiche raus, so dass ich die Funktion hier als Alternative stehen lasse. Das wir noch eine Datentabelle als Ausgabe kriegen, ist natürlich auch super schön.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t_test</span>(jump_length <span class="sc">~</span> trt, <span class="at">data =</span> paired_long_tbl, </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">paired =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(group1, group2, p)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  group1  group2      p
  &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt;
1 hungrig satt   0.0025</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="modellierung" class="level2" data-number="30.7">
<h2 data-number="30.7" class="anchored" data-anchor-id="modellierung"><span class="header-section-number">30.7</span> Modellierung</h2>
<p>Für vielleicht viele, auch für die sich schon länger mit der Statistik beschäftigen, ist es immer wieder eine Überraschung, dass sich die gängigen statistischen Tests auch als Modelle abbilden lassen. Die Übersicht <a href="https://lindeloev.github.io/tests-as-linear/">Common statistical tests are linear models</a> liefert hier nochmal eine wunderbare Tabelle. Ich zeige hier die Modellierungen in <code>lm()</code> sowie <code>gls()</code>, die ja eigentlich als Regression gilt udn nicht als Test. Hier siehst du, wie sich dann auch über die Jahre Zusammenhänge herausgestellt haben, die dann methodisch vereinheitlicht wurden. Ich habe dir den direkten Vergleich dann immer in den zweiten Tab gelegt. Dann beginnen wir mit dem linearen Modell mit <code>lm()</code>, die dann auf einer kategoriellen Einflussvariable einen t-Test rechnet.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true"><code>lm()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false"><code>t.test()</code></a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = jump_length ~ animal, data = fac1_tbl)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.5429 -1.3179 -0.1857  0.9214  3.6714 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    8.129      0.766  10.611 1.88e-07 ***
animalcat     -3.386      1.083  -3.125  0.00877 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.027 on 12 degrees of freedom
Multiple R-squared:  0.4487,    Adjusted R-squared:  0.4028 
F-statistic: 9.767 on 1 and 12 DF,  p-value: 0.008768</code></pre>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(jump_length <span class="sc">~</span> animal, </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> fac1_tbl, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  jump_length by animal
t = 3.1253, df = 12, p-value = 0.008768
alternative hypothesis: true difference in means between group dog and group cat is not equal to 0
95 percent confidence interval:
 1.025339 5.746089
sample estimates:
mean in group dog mean in group cat 
         8.128571          4.742857 </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Neben der klassischen Regression, die dann homogene Varianzen in den Gruppen annimmt, können wir die Regression auch mit der Funktion <code>gls()</code> aus dem R Paket <code>{nlme}</code> rechen. Dann haben wir auch die Möglichkeit die heterogenen Varianzen in den Gruppen zu berücksichten.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true"><code>gls()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false"><code>t.test()</code></a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gls</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl, </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> animal)) <span class="sc">|&gt;</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized least squares fit by REML
  Model: jump_length ~ animal 
  Data: fac1_tbl 
       AIC      BIC    logLik
  62.81397 64.75359 -27.40698

Variance function:
 Structure: Different standard deviations per stratum
 Formula: ~1 | animal 
 Parameter estimates:
      dog       cat 
1.0000000 0.8867314 

Coefficients:
                Value Std.Error   t-value p-value
(Intercept)  8.128571 0.8105592 10.028350  0.0000
animalcat   -3.385714 1.0833307 -3.125282  0.0088

 Correlation: 
          (Intr)
animalcat -0.748

Standardized residuals:
       Min         Q1        Med         Q3        Max 
-1.3371992 -0.6930148 -0.0997879  0.4296630  1.7119904 

Residual standard error: 2.144538 
Degrees of freedom: 14 total; 12 residual</code></pre>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(jump_length <span class="sc">~</span> animal, </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> fac1_tbl, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  jump_length by animal
t = 3.1253, df = 11.831, p-value = 0.008906
alternative hypothesis: true difference in means between group dog and group cat is not equal to 0
95 percent confidence interval:
 1.021587 5.749842
sample estimates:
mean in group dog mean in group cat 
         8.128571          4.742857 </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Dann haben wir noch den Fall, dass wir einen paarweisen Vergleich rechnen wollen. In dem Fall nutzen wir wieder die Funktion <code>lm()</code> in einem linearen Modell, rechnen aber mit der Differenz. Die Schreibweise ist etwas wild, aber wir schauen einfach, ob sich die Differenz der beiden Spalten von Null unterscheidet. Nichts anderes macht ja auch der gepaarte t-Test.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true"><code>lm()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false"><code>t.test()</code></a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(hungrig <span class="sc">-</span> satt <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> paired_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = hungrig - satt ~ 1, data = paired_tbl)

Residuals:
   1    2    3    4    5 
-0.1 -0.3  0.4 -0.1  0.1 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)  -0.8000     0.1183  -6.761   0.0025 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2646 on 4 degrees of freedom</code></pre>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(paired_tbl<span class="sc">$</span>satt, paired_tbl<span class="sc">$</span>hungrig, </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  paired_tbl$satt and paired_tbl$hungrig
t = 6.7612, df = 4, p-value = 0.002496
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 0.4714866 1.1285134
sample estimates:
mean difference 
            0.8 </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="ergebnisse-mit-tidyplots" class="level2" data-number="30.8">
<h2 data-number="30.8" class="anchored" data-anchor-id="ergebnisse-mit-tidyplots"><span class="header-section-number">30.8</span> Ergebnisse mit <code>{tidyplots}</code></h2>
<p>Häufig wollen wir nicht nur den p-Wert aus einem t-Test berichten sondern natürlich auch gleich die richtige Abbildung dazu haben. Hier gibt es mit dem R Paket <code>{tidyplots}</code> eine gute Möglichkeit. Das R Paket verbindet dabei die Funktionalität von <code>{ggplot}</code> und <code>{ggpubr}</code>. Dabei bleibt es aber dann sehr einfahc zu bedienen. Insbesondere in dem Fall, dass du nur zwei Gruppen in einem t-Test miteinander vergleichen willst.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Alternativen zu <code>{tidyplots}</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Das R Paket <code>{ggpubr}</code> bietet auch noch andere Alternativen für die Darstellung von statistischen Vergleichen in deinen Daten unter <a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr: ‘ggplot2’ Based Publication Ready Plots</a>. Vielleicht findest du da auch noch eine bessere Abbildung als hier. Da wir hier sehr viel ähnliches haben, bleibe ich bei <code>{tidyplots}</code>.</p>
</div>
</div>
<p>Neben den p-Werten, die ich hier mit der Funktion <code>add_test_pvalue()</code> ergänze kannst du auch Sterne mit der Funktion <code>add_test_asterisks()</code> nutzen. Das liegt dann ganz bei dir. Es gibt auch die Möglichkeit nicht signifikante Ergebnisse auszublenden. Mehr dazu findest du dann auf der <a href="https://jbengler.github.io/tidyplots/articles/Visualizing-data.html#statistical-comparison">Hilfeseite zu den statistischen Vergleichen in <code>{tidyplots}</code></a>. Ich zeige hier dir nur die Standardanwendung. Wichtig ist auch zu wissen, dass wir immer einen Welch t-Test rechnen, also immer für die Varianzheterogenität adjustieren. Das ist auch eigentlich die bessere Variante als der Student t-Test. Häufig ist es sehr schwer in kleinen Fallzahlen abzuschätzen wie die Varianzen in den Gruppen sind. Dann lieber gleich richtig adjsutieren und auf der sicheren Seite sein.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Barplot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Boxplot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">Gepaarter Dotplot</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p>Die Standardabbildung ist sicherlich der Barplot zusammen mit der Standardabweichung als Fehlerbalken. Dann habe ich noch die einzelnen Beobachtungen ergänzt. Die Klammer über den beiden Säulen gibt den Vergleich an und die Zahl ist der p-Wert aus einem Welch t-Test. Wir sehen hier, dass sich die beiden Floharten in den Sprungweiten signifikant unterscheiden. Der p-Wert ist kleiner als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5%.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidyplot</span>(<span class="at">data =</span> fac1_tbl, </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> animal, <span class="at">y =</span> jump_length, <span class="at">color =</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_data_points</span>() <span class="sc">|&gt;</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_mean_bar</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">width =</span> <span class="fl">0.4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_sd_errorbar</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_test_pvalue</span>(<span class="at">method =</span> <span class="st">"t_test"</span>, <span class="at">hide_info =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_legend</span>() <span class="sc">|&gt;</span> </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_font</span>(<span class="at">fontsize =</span> <span class="dv">9</span>) <span class="sc">|&gt;</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_x_axis_title</span>(<span class="st">"Flohart"</span>) <span class="sc">|&gt;</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_y_axis_title</span>(<span class="st">"Sprungweite in [cm]"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_x_axis_labels</span>(<span class="at">new_names =</span> <span class="fu">c</span>(<span class="st">"dog"</span> <span class="ot">=</span> <span class="st">"Hund"</span>, <span class="st">"cat"</span> <span class="ot">=</span> <span class="st">"Katze"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_size</span>(<span class="at">width =</span> <span class="cn">NA</span>, <span class="at">height =</span> <span class="cn">NA</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-tidyplot-barplot-ttest" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tidyplot-barplot-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-ttest_files/figure-html/fig-tidyplot-barplot-ttest-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Abbildung&nbsp;30.7— Einfaktorieller Barplot für die Sprungweiten in [cm] gruppiert nach den Floharten mit mehr Optionen und angepassten Beschriftungen sowie den p-Wert aus einem Welch t-Test."><img src="stat-tests-ttest_files/figure-html/fig-tidyplot-barplot-ttest-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="336"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tidyplot-barplot-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;30.7— Einfaktorieller Barplot für die Sprungweiten in [cm] gruppiert nach den Floharten mit mehr Optionen und angepassten Beschriftungen sowie den p-Wert aus einem Welch t-Test.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p>Es gibt auch gute Gründe ienmal den Boxplot zu wählen, wenn wir etwas besser die Verteilung der Sprungweiten darstellen wollen. Ich habe dann noch die einzelnen Beobachtungen ergänzt. Die Klammer über den beiden Säulen gibt den Vergleich an und die Zahl ist der p-Wert aus einem Welch t-Test. Wir sehen hier, dass sich die beiden Floharten in den Sprungweiten signifikant unterscheiden. Der p-Wert ist kleiner als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5%.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidyplot</span>(<span class="at">data =</span> fac1_tbl, </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> animal, <span class="at">y =</span> jump_length, <span class="at">color =</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_data_points</span>() <span class="sc">|&gt;</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">box_width =</span> <span class="fl">0.3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_test_pvalue</span>(<span class="at">method =</span> <span class="st">"t_test"</span>, <span class="at">hide_info =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_legend</span>() <span class="sc">|&gt;</span> </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_font</span>(<span class="at">fontsize =</span> <span class="dv">9</span>) <span class="sc">|&gt;</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_x_axis_title</span>(<span class="st">"Flohart"</span>) <span class="sc">|&gt;</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_y_axis_title</span>(<span class="st">"Sprungweite in [cm]"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_x_axis_labels</span>(<span class="at">new_names =</span> <span class="fu">c</span>(<span class="st">"dog"</span> <span class="ot">=</span> <span class="st">"Hund"</span>, <span class="st">"cat"</span> <span class="ot">=</span> <span class="st">"Katze"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_size</span>(<span class="at">width =</span> <span class="cn">NA</span>, <span class="at">height =</span> <span class="cn">NA</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-tidyplot-boxplot-ttest" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tidyplot-boxplot-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-ttest_files/figure-html/fig-tidyplot-boxplot-ttest-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Abbildung&nbsp;30.8— Einfaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten mit mehr Optionen und angepassten Beschriftungen sowie den p-Wert aus einem Welch t-Test."><img src="stat-tests-ttest_files/figure-html/fig-tidyplot-boxplot-ttest-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="336"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tidyplot-boxplot-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;30.8— Einfaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten mit mehr Optionen und angepassten Beschriftungen sowie den p-Wert aus einem Welch t-Test.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<p>Am Ende wollen wir uns dann nochmal den gepaarten t-Test anschauen. Hier ist dann die Abbildung realtiv einfach. Wir können da die Daten <code>paired_tbl</code> aus dem gepaarten t-Test nutzen nachdem wir die Daten in das Long-Format überführt haben. Etwas schwieriger ist dann der p-Wert, den p-Wert müssen wir dann erst selber errechnen und dann ergänzen. Hier nutzen wir dann den gepaarten Datensatz in dem Long-Format.</p>
<p>Jetzt können wir den gepaarten t-Test rechnen und zwar aus dem R Paket <code>{rstatix}</code>. Dann müssen wir noch alles so umbauen, dass wir die Informationen dann in <code>{tidyplots}</code> auch nutzen können.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>stats_tbl <span class="ot">&lt;-</span> paired_long_tbl <span class="sc">|&gt;</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(id) <span class="sc">|&gt;</span> </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t_test</span>(jump_length <span class="sc">~</span> trt, <span class="at">paired =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_significance</span>() <span class="sc">|&gt;</span> </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_xy_position</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir nutzen hier die Funktion <code>stat_pvalue_manual()</code> um händisch die p-Werte zu den Dotplot mit den Mittelwert und Standardabweichung zu ergänzen. Die Verbindungen zwischen den Beobachtungen haben wir dann durch <code>add_line()</code> erzeugt. Ich gebe zu, dass ist etwas komplizierter. Wenn du dann die Sterne haben willst, dann musst due das Label auf <code>"p.signif"</code> setzen. Dann werden statt der p-Werte <code>"p"</code> dir die Sterne <code>*</code> angezeigt. Wir sehen hier, dass sich die beiden Fütterungslevel in den Sprungweiten signifikant unterscheiden. Der p-Wert ist kleiner als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5%.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>paired_long_tbl <span class="sc">|&gt;</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidyplot</span>(<span class="at">x =</span> trt, <span class="at">y =</span> jump_length, <span class="at">color =</span> trt, <span class="at">fill =</span> <span class="cn">NA</span>) <span class="sc">|&gt;</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_line</span>(<span class="at">group =</span> id, <span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_data_points</span>() <span class="sc">|&gt;</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_mean_dash</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_sd_errorbar</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add</span>(<span class="fu">stat_pvalue_manual</span>(stats_tbl, <span class="at">size =</span> <span class="dv">7</span><span class="sc">/</span>.pt, <span class="at">label =</span> <span class="st">"p"</span>,</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">bracket.nudge.y =</span> <span class="fl">0.1</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_legend</span>() <span class="sc">|&gt;</span> </span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_font</span>(<span class="at">fontsize =</span> <span class="dv">9</span>) <span class="sc">|&gt;</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_x_axis_title</span>(<span class="st">"Fütterung"</span>) <span class="sc">|&gt;</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_y_axis_title</span>(<span class="st">"Sprungweite in [cm]"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reorder_x_axis_labels</span>(<span class="st">"unfed"</span>, <span class="st">"fed"</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_x_axis_labels</span>(<span class="at">new_names =</span> <span class="fu">c</span>(<span class="st">"fed"</span> <span class="ot">=</span> <span class="st">"gefüttert"</span>, <span class="st">"unfed"</span> <span class="ot">=</span> <span class="st">"ungefüttert"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_size</span>(<span class="at">width =</span> <span class="cn">NA</span>, <span class="at">height =</span> <span class="cn">NA</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-tidyplot-barplot-ttest-paired" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tidyplot-barplot-ttest-paired-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-ttest_files/figure-html/fig-tidyplot-barplot-ttest-paired-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Abbildung&nbsp;30.9— Dotplot mit Mittelwert und Standardabweichung für die Sprungweiten in [cm] gruppiert nach den Floharten mit mehr Optionen und angepassten Beschriftungen sowie den p-Wert aus einem paired t-Test. Gleiche Messungen an gleichen Flöhen sind mit einer Linie verbunden."><img src="stat-tests-ttest_files/figure-html/fig-tidyplot-barplot-ttest-paired-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="336"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tidyplot-barplot-ttest-paired-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;30.9— Dotplot mit Mittelwert und Standardabweichung für die Sprungweiten in [cm] gruppiert nach den Floharten mit mehr Optionen und angepassten Beschriftungen sowie den p-Wert aus einem paired t-Test. Gleiche Messungen an gleichen Flöhen sind mit einer Linie verbunden.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="freiheitsgrade" class="level2" data-number="30.9">
<h2 data-number="30.9" class="anchored" data-anchor-id="freiheitsgrade"><span class="header-section-number">30.9</span> Freiheitsgrade</h2>
<p>Der t-Verteilung der Teststatistiken des t-Tests verhält sich nicht wie eine <a href="eda-distribution.html">klassische Normalverteilung</a>, die durch den Mittelwert und die Standardabweichung definiert ist. Die t-Verteilung ist nur durch die Freiheitsgrade definiert. Der Freiheitsgrad (eng. <em>degree of freedom</em>, abk. <em>df</em>) in einem t-Test mit zwei Gruppen mit den Fallzahlen <span class="math inline">\(n_1\)</span> und <span class="math inline">\(n_2\)</span> ist gegeben durch <span class="math inline">\(df = n_1 + n_2 -2\)</span>. Damit beschreiben die Freiheitsgrade grob die gesamte Fallzahl in einen Datensatz mit nur zwei Gruppen. Je mehr Fallzahl in den beiden Gruppen desto großer der Freiheitsgrad eines t-Tests.</p>
<p>Die <a href="#fig-ttest-06" class="quarto-xref">Abbildung&nbsp;<span>30.10</span></a> visualisiert diesen Zusammenhang von Freiheitsgraden und der Form der t-Verteilung. Je kleiner die Freiheitsgrade und damit die Fallzahl in unseren beiden Gruppen, desto weiter sind die Verteilungsschwänze. Wie du sehen kannst, reicht die rote Verteilung mit einem Freiheitsgrad von <span class="math inline">\(df = 10\)</span> viel weiter nach links und rechts als die anderen Verteilungen mit niedrigeren Freiheitsgraden. Daher benötigen wir auch größere <span class="math inline">\(T_{D}\)</span> Werte um ein signifikantes Ergebnis zu erhalten. Denn die Fläche unter der t-Verteilung ist immer gleich 1 und somit wandert dann der kritische Wert <span class="math inline">\(T_{\alpha = 5\%}\)</span> immer weiter nach außen. Das macht ja auch Sinn, wenn wir wenige Beobachtungen vorliegen haben, dann brauchen wir größere Werte der Teststatistik um an einen signifikanten Effekt glauben zu können.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ttest-06" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ttest-06-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-ttest_files/figure-html/fig-ttest-06-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Abbildung&nbsp;30.10— Die t-Verteilung für drei beispielhafte Freiheitsgrade. Je größer die Freiheitsgrade und damit die Fallzahl, desto näher kommt die t-Verteilung einer Normalverteilung nahe. Bei einer geringeren Fallzahl, müssen damit größere T_{D} Werte erreicht werden um eine signifikantes Ergebnis zu erhalten, da mehr Fläche nach außen wandert. [Zum Vergrößern anklicken]"><img src="stat-tests-ttest_files/figure-html/fig-ttest-06-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ttest-06-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;30.10— Die t-Verteilung für drei beispielhafte Freiheitsgrade. Je größer die Freiheitsgrade und damit die Fallzahl, desto näher kommt die t-Verteilung einer Normalverteilung nahe. Bei einer geringeren Fallzahl, müssen damit größere <span class="math inline">\(T_{D}\)</span> Werte erreicht werden um eine signifikantes Ergebnis zu erhalten, da mehr Fläche nach außen wandert. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="referenzen" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="referenzen">Referenzen</h2>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-de2010five" class="csl-entry" role="listitem">
De Winter, J. C., &amp; Dodou, D. (2010). Five-point Likert items: t test versus Mann-Whitney-Wilcoxon. <em>Practical assessment, research &amp; evaluation</em>, <em>15</em>(11), 11.
</div>
<div id="ref-erb2012anthropogenic" class="csl-entry" role="listitem">
Erb, P. L., McShea, W. J., &amp; Guralnick, R. P. (2012). <em>Anthropogenic influences on macro-level mammal occupancy in the Appalachian trail corridor</em>.
</div>
<div id="ref-rasch2011two" class="csl-entry" role="listitem">
Rasch, D., Kubinger, K. D., &amp; Moder, K. (2011). The two-sample t test: pre-testing its assumptions does not pay off. <em>Statistical papers</em>, <em>52</em>, 219–231.
</div>
<div id="ref-rasch2007robust" class="csl-entry" role="listitem">
Rasch, D., Teuscher, F., &amp; Guiard, V. (2007). How robust are tests for two independent samples? <em>Journal of statistical planning and inference</em>, <em>137</em>(8), 2706–2720.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./stat-tests-R.html" class="pagination-link" aria-label="Testen in R">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Testen in R</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./stat-tests-anova2.html" class="pagination-link" aria-label="Die ANOVA">
        <span class="nav-page-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Quellcode</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb42" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = FALSE}</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, readxl, knitr, kableExtra, Hmisc,</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="in">               patchwork, see, tinytable, infer)</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="in">cbbPalette &lt;- c("#000000", "#E69F00", "#56B4E9", "#009E73", </span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="in">                "#F0E442", "#0072B2", "#D55E00", "#CC79A7")</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="in">fac1_tbl &lt;- read_excel("data/flea_dog_cat.xlsx") |&gt; </span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(animal = as_factor(animal)) |&gt; </span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="in">  select(animal, jump_length)</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="fu"># Der t-Test {#sec-ttest}</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>*Letzte Änderung am `r format(fs::file_info("stat-tests-ttest.qmd")$modification_time, '%d. %B %Y um %H:%M:%S')`*</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"You cannot be a powerful and life-changing presence to some people without being a joke or an embarrassment to others." --- Mark Manson*</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>{{&lt; video https://youtu.be/iECcenEDzOM &gt;}}</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>Beginnen wir unsere Reise durch die statistischen Tests mit dem t-Test. Damit beginnen wir auch historisch korrekt, da der t-Test auch der erste statistische Test war, der entwickelt wurde. Wir sehen die Nutzung des t-Tests in vielen wissenschaftlichen Publikationen, wie zum Beispiel der Veröffentlichung von @erb2012anthropogenic zu dem Auftreten von Säugetieren entlang des <span class="co">[</span><span class="ot">Appalachian Trail</span><span class="co">](https://de.wikipedia.org/wiki/Appalachian_Trail)</span> in den USA. Gibt es einen Unterschied im Auftreten von Schwarzbären und Rotfüchsen in Abhängigkeit von der Trailnutzung? Wie du erkennst, handelt es sich hier um Säulendiagramme als Mittelwerte und Standardfehler. Der t-Test versteckt sich hinter den Sternen, die du als eine mögliche Darstellung der p-Werte aus dem statistischen Testen kennst.</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a><span class="al">![*Vorrausichtliches Auftreten von Schwarzbären und Rotfüchsen im Appalachian Trail Korridor nach der Häufigkeit der Nutzung. Die Sterne stellen das Signifikanzniveau auf der Grundlage eines t-Tests mit zwei Stichproben unter der Annahme ungleicher Varianz dar (\*\*\* p \&lt; 0.001).* Quelle: @erb2012anthropogenic](images/preface_t_test.png)</span>{#fig-utest-intro fig-align="center" width="100%"}</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>Woher kommen nun die Sterne über die Säulen und was soll ungleiche Varianzen bedeuten? Hier wollen wir dann mal einsteigen und verstehen was der t-Test macht und warum der t-Test für den zwei Gruppenvergleich immer noch der Goldstandard ist.</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a><span class="fu">## Allgemeiner Hintergrund</span></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>Der t-Test ist *der* bedeutende Test, wenn es um das Verständnis der Algorithmen und Konzepte in der Statistik geht. Wir haben den t-Test schon genutzt um die Idee des statistischen Testens zu verstehen und wir werdend den t-Test auch im statistischen Modellieren wiedertreffen. Dort finden wir aber die Teststatistik des t-Tests. Wir werden dort nicht direkt den t-Test rechnen sondern das Konzept des t-Tests wieder nutzen. Natürlich hat der t-Test auch wieder verschiedene Namen, je nachdem welche Software du nutzen möchtest. Deshalb nochmal eine kurze Übersicht in der nachfolgenden Tabelle für R und Excel.</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>| Name | R | Excel |</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>|:--:|:--:|:--:|</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>| Student t-Test | Two Sample t-test | t-Test: Two-Sample Assuming Equal Variances |</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>| Welch t-Test | Welch Two Sample t-test | t-Test: Two-Sample Assuming Unequal Variances |</span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>: Verschiedene Bezeichnungen für den t-Test je nach verwendeter Software. Es gibt natürlich noch weitere statistsiche Software mit noch anderen Namen. {#tbl-t-test-name}</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>Was macht also der t-Test? Der t-Test vergleicht die Mittelwerte zweier Gruppen miteinander. Das heißt wir haben zwei Gruppen, wie Hunde und Katzen, und wollen nun wissen wie sich die Sprungweiten der Hundeflöhe im Mittel von den Katzenflöhen unterscheiden. In R hätten wir damit einen Faktor mit zwei Leveln vorliegen. Darüber hinaus nimmt der t-Test implizit an, das unser Outcome $y$ normalverteilt ist. Die Varianzen können in beiden Gruppen gleich sein, dann sprechen wir von homogenen Varianzen oder Varianzhomogenität. Wir können den t-Test aber auch mit ungleichen Varianzen in beiden Gruppen rechnen, dann sprechen wir von heterogenen Varianzen oder eben Varianzheterogenität. Wir nutzen dann den Welch t-Test.</span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>Nutze den Welch t-Test, wenn du unsicher über die Varianzen bist</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>:   Ich kann als Empfehlung nur aussprechen eigentlich immer den Welch t-Test zu nutzen. Sollten die Varianzen dennoch homogen sein, macht der Welch t-Test faktisch nichts schlechter als der Student t-Test. Dafür hat der Student t-Test wirklich Probleme mit ungleichen Varianzen.</span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>Nun ist es so, das wir häufig einen t-Test verwenden müssen, wenn unsere Fallzahl $n$ sehr klein wird, da nicht-parametrische Methoden dann algorithmisch nicht mehr funktionieren. Hier hilft dann als wissenschaftliche Quelle die Arbeit von @rasch2007robust, die auch unter dem Titel <span class="co">[</span><span class="ot">The Robustness of Parametric Statistical Methods</span><span class="co">](https://www.researchgate.net/profile/Dieter-Rasch/publication/279377987_The_Influence_of_Different_Shapes_of_Distributions_with_the_Same_First_four_Moments_on_Robustness/links/586b823108aebf17d3a58cbb/The-Influence-of-Different-Shapes-of-Distributions-with-the-Same-First-four-Moments-on-Robustness.pdf)</span> frei verfügbar ist. Wichtig ist eigentlich nur das folgende Zitat aus dem Abstrakt der wissenschaftlichen Arbeit.</span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"All the results are that in most practical cases the two-sample t-test is so robust that it can be recommended in nearly all applications." --- @rasch2007robust*</span></span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>Unter den meisten Bedingungen ist der t-Test robust gegen die Verletzung der Normalverteilungsannahme. Wenn wir Varianzheterogenität vorliegen haben, dann können wir ja den Welch t-Test rechnen. Aber auch hier ist es dann wichtig auf den konkreten Datenfall zu schauen. Mehr zu der Thematik gibt es auch von @rasch2011two in der Veröffentlichugn <span class="co">[</span><span class="ot">The two-sample t test: pre-testing its assumptions does not pay off</span><span class="co">](https://link.springer.com/article/10.1007/s00362-009-0224-x)</span> mit dem zentralen Zitat.</span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"As a result, we propose that it is preferable to apply no pre-tests for the t test and no t test at all, but instead to use the Welch-test as a standard test: its power comes close to that of the t test when the variances are homogeneous \[...\]."* --- @rasch2011two</span></span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a>Auch findet @de2010five in der Veröffentlichung <span class="co">[</span><span class="ot">Five-point Likert items: t test versus Mann-Whitney-Wilcoxon</span><span class="co">](https://research.tudelft.nl/en/publications/five-point-likert-items-t-test-versus-mann-whitney-wilcoxon)</span>, dass wir uns nicht so richtig um die Normalverteilung sorgen müssen. Auch für Boniturnoten auf der Likertskala kann gut ein t-Test gerechnet werden.</span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; "*In conclusion, for five-point Likert items, the t test and wilcoxon mann whitney test generally have similar power, and researchers do not have to worry about finding a difference whilst there is none in the population."* --- @de2010five</span></span>
<span id="cb42-53"><a href="#cb42-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-54"><a href="#cb42-54" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theoretischer Hintergrund</span></span>
<span id="cb42-55"><a href="#cb42-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-56"><a href="#cb42-56" aria-hidden="true" tabindex="-1"></a>Wenn du direkt aus dem statistischen Testen hierher kommst, dann ist die Berechnung des Student t-Tests für dich kein Problem. Das machen wir im statistischen Testen ja schon als Beispiel für die Teststatistik und den p-Wert. Hier kommen dann gleich fertige Funktionen in R, die dir alles in einem berechnen. Da ist es dann immer etwas schwerer nachzuvollziehen, was die einzelnen Schritte im statistischen Testen eigentlich sind.</span>
<span id="cb42-57"><a href="#cb42-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-58"><a href="#cb42-58" aria-hidden="true" tabindex="-1"></a>Hier hilft dann das R Paket <span class="in">`{infer}`</span> mit einer Schritt für Schritt Prozedur bei Durchführung des statistischen Testen. Dann machen wir es also einmal genau so, wie wir es schon kennen. Erst die Teststatistik $T_D$ der Daten berechenen. Dann die Verteilung der Nullhypothese der Grundgesamtheit bestimmen und dann beides zusammenbringen. Ein weiterer Vorteil von <span class="in">`{infer}`</span> ist, dass wir die Funktionen sehr gut mit dem <span class="in">`|&gt;`</span> Operator nutzen können.</span>
<span id="cb42-59"><a href="#cb42-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-60"><a href="#cb42-60" aria-hidden="true" tabindex="-1"></a>Als erstes berechnen wir die Teststatistik für den t-Test $T_D$ aus den beobachteten Daten. Dafür nutzen wir unsere Sprungweiten der Hunde- und Katzenflöhe. Mehr zu den Daten auch gleich weiter unten im Abschnitt zu den genutzen Daten im Kapitel.</span>
<span id="cb42-61"><a href="#cb42-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-64"><a href="#cb42-64" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-65"><a href="#cb42-65" aria-hidden="true" tabindex="-1"></a>t_d <span class="ot">&lt;-</span> fac1_tbl <span class="sc">|&gt;</span> </span>
<span id="cb42-66"><a href="#cb42-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(jump_length <span class="sc">~</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb42-67"><a href="#cb42-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"t"</span>, <span class="at">order =</span> <span class="fu">c</span>(<span class="st">"dog"</span>, <span class="st">"cat"</span>))</span>
<span id="cb42-68"><a href="#cb42-68" aria-hidden="true" tabindex="-1"></a>t_d</span>
<span id="cb42-69"><a href="#cb42-69" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-70"><a href="#cb42-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-71"><a href="#cb42-71" aria-hidden="true" tabindex="-1"></a>Mit der Teststatistik der Daten $T_D$ können wir so erstmal nichts anfangen. Wir brauchen noch einen vergleich zu der Verteilung der Nullhypothese. Daher bestimmen wir im Folgednen die Verteilung der Nullhypothese zu der wir unsere berechnete Teststatistik $T_D$ aus den Daten vergleichen wollen.</span>
<span id="cb42-72"><a href="#cb42-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-75"><a href="#cb42-75" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-76"><a href="#cb42-76" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">202506</span>)</span>
<span id="cb42-77"><a href="#cb42-77" aria-hidden="true" tabindex="-1"></a>null_dist_data <span class="ot">&lt;-</span> fac1_tbl <span class="sc">|&gt;</span> </span>
<span id="cb42-78"><a href="#cb42-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(jump_length <span class="sc">~</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb42-79"><a href="#cb42-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">"independence"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-80"><a href="#cb42-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">"permute"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-81"><a href="#cb42-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"t"</span>, <span class="at">order =</span> <span class="fu">c</span>(<span class="st">"dog"</span>, <span class="st">"cat"</span>))</span>
<span id="cb42-82"><a href="#cb42-82" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-83"><a href="#cb42-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-84"><a href="#cb42-84" aria-hidden="true" tabindex="-1"></a>Dann schauen wir uns einmal die Verteilung der Nullhypothese an. Wie wir sehen können, liegen die meisten Teststatistiken bei der Null. Macht ja auch Sinn, in der Nullhypothese haben wir ja auch Gleichheit zwischend Hunde- und Katzenflöhen angenommen.</span>
<span id="cb42-85"><a href="#cb42-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-88"><a href="#cb42-88" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-89"><a href="#cb42-89" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb42-90"><a href="#cb42-90" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb42-91"><a href="#cb42-91" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb42-92"><a href="#cb42-92" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-theo-infer-01</span></span>
<span id="cb42-93"><a href="#cb42-93" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-94"><a href="#cb42-94" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.5</span></span>
<span id="cb42-95"><a href="#cb42-95" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb42-96"><a href="#cb42-96" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Verteilung der Nullhypothese in unseren Daten der Sprungweiten von Hunde- und Katzenflöhen. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb42-97"><a href="#cb42-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-98"><a href="#cb42-98" aria-hidden="true" tabindex="-1"></a><span class="fu">visualize</span>(null_dist_data) <span class="sc">+</span></span>
<span id="cb42-99"><a href="#cb42-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-100"><a href="#cb42-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Statistik"</span>, <span class="at">y =</span> <span class="st">"Absolute Häufigkeit"</span>) </span>
<span id="cb42-101"><a href="#cb42-101" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-102"><a href="#cb42-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-103"><a href="#cb42-103" aria-hidden="true" tabindex="-1"></a>Dann wollen wir noch die Fläche neben unsere berechnete Teststatistik $T_D$ um damit den $p$-Wert zu bestimmen.</span>
<span id="cb42-104"><a href="#cb42-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-107"><a href="#cb42-107" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-108"><a href="#cb42-108" aria-hidden="true" tabindex="-1"></a>null_dist_data <span class="sc">%&gt;%</span></span>
<span id="cb42-109"><a href="#cb42-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_p_value</span>(<span class="at">obs_stat =</span> t_d, <span class="at">direction =</span> <span class="st">"two-sided"</span>)</span>
<span id="cb42-110"><a href="#cb42-110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-111"><a href="#cb42-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-112"><a href="#cb42-112" aria-hidden="true" tabindex="-1"></a>Wie du dich noch erinnerst, ist der p-Wert die Fläche neben der berechneten Teststatistik $T_D$ zu den Verteilungsenden hin. Das wollen wir uns dann in der folgenden Abbildung nochmal anschauen, damit wir den Zusammenhang nochmal besser verstehen.</span>
<span id="cb42-113"><a href="#cb42-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-116"><a href="#cb42-116" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-117"><a href="#cb42-117" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb42-118"><a href="#cb42-118" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb42-119"><a href="#cb42-119" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb42-120"><a href="#cb42-120" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-theo-infer-02</span></span>
<span id="cb42-121"><a href="#cb42-121" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-122"><a href="#cb42-122" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.5</span></span>
<span id="cb42-123"><a href="#cb42-123" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb42-124"><a href="#cb42-124" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Verteilung der Nullhypothese in unseren Daten der Sprungweiten von Hunde- und Katzenflöhen. Die rote Linie stellt die berechnete Teststatistik $T_D$ der Daten dar. Die Eingefärbte Fläche ist der p-Wert. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb42-125"><a href="#cb42-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-126"><a href="#cb42-126" aria-hidden="true" tabindex="-1"></a><span class="fu">visualize</span>(null_dist_data) <span class="sc">+</span></span>
<span id="cb42-127"><a href="#cb42-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-128"><a href="#cb42-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shade_p_value</span>(<span class="at">obs_stat =</span> t_d, <span class="at">direction =</span> <span class="st">"two-sided"</span>,</span>
<span id="cb42-129"><a href="#cb42-129" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span></span>
<span id="cb42-130"><a href="#cb42-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Statistik"</span>, <span class="at">y =</span> <span class="st">"Absolute Häufigkeit"</span>) </span>
<span id="cb42-131"><a href="#cb42-131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-132"><a href="#cb42-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-133"><a href="#cb42-133" aria-hidden="true" tabindex="-1"></a>Die Abfolge der Schritte erfolgt so nicht in der generischen Funktion <span class="in">`t.test()`</span>, die wir dann in der Anwendung viel nutzen. Daher ist das R Paket <span class="in">`{infer}`</span> nochmal gut um die Schritte der Berechnung sich klar werden zu lassen. Später nutzen wir dann nur eine Funktion, aber der Prozess ist im Hintergrund immer sehr ähnlich.</span>
<span id="cb42-134"><a href="#cb42-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-135"><a href="#cb42-135" aria-hidden="true" tabindex="-1"></a>Eine detailliertere Einführung mit mehr Beispielen für die Nutzung vom <span class="co">[</span><span class="ot">R Paket `{infer}`</span><span class="co">](https://infer.netlify.app/)</span> findest du im Kapitel <span class="co">[</span><span class="ot">Testen in R</span><span class="co">](#sec-test-R)</span>. Hier soll es dann bei der kurzen Gegenüberstellung bleiben.</span>
<span id="cb42-136"><a href="#cb42-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-137"><a href="#cb42-137" aria-hidden="true" tabindex="-1"></a><span class="fu">## Genutzte R Pakete</span></span>
<span id="cb42-138"><a href="#cb42-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-139"><a href="#cb42-139" aria-hidden="true" tabindex="-1"></a>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</span>
<span id="cb42-140"><a href="#cb42-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-141"><a href="#cb42-141" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = TRUE}</span></span>
<span id="cb42-142"><a href="#cb42-142" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb42-143"><a href="#cb42-143" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb42-144"><a href="#cb42-144" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, magrittr, broom, readxl,</span></span>
<span id="cb42-145"><a href="#cb42-145" aria-hidden="true" tabindex="-1"></a><span class="in">               infer, see, tidyplots, rstatix, ggpubr,</span></span>
<span id="cb42-146"><a href="#cb42-146" aria-hidden="true" tabindex="-1"></a><span class="in">               ggrepel, nlme, conflicted)</span></span>
<span id="cb42-147"><a href="#cb42-147" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::filter)</span></span>
<span id="cb42-148"><a href="#cb42-148" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(rstatix::t_test)</span></span>
<span id="cb42-149"><a href="#cb42-149" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(20221206)</span></span>
<span id="cb42-150"><a href="#cb42-150" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-151"><a href="#cb42-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-152"><a href="#cb42-152" aria-hidden="true" tabindex="-1"></a>An der Seite des Kapitels findest du den Link *Quellcode anzeigen*, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</span>
<span id="cb42-153"><a href="#cb42-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-154"><a href="#cb42-154" aria-hidden="true" tabindex="-1"></a><span class="fu">## Daten</span></span>
<span id="cb42-155"><a href="#cb42-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-156"><a href="#cb42-156" aria-hidden="true" tabindex="-1"></a>In den folgendne Abschnitten brauchen wir dann zwei Datensätze. Der erste Datensatz beschreibt Hunde- und Katzenflöhe, die springen und deren Sprungweite dann gemessen wurde. Wir haben hier verschiedene Flöhe vorliegen, die nur einmal springen. Wir können aber auch den Fall haben, dass wir uns wiederholt einen Floh anschauen. Der zweite Datensatz betrachtet Hundeflöhe, die vor der Fütterung und nach der Fütterung gesprungen sind.</span>
<span id="cb42-157"><a href="#cb42-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-158"><a href="#cb42-158" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Unabhängige Messungen {.unnumbered .unlisted}</span></span>
<span id="cb42-159"><a href="#cb42-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-160"><a href="#cb42-160" aria-hidden="true" tabindex="-1"></a>Beginnen wir mit einem Datenbeispiel zu den Hunde- und Katzenflöhen. Was brauchen wir damit wir den t-Test rechnen können? Wir brauchen für den t-Test eine Spalte $y$ mit kontinuierlichen Zahlen und einer Spalte $x$ in dem wir einen Faktor mit zwei Leveln finden oder eben zwei Gruppen. Jedes Level steht dann für eine der beiden Gruppen. Das war es schon. Schauen wir uns nochmal den Datensatz <span class="in">`flea_dog_cat.xlsx`</span> in @tbl-data-ttest an und überlegen, was wir dort auswählen können.</span>
<span id="cb42-161"><a href="#cb42-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-164"><a href="#cb42-164" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-165"><a href="#cb42-165" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/flea_dog_cat.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-166"><a href="#cb42-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal)) <span class="sc">|&gt;</span> </span>
<span id="cb42-167"><a href="#cb42-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, jump_length)</span>
<span id="cb42-168"><a href="#cb42-168" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-169"><a href="#cb42-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-170"><a href="#cb42-170" aria-hidden="true" tabindex="-1"></a>Wir benötigen für den t-Test ein normalverteiltes $y$ womit wir uns hier erstmal für die kontinuierliche Sprungweite entscheiden. Dann brauchen wir einen Faktor mit zwei Leveln als $x$ und da bietet sich natürlich die beiden Gruppen Hunde- und Katzenflöhe an. Wir wählen daher mit <span class="in">`select()`</span> die Spalte <span class="in">`jump_length`</span> und <span class="in">`animal`</span> aus dem Datensatz <span class="in">`flea_dog_cat.xlsx`</span> aus. Wichtig ist, dass wir die Spalte <span class="in">`animal`</span> mit der Funktion <span class="in">`as_factor()`</span> in einen Faktor umwandeln. Anschließend speichern wir die Auswahl in dem Objekt <span class="in">`fac1_tbl`</span>. Hier dann nochmal die Datentabelle.</span>
<span id="cb42-171"><a href="#cb42-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-174"><a href="#cb42-174" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-175"><a href="#cb42-175" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb42-176"><a href="#cb42-176" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb42-177"><a href="#cb42-177" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Tabelle von sieben Hunde- und Katzenflöhen mit der Sprunglänge [cm]."</span></span>
<span id="cb42-178"><a href="#cb42-178" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-data-ttest</span></span>
<span id="cb42-179"><a href="#cb42-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-180"><a href="#cb42-180" aria-hidden="true" tabindex="-1"></a>fac1_raw_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/flea_dog_cat.xlsx"</span>) <span class="sc">|&gt;</span></span>
<span id="cb42-181"><a href="#cb42-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, jump_length) </span>
<span id="cb42-182"><a href="#cb42-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-183"><a href="#cb42-183" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(fac1_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>),</span>
<span id="cb42-184"><a href="#cb42-184" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(fac1_raw_tbl)),</span>
<span id="cb42-185"><a href="#cb42-185" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(fac1_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb42-186"><a href="#cb42-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tt</span>(<span class="at">width =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">align =</span> <span class="st">"c"</span>, <span class="at">theme =</span> <span class="st">"striped"</span>)</span>
<span id="cb42-187"><a href="#cb42-187" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-188"><a href="#cb42-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-189"><a href="#cb42-189" aria-hidden="true" tabindex="-1"></a>Wir haben jetzt die Daten richtig vorbereiten und können uns nun mit dem t-Test beschäftigen. Bevor wir den t-Test jedoch rechnen können, müssen wir uns nochmal überlegen, was der t-Test eigentlich testet und uns die Daten einmal visualisieren. Klassischerweise wollen wir einen t-Test rechnen, da wir zwei Säulen in einem Barplot miteinander vergleichen wollen. Dafür schauen wir uns in @fig-barplot-ttest einmal den Barplot und den Boxplot für die Sprungweiten getrennt nach Hund und Katze an.</span>
<span id="cb42-190"><a href="#cb42-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-193"><a href="#cb42-193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-194"><a href="#cb42-194" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb42-195"><a href="#cb42-195" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb42-196"><a href="#cb42-196" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb42-197"><a href="#cb42-197" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-barplot-ttest</span></span>
<span id="cb42-198"><a href="#cb42-198" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-199"><a href="#cb42-199" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb42-200"><a href="#cb42-200" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb42-201"><a href="#cb42-201" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung der Sprungweiten der Hunde- und Katzenflöhe. **(A)** Säulendiagramm oder Barplot mit den Mittelwerten und der Standardabweichung. **(B)** Boxplot mit den Median und dem IQR. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb42-202"><a href="#cb42-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-203"><a href="#cb42-203" aria-hidden="true" tabindex="-1"></a>stat_tbl <span class="ot">&lt;-</span> fac1_tbl <span class="sc">|&gt;</span> </span>
<span id="cb42-204"><a href="#cb42-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(animal) <span class="sc">|&gt;</span> </span>
<span id="cb42-205"><a href="#cb42-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(jump_length),</span>
<span id="cb42-206"><a href="#cb42-206" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(jump_length),</span>
<span id="cb42-207"><a href="#cb42-207" aria-hidden="true" tabindex="-1"></a>            <span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">n</span>()))</span>
<span id="cb42-208"><a href="#cb42-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-209"><a href="#cb42-209" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(stat_tbl, <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> mean, <span class="at">fill =</span> animal)) <span class="sc">+</span> </span>
<span id="cb42-210"><a href="#cb42-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-211"><a href="#cb42-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb42-212"><a href="#cb42-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean<span class="sc">-</span>sd, <span class="at">ymax =</span> mean<span class="sc">+</span>sd),</span>
<span id="cb42-213"><a href="#cb42-213" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb42-214"><a href="#cb42-214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Tierart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite [cm]"</span>) <span class="sc">+</span></span>
<span id="cb42-215"><a href="#cb42-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb42-216"><a href="#cb42-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Hund"</span>, <span class="st">"Katze"</span>)) <span class="sc">+</span></span>
<span id="cb42-217"><a href="#cb42-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>()</span>
<span id="cb42-218"><a href="#cb42-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-219"><a href="#cb42-219" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(fac1_tbl, <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length, </span>
<span id="cb42-220"><a href="#cb42-220" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb42-221"><a href="#cb42-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb42-222"><a href="#cb42-222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Tierart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite [cm]"</span>) <span class="sc">+</span></span>
<span id="cb42-223"><a href="#cb42-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-224"><a href="#cb42-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb42-225"><a href="#cb42-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Hund"</span>, <span class="st">"Katze"</span>)) <span class="sc">+</span></span>
<span id="cb42-226"><a href="#cb42-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>()</span>
<span id="cb42-227"><a href="#cb42-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-228"><a href="#cb42-228" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> </span>
<span id="cb42-229"><a href="#cb42-229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb42-230"><a href="#cb42-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb42-231"><a href="#cb42-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb42-232"><a href="#cb42-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-233"><a href="#cb42-233" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-234"><a href="#cb42-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-235"><a href="#cb42-235" aria-hidden="true" tabindex="-1"></a>Zum einen sind die Mittelwerte der Barplots nicht auf einer Höhe. Dies spricht schon mal dafür, dass wir hier einen Unterschied in den Sprungweiten vorliegen haben könnten. Schauen wir auch einmal auf die Boxplots. Wir sehen, dass sich die Boxen nicht überschneiden, ein Indiz für einen signifikanten Unterschied zwischen den beiden Gruppen. Im Weiteren liegt der Median in etwa in der Mitte der beiden Boxen. Die Whisker sind ungefähr gleich bei Hunden und Katzen. Ebenso sehen wir bei beiden Gruppen keine Ausreißer. Wir schließen daher nach der Betrachtung der beiden Abbildungen auf Folgendes:</span>
<span id="cb42-236"><a href="#cb42-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-237"><a href="#cb42-237" aria-hidden="true" tabindex="-1"></a>1)  Die Sprungweite ist für beide Gruppen ist annähernd bzw. approximativ normalverteilt.</span>
<span id="cb42-238"><a href="#cb42-238" aria-hidden="true" tabindex="-1"></a>2)  Die Standardabweichungen und damit die Varianzen $s^2_{dog} = s^2_{cat}$ der beiden Gruppen sind gleich. Es liegt somit Varianzhomogenität vor.</span>
<span id="cb42-239"><a href="#cb42-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-240"><a href="#cb42-240" aria-hidden="true" tabindex="-1"></a>Manchmal ist es etwas verwirrend, dass wir uns in einem Boxplot mit Median und IQR die Daten für einen t-Test anschauen. Immerhin rechnet ja ein t-Test mit den Mittelwerten und der Standardabweichung. Hier vergleichen wir etwas Äpfel mit Birnen. Deshalb in der @fig-dotplot-ttest der Dotplot mit dem Mittelwert und den entsprechender Standardabweichung als Fehlerbalken.</span>
<span id="cb42-241"><a href="#cb42-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-244"><a href="#cb42-244" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-245"><a href="#cb42-245" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb42-246"><a href="#cb42-246" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb42-247"><a href="#cb42-247" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-248"><a href="#cb42-248" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb42-249"><a href="#cb42-249" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb42-250"><a href="#cb42-250" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Dotplot der Sprungweiten [cm] von Hunden und Katzen zusammen mit dem Mittelwert und der Standardabweichung als Fehlerbalken."</span></span>
<span id="cb42-251"><a href="#cb42-251" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-dotplot-ttest</span></span>
<span id="cb42-252"><a href="#cb42-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-253"><a href="#cb42-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-254"><a href="#cb42-254" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fac1_tbl, <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length, </span>
<span id="cb42-255"><a href="#cb42-255" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fill =</span> animal)) <span class="sc">+</span> </span>
<span id="cb42-256"><a href="#cb42-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>  </span>
<span id="cb42-257"><a href="#cb42-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binaxis =</span> <span class="st">'y'</span>, <span class="at">stackdir =</span> <span class="st">'center'</span>) <span class="sc">+</span> </span>
<span id="cb42-258"><a href="#cb42-258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_sdl, <span class="at">fun.args =</span> <span class="fu">list</span>(<span class="at">mult=</span><span class="dv">1</span>), </span>
<span id="cb42-259"><a href="#cb42-259" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb42-260"><a href="#cb42-260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom=</span><span class="st">"point"</span>, <span class="at">color=</span><span class="st">"gray50"</span>, <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb42-261"><a href="#cb42-261" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape =</span> <span class="dv">23</span>) <span class="sc">+</span></span>
<span id="cb42-262"><a href="#cb42-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Tierart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite [cm]"</span>) <span class="sc">+</span></span>
<span id="cb42-263"><a href="#cb42-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb42-264"><a href="#cb42-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Hund"</span>, <span class="st">"Katze"</span>)) <span class="sc">+</span></span>
<span id="cb42-265"><a href="#cb42-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>()</span>
<span id="cb42-266"><a href="#cb42-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-267"><a href="#cb42-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-268"><a href="#cb42-268" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-269"><a href="#cb42-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-270"><a href="#cb42-270" aria-hidden="true" tabindex="-1"></a>Wir nutzen aber später häufig den Boxplot zur Visualisierung der einzelnen Gruppen. Über den Boxplot können wir auch gut abschätzen, ob wir eine annähernde bzw. approximative Normalverteilung vorliegen haben. Häufig werden aber auch Barplots verlangt, so dass du hier relativ frei bist, was du verwendest. Am Ende ist es aber nicht so wichtig, ob wir eine Normalverteilung vorliegen haben oder nicht. Der t-Test ist recht robust gegen eine Abweichung. Viel wichtiger ist, das du eben Mittelwerte vergleichst. Also dann zum Beispiel mittlere Boniturnoten oder mittlere Anzahlen.</span>
<span id="cb42-271"><a href="#cb42-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-272"><a href="#cb42-272" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Abhängige Messungen {.unnumbered .unlisted}</span></span>
<span id="cb42-273"><a href="#cb42-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-274"><a href="#cb42-274" aria-hidden="true" tabindex="-1"></a>Der t-Test erlaubt auch abhängige Daten zu analysieren. Das heißt wir haben die gleichen sieben Hundeflöhe wiederholt gemessen. Einmal haben wir einen Hundefloh gemessen bevor er was gegessen hat, also hungrig ist, und einmal nachdem der gleiche Floh sich satt gegessen hat. Daher haben wir hier abhängige oder verbundene Bebachtungen. Im folgenden einmal der Datensatz eingelesen im Wide-Format.</span>
<span id="cb42-275"><a href="#cb42-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-278"><a href="#cb42-278" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-279"><a href="#cb42-279" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb42-280"><a href="#cb42-280" aria-hidden="true" tabindex="-1"></a>paired_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/flea_dog_cat_repeated.xlsx"</span>) </span>
<span id="cb42-281"><a href="#cb42-281" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-282"><a href="#cb42-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-283"><a href="#cb42-283" aria-hidden="true" tabindex="-1"></a>Wie du sehen kannst haben wir die sieben Flöhe wiederholt gemessen. Die Daten sind nicht im <span class="in">`tidy`</span>-Format, da nicht jede Zeile nur eine Messunfg für eine Beobachtung beinhaltet. Das ändern wir dann einmal gleich in Long-Format.</span>
<span id="cb42-284"><a href="#cb42-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-287"><a href="#cb42-287" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-288"><a href="#cb42-288" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb42-289"><a href="#cb42-289" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb42-290"><a href="#cb42-290" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Tabelle  der Sprunglängen [cm] von fünf Hundeflöhen zu zwei Zeitpunkten. Einmal wurde die Sprungweite mit den hungrigen Flöhen und einmal mit den gleichen satten Flöhen bestimmt."</span></span>
<span id="cb42-291"><a href="#cb42-291" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-data-ttest-paired-01</span></span>
<span id="cb42-292"><a href="#cb42-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-293"><a href="#cb42-293" aria-hidden="true" tabindex="-1"></a>paired_tbl <span class="sc">|&gt;</span> </span>
<span id="cb42-294"><a href="#cb42-294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tt</span>(<span class="at">width =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">align =</span> <span class="st">"c"</span>, <span class="at">theme =</span> <span class="st">"striped"</span>)</span>
<span id="cb42-295"><a href="#cb42-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-296"><a href="#cb42-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-297"><a href="#cb42-297" aria-hidden="true" tabindex="-1"></a>Dann hier nochmal die Long-Formatvariante mit der Funktion <span class="in">`pivot_longer()`</span>. Wir brauchen das Long-Format für die Auswertung in den unteren Abschnitten für das R Paket <span class="in">`{rstatix}`</span>.</span>
<span id="cb42-298"><a href="#cb42-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-301"><a href="#cb42-301" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-302"><a href="#cb42-302" aria-hidden="true" tabindex="-1"></a>paired_long_tbl <span class="ot">&lt;-</span> paired_tbl <span class="sc">|&gt;</span> </span>
<span id="cb42-303"><a href="#cb42-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> hungrig<span class="sc">:</span>satt,</span>
<span id="cb42-304"><a href="#cb42-304" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"jump_length"</span>,</span>
<span id="cb42-305"><a href="#cb42-305" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"trt"</span>) </span>
<span id="cb42-306"><a href="#cb42-306" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-307"><a href="#cb42-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-308"><a href="#cb42-308" aria-hidden="true" tabindex="-1"></a>Manchmal ist es schwer zu verstehen, was jetzt wiederholt oder gepaart heißen soll. Deshalb hier nochmal die Visualiserung der Daten für die beiden Sprünge vor und nach der Fütterung. Ich habe die Messungen, die zusammengehören mit einer Linie verbunden. Dazu dann auch noch die jeweiligen IDs der Flöhe ergänzt.</span>
<span id="cb42-309"><a href="#cb42-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-312"><a href="#cb42-312" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-313"><a href="#cb42-313" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb42-314"><a href="#cb42-314" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb42-315"><a href="#cb42-315" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-316"><a href="#cb42-316" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb42-317"><a href="#cb42-317" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb42-318"><a href="#cb42-318" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Dotplot der Sprungweiten [cm] für Hundeflöhe in zwei verschiedenen Ernährungszuständen gemessen an zwei Zeitpunkten. Die Linien verbinden die Messung an dem gleichen Floh."</span></span>
<span id="cb42-319"><a href="#cb42-319" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-example-paired</span></span>
<span id="cb42-320"><a href="#cb42-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-321"><a href="#cb42-321" aria-hidden="true" tabindex="-1"></a>paired_tbl <span class="sc">|&gt;</span> </span>
<span id="cb42-322"><a href="#cb42-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> hungrig<span class="sc">:</span>satt,</span>
<span id="cb42-323"><a href="#cb42-323" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"jump_length"</span>,</span>
<span id="cb42-324"><a href="#cb42-324" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"trt"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-325"><a href="#cb42-325" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(trt, jump_length, <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb42-326"><a href="#cb42-326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-327"><a href="#cb42-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> id), <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb42-328"><a href="#cb42-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb42-329"><a href="#cb42-329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb42-330"><a href="#cb42-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> id), <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="fl">0.05</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb42-331"><a href="#cb42-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb42-332"><a href="#cb42-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Ernährungszustand"</span>,</span>
<span id="cb42-333"><a href="#cb42-333" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>)</span>
<span id="cb42-334"><a href="#cb42-334" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-335"><a href="#cb42-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-336"><a href="#cb42-336" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hypothesen</span></span>
<span id="cb42-337"><a href="#cb42-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-338"><a href="#cb42-338" aria-hidden="true" tabindex="-1"></a>Ohne eine Hypothese ist das Ergebnis eines statistischen Tests wie auch der t-Test nicht zu interpretieren. Wir berechnen eine Teststatistik und einen p-Wert. Beide statistischen Maßzahlen machen eine Aussage über die beobachteten Daten $D$ unter der Annahme, das die Nullhypothese $H_0$ gilt.</span>
<span id="cb42-339"><a href="#cb42-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-340"><a href="#cb42-340" aria-hidden="true" tabindex="-1"></a>Wie lautet nun das Hypothesenpaar des t-Tests? Der t-Test vergleicht die Mittelwerte von zwei Gruppen. Die Nullhypothese ist auch die Gleichheitshypothese. Die Alternativehypothese haben wir auch als Unterschiedshypothese bezeichnet.</span>
<span id="cb42-341"><a href="#cb42-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-342"><a href="#cb42-342" aria-hidden="true" tabindex="-1"></a>Daher ergibt sich für unser Beispiel mit den Sprungweiten für Hunde- und Katzenflöhen folgende Hypothesen. Die Nullhypothese sagt, dass die mittleren Sprungweite für die Hundeflöhe gleich der mittleren Sprungweite der Katzenflöhe ist. Die Alternativehypothese sagt aus, dass sich die mittlere Sprungweite von Hunde- und Katzenflöhen unterscheidet.</span>
<span id="cb42-343"><a href="#cb42-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-344"><a href="#cb42-344" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-345"><a href="#cb42-345" aria-hidden="true" tabindex="-1"></a>\begin{aligned} </span>
<span id="cb42-346"><a href="#cb42-346" aria-hidden="true" tabindex="-1"></a>H_0: \bar{y}_{dog} &amp;= \bar{y}_{cat} <span class="sc">\\</span>  </span>
<span id="cb42-347"><a href="#cb42-347" aria-hidden="true" tabindex="-1"></a>H_A: \bar{y}_{dog} &amp;\neq \bar{y}_{cat} <span class="sc">\\</span>   </span>
<span id="cb42-348"><a href="#cb42-348" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb42-349"><a href="#cb42-349" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-350"><a href="#cb42-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-351"><a href="#cb42-351" aria-hidden="true" tabindex="-1"></a>Wir testen grundsätzlich auf ein zweiseitiges $\alpha$-Niveau von 5%.</span>
<span id="cb42-352"><a href="#cb42-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-353"><a href="#cb42-353" aria-hidden="true" tabindex="-1"></a><span class="fu">## Der t-Test</span></span>
<span id="cb42-354"><a href="#cb42-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-355"><a href="#cb42-355" aria-hidden="true" tabindex="-1"></a>Dann wollen wir mal den t-Test berechnen. Den t-Test gibt es in drei Varianten, je nachdem, was wir für Fallzahlen oder aber Varianzen vorliegen haben. Wir können den t-Test wie immer mit der Hand berechnen oder aber in R sowie in Excel. Wir konzentrieren uns hier einmal auf die händsiche Berechnung für die Klausur und die Anwendung in R. Ich habe aber nochmal ein Video aufgenommen für die Anwendung des t-Tests in Excel. Manchmal gibt es ja den Notfall, dass nur Excel geht. Du müsstest die Formel des t-Test in der einfachen Form des Student t-Test gleich wiedererkennen, denn an dem t-Test erkläre ich die statistische Testtheorie und die Testentscheidung.</span>
<span id="cb42-356"><a href="#cb42-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-357"><a href="#cb42-357" aria-hidden="true" tabindex="-1"></a><span class="fu">### Student t-Test für Varianzhomogenität</span></span>
<span id="cb42-358"><a href="#cb42-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-359"><a href="#cb42-359" aria-hidden="true" tabindex="-1"></a>Fangen wir mit den einfacheren der beiden t-Tests an, dem Student t-Test. Der Student t-Test heißt so komisch, weil der Erfinder <span class="co">[</span><span class="ot">William Sealy Gosset</span><span class="co">](https://de.wikipedia.org/wiki/William_Sealy_Gosset)</span> zum Zeitpunkt der Entwicklung der Formel bei Guinness-Brauerei gearbeitet hat. Die Firma wollte aber nicht, dass seine Entdeckungen veröffentlicht werden. Also entschied sich Gosset unter einem Pseudonym seine Ideen zu präsentieren. Warum Gosset nun unbedingt Student als Pseudonym wählen musste, wird wohl sein Geheimnis bleiben. Deshalb der etwas wirre Name des t-Tests für Varianzhomogenität.</span>
<span id="cb42-360"><a href="#cb42-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-361"><a href="#cb42-361" aria-hidden="true" tabindex="-1"></a>:::: panel-tabset</span>
<span id="cb42-362"><a href="#cb42-362" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theoretisch</span></span>
<span id="cb42-363"><a href="#cb42-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-364"><a href="#cb42-364" aria-hidden="true" tabindex="-1"></a>Die Formel des Student t-Test für Varianzhomogenität müsste dir noch aus dem Kapitel zur Testentscheidung bekannt vorkommen. Die Formel ist recht einfach, deshalb nutze ich den Student t-Test in dem Kapitel für die Einführung zur Teststatistik und dem p-Wert. Was brauchen wir nun für einen Student t-Test? Liegt ein normalverteiltes $y$ vor und sind die Varianzen für die beiden zu vergleichenden Gruppen homogen $s^2_{1} = s^2_{2}$, können wir einen Student t-Test rechnen. Wir nutzen dazu die folgende Formel des Student t-Tests.</span>
<span id="cb42-365"><a href="#cb42-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-366"><a href="#cb42-366" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-367"><a href="#cb42-367" aria-hidden="true" tabindex="-1"></a>T_{D} = \cfrac{\bar{y}_{1}-\bar{y}_{2}}{s_{p} \cdot \sqrt{\cfrac{2}{n_{g}}}}</span>
<span id="cb42-368"><a href="#cb42-368" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-369"><a href="#cb42-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-370"><a href="#cb42-370" aria-hidden="true" tabindex="-1"></a>mit</span>
<span id="cb42-371"><a href="#cb42-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-372"><a href="#cb42-372" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$T_D$, der berechneten Teststatistik der Daten $D$.</span>
<span id="cb42-373"><a href="#cb42-373" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\bar{y}_{1}$, dem Mittelwert der ersten Gruppe. Gerne nehme ich hier den numerisch *größeren* Mittelwert.</span>
<span id="cb42-374"><a href="#cb42-374" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\bar{y}_{2}$, dem Mittelwert der zweiten Gruppe. Gerne nehme ich hier den numerisch *kleineren* Mittelwert.</span>
<span id="cb42-375"><a href="#cb42-375" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$s_{p}$, die gepoolte Standardabweichung aus den Standardabweichungen der $s_1$ und $s_2$ der beiden Gruppen.</span>
<span id="cb42-376"><a href="#cb42-376" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$n_{g}$, die Gruppengröße der beiden Gruppen, die hier gleich sein muss. Daher ist $n_1 = n_2 = n_g$.</span>
<span id="cb42-377"><a href="#cb42-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-378"><a href="#cb42-378" aria-hidden="true" tabindex="-1"></a>Dann nutzen wir die vereinfachte Formel für die gepoolte Standardabweichung $s_p$. Das hat den einfachen Grund, dass wir eben den t-Test nur in der Klausur händisch rechnen. Und hier machen wir uns es dann etwas einfacher.</span>
<span id="cb42-379"><a href="#cb42-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-380"><a href="#cb42-380" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-381"><a href="#cb42-381" aria-hidden="true" tabindex="-1"></a>s_{p} = \cfrac{s_{1} + s_{2}}{2}</span>
<span id="cb42-382"><a href="#cb42-382" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-383"><a href="#cb42-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-384"><a href="#cb42-384" aria-hidden="true" tabindex="-1"></a>mit</span>
<span id="cb42-385"><a href="#cb42-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-386"><a href="#cb42-386" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$s_1$, der Standardabweichung der ersten Gruppe.</span>
<span id="cb42-387"><a href="#cb42-387" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$s_2$, der Standardabweichung der zweiten Gruppe.</span>
<span id="cb42-388"><a href="#cb42-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-389"><a href="#cb42-389" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>" layout-valign="center"}</span>
<span id="cb42-390"><a href="#cb42-390" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/angel_01_small.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb42-391"><a href="#cb42-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-392"><a href="#cb42-392" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Eigentlich wäre hier folgende Formel mit $s_{p} = \sqrt{\frac{1}{2} (s^2_{dog} + s^2_{cat})}$ richtig, da wir eigentlich die Varianzen mitteln müssten und dann die Wurzel ziehen. Aber auch hier erwischen wir einen Statistikengel um es etwas einfacher zu machen.</span></span>
<span id="cb42-393"><a href="#cb42-393" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb42-394"><a href="#cb42-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-395"><a href="#cb42-395" aria-hidden="true" tabindex="-1"></a>Dann kannst du in den folgenden Tab auch dir einmal anschauen, wie die Berechnung des Student t-Tests für das Beispiel mit den Sprungweiten der Hunde- und Katzenflöhe ablaufen würde.</span>
<span id="cb42-396"><a href="#cb42-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-397"><a href="#cb42-397" aria-hidden="true" tabindex="-1"></a><span class="fu">## Händisch</span></span>
<span id="cb42-398"><a href="#cb42-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-399"><a href="#cb42-399" aria-hidden="true" tabindex="-1"></a>Wenn wir einen Student t-Test per Hand berechnen wollen, dann brauchen wir ja einiges an statistischen Maßzahlen. Hier erstmal nochmal die Formel, damit wir dann für Wissen, welche der statistischen Maßzahlen wir benötigen.</span>
<span id="cb42-400"><a href="#cb42-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-401"><a href="#cb42-401" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-402"><a href="#cb42-402" aria-hidden="true" tabindex="-1"></a>T_{D} = \cfrac{\bar{y}_{dog}-\bar{y}_{cat}}{s_{p} \cdot \sqrt{\cfrac{2}{n_{g}}}}</span>
<span id="cb42-403"><a href="#cb42-403" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-404"><a href="#cb42-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-405"><a href="#cb42-405" aria-hidden="true" tabindex="-1"></a>Wir wollen nun die Werte für $\bar{y}_{dog}$, $\bar{y}_{cat}$ und $s_{p}$ berechnen. Der Wert von $n_g$ ist ja mit sieben schon bekannt. Wir nutzen hierfür die folgenden Formeln aus dem Kapitel zur deskriptiven Statistik. Wichtig ist nochmal, dass wir annehmen, dass die Varianz der Hundeflöhe ungefähr gleich ist zu der Varianz der Katzenflöhe mit $s^2_{cat} = s^2_{dog}$.</span>
<span id="cb42-406"><a href="#cb42-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-407"><a href="#cb42-407" aria-hidden="true" tabindex="-1"></a>Fangen wir einmal an mit den Mittelwerten der Sprungweiten der Hunde- und Katzenflöhe.</span>
<span id="cb42-408"><a href="#cb42-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-409"><a href="#cb42-409" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-410"><a href="#cb42-410" aria-hidden="true" tabindex="-1"></a>\bar{y}_{dog} = \cfrac{5.7 + 8.9 + 11.8 + 5.6 + 9.1 + 8.2 + 7.6}{7} = 8.13</span>
<span id="cb42-411"><a href="#cb42-411" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-412"><a href="#cb42-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-413"><a href="#cb42-413" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-414"><a href="#cb42-414" aria-hidden="true" tabindex="-1"></a>\bar{y}_{cat} = \cfrac{3.2 + 2.2 + 5.4 + 4.1 + 4.3 + 7.9 + 6.1}{7} = 4.74</span>
<span id="cb42-415"><a href="#cb42-415" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-416"><a href="#cb42-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-417"><a href="#cb42-417" aria-hidden="true" tabindex="-1"></a>Dann berechnen wir jeweils die Varianz der Sprungweite der Hunde- und Katzenflöhe. Dafür brauchen wir jetzt den Mittelwert der Sprungweiten.</span>
<span id="cb42-418"><a href="#cb42-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-419"><a href="#cb42-419" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-420"><a href="#cb42-420" aria-hidden="true" tabindex="-1"></a>s^2_{dog} = \cfrac{(5.7 - 8.13)^2 + (8.9 - 8.13)^2 + \cdots + (7.6 - 8.13)^2}{7-1} = 4.60</span>
<span id="cb42-421"><a href="#cb42-421" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-422"><a href="#cb42-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-423"><a href="#cb42-423" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-424"><a href="#cb42-424" aria-hidden="true" tabindex="-1"></a>s^2_{cat} = \cfrac{(3.2 - 4.74)^2 + (2.2 - 4.74)^2 + \cdots + (6.1 - 4.74)^2}{7-1} = 3.62</span>
<span id="cb42-425"><a href="#cb42-425" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-426"><a href="#cb42-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-427"><a href="#cb42-427" aria-hidden="true" tabindex="-1"></a>Wenn wir die Varianz haben, können wir auch gleich die Standardabweichungen der Sprungweite der Hunde- und Katzenflöhe berechnen. Wir brauchen die einzelnen Standardabweichungen, um diese dann im Anschluss zusammenzufassen (eng. *pool*).</span>
<span id="cb42-428"><a href="#cb42-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-429"><a href="#cb42-429" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-430"><a href="#cb42-430" aria-hidden="true" tabindex="-1"></a>s_{dog} = \sqrt{4.60} = 2.14</span>
<span id="cb42-431"><a href="#cb42-431" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-432"><a href="#cb42-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-433"><a href="#cb42-433" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-434"><a href="#cb42-434" aria-hidden="true" tabindex="-1"></a>s_{car} = \sqrt{3.62} = 1.90</span>
<span id="cb42-435"><a href="#cb42-435" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-436"><a href="#cb42-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-437"><a href="#cb42-437" aria-hidden="true" tabindex="-1"></a>Jetzt können wir die gepoolte Standardabweichung aus den einzelnen Standardabweichungen der Sprungweiten der Hunde- und Katzenflöhe berechnen.</span>
<span id="cb42-438"><a href="#cb42-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-439"><a href="#cb42-439" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-440"><a href="#cb42-440" aria-hidden="true" tabindex="-1"></a>s_{p} = \cfrac{2.14 + 1.90}{2} = 2.02 </span>
<span id="cb42-441"><a href="#cb42-441" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-442"><a href="#cb42-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-443"><a href="#cb42-443" aria-hidden="true" tabindex="-1"></a>Abschließend setzen wir alle berechneten Werte in den Formel des Student t-Test ein. Wir können jetzt $s_p$ und die Mittelwerte sowie die Gruppengröße $n_g = 7$ in die Formel für den Student t-Test einfach einsetzen und die Teststatistik $T_{D}$ berechnen.</span>
<span id="cb42-444"><a href="#cb42-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-445"><a href="#cb42-445" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-446"><a href="#cb42-446" aria-hidden="true" tabindex="-1"></a>T_{D} = \cfrac{8.13 - 4.74}{2.02 \cdot \sqrt{\cfrac{2}{7}}} = 3.14</span>
<span id="cb42-447"><a href="#cb42-447" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-448"><a href="#cb42-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-449"><a href="#cb42-449" aria-hidden="true" tabindex="-1"></a>Wir erhalten eine Teststatistik $T_{D} = 3.14$ die wir mit dem kritischen Wert $T_{\alpha = 5\%} = 2.17$ vergleichen können. Da $T_{D} &gt; T_{\alpha = 5\%}$ ist, können wir die Nullhypothese ablehnen. Wir haben ein signifikanten Unterschied zwischen den mittleren Sprungweiten von Hunde- und Katzenflöhen nachgewiesen.</span>
<span id="cb42-450"><a href="#cb42-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-451"><a href="#cb42-451" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{stats}`</span></span>
<span id="cb42-452"><a href="#cb42-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-453"><a href="#cb42-453" aria-hidden="true" tabindex="-1"></a>Soweit für den Weg zu Fuß. Wir rechnen in der Anwendung keinen Student t-Test per Hand. Wir nutzen die Formel <span class="in">`t.test()`</span>. Da wir den Student t-Test unter der Annahme der Varianzhomogenität nutzen wollen, müssen wir noch die Option <span class="in">`var.equal = TRUE`</span> wählen. Die Funktion <span class="in">`t.test()`</span> benötigt erst die das $y$ und $x$ in der Modellschreibweise mit den Namen, wie die beiden Variablen auch im Datensatz <span class="in">`fac1_tbl`</span> stehen. In unserem Fall ist die Modellschreibweise dann <span class="in">`jump_length ~ animal`</span>. Im Weiteren müssen wir noch den Datensatz angeben den wir verwenden wollen durch die Option <span class="in">`data = fac1_tbl`</span>. Dann können wir die Funktion <span class="in">`t.test()`</span> ausführen.</span>
<span id="cb42-454"><a href="#cb42-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-457"><a href="#cb42-457" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-458"><a href="#cb42-458" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(jump_length <span class="sc">~</span> animal, </span>
<span id="cb42-459"><a href="#cb42-459" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> fac1_tbl, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-460"><a href="#cb42-460" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-461"><a href="#cb42-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-462"><a href="#cb42-462" aria-hidden="true" tabindex="-1"></a>Wir erhalten eine sehr lange Ausgabe, die auch etwas verwirrend aussieht. Gehen wir die Ausgabe einmal durch. Ich gehe nicht auf alle Punkte ein, sondern konzentriere mich hier auf die wichtigsten Aspekte.</span>
<span id="cb42-463"><a href="#cb42-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-464"><a href="#cb42-464" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`t = 3.12528`</span> ist die berechnete Teststatistik $T_{D}$. Der Wert unterscheidet sich leicht von unserem berechneten Wert. Der Unterschied war zu erwarten, wir haben ja auch die t-Test Formel vereinfacht.</span>
<span id="cb42-465"><a href="#cb42-465" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`p-value = 0.0087684`</span> ist der berechnete p-Wert $Pr(T_{D}|H_0)$ aus der obigen Teststatistik. Daher die Fläche rechts von der Teststatistik.</span>
<span id="cb42-466"><a href="#cb42-466" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`95 percent confidence interval: 1.0253394 5.7460892`</span> ist das 95% Konfidenzintervall. Die erste Zahl ist die untere Grenze, die zweite Zahl ist die obere Grenze.</span>
<span id="cb42-467"><a href="#cb42-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-468"><a href="#cb42-468" aria-hidden="true" tabindex="-1"></a>Wir erhalten hier dreimal die Möglichkeit eine Aussage über die $H_0$ zu treffen. In dem obigen Output von R fehlt der kritische Wert $T_{\alpha = 5\%}$. Daher ist die berechnete Teststatistik für die Testentscheidung nicht verwendbar. Wir nutzen daher den p-Wert und vergleichen den p-Wert mit dem $\alpha$-Niveau von 5%. Da der p-Wert kleiner ist als das $\alpha$-Niveau können wir wie Nullhypothese ablehnen. Wir haben einen signifikanten Unterschied. Die Entscheidung mit dem Konfidenzintervall benötigt die Signifikanzschwelle. Da wir hier einen Mittelwertsvergleich vorliegen haben ist die Signifikanzschwelle gleich 0. Wenn die 0 im Konfidenzintervall liegt können wir die Nullhypothese nicht ablehnen. In unserem Fall ist das nicht der Fall. Das Konfidenzintervall läuft von 1.025 bis 5.75. Damit ist die 0 nicht im Konfidenzintervall enthalten und wir können die Nullhypothese ablehnen. Wir haben ein signifikantes Konfidenzintervall vorliegen.</span>
<span id="cb42-469"><a href="#cb42-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-470"><a href="#cb42-470" aria-hidden="true" tabindex="-1"></a>Wie wir sehen fehlt der Mittelwertsunterschied als Effekt $\Delta$ in der Standardausgabe des t-Tests in R. Wir können den Mittelwertsunterschied selber berechnen oder aber die Funktion <span class="in">`tidy()`</span> aus dem R Paket <span class="in">`{broom}`</span> nutzen. Da der Funktion <span class="in">`tidy()`</span> kriegen wir die Informationen besser sortiert und einheitlich wiedergegeben. Da <span class="in">`tidy`</span> eine Funktion ist, die mit vielen statistischen Tests funktioniert müssen wir wissen was die einzelnen <span class="in">`estimate`</span> sind. Es hilft in diesem Fall sich die Visualisierung der Daten anzuschauen und die Abbildung mit den berechneten Werten abzugleichen.</span>
<span id="cb42-471"><a href="#cb42-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-474"><a href="#cb42-474" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-475"><a href="#cb42-475" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(jump_length <span class="sc">~</span> animal, </span>
<span id="cb42-476"><a href="#cb42-476" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> fac1_tbl, <span class="at">var.equal =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-477"><a href="#cb42-477" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() </span>
<span id="cb42-478"><a href="#cb42-478" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-479"><a href="#cb42-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-480"><a href="#cb42-480" aria-hidden="true" tabindex="-1"></a>Wir erkennen als erstes den Mittelwertsunterschied zwischen den beiden Gruppen von $3.39cm$. Danach folgen die einzelnen Mittelwerte der Sprungweiten der Hunde und Katzenflöhe mit jeweils $8.13cm$ und $4.74cm$. Darauf folgt noch der p-Wert als <span class="in">`p.value`</span> mit 0.00891 und die beiden Grenzen des Konfidenzintervalls <span class="sc">\[</span>1.03; 5.75<span class="sc">\]</span>.</span>
<span id="cb42-481"><a href="#cb42-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-482"><a href="#cb42-482" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{rstatix}`</span></span>
<span id="cb42-483"><a href="#cb42-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-484"><a href="#cb42-484" aria-hidden="true" tabindex="-1"></a>Ich würde eher die Implementierung in <span class="in">`{rstatix}`</span> der Standardimplementierung in <span class="in">`{stats}`</span> vorziehen, da wir hier die Daten über die Pipe in die Funktion weiterleiten können. Das macht es dann doch etwas einfacher. Am Ende kommt aber das gleiche raus, so dass ich die Funktion hier als Alternative stehen lasse. Das wir noch eine Datentabelle als Ausgabe kriegen, ist natürlich auch super schön.</span>
<span id="cb42-485"><a href="#cb42-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-488"><a href="#cb42-488" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-489"><a href="#cb42-489" aria-hidden="true" tabindex="-1"></a><span class="fu">t_test</span>(jump_length <span class="sc">~</span> animal, </span>
<span id="cb42-490"><a href="#cb42-490" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> fac1_tbl, <span class="at">var.equal =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-491"><a href="#cb42-491" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(group1, group2, p)</span>
<span id="cb42-492"><a href="#cb42-492" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-493"><a href="#cb42-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-494"><a href="#cb42-494" aria-hidden="true" tabindex="-1"></a><span class="fu">## Excel</span></span>
<span id="cb42-495"><a href="#cb42-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-496"><a href="#cb42-496" aria-hidden="true" tabindex="-1"></a>Ich habe einmal ein Video eingesprochen indem ich nochmal zeige, wie du in Excel einen t-Test rechnen kannst. Ich empfehle grundsätzlich, wenn es schon Excel sein muss, immer den Welch t-Test zu rechnen. In Excel heißt dann der Welch t-Test <span class="in">`t-Test: Two-Sample Assuming Unequal Variances`</span>. Ich kann es nicht so richtig empfehlen, alles in Excel zu rechnen. Die Möglichkeiten sind doch arg begrenz. Aber ich kann verstehen, dass es manchmal sein muss.</span>
<span id="cb42-497"><a href="#cb42-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-498"><a href="#cb42-498" aria-hidden="true" tabindex="-1"></a>{{&lt; video https://youtu.be/fA_7X_Rz83M &gt;}}</span>
<span id="cb42-499"><a href="#cb42-499" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb42-500"><a href="#cb42-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-501"><a href="#cb42-501" aria-hidden="true" tabindex="-1"></a><span class="fu">### Welch t-Test mit Varianzheterogenität</span></span>
<span id="cb42-502"><a href="#cb42-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-503"><a href="#cb42-503" aria-hidden="true" tabindex="-1"></a>Jetzt stellt sich natürlich sofort die Frage, was ist, wenn ich nicht die gleichen Varianzen in den beiden Gruppen vorliegen habe oder aber eben mir nicht sicher bin, ob die Varianzen *wirklich* gleich sind? Dann kannst du auch den Welch t-Test nutzen. Der Welch t-Test verlangt keine Varianzhomogenität zwischen den beiden Gruppen. Es kann also die Varianz jeweils unterschiedliche sein. Auch kann die Fallzahl in den beiden Gruppen variieren, was manchmal auch sehr praktisch sein kann. Im Allgemeinen empfehle ich eigentlich immer als Standard, wie es auch in R ist, den Welch t-Test zu nutzen. Wenn die Varianzen homogen sind, dann verlierst du nicht viel. Auf der anderen Seite gewinnst du aber mehr, wenn die Varianzen heterogen sind.</span>
<span id="cb42-504"><a href="#cb42-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-505"><a href="#cb42-505" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb42-506"><a href="#cb42-506" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theoretisch</span></span>
<span id="cb42-507"><a href="#cb42-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-508"><a href="#cb42-508" aria-hidden="true" tabindex="-1"></a>Der Welch t-Test ist auch in der Lage mit Varianzheterogenität umzugehen. Das heißt, wenn die Varianzen der beiden Gruppen nicht gleich sind. Eigentlich haben wir damit die generalisierte Formel für den t-Test vorliegen. Neben der unterschiedlichen Varianz erlaubt der Welch t-Test nämlich auch unterschiedliche Gruppengrößen zu verwenden. Wir haben dann folgende Formel vorliegen. Wir können nun wirklich jeden der drei statistischen Parameter, Mittelwert, Varianz und Fallzahl der Gruppe, entsprechend anpassen.</span>
<span id="cb42-509"><a href="#cb42-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-510"><a href="#cb42-510" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-511"><a href="#cb42-511" aria-hidden="true" tabindex="-1"></a>T_{D} = \cfrac{\bar{y}_1 - \bar{y}_2}{\sqrt{\cfrac{s^2_1}{n_1} + \cfrac{s^2_2}{n_2}}}</span>
<span id="cb42-512"><a href="#cb42-512" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-513"><a href="#cb42-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-514"><a href="#cb42-514" aria-hidden="true" tabindex="-1"></a>mit</span>
<span id="cb42-515"><a href="#cb42-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-516"><a href="#cb42-516" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$T_D$, der berechneten Teststatistik der Daten $D$.</span>
<span id="cb42-517"><a href="#cb42-517" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\bar{y}_{1}$, dem Mittelwert der ersten Gruppe. Gerne nehme ich hier den numerisch *größeren* Mittelwert.</span>
<span id="cb42-518"><a href="#cb42-518" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\bar{y}_{2}$, dem Mittelwert der zweiten Gruppe. Gerne nehme ich hier den numerisch *kleineren* Mittelwert.</span>
<span id="cb42-519"><a href="#cb42-519" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$s^2_1$, der Varianz der ersten Gruppe.</span>
<span id="cb42-520"><a href="#cb42-520" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$s^2_2$, der Varianz der zweiten Gruppe.</span>
<span id="cb42-521"><a href="#cb42-521" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$n_{1}$, der Fallzahl der ersten Gruppe.</span>
<span id="cb42-522"><a href="#cb42-522" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$n_{2}$, der Fallzahl der zweiten Gruppe.</span>
<span id="cb42-523"><a href="#cb42-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-524"><a href="#cb42-524" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass sich die Formel dadurch etwas ändert. Da wir nicht mehr annehmen, dass die Varianzen homogen und daher gleich sind, können wir auch keinen gepoolten Varianzschätzer $s_p$ berechnen. Die Varianzen gehen einzeln in die Formel des Welch t-Tests ein. Ebenso müssen die beiden Gruppen nicht mehr gleich groß sein. Statt einen Wert $n_g$ für die Gruppengröße können wir auch die beiden Gruppengrößen mit $n_1$ und $n_2$ separat angeben.</span>
<span id="cb42-525"><a href="#cb42-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-526"><a href="#cb42-526" aria-hidden="true" tabindex="-1"></a>Wir könne auch kurz die Formel des Student t-Test aus der Formel des Welch t-Test herleiten. Wir müssen dazu annehmen, dass wir gleiche Fallzahlen $n_1 = n_2$ sowie die gleiche Varianz $s^2_1 = s^2_2$ in den beiden Gruppen vorliegen haben. Dann sehen wir, dass die Formel des Welch t-Test im Nenner in sich zusammenfällt und wir die einfache Formel des Student t-Test erhalten.</span>
<span id="cb42-527"><a href="#cb42-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-528"><a href="#cb42-528" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb42-529"><a href="#cb42-529" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb42-530"><a href="#cb42-530" aria-hidden="true" tabindex="-1"></a>T_{D} &amp;= \cfrac{\bar{y}_1 - \bar{y}_2}{\sqrt{\cfrac{s^2_1}{n_1} + \cfrac{s^2_1}{n_1}}}<span class="sc">\\</span></span>
<span id="cb42-531"><a href="#cb42-531" aria-hidden="true" tabindex="-1"></a>&amp;= \cfrac{\bar{y}_1 - \bar{y}_2}{\sqrt{\cfrac{s^2_1 + s^2_1}{n_1}}}<span class="sc">\\</span></span>
<span id="cb42-532"><a href="#cb42-532" aria-hidden="true" tabindex="-1"></a>&amp;= \cfrac{\bar{y}_1 - \bar{y}_2}{\sqrt{\cfrac{2 \cdot s^2_1}{n_1}}}<span class="sc">\\</span></span>
<span id="cb42-533"><a href="#cb42-533" aria-hidden="true" tabindex="-1"></a>&amp;= \cfrac{\bar{y}_1 - \bar{y}_2}{s_1 \cdot \sqrt{\cfrac{2}{n_1}}}</span>
<span id="cb42-534"><a href="#cb42-534" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb42-535"><a href="#cb42-535" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-536"><a href="#cb42-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-537"><a href="#cb42-537" aria-hidden="true" tabindex="-1"></a>Eine Sache muss ich noch erwähnen, wenn du den Welch t-Test nutzt, dann ändern sich auch die Freiheitsgrade für die t-Verteilung, wenn die Nullhypothese gilt, nach einer etwas schrägen Formel. Daher muss man noch bedenken, dass die Freiheitsgrade anders berechnet werden. Die Freiheitsgrade werden wie folgt mit einer etwas komplexeren Formel berechnet.</span>
<span id="cb42-538"><a href="#cb42-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-539"><a href="#cb42-539" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb42-540"><a href="#cb42-540" aria-hidden="true" tabindex="-1"></a>df = \cfrac{\left(\cfrac{s^2_1}{n_1} + \cfrac{s^2_2}{n_2}\right)^2}{\cfrac{\left(\cfrac{s^2_1}{n_1}\right)^2}{n_1-1} + \cfrac{\left(\cfrac{s^2_2}{n_2}\right)^2}{n_2-1}}</span>
<span id="cb42-541"><a href="#cb42-541" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-542"><a href="#cb42-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-543"><a href="#cb42-543" aria-hidden="true" tabindex="-1"></a>Was aber in der eigentlichen Anwendung nichts zur Sache tut. Deshalb gehen wir hier auch nicht tiefer darauf ein. In der Anwendung wird intern schon mit den angepassten Freiheitsgraden gerechnet und händisch nutzten wir diese Formel nicht, wenn wir den Welch t-Test ausrechnen.</span>
<span id="cb42-544"><a href="#cb42-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-545"><a href="#cb42-545" aria-hidden="true" tabindex="-1"></a><span class="fu">## Händisch</span></span>
<span id="cb42-546"><a href="#cb42-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-547"><a href="#cb42-547" aria-hidden="true" tabindex="-1"></a>Wenn wir einen Welch t-Test per Hand berechnen wollen, dann brauchen wir ja einiges an statistischen Maßzahlen. Hier erstmal nochmal die Formel, damit wir dann für Wissen, welche der statistischen Maßzahlen wir benötigen.</span>
<span id="cb42-548"><a href="#cb42-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-549"><a href="#cb42-549" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-550"><a href="#cb42-550" aria-hidden="true" tabindex="-1"></a>T_{D} = \cfrac{\bar{y}_{dog} - \bar{y}_{cat}}{\sqrt{\cfrac{s^2_{dog}}{n_{dog}} + \cfrac{s^2_{cat}}{n_{cat}}}}</span>
<span id="cb42-551"><a href="#cb42-551" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-552"><a href="#cb42-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-553"><a href="#cb42-553" aria-hidden="true" tabindex="-1"></a>Wir wollen nun die Werte für $\bar{y}_{dog}$, $\bar{y}_{cat}$ und die beiden Varianzen $s^2_{dog}$ sowie $s^2_{cat}$ berechnen. Die Fallzahlen für die beiden Gruppen sind ja mit jeweils sieben Flöhen schon bekannt. Wir nutzen hierfür die folgenden Formeln aus dem Kapitel zur deskriptiven Statistik. Wichtig ist nochmal, dass wir annehmen, dass die Varianz der Hundeflöhe **nicht** gleich der Varianz der Katzenflöhe mit $s^2_{cat} \neq s^2_{dog}$ ist.</span>
<span id="cb42-554"><a href="#cb42-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-555"><a href="#cb42-555" aria-hidden="true" tabindex="-1"></a>Fangen wir einmal an mit den Mittelwerten der Sprungweiten der Hunde- und Katzenflöhe.</span>
<span id="cb42-556"><a href="#cb42-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-557"><a href="#cb42-557" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-558"><a href="#cb42-558" aria-hidden="true" tabindex="-1"></a>\bar{y}_{dog} = \cfrac{5.7 + 8.9 + 11.8 + 5.6 + 9.1 + 8.2 + 7.6}{7} = 8.13</span>
<span id="cb42-559"><a href="#cb42-559" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-560"><a href="#cb42-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-561"><a href="#cb42-561" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-562"><a href="#cb42-562" aria-hidden="true" tabindex="-1"></a>\bar{y}_{cat} = \cfrac{3.2 + 2.2 + 5.4 + 4.1 + 4.3 + 7.9 + 6.1}{7} = 4.74</span>
<span id="cb42-563"><a href="#cb42-563" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-564"><a href="#cb42-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-565"><a href="#cb42-565" aria-hidden="true" tabindex="-1"></a>Dann berechnen wir jeweils die Varianz der Sprungweite der Hunde- und Katzenflöhe. Dafür brauchen wir jetzt den Mittelwert der Sprungweiten.</span>
<span id="cb42-566"><a href="#cb42-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-567"><a href="#cb42-567" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-568"><a href="#cb42-568" aria-hidden="true" tabindex="-1"></a>s^2_{dog} = \cfrac{(5.7 - 8.13)^2 + (8.9 - 8.13)^2 + \cdots + (7.6 - 8.13)^2}{7-1} = 4.60</span>
<span id="cb42-569"><a href="#cb42-569" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-570"><a href="#cb42-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-571"><a href="#cb42-571" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-572"><a href="#cb42-572" aria-hidden="true" tabindex="-1"></a>s^2_{cat} = \cfrac{(3.2 - 4.74)^2 + (2.2 - 4.74)^2 + \cdots + (6.1 - 4.74)^2}{7-1} = 3.62</span>
<span id="cb42-573"><a href="#cb42-573" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-574"><a href="#cb42-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-575"><a href="#cb42-575" aria-hidden="true" tabindex="-1"></a>Abschließend setzen wir alle berechneten Werte in den Formel des Welch t-Test ein. Wir können jetzt die Varianzen der beiden Gruppen, die Mittelwerte sowie die Gruppengröße $n_{dog} = n_{cat} = 7$ in die Formel für den Student t-Test einfach einsetzen und die Teststatistik $T_{D}$ berechnen.</span>
<span id="cb42-576"><a href="#cb42-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-577"><a href="#cb42-577" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-578"><a href="#cb42-578" aria-hidden="true" tabindex="-1"></a>T_{D} = \cfrac{8.13 - 4.74}{\sqrt{\cfrac{4.60}{7} + \cfrac{3.62}{7}}} = 3.13</span>
<span id="cb42-579"><a href="#cb42-579" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-580"><a href="#cb42-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-581"><a href="#cb42-581" aria-hidden="true" tabindex="-1"></a>Wir erhalten eine Teststatistik $T_{D} = 3.13$ die wir mit dem kritischen Wert $T_{\alpha = 5\%} = 2.17$ vergleichen können. Da $T_{D} &gt; T_{\alpha = 5\%}$ ist, können wir die Nullhypothese ablehnen. Wir haben ein signifikanten Unterschied zwischen den mittleren Sprungweiten von Hunde- und Katzenflöhen nachgewiesen.</span>
<span id="cb42-582"><a href="#cb42-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-583"><a href="#cb42-583" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{stats}`</span></span>
<span id="cb42-584"><a href="#cb42-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-585"><a href="#cb42-585" aria-hidden="true" tabindex="-1"></a>Wir schauen uns gleich die Umsetzung in R an. Wir nutzen erneut die Funktion <span class="in">`t.test()`</span> und zwar diesmal mit der Option <span class="in">`var.equal = FALSE`</span>. Damit geben wir an, dass die Varianzen heterogen zwischen den beiden Gruppen sind. Wir nutzen in unserem Beispiel die gleichen Zahlen und Daten wie schon im obigen Student t-Test Beispiel.</span>
<span id="cb42-586"><a href="#cb42-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-589"><a href="#cb42-589" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-590"><a href="#cb42-590" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(jump_length <span class="sc">~</span> animal, </span>
<span id="cb42-591"><a href="#cb42-591" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> fac1_tbl, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb42-592"><a href="#cb42-592" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-593"><a href="#cb42-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-594"><a href="#cb42-594" aria-hidden="true" tabindex="-1"></a>Wir erhalten eine sehr lange Ausgabe, die auch etwas verwirrend aussieht. Gehen wir die Ausgabe einmal durch. Ich gehe nicht auf alle Punkte ein, sondern konzentriere mich hier auf die wichtigsten Aspekte.</span>
<span id="cb42-595"><a href="#cb42-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-596"><a href="#cb42-596" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`t = 3.1253`</span> ist die berechnete Teststatistik $T_{D}$. Der Wert unterscheidet sich leicht von unserem berechneten Wert. Der Unterschied war zu erwarten, wir haben ja auch die t-Test Formel vereinfacht.</span>
<span id="cb42-597"><a href="#cb42-597" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`p-value = 0.008906`</span> ist der berechnete p-Wert $Pr(T_{D}|H_0)$ aus der obigen Teststatistik. Daher die Fläche rechts von der Teststatistik.</span>
<span id="cb42-598"><a href="#cb42-598" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`95 percent confidence interval: 1.021587 5.749842`</span> ist das 95% Konfidenzintervall. Die erste Zahl ist die untere Grenze, die zweite Zahl ist die obere Grenze.</span>
<span id="cb42-599"><a href="#cb42-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-600"><a href="#cb42-600" aria-hidden="true" tabindex="-1"></a>Wir nutzen auch hier den p-Wert für unsere Testentscheidung. Daher vergleichen wir den p-Wert mit dem $\alpha$-Niveau von 5%. Da der p-Wert kleiner ist als das $\alpha$-Niveau können wir wie Nullhypothese ablehnen. Wir haben einen signifikanten Unterschied. Die Entscheidung mit dem Konfidenzintervall benötigt die Signifikanzschwelle. Wenn die 0 im Konfidenzintervall liegt können wir die Nullhypothese nicht ablehnen. Das Konfidenzintervall läuft von 1.022 bis 5.75. Damit ist die 0 nicht im Konfidenzintervall enthalten und wir können die Nullhypothese ablehnen. Wir haben ein signifikantes Konfidenzintervall vorliegen.</span>
<span id="cb42-601"><a href="#cb42-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-602"><a href="#cb42-602" aria-hidden="true" tabindex="-1"></a>Wir sehen das viele Zahlen nahezu gleich zum Student t-Test sind. Das liegt auch daran, dass wir in unserem Daten keine große Abweichung von der Varianzhomogenität haben. Wir erhalten die gleichen Aussagen wie auch schon im Student t-Test. Schauen wir uns nochmal die Ausgabe der Funktion <span class="in">`tidy()`</span> zum Abschluss an.</span>
<span id="cb42-603"><a href="#cb42-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-606"><a href="#cb42-606" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-607"><a href="#cb42-607" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(jump_length <span class="sc">~</span> animal, </span>
<span id="cb42-608"><a href="#cb42-608" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> fac1_tbl, <span class="at">var.equal =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-609"><a href="#cb42-609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() </span>
<span id="cb42-610"><a href="#cb42-610" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-611"><a href="#cb42-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-612"><a href="#cb42-612" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{rstatix}`</span></span>
<span id="cb42-613"><a href="#cb42-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-614"><a href="#cb42-614" aria-hidden="true" tabindex="-1"></a>Ich würde eher die Implementierung in <span class="in">`{rstatix}`</span> der Standardimplementierung in <span class="in">`{stats}`</span> vorziehen, da wir hier die Daten über die Pipe in die Funktion weiterleiten können. Das macht es dann doch etwas einfacher. Am Ende kommt aber das gleiche raus, so dass ich die Funktion hier als Alternative stehen lasse. Das wir noch eine Datentabelle als Ausgabe kriegen, ist natürlich auch super schön.</span>
<span id="cb42-615"><a href="#cb42-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-618"><a href="#cb42-618" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-619"><a href="#cb42-619" aria-hidden="true" tabindex="-1"></a><span class="fu">t_test</span>(jump_length <span class="sc">~</span> animal, </span>
<span id="cb42-620"><a href="#cb42-620" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> fac1_tbl, <span class="at">var.equal =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-621"><a href="#cb42-621" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(group1, group2, p)</span>
<span id="cb42-622"><a href="#cb42-622" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-623"><a href="#cb42-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-624"><a href="#cb42-624" aria-hidden="true" tabindex="-1"></a><span class="fu">## Excel</span></span>
<span id="cb42-625"><a href="#cb42-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-626"><a href="#cb42-626" aria-hidden="true" tabindex="-1"></a>Ich habe einmal ein Video eingesprochen indem ich nochmal zeige, wie du in Excel einen t-Test rechnen kannst. Ich empfehle grundsätzlich, wenn es schon Excel sein muss, immer den Welch t-Test zu rechnen. In Excel heißt dann der Welch t-Test <span class="in">`t-Test: Two-Sample Assuming Unequal Variances`</span>. Ich kann es nicht so richtig empfehlen, alles in Excel zu rechnen. Die Möglichkeiten sind doch arg begrenz. Aber ich kann verstehen, dass es manchmal sein muss.</span>
<span id="cb42-627"><a href="#cb42-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-628"><a href="#cb42-628" aria-hidden="true" tabindex="-1"></a>{{&lt; video https://youtu.be/fA_7X_Rz83M &gt;}}</span>
<span id="cb42-629"><a href="#cb42-629" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-630"><a href="#cb42-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-631"><a href="#cb42-631" aria-hidden="true" tabindex="-1"></a>Wir sehen hier etwas besser, dass es kaum Abweichungen gibt. Alles egal? Nicht unbedingt. Das Problem ist eher *das Erkennen* von Varianzheterogenität in sehr kleinen Datensätzen. Kleine Datensätze meint Datensätze unter 30 Beobachtungen je Gruppe. Erst aber dieser Anzahl lassen sich unverzerrte Histogramme zeichnen und so aussagekräftige Abschätzungen der Varianzhomogenität oder Varianzheterogenität treffen.</span>
<span id="cb42-632"><a href="#cb42-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-633"><a href="#cb42-633" aria-hidden="true" tabindex="-1"></a>Für das Erkennen von Normalverteilung und Varianzheterogenität werden häufig so genannte Vortest empfohlen. Aber auch hier gilt, bei kleiner Fallzahl liefern die Vortests keine verlässlichen Ergebnisse. In diesem Fall ist weiterhin die Beurteilung über einen Boxplot sinnvoller. Du findest hier mehr Informationen im Kapitel zum <span class="co">[</span><span class="ot">Pre-Test oder Vortest</span><span class="co">](#sec-pretest)</span>.</span>
<span id="cb42-634"><a href="#cb42-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-635"><a href="#cb42-635" aria-hidden="true" tabindex="-1"></a><span class="fu">### Verbundener t-Test mit abhängigen Beobachtungen</span></span>
<span id="cb42-636"><a href="#cb42-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-637"><a href="#cb42-637" aria-hidden="true" tabindex="-1"></a>Es kommt häufiger mal vor, dass wir an dem *gleichen* Tier oder der *gleichen* Pflanze Messungen durchführen. Dann haben wir es mit abhängigen oder verbundenen Beobachtungen zu tun. Hier müssen wir dann zu einem anderen t-Test greifen, nämlich den t-Test für abhängige Beobachtungen. Wir nennen den t-Test auch gerne gepaarten t-Test (eng. *paired t test*).</span>
<span id="cb42-638"><a href="#cb42-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-639"><a href="#cb42-639" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb42-640"><a href="#cb42-640" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theoretisch</span></span>
<span id="cb42-641"><a href="#cb42-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-642"><a href="#cb42-642" aria-hidden="true" tabindex="-1"></a>Was ist nun der theoretische Hintergrund des gepaarten t-Test? Wir brauchen dafür zwei Spalten, die jeweils zwei Messungen am gleichen Tier oder an der gleichen Pflanze darstellen. Dann bilden wir die Differenz der Messwerte für die erste Messung sowie der zweiten Messung und nennen diesen Wert dann $\Delta$ (deu. *Delta*). Wir rechnen den Test also auf der deskriptiven Statistik der Differenzen. Es ergeben sich dann die folgenden Hypothesenpaare für den gepaarten t-Test.</span>
<span id="cb42-643"><a href="#cb42-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-644"><a href="#cb42-644" aria-hidden="true" tabindex="-1"></a>Nullhypothese</span>
<span id="cb42-645"><a href="#cb42-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-646"><a href="#cb42-646" aria-hidden="true" tabindex="-1"></a>:   Wir testen, ob der Mittelwert der Differenzen gleich Null ist. $$\bar{\Delta} = 0$$</span>
<span id="cb42-647"><a href="#cb42-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-648"><a href="#cb42-648" aria-hidden="true" tabindex="-1"></a>Alternativhypothese</span>
<span id="cb42-649"><a href="#cb42-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-650"><a href="#cb42-650" aria-hidden="true" tabindex="-1"></a>:   Als Alternative ist der Mittelwert der Differenzen ungleich Null. $$\bar{\Delta} \neq 0$$</span>
<span id="cb42-651"><a href="#cb42-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-652"><a href="#cb42-652" aria-hidden="true" tabindex="-1"></a>Dann brauchen wir natürlich auch eine Datentabelle mit der ID der Beobachtung, damit auch klar wird, dass wir eine Beobachtung zweimal messen. Dann kommen die beiden Messungen und anschließend die berechnete Differenz der beiden Messungen. Zwischen den Messungen kann natürlich beliebig viel Zeit vergehen. Je länger der Zeitraum, desto eher könntest du von unabhängigen Beobachtungen ausgehen.</span>
<span id="cb42-653"><a href="#cb42-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-654"><a href="#cb42-654" aria-hidden="true" tabindex="-1"></a>| ID Beobachtung | Messung 1 | Messung 2 | Differenz $\boldsymbol{\Delta}$ |</span>
<span id="cb42-655"><a href="#cb42-655" aria-hidden="true" tabindex="-1"></a>|----------------|:---------:|:---------:|:-------------------------------:|</span>
<span id="cb42-656"><a href="#cb42-656" aria-hidden="true" tabindex="-1"></a>| 1              | $y_{11}$  | $y_{21}$  |  $\Delta_1 = y_{11} - y_{21}$   |</span>
<span id="cb42-657"><a href="#cb42-657" aria-hidden="true" tabindex="-1"></a>| 2              | $y_{12}$  | $y_{22}$  |  $\Delta_2 = y_{12} - y_{22}$   |</span>
<span id="cb42-658"><a href="#cb42-658" aria-hidden="true" tabindex="-1"></a>| 3              | $y_{13}$  | $y_{23}$  |  $\Delta_3 = y_{13} - y_{23}$   |</span>
<span id="cb42-659"><a href="#cb42-659" aria-hidden="true" tabindex="-1"></a>| $\vdots$       | $\vdots$  | $\vdots$  |            $\vdots$             |</span>
<span id="cb42-660"><a href="#cb42-660" aria-hidden="true" tabindex="-1"></a>| n              | $y_{1n}$  | $y_{2n}$  |  $\Delta_n = y_{1n} - y_{2n}$   |</span>
<span id="cb42-661"><a href="#cb42-661" aria-hidden="true" tabindex="-1"></a>|                |           |           |         $\bar{\Delta}$          |</span>
<span id="cb42-662"><a href="#cb42-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-663"><a href="#cb42-663" aria-hidden="true" tabindex="-1"></a>: Beispielhafter Datensatz für einen gepaarten t-Test mit bis zu $n$ Beobachtungen. Jede Beobachtung wird zweimal gemessen und anschließend wird die Differenz als deskriptive Statistik für den Test berechnet. {#tbl-t-test-verbunden}</span>
<span id="cb42-664"><a href="#cb42-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-665"><a href="#cb42-665" aria-hidden="true" tabindex="-1"></a>Wir nutzen folgende Formel für den gepaarten t-Test für verbundene Stichproben. Wir teilen als deen Mittelwert der Differenzen durch die Standardabweichung der Differenzen. Dann multiplizieren wir mit der Anzahl der Beobachtungen.</span>
<span id="cb42-666"><a href="#cb42-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-667"><a href="#cb42-667" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-668"><a href="#cb42-668" aria-hidden="true" tabindex="-1"></a>T_{D} = \sqrt{n}\cdot\cfrac{\bar{\Delta}}{s_{\Delta}}</span>
<span id="cb42-669"><a href="#cb42-669" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-670"><a href="#cb42-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-671"><a href="#cb42-671" aria-hidden="true" tabindex="-1"></a>mit</span>
<span id="cb42-672"><a href="#cb42-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-673"><a href="#cb42-673" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$T_D$, der berechneten Teststatistik der Daten $D$.</span>
<span id="cb42-674"><a href="#cb42-674" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\bar{\Delta}$, dem Mittelwert der Differenzen $\Delta$.</span>
<span id="cb42-675"><a href="#cb42-675" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$s_{\Delta}$, der Standardabweichung der Differenzen $\Delta$.</span>
<span id="cb42-676"><a href="#cb42-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-677"><a href="#cb42-677" aria-hidden="true" tabindex="-1"></a>Den Wert der Teststatistik aus den Daten $T_{D}$ können wir dann wie immer mit einem kritischen Wert mit $T_{\alpha = 5\%}$ vergleichen. Diesen Wert $T_{\alpha = 5\%}$ erhälst du dann in der Klausur oder aber ist den Anwendungsprogrammen bekannt. Da musst du dir in der Anwendung keine Gedanken zu machen.</span>
<span id="cb42-678"><a href="#cb42-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-679"><a href="#cb42-679" aria-hidden="true" tabindex="-1"></a><span class="fu">## Händisch</span></span>
<span id="cb42-680"><a href="#cb42-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-681"><a href="#cb42-681" aria-hidden="true" tabindex="-1"></a>Im folgenden Datenbeispiel in @tbl-data-ttest-paired haben wir eine verbundene Stichprobe. Das heißt wir haben nicht zehn Flöhe gemessen sondern fünf Flöhe jewiels zweimal. Einmal haben wir die Sprungweite der Flöhe im ungefütterten Zustand <span class="in">`hungrig`</span> und einmal im gefütterten Zustand <span class="in">`satt`</span> gemessen. Wir wollen nun wissen, ob der Fütterungszustand Auswirkungen auf die Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span> hat. Hier dann nochmal die Tabelle als Erinnerung.</span>
<span id="cb42-682"><a href="#cb42-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-685"><a href="#cb42-685" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-686"><a href="#cb42-686" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb42-687"><a href="#cb42-687" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb42-688"><a href="#cb42-688" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Tabelle  der Sprunglängen [cm] von fünf Flöhen zu zwei Zeitpunkten. Einmal wurde die Sprungweite ungefüttert und einmal gefüttert bestimmt."</span></span>
<span id="cb42-689"><a href="#cb42-689" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-data-ttest-paired</span></span>
<span id="cb42-690"><a href="#cb42-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-691"><a href="#cb42-691" aria-hidden="true" tabindex="-1"></a>paired_raw_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">hungrig =</span> <span class="fu">c</span>(<span class="fl">5.2</span>, <span class="fl">4.1</span>, <span class="fl">3.5</span>, <span class="fl">3.2</span>, <span class="fl">4.6</span>),</span>
<span id="cb42-692"><a href="#cb42-692" aria-hidden="true" tabindex="-1"></a>                         <span class="at">satt =</span> <span class="fu">c</span>(<span class="fl">6.1</span>, <span class="fl">5.2</span>, <span class="fl">3.9</span>, <span class="fl">4.1</span>, <span class="fl">5.3</span>),</span>
<span id="cb42-693"><a href="#cb42-693" aria-hidden="true" tabindex="-1"></a>                         <span class="at">diff =</span> satt <span class="sc">-</span> hungrig) </span>
<span id="cb42-694"><a href="#cb42-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-695"><a href="#cb42-695" aria-hidden="true" tabindex="-1"></a>paired_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(paired_raw_tbl<span class="sc">$</span>diff)</span>
<span id="cb42-696"><a href="#cb42-696" aria-hidden="true" tabindex="-1"></a>paired_sd <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">sd</span>(paired_raw_tbl<span class="sc">$</span>diff), <span class="dv">2</span>)</span>
<span id="cb42-697"><a href="#cb42-697" aria-hidden="true" tabindex="-1"></a>paired_t <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">sqrt</span>(<span class="dv">5</span>) <span class="sc">*</span> paired_mean<span class="sc">/</span>paired_sd, <span class="dv">2</span>)</span>
<span id="cb42-698"><a href="#cb42-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-699"><a href="#cb42-699" aria-hidden="true" tabindex="-1"></a>paired_raw_tbl <span class="sc">|&gt;</span> </span>
<span id="cb42-700"><a href="#cb42-700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb42-701"><a href="#cb42-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-702"><a href="#cb42-702" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-703"><a href="#cb42-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-704"><a href="#cb42-704" aria-hidden="true" tabindex="-1"></a>Als erstes brauchen wir den Mittelwert der Differenzen. Daher berechnen wir einmal den Mittelwert der Differenzen $\Delta$ wie folgt aus.</span>
<span id="cb42-705"><a href="#cb42-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-706"><a href="#cb42-706" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-707"><a href="#cb42-707" aria-hidden="true" tabindex="-1"></a>\bar{\Delta} = \cfrac{0.9 + 1.1 + 0.4 + 0.9 + 0.7}{5} = 0.8</span>
<span id="cb42-708"><a href="#cb42-708" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-709"><a href="#cb42-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-710"><a href="#cb42-710" aria-hidden="true" tabindex="-1"></a>Und dann brauchen wir auch einmal die Standardabweichung der einzelnen Differenzen zu dem Mittelwert der Differenzen $\bar{\Delta}$. Wir rechnen natürlich die Standardabweichung als Wurzel der Varianz aus. Deshalb die Wurzel hier in der Formel.</span>
<span id="cb42-711"><a href="#cb42-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-712"><a href="#cb42-712" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-713"><a href="#cb42-713" aria-hidden="true" tabindex="-1"></a>s_{\Delta} = \sqrt{\cfrac{(0.9 - 0.8)^2 + (1.1 - 0.8)^2 + \cdots + (0.7 - 0.8)^2}{n-1}}</span>
<span id="cb42-714"><a href="#cb42-714" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-715"><a href="#cb42-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-716"><a href="#cb42-716" aria-hidden="true" tabindex="-1"></a>Wir können jetzt $\bar{\Delta}$ als Mittelwert der Differenzen die Standardabweichung der Differenzen $s_{\Delta}$ in die Formel für den t-Test für verbundene Beobachtungen einsetzen.</span>
<span id="cb42-717"><a href="#cb42-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-718"><a href="#cb42-718" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-719"><a href="#cb42-719" aria-hidden="true" tabindex="-1"></a>T_{D} = \sqrt{5}\cfrac{<span class="in">`r paired_mean`</span>}{<span class="in">`r paired_sd`</span>} = <span class="in">`r paired_t`</span></span>
<span id="cb42-720"><a href="#cb42-720" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb42-721"><a href="#cb42-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-722"><a href="#cb42-722" aria-hidden="true" tabindex="-1"></a>Jetzt brauchen wir natürlich noch einen kritischen Wert $T_{\alpha = 5\%}$ und der wäre in diesem Fall gleich $<span class="in">`r round(qt(0.95, (5 + 5 - 2), lower.tail = TRUE), 2)`</span>$. Damit können wir dann die Nullhypothese ablehnen, dass wir keinen Effekt der Behandlung vorliegen haben. Es macht einen Unterschied, wie wir die Flöhe gefüttert haben. Da das $\Delta$ positiv ist, können wir auch sagen, dass gefütterte Flöhe weiter springen als nicht gefütterte Flöhe.</span>
<span id="cb42-723"><a href="#cb42-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-724"><a href="#cb42-724" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{stats}`</span></span>
<span id="cb42-725"><a href="#cb42-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-726"><a href="#cb42-726" aria-hidden="true" tabindex="-1"></a>Dann haben wir hier einmal unseren kleinen Datensatz, den wir für unseren gepaarten t-Test nutzen wollen. Wir brauchen die <span class="in">`id`</span> um später nochmal die Daten besser darstellen zu können. Ich möchte nämlich in den Ergebnisabbildungen weiter unten die Beobachtungen miteinander verbinden.</span>
<span id="cb42-727"><a href="#cb42-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-728"><a href="#cb42-728" aria-hidden="true" tabindex="-1"></a>Um den die Funktion <span class="in">`t.test()`</span>in R mit der Option <span class="in">`paired = TRUE`</span> für den paired t-Test zu nutzen, müssen wir die Daten jeweils als Vektor in die Funktion übergeben. Daher als erstes die Spalte mit den Informationen zu den ungefütterten Flöhen und dann die Spalte mit der Information zu den gefütterten Flöhen. Wir wollen nun wissen, ob der Fütterungszustand nun eine Auswirkungen auf die Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span> hat.</span>
<span id="cb42-729"><a href="#cb42-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-732"><a href="#cb42-732" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-733"><a href="#cb42-733" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(paired_tbl<span class="sc">$</span>satt, paired_tbl<span class="sc">$</span>hungrig, </span>
<span id="cb42-734"><a href="#cb42-734" aria-hidden="true" tabindex="-1"></a>       <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-735"><a href="#cb42-735" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-736"><a href="#cb42-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-737"><a href="#cb42-737" aria-hidden="true" tabindex="-1"></a>Die Ausgabe des paired t-Test ähnelt stark der Aussage des Student t-Test. Wir erhalten ebenfalls den wichtigen p-Wert mit 0.0025 sowie das 95% Konfidenzintervall mit <span class="sc">\[</span>0.47; 1.13<span class="sc">\]</span>. Zum einen ist $0.0025 &lt; \alpha$ und somit können wir die Nullhypothese ablehnen, zum anderen ist auch die 0 nicht mit in dem Konfidenzintervall, womit wir auch hier die Nullhypothese ablehnen können.</span>
<span id="cb42-738"><a href="#cb42-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-739"><a href="#cb42-739" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{rstatix}`</span></span>
<span id="cb42-740"><a href="#cb42-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-741"><a href="#cb42-741" aria-hidden="true" tabindex="-1"></a>Ich würde eher die Implementierung in <span class="in">`{rstatix}`</span> der Standardimplementierung in <span class="in">`{stats}`</span> vorziehen, da wir hier die Daten über die Pipe in die Funktion weiterleiten können. Das macht es dann doch etwas einfacher. Am Ende kommt aber das gleiche raus, so dass ich die Funktion hier als Alternative stehen lasse. Das wir noch eine Datentabelle als Ausgabe kriegen, ist natürlich auch super schön.</span>
<span id="cb42-742"><a href="#cb42-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-745"><a href="#cb42-745" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-746"><a href="#cb42-746" aria-hidden="true" tabindex="-1"></a><span class="fu">t_test</span>(jump_length <span class="sc">~</span> trt, <span class="at">data =</span> paired_long_tbl, </span>
<span id="cb42-747"><a href="#cb42-747" aria-hidden="true" tabindex="-1"></a>       <span class="at">paired =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-748"><a href="#cb42-748" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(group1, group2, p)</span>
<span id="cb42-749"><a href="#cb42-749" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-750"><a href="#cb42-750" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-751"><a href="#cb42-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-752"><a href="#cb42-752" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modellierung</span></span>
<span id="cb42-753"><a href="#cb42-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-754"><a href="#cb42-754" aria-hidden="true" tabindex="-1"></a>Für vielleicht viele, auch für die sich schon länger mit der Statistik beschäftigen, ist es immer wieder eine Überraschung, dass sich die gängigen statistischen Tests auch als Modelle abbilden lassen. Die Übersicht <span class="co">[</span><span class="ot">Common statistical tests are linear models</span><span class="co">](https://lindeloev.github.io/tests-as-linear/)</span> liefert hier nochmal eine wunderbare Tabelle. Ich zeige hier die Modellierungen in <span class="in">`lm()`</span> sowie <span class="in">`gls()`</span>, die ja eigentlich als Regression gilt udn nicht als Test. Hier siehst du, wie sich dann auch über die Jahre Zusammenhänge herausgestellt haben, die dann methodisch vereinheitlicht wurden. Ich habe dir den direkten Vergleich dann immer in den zweiten Tab gelegt. Dann beginnen wir mit dem linearen Modell mit <span class="in">`lm()`</span>, die dann auf einer kategoriellen Einflussvariable einen t-Test rechnet.</span>
<span id="cb42-755"><a href="#cb42-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-756"><a href="#cb42-756" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb42-757"><a href="#cb42-757" aria-hidden="true" tabindex="-1"></a><span class="fu">## `lm()`</span></span>
<span id="cb42-758"><a href="#cb42-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-761"><a href="#cb42-761" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-762"><a href="#cb42-762" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb42-763"><a href="#cb42-763" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb42-764"><a href="#cb42-764" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-765"><a href="#cb42-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-766"><a href="#cb42-766" aria-hidden="true" tabindex="-1"></a><span class="fu">## `t.test()`</span></span>
<span id="cb42-767"><a href="#cb42-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-770"><a href="#cb42-770" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-771"><a href="#cb42-771" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(jump_length <span class="sc">~</span> animal, </span>
<span id="cb42-772"><a href="#cb42-772" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> fac1_tbl, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-773"><a href="#cb42-773" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-774"><a href="#cb42-774" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-775"><a href="#cb42-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-776"><a href="#cb42-776" aria-hidden="true" tabindex="-1"></a>Neben der klassischen Regression, die dann homogene Varianzen in den Gruppen annimmt, können wir die Regression auch mit der Funktion <span class="in">`gls()`</span> aus dem R Paket <span class="in">`{nlme}`</span> rechen. Dann haben wir auch die Möglichkeit die heterogenen Varianzen in den Gruppen zu berücksichten.</span>
<span id="cb42-777"><a href="#cb42-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-778"><a href="#cb42-778" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb42-779"><a href="#cb42-779" aria-hidden="true" tabindex="-1"></a><span class="fu">## `gls()`</span></span>
<span id="cb42-780"><a href="#cb42-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-783"><a href="#cb42-783" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-784"><a href="#cb42-784" aria-hidden="true" tabindex="-1"></a><span class="fu">gls</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl, </span>
<span id="cb42-785"><a href="#cb42-785" aria-hidden="true" tabindex="-1"></a>    <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> animal)) <span class="sc">|&gt;</span> </span>
<span id="cb42-786"><a href="#cb42-786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb42-787"><a href="#cb42-787" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-788"><a href="#cb42-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-789"><a href="#cb42-789" aria-hidden="true" tabindex="-1"></a><span class="fu">## `t.test()`</span></span>
<span id="cb42-790"><a href="#cb42-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-793"><a href="#cb42-793" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-794"><a href="#cb42-794" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(jump_length <span class="sc">~</span> animal, </span>
<span id="cb42-795"><a href="#cb42-795" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> fac1_tbl, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb42-796"><a href="#cb42-796" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-797"><a href="#cb42-797" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-798"><a href="#cb42-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-799"><a href="#cb42-799" aria-hidden="true" tabindex="-1"></a>Dann haben wir noch den Fall, dass wir einen paarweisen Vergleich rechnen wollen. In dem Fall nutzen wir wieder die Funktion <span class="in">`lm()`</span> in einem linearen Modell, rechnen aber mit der Differenz. Die Schreibweise ist etwas wild, aber wir schauen einfach, ob sich die Differenz der beiden Spalten von Null unterscheidet. Nichts anderes macht ja auch der gepaarte t-Test.</span>
<span id="cb42-800"><a href="#cb42-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-801"><a href="#cb42-801" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb42-802"><a href="#cb42-802" aria-hidden="true" tabindex="-1"></a><span class="fu">## `lm()`</span></span>
<span id="cb42-803"><a href="#cb42-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-806"><a href="#cb42-806" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-807"><a href="#cb42-807" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(hungrig <span class="sc">-</span> satt <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> paired_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb42-808"><a href="#cb42-808" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb42-809"><a href="#cb42-809" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-810"><a href="#cb42-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-811"><a href="#cb42-811" aria-hidden="true" tabindex="-1"></a><span class="fu">## `t.test()`</span></span>
<span id="cb42-812"><a href="#cb42-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-815"><a href="#cb42-815" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-816"><a href="#cb42-816" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(paired_tbl<span class="sc">$</span>satt, paired_tbl<span class="sc">$</span>hungrig, </span>
<span id="cb42-817"><a href="#cb42-817" aria-hidden="true" tabindex="-1"></a>       <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-818"><a href="#cb42-818" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-819"><a href="#cb42-819" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-820"><a href="#cb42-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-821"><a href="#cb42-821" aria-hidden="true" tabindex="-1"></a><span class="fu">## Ergebnisse mit `{tidyplots}`</span></span>
<span id="cb42-822"><a href="#cb42-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-823"><a href="#cb42-823" aria-hidden="true" tabindex="-1"></a>Häufig wollen wir nicht nur den p-Wert aus einem t-Test berichten sondern natürlich auch gleich die richtige Abbildung dazu haben. Hier gibt es mit dem R Paket <span class="in">`{tidyplots}`</span> eine gute Möglichkeit. Das R Paket verbindet dabei die Funktionalität von <span class="in">`{ggplot}`</span> und <span class="in">`{ggpubr}`</span>. Dabei bleibt es aber dann sehr einfahc zu bedienen. Insbesondere in dem Fall, dass du nur zwei Gruppen in einem t-Test miteinander vergleichen willst.</span>
<span id="cb42-824"><a href="#cb42-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-825"><a href="#cb42-825" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb42-826"><a href="#cb42-826" aria-hidden="true" tabindex="-1"></a><span class="fu">## Alternativen zu `{tidyplots}`</span></span>
<span id="cb42-827"><a href="#cb42-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-828"><a href="#cb42-828" aria-hidden="true" tabindex="-1"></a>Das R Paket <span class="in">`{ggpubr}`</span> bietet auch noch andere Alternativen für die Darstellung von statistischen Vergleichen in deinen Daten unter <span class="co">[</span><span class="ot">ggpubr: ‘ggplot2’ Based Publication Ready Plots</span><span class="co">](https://rpkgs.datanovia.com/ggpubr/)</span>. Vielleicht findest du da auch noch eine bessere Abbildung als hier. Da wir hier sehr viel ähnliches haben, bleibe ich bei <span class="in">`{tidyplots}`</span>.</span>
<span id="cb42-829"><a href="#cb42-829" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-830"><a href="#cb42-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-831"><a href="#cb42-831" aria-hidden="true" tabindex="-1"></a>Neben den p-Werten, die ich hier mit der Funktion <span class="in">`add_test_pvalue()`</span> ergänze kannst du auch Sterne mit der Funktion <span class="in">`add_test_asterisks()`</span> nutzen. Das liegt dann ganz bei dir. Es gibt auch die Möglichkeit nicht signifikante Ergebnisse auszublenden. Mehr dazu findest du dann auf der <span class="co">[</span><span class="ot">Hilfeseite zu den statistischen Vergleichen in `{tidyplots}`</span><span class="co">](https://jbengler.github.io/tidyplots/articles/Visualizing-data.html#statistical-comparison)</span>. Ich zeige hier dir nur die Standardanwendung. Wichtig ist auch zu wissen, dass wir immer einen Welch t-Test rechnen, also immer für die Varianzheterogenität adjustieren. Das ist auch eigentlich die bessere Variante als der Student t-Test. Häufig ist es sehr schwer in kleinen Fallzahlen abzuschätzen wie die Varianzen in den Gruppen sind. Dann lieber gleich richtig adjsutieren und auf der sicheren Seite sein.</span>
<span id="cb42-832"><a href="#cb42-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-833"><a href="#cb42-833" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb42-834"><a href="#cb42-834" aria-hidden="true" tabindex="-1"></a><span class="fu">## Barplot</span></span>
<span id="cb42-835"><a href="#cb42-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-836"><a href="#cb42-836" aria-hidden="true" tabindex="-1"></a>Die Standardabbildung ist sicherlich der Barplot zusammen mit der Standardabweichung als Fehlerbalken. Dann habe ich noch die einzelnen Beobachtungen ergänzt. Die Klammer über den beiden Säulen gibt den Vergleich an und die Zahl ist der p-Wert aus einem Welch t-Test. Wir sehen hier, dass sich die beiden Floharten in den Sprungweiten signifikant unterscheiden. Der p-Wert ist kleiner als das Signifikanzniveau $\alpha$ gleich 5%.</span>
<span id="cb42-837"><a href="#cb42-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-840"><a href="#cb42-840" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-841"><a href="#cb42-841" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb42-842"><a href="#cb42-842" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb42-843"><a href="#cb42-843" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb42-844"><a href="#cb42-844" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-tidyplot-barplot-ttest</span></span>
<span id="cb42-845"><a href="#cb42-845" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-846"><a href="#cb42-846" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb42-847"><a href="#cb42-847" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 3.5</span></span>
<span id="cb42-848"><a href="#cb42-848" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Einfaktorieller Barplot für die Sprungweiten in [cm] gruppiert nach den Floharten mit mehr Optionen und angepassten Beschriftungen sowie den p-Wert aus einem Welch t-Test."</span></span>
<span id="cb42-849"><a href="#cb42-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-850"><a href="#cb42-850" aria-hidden="true" tabindex="-1"></a><span class="fu">tidyplot</span>(<span class="at">data =</span> fac1_tbl, </span>
<span id="cb42-851"><a href="#cb42-851" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> animal, <span class="at">y =</span> jump_length, <span class="at">color =</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb42-852"><a href="#cb42-852" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_data_points</span>() <span class="sc">|&gt;</span></span>
<span id="cb42-853"><a href="#cb42-853" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_mean_bar</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">width =</span> <span class="fl">0.4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-854"><a href="#cb42-854" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_sd_errorbar</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-855"><a href="#cb42-855" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_test_pvalue</span>(<span class="at">method =</span> <span class="st">"t_test"</span>, <span class="at">hide_info =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb42-856"><a href="#cb42-856" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_legend</span>() <span class="sc">|&gt;</span> </span>
<span id="cb42-857"><a href="#cb42-857" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_font</span>(<span class="at">fontsize =</span> <span class="dv">9</span>) <span class="sc">|&gt;</span></span>
<span id="cb42-858"><a href="#cb42-858" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_x_axis_title</span>(<span class="st">"Flohart"</span>) <span class="sc">|&gt;</span></span>
<span id="cb42-859"><a href="#cb42-859" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_y_axis_title</span>(<span class="st">"Sprungweite in [cm]"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-860"><a href="#cb42-860" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_x_axis_labels</span>(<span class="at">new_names =</span> <span class="fu">c</span>(<span class="st">"dog"</span> <span class="ot">=</span> <span class="st">"Hund"</span>, <span class="st">"cat"</span> <span class="ot">=</span> <span class="st">"Katze"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb42-861"><a href="#cb42-861" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_size</span>(<span class="at">width =</span> <span class="cn">NA</span>, <span class="at">height =</span> <span class="cn">NA</span>) </span>
<span id="cb42-862"><a href="#cb42-862" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-863"><a href="#cb42-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-864"><a href="#cb42-864" aria-hidden="true" tabindex="-1"></a><span class="fu">## Boxplot</span></span>
<span id="cb42-865"><a href="#cb42-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-866"><a href="#cb42-866" aria-hidden="true" tabindex="-1"></a>Es gibt auch gute Gründe ienmal den Boxplot zu wählen, wenn wir etwas besser die Verteilung der Sprungweiten darstellen wollen. Ich habe dann noch die einzelnen Beobachtungen ergänzt. Die Klammer über den beiden Säulen gibt den Vergleich an und die Zahl ist der p-Wert aus einem Welch t-Test. Wir sehen hier, dass sich die beiden Floharten in den Sprungweiten signifikant unterscheiden. Der p-Wert ist kleiner als das Signifikanzniveau $\alpha$ gleich 5%.</span>
<span id="cb42-867"><a href="#cb42-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-870"><a href="#cb42-870" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-871"><a href="#cb42-871" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb42-872"><a href="#cb42-872" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb42-873"><a href="#cb42-873" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb42-874"><a href="#cb42-874" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-tidyplot-boxplot-ttest</span></span>
<span id="cb42-875"><a href="#cb42-875" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-876"><a href="#cb42-876" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb42-877"><a href="#cb42-877" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 3.5</span></span>
<span id="cb42-878"><a href="#cb42-878" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Einfaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten mit mehr Optionen und angepassten Beschriftungen sowie den p-Wert aus einem Welch t-Test."</span></span>
<span id="cb42-879"><a href="#cb42-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-880"><a href="#cb42-880" aria-hidden="true" tabindex="-1"></a><span class="fu">tidyplot</span>(<span class="at">data =</span> fac1_tbl, </span>
<span id="cb42-881"><a href="#cb42-881" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> animal, <span class="at">y =</span> jump_length, <span class="at">color =</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb42-882"><a href="#cb42-882" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_data_points</span>() <span class="sc">|&gt;</span></span>
<span id="cb42-883"><a href="#cb42-883" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">box_width =</span> <span class="fl">0.3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-884"><a href="#cb42-884" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_test_pvalue</span>(<span class="at">method =</span> <span class="st">"t_test"</span>, <span class="at">hide_info =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-885"><a href="#cb42-885" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_legend</span>() <span class="sc">|&gt;</span> </span>
<span id="cb42-886"><a href="#cb42-886" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_font</span>(<span class="at">fontsize =</span> <span class="dv">9</span>) <span class="sc">|&gt;</span></span>
<span id="cb42-887"><a href="#cb42-887" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_x_axis_title</span>(<span class="st">"Flohart"</span>) <span class="sc">|&gt;</span></span>
<span id="cb42-888"><a href="#cb42-888" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_y_axis_title</span>(<span class="st">"Sprungweite in [cm]"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-889"><a href="#cb42-889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_x_axis_labels</span>(<span class="at">new_names =</span> <span class="fu">c</span>(<span class="st">"dog"</span> <span class="ot">=</span> <span class="st">"Hund"</span>, <span class="st">"cat"</span> <span class="ot">=</span> <span class="st">"Katze"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb42-890"><a href="#cb42-890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_size</span>(<span class="at">width =</span> <span class="cn">NA</span>, <span class="at">height =</span> <span class="cn">NA</span>) </span>
<span id="cb42-891"><a href="#cb42-891" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-892"><a href="#cb42-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-893"><a href="#cb42-893" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gepaarter Dotplot</span></span>
<span id="cb42-894"><a href="#cb42-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-895"><a href="#cb42-895" aria-hidden="true" tabindex="-1"></a>Am Ende wollen wir uns dann nochmal den gepaarten t-Test anschauen. Hier ist dann die Abbildung realtiv einfach. Wir können da die Daten <span class="in">`paired_tbl`</span> aus dem gepaarten t-Test nutzen nachdem wir die Daten in das Long-Format überführt haben. Etwas schwieriger ist dann der p-Wert, den p-Wert müssen wir dann erst selber errechnen und dann ergänzen. Hier nutzen wir dann den gepaarten Datensatz in dem Long-Format.</span>
<span id="cb42-896"><a href="#cb42-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-897"><a href="#cb42-897" aria-hidden="true" tabindex="-1"></a>Jetzt können wir den gepaarten t-Test rechnen und zwar aus dem R Paket <span class="in">`{rstatix}`</span>. Dann müssen wir noch alles so umbauen, dass wir die Informationen dann in <span class="in">`{tidyplots}`</span> auch nutzen können.</span>
<span id="cb42-898"><a href="#cb42-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-901"><a href="#cb42-901" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-902"><a href="#cb42-902" aria-hidden="true" tabindex="-1"></a>stats_tbl <span class="ot">&lt;-</span> paired_long_tbl <span class="sc">|&gt;</span> </span>
<span id="cb42-903"><a href="#cb42-903" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(id) <span class="sc">|&gt;</span> </span>
<span id="cb42-904"><a href="#cb42-904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t_test</span>(jump_length <span class="sc">~</span> trt, <span class="at">paired =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-905"><a href="#cb42-905" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_significance</span>() <span class="sc">|&gt;</span> </span>
<span id="cb42-906"><a href="#cb42-906" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_xy_position</span>()</span>
<span id="cb42-907"><a href="#cb42-907" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-908"><a href="#cb42-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-909"><a href="#cb42-909" aria-hidden="true" tabindex="-1"></a>Wir nutzen hier die Funktion <span class="in">`stat_pvalue_manual()`</span> um händisch die p-Werte zu den Dotplot mit den Mittelwert und Standardabweichung zu ergänzen. Die Verbindungen zwischen den Beobachtungen haben wir dann durch <span class="in">`add_line()`</span> erzeugt. Ich gebe zu, dass ist etwas komplizierter. Wenn du dann die Sterne haben willst, dann musst due das Label auf <span class="in">`"p.signif"`</span> setzen. Dann werden statt der p-Werte <span class="in">`"p"`</span> dir die Sterne <span class="in">`*`</span> angezeigt. Wir sehen hier, dass sich die beiden Fütterungslevel in den Sprungweiten signifikant unterscheiden. Der p-Wert ist kleiner als das Signifikanzniveau $\alpha$ gleich 5%.</span>
<span id="cb42-910"><a href="#cb42-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-913"><a href="#cb42-913" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-914"><a href="#cb42-914" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb42-915"><a href="#cb42-915" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb42-916"><a href="#cb42-916" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb42-917"><a href="#cb42-917" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-tidyplot-barplot-ttest-paired</span></span>
<span id="cb42-918"><a href="#cb42-918" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-919"><a href="#cb42-919" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb42-920"><a href="#cb42-920" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 3.5</span></span>
<span id="cb42-921"><a href="#cb42-921" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Dotplot mit Mittelwert und Standardabweichung für die Sprungweiten in [cm] gruppiert nach den Floharten mit mehr Optionen und angepassten Beschriftungen sowie den p-Wert aus einem paired t-Test. Gleiche Messungen an gleichen Flöhen sind mit einer Linie verbunden."</span></span>
<span id="cb42-922"><a href="#cb42-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-923"><a href="#cb42-923" aria-hidden="true" tabindex="-1"></a>paired_long_tbl <span class="sc">|&gt;</span> </span>
<span id="cb42-924"><a href="#cb42-924" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidyplot</span>(<span class="at">x =</span> trt, <span class="at">y =</span> jump_length, <span class="at">color =</span> trt, <span class="at">fill =</span> <span class="cn">NA</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-925"><a href="#cb42-925" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_line</span>(<span class="at">group =</span> id, <span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-926"><a href="#cb42-926" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_data_points</span>() <span class="sc">|&gt;</span></span>
<span id="cb42-927"><a href="#cb42-927" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_mean_dash</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-928"><a href="#cb42-928" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_sd_errorbar</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-929"><a href="#cb42-929" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add</span>(<span class="fu">stat_pvalue_manual</span>(stats_tbl, <span class="at">size =</span> <span class="dv">7</span><span class="sc">/</span>.pt, <span class="at">label =</span> <span class="st">"p"</span>,</span>
<span id="cb42-930"><a href="#cb42-930" aria-hidden="true" tabindex="-1"></a>                         <span class="at">bracket.nudge.y =</span> <span class="fl">0.1</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb42-931"><a href="#cb42-931" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_legend</span>() <span class="sc">|&gt;</span> </span>
<span id="cb42-932"><a href="#cb42-932" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_font</span>(<span class="at">fontsize =</span> <span class="dv">9</span>) <span class="sc">|&gt;</span></span>
<span id="cb42-933"><a href="#cb42-933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_x_axis_title</span>(<span class="st">"Fütterung"</span>) <span class="sc">|&gt;</span></span>
<span id="cb42-934"><a href="#cb42-934" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_y_axis_title</span>(<span class="st">"Sprungweite in [cm]"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-935"><a href="#cb42-935" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reorder_x_axis_labels</span>(<span class="st">"unfed"</span>, <span class="st">"fed"</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb42-936"><a href="#cb42-936" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_x_axis_labels</span>(<span class="at">new_names =</span> <span class="fu">c</span>(<span class="st">"fed"</span> <span class="ot">=</span> <span class="st">"gefüttert"</span>, <span class="st">"unfed"</span> <span class="ot">=</span> <span class="st">"ungefüttert"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb42-937"><a href="#cb42-937" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_size</span>(<span class="at">width =</span> <span class="cn">NA</span>, <span class="at">height =</span> <span class="cn">NA</span>) </span>
<span id="cb42-938"><a href="#cb42-938" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-939"><a href="#cb42-939" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb42-940"><a href="#cb42-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-941"><a href="#cb42-941" aria-hidden="true" tabindex="-1"></a><span class="fu">## Freiheitsgrade</span></span>
<span id="cb42-942"><a href="#cb42-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-943"><a href="#cb42-943" aria-hidden="true" tabindex="-1"></a>Der t-Verteilung der Teststatistiken des t-Tests verhält sich nicht wie eine <span class="co">[</span><span class="ot">klassische Normalverteilung</span><span class="co">](#sec-distribution)</span>, die durch den Mittelwert und die Standardabweichung definiert ist. Die t-Verteilung ist nur durch die Freiheitsgrade definiert. Der Freiheitsgrad (eng. *degree of freedom*, abk. *df*) in einem t-Test mit zwei Gruppen mit den Fallzahlen $n_1$ und $n_2$ ist gegeben durch $df = n_1 + n_2 -2$. Damit beschreiben die Freiheitsgrade grob die gesamte Fallzahl in einen Datensatz mit nur zwei Gruppen. Je mehr Fallzahl in den beiden Gruppen desto großer der Freiheitsgrad eines t-Tests.</span>
<span id="cb42-944"><a href="#cb42-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-945"><a href="#cb42-945" aria-hidden="true" tabindex="-1"></a>Die @fig-ttest-06 visualisiert diesen Zusammenhang von Freiheitsgraden und der Form der t-Verteilung. Je kleiner die Freiheitsgrade und damit die Fallzahl in unseren beiden Gruppen, desto weiter sind die Verteilungsschwänze. Wie du sehen kannst, reicht die rote Verteilung mit einem Freiheitsgrad von $df = 10$ viel weiter nach links und rechts als die anderen Verteilungen mit niedrigeren Freiheitsgraden. Daher benötigen wir auch größere $T_{D}$ Werte um ein signifikantes Ergebnis zu erhalten. Denn die Fläche unter der t-Verteilung ist immer gleich 1 und somit wandert dann der kritische Wert $T_{\alpha = 5\%}$ immer weiter nach außen. Das macht ja auch Sinn, wenn wir wenige Beobachtungen vorliegen haben, dann brauchen wir größere Werte der Teststatistik um an einen signifikanten Effekt glauben zu können.</span>
<span id="cb42-946"><a href="#cb42-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-949"><a href="#cb42-949" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb42-950"><a href="#cb42-950" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb42-951"><a href="#cb42-951" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb42-952"><a href="#cb42-952" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb42-953"><a href="#cb42-953" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ttest-06</span></span>
<span id="cb42-954"><a href="#cb42-954" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-955"><a href="#cb42-955" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4.5</span></span>
<span id="cb42-956"><a href="#cb42-956" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb42-957"><a href="#cb42-957" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Die t-Verteilung für drei beispielhafte Freiheitsgrade. Je größer die Freiheitsgrade und damit die Fallzahl, desto näher kommt die t-Verteilung einer Normalverteilung nahe. Bei einer geringeren Fallzahl, müssen damit größere $T_{D}$ Werte erreicht werden um eine signifikantes Ergebnis zu erhalten, da mehr Fläche nach außen wandert. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb42-958"><a href="#cb42-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-959"><a href="#cb42-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-960"><a href="#cb42-960" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.25</span>, <span class="fl">3.25</span>)), <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb42-961"><a href="#cb42-961" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-962"><a href="#cb42-962" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb42-963"><a href="#cb42-963" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb42-964"><a href="#cb42-964" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">1.5</span>), </span>
<span id="cb42-965"><a href="#cb42-965" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.25</span>, <span class="fl">8.25</span>), <span class="at">color =</span> <span class="st">"#E89F00"</span>) <span class="sc">+</span></span>
<span id="cb42-966"><a href="#cb42-966" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.25</span>, <span class="fl">8.25</span>), <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">1.5</span>), </span>
<span id="cb42-967"><a href="#cb42-967" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="st">"#E89F00"</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb42-968"><a href="#cb42-968" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="fl">2.8</span>, <span class="at">y =</span> <span class="fl">0.25</span>, <span class="at">label =</span> <span class="st">"df = 30"</span>, <span class="at">size =</span> <span class="dv">8</span>,</span>
<span id="cb42-969"><a href="#cb42-969" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"#E89F00"</span>) <span class="sc">+</span></span>
<span id="cb42-970"><a href="#cb42-970" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_curve</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">2.8</span>, <span class="at">y =</span> <span class="fl">0.24</span>, <span class="at">xend =</span> <span class="sc">-</span><span class="fl">0.6</span>, <span class="at">yend =</span> <span class="fl">0.21</span>,</span>
<span id="cb42-971"><a href="#cb42-971" aria-hidden="true" tabindex="-1"></a>             <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.03</span>, <span class="st">"npc"</span>), <span class="at">type =</span> <span class="st">"closed"</span>),</span>
<span id="cb42-972"><a href="#cb42-972" aria-hidden="true" tabindex="-1"></a>             <span class="at">curvature =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb42-973"><a href="#cb42-973" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">2</span>), </span>
<span id="cb42-974"><a href="#cb42-974" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.25</span>, <span class="fl">8.25</span>), <span class="at">color =</span> <span class="st">"#58B4E9"</span>) <span class="sc">+</span></span>
<span id="cb42-975"><a href="#cb42-975" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.25</span>, <span class="fl">8.25</span>), <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">2</span>), </span>
<span id="cb42-976"><a href="#cb42-976" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="st">"#58B4E9"</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb42-977"><a href="#cb42-977" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="fl">0.175</span>, <span class="at">label =</span> <span class="st">"df = 20"</span>, <span class="at">size =</span> <span class="dv">8</span>,</span>
<span id="cb42-978"><a href="#cb42-978" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"#58B4E9"</span>) <span class="sc">+</span></span>
<span id="cb42-979"><a href="#cb42-979" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_curve</span>(<span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="fl">0.165</span>, <span class="at">xend =</span> <span class="fl">1.2</span>, <span class="at">yend =</span> <span class="fl">0.14</span>,</span>
<span id="cb42-980"><a href="#cb42-980" aria-hidden="true" tabindex="-1"></a>             <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.03</span>, <span class="st">"npc"</span>), <span class="at">type =</span> <span class="st">"closed"</span>),</span>
<span id="cb42-981"><a href="#cb42-981" aria-hidden="true" tabindex="-1"></a>             <span class="at">curvature =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb42-982"><a href="#cb42-982" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>), </span>
<span id="cb42-983"><a href="#cb42-983" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.25</span>, <span class="fl">8.25</span>), <span class="at">color =</span> <span class="st">"#CC89A8"</span>) <span class="sc">+</span></span>
<span id="cb42-984"><a href="#cb42-984" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.25</span>, <span class="fl">8.25</span>), <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>), </span>
<span id="cb42-985"><a href="#cb42-985" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="st">"#CC89A8"</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb42-986"><a href="#cb42-986" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="fl">0.1</span>, <span class="at">label =</span> <span class="st">"df = 10"</span>, <span class="at">size =</span> <span class="dv">8</span>,</span>
<span id="cb42-987"><a href="#cb42-987" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"#CC89A8"</span>) <span class="sc">+</span></span>
<span id="cb42-988"><a href="#cb42-988" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_curve</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="fl">0.09</span>, <span class="at">xend =</span> <span class="fl">4.1</span>, <span class="at">yend =</span> <span class="fl">0.035</span>,</span>
<span id="cb42-989"><a href="#cb42-989" aria-hidden="true" tabindex="-1"></a>             <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.03</span>, <span class="st">"npc"</span>), <span class="at">type =</span> <span class="st">"closed"</span>),</span>
<span id="cb42-990"><a href="#cb42-990" aria-hidden="true" tabindex="-1"></a>             <span class="at">curvature =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb42-991"><a href="#cb42-991" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb42-992"><a href="#cb42-992" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb42-993"><a href="#cb42-993" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>) </span>
<span id="cb42-994"><a href="#cb42-994" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb42-995"><a href="#cb42-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-996"><a href="#cb42-996" aria-hidden="true" tabindex="-1"></a><span class="fu">## Referenzen {.unnumbered}</span></span>
</code><button title="In die Zwischenablage kopieren" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Bio Data Science wurde von <a href="https://www.hs-osnabrueck.de/prof-dr-jochen-kruppa/">Jochen Kruppa-Scheetz</a> geschrieben.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-tests-ttest.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-tests-ttest.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Dieses Openbook wurde mit <a href="https://quarto.org/">Quarto</a> erstellt.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>